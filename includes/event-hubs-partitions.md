---
title: Включить файл
description: включить файл
services: event-hubs
author: spelluru
ms.service: event-hubs
ms.topic: include
ms.date: 03/15/2021
ms.author: spelluru
ms.custom: include file
ms.openlocfilehash: 1dd78ba3799573e05e4ebbf55887bae3d9674b7c
ms.sourcegitcommit: b4fbb7a6a0aa93656e8dd29979786069eca567dc
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2021
ms.locfileid: "107310089"
---
Центры событий упорядочивают последовательности событий, отправленных в концентратор событий, в одну или несколько секций. По мере поступления новых событий они добавляются в конец этой последовательности. 

![Центры событий](./media/event-hubs-partitions/multiple-partitions.png)

Секцию можно рассматривать как журнал фиксации. Секции содержат данные событий: тело события, контейнер определяемых пользователем свойств для описания события, а также метаданные, такие как смещение в секции, номер события в последовательности потока и метка времени, когда событие было принято, на стороне службы.

![Схема, на которой показана последовательность событий (от старых до более новых).](./media/event-hubs-partitions/partition.png)

### <a name="advantages-of-using-partitions"></a>Преимущества использования секций
Служба "Центры событий" предназначена для обработки больших объемов событий, а секционирование помогает при этом двумя способами.

- Хотя "Центры событий" — это служба PaaS, в ее основе лежит физическая реальность, и для поддержания журнала, сохраняющего порядок событий, необходимо, чтобы эти события хранились вместе в базовом хранилище и его репликах, что приводит к достижению верхнего порога пропускной способности для такого журнала. Секционирование позволяет использовать для одного концентратора событий несколько параллельных журналов и, следовательно, умножить доступную пропускную способность необработанных операций ввода-вывода.
- Ваши приложения должны справляться с обработкой объема событий, отправляемых в концентратор событий. Это может оказаться сложной задачей, для которой требуется значительная масштабируемая емкость параллельной обработки. Емкость одного процесса обработки событий ограничена, поэтому вам требуется несколько процессов. Секции — это то, как ваше решение передает эти процессы и тем самым гарантирует, что у каждого события есть четкий владелец обработки. 

### <a name="number-of-partitions"></a>Количество разделов
Количество секций определяется во время создания. В Центрах событий ценовой категории "Стандартный" рабочий диапазон — от 1 до 32. В Центрах событий ценовой категории "Выделенный" число секций на единицу емкости может доходить до 2000. 

Рекомендуем выбрать как минимум столько секций, сколько может потребоваться для поддержания постоянного количества [единиц пропускной способности](../articles/event-hubs/event-hubs-faq.yml#what-are-event-hubs-throughput-units-) во время пиковой нагрузки вашего приложения для этого концентратора событий. При расчетах следует иметь в виду, что пропускная способность одной секции соответствует 1 единице пропускной способности (1 МБ входящих данных, 2 МБ исходящих данных). Вы можете масштабировать единицы пропускной способности в пространстве имен или единицы емкости в кластере независимо от числа секций. Стоимость концентратора событий с 32 секциями и концентратора событий с одной секцией будет одинаковой, если для пространства имен задана емкость в 1 единицу пропускной способности. 

Число секций концентратора событий в [выделенном кластере службы "Центры событий"](../articles/event-hubs/event-hubs-dedicated-overview.md) можно [увеличить](../articles/event-hubs/dynamically-add-partitions.md) после создания концентратора событий, но распределение потоков между секциями изменится, если изменится сопоставление ключей секций c секциями. Поэтому, если для вашего приложения важен относительный порядок событий, старайтесь избегать таких изменений.

Установить для количества секций максимально допустимое значение может быть заманчиво, но всегда помните, что ваши потоки событий должны быть структурированы так, чтобы вы действительно могли воспользоваться преимуществами нескольких секций. Если требуется абсолютное сохранение порядка по всем событиям или только небольшому количеству подпотоков, вы не сможете воспользоваться преимуществами нескольких секций. Кроме того, наличие большого количества секций усложняет обработку. 


### <a name="mapping-of-events-to-partitions"></a>Сопоставление событий с секциями
Вы можете использовать ключ секции, чтобы сопоставлять входные данные событий с определенными секциями для организации данных. Ключ секции — это указываемое отправителем значение, передаваемое в концентратор событий. Оно обрабатывается с помощью статической функции хэширования, в результате чего создается назначение секции. Если при публикации события не указать ключ секции, назначение создается с помощью циклического перебора.

Издателю событий известен только ключ секции, но не сама секция, в которой публикуются события. Благодаря разделению ключа и секции отправителю не нужно располагать избыточными сведениями о последующей обработке и хранении событий. Уникальное удостоверение устройства или пользователя является хорошим ключом секции, но другие атрибуты, например географическое положение, можно также использовать для группировки связанных событий в одну секцию.

Указание ключа секции позволяет хранить связанные события в одной и той же секции и в точно таком же порядке, в котором они были отправлены. Ключ секции — это строка, которая является производной от контекста приложения и определяет взаимосвязь событий. Последовательность событий, определяемых ключом секции, называется *потоком*. Секция — это мультиплексное хранилище журналов для множества таких потоков. 

> [!NOTE]
> Хотя вы можете отправить события непосредственно в секции, мы не рекомендуем это делать, особенно если вам важна высокая доступность. Это понижает доступность концентратора событий до уровня секции. Дополнительные сведения см. в статье [Доступность и согласованность в Центрах событий](../articles/event-hubs/event-hubs-availability-and-consistency.md).

