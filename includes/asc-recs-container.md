---
author: memildin
ms.service: security-center
ms.topic: include
ms.date: 03/14/2021
ms.author: memildin
ms.custom: generated
ms.openlocfilehash: 4a03a36f098035db1a91b4516dedb6a303aa41d2
ms.sourcegitcommit: 3ea12ce4f6c142c5a1a2f04d6e329e3456d2bda5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103466212"
---
В этой категории есть **24** рекомендации.

|Рекомендация |Описание |Severity |
|---|---|---|
|Azure Defender для реестров контейнеров должен быть включен |Чтобы создать защищенные контейнерные рабочие нагрузки, убедитесь, что базовые образы не содержат известные уязвимости.<br>Azure Defender для реестров контейнеров проверяет реестр на наличие уязвимостей в каждом из отправленных образов контейнеров и предоставляет подробные результаты для каждого образа.<br>Чтобы улучшить безопасность контейнеров и защитить их от атак, включите Azure Defender для реестров контейнеров.<br><br>Важно! Применение этой рекомендации предусматривает плату за защиту реестров контейнеров. Если в этой подписке нет реестров контейнеров, плата не будет взиматься.<br>Если в будущем вы создадите в этой подписке реестры контейнеров, они будут автоматически защищены, и с этого момента начнет начисляться плата.<br> <a href='https://docs.microsoft.com/azure/security-center/azure-container-registry-integration'>Подробные сведения об Azure Defender для реестров контейнеров.</a><br />(связанная политика: [необходимо включить Azure Defender для реестров контейнеров](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2fc25d9a16-bc35-4e15-a7e5-9db606bf9ed4)) |Высокий |
|Azure Defender для Kubernetes должен быть включен |Azure Defender для Kubernetes обеспечивает защиту контейнерных сред от угроз в реальном времени и создает оповещения о подозрительных действиях.<br>Эти сведения можно использовать для быстрого устранения проблем безопасности и повышения безопасности контейнеров.<br><br>Важно! Применение этой рекомендации предусматривает плату за защиту кластеров Kubernetes. Если в этой подписке нет кластеров Kubernetes, плата не будет взиматься.<br>Если в будущем вы создадите в этой подписке кластеры Kubernetes, они будут автоматически защищены, и с этого момента начнет начисляться плата.<br> <a href='https://docs.microsoft.com/azure/security-center/azure-kubernetes-service-integration'>Дополнительные сведения об Azure Defender для Kubernetes.</a><br />(связанная политика: [необходимо включить Azure Defender для Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fmicrosoft.authorization%2fpolicyDefinitions%2f523b5cd1-3e23-492f-a539-13118b6d1e3a)) |Высокий |
|В кластерах должна быть установлена и включена надстройка Политики Azure для Kubernetes |Надстройка службы "Политика Azure" для Kubernetes расширяет возможности <a target="_blank" href="https://github.com/open-policy-agent/gatekeeper">Gatekeeper</a> версии 3 (веб-перехватчик контроллера допуска для <a target="_blank" href="https://www.openpolicyagent.org/">Open Policy Agent</a> (OPA)), чтобы централизованным и согласованным образом применить правила и меры безопасности для кластеров в требуемом масштабе.<p>Центр безопасности ожидает, что надстройка будет выполнять аудит и применять возможности для обеспечения защиты и соответствия в кластерах. <a target="_blank" href="https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes"> Подробнее</a>.</p><p>Требуется Kubernetes версии 1.14.0 или более поздней.</p><br />(связанная политика: [в ваших кластерах должна быть установлена и включена надстройка службы "Политика Azure" для службы Kubernetes (AKS)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f0a15ec92-a229-4763-bb14-0ea34a568f8d)) |Высокий |
|Для контейнеров должны соблюдаться ограничения по числу ЦП и объему оперативной памяти. |Применение ограничений по числу ЦП и объему памяти защищает от атак, вызывающих нехватку ресурсов (это одна из вариаций атаки типа "отказ в обслуживании").<p>Мы рекомендуем устанавливать для контейнеров ограничения, не позволяющие среде выполнения выходить за установленные пределы потребления ресурсов.</p><br />(связанная политика: [обеспечение лимитов ресурсов ЦП и памяти контейнера в пределах заданных лимитов кластера Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fe345eecc-fa47-480f-9e88-67dcc122b164)) |Средний |
|Образы контейнеров должны развертываться только из доверенных реестров |Образы, работающие в кластере Kubernetes, могут поступать только из известных и отслеживаемых реестров образов контейнеров. Доверенные реестры снижают риск уязвимости для кластеров, ограничивая возможности появления неизвестных уязвимостей, проблем с безопасностью и вредоносных образов.<br />(связанная политика: [обеспечение использования только допустимых образов контейнера в кластере Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ffebd0533-8e55-448f-b837-bd0e06f16469)) |Высокий |
|В реестрах контейнеров должно использоваться шифрование с помощью ключа, управляемого клиентом (CMK) |Используйте ключи, управляемые клиентом, для управления шифрованием неактивного содержимого реестров. По умолчанию неактивные данные шифруются с помощью ключей, управляемых службой, но для соблюдения нормативных требований обычно требуются управляемые клиентом ключи (CMK). Ключи CMK позволяют шифровать данные с помощью ключа Azure Key Vault, создателем и владельцем которого являетесь вы. Вы полностью контролируете жизненный цикл ключа, включая его смену и управление им. См. дополнительные сведения о шифровании CMK: https://aka.ms/acr/CMK.<br />(связанная политика: [Реестры контейнеров должны шифроваться с помощью ключа, управляемого клиентом (CMK)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580)) |Средний |
|В реестрах контейнеров не должен быть разрешен неограниченный сетевой доступ |По умолчанию реестры контейнеров Azure принимают подключения через Интернет от узлов в любой сети. Чтобы защитить свои реестры от потенциальных угроз, разрешите доступ только с определенных общедоступных IP-адресов или диапазонов адресов. Если для реестра нет правила IP-адресов или брандмауэра либо настроенной виртуальной сети, он отобразится как неработоспособный ресурс. См. дополнительные сведения о сетевых правилах Реестра контейнеров: https://aka.ms/acr/portal/public-network и https://aka.ms/acr/vnet.<br />(связанная политика: [Реестры контейнеров не должны разрешать неограниченный сетевой доступ](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fd0793b48-0edc-4296-a390-4c75d1bdfd71)) |Средний |
|Реестры контейнеров должны использовать приватный канал |Приватный канал Azure позволяет подключить виртуальную сеть к службам Azure без общедоступного IP-адреса в исходном или целевом расположении. Платформа приватного канала обрабатывает подключение между потребителем и службами через магистральную сеть Azure. Сопоставление частных конечных точек с реестрами контейнеров, а не всей службой также обеспечивает защиту от утечки данных. См. дополнительные сведения: https://aka.ms/acr/private-link.<br />(связанная политика: [Реестры контейнеров должны использовать приватный канал](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fe8eef0a8-67cf-4eb4-9386-14b0e78733d4)) |Средний |
|Контейнеры с повышением привилегий должны по возможности исключаться |Контейнеры не должны выполняться в кластере Kubernetes с повышением привилегий до пользователя root.<br>Атрибут AllowPrivilegeEscalation определяет, может ли процесс получить больше привилегий, чем его родительский процесс.<br />(связанная политика: [кластеры Kubernetes не должны разрешать повышение привилегий контейнеров](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f1c6e92c9-99f0-4e55-9cf2-0c234dc48f99)) |Средний |
|Контейнеры с общим доступом к важным пространствам имен узлов должны по возможности исключаться |Чтобы защититься от повышения привилегий за пределами контейнера, старайтесь не предоставлять группам pod доступ к важным пространствам имен узла (идентификатор хост-процесса и IPC узла) в кластере Kubernetes.<br />(связанная политика: [контейнеры кластера Kubernetes не должны совместно использовать пространства имен идентификатора процесса узла и IPC узла](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8)) |Средний |
|Контейнеры должны ожидать передачи данных только на разрешенных портах |Чтобы сократить направления атак для кластера Kubernetes, ограничьте доступ к нему, разрешив контейнерам обращаться только к настроенным портам.<br />(связанная политика: [обеспечение ожидания передачи данных контейнерами только на разрешенных портах в кластере Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f440b515e-a580-421e-abeb-b159a61ddcbc)) |Средний |
|Для контейнеров должна применяться неизменяемая (доступная только для чтения) корневая файловая система |Контейнеры в кластере Kubernetes должны запускаться с корневой файловой системой, доступной только для чтения. Неизменяемая файловая система защищает контейнеры от внесения вредоносных двоичных файлов в переменную PATH в среде выполнения.<br />(связанная политика: [контейнеры в кластере Kubernetes должны запускаться с корневой файловой системой, доступной только для чтения](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fdf49d893-a74c-421d-bc95-c663042e5b80)) |Средний |
|Кластеры Kubernetes должны быть доступны только по протоколу HTTPS |Использование HTTPS обеспечивает аутентификацию, а также защищает передаваемые данные от перехвата на сетевом уровне. Эта возможность в настоящее время общедоступна для Службы Azure Kubernetes (AKS), но для обработчика AKS и Kubernetes с поддержкой Azure Arc она предоставляется в предварительной версии. Дополнительные сведения см. на следующей странице: https://aka.ms/kubepolicydoc.<br />(Связанная политика: [принудительное использование HTTPS для входящего трафика в кластере Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d).) |Высокий |
|Для сервера API управления службами Kubernetes должен быть настроен ограниченный доступ |Чтобы обеспечить доступ к кластеру только для приложений из разрешенных сетей, компьютеров или подсетей, ограничьте доступ к серверу API управления службами Kubernetes. Чтобы ограничить доступ, можно определить диапазоны разрешенных IP-адресов или настроить серверы API как частные кластеры, как описано по адресу <a target='_blank' href=https://docs.microsoft.com/azure/aks/private-clusters>https://docs.microsoft.com/azure/aks/private-clusters</a>.<br />(связанная политика: [в службах Kubernetes нужно определить разрешенные диапазоны IP-адресов](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f0e246bcf-5f6f-4f87-bc6f-775d4712c7ea)) |Высокий |
|Службы Kubernetes должны быть обновлены до версии с устраненными уязвимостями |Обновите версию службы Kubernetes своего кластера, чтобы получить защиту от известных уязвимостей текущей версии. Уязвимость <a target='_blank' href='https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9946'>CVE-2019-9946</a> исправлена в Kubernetes версий 1.11.9+, 1.12.7+, 1.13.5+ и 1.14.0+.<br />(связанная политика: [службы Kubernetes должны быть обновлены до версии с устраненными уязвимостями](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ffb893a29-21bb-418c-a157-e99480ec364c)) |Высокий |
|Для контейнеров должны применяться возможности Linux с минимальными правами |Чтобы сократить направления атак на свой контейнер, ограничьте возможности Linux и предоставьте контейнерам определенные привилегии, но не все, что доступны привилегированному пользователю. Мы рекомендуем удалить все возможности, а затем добавить только требуемые.<br />(связанная политика: [контейнеры в кластере Kubernetes должны использовать только разрешенные возможности](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fc26596ff-4d70-4e6a-9a30-c2506bd2f80c)) |Средний |
|Возможности переопределения или отключения профиля AppArmor для контейнеров должны быть ограничены |Контейнеры, работающие в кластере Kubernetes, должны быть ограничены только разрешенными профилями AppArmor.<br>AppArmor — это модуль безопасности Linux, который защищает операционную систему и ее приложения от угроз безопасности. Чтобы использовать его, системный администратор должен связать профиль безопасности AppArmor с каждой программой.<br />(связанная политика: [контейнеры в кластере Kubernetes должны использовать только разрешенные профили AppArmor](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f511f5417-5d12-434d-ab2e-816901e72a5e)) |Высокий |
|Требуется избегать привилегированных контейнеров |Чтобы избежать неограниченного доступа к узлу, избегайте использовать привилегированные контейнеры.<p>Привилегированные контейнеры обладают всеми возможностями привилегированного пользователя на компьютере узла. Они могут использоваться в качестве точек входа для атак или распространения вредоносного кода на скомпрометированные приложения, узлы и сети.</p><br />(связанная политика: [не разрешать привилегированные контейнеры в кластере Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f95edb821-ddaf-4404-9732-666045e056b4)) |Средний |
|В службах Kubernetes должно использоваться управление доступом на основе ролей |Чтобы обеспечить детальную фильтрацию действий, которые могут выполнять пользователи, используйте управление доступом на основе ролей (RBAC) для управления разрешениями в кластерах службы Kubernetes и настройте соответствующие политики авторизации. Дополнительные сведения см. в статье <a target='_blank' href='https://docs.microsoft.com/azure/aks/concepts-identity#role-based-access-controls-rbac'>Управление доступом на основе ролей в Azure</a>.<br />(связанная политика: [в службах Kubernetes следует использовать управление доступом на основе ролей (RBAC)](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2fac4a19c2-fa67-49b4-8ae5-0b2e78c49457)) |Высокий |
|Работа контейнеров от имени привилегированного пользователя должна по возможности исключаться |Контейнеры в кластере Kubernetes должны выполняться от имени непривилегированного пользователя. Запуск процесса от имени привилегированного пользователя в контейнере означает, что он выполняется с правами root. В случае компрометации злоумышленник сразу получит права привилегированного пользователя в контейнере, что упрощает применение эксплойтов.<br />(связанная политика: [группы pod и контейнеры в кластере Kubernetes должны запускаться только с утвержденными идентификаторами пользователей и групп](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2ff06ddb64-5fa3-4b77-b166-acb36f7f6042)) |Высокий |
|Службы должны ожидать передачи данных только на разрешенных портах |Чтобы сократить направления атак для кластера Kubernetes, ограничьте доступ к нему, разрешив службам обращаться только к настроенным портам.<br />(связанная политика: [обеспечение ожидания передачи данных службами только на разрешенных портах в кластере Kubernetes](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f233a2a17-77ca-4fb1-9b6b-69223d272a44)) |Средний |
|Использование сети и портов узлов должно быть ограничено |Ограничивает доступ pod к сети узла и допустимому диапазону портов узла в кластере Kubernetes. Объекты pod, созданные с включенным атрибутом hostNetwork, будут совместно использовать сетевое пространство узла. Чтобы предотвратить перехват сетевого трафика скомпрометированным контейнером, рекомендуется не размещать pod в сети узла. Если в сети узла должен быть предоставлен порт контейнера и при этом порт узла службы Kubernetes не удовлетворяет ваши потребности, вы можете указать для контейнера параметр hostPort в спецификации pod.<br />(связанная политика: [группы pod в кластере Kubernetes должны использовать только утвержденные сеть узла и диапазон портов](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f82985f06-dc18-4a48-bc1c-b9f4f0098cfe)) |Средний |
|Использование подключений томов HostPath для групп pod должно быть ограничено списком известных узлов для предотвращения доступа из скомпрометированных контейнеров. |Мы рекомендуем ограничить число точек подключения для томов HostPath групп pod в кластере Kubernetes настроенными разрешенными путями к узлам. В случае компрометации доступ к узлу контейнера из контейнеров должен быть ограничен.<br />(связанная политика: [тома hostPath групп pod в кластере Kubernetes должны использовать только разрешенные пути к узлам](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f098fc59e-46c7-4d99-9b16-64990e543d75)) |Средний |
|Должны быть исправлены уязвимости в образах Реестра контейнеров Azure (на платформе Qualys) |Средство оценки уязвимостей в образах контейнеров проверяет реестр на наличие уязвимостей в каждом образе и предоставляет подробные результаты для каждого образа. Устранение уязвимостей может значительно улучшить безопасность контейнеров и защитить их от атак.<br />(связанная политика: [уязвимости в образах Реестра контейнеров Azure должны быть устранены](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyDetailBlade/definitionId/%2fproviders%2fMicrosoft.Authorization%2fpolicyDefinitions%2f5f0f936f-2f01-4bf5-b6be-d423792fa562)) |Высокий |
|||
