---
title: включить файл
description: включить файл
services: virtual-machines
author: albecker1
ms.service: virtual-machines
ms.topic: include
ms.date: 02/12/2021
ms.author: albecker1
ms.custom: include file
ms.openlocfilehash: 54c29d76757916a8eea54af16babdae21b809a19
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101750267"
---
## <a name="disk-level-bursting"></a>Разбивка на дисковый уровень

### <a name="on-demand-bursting-preview"></a>Разбивка по запросу (Предварительная версия)

Диски, использующие модель интенсивности по требованию для ускорения работы с дисками, могут выполнять выход за пределы исходных подготовленных целевых объектов, как это часто требуется для рабочей нагрузки, вплоть до максимального количества пакетов. Например, на Тиб P30 диске подготовлено операций ввода-5000 вывода в секунду. Если на этом диске включена функция ускорения работы с дисками, рабочие нагрузки могут выдавать диски IOs на этот диск вплоть до максимальной производительности в 30 000 операций ввода-вывода в секунду и 1 000 Мбит/с.

Если вы предполагаете, что рабочие нагрузки будут часто выполняться за пределами подготовленного целевого объекта производительности, это не будет экономичным. В этом случае рекомендуется изменить уровень производительности диска на [более высокий уровень](../articles/virtual-machines/disks-performance-tiers.md) , чтобы повысить производительность базовых показателей. Проверьте сведения о выставлении счетов и оцените их соответствие шаблону трафика рабочих нагрузок.

Перед включением ускорения по запросу необходимо учитывать следующее.

[!INCLUDE [managed-disk-bursting-regions-limitations](managed-disk-bursting-regions-limitations.md)]

#### <a name="regional-availability"></a>Доступность по регионам

[!INCLUDE [managed-disk-bursting-availability](managed-disk-bursting-availability.md)]

#### <a name="billing"></a>Выставление счетов

Для дисков, использующих модель ускорения по запросу, взимается фиксированная плата за почасовое включение, а затраты на транзакции применяются к любым пакетным транзакциям за пределами подготовленного целевого объекта. Расходы на транзакции оплачиваются с использованием модели оплаты по мере использования, основанной на некэшированном диске IOs, включая операции чтения и записи, превышающие подготовленные целевые объекты. Ниже приведен пример шаблонов трафика на диске за час выставления счетов.

Конфигурация диска: SSD (цен. категория "Премиум") – 1 Тиб (P30), включена Ускоренная работа диска.

- 00:00:00 – 00:10:00 дисковых операций ввода-вывода ниже подготовленного целевого объекта в 5 000 операций ввода/вывода 
- 00:10:01 – 00:10:10 приложение запустило пакетное задание, которое привело к 6 000 ускорению операций ввода-вывода диска в секунду в течение 10 секунд 
- 00:10:11 – 00:59:00 дисковых операций ввода-вывода ниже подготовленного целевого объекта в 5 000 операций ввода/вывода 
- 00:59:01 – 01:00:00 приложение выпустило другое пакетное задание, которое привело к 7 000 ускорению операций ввода-вывода диска в секунду в течение 60 секунд 

В этот час выставления счетов стоимость разбивки состоит из двух расходов:

Первая плата включает в себя фиксированную плату за использование $X (определяется вашим регионом). Эта фиксированная плата всегда взимается по пропуску состояния подключения диска до тех пор, пока она не будет отключена. 

Второй — это стоимость транзакции с увеличением нагрузки. В двух слотах времени произошла Ускоренная работа диска. С 00:10:01 – 00:10:10, накопленная транзакция с разбивкой на транзакции составляет (6 000 – 5 000) X 10 = 10 000. С 00:59:01 – 01:00:00, накопленная транзакция с разбивкой на транзакции составляет (7 000 – 5 000) X 60 = 120 000. Общее число транзакций — 10 000 + 120 000 = 130 000. Плата за пакетную транзакцию будет начисляться на $Y на основе 13 единиц 10 000 транзакций (в зависимости от региональных цен).

При этом общая стоимость этого часа выставления счетов равна $X + $Y. Такое же вычисление применяется для разбивки на подготовленные целевые объекты Мбит/с. Мы преобразуем свыше МБ в транзакции с размером 256 КБ. Если объем трафика на диске превышает подготовленные операции ввода-вывода в секунду и Мбит/с, можно обратиться к приведенному ниже примеру, чтобы вычислить транзакции с пакетной обсчетом. 

Конфигурация диска: SSD (цен. категория "Премиум") – 1 ТБ (P30), включена Ускоренная работа диска.

- 00:00:01 – 00:00:05 приложение выдало пакетное задание, которое привело к увеличению числа операций ввода-вывода диска в 10 000 и 300 Мбит/с в течение пяти секунд.
- 00:00:06 – 00:00:10 приложение запустило задание восстановления, которое привело к ускорению операций ввода-вывода диска в 6 000 и 600 Мбит/с в течение пяти секунд.

Пакетная транзакция учитывает максимальное количество транзакций в секунду или Мбит/с. С 00:00:01 – 00:00:05, накопленная транзакция с максимальной обрезкой транзакций ((10 000 – 5 000), (300-200) * 1024/256)) * 5 = 25 000 Transactions. С 00:00:06 – 00:00:10, накопленная транзакция с максимальной обрезкой транзакций ((6 000 – 5 000), (600-200) * 1024/256)) * 5 = 8 000 Transactions. Поверх этого вы включаете фиксированную плату по включению пакетов, чтобы получить общую стоимость включения ускорения использования дисков на основе по требованию. 

Дополнительные сведения о ценах и использовании [калькулятора цен Azure](https://azure.microsoft.com/pricing/calculator/?service=storage) для оценки рабочей нагрузки можно получить на [странице цен на управляемые диски](https://azure.microsoft.com/pricing/details/managed-disks/) . 

### <a name="credit-based-bursting"></a>Разбивка по кредиту

Разбивка по кредиту доступна для размеров дисков P20 и меньше во всех регионах общедоступных, правительственных и китайских облаков Azure. По умолчанию нагрузка на диск включается для всех новых и существующих развертываний поддерживаемых размеров дисков. Для ускорения на уровне виртуальной машины используется балансировка нагрузки на основе кредита.

### <a name="virtual-machine-level-bursting"></a>Пакетная передача на уровне виртуальной машины
Поддержка ускорения на уровне виртуальной машины включена во всех регионах общедоступного облака на основе поддерживаемых размеров: 
- [Серия Lsv2](../articles/virtual-machines/lsv2-series.md)

Кроме того, в западной центральной части США доступно выполнение пакетов на уровне виртуальной машины для следующих поддерживаемых размеров:
- [Серии Dv3 и Dsv3](../articles/virtual-machines/dv3-dsv3-series.md)
- [Серии Ev3 и Esv3](../articles/virtual-machines/ev3-esv3-series.md)

По умолчанию для виртуальных машин, поддерживающих эту возможность, включена разбивка на пакеты.

## <a name="bursting-flow"></a>Поток пакета

Система разбивки по кредиту применяется таким же образом как на уровне виртуальной машины, так и на уровне диска. Ваш ресурс, виртуальная машина или диск, будет начинаться с полностью учтенных кредитов в своем собственном сегменте. Эти кредиты позволяют выполнять пакетную установку до 30 минут с максимальной скоростью пакетов. Вы накапливаете кредиты каждый раз, когда используются операции ввода-вывода ресурса или МБ/с, ниже целевого объекта производительности ресурса. Если в ресурсе есть начисленные кредиты, а для рабочей нагрузки требуется повышенная производительность, ваш ресурс может использовать эти кредиты для достижения более высоких ограничений производительности и повышения производительности в соответствии с потребностями рабочей нагрузки.

![Схема разбивки на сегменты.](media/managed-disks-bursting/bucket-diagram.jpg)

Как вы тратите на ваши кредиты, вы. Вы можете использовать в течение дня 30 минут для кредитов. При развертывании ресурсов они поставляются с полным выделением кредитов. Если они исчерпаны, для их переезда требуется меньше дней. Кредиты могут быть проведены по собственному усмотрению. для разбивки ресурсов на пакетный контейнер не требуется его заполнение. Накопление пакетов зависит от каждого ресурса, так как он основан на неиспользуемых операциях ввода-вывода и МБ/с ниже их целевых показателей производительности. Более высокие базовые показатели производительности могут начислять свои кредиты быстрее, чем понизить производительность базовых ресурсов. Например, диск P1 состояние простоя будет начислять 120 операций ввода-вывода в секунду, в то время как диск P20 состояние простоя будет начислять 2 300 операций ввода-вывода в секунду.

## <a name="bursting-states"></a>Состояния пакетов
Существует три состояния, в которых ресурс может быть включен с поддержкой разбивки:
- **Начисление** — трафик ввода-вывода ресурса использует меньше целевого объекта производительности. Накопление пакетных кредитов для операций ввода-вывода в секунду и МБ/с выполняется отдельно друг от друга. Ваш ресурс может начислять кредиты операций ввода-вывода в секунду и расходов на кредиты (МБ/с) или наоборот.
- **Разбивка** данных — трафик ресурса использует больше целевого объекта производительности. Пакетный трафик будет независимо потреблять кредиты операций ввода-вывода или пропускной способности.
- **Constant** — трафик ресурса в точности соответствует целевому показателю производительности.

## <a name="bursting-examples"></a>Примеры пакетной передачи

В следующих примерах показано, как работает пакетная работа с различными сочетаниями виртуальных машин и дисков. Чтобы сделать примеры простыми, мы будем сосредоточиться на МБ/с, но одна и та же логика применяется независимо к операциям ввода-вывода.

### <a name="non-burstable-virtual-machine-with-burstable-disks"></a>Невиртуализованная виртуальная машина с дисковыми накопителями
**Сочетание виртуальных машин и дисков:** 
- Standard_D8as_v4 
    - Некэшированных МБ/с: 192
- Диск с ОС P4
    - Подготовлено МБ/с: 25
    - Макс. МБ/с: 170 
- Диски данных с 2 P10 
    - Подготовлено МБ/с: 100
    - Макс. МБ/с: 170

 Когда виртуальная машина загрузится, извлекаются данные с диска операционной системы. Так как диск ОС является частью загрузочной виртуальной машины, диск ОС будет заполнен пакетами. Эти кредиты допускают загрузку диска ОС в 170 МБ/с.

![Виртуальная машина отправляет запрос на 192 МБ/с пропускной способности на диск ОС, диск ОС отвечает на данные 170 МБ/с.](media/managed-disks-bursting/nonbursting-vm-bursting-disk/nonbursting-vm-bursting-disk-startup.jpg)

После завершения загрузки приложение запускается на виртуальной машине и имеет некритическую рабочую нагрузку. Для этой рабочей нагрузки требуется 15 МБ/с, равномерно распределенная по всем дискам.

![Приложение отправляет запрос с пропускной способностью 15 МБ/с для виртуальной машины, виртуальная машина принимает запрос и отправляет каждый из своих дисков запрос на 5 МБ/с, каждый диск возвращает 5 МБ/с. Виртуальная машина возвращает значение 15 МБ/с для приложения.](media/managed-disks-bursting/nonbursting-vm-bursting-disk/nonbursting-vm-bursting-disk-idling.jpg)

Затем приложению необходимо обработать пакетное задание, для которого требуется 192 МБ/с. диск операционной системы использует 2 МБ/с, а остальные диски равномерно распределяются между дисками данных.

![Приложение отправляет запрос с пропускной способностью 192 МБ/с для виртуальной машины, виртуальная машина принимает запрос и отправляет пакетную часть своего запроса к дискам данных (95 МБ/с, каждый) и 2 МБ/с на диске операционной системы, диски данных, отвечающие требованию, и все диски возвращают запрошенную пропускную способность виртуальной машине, которая возвращает его приложению.](media/managed-disks-bursting/nonbursting-vm-bursting-disk/nonbursting-vm-bursting-disk-bursting.jpg)

### <a name="burstable-virtual-machine-with-non-burstable-disks"></a>Многоуровневая виртуальная машина с дисками, не поддерживающими разбивку на пакеты
**Сочетание виртуальных машин и дисков:** 
- Standard_L8s_v2 
    - Некэшированных МБ/с: 160
    - Макс. МБ/с: 1 280
- Диск ОС P50
    - Подготовлено МБ/с: 250 
- Диски данных с 2 P10 
    - Подготовлено МБ/с: 250

 После начальной загрузки приложение запускается на виртуальной машине и имеет некритическую рабочую нагрузку. Для этой рабочей нагрузки требуется 30 МБ/с, равномерно распределенная по всем дискам.
![Приложение отправляет запрос на 30 МБ в секунду на виртуальную машину, виртуальная машина принимает запрос и отправляет каждый из своих дисков запрос на 10 МБ/с, каждый диск возвращает 10 МБ/с. Виртуальная машина возвращает 30 МБ/с для приложения.](media/managed-disks-bursting/bursting-vm-nonbursting-disk/burst-vm-nonbursting-disk-normal.jpg)

Затем приложению необходимо обработать пакетное задание, для которого требуется 600 МБ/с. Standard_L8s_v2 выполняет нагрузку в соответствии с этим спросом, а затем запросы к дискам равномерно распределяются по P50 дискам.

![Приложение отправляет запрос с пропускной способностью 600 МБ/с для виртуальной машины, виртуальная машина выполняет запросы и отправляет каждый из его дисков запрос на 200 МБ/с, каждый из которых возвращает значение 200 МБ/с, а также пакеты виртуальных машин, которые возвращают 600 МБ/с для приложения.](media/managed-disks-bursting/bursting-vm-nonbursting-disk/burst-vm-nonbursting-disk-bursting.jpg)
### <a name="burstable-virtual-machine-with-burstable-disks"></a>Пакетная виртуальная машина с жестко дисковыми данными
**Сочетание виртуальных машин и дисков:** 
- Standard_L8s_v2 
    - Некэшированных МБ/с: 160
    - Макс. МБ/с: 1 280
- Диск с ОС P4
    - Подготовлено МБ/с: 25
    - Макс. МБ/с: 170 
- 2 диска данных P4 
    - Подготовлено МБ/с: 25
    - Макс. МБ/с: 170 

При запуске виртуальной машины будет запрашиваться предельное число 1 280 МБ/с с диска операционной системы, а диск операционной системы будет отвечать на запросы с максимальной производительностью 170 МБ/с.

![При запуске виртуальная машина пересылает запрос 1 280 МБ/с на диск операционной системы, а жесткий диск ОС возвращает 1 280 МБ/с.](media/managed-disks-bursting/bursting-vm-bursting-disk/burst-vm-burst-disk-startup.jpg)

После запуска запускается приложение с некритической рабочей нагрузкой. Для этого приложения требуется 15 МБ/с, которые равномерно распределяются по всем дискам.

![Приложение отправляет запрос с пропускной способностью 15 МБ/с для виртуальной машины, виртуальная машина принимает запрос и отправляет каждый из своих дисков запрос на 5 МБ/с, каждый диск возвращает 5 МБ/с. Виртуальная машина возвращает значение 15 МБ/с для приложения.](media/managed-disks-bursting/bursting-vm-bursting-disk/burst-vm-burst-disk-idling.jpg)

Затем приложению необходимо обработать пакетное задание, для которого требуется 360 МБ/с. Standard_L8s_v2 в соответствии с этим спросом, а затем запрашивает. Диску ОС требуются только 20 МБ/с. Оставшиеся 340 МБ/с обрабатываются дисками данных P4.

![Приложение отправляет запрос с пропускной способностью 360 МБ/с для виртуальной машины, виртуальная машина занимает много запросов и отправляет каждый из его дисков данных запрос на 170 МБ/с и 20 МБ/с с диска ОС, каждый диск возвращает запрошенный объем памяти в МБ 360/с.](media/managed-disks-bursting/bursting-vm-bursting-disk/burst-vm-burst-disk-bursting.jpg)
