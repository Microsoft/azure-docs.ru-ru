---
author: v-dalc
ms.service: databox
ms.author: alkohli
ms.topic: include
ms.date: 03/23/2021
ms.openlocfilehash: 34d0d55ba6eb403055be96758b57b7bd0c2ab704
ms.sourcegitcommit: ac035293291c3d2962cee270b33fca3628432fac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2021
ms.locfileid: "104988350"
---
Используйте ответы времени выполнения агента IoT Edge, чтобы устранить ошибки, связанные с вычислением. Ниже перечислены возможные ответы:

* 200 – OK
* 400 — конфигурация развертывания имеет неправильный формат или недопустима.
* 417-у устройства нет набора конфигураций развертывания.
* 412 — версия схемы в конфигурации развертывания недопустима.
* 406 — устройство IoT Edge работает в автономном режиме или не отправляет отчеты о состоянии.
* 500 — в среде выполнения IoT Edge произошла ошибка.

Дополнительные сведения см. в разделе [агент IOT Edge](../articles/iot-edge/iot-edge-runtime.md?preserve-view=true&view=iotedge-2018-06#iot-edge-agent).

Следующая ошибка связана со службой IoT Edge на устройстве Azure Stack ребра Pro.

### <a name="compute-modules-have-unknown-status-and-cant-be-used"></a>Модули вычислений имеют неизвестное состояние и не могут использоваться

#### <a name="error-description"></a>Описание ошибки

Все модули на устройстве отображают неизвестное состояние и не могут использоваться. Неизвестное состояние сохраняется при перезагрузке.<!--Original Support ticket relates to trying to deploy a container app on a Hub. Based on the work item, I assume the error description should not be that specific, and that the error applies to Azure Stack Edge Devices, which is the focus of this troubleshooting.-->

#### <a name="suggested-solution"></a>Предлагаемое решение

Удалите IoT Edgeную службу, а затем повторно разверните модули. Дополнительные сведения см. в разделе [Remove IOT Edge Service](../articles/databox-online/azure-stack-edge-j-series-manage-compute.md#remove-iot-edge-service).


### <a name="modules-show-as-running-but-are-not-working"></a>Модули отображаются как выполняющиеся, но не работают

#### <a name="error-description"></a>Описание ошибки

Состояние выполнения модуля отображается как выполняемое, но ожидаемые результаты не видны. 

Это может быть вызвано проблемой с неработающей конфигурацией маршрута модуля или `edgehub` маршрутизацией сообщений, как ожидалось. Журналы можно проверить `edgehub` . Если вы видите ошибки, такие как сбой подключения к службе центра Интернета вещей, то наиболее распространенной причиной являются проблемы с подключением. Проблемы с подключением могут быть вызваны тем, что порт AMPQ, используемый в качестве порта по умолчанию службой центра Интернета вещей для обмена данными, заблокирован или сервер веб-прокси блокирует эти сообщения.

#### <a name="suggested-solution"></a>Предлагаемое решение

Выполните следующие шаги.
1. Чтобы устранить эту ошибку, перейдите к ресурсу центра Интернета вещей для своего устройства, а затем выберите свое пограничное устройство. 
1. Перейдите к разделу **Set modules > Settings среды выполнения**. 
1. Добавьте `Upstream protocol` переменную среды и присвойте ей значение `AMQPWS` . Сообщения, настроенные в этом случае, отправляются через WebSocket через порт 443.

### <a name="modules-show-as-running-but-do-not-have-an-ip-assigned"></a>Модули отображаются как работающие, но не назначены IP-адреса

#### <a name="error-description"></a>Описание ошибки

Состояние выполнения модуля отображается как выполняемое, но контейнерное приложение не имеет назначенного IP-адреса. 

Это происходит потому, что диапазон IP-адресов, которые вы указали для адресов внешней службы Kubernetes, недостаточно. Необходимо расширить этот диапазон, чтобы убедиться в том, что развернут каждый контейнер или виртуальная машина, которые вы развернули.

#### <a name="suggested-solution"></a>Предлагаемое решение

В локальном веб-ИНТЕРФЕЙСе устройства выполните следующие действия.
1. Перейдите на страницу " **Вычисление** ". Выберите порт, для которого вы включили расчетную сеть. 
1. Введите статический, непрерывный диапазон IP-адресов для **IP-адресов внешней службы Kubernetes**. Для службы требуется 1 IP-адрес `edgehub` . Кроме того, необходим один IP-адрес для каждого модуля IoT Edge и для каждой виртуальной машины, которую вы будете развертывать. 
1. Нажмите кнопку **Применить**. Измененный диапазон IP-адресов должен вступить в силу немедленно.

Дополнительные сведения см. в разделе [изменение IP-адресов внешней службы для контейнеров](../articles/databox-online/azure-stack-edge-j-series-manage-compute.md#change-external-service-ips-for-containers).

### <a name="configure-static-ips-for-iot-edge-modules"></a>Настройка статических IP-адресов для модулей IoT Edge

#### <a name="problem-description"></a>Описание проблемы

Kubernetes назначает динамические IP-адреса каждому модулю IoT Edge на устройстве Azure Stack ребра Pro GPU. Метод необходим для настройки статических IP-адресов для модулей.

#### <a name="suggested-solution"></a>Предлагаемое решение

Вы можете указать фиксированные IP-адреса для модулей IoT Edge с помощью K8s-экспериментального раздела, как описано ниже. 

```yaml
{
  "k8s-experimental": {
    "serviceOptions" : {
      "loadBalancerIP" : "100.23.201.78",
      "type" : "LoadBalancer"
    }
  }
}
```
### <a name="expose-kubernetes-service-as-cluster-ip-service-for-internal-communication"></a>Предоставление службы Kubernetes в качестве IP-службы кластера для внутренней связи

#### <a name="problem-description"></a>Описание проблемы

По умолчанию служба IoT имеет тип подсистемы балансировки нагрузки и назначила внешние IP-адреса. Возможно, вам не нужен внешний IP-адрес для вашего приложения. Возможно, потребуется предоставить доступ к модулям Pod в кластере KUbernetes для доступа в качестве других модулей, а не в качестве внешней службы балансировщика нагрузки. 

#### <a name="suggested-solution"></a>Предлагаемое решение

Параметры Create можно использовать в разделе K8s-экспериментальный. Следующий параметр службы должен работать с привязками портов.

```yaml
{
"k8s-experimental": {
  "serviceOptions" : {
    "type" : "ClusterIP"
    }
  }
}
```
