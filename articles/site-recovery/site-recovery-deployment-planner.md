---
title: Планировщик развертывания Azure Site Recovery аварийного восстановления VMware
description: Сведения о Планировщике развертывания Azure Site Recovery для аварийного восстановления виртуальных машин VMware в Azure.
author: mayurigupta13
manager: rochakm
ms.service: site-recovery
ms.topic: conceptual
ms.date: 03/13/2020
ms.author: mayg
ms.openlocfilehash: 4291e8438f70e2e7190cd4dc6c890b5b325f2324
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100360913"
---
# <a name="about-the-azure-site-recovery-deployment-planner-for-vmware-to-azure"></a>О Планировщике развертывания Azure Site Recovery для восстановления виртуальных машин VMware в Azure
В этой статье приведены рекомендации по использованию планировщика развертывания Azure Site Recovery в сценариях рабочих развертываний виртуальных машин VMware в Azure.

## <a name="overview"></a>Обзор

Перед установкой защиты виртуальных машин VMware с помощью Azure Site Recovery выделите достаточный объем пропускной способности в зависимости от частоты ежедневного изменения данных в соответствии с требуемой целевой точкой восстановления (RPO). В локальной среде необходимо развернуть нужное число серверов конфигурации и обработки.

Кроме того, необходимо создать требуемое количество целевых учетных записей хранения Azure соответствующего типа. (класса Standard или Premium), учитывая рост нагрузки на исходные рабочие серверы из-за более активного их использования в будущем. Тип хранилища определяется для каждой виртуальной машины на основе особенностей рабочей нагрузки (количества операций записи и чтения на диск в секунду [IOPS], активности обработки данных) и ограничений Site Recovery.

 Планировщик развертывания Site Recovery — это программа командной строки для сценариев аварийного восстановления виртуальных машин Hyper-V в Azure и VMware в Azure. Эта программа позволяет выполнить удаленное профилирование виртуальных машин VMware (никоим образом не влияя на рабочий процесс), чтобы оценить требования к пропускной способности и службе хранилища для успешной репликации и отработки отказа. Вы можете запустить эту программу, не устанавливая в локальной среде каких-либо дополнительных компонентов Site Recovery. Чтобы получить более точные сведения о пропускной способности, запустите планировщик ресурсов на виртуальной машине Windows Server, соответствующей минимальным требованиям сервера конфигурации Site Recovery, который в конечном итоге потребуется развернуть на одном из первых этапов рабочего развертывания.

Эта программа предоставляет указанные ниже сведения.

**Оценка совместимости**

* Оценка соответствия виртуальной машины требованиям в зависимости от количества дисков, их размера, числа операций ввода-вывода в секунду, активности обработки данных, типа загрузки (EFI/BIOS) и версии ОС.

**Оценка пропускной способности сети и RPO.**

* Расчетное значение пропускной способности, необходимой для разностной репликации.
* Пропускная способность, которую может получить Site Recovery при репликации данных из локальной среды в Azure.
* Количество виртуальных машин, которое можно включить в пакет, на основе расчетного значения пропускной способности для завершения начальной репликации в указанный промежуток времени.
* Целевая точка восстановления, которая может быть достигнута при указанной пропускной способности.
* Влияние низкой пропускной способности на требуемую целевую точку восстановления.

**Требования к инфраструктуре Azure.**

* Требования к типу хранилища (хранилище уровня "Стандартный" или "Премиум") для каждой виртуальной машины
* Общее число учетных записей хранения уровня "Стандартный" и "Премиум", которые должны быть настроены для репликации (включая учетные записи хранения кэша).
* Именование учетных записей хранения в соответствии с рекомендациями к службе хранилища.
* Число ядер Azure, которое необходимо настроить перед отработкой отказа или тестовой отработкой отказа, на подписку.
* Рекомендуемый размер виртуальной машины Azure для каждой локальной виртуальной машины.

**Требования к локальной инфраструктуре.**
* Необходимое число серверов конфигурации и серверов обработки, которое необходимо развернуть в локальной среде.

**Предполагаемые затраты на аварийное восстановление в Azure**
* Оценочные общие затраты на аварийное восстановление в Azure: затраты на вычисление, хранение, сети и лицензии Site Recovery.
* подробный анализ затрат для каждой виртуальной машины.


>[!IMPORTANT]
>
>При выполнении вычислений в программе использовался 30%-ный коэффициент роста характеристик рабочей нагрузки (из-за возможного роста использования со временем), а также 95-й процентиль всех метрик профилирования (число операций записи и чтения в секунду, активность обработки данных и обновление). Коэффициент роста и используемый процентиль можно изменить. Дополнительные сведения о коэффициенте роста и используемом процентиле см. в разделе "Рекомендации по коэффициенту роста" Дополнительные сведения о значении процентиля см. в разделе "Значение процентиля, используемое для вычисления".
>

## <a name="support-matrix"></a>Матрица поддержки

| **Категория** | **VMware в VMware** |**Hyper-V в Azure**|**Из Azure в Azure**|**Из Hyper-V на дополнительный сайт**|**Из VMware на дополнительный сайт**
--|--|--|--|--|--
Поддерживаемые сценарии |Да|Да|Нет|Да*|Нет
Поддерживаемая версия | vCenter 7,0, 6,7, 6,5, 6,0 или 5,5| Windows Server 2016, Windows Server 2012 R2 | Н/Д |Windows Server 2016, Windows Server 2012 R2|Н/Д
Поддерживаемая конфигурация|vCenter, ESXi| Кластер Hyper-V, узел Hyper-V|Н/Д|Кластер Hyper-V, узел Hyper-V|Н/Д|
Число серверов, которые можно профилировать для каждого запущенного экземпляра планировщика развертывания Site Recovery. |Один (одновременно можно профилировать виртуальные машины на одном сервере vCenter Server или ESXi)|Несколько (одновременно можно профилировать виртуальные машины на нескольких узлах или кластерах узлов)| Н/Д |Несколько (одновременно можно профилировать виртуальные машины на нескольких узлах или кластерах узлов)| Н/Д

*Это средство в первую очередь предназначено для сценария аварийного восстановления виртуальных машин Hyper-V в Azure. При аварийном восстановлении виртуальных машин Hyper-V на вторичный сайт это средство может использоваться только для того, чтобы получить рекомендации на стороне источника, такие как необходимая пропускная способность сети, требуемое свободное место на каждом исходном сервере Hyper-V, а также количество необходимых операций пакетной обработки и определения пакетов для начальной репликации. Пропустите рекомендации и сведения о затратах на Azure в отчете. Кроме того, операция оценки пропускной способности не применяется в сценариях аварийного восстановления виртуальных машин Hyper-V на вторичный сайт.

## <a name="prerequisites"></a>Предварительные условия
Программа выполняет два основных действия: осуществляет профилирование и создает отчет. С ее помощью также можно оценить пропускную способность. В таблице ниже приведены требования к серверу, на котором инициируется профилирование и измерение пропускной способности.

| Требование к серверу | Описание|
|---|---|
|Профилирование и измерение пропускной способности| <ul><li>Операционная система: Windows Server 2016 или Windows Server 2012 R2.<br>(в идеале соответствует [рекомендациям по размеру сервера конфигурации](/en-in/azure/site-recovery/site-recovery-plan-capacity-vmware#size-recommendations-for-the-configuration-server)).</li><li>Конфигурация виртуальной машины: 8 виртуальных ЦП, 16 ГБ ОЗУ, жесткий диск емкостью 300 ГБ.</li><li>[.NET Framework 4.5](https://aka.ms/dotnet-framework-45)</li><li>[VMware vSphere PowerCLI 6.0 R3](https://aka.ms/download_powercli).</li><li>[Распространяемый компонент Visual C++ для Visual Studio 2012](https://aka.ms/vcplusplus-redistributable).</li><li>Доступ в Интернет к Azure (*. blob.core.windows.net) с этого сервера, порт 443<br>[Это необязательно. Вы можете указать доступную пропускную способность во время создания отчета вручную.]</li><li>Учетная запись хранения Azure.</li><li>Права администратора на доступ к серверу.</li><li>Минимальное свободное место на диске: 100 ГБ (предполагается, что профилирование 1,000 виртуальных машин в среднем с 3 дисками на каждую выполняется 30 дней).</li><li>Параметрам уровня статистики vCenter VMware можно присвоить значение 1 или выше.</li><li>Разрешение порта vCenter (по умолчанию 443). Планировщик развертывания Site Recovery использует этот порт для подключения к серверу vCenter или к хосту ESXi.</ul></ul>|
| Создание отчетов. | Компьютер, поддерживающий Windows или Windows Server с Excel 2013 или более поздней версии.<li>[.NET Framework 4.5](https://aka.ms/dotnet-framework-45)</li><li>[Распространяемый компонент Visual C++ для Visual Studio 2012](https://aka.ms/vcplusplus-redistributable).</li><li>[VMware vSphere PowerCLI 6.0 R3](https://aka.ms/download_powercli) необходим только при передаче параметра пользователя в команде генерации отчета для получения последней информации о конфигурации для виртуальных машин. Планировщик развертывания подключается к серверу vCenter. Разрешите порту vCenter (по умолчанию 443) подключиться к серверу vCenter.</li>|
| Разрешения пользователя | Разрешение только на чтение для учетной записи пользователя, используемой для доступа к серверу VMware vCenter Server или узлу VMware vSphere ESXi во время профилирования. |

> [!NOTE]
>
>Эта программа позволяет профилировать только виртуальные машины с дисками VMDK и RDM и не поддерживает диски iSCSI или NFS. Site Recovery поддерживает диски iSCSI и NFS для серверов VMware. Однако так как планировщик ресурсов запущен не в гостевой ОС и выполняет профилирование только на основе показателей счетчиков производительности vCenter, он не видит диски этого типа.
>

## <a name="download-and-extract-the-deployment-planner-tool"></a>Скачивание и извлечение планировщика развертывания
1. Скачайте последнюю версию [планировщика ресурсов Site Recovery](https://aka.ms/asr-deployment-planner).
Эта программа упакована в формате ZIP. Текущая ее версия поддерживает только сценарии развертывания виртуальных машин VMware в Azure.

2. Скопируйте ZIP-папку на сервер Windows Server, на котором необходимо запустить программу.
Вы можете запустить планировщик на любом сервере Windows Server 2012 R2, имеющем сетевой доступ к vCenter Server или узлу vSphere ESXi, в котором содержатся виртуальные машины, профилирование которых необходимо выполнить. Но мы советуем запускать эту программу на сервере, конфигурация оборудования которого соответствует [рекомендациям по размеру сервера конфигурации](/en-in/azure/site-recovery/site-recovery-plan-capacity-vmware#size-recommendations-for-the-configuration-server). Если вы уже развернули компоненты Site Recovery в локальной среде, запустите программу на сервере конфигурации.

    При одинаковых конфигурациях оборудования сервера, рекомендуемого для запуска программы, и сервера конфигурации (со встроенным сервером обработки) пропускная способность, сведения о которой получены с помощью планировщика, будет соответствовать фактической пропускной способности, которой Site Recovery может добиться во время репликации. Значение пропускной способности зависит от доступной пропускной способности сети и конфигурации оборудования сервера (например, ЦП и хранилище). При запуске программы на другом сервере пропускная способность вычисляется при передаче из этого сервера в Azure. Кроме того, конфигурация оборудования на этом сервере и на сервере конфигурации может отличаться. И поэтому значение достигаемой пропускной способности, полученное с помощью этой программы, будет неточным.

3. Распакуйте ZIP-папку.
Папка содержит несколько файлов и вложенных папок. Исполняемый файл ASRDeploymentPlanner.exe находится в родительской папке.

    Пример. Скопируйте ZIP-файл в папку E:\ drive и распакуйте его.
    E:\ASR Deployment Planner_v2.3.zip

    E:\ASR Deployment Planner_v2.3\ASRDeploymentPlanner.exe

### <a name="update-to-the-latest-version-of-deployment-planner"></a>Обновление планировщика развертывания до последней версии

Последние обновления приведены в [журнале версий](site-recovery-deployment-planner-history.md)планировщик развертывания.

Если установлена предыдущая версия планировщика развертывания, выполните одно из следующих действий.
 * Если в последней версии нет исправления профилирования и оно уже выполняется, вам не нужно останавливать его.
 * Если в последней версии есть исправления профилирования, мы рекомендуем остановить профилирование, выполняемое в текущей версии, и запустить его с использованием новой версии.


 >[!NOTE]
 >
 >При запуске профилирования с использованием новой версии передайте тот же путь к выходному каталогу, который будет использоваться средством для добавления данных профиля в существующие файлы. При создании отчетов используется полный набор данных профилирования. Если передать разные выходные каталоги, то создадутся файлы, а старые данные профилирования нельзя будет использовать при создании отчета.
 >
 >Каждое обновление версии планировщика ресурсов с использованием ZIP-файла является накопительным. Не нужно копировать файлы новой версии в папку со старой версией. Вы можете создать и использовать папку.


## <a name="version-history"></a>Журнал версий
Последняя версия средства Планировщик развертывания Site Recovery — 2,5.
Описание исправлений, добавляемых при каждом обновлении, см. на странице [журнала версий планировщика развертывания Site Recovery](./site-recovery-deployment-planner-history.md).

## <a name="next-steps"></a>Дальнейшие действия
[Запуск планировщика развертывания Azure Site Recovery для сценариев развертывания виртуальных машин VMware в Azure](site-recovery-vmware-deployment-planner-run.md)
