---
title: Рекомендации по выполнению длительных операций в Azure Analysis Services | Документация Майкрософт
description: В этой статье описываются рекомендации по выполнению длительных операций.
author: minewiskan
ms.service: azure-analysis-services
ms.topic: conceptual
ms.date: 04/14/2020
ms.author: owend
ms.openlocfilehash: 4e069effae0cb7f834b2c3dac696d05304d841a7
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92014840"
---
# <a name="best-practices-for-long-running-operations"></a>Рекомендации по выполнению длительных операций

В Azure Analysis Services *узел* представляет виртуальную машину узла, в которой выполняется серверный ресурс. Некоторые операции, такие как длительные запросы, операции обновления и масштабируемая синхронизация запросов, могут завершиться ошибкой, если ресурс сервера перемещается на другой узел. Распространенные сообщения об ошибках в этом сценарии:

- "При попытке нахождение долго выполняющегося запроса XMLA произошла ошибка. Возможно, запрос был прерван при обновлении службы или перезапуске сервера ".
- "Задание с ИДЕНТИФИКАТОРом" <guid> для модели " <database> " было отменено из-за ошибки службы (неактивности) с сообщением "Отмена запроса на обновление, так как он был задержан без каких-либо обновлений. Это внутренняя проблема со службой. Отправьте задание или файл с билетом, чтобы получить справку, если проблема возникает повторно. "

Существует множество причин, по которым долго выполняющиеся операции могут быть нарушены. Например, обновления в Azure, например: 
- Исправления операционной системы 
- Обновления для системы безопасности
- Обновления службы Azure Analysis Services
- Service Fabric обновления. Service Fabric — это компонент платформы, используемый несколькими облачными службами Майкрософт, включая Azure Analysis Services.

Помимо обновлений, происходящих в службе, существует естественное перемещение служб между узлами из-за балансировки нагрузки. Перемещения узлов — это ожидаемая часть облачной службы. Azure Analysis Services пытается свести к минимальным последствиям перемещения узлов, но невозможно полностью устранить их. 

Помимо перемещений между узлами, могут возникнуть и другие сбои. Например, система базы данных источника данных может находиться в режиме «вне сети» или «сетевое подключение потеряно». Если во время обновления секция содержит 10 000 000 строк, а в строке 9 миллионов возникает ошибка, то перезапустить обновление на момент сбоя невозможно. Служба должна запуститься снова с самого начала. 

## <a name="refresh-rest-api"></a>Обновить REST API

Перерывы в работе служб могут быть проблематичными для длительных операций, таких как обновление данных. Azure Analysis Services содержит REST API, помогающий снизить негативное влияние на перерывы в работе службы. Дополнительные сведения см. в разделе [асинхронное обновление с помощью REST API](analysis-services-async-refresh.md).
 
Помимо REST API есть и другие подходы, которые можно использовать для снижения числа потенциальных проблем во время длительных операций обновления. Основная цель состоит в том, чтобы не пришлось перезапускать операцию обновления с самого начала, а выполнять обновление в небольших пакетах, которые можно зафиксировать поэтапно. 
 
REST API допускает такую перезагрузку, но не позволяет полностью гибко создавать и удалять секции. Если для сценария требуются сложные операции управления данными, решение должно включать в себя некоторую форму пакетной обработки в своей логике. Например, использование транзакций для обработки данных в нескольких пакетах позволяет не запрашивать перезагрузку с самого начала, а из промежуточной контрольной точки. 
 
## <a name="scale-out-query-replicas"></a>Масштабируемые реплики запросов

Независимо от того, используется ли пользовательская или настраиваемая логика, запросы клиентских приложений могут возвращать непоследовательные или промежуточные результаты во время обработки пакетов. Если в процессе обработки требуются последовательные данные, возвращаемые запросами клиентских приложений, а данные модели находятся в промежуточном состоянии, можно использовать [горизонтальное масштабирование](analysis-services-scale-out.md) с репликами запросов только для чтения.

Используя реплики запросов только для чтения, а обновления выполняются в пакетах, пользователи клиентских приложений могут продолжать запрашивать старый моментальный снимок данных в репликах только для чтения. После завершения обновления можно выполнить операцию синхронизации, чтобы перевести реплики, доступные только для чтения, в актуальное состоянии.


## <a name="next-steps"></a>Дальнейшие действия

[Asynchronous refresh with the REST API](analysis-services-async-refresh.md) (Асинхронное обновление с помощью REST API)  
[Azure Analysis Services scale-out](analysis-services-scale-out.md) (Горизонтальное масштабирование служб Azure Analysis Services)  
[Высокая доступность служб Analysis Services](analysis-services-bcdr.md)  
[Руководство по повторным попыткам для служб Azure](/azure/architecture/best-practices/retry-service-specific)