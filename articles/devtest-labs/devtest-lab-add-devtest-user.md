---
title: Добавление владельцев и пользователей в Azure DevTest Labs | Документация Майкрософт
description: Сведения о добавлении владельцев и пользователей в Azure DevTest Labs с помощью портала Azure или PowerShell
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: 2ca6a1ffa66ab294e34a1b4866953a393aba4d6d
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97511983"
---
# <a name="add-owners-and-users-in-azure-devtest-labs"></a>Добавление владельцев и пользователей в Azure DevTest Labs
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/How-to-set-security-in-your-DevTest-Lab/player]
> 
> 

Доступ в Azure DevTest Labs контролируется с помощью [управления доступом на основе ролей Azure (Azure RBAC)](../role-based-access-control/overview.md). С помощью Azure RBAC вы можете разделить обязанности внутри группы на *роли* , в которых вы предоставляете только необходимый объем доступа пользователям для выполнения своих заданий. Три из этих ролей Azure — *владелец*, *пользователь DevTest Labs* и *участник*. В этой статье вы узнаете, какие действия можно выполнить в каждой из трех основных ролей Azure. Здесь также приведены сведения о том, как добавлять пользователей в лабораторию (с использованием портала или сценария PowerShell) и как добавлять пользователей на уровне подписки.

## <a name="actions-that-can-be-performed-in-each-role"></a>Действия, которые можно выполнять в каждой роли
Пользователю можно назначить одну из трех основных ролей:

* Владелец
* Пользователь DevTest Labs
* Участник

В следующей таблице представлены действия, которые могут выполнять пользователи с каждой из этих ролей.

| **Действия, которые могут выполнять пользователи с этой ролью** | **Пользователь DevTest Labs** | **Владелец** | **Участник** |
| --- | --- | --- | --- |
| **Задачи лаборатории** | | | |
| Добавление пользователей в лабораторию |Нет |Да |Нет |
| Обновление параметров стоимости |Нет |Да |Да |
| **Базовые задачи виртуальных машин** | | | |
| Добавление и удаление пользовательских образов |Нет |Да |Да |
| Добавление, обновление и удаление формул |Да |Да |Да |
| Включение образов Marketplace |Нет |Да |Да |
| **Задачи виртуальных машин** | | | |
| Создание виртуальных машин |Да |Да |Да |
| Запуск, остановка и удаление виртуальных машин |Только виртуальные машины, созданные пользователем |Да |Да |
| Обновление политик виртуальных машин |Нет |Да |Да |
| Добавление и удаление дисков данных виртуальных машин |Только виртуальные машины, созданные пользователем |Да |Да |
| **Задачи артефактов** | | | |
| Добавление и удаление репозиториев артефактов |Нет |Да |Да |
| Применение артефактов |Да |Да |Да |

> [!NOTE]
> Когда пользователь создает виртуальную машину, ему автоматически назначается роль **Владелец** для этой виртуальной машины.
> 
> 

## <a name="add-an-owner-or-user-at-the-lab-level"></a>Добавление владельца или пользователя на уровне лаборатории
Владельцев и пользователей можно добавлять на уровне лаборатории с помощью портала Azure. Можно добавить внешнего пользователя с допустимой [учетной записью Майкрософт (MSA)](devtest-lab-faq.md#what-is-a-microsoft-account).
Ниже описана процедура добавления владельца или пользователя в лабораторию в Azure DevTest Labs.

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Выберите **все службы**, а затем в списке выберите **DevTest Labs** .
3. Из списка лабораторий выберите нужную лабораторию.
4. В колонке лаборатории выберите **Конфигурация и политики**. 
5. На странице **Configuration and Policies** (Конфигурация и политики) выберите **Управление доступом (IAM)** в меню слева. 
6. Щелкните **Добавить назначение ролей** на панели инструментов, чтобы добавить пользователя в роль.
1. На странице **Добавление разрешений** выполните следующие действия: 
    1. Выберите роль (например, пользователь DevTest Labs). В разделе [Действия, которые можно выполнять в каждой роли](#actions-that-can-be-performed-in-each-role) перечислены различные действия, которые могут выполнять пользователи с ролью владельца, пользователя DevTest или участника.
    2. Выберите пользователя для добавления в роль. 
    3. Щелкните **Сохранить**. 
11. Вернувшись в колонку **Пользователи** , вы увидите, что пользователь добавлен.  

## <a name="add-an-external-user-to-a-lab-using-powershell"></a>Добавление внешнего пользователя в лабораторию с помощью PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

Помимо добавления пользователей на портале Azure, вы можете добавить внешнего пользователя в лабораторию с помощью сценария PowerShell. В следующем примере измените значения параметров под комментарием **Values to change** (Изменяемые значения).
Вы можете узнать значения `subscriptionId`, `labResourceGroup` и `labName` в колонке лаборатории на портале Azure.

> [!NOTE]
> В примере сценария предполагается, что указанный пользователь добавлен в Active Directory в качестве гостя. Если это не так, сценарий завершится ошибкой. Чтобы добавить в лабораторию пользователя, которого нет в Active Directory, используйте для назначения роли пользователю портал Azure, как показано в разделе [Добавление владельца или пользователя на уровне лаборатории](#add-an-owner-or-user-at-the-lab-level).   
> 
> 

```azurepowershell
# Add an external user in DevTest Labs user role to a lab
# Ensure that guest users can be added to the Azure Active directory:
# https://azure.microsoft.com/documentation/articles/active-directory-create-users/#set-guest-user-access-policies

# Values to change
$subscriptionId = "<Enter Azure subscription ID here>"
$labResourceGroup = "<Enter lab's resource name here>"
$labName = "<Enter lab name here>"
$userDisplayName = "<Enter user's display name here>"

# Log into your Azure account
Connect-AzAccount

# Select the Azure subscription that contains the lab. 
# This step is optional if you have only one subscription.
Select-AzSubscription -SubscriptionId $subscriptionId

# Retrieve the user object
$adObject = Get-AzADUser -SearchString $userDisplayName

# Create the role assignment. 
$labId = ('subscriptions/' + $subscriptionId + '/resourceGroups/' + $labResourceGroup + '/providers/Microsoft.DevTestLab/labs/' + $labName)
New-AzRoleAssignment -ObjectId $adObject.Id -RoleDefinitionName 'DevTest Labs User' -Scope $labId
```

## <a name="add-an-owner-or-user-at-the-subscription-level"></a>Добавление владельца или пользователя на уровне подписки
Разрешения Azure распространяются от родительской области к дочерней. Таким образом, владельцы подписки Azure, содержащей лаборатории, автоматически являются владельцами этих лабораторий. Они также являются владельцами виртуальных машин и других ресурсов, созданных пользователями лаборатории и службой Azure DevTest Labs. 

Дополнительных владельцев можно добавлять через колонку лаборатории на [портале Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040). Тем не менее область их администрирования будет более узкой, чем у владельцев подписки. У них, к примеру, не будет полного доступа к некоторым ресурсам, которые создаются в подписке службой DevTest Labs. 

Чтобы добавить владельца подписки Azure, сделайте следующее:

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы**, а затем в списке выберите **Подписки**.
3. Выберите нужную подписку.
4. Щелкните значок **Доступ** . 
   
    ![Доступ к пользователям](./media/devtest-lab-add-devtest-user/access-users.png)
5. В колонке **Пользователи** выберите **Добавить**.
   
    ![Добавление пользователя](./media/devtest-lab-add-devtest-user/devtest-users-blade.png)
6. В колонке **Выберите роль** щелкните **Владелец**.
7. В колонке **Добавление пользователей** введите адрес электронной почты или имя пользователя, которому нужно назначить роль владельца. Если пользователь не найден, система выдаст соответствующее сообщение об ошибке. Если пользователь найден, он появится в текстовом поле **Пользователи** .
8. Выберите имя найденного пользователя.
9. Щелкните **Выбрать**.
10. Нажмите кнопку **ОК**, чтобы закрыть колонку **Добавить доступ**.
11. Вернувшись в колонку **Пользователи** , вы увидите, что пользователь добавлен как владелец. Теперь он является владельцем любых лабораторий, созданных в этой подписке, а значит может выполнять задачи пользователя. 

[!INCLUDE [devtest-lab-try-it-out](../../includes/devtest-lab-try-it-out.md)]
