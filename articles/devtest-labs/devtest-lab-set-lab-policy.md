---
title: Управление политиками лаборатории в Azure DevTest Labs | Документация Майкрософт
description: Узнайте, как определить политики лаборатории, такие как размеры виртуальных машин, максимальное количество виртуальных машин для каждого пользователя и автоматизация завершения работы.
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: a7ada980b2a251b8164f2e1a20f65da54c89ba72
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "90530358"
---
# <a name="manage-all-policies-for-a-lab-in-azure-devtest-labs"></a>Управление всеми политиками лаборатории в Azure DevTest Labs

Azure DevTest Labs позволяет контролировать расходы и оптимизировать использование ресурсов в лабораториях с помощью управления политиками (параметрами) для каждой лаборатории. В этой статье описываются пошаговые действия по настройке каждой политики.  

## <a name="set-allowed-virtual-machine-sizes"></a>Настройка допустимых размеров виртуальных машин
Политика для настройки допустимых размеров виртуальных машин помогает сократить издержки, позволяя указывать, какие размеры виртуальных машин допускаются в лаборатории. Если эта политика включена, для создания виртуальных машин можно использовать размеры виртуальных машин только из этого списка.

1. На [портале Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040) выберите лабораторию, а затем выберите **Конфигурация и политики**.

    ![Открытие области "Конфигурация и политики" лаборатории](./media/devtest-lab-set-lab-policy/policies-menu.png)

1. В области **Конфигурация и политики** лаборатории выберите **Allowed virtual machines sizes** (Допустимые размеры виртуальных машин).
   
    ![Allowed virtual machines sizes](./media/devtest-lab-set-lab-policy/allowed-vm-sizes.png)

1. Щелкните **On** (Вкл.), чтобы включить эту политику, или **Off** (Выкл.), чтобы отключить ее.

1. Если эта политика включена, выберите один или несколько размеров виртуальных машин, которые могут быть созданы в лаборатории.

1. Щелкните **Сохранить**.

## <a name="set-virtual-machines-per-user"></a>Настройка количества виртуальных машин на пользователя
Политика для **Виртуальных машин на пользователя** позволяет указать число виртуальных машин, которые может создать отдельный пользователь. Если пользователь пытается создать или запросить виртуальную машину в случае достижения ограничения для пользователя, то выводится сообщение об ошибке, информирующее о невозможности создания или запроса виртуальной машины. 

1. В области **Конфигурация и политики** лаборатории выберите **Виртуальных машин на пользователя**.
   
    ![Virtual machines per user](./media/devtest-lab-set-lab-policy/max-vms-per-user.png)

1. Выберите **Да**, чтобы ограничить количество виртуальных машин на пользователя. Если вы не хотите ограничивать это количество, то выберите **Нет**. Если вы выбрали **Да**, то введите количество виртуальных машин, которые может создать или запросить пользователь. 

1. Выберите **Да**, чтобы ограничить количество виртуальных машин, которые могут использовать твердотельный накопитель (SSD). Если вы не хотите ограничивать это количество, то выберите **Нет**. Если вы выбрали **Да**, то введите количество виртуальных машин, которые можно создать с помощью SSD. 

1. Щелкните **Сохранить**.

## <a name="set-virtual-machines-per-lab"></a>Настройка количества виртуальных машин на лабораторию
Политика для **Виртуальных машин на лабораторию** позволяет указать число виртуальных машин, которые можно создать для текущей лаборатории. Если пользователь пытается создать виртуальную машину в случае достижения ограничения для лаборатории, то выводится сообщение об ошибке, информирующее о невозможности создания виртуальной машины. 

1. В области **Конфигурация и политики** лаборатории выберите **Виртуальных машин на лабораторию**.
   
    ![Virtual machines per lab](./media/devtest-lab-set-lab-policy/max-vms-per-lab.png)

1. Выберите **Да**, чтобы ограничить количество виртуальных машин на лабораторию. Если вы не хотите ограничивать это количество, то выберите **Нет**. Если вы выбрали **Да**, то введите количество виртуальных машин, которые может создать или запросить пользователь. 

1. Выберите **Да**, чтобы ограничить количество виртуальных машин, которые могут использовать твердотельный накопитель (SSD). Если вы не хотите ограничивать это количество, то выберите **Нет**. Если вы выбрали **Да**, то введите количество виртуальных машин, которые можно создать с помощью SSD. 

1. Щелкните **Сохранить**.

## <a name="set-auto-shutdown"></a>Задание автоматического завершения работы
Политика автоматического завершения работы помогает сократить издержки, позволяя указать время завершения работы виртуальных машин в этой лаборатории.

1. В области **Конфигурация и политики** лаборатории выберите **Автозавершение работы**.
   
    ![Автоматическое завершение работы](./media/devtest-lab-set-lab-policy/auto-shutdown.png)

1. Щелкните **On** (Вкл.), чтобы включить эту политику, или **Off** (Выкл.), чтобы отключить ее.

1. Если эта политика включена, то укажите время (и часовой пояс) завершения работы всех виртуальных машин в текущей лаборатории.

1. Укажите значение **Да** или **Нет** для параметра отправки уведомления за 15 минут до времени автоматического завершения работы. Выбрав **Да**, укажите конечную точку в виде URL-адреса веб-перехватчика, где будут публиковаться уведомления, или адрес электронной почты, на который будут отправляться такие уведомления. При получении уведомления пользователь получает возможность отложить завершение работы.

   Дополнительные сведения об объектах webhook см. в статье [Создание функции Azure объекта webhook или API](../azure-functions/functions-bindings-http-webhook.md). 

1. Щелкните **Сохранить**.

По умолчанию после включения эта политика применяется ко всем виртуальным машинам в текущей лаборатории. Чтобы удалить этот параметр из конкретной виртуальной машины, откройте область управления виртуальной машины и измените значение параметра **Автозавершение работы**.

## <a name="set-auto-shutdown-policy"></a>Задание политики автоматического завершения работы
Владелец лаборатории может настроить расписание завершения работы всех виртуальных машин в лаборатории. Таким образом, вы сможете сэкономить на работе компьютеров, которые не используются (в режиме простоя). Вы можете применять политику завершения работы ко всем виртуальным машинам в лаборатории централизованно, а также сократить трудозатраты ваших пользователей лаборатории, настроив расписания их индивидуальных компьютеров. Эта функция позволяет задать политику при запуске расписания лаборатории для ваших пользователей: от предложения без управления до предложения с полным управлением. В качестве владельца лаборатории, вы можете настроить эту политику, выполнив следующие действия:

1. На домашней странице лаборатории выберите функцию **Конфигурация и политики**.
2. Выберите **Политика автоматического завершения работы** в разделе **Расписания** меню слева.
3. Выберите один из способов. Следующие разделы содержат дополнительные сведения об этих вариантах. Задание политики применяется только к новым виртуальным машинам, созданным в лаборатории, но не к уже созданным виртуальным машинам. 

    ![Варианты политики автоматического завершения работы](./media/devtest-lab-set-lab-policy/auto-shutdown-policy-options.png)

### <a name="user-sets-a-schedule-and-can-opt-out"></a>Пользователь задает расписание и может отказаться от него
Если задать лаборатории эту политику, пользователи лаборатории могут переопределить или отказаться от расписания лаборатории. Этот параметр предоставляет пользователям лаборатории полный контроль над расписанием автоматического завершения работы своих виртуальных машин. Пользователи лаборатории не увидят изменений на своей странице расписания автоматического завершения работы виртуальной машины.

![Вариант политики автоматического завершения работы — 1](./media/devtest-lab-set-lab-policy/auto-shutdown-policy-option-1.png)

### <a name="user-sets-a-schedule-and-cannot-opt-out"></a>Пользователь задает расписание и не может отказаться от него
Если задать лаборатории эту политику, пользователи лаборатории могут переопределить расписание лаборатории. Однако они не могут отказаться от политики автоматического завершения работы. Этот параметр гарантирует, что все компьютеры в лаборатории следуют расписанию автоматического завершения работы. Пользователи лаборатории могут обновить расписание автоматического завершения работы своих виртуальных машин и настроить уведомления об отключении.

![Вариант политики автоматического завершения работы — 2](./media/devtest-lab-set-lab-policy/auto-shutdown-policy-option-2.png)

### <a name="user-has-no-control-over-the-schedule-set-by-lab-admin"></a>Пользователь не может изменять расписание, заданное администратором лаборатории
Если задать лаборатории эту политику, пользователи лаборатории не смогут переопределить или отказаться от расписания лаборатории. Этот параметр дает администратору лаборатории полный контроль над расписанием каждой машины в лаборатории. Пользователи лаборатории могут задать только уведомления об автоматическом завершении работы своих виртуальных машин.

![Вариант политики автоматического завершения работы — 3](./media/devtest-lab-set-lab-policy/auto-shutdown-policy-option-3.png)

## <a name="set-autostart"></a>Задание автоматического запуска
Политика автоматического запуска позволяет указать время запуска виртуальных машин в текущей лаборатории.  

1. В колонке **Конфигурация и политики** лаборатории выберите **Автозапуск**.
   
    ![Снимок экрана показывает параметры автоматического запуска для виртуальной машины.](./media/devtest-lab-set-lab-policy/auto-start.png)

2. Щелкните **On** (Вкл.), чтобы включить эту политику, или **Off** (Выкл.), чтобы отключить ее.

3. Если вы включили эту политику, то укажите время запланированного запуска, часовой пояс и дни недели, к которым применяется это время. 

4. Щелкните **Сохранить**.

После включения эта политика не применяется автоматически к виртуальным машинам в текущей лаборатории. Чтобы применить этот параметр к конкретной виртуальной машине, откройте область управления виртуальной машины и измените значение параметра **Автозапуск**.

## <a name="set-expiration-date"></a>Дата истечения срока действия
Вы можете задать дату истечения срока действия при [создании виртуальной машины](devtest-lab-add-vm.md). В разделе **Дополнительные параметры** щелкните значок календаря и укажите дату, в которую виртуальная машина должна быть автоматически удалена. По умолчанию виртуальная машина является бессрочной.

[!INCLUDE [devtest-lab-try-it-out](../../includes/devtest-lab-try-it-out.md)]

## <a name="next-steps"></a>Дальнейшие действия
После определения и применения различных параметров политики виртуальных машин для лаборатории можно выполнить следующие задачи.

* [Общие IP-адреса в Azure DevTest Labs](devtest-lab-shared-ip.md). Объясняется, как с помощью общих IP-адресов в DevTest Labs минимизировать количество общедоступных IP-адресов, необходимых для подключения к виртуальным машинам лаборатории.
* [Настройка управления затратами.](devtest-lab-configure-cost-management.md) Показано, как использовать диаграмму **Monthly Estimated Cost Trend** (Помесячная тенденция изменения оценочной стоимости),  
  чтобы просматривать стоимость на данный момент в текущем календарном месяце и прогнозируемую стоимость на конец месяца.
* [Создание пользовательского образа.](devtest-lab-create-template.md) При создании виртуальной машины необходимо указать базовый образ виртуальной машины, который может представлять собой пользовательский образ или образ из Marketplace. В этой статье показано, как создать настраиваемый образ из VHD-файла.
* [Настройка образов Marketplace.](devtest-lab-configure-marketplace-images.md) Azure DevTest Labs поддерживает создание виртуальных машин на основе образов Azure Marketplace. В этой статье показано, как определить, какие образы Azure Marketplace (если таковые имеются) можно использовать при создании виртуальных машин в лаборатории.
* [Добавление виртуальной машины в лабораторию в Azure DevTest Labs](devtest-lab-add-vm.md) — из этой статьи вы узнаете, как создать виртуальную машину из базового образа (пользовательского или из Marketplace) и как работать с артефактами в виртуальной машине.
