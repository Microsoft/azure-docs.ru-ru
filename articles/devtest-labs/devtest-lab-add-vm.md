---
title: Добавление виртуальной машины в лабораторию в Azure DevTest Labs | Документация Майкрософт
description: Узнайте, как использовать портал Azure для добавления виртуальной машины в лабораторию в Azure DevTest Labs. Можно выбрать базу, которая является пользовательским изображением или формулой.
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: 07efcf93b963009494021b90e6c730c4615301ef
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "91297629"
---
# <a name="add-a-vm-to-a-lab-in-azure-devtest-labs"></a>Добавление виртуальной машины в лабораторию в Azure DevTest Labs
Если вы уже [создали свою первую виртуальную машину](tutorial-create-custom-lab.md#add-a-vm-to-the-lab), скорее всего, вы использовали предварительно загруженный [образ Мarketplace](devtest-lab-configure-marketplace-images.md). Теперь, если вы хотите добавить в лабораторию больше виртуальных машин, вы также можно использовать *базовый образ* — [пользовательский образа](devtest-lab-create-template.md) или [формулу](devtest-lab-manage-formulas.md). В данном руководстве описывается добавление виртуальной машины в лабораторию в DevTest Labs с помощью портала Azure.

В этой статье также описывается управление артефактами для виртуальной машины в лаборатории.

## <a name="steps-to-add-a-vm-to-a-lab-in-azure-devtest-labs"></a>Добавление виртуальной машины в лабораторию в Azure DevTest Labs
1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
1. Щелкните **Все службы** и выберите **DevTest Labs** в разделе **DEVOPS**. Выберите * (звездочку) рядом с полем **DevTest Labs** в разделе **DEVOPS**. После этого пункт **DevTest Labs** будет добавлен в левое меню навигации, чтобы вы в следующий раз могли легко открыть его. Теперь вы можете выбрать **DevTest Labs** в левом меню навигации.

    ![Окно "Все службы". Выбор DevTest Labs](./media/devtest-lab-create-lab/all-services-select.png)
1. Из списка лабораторий выберите ту, в которой необходимо создать виртуальную машину.
2. На странице **Обзор** нужной лаборатории выберите **+ Добавить**.

    ![Кнопка добавления виртуальной машины](./media/devtest-lab-add-vm/devtestlab-home-blade-add-vm.png)
1. На странице **Choose a base** (Выбор базового образа) выберите образ marketplace для виртуальной машины.
1. На вкладке **Основные параметры** страницы **Виртуальная машина** выполните следующие действия.
    1. В текстовом поле **Имя виртуальной машины** введите имя виртуальной машины. Текстовое поле предварительно заполняется уникальным автоматически созданным именем. Имя соответствует имени пользователя в вашем адресе электронной почты, за которым следует уникальное трехзначное число. Эта функция экономит ваше время, избавляя вас от необходимости придумывать и вводить имя каждый раз, когда вы создаете виртуальную машину. Вы можете изменить автозаполненное значение в этом поле на имя, которое вам требуется. Чтобы переопределить автозаполненное имя виртуальной машины, введите его в текстовое поле **Имя виртуальной машины**.
    2. Введите **имя пользователя**, которому будут предоставлены права администратора на виртуальной машине. **Имя пользователя** для виртуальной машины предварительно заполнено уникальным автоматически созданным именем. Имя соответствует имени пользователя в вашем адресе электронной почты. Эта функция экономит ваше время, избавляя от необходимости придумывать имя пользователя при создании новой виртуальной машины. Вы также можете изменить автозаполненное значение в этом поле на имя пользователя, которое вам требуется. Чтобы переопределить значение автозаполнения для имени пользователя, введите значение в текстовое поле **Имя пользователя**. Этому пользователю будут предоставлены права **администратора** на виртуальной машине.
    3. Если вы создаете первую виртуальную машину в лаборатории, введите **пароль** для пользователя. Чтобы сохранить этот пароль в качестве пароля по умолчанию в Azure Key Vault, связанном с лабораторией, щелкните **Save as default password** (Сохранить как пароль по умолчанию). Пароль по умолчанию сохраняется в хранилище ключей с именем: **VmPassword**. Когда вы пытаетесь создать последующие виртуальные машины в лаборатории, **VmPassword** автоматически выбирается в качестве **пароля**. Чтобы переопределить значение, снимите флажок **Use a saved secret** (Использовать сохраненный секрет) и введите пароль.

        ![Снимок экрана, на котором показана страница "Создание лабораторного ресурса" с выбранным параметром "основные параметры" и указанными значениями "Параметры пользователя".](./media/tutorial-create-custom-lab/new-virtual-machine.png)

        Вы также можете сначала сохранить секреты в хранилище ключей, а затем использовать их при создании виртуальной машины в лаборатории. Дополнительные сведения см. в статье [Хранение секретов в хранилище ключей в Azure DevTest Labs](devtest-lab-store-secrets-in-key-vault.md). Если вы хотите использовать пароль, хранящийся в хранилище ключей, выберите **Use a saved secret** (Использовать сохраненный секрет) и укажите значение ключа, которое соответствует секрету (пароль).
    4. В разделе **Дополнительные параметры** выберите **Изменить размер**. Выберите один из стандартных пунктов, указывающих количество ядер процессора, объем ОЗУ и размер жесткого диска для создаваемой виртуальной машины.
    5. Выберите **Добавление/удаление артефактов**. Выберите и настройте артефакты, которые необходимо добавить в базовый образ.
    **Примечание.** Если вы незнакомы с DevTest Labs или настройкой артефактов, перейдите к разделу [Добавление существующего артефакта к виртуальной машине](./devtest-lab-add-vm.md#add-an-existing-artifact-to-a-vm), а затем вернитесь в этот раздел.
2. Переключитесь на вкладку **Дополнительные параметры**, расположенную сверху, и выполните следующие действия.
    1. Чтобы изменить виртуальную сеть, в которой находится виртуальная машина, выберите **Изменить виртуальную сеть**.
    2. Чтобы изменить подсеть, выберите **Изменить подсеть**.
    3. Укажите тип IP-адреса виртуальной машины: **общедоступный, частный или общий**.
    4. Чтобы автоматически удалить виртуальную машину, укажите **дату и время окончания срока действия**.
    5. Чтобы пользователь лаборатории мог запросить виртуальную машину, выберите значение **Да** для параметра **Make this machine claimable** (Разрешить запрашивать эту виртуальную машину).
    6. Укажите число **экземпляров виртуальной машины**, которое необходимо предоставить пользователям лаборатории.

        ![Выбор основы](./media/tutorial-create-custom-lab/new-vm-advanced-settings.png)
1. Щелкните **Создать** , чтобы добавить в лабораторию указанную виртуальную машину.

   На странице лаборатории отображается состояние создания виртуальной машины. Сначала это состояние имеет значение **Создается**, а после запуска виртуальной машины — **Выполняется**.

    ![Состояние создания виртуальной машины](./media/tutorial-create-custom-lab/vm-creation-status.png)

## <a name="add-an-existing-artifact-to-a-vm"></a>Добавление существующего артефакта к виртуальной машине
Существующие артефакты можно добавить при создании виртуальной машины. Каждая лаборатория включает в себя артефакты из общедоступного репозитория артефактов DevTest Labs, а также артефакты, созданные и добавленные в ваш собственный репозиторий артефактов.

* *Артефакты* Azure DevTest Labs позволяют указывать *действия*, которые выполняются при подготовке виртуальной машины, включая запуск скриптов Windows PowerShell, выполнение команд Bash и установку программного обеспечения.
* *Параметры* артефакта позволяют настроить артефакт для конкретного сценария.

Дополнительные сведения о создании артефактов см. в статье [Создание пользовательских артефактов для виртуальной машины DevTest Lab](devtest-lab-artifact-author.md).

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
1. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
1. Из списка лабораторий выберите ту, где содержится виртуальная машина, с которой вы будете работать.
1. Выберите **My virtual machines** (Мои виртуальные машины).
1. Выберите нужную виртуальную машину.
1. Выберите **Управление артефактами**.
1. Выберите **Apply artifacts** (Применить артефакты).
1. В области **Применение артефактов** выберите артефакт для добавления к виртуальной машине.
1. В области **Добавление артефакта** введите значения обязательных параметров и другие параметры по желанию.
1. Выберите **Добавить**, чтобы добавить артефакт и вернуться в область **Применение артефактов**.
1. Продолжайте добавлять артефакты, необходимые для виртуальной машины.
1. После добавления артефактов можно [изменить порядок, в котором они выполняются](#change-the-order-in-which-artifacts-are-run). Также можно вернуться к [просмотру или изменению артефакта](#view-or-modify-an-artifact).
1. После добавления артефактов выберите **Применить**.

## <a name="change-the-order-in-which-artifacts-are-run"></a>Изменение порядка выполнения артефактов
По умолчанию действия артефактов выполняются в порядке их добавления на виртуальную машину.
Ниже показано, как изменить порядок, в котором выполняются артефакты.

1. В верхней части области **Применение артефактов** щелкните ссылку, указывающую количество добавленных к виртуальной машине артефактов.

    ![Количество артефактов, добавленных к виртуальной машине](./media/devtest-lab-add-vm-with-artifacts/devtestlab-add-artifacts-blade-selected-artifacts.png)
1. В области **Выбранные артефакты** расположите артефакты в нужном порядке с помощью перетаскивания. **Примечание.** Если у вас возникли проблемы при перетаскивании артефактов, убедитесь, что вы перетаскиваете их за левую сторону.
1. По окончании нажмите кнопку **ОК** .

## <a name="view-or-modify-an-artifact"></a>просмотру или изменению артефакта
Для просмотра или изменения параметров артефакта выполните следующие действия:

1. В верхней части области **Применение артефактов** щелкните ссылку, указывающую количество добавленных к виртуальной машине артефактов.

    ![Количество артефактов, добавленных к виртуальной машине](./media/devtest-lab-add-vm-with-artifacts/devtestlab-add-artifacts-blade-selected-artifacts.png)
1. В области **Выбранные артефакты** выберите артефакт, который нужно просмотреть или изменить.
1. В области **Добавление артефакта** внесите необходимые изменения. Затем нажмите кнопку **ОК**, чтобы закрыть область **Добавление артефакта**.
1. Нажмите кнопку **ОК**, чтобы закрыть область **Выбранные артефакты**.

## <a name="save-azure-resource-manager-template"></a>Сохранение шаблона Azure Resource Manager
С помощью шаблона Azure Resource Manager можно декларативно определить повторяемое развертывание.
Далее описывается процесс сохранения шаблона Azure Resource Manager для создаваемой виртуальной машины.
После сохранения шаблон Azure Resource Manager можно использовать для [развертывания новых виртуальных машин с помощью Azure PowerShell](../azure-resource-manager/templates/overview.md).

1. В области **Виртуальная машина** выберите **Просмотр шаблона Azure Resource Manager**.
2. В области **Просмотр шаблона Azure Resource Manager** выделите текст шаблона.
3. Скопируйте выделенный текст в буфер обмена.
4. Нажмите кнопку **ОК**, чтобы закрыть область **Просмотр шаблона Azure Resource Manager**.
5. Откройте текстовый редактор.
6. Вставьте текст шаблона из буфера обмена.
7. Сохраните файл для последующего использования.

[!INCLUDE [devtest-lab-try-it-out](../../includes/devtest-lab-try-it-out.md)]

## <a name="next-steps"></a>Дальнейшие действия
* После создания виртуальной машины к ней можно подключиться, щелкнув **Подключиться** в области виртуальной машины.
* Узнайте, как [создавать пользовательские артефакты для виртуальной машины DevTest Labs](devtest-lab-artifact-author.md).
* Изучите [коллекцию шаблонов быстрого запуска DevTest Labs Azure Resource Manager](https://github.com/Azure/azure-devtestlab/tree/master/samples/DevTestLabs/QuickStartTemplates).
