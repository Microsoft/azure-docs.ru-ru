---
title: Создание запрашиваемых виртуальных машин и управление ими в Azure DevTest Labs | Документация Майкрософт
description: Узнайте, как с помощью портал Azure добавить запрашиваемую виртуальную машину в Azure DevTest Labs и просмотреть следующие процессы, чтобы запрашивать или отменять запрос виртуальной машины.
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: 1fe949d7104fe6437087e77c403cc0d921ebd025
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "88270985"
---
# <a name="create-and-manage-claimable-vms-in-azure-devtest-labs"></a>Создание запрашиваемой виртуальной машины и управление ею в лаборатории Azure DevTest Labs
Добавление запрашиваемой виртуальной машины в лабораторию аналогично [добавлению стандартной виртуальной машины](devtest-lab-add-vm.md). Оно выполняется *на базе*[пользовательского образа](devtest-lab-create-template.md), [формулы](devtest-lab-manage-formulas.md) или [образа Marketplace](devtest-lab-configure-marketplace-images.md). В этой статье описывается добавление запрашиваемой виртуальной машины в лабораторию в DevTest Labs с помощью портала Azure, а также действия пользователя для резервирования или освобождения виртуальной машины.

## <a name="steps-to-add-a-claimable-vm-to-a-lab-in-azure-devtest-labs"></a>Процедура добавления запрашиваемой виртуальной машины в лабораторию в Azure DevTest Labs
1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
1. Щелкните **Все службы** и выберите **DevTest Labs** в разделе **DEVOPS**. Выберите * (звездочку) рядом с полем **DevTest Labs** в разделе **DEVOPS**. После этого пункт **DevTest Labs** будет добавлен в левое меню навигации, чтобы вы в следующий раз могли легко открыть его. Теперь вы можете выбрать **DevTest Labs** в левом меню навигации.

    ![Окно "Все службы". Выбор DevTest Labs](./media/devtest-lab-create-lab/all-services-select.png)
1. Из списка лабораторий выберите ту, в которой необходимо создать виртуальную машину.
2. На странице **Обзор** нужной лаборатории выберите **+ Добавить**.

    ![Кнопка добавления виртуальной машины](./media/devtest-lab-add-vm/devtestlab-home-blade-add-vm.png)
1. На странице **Choose a base** (Выбор базового образа) выберите образ marketplace для виртуальной машины.
1. На вкладке **Основные параметры** страницы **Виртуальная машина** выполните следующие действия.
    1. В текстовом поле **Имя виртуальной машины** введите имя виртуальной машины. Текстовое поле предварительно заполняется уникальным автоматически созданным именем. Имя соответствует имени пользователя в вашем адресе электронной почты, за которым следует уникальное трехзначное число. Эта функция экономит ваше время, избавляя вас от необходимости придумывать и вводить имя каждый раз, когда вы создаете виртуальную машину. Вы можете изменить автозаполненное значение в этом поле на имя, которое вам требуется. Чтобы переопределить автозаполненное имя виртуальной машины, введите его в текстовое поле **Имя виртуальной машины**.
    2. Введите **имя пользователя**, которому будут предоставлены права администратора на виртуальной машине. **Имя пользователя** для виртуальной машины предварительно заполнено уникальным автоматически созданным именем. Имя соответствует имени пользователя в вашем адресе электронной почты. Эта функция экономит ваше время, избавляя от необходимости придумывать имя пользователя при создании новой виртуальной машины. Вы также можете изменить автозаполненное значение в этом поле на имя пользователя, которое вам требуется. Чтобы переопределить значение автозаполнения для имени пользователя, введите значение в текстовое поле **Имя пользователя**. Этому пользователю будут предоставлены права **администратора** на виртуальной машине.
    3. Если вы создаете первую виртуальную машину в лаборатории, введите **пароль** для пользователя. Чтобы сохранить этот пароль в качестве пароля по умолчанию в Azure Key Vault, связанном с лабораторией, щелкните **Save as default password** (Сохранить как пароль по умолчанию). Пароль по умолчанию сохраняется в хранилище ключей с именем: **VmPassword**. Когда вы пытаетесь создать последующие виртуальные машины в лаборатории, **VmPassword** автоматически выбирается в качестве **пароля**. Чтобы переопределить значение, снимите флажок **Use a saved secret** (Использовать сохраненный секрет) и введите пароль.

        Вы также можете сначала сохранить секреты в хранилище ключей, а затем использовать их при создании виртуальной машины в лаборатории. Дополнительные сведения см. в статье [Хранение секретов в хранилище ключей в Azure DevTest Labs](devtest-lab-store-secrets-in-key-vault.md). Если вы хотите использовать пароль, хранящийся в хранилище ключей, выберите **Use a saved secret** (Использовать сохраненный секрет) и укажите значение ключа, которое соответствует секрету (пароль).
    4. В разделе **Дополнительные параметры** выберите **Изменить размер**. Выберите один из стандартных пунктов, указывающих количество ядер процессора, объем ОЗУ и размер жесткого диска для создаваемой виртуальной машины.
    5. Выберите **Добавление/удаление артефактов**. Выберите и настройте артефакты, которые необходимо добавить в базовый образ.
    **Примечание.** Если вы незнакомы с DevTest Labs или настройкой артефактов, перейдите к разделу [Добавление существующего артефакта к виртуальной машине](./devtest-lab-add-vm.md#add-an-existing-artifact-to-a-vm), а затем вернитесь в этот раздел.
2. Переключитесь на вкладку **Дополнительные параметры**, расположенную сверху, и выполните следующие действия.
    1. Чтобы изменить виртуальную сеть, в которой находится виртуальная машина, выберите **Изменить виртуальную сеть**.
    2. Чтобы изменить подсеть, выберите **Изменить подсеть**.
    3. Укажите тип IP-адреса виртуальной машины: **общедоступный, частный или общий**.
    4. Чтобы автоматически удалить виртуальную машину, укажите **дату и время окончания срока действия**.
    5. Чтобы пользователь лаборатории мог запросить виртуальную машину, выберите значение **Да** для параметра **Make this machine claimable** (Разрешить запрашивать эту виртуальную машину).
    6. Укажите число **экземпляров виртуальной машины**, которое необходимо предоставить пользователям лаборатории.
3. Щелкните **Создать** , чтобы добавить в лабораторию указанную виртуальную машину.

   На странице лаборатории отображается состояние создания виртуальной машины. Сначала это состояние имеет значение **Создается**, а после запуска виртуальной машины — **Выполняется**.

> [!NOTE]
> Если вы развертываете лабораторные виртуальные машины с помощью [шаблонов Azure Resource Manager](devtest-lab-create-environment-from-arm.md), вы можете создать запрашиваемые виртуальные машины, задав в разделе свойств для свойства **allowClaim** значение true.


## <a name="using-a-claimable-vm"></a>Использование запрашиваемой виртуальной машины

Пользователь может запросить любую виртуальную машину из списка "Claimable virtual machines" ("Запрашиваемые виртуальные машины"), выполнив одно из действий, описанных ниже.

* В нижней части панели "Обзор" в лаборатории щелкните правой кнопкой мыши одну из виртуальных машин, представленных в списке "Виртуальные машины, для которых разрешены заявки на доступ" и выберите **Отправить заявку на доступ к виртуальной машине**.

  ![Запрос определенной запрашиваемой виртуальной машины](./media/devtest-lab-add-vm/devtestlab-claim-VM.png)


* В верхней части панели "Обзор" выберите вариант **Отправить заявку на доступ к любой**. Из списка запрашиваемых виртуальных машин будет назначена случайная виртуальная машина.

  ![Запрос любой запрашиваемой виртуальной машины](./media/devtest-lab-add-vm/devtestlab-claim-any.png)


После того как пользователь получит заявку на виртуальную машину, DevTest Labs запустит его и переместит в список "мои виртуальные машины" пользователя лаборатории. Это означает, что пользователь лаборатории теперь имеет права владельца на этом компьютере. Время, необходимое для этого шага, может отличаться в зависимости от времени запуска, а также от других настраиваемых действий, выполняемых во время события утверждения. После получения заявки компьютер больше не будет доступен в запрашиваемом пуле.  

## <a name="unclaim-a-vm"></a>Освобождение виртуальной машины

Когда пользователь закончит использовать зарезервированную виртуальную машину, он может освободить ее для доступа других пользователей. Чтобы вернуть виртуальную машину в список доступных для запроса, выполните одно из следующих действий.

- В списке "Мои виртуальные машины" щелкните правой кнопкой мыши одну из виртуальных машин или значок многоточия (...) и выберите действие **Освободить**.

  ![Освобождение виртуальной машины в списке виртуальных машин](./media/devtest-lab-add-vm/devtestlab-unclaim-VM2.png)

- В списке "Мои виртуальные машины" выберите виртуальную машину, чтобы открыть для нее панель управления, а затем в верхнем меню выберите действие **Освободить**.

  ![Действие освобождения на панели управления виртуальной машиной](./media/devtest-lab-add-vm/devtestlab-unclaim-VM.png)

Когда пользователь отменяет виртуальную машину, у него больше нет разрешений владельца на эту виртуальную машину лаборатории, и ее можно запросить у любого другого пользователя лаборатории в том состоянии, в котором оно было возвращено в пул. 

### <a name="transferring-the-data-disk"></a>Передача диска данных
Если к запрашиваемой виртуальной машине подключен диск данных, то при освобождении виртуальной машины диск данных остается подключенным к ней. Когда другой пользователь отправит заявку на эту виртуальную машину, он одновременно получит и подключенный диск данных.

Этот процесс называется "передача диска данных". Переданный диск данных появляется в списке **Мои диски данных** нового пользователя, где он может управлять этим диском.

![Освобождение дисков данных](./media/devtest-lab-add-vm/devtestlab-unclaim-datadisks.png)



## <a name="next-steps"></a>Дальнейшие действия
* После создания виртуальной машины вы можете подключиться к ней, выбрав **Подключиться** на соответствующей панели управления.
* Изучите [коллекцию шаблонов быстрого запуска DevTest Labs Azure Resource Manager](https://github.com/Azure/azure-devtestlab/tree/master/samples/DevTestLabs/QuickStartTemplates).
