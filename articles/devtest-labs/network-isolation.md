---
title: Сетевая изоляция в Azure DevTest Labs
description: Сведения об изоляции сети в Azure DevTest Labs.
ms.topic: article
ms.date: 08/25/2020
ms.openlocfilehash: 28bfa048a8a6666deb58a8ecfff38779c91d95b8
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96352938"
---
# <a name="network-isolation-in-devtest-labs"></a>Сетевая изоляция в DevTest Labs

[Виртуальная сеть Azure](../virtual-network/virtual-networks-overview.md) выступает в качестве границы безопасности, изолируя ресурсы Azure из общедоступного Интернета. Вы также можете присоединить виртуальную сеть Azure к локальной сети, чтобы обеспечить безопасное подключение к локальным ресурсам. В DevTest Labs Вы можете [изолировать все виртуальные машины](devtest-lab-configure-vnet.md) и среды лаборатории для [сети](connect-environment-lab-virtual-network.md) , чтобы обеспечить соблюдение лабораторных ресурсов в соответствии с политиками сети Организации. 

Как владелец лаборатории вы также можете полностью изолировать лабораторию, то есть, помимо изоляции виртуальных машин и сред в выбранной сети, можно также изолировать учетную запись хранения лаборатории и хранилища ключей, созданные в вашей подписке. В этой статье описывается создание изолированной от сети лаборатории. 

Также ознакомьтесь со следующими статьями:

- [Как DevTest Labs использует учетную запись хранения лаборатории](encrypt-storage.md)
- [Как DevTest Labs использует хранилища ключей](devtest-lab-store-secrets-in-key-vault.md)
 
> [!NOTE]
> В настоящее время сетевая изоляция поддерживается только для новых операций создания лабораторий.

## <a name="steps-to-enable-network-isolation-during-lab-creation"></a>Действия по включению сетевой изоляции во время создания лаборатории

1. Во время создания лаборатории перейдите на вкладку **Сетевые подключения** .
1. Можно выбрать сеть **по умолчанию** , которую будет создавать лаборатория, или выбрать существующую сеть из раскрывающегося списка. Вы сможете выбрать только те сети, которые находятся в том же регионе и подписке, что и лаборатория. 

    > [!div class="mx-imgBorder"]
    > ![Создание лаборатории](./media/network-isolation/create-lab.png)
1. Выберите подсеть.

    > [!div class="mx-imgBorder"]
    > ![Создание подсети](./media/network-isolation/create-lab-subnet.png)
1. Если вы решили изолировать ресурсы лаборатории (учетную запись хранения лаборатории и хранилище ключей) в сети по умолчанию, дальнейшие действия не требуются, и лаборатория будет обрабатывать изоляцию ресурсов.
 
    > [!div class="mx-imgBorder"]
    > ![Сетевая изоляция](./media/network-isolation/isolate-lab-resources.png)
1. Если вы решили изолировать ресурсы лаборатории (учетную запись хранения лаборатории и хранилище ключей) с выбранной сетью, то необходимо выполнить следующие действия после создания лаборатории, чтобы убедиться в том, что Лаборатория продолжит функционировать в изолированном режиме. 
 
    > [!div class="mx-imgBorder"]
    > ![Изолировать с переисточником](./media/network-isolation/isolate-my-vnet.png)

    > [!IMPORTANT]
    > Перед настройкой и/или созданием ресурсов в лаборатории необходимо выполнить эти действия.

### <a name="steps-to-follow-post-lab-creation"></a>Действия после создания лаборатории

1. На домашней странице лаборатории выберите **группу ресурсов** на странице **Обзор** . Вы увидите страницу **группы ресурсов** для группы ресурсов, содержащей лабораторию. 
 
   > [!div class="mx-imgBorder"]
   > ![Лаборатория contoso](./media/network-isolation/contoso-lab.png)
1. Выберите учетную запись хранения Azure лаборатории. Для учетной записи хранения лаборатории используется соглашение об именовании:<*лабнамевисаутинвалидчарактерс* > *<4-значное число*>. Например, если имя лаборатории — контосолаб, то имя учетной записи хранения может быть acontosolab1234.
 
   > [!div class="mx-imgBorder"]
   > ![Проверка contoso](./media/network-isolation/contoso-test.png)
1. В учетной записи хранения перейдите в раздел брандмауэры и виртуальные сети и убедитесь, что установлен флажок разрешить доверенным службам Майкрософт доступ к этой учетной записи хранения. Так как [DevTest Labs является доверенной службой Майкрософт](../storage/common/storage-network-security.md#trusted-microsoft-services), этот параметр позволяет лабораторию работать нормально в изолированном от сети режиме. 

   > [!div class="mx-imgBorder"]
   > ![Брандмауэры Contoso Lab](./media/network-isolation/contoso-lab-firewalls-vnets.png)
1. Затем щелкните **+ Добавить существующую виртуальную сеть**, выберите виртуальную сеть и подсеть, выбранные при создании лаборатории, и щелкните **включить**. 

   > [!div class="mx-imgBorder"]
   > ![Contoso моя виртуальная сеть](./media/network-isolation/contoso-lab-my-vnet.png)
5.  После успешного включения конечной точки службы для выбранной виртуальной сети нажмите кнопку **Добавить**. 

   > [!div class="mx-imgBorder"]
   > ![Добавление](./media/network-isolation/contoso-firewall-add.png)
 
В результате служба хранилища Azure разрешит входящие подключения из добавленной виртуальной сети и предоставит лабораторию успешное функционирование в изолированном сетевом режиме. 

Вы также можете автоматизировать эти действия, чтобы настроить этот параметр для нескольких лабораторий. 

[Дополнительные сведения об управлении правилами сетевого доступа по умолчанию для службы хранилища Azure с помощью PowerShell и интерфейса командной строки](../storage/common/storage-network-security.md?toc=%2fazure%2fvirtual-network%2ftoc.json#powershell)

## <a name="things-to-remember-while-using-a-lab-in-a-network-isolated-mode"></a>Что следует помнить при использовании лаборатории в изолированном от сети режиме

### <a name="accessing-labs-storage-account-outside-the-lab"></a>Доступ к учетной записи хранения лаборатории за пределами лаборатории 

В лаборатории, изолированной от сети, для таких действий, как отправка виртуального жесткого диска в учетную запись хранения лаборатории для создания пользовательских образов из, владелец лаборатории должен явно включить доступ к учетной записи хранения из разрешенной конечной точки. Это можно сделать, создав виртуальную машину и безопасно обеспечивая доступ к учетной записи хранения лаборатории из этой виртуальной машины. 

[Дополнительные сведения о доступе к учетной записи хранения в частном порядке с помощью виртуальной машины](../private-link/tutorial-private-endpoint-storage-portal.md)

### <a name="exporting-usage-data-from-the-lab"></a>Экспорт данных об использовании из лаборатории 

В лабораторной среде, изолированной от сети, для [экспорта личных данных об использовании в лаборатории](personal-data-delete-export.md)владельцу лаборатории потребуется предоставить учетную запись хранения и создать большой двоичный объект в учетной записи для хранения данных. 

Если учетная запись хранения не предоставлена, эта операция завершится сбоем в режиме сетевой изоляции, так как учетная запись хранения лаборатории недоступна для использования в лабораторной работе в случае отсутствия учетной записи хранения, предоставленной клиентом. 

[Дополнительные сведения об экспорте данных об использовании лаборатории в указанной учетной записи хранения](personal-data-delete-export.md#azure-powershell)

## <a name="next-steps"></a>Дальнейшие действия

[Автоматическое создание и изменение лабораторий помощью шаблонов Azure Resource Manager и PowerShell](devtest-lab-use-arm-and-powershell-for-lab-resources.md)