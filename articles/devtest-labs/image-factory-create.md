---
title: Создание фабрики изображений в Azure DevTest Labs | Документация Майкрософт
description: В этой статье показано, как настроить настраиваемую фабрику образов с помощью примеров сценариев, доступных в репозитории Git (Azure DevTest Labs).
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: 14c8338d6a5ae21847da3a9c774ea6dcdac33ae4
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "85482077"
---
# <a name="create-a-custom-image-factory-in-azure-devtest-labs"></a>Создание настраиваемой фабрики изображений в Azure DevTest Labs
В этой статье показано, как настроить настраиваемую фабрику образов с помощью примеров сценариев, доступных в [репозитории Git](https://github.com/Azure/azure-devtestlab/tree/master/samples/DevTestLabs/Scripts/ImageFactory).

## <a name="whats-an-image-factory"></a>Что такое фабрика изображений?
Фабрика изображений — это решение с конфигурацией "Конфигурация — код", которое регулярно создает и распространяет образы автоматически на основе всех требуемых конфигураций. Образы в фабрике образов всегда обновлены, и непрерывное обслуживание почти равно нулю после автоматизации всего процесса. И, так как все необходимые конфигурации уже находятся в образе, оно сохраняет время от ручной настройки системы после создания виртуальной машины с базовой ОС.

Значительное сочетание клавиш для перехода на Рабочий стол разработчика в состояние готовности в DevTest Labs использует пользовательские образы. Недостаток пользовательских образов заключается в том, что в лаборатории есть что-то дополнительное для поддержки. Например, срок действия пробных версий продуктов истекает через некоторое время (или) недавно выпущенные обновления безопасности не применяются, что позволяет периодически обновлять пользовательский образ. С фабрикой изображений вы можете определить изображение, возвращенное в систему управления версиями, и создать автоматизированный процесс для создания пользовательских изображений на основе определения.

Решение позволяет ускорить создание виртуальных машин на основе пользовательских образов, исключая дополнительные текущие затраты на обслуживание. С помощью этого решения можно автоматически создавать пользовательские образы, распространять их в другие DevTest Labs и снимать старые образы. В следующем видео вы узнаете о фабрике образов и о том, как она реализована с помощью DevTest Labs.  Все сценарии Azure PowerShell свободно доступны и находятся здесь:  [https://aka.ms/dtlimagefactory](https://aka.ms/dtlimagefactory) .

<br/>

> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Custom-Image-Factory-with-Azure-DevTest-Labs/player]


## <a name="high-level-view-of-the-solution"></a>Высокоуровневое представление решения
Решение позволяет ускорить создание виртуальных машин на основе пользовательских образов, исключая дополнительные текущие затраты на обслуживание. С помощью этого решения можно автоматически создавать пользовательские образы и распространять их в другие DevTest Labs. Вы используете Azure DevOps (ранее Visual Studio Team Services) в качестве механизма оркестрации для автоматизации всех операций в DevTest Labs.

![Высокоуровневое представление решения](./media/create-image-factory/high-level-view-of-solution.png)

Существует [расширение VSTS для DevTest Labs](https://marketplace.visualstudio.com/items?itemName=ms-azuredevtestlabs.tasks) , которое позволяет выполнять следующие действия:

- Создание пользовательского образа
- Создание виртуальной машины
- Удаление виртуальной машины
- Создать окружение
- Удалить окружение
- Заполнить окружение

Использование расширения DevTest Labs — это простой способ начать работу с автоматическим созданием пользовательских образов в DevTest Labs.

Существует альтернативная реализация, использующая скрипт PowerShell для более сложного сценария. С помощью PowerShell можно полностью автоматизировать фабрику изображений на основе DevTest Labs, которые можно использовать для непрерывной интеграции и непрерывной поставки (CI/CD) цепочки инструментов. Ниже приведены принципы, которые следует выполнить в этом альтернативном решении.

- Для общих обновлений не требуется вносить изменения в фабрику образов. (например, Добавление нового типа пользовательского образа, автоматическое удаление старых образов, Добавление новой конечной точки DevTest Labs для получения пользовательских образов и т. д.)
- Распространенные изменения в системе управления исходным кодом (инфраструктура как код)
- DevTest Labs, получающие пользовательские образы, могут не входить в одну подписку Azure (практические занятия, охватывающие подписки).
- Скрипты PowerShell необходимо использовать повторно, чтобы при необходимости можно было выполнить дополнительные фабрики.

## <a name="next-steps"></a>Дальнейшие действия
Перейдите к следующей статье в этом разделе: [Запуск фабрики образов из Azure DevOps](image-factory-set-up-devops-lab.md)
