---
title: Шифрование учетной записи хранения Azure, используемой лабораторией, в Azure DevTest Labs
description: Узнайте, как настроить шифрование службы хранилища Azure, используемой лабораторией, в Azure DevTest Labs
ms.topic: how-to
ms.date: 07/29/2020
ms.openlocfilehash: dcede89fb23c532742e41121688bcb51a5a73833
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92149312"
---
# <a name="encrypt-azure-storage-used-by-a-lab-in-azure-devtest-labs"></a>Шифрование хранилища Azure, используемого лабораторией в Azure DevTest Labs
Каждая лабораторная работа, созданная в Azure DevTest Labs, создается с соответствующей учетной записью хранения Azure. Учетная запись хранения используется в следующих целях: 

- Хранение документов [формул](devtest-lab-manage-formulas.md) , которые можно использовать для создания виртуальных машин.
- Хранение результатов артефактов, содержащих журналы развертывания и расширения, созданные на основе применения артефактов. 
- [Отправка виртуальных жестких дисков (VHD) для создания пользовательских образов в лаборатории.](devtest-lab-create-template.md)
- Кэширование часто используемых [артефактов](add-artifact-vm.md) и [шаблонов Azure Resource Manager](devtest-lab-create-environment-from-arm.md) для ускорения извлечения во время создания виртуальной машины или среды.

> [!NOTE]
> Приведенная выше информация важна для работы лаборатории. Он хранится в течение жизненного цикла лаборатории (и лабораторных ресурсов), если явно не удален. Удаление этих ресурсов вручную может привести к ошибкам при создании виртуальных машин лаборатории и (или) формулах, которые повреждаются для будущего использования. 

## <a name="locate-the-storage-account-and-view-its-contents"></a>Определение местонахождения учетной записи хранения и просмотр ее содержимого

1. На домашней странице лаборатории выберите **группу ресурсов** на странице **Обзор** . Вы увидите страницу **группы ресурсов** для группы ресурсов, содержащей лабораторию. 

    :::image type="content" source="./media/encrypt-storage/overview-resource-group-link.png" alt-text="Выбор группы ресурсов на странице &quot;Обзор&quot;":::
1. Выберите учетную запись хранения Azure лаборатории. Соглашение об именовании для учетной записи хранения лаборатории: `a<labNameWithoutInvalidCharacters><4-digit number>` . Например, если имя лаборатории — `contosolab` , то имя учетной записи хранения может иметь значение `acontosolab7576` . 

    :::image type="content" source="./media/encrypt-storage/select-storage-account.png" alt-text="Выбор учетной записи хранения в группе ресурсов лаборатории":::
3. На странице **учетная запись хранения** выберите **Обозреватель службы хранилища (Предварительная версия)** в меню слева, а затем щелкните **контейнеры больших двоичных объектов** , чтобы найти соответствующее содержимое, связанное с лабораторией. 

   :::image type="content" source="./media/encrypt-storage/storage-explorer.png" alt-text="Обозреватель хранилищ (предварительная версия)" lightbox="./media/encrypt-storage/storage-explorer.png":::

## <a name="encrypt-the-lab-storage-account"></a>Шифрование учетной записи хранения лаборатории
Служба хранилища Azure автоматически шифрует данные при их сохранении в облаке. Шифрование службы хранилища Azure защищает ваши данные и помогает удовлетворить ваши обязательства по обеспечению безопасности и соответствия требованиям Организации. Дополнительные сведения см. в статье [Шифрование службы хранилища Azure для неактивных данных](../storage/common/storage-service-encryption.md).

Данные в учетной записи хранения лаборатории шифруются с помощью **ключа, управляемого корпорацией Майкрософт**. Вы можете использовать ключи, управляемые корпорацией Майкрософт, для шифрования данных, а также управлять шифрованием с помощью собственных ключей. Если вы решили управлять шифрованием с помощью собственных ключей для учетной записи хранения лаборатории, можно указать ключ, **управляемый клиентом** , с помощью Azure Key Vault, который будет использоваться для шифрования и расшифровки данных в хранилище BLOB-объектов и в службе файлов Azure. Дополнительные сведения о ключах, управляемых клиентом, см. [в статье Использование управляемых клиентом ключей с Azure Key Vault для управления шифрованием службы хранилища Azure](../storage/common/customer-managed-keys-overview.md).

Чтобы узнать, как настроить ключи, управляемые клиентом, для шифрования службы хранилища Azure, см. следующие статьи: 

- [Портал Azure](../storage/common/customer-managed-keys-configure-key-vault.md)
- [Azure PowerShell](../storage/common/customer-managed-keys-configure-key-vault.md)
- [Azure CLI](../storage/common/customer-managed-keys-configure-key-vault.md)


## <a name="manage-the-azure-blob-storage-life-cycle"></a>Управление жизненным циклом хранилища BLOB-объектов Azure
Как уже упоминалось, сведения, хранящиеся в учетной записи хранения лаборатории, критически важны для работы лаборатории без ошибок. Если не удалить явно, эти данные останутся в учетной записи хранения лаборатории в течение жизненного цикла лаборатории или жизненного цикла конкретных виртуальных машин лаборатории, в зависимости от типа данных.

### <a name="uploaded-vhds"></a>Отправленные виртуальные жесткие диски
Эти виртуальные жесткие диски используются для создания пользовательских образов. Их удаление сделает невозможным создание пользовательских образов на основе этих виртуальных жестких дисков.

### <a name="artifacts-cache"></a>Кэш артефактов
Эти кэши будут созданы повторно при каждом применении артефактов. Они будут обновлены последним содержимым из соответствующих репозиториев, на которые имеются ссылки. Таким образом, если удалить эти сведения для сохранения расходов, связанных с хранилищем, это приведет к временной отсчету.

### <a name="azure-resource-manager-template-cache"></a>Кэш шаблонов Azure Resource Manager
Эти кэши будут созданы повторно в любой момент, когда все репозитории шаблонов на основе Azure Resource Manager будут подключены и отправится в лабораторию. Они будут обновлены последним содержимым из соответствующих репозиториев, на которые имеются ссылки. Таким образом, если удалить эти сведения для сохранения расходов, связанных с хранилищем, это приведет к временной отсчету.

### <a name="formulas"></a>Формулы
Эти документы используются для поддержки возможности создания формул из существующих виртуальных машин и создания виртуальных машин из формул. Удаление этих документов формулы может привести к ошибкам при выполнении следующих операций:

- Создание формулы на основе существующей виртуальной машины лаборатории
- Создание или обновление формул 
- Создание виртуальной машины из формулы.

### <a name="artifact-results"></a>Результаты артефактов
По мере применения артефактов размер соответствующих результатов артефактов может увеличиваться со временем в зависимости от числа и типа артефактов, выполняемых на виртуальных машинах лаборатории. Поэтому, как владелец лаборатории, вам может потребоваться управлять жизненным циклом таких документов. Дополнительные сведения см. в статье [Управление жизненным циклом хранилища BLOB-объектов Azure](../storage/blobs/storage-lifecycle-management-concepts.md).

> [!IMPORTANT]
> Рекомендуется выполнить этот шаг, чтобы сократить расходы, связанные с учетной записью хранения Azure. 

Например, следующее правило используется для задания правила истечения срока действия 90 дней специально для результатов артефакта. Это гарантирует, что старые результаты артефакта будут повторно запущены из учетной записи хранения с постоянным ритмичей.

```json
{
  "rules": [
    {
      "name": "expirationRule",
      "enabled": true,
      "type": "Lifecycle",
      "definition": {
        "filters": {
          "blobTypes": [ "blockBlob" ],
          "prefixMatch": [ "artifacts/results" ]
        },
        "actions": {
          "baseBlob": {
            "delete": { "daysAfterModificationGreaterThan": 90 }
          },
          "snapshot": {
            "delete": { "daysAfterCreationGreaterThan": 90 }
          }
        }
      }
    }
  ]
}
```

## <a name="next-steps"></a>Дальнейшие действия
Чтобы узнать, как настроить ключи, управляемые клиентом, для шифрования службы хранилища Azure, см. следующие статьи: 

- [Портал Azure](../storage/common/customer-managed-keys-configure-key-vault.md)
- [Azure PowerShell](../storage/common/customer-managed-keys-configure-key-vault.md)
- [Azure CLI](../storage/common/customer-managed-keys-configure-key-vault.md)