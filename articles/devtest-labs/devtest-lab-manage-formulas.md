---
title: Управление формулами в Azure DevTest Labs для создания виртуальных машин | Документация Майкрософт
description: В этой статье показано, как создать формулу из базового образа (пользовательского образа, образа Marketplace или другой формулы) или существующей виртуальной машины.
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: f012a8c59a8e938334c3e1abc4c7b3ccd0e48d3e
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "91308900"
---
# <a name="manage-azure-devtest-labs-formulas"></a>Управление формулами Azure DevTest Labs

[!INCLUDE [devtest-lab-formula-definition](../../includes/devtest-lab-formula-definition.md)]

В этой статье показано, как создать формулу из базового образа (пользовательского образа, образа Marketplace или другой формулы) или существующей виртуальной машины. В этой статье также объясняется, как управлять существующими формулами.

## <a name="create-a-formula"></a>Создание формулы
Любой пользователь, имеющий разрешения роли *Пользователь* DevTest Labs, может создавать виртуальные машины на основе формул. Формулы можно создавать двумя способами. 

* Из базового образа — используйте этот способ, если хотите задать все характеристики формулы.
* На основе существующей виртуальной машины — используйте этот способ, если хотите создать формулу на основе параметров существующей виртуальной машины.

Дополнительные сведения о добавлении пользователей и разрешений см. в статье [Добавление владельцев и пользователей в Azure DevTest Labs](./devtest-lab-add-devtest-user.md).

### <a name="create-a-formula-from-a-base"></a>Создание формулы из базового образа
Ниже приведены пошаговые инструкции по созданию формулы на основе пользовательского образа, образа Marketplace или другой формулы.

1. Войдите на [портал Azure](https://portal.azure.com).

2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.

3. Из списка лабораторий выберите нужную лабораторию.  

4. На странице лаборатории выберите в меню слева пункт **формулы (базы для повторного использования)** .
5. На странице **Формулы** выберите **+ Добавить**.
   
    ![Добавление формулы](./media/devtest-lab-create-formulas/add-formula.png)
6. На странице **Выбор базы** выберите основу (пользовательский образ, образ Marketplace или общий образ коллекции образов), из которого нужно создать формулу.

    :::image type="content" source="./media/devtest-lab-create-formulas/select-base.png" alt-text="Выбор базового образа":::
1. Во вкладке **Основные параметры** на странице **создания формулы** укажите следующие значения.
   
    * **Имя формулы** — введите имя формулы. Это значение отображается в списке базовых образов при создании виртуальной машины. Имя проверяется по мере ввода. Если оно недопустимо, появляется сообщение с указанием требований к именам.
    - Введите необязательное **Описание** формулы. 
    * **Имя пользователя** — введите имя пользователя, которому будут предоставлены права администратора.
    * **Пароль** — введите или выберите из раскрывающегося списка значение, связанное с секретом (паролем), которое будет применяться для указанного пользователя. См. дополнительные сведения о [хранении секретов в Azure Key Vault и их использовании их при создании ресурсов лаборатории](devtest-lab-store-secrets-in-key-vault.md).

        Выберите **использовать сохраненный секрет** , если хотите использовать секрет из Azure Key Vault вместо пароля. 
    * **Размер виртуальной машины** . Выберите **изменить размер** , чтобы изменить размер виртуальной машины. 
    - **Тип диска ОС** . Выберите тип диска, который вы хотите использовать (HDD (цен. категория "Стандартный"), SSD (цен. категория "Стандартный") или SSD (цен. Категория "Премиум")).
    * **Артефакты** — выберите страницу **Добавление/удаление артефактов**, где можно выбрать и настроить артефакты, которые нужно добавить в базовый образ. Дополнительные сведения об артефактах см. в статье о [создании настраиваемых артефактов для виртуальной машины Azure DevTest Labs](devtest-lab-artifact-author.md).

        ![Страница "основные параметры"](./media/devtest-lab-create-formulas/basic-settings.png)
8. Переключитесь на вкладку **Дополнительные параметры** и укажите следующие значения.
    - **Виртуальная сеть** — чтобы изменить виртуальную сеть, щелкните **Изменить виртуальную сеть**. 
    - **Подсеть** — чтобы изменить подсеть, выберите **Изменить подсеть**. 
    - **Настройка IP-адреса** — укажите, какие IP-адреса необходимо использовать (общедоступные, частные или общие). Дополнительные сведения см. в статье [Общие IP-адреса в Azure DevTest Labs](./devtest-lab-shared-ip.md).
    - **Дата и время окончания срока действия** . Вы не можете изменить это поле. 
    - **Make this machine claimable** (Разрешить запрашивать эту виртуальную машину) — этот параметр означает, что при создании виртуальной машины права владения не будут назначаться. Вместо этого пользователи лаборатории смогут становиться владельцами этой виртуальной машины ("запрашивать" ее) на странице лаборатории.  

        ![Снимок экрана, на котором показаны дополнительные параметры для страницы "Создание формулы (базовая)".](./media/devtest-lab-create-formulas/advanced-settings.png)
    - Если в качестве основы выбран общий образ коллекции образов, вы увидите поле **версия изображения** , позволяющее выбрать версию образа из коллекции, которую нужно использовать в качестве основы. 

        ![Страница "Дополнительные параметры"](./media/devtest-lab-create-formulas/advanced-settings-shared-image-gallery.png)
8. Для создания формулы выберите **Отправить**.

9. Когда формула создана, она отображается на странице **Формулы**.

### <a name="create-a-formula-from-a-vm"></a>Создание формулы на основе виртуальной машины
Ниже приводятся пошаговые инструкции по созданию формулы на основе существующей виртуальной машины. 

> [!NOTE]
> Для создания формулы на основе виртуальной машины необходимо, чтобы эта виртуальная машина была создана после 30 марта 2016 г. 
> 
> 

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.  
4. На странице **Обзор** выберите виртуальную машину, на основе которой будет создана формула.
   
    ![Лабораторные виртуальные машины](./media/devtest-lab-create-formulas/my-vms.png)
5. На странице виртуальной машины выберите **Create formula (reusable base)** (Создать формулу (базовый образ, используемый повторно)).
   
    ![Создание формулы](./media/devtest-lab-create-formulas/create-formula-menu.png)
6. На странице **Create formula** (Создание формулы) введите **имя** и **описание** новой формулы в соответствующих полях.
   
    ![Страница создания формулы](./media/devtest-lab-create-formulas/create-formula-blade.png)
7. Нажмите кнопку **ОК** , чтобы создать формулу.

## <a name="modify-a-formula"></a>Изменение формулы
Чтобы изменить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.  
4. На странице лаборатории выберите **Formulas (reusable bases)** (Формулы (базовые образы, используемые повторно)).
   
    ![Снимок экрана, на котором показана страница лаборатории с выбранным параметром "формулы (базы с возможностью повторного использования)".](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. На странице **Lab formulas** (Формулы лаборатории) выберите формулу, которую нужно изменить.
6. На странице **Изменить формулу** внесите необходимые изменения и щелкните **Обновить**.

## <a name="delete-a-formula"></a>Удаление формулы
Чтобы удалить формулу, выполните указанные ниже действия.

1. Войдите на [портал Azure](https://go.microsoft.com/fwlink/p/?LinkID=525040).
2. Щелкните **Все службы** и выберите в списке **DevTest Labs**.
3. Из списка лабораторий выберите нужную лабораторию.  
4. На странице **параметров** лаборатории выберите **Формулы**.
   
    ![Меню формулы](./media/devtest-lab-manage-formulas/lab-settings-formulas.png)
5. На странице **Lab formulas** (Формулы лаборатории) щелкните многоточие справа от формулы, которую нужно удалить.
   
    ![Снимок экрана, на котором показана страница "формулы лаборатории" с многоточием для выделенных параметров формулы.](./media/devtest-lab-manage-formulas/lab-formulas-blade.png)
6. В контекстном меню формулы выберите **Удалить**.
   
    ![Контекстное меню формулы](./media/devtest-lab-manage-formulas/formula-delete-context-menu.png)
7. В диалоговом окне подтверждения удаления нажмите кнопку **Да** .

[!INCLUDE [devtest-lab-try-it-out](../../includes/devtest-lab-try-it-out.md)]

## <a name="related-blog-posts"></a>Связанные записи в блогах
* [Custom images or formulas? (Пользовательские изображения или формулы?)](devtest-lab-faq.md#what-is-the-difference-between-a-custom-image-and-a-formula)

## <a name="next-steps"></a>Дальнейшие действия
После создания формулы, которая служит для создания виртуальных машин, можно [добавить виртуальную машину в лабораторию](devtest-lab-add-vm.md).

