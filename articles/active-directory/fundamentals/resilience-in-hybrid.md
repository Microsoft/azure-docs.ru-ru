---
title: Создание более устойчивой гибридной проверки подлинности в Azure Active Directory
description: Руководством для архитекторов и ИТ-администраторов по созданию отказоустойчивой гибридной инфраструктуры.
services: active-directory
author: BarbaraSelden
manager: daveba
ms.service: active-directory
ms.workload: identity
ms.subservice: fundamentals
ms.topic: conceptual
ms.date: 11/30/2020
ms.author: baselden
ms.reviewer: ajburnle
ms.custom: it-pro, seodec18
ms.collection: M365-identity-device-management
ms.openlocfilehash: de01788c01d4d6dedd9563faaaac07bff30bbd97
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "98724765"
---
# <a name="build-resilience-in-your-hybrid-architecture"></a>Устойчивость к сборке в гибридной архитектуре

Гибридная проверка подлинности позволяет пользователям получать доступ к облачным ресурсам с помощью локальных удостоверений. Гибридная инфраструктура включает как облачные, так и локальные компоненты.

* К облачным компонентам относятся Azure AD, ресурсы и службы Azure, облачные приложения вашей организации и приложения SaaS.

* К локальным компонентам относятся локальные приложения, ресурсы, такие как базы данных SQL, и поставщик удостоверений, например Windows Server Active Directory. 

> [!IMPORTANT]
> При планировании устойчивости в гибридной инфраструктуре он является ключом к уменьшению зависимостей и единых точек отказа. 

Корпорация Майкрософт предлагает три механизма гибридной проверки подлинности. Параметры перечислены в порядке устойчивости. Рекомендуется по возможности реализовать синхронизацию хэша паролей.

* [Синхронизация хэшей паролей](../hybrid/whatis-phs.md) (PHS) использует Azure AD Connect для синхронизации удостоверения и хеширования хэша пароля с Azure AD, позволяя пользователям входить в облачные ресурсы с локальным паролем. PHS имеет локальные зависимости только для синхронизации, а не для проверки подлинности.

* [Сквозная проверка подлинности](../hybrid/how-to-connect-pta.md) (PTA) перенаправляет пользователей в Azure AD для входа. Затем имя пользователя и пароль проверяются на Active Directory локально с помощью агента, развернутого в корпоративной сети. У PTA есть локальное размещение агентов Azure AD PTA, расположенных на локальных серверах.

* Клиенты [Федерации](../hybrid/whatis-fed.md) развертывают службу федерации, например AD FS, а затем Azure AD проверяет утверждение SAML, созданное службой федерации. Федерация имеет наибольшую зависимость от локальной инфраструктуры и, следовательно, больше точек сбоя. 

   
Возможно, вы используете один или несколько из этих методов в вашей организации. Дополнительные сведения см. в статье [Выбор правильного метода аутентификации для решения гибридной идентификации Azure AD](../hybrid/choose-ad-authn.md). В этой статье содержится дерево принятия решений, которое поможет принять решение о методологии.

## <a name="password-hash-synchronization"></a>Синхронизация хэша паролей

Самым простым и надежным гибридным вариантом проверки подлинности в Azure AD является [Синхронизация хэшей паролей](../hybrid/whatis-phs.md) , которая не имеет зависимости локальной инфраструктуры удостоверений при обработке запросов проверки подлинности. После синхронизации удостоверений с хэшированными паролями в Azure AD пользователи могут проходить проверку подлинности в облачных ресурсах без зависимости от локальных компонентов удостоверений. 

![Схема архитектуры PHS](./media/resilience-in-hybrid/admin-resilience-password-hash-sync.png)

При выборе этого варианта проверки подлинности вы не будете испытывать проблемы, когда локальные компоненты удостоверений становятся недоступными. Локальное прерывание может происходить по многим причинам, включая сбои оборудования, перебои в работе, стихийные бедствия и атаки на вредоносные программы. 

### <a name="how-do-i-implement-phs"></a>Разделы справки реализовать PHS?

Чтобы реализовать PHS, см. следующие ресурсы:

* [Реализация синхронизации хэшей паролей с Azure AD Connect](../hybrid/how-to-connect-password-hash-synchronization.md)

* [Включить синхронизацию хэшей паролей](../hybrid/how-to-connect-password-hash-synchronization.md)

Если ваши требования не позволяют использовать PHS, используйте сквозную аутентификацию.

## <a name="pass-through-authentication"></a>Сквозная проверка подлинности

Сквозная проверка подлинности зависит от агентов проверки подлинности, размещенных локально на серверах. Между Azure AD и локальными агентами PTA имеется постоянное подключение или служебная шина. Брандмауэр, серверы, на которых размещаются агенты проверки подлинности, и локальный Active Directory Windows Server (или другой поставщик удостоверений) являются потенциальными точками сбоя. 

![Схема архитектуры PTA](./media/resilience-in-hybrid/admin-resilience-pass-through-authentication.png)

### <a name="how-do-i-implement-pta"></a>Разделы справки реализовать PTA?

Чтобы реализовать сквозную аутентификацию, см. следующие ресурсы.

* [Как работает сквозная проверка подлинности](../hybrid/how-to-connect-pta-how-it-works.md)

* [Руководство по безопасности сквозной аутентификации Azure Active Directory](../hybrid/how-to-connect-pta-security-deep-dive.md)

* [Установка сквозной проверки подлинности Azure AD](../hybrid/how-to-connect-pta-quick-start.md)

* Если вы используете PTA, определите [топологию высокой доступности](../hybrid/how-to-connect-pta-quick-start.md).

 ## <a name="federation"></a>Федерация

Федерация включает создание отношений доверия между Azure AD и службой федерации, включая обмен конечными точками, сертификаты подписи маркеров и другие метаданные. Когда запрос поступает в Azure AD, он считывает конфигурацию и перенаправляет пользователя в настроенные конечные точки. На этом этапе пользователь взаимодействует со службой федерации, которая выдает утверждение SAML, проверяемое Azure AD. 

На следующей диаграмме показана топология корпоративного службы федерации Active Directory (AD FS) (AD FS), которая включает избыточные серверы федерации и прокси-службы веб приложения в нескольких локальных центрах обработки данных. Эта конфигурация полагается на корпоративные сетевые компоненты инфраструктуры, такие как DNS, балансировка сетевой нагрузки с возможностями геосходства, брандмауэры и т. д. Все локальные компоненты и подключения подвержены сбоям. Дополнительные сведения см. в [документации по планированию емкости AD FS](/windows-server/identity/ad-fs/design/planning-for-ad-fs-server-capacity) .

> [!NOTE]
>  Федерация имеет наибольшее число локальных зависимостей и, следовательно, наиболее вероятные точки отказа. Хотя на этой схеме показано AD FS, другие локальные поставщики удостоверений подвержены аналогичным вопросам проектирования для достижения высокого уровня доступности, масштабируемости и отработки отказа.

![Схема архитектуры Федерации](./media/resilience-in-hybrid/admin-resilience-federation.png)

 ### <a name="how-do-i-implement-federation"></a>Разделы справки реализовать федерацию?

Если вы реализуете стратегию федеративной проверки подлинности или хотите сделать ее более устойчивой, ознакомьтесь со следующими ресурсами.

* [Что такое Федеративная проверка подлинности](../hybrid/whatis-fed.md)

* [Принцип работы федерации](../hybrid/how-to-connect-fed-whatis.md)

* [Список совместимости с федерацией Azure AD](../hybrid/how-to-connect-fed-compatibility.md)

* Следуйте указаниям в [документации по планированию емкости AD FS](/windows-server/identity/ad-fs/design/planning-for-ad-fs-server-capacity)

* [Развертывание AD FS в Azure IaaS](/windows-server/identity/ad-fs/deployment/how-to-connect-fed-azure-adfs)

* [Включение PHS](../hybrid/tutorial-phs-backup.md) вместе с Федерации

## <a name="next-steps"></a>Дальнейшие действия
Ресурсы по устойчивости для администраторов и архитекторов
 
* [Устойчивость к сборке с помощью управления учетными данными](resilience-in-credentials.md)

* [Устойчивость сборки к состояниям устройств](resilience-with-device-states.md)

* [Устойчивость сборки с помощью оценки непрерывного доступа (автоматизированного конструирования)](resilience-with-continuous-access-evaluation.md)

* [Устойчивость к сборке при аутентификации внешних пользователей](resilience-b2b-authentication.md)

* [Устойчивость к сборке в доступе к приложениям с помощью прокси приложения](resilience-on-premises-access.md)

Обеспечение устойчивости ресурсов для разработчиков

* [Создание устойчивости IAM в приложениях](resilience-app-development-overview.md)

* [Устойчивость сборок в CIAM Systems](resilience-b2c.md)