---
title: Управление учетными записями локальной службы | Azure Active Directory
description: Руководством по созданию и запуску процесса жизненного цикла учетных записей служб
services: active-directory
author: BarbaraSelden
manager: daveba
ms.service: active-directory
ms.workload: identity
ms.subservice: fundamentals
ms.topic: conceptual
ms.date: 2/15/2021
ms.author: baselden
ms.reviewer: ajburnle
ms.custom: it-pro, seodec18
ms.collection: M365-identity-device-management
ms.openlocfilehash: 503d5c5c8d605e56ca510f12cd9c6f5a1f21c0bc
ms.sourcegitcommit: d4734bc680ea221ea80fdea67859d6d32241aefc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100417970"
---
# <a name="governing-on-premises-service-accounts"></a>Управление учетными записями локальной службы

В Active Directory Windows существует четыре типа локальных учетных записей служб:

* [Групповые управляемые учетные записи служб](service-accounts-group-managed.md) (gmsa)

* [автономные управляемые учетные записи служб](service-accounts-standalone-managed.md) (смсас)

* [Учетные записи компьютеров](service-accounts-computer.md)

* [Учетные записи пользователей работают как учетные записи служб](service-accounts-user-on-premises.md)


Очень важно управлять учетными записями служб так: 

* Защита учетных записей служб на основе требований и целей их использования.

* Управление жизненным циклом учетных записей служб и их учетных данных.

* Оцените учетные записи служб в зависимости от риска, к которому они будут предоставляться, и разрешений, которые они приносят. 

* Убедитесь, что Active Directory и Azure Active Directory не имеют устаревших учетных записей служб с потенциально более далекоми разрешениями.

## <a name="principles-for-creating-a-new-service-account"></a>Принципы создания новой учетной записи службы

При создании новой учетной записи службы используйте следующие критерии.

| Принципы работы| Рекомендации | 
| - |- | 
| Сопоставление учетной записи службы| Привязать учетную запись службы к одной службе, приложению или сценарию. |
| владельца;| Убедитесь, что есть владелец, который запрашивает и несет ответственность за учетную запись. |
| Область| Определите область четко и представит длительность использования для учетной записи службы. |
| Назначение| Создание учетных записей служб для одной конкретной цели. |
| Privilege| Примените принцип наименьших привилегий, выполнив следующие действия. <br>Никогда не назначайте их встроенным группам, например администраторам.<br> При необходимости удалите права локального компьютера.<br>Адаптация доступа и использование делегирования Active Directory для доступа к каталогу.<br>Использование разрешений на детализированный доступ.<br>Установка ограничений на учетные записи и ограничения на основе расположения для учетных записей служб на основе пользователей |
| Мониторинг и аудит использования| Отслеживайте данные входа и убедитесь, что они соответствуют предполагаемому использованию. Настройте оповещения для аномального использования. |

### <a name="enforce-least-privilege-for-user-accounts-and-limit-account-overuse"></a>Обеспечение минимальных привилегий для учетных записей пользователей и ограничение учетной записи

Используйте следующие параметры с учетными записями пользователей, используемыми в качестве учетных записей служб.

* [**Срок действия учетной записи**](https://docs.microsoft.com/powershell/module/activedirectory/set-adaccountexpiration?view=winserver2012-ps): задайте автоматический срок действия учетной записи службы по истечении периода проверки, если не будет определено, что он должен быть продолжен.

*  **Логонворкстатионс**: Ограничьте разрешения для того места, где может входить учетная запись службы. Если он выполняется локально на компьютере и обращается только к ресурсам на этом компьютере, ограничьте его вход в систему в любом месте.

* [**Невозможно изменить пароль**](https://docs.microsoft.com/powershell/module/addsadministration/set-aduser?view=win10-ps): запретить учетной записи службы изменять свой собственный пароль, присвоив параметру значение false.

 
## <a name="build-a-lifecycle-management-process"></a>Создание процесса управления жизненным циклом

Чтобы обеспечить безопасность учетных записей служб, необходимо управлять ими с момента, когда они не будут списаны. 

Для управления жизненным циклом учетных записей служб используйте следующую процедуру.

1. Получение сведений об использовании для учетной записи
1. Подключение учетной записи службы и приложения к базе данных управления конфигурацией (CMDB)
1. Оценка рисков или формальный анализ
1. Создайте учетную запись службы и примените ограничения.
1. Планирование и выполнение повторяющихся проверок. При необходимости измените разрешения и области.
1. При необходимости отмените предоставление учетной записи.

### <a name="collect-usage-information-for-the-service-account"></a>Получение сведений об использовании для учетной записи службы

Собирайте соответствующие бизнес-сведения для каждой учетной записи службы. В приведенной ниже таблице показаны минимальные сведения, которые необходимо собрать, но необходимо собрать все необходимое, чтобы сделать бизнес-сценарий для существования учетных записей.

| Данные| Сведения |
| - | - |
| Владелец| Пользователь или группа, которые поддается учетной записи службы |
| Назначение| Назначение учетной записи службы |
| Разрешения (области)| Ожидаемый набор разрешений |
| Ссылки на базу данных управления конфигурацией (CMDB)| Межканальная учетная запись службы с целевым скриптом, приложением и владельцами |
| Риск| Оценка рисков и влияния на бизнес, основанная на оценке рисков безопасности |
| Время существования| Ожидаемое максимальное время существования для включения планирования истечения срока действия учетной записи или повторной сертификации |


 

В идеале сделайте запрос на самостоятельную учетную запись и попросите нужные сведения. Владелец, который может быть владельцем приложения или организации, участником или владельцем инфраструктуры. Использование такого средства, как Microsoft Forms для этого запроса, и связанная с ним информация позволяет легко перенести его в средство инвентаризации CMDB, если учетная запись утверждена.

### <a name="onboard-service-account-to-cmdb"></a>Подключение учетной записи службы к CMDB

Храните собранные сведения в приложении типа CMDB. Помимо бизнес-информации, включите все зависимости в другую инфраструктуру, приложения и процессы.  Этот центральный репозиторий упрощает:

* Оцените риск.

* Настройте учетную запись службы с требуемыми ограничениями.

* Ознакомьтесь с соответствующими функциональными зависимостями и зависимости безопасности.

* Регулярно проверяют безопасность и продолжайте понужды.

* Обратитесь к владельцам для просмотра, снятия с учета и изменения учетной записи службы.

Рассмотрим учетную запись службы, которая используется для запуска веб-сайта и имеет привилегии для подключения к одной или нескольким базам данных SQL. Данные, хранящиеся в CMDB для этой учетной записи службы, могут быть:

|Данные | Сведения|
| - | - |
| Владелец, Deputy| Джон раскрытия, Анна Майерс |
| Назначение| Запустите веб-страницу HR и подключитесь к HR-databases. Может олицетворять конечного пользователя при доступе к базам данных. |
| Разрешения, области| HR-Web Server: локальный вход, запуск веб-страницы<br>HR-SQL1: локальный вход в систему, чтение во всей базе данных HR *<br>HR-SQL2: локальный вход в систему, чтение ЗАРПЛАТы * база данных |
| Cost Center| 883944 |
| Оценка риска| Высокое Влияние на бизнес: средний; Частная информация; Высокое |
| Ограничения учетной записи| Вход в: только вышеупомянутые серверы; Невозможно изменить пароль; Политика MBI-Password; |
| Время существования| неограниченный |
| Цикл проверки| BI-ежегодно (по владельцам, по группам безопасности, по конфиденциальности) |

### <a name="perform-risk-assessment-or-formal-review-of-service-account-usage"></a>Оценка рисков и формальный анализ использования учетной записи службы

Учитывая его разрешения и назначение, оцените риск, который может привести учетной записи к связанному приложению или службе, а также к инфраструктуре, если она скомпрометирована. Рассмотрим как прямые, так и косвенные риски. 

* Что может дать злоумышленнику прямой доступ?

* Какие другие сведения или системы могут получить доступ к учетной записи службы?

* Можно ли использовать учетную запись для предоставления дополнительных разрешений?

* Как вы будете иметь представление об изменении разрешений?

Оценка рисков, проводимая после проведения и документирования, может оказать влияние на:

* Ограничения учетной записи

* Время существования учетной записи

* Требования к проверке учетной записи (ритмичность и проверяющие)

### <a name="create-a-service-account-and-apply-account-restrictions"></a>Создание учетной записи службы и применение ограничений для учетной записи

Создавайте учетную запись службы только после документирования соответствующей информации в CMDB, и вы выполняете оценку рисков. Ограничения учетной записи должны быть согласованы с оценкой рисков. Учитывайте следующие ограничения, связанные с оценкой.

* [Срок действия учетной записи](https://docs.microsoft.com/powershell/module/activedirectory/set-adaccountexpiration?view=winserver2012-ps)

   * Для всех учетных записей пользователей, используемых в качестве учетных записей служб, определите реалистичную и определенную конечную дату для использования. Задайте его с помощью флага "срок действия учетной записи". Дополнительные сведения см. в разделе[ Set-адаккаунтекспиратион](https://docs.microsoft.com/powershell/module/addsadministration/set-adaccountexpiration?view=win10-ps). 

* Вход в ([логонворкстатион](https://docs.microsoft.com/powershell/module/addsadministration/set-aduser?view=win10-ps))

* Требования [политики паролей](https://docs.microsoft.com/azure/active-directory-domain-services/password-policy)

* Создание в [расположении подразделения](https://docs.microsoft.com/windows-server/identity/ad-ds/plan/delegating-administration-of-account-ous-and-resource-ous) , которое обеспечивает управление только привилегированными пользователями

* Настройте и собирайте аудит [, который обнаруживает изменения](https://docs.microsoft.com/windows/security/threat-protection/auditing/audit-directory-service-changes) в учетной записи службы и [использует учетную запись службы](https://www.manageengine.com/products/active-directory-audit/how-to/audit-kerberos-authentication-events.html).

Когда все будет готово к переходу в рабочую среду, предоставьте доступ к учетной записи службы безопасно. 

### <a name="schedule-regular-reviews-of-service-accounts"></a>Планирование регулярных проверок учетных записей служб

Настройка регулярных проверок учетных записей служб, классифицированных как средний и высокий риск. Проверки должны включать: 

* Аттестация владельца до нужной учетной записи и обоснование прав и областей.

* Ознакомьтесь с группами обеспечения конфиденциальности и безопасности, включая оценку вышестоящего и подчиненного подключений.

* Данные из аудита, гарантирующие, что он используется только в целях назначения

### <a name="deprovision-service-accounts"></a>Отменить подготовку учетных записей служб

В процессе отмены подготовки сначала удалите разрешения и монитор, а затем удалите учетную запись, если это необходимо.

Отменить подготовку учетных записей служб в следующих случаях:

* Скрипт или приложение, для которых была создана учетная запись службы, снято с учета.

* Функция в скрипте или приложении, для которой используется учетная запись службы (например, доступ к определенному ресурсу), будет прекращена.

* Учетная запись службы заменена другой учетной записью службы.

После удаления всех разрешений Используйте этот процесс для удаления учетной записи.

1. После отмены подготовки связанного приложения или скрипта Отслеживайте входы и доступ к ресурсам для связанных учетных записей служб, чтобы убедиться, что они не используются в другом процессе. Если вы уверены, что он больше не нужен, перейдите к следующему шагу.

2. Отключите учетную запись службы от входа и убедитесь, что она больше не нужна. Создайте бизнес-политику для учетных записей времени, которые должны оставаться отключенными.

3. Удалите учетную запись службы после выполнения политики "осталось отключено". 

   * Для MSAs можно [удалить его](https://docs.microsoft.com/powershell/module/activedirectory/uninstall-adserviceaccount?view=winserver2012-ps) с помощью PowerShell или удалить вручную из контейнера учетной записи управляемой службы.

   * Учетные записи компьютеров или пользователей можно удалить вручную из Active Directory.

## <a name="next-steps"></a>Следующие шаги
См. следующие статьи о защите учетных записей служб.

* [Общие сведения о локальных учетных записях служб](service-accounts-on-premises.md)

* [Безопасная групповая управляемая учетная запись службы](service-accounts-group-managed.md)

* [Защищенные автономные управляемые учетные записи служб](service-accounts-standalone-managed.md)

* [Защита учетных записей компьютеров](service-accounts-computer.md)

* [Защита учетных записей пользователей](service-accounts-user-on-premises.md)

* [Управление учетными записями локальной службы](service-accounts-govern-on-premises.md)