---
title: Типы приложений для платформы Microsoft Identity | Службы
description: Типы приложений и сценариев, поддерживаемых платформой идентификации Майкрософт.
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.workload: identity
ms.topic: conceptual
ms.date: 11/13/2020
ms.author: ryanwi
ms.reviewer: saeeda, jmprieur
ms.custom: aaddev, fasttrack-edit, contperf-fy21q2
ms.openlocfilehash: 7ec309f016e73642262399bd75e7b5146bc5e497
ms.sourcegitcommit: 5cdd0b378d6377b98af71ec8e886098a504f7c33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2021
ms.locfileid: "98752782"
---
# <a name="application-types-for-the-microsoft-identity-platform"></a>Типы приложений для платформы Microsoft Identity

Платформа Microsoft Identity поддерживает проверку подлинности для различных архитектур современных приложений, все они основаны на стандартных протоколах [OAuth 2,0 или OpenID Connect Connect](active-directory-v2-protocols.md). В этой статье описываются типы приложений, которые можно создавать с помощью платформы удостоверений Microsoft вне зависимости от выбранного языка и платформы. Эти сведения помогут вам понять высокоуровневые сценарии до начала работы с кодом в [сценариях приложений](authentication-flows-app-scenarios.md#application-scenarios).

## <a name="the-basics"></a>Основные сведения

Необходимо зарегистрировать каждое приложение, использующее платформу удостоверений Майкрософт, в портал Azure [Регистрация приложений](https://go.microsoft.com/fwlink/?linkid=2083908). В процессе регистрации приложения будет задано несколько параметров приложения:

* **ИД приложения (клиента)** , идентифицирующий ваше приложение уникальным образом
* **универсальный код ресурса (URI) перенаправления**, который можно использовать для направления ответов к приложению;
* Несколько других значений, относящихся к сценарию, например поддерживаемые типы учетных записей

Дополнительные сведения см. в статье о [регистрации приложения](quickstart-register-app.md).

После регистрации приложения приложение взаимодействует с платформой Microsoft Identity, отправляя запросы к конечной точке. Мы предоставляем платформы и библиотеки с открытым кодом, которые отвечают обрабатывают данные этих запросов. Также имеется возможность самостоятельно реализовать логику аутентификации, создавая запросы к этим конечным точкам.

```HTTP
https://login.microsoftonline.com/common/oauth2/v2.0/authorize
https://login.microsoftonline.com/common/oauth2/v2.0/token
```

## <a name="single-page-apps-javascript"></a>Одностраничные приложения (JavaScript)

Многие современные приложения содержат одностраничное приложение переднего плана, созданное преимущественно с помощью языка JavaScript, часто на платформе Angular, React или Vue. Платформа удостоверений Майкрософт поддерживает эти приложения с помощью протокола [OpenID Connect Connect](v2-protocols-oidc.md) для проверки подлинности и либо в [неявном потоке предоставления OAuth 2,0](v2-oauth2-implicit-grant-flow.md) , либо в более позднем [коде авторизации OAuth 2,0 + PKCE](v2-oauth2-auth-code-flow.md) для авторизации (см. ниже).

На приведенной ниже схеме последовательности показан код авторизации OAuth 2,0 (с подробными сведениями о PKCE опущен), где приложение получает код от конечной точки платформы идентификации Майкрософт `authorize` и активирует его для токенов и обновляет маркеры с помощью межсайтовых веб-запросов. Срок действия маркера обновления истекает каждые 24 часа, и приложение должно запросить другой код. В дополнение к маркеру доступа, `id_token` который представляет пользователя, выполнившего вход, в клиентское приложение, как правило, запрашивается в том же потоке и (или) отдельном запросе OpenID Connect Connect (не показано здесь).

:::image type="content" source="media/v2-oauth-auth-code-spa/active-directory-oauth-code-spa.svg" alt-text="Схема, показывающая поток кода авторизации OAuth 2 между одностраничным приложением и конечной точкой службы маркеров безопасности." border="false":::

Увидеть этот сценарий в действии можно в нашем [учебнике по входу пользователей и вызову API Microsoft Graph из одностраничного приложения JavaScript с помощью потока кода авторизации](tutorial-v2-javascript-auth-code.md).

### <a name="authorization-code-flow-vs-implicit-flow"></a>Поток кода авторизации и неявный поток

Большую часть времени существования OAuth 2.0 [неявный поток](v2-oauth2-implicit-grant-flow.md) был рекомендованным способом создания одностраничных приложений. С удалением [файлов cookie сторонних производителей](reference-third-party-cookies-spas.md) и [повышением внимания](https://tools.ietf.org/html/draft-ietf-oauth-security-topics-14) к проблемам безопасности, связанным с неявным потоком, мы стали использовать поток кода авторизации для одностраничных приложений.

Чтобы обеспечить совместимость приложения в Safari и других браузерах с высокими требованиями к конфиденциальности, мы рекомендуем использовать не неявный поток, а поток кода авторизации.

## <a name="web-apps"></a>Веб-приложения

Для веб-приложений (.NET, PHP, Java, Ruby, Python, Node), доступных пользователю через браузер, для входа пользователей можно использовать [OpenID Connect](active-directory-v2-protocols.md). В OpenID Connect веб-приложение получает маркер идентификации. Это маркер безопасности, который проверяет удостоверение пользователя и предоставляет сведения о пользователе в форме утверждений.

```JSON
// Partial raw ID token
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImtyaU1QZG1Cd...

// Partial content of a decoded ID token
{
    "name": "John Smith",
    "email": "john.smith@gmail.com",
    "oid": "d9674823-dffc-4e3f-a6eb-62fe4bd48a58"
    ...
}
```

Дополнительные сведения о различных типах токенов, используемых в платформе Microsoft Identity, доступны в справочнике по [маркерам доступа](access-tokens.md) и [id_token справочнике](id-tokens.md) .

В приложениях веб-сервера поток аутентификации для входа состоит из следующих базовых этапов.

![Показывает поток проверки подлинности в веб-приложении](./media/v2-app-types/convergence-scenarios-webapp.svg)

Удостоверение пользователя можно проверить, проверив маркер идентификации с помощью открытого ключа подписывания, полученного от платформы Microsoft Identity. Для этого задается файл cookie сеанса, с помощью которого можно идентифицировать пользователя при последующих запросах страницы.

Чтобы увидеть этот сценарий в действии, попробуйте использовать примеры кода в [веб-приложении, которое выполняет вход в систему пользователей](scenario-web-app-sign-user-overview.md).

Помимо простого входа в систему, приложению веб-сервера может потребоваться доступ к некоторым другим веб-службам, например интерфейсу REST API. В этом случае приложение веб-сервера участвует в объединенном потоке OpenID Connect и OAuth 2.0 с использованием [потока кода авторизации OAuth 2.0](v2-oauth2-auth-code-flow.md). Чтобы больше узнать об этом сценарии, ознакомьтесь с тем, как [приступить к работе с веб-приложениями и интерфейсами веб-API](https://github.com/AzureADQuickStarts/AppModelv2-WebApp-WebAPI-OpenIDConnect-DotNet).

## <a name="web-apis"></a>Веб-API

Платформу Microsoft Identity можно использовать для защиты веб-служб, таких как веб-API RESTFUL вашего приложения. Веб-API можно реализовать на множестве платформ и языков. Их также можно реализовать с помощью триггеров HTTP в функциях Azure. Веб-API вместо маркеров идентификации и файлов cookie сеанса использует маркер доступа OAuth 2.0 для защиты данных и аутентификации входящих запросов. Объект, вызывающий веб-API, добавляет маркер доступа в начале заголовка авторизации HTTP-запроса, как показано ниже.

```HTTP
GET /api/items HTTP/1.1
Host: www.mywebapi.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6...
Accept: application/json
...
```

Веб-API использует маркер доступа для проверки удостоверения объекта, вызывающего API, и получения сведений о нем из утверждений, которые закодированы в маркере доступа. Дополнительные сведения о различных типах токенов, используемых в платформе Microsoft Identity, доступны в справочнике по [маркерам доступа](access-tokens.md) и [id_token](id-tokens.md) .

Веб-API может дать пользователям возможность применять определенные функции и данные или отказаться от них, предоставляя разрешения, которые также называют [областями](v2-permissions-and-consent.md). Чтобы вызывающее приложение получило разрешение для области, пользователь должен дать согласие на это. Платформа Microsoft Identity запрашивает у пользователя разрешение, а затем записывает разрешения во все маркеры доступа, получаемые веб-API. Веб-API проверяет маркеры доступа, получаемые при каждом вызове, и выполняет проверки авторизации.

Веб-API может получать маркеры доступа от всех типов приложений, включая приложения веб-сервера, классические и мобильные приложения, одностраничные приложения, серверные управляющие программы и даже другие веб-API. Общий поток для веб-API выглядит следующим образом.

![Показывает поток проверки подлинности в веб-API](./media/v2-app-types/convergence-scenarios-webapi.svg)

Чтобы узнать, как защитить веб-API с помощью маркеров доступа OAuth2, ознакомьтесь с примерами кода веб-API в [сценарии защищенного веб-API](scenario-protected-web-api-overview.md).

Во многих случаях веб-интерфейсам API также требуется выполнять исходящие запросы к другим нижестоящим веб-API, защищенным платформой удостоверений Microsoft. Для этого веб-API могут воспользоваться преимуществами потока **От имени**. Это позволяет им обменять входящий маркер доступа на другой маркер доступа, который будет использоваться в исходящих запросах. Дополнительные сведения см. в [статье о платформе Microsoft Identity и OAuth 2,0 от имени потока](v2-oauth2-on-behalf-of-flow.md).

## <a name="mobile-and-native-apps"></a>Мобильные и собственные приложения

Приложениям, установленным на устройстве, например мобильным и классическим приложениям, часто требуется доступ к внутренним службам или интерфейсам веб-API, которые хранят данные и выполняют различные функции от имени пользователя. В этих приложениях можно реализовать процесс входа и авторизации во внутренних службах с помощью [потока кода авторизации OAuth 2.0](v2-oauth2-auth-code-flow.md).

В этом потоке приложение получает код авторизации от платформы идентификации Майкрософт при входе пользователя в систему. Код авторизации представляет собой разрешение, полученное от приложения, на вызов внутренних служб от имени пользователя, выполнившего вход. Приложение может передать код авторизации в фоновом режиме, чтобы получить маркер доступа OAuth 2.0 и маркер обновления. Приложение может использовать маркер доступа для аутентификации в интерфейсах веб-API в HTTP-запросах и использовать маркер обновления, чтобы получать новые маркеры доступа после истечения срока действия старых маркеров.

![Показывает поток аутентификации собственного приложения](./media/v2-app-types/convergence-scenarios-native.svg)

> [!NOTE]
> Если приложение использует System WebView по умолчанию, ознакомьтесь со сведениями о функции "подтверждение входа в систему" и кодом ошибки AADSTS50199 в [кодах ошибок проверки подлинности и авторизации Azure AD](reference-aadsts-error-codes.md).

## <a name="daemons-and-server-side-apps"></a>Управляющие программы и серверные приложения

Приложениям, использующим долговременные процессы или работающим без взаимодействия с пользователем, тоже нужна возможность доступа к защищенным ресурсам, таким как интерфейсы веб-API. Такие приложения могут выполнять аутентификацию и получать маркеры, используя удостоверение приложения (а не делегированное удостоверение пользователя) с помощью потока учетных данных клиента OAuth 2.0. Можно подтвердить удостоверение приложения с помощью секрета или сертификата клиента. Дополнительные сведения см. в разделе [консольное приложение управляющей программы .NET Core с использованием платформы удостоверений Microsoft](https://github.com/Azure-Samples/active-directory-dotnetcore-daemon-v2).

В этом потоке приложение взаимодействует непосредственно с конечной точкой `/token`, чтобы получить доступ:

![Показывает поток аутентификации управляющей программы](./media/v2-app-types/convergence-scenarios-daemon.svg)

Чтобы создать управляющую программу, изучите [документацию по учетным данным клиентов](v2-oauth2-client-creds-grant-flow.md) или ознакомьтесь с [примером приложения .NET](https://github.com/Azure-Samples/active-directory-dotnet-daemon-v2).

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы знакомы с типами приложений, поддерживаемыми платформой удостоверений Microsoft, узнайте больше о [OAuth 2.0 и OpenID Connect](active-directory-v2-protocols.md), чтобы получить представление о компонентах протокола, используемых различными сценариями.
