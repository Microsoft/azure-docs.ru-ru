---
title: Регистрация одностраничных приложений (SPA) | Azure
titleSuffix: Microsoft identity platform
description: Узнайте, как создать одностраничное приложение (регистрация приложения)
services: active-directory
author: hahamil
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.topic: conceptual
ms.workload: identity
ms.date: 05/19/2020
ms.author: hahamil
ms.custom: aaddev
ms.openlocfilehash: 9366bb5b2bb5820245ec1b699bbf2ddda0dd9f9d
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100103181"
---
# <a name="single-page-application-app-registration"></a>Одностраничное приложение: Регистрация приложения

Чтобы зарегистрировать одностраничное приложение (SPA) на платформе удостоверений Майкрософт, сделайте следующее. Процедура регистрации будет разной для MSAL.js 1.0 с поддержкой неявного потока предоставления разрешений и MSAL.js 2.0 с поддержкой потока кода авторизации с использованием PKCE.

## <a name="create-the-app-registration"></a>Создание регистрации приложения

Для обоих типов приложений (на основе MSAL.js версии  1.0 и 2.0) сначала создается исходная регистрация приложения.

1. Войдите на <a href="https://portal.azure.com/" target="_blank">портал Azure</a>.
1. Если у вас есть доступ к нескольким клиентам, в верхнем меню используйте фильтр **Каталог и подписка** :::image type="icon" source="./media/common/portal-directory-subscription-filter.png" border="false":::, чтобы выбрать клиент, в котором следует зарегистрировать приложение.
1. Найдите и выберите **Azure Active Directory**.
1. В разделе **Управление** выберите **Регистрация приложений** > **Создать регистрацию**.
1. Введите значение **Name** (Имя) для приложения. Пользователи приложения могут видеть это имя. Вы можете изменить его позже.
1. Выберите **Поддерживаемые типы учетных записей** для приложения. **НЕ** указывайте **URI перенаправления**. Описание различных типов учетных записей см. в разделе [Регистрация приложения](quickstart-register-app.md).
1. Щелкните **Зарегистрировать**, чтобы создать регистрацию приложения.

Теперь присвойте этой регистрации приложения **URI перенаправления**, чтобы указать, куда платформа удостоверений Майкрософт будет перенаправлять клиенты с любыми маркерами безопасности. Выполните действия с учетом используемой в приложении версии MSAL.js:

- [MSAL.js 2.0 с потоком кода авторизации](#redirect-uri-msaljs-20-with-auth-code-flow) (рекомендуется)
- [MSAL.js 1.0 с неявным потоком](#redirect-uri-msaljs-10-with-implicit-flow)

## <a name="redirect-uri-msaljs-20-with-auth-code-flow"></a>URI перенаправления: [MSAL.js 2,0 с потоком кода проверки подлинности](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-browser)

Выполните следующие действия, чтобы добавить URI перенаправления для приложения с библиотекой MSAL.js 2.0 или более поздней версии. MSAL.js 2.0 и более поздние версии поддерживают поток кода авторизации с использованием PKCE и CORS, что связано с [ограничениями в браузерах на прием сторонних файлов cookie](reference-third-party-cookies-spas.md). Неявный поток предоставления разрешений в MSAL.js 2.0 и более поздних версиях не поддерживается.

1. На портале Azure выберите регистрацию приложения, создание которой описано в разделе [Создание регистрации приложения](#create-the-app-registration).
1. В разделе **Управление** выберите **Проверка подлинности** > **Добавить платформу**.
1. В разделе **Веб-приложения** щелкните плитку **Одностраничные приложения**.
1. В поле **URI перенаправления** введите [URI перенаправления](reply-url.md). **Не** устанавливайте ни один из флажков в разделе **неявное предоставление и гибридные потоки**.
1. Щелкните **Настроить**, чтобы завершить добавление URI перенаправления.

Итак, вы завершили регистрацию одностраничного приложения (SPA) и настроили URI перенаправления, на который будут перенаправляться все клиенты и оправляться маркеры безопасности. Когда вы завершите настройку URI перенаправления, используя плитку **Одностраничное приложение** на панели **Добавить платформу**, для регистрации приложения будет настроена поддержка потока кода авторизации с помощью PKCE и CORS.

Следуйте указаниям в [руководстве](tutorial-v2-javascript-auth-code.md) .

## <a name="redirect-uri-msaljs-10-with-implicit-flow"></a>URI перенаправления: [MSAL.js 1,0 с неявным потоком](https://github.com/AzureAD/microsoft-authentication-library-for-js/tree/dev/lib/msal-core)

Выполните следующие действия, чтобы добавить URI перенаправления для одностраничного приложения с библиотекой MSAL.js 1.3 или более ранней версии, которая использует поток неявного предоставления разрешений. Приложения, которые используют MSAL.js 1.3 или более раннюю версию, не поддерживают поток кода авторизации.

1. На портале Azure выберите регистрацию приложения, создание которой описано в разделе [Создание регистрации приложения](#create-the-app-registration).
1. В разделе **Управление** выберите **Проверка подлинности** > **Добавить платформу**.
1. В разделе **Веб-приложения** щелкните плитку **Одностраничные приложения**.
1. В поле **URI перенаправления** введите [URI перенаправления](reply-url.md).
1. Включить **неявное предоставление и гибридные потоки**:
    - Если приложение обрабатывает вход пользователей, щелкните **Маркеры идентификации**.
    - Если приложение вызывает с защищенный веб-API, выберите **Маркеры доступа**. Дополнительные сведения об этих типах маркеров см. в статьях [Маркеры идентификаторов платформы удостоверений Майкрософт](id-tokens.md) и [Маркеры доступа платформы удостоверений Майкрософт](access-tokens.md).
1. Щелкните **Настроить**, чтобы завершить добавление URI перенаправления.

Итак, вы завершили регистрацию одностраничного приложения (SPA) и настроили URI перенаправления, на который будут перенаправляться все клиенты и оправляться маркеры безопасности. Установив флажки **Маркеры идентификации** и **Маркеры доступа**, вы включили неявный поток предоставления разрешений.

Следуйте указаниям в [руководстве](tutorial-v2-javascript-spa.md) .

## <a name="note-about-authorization-flows"></a>Примечание о потоках авторизации

По умолчанию регистрация приложения, настроенная на платформе одностраничного приложения, включает поток кода авторизации. Но чтобы использовать этот поток, приложение должно работать с библиотекой MSAL.js 2.0 или более поздней версии.

Как уже упоминалось, одностраничные приложения с MSAL.js 1.3 могут работать только с потоком неявного предоставления разрешений. В текущих [рекомендациях по OAuth 2.0](v2-oauth2-auth-code-flow.md) предлагается использовать для одностраничных приложений поток кода авторизации, а не неявный поток. Наличие маркеров обновления с ограниченным сроком действия также позволяет приложению учитывать [современные ограничения браузеров в отношении конфиденциальности файлов cookie](reference-third-party-cookies-spas.md), например Safari ITP.

Когда все рабочие одностраничные приложения, которые используют эту регистрацию приложения, будут использовать MSAL.js 2.0 и поток кода авторизации, снимите флажок поддержки неявного предоставления разрешений на панели **Проверка подлинности** на портале Azure для этой регистрации приложения. Но если вы оставите включенным неявный поток (установленный флажок), приложения с MSAL.js 1.x и неявным потоком будут и дальше нормально работать.

## <a name="next-steps"></a>Дальнейшие действия

Настройте код приложения для использования регистрации приложения, созданной на предыдущих шагах: [Конфигурация кода приложения](scenario-spa-app-configuration.md).
