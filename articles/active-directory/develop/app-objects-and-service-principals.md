---
title: Приложения, & субъекты-службы в Azure AD | Службы
titleSuffix: Microsoft identity platform
description: Узнайте о связи между объектами приложений и субъектами-службами в Azure Active Directory.
author: rwike77
manager: CelesteDG
services: active-directory
ms.service: active-directory
ms.subservice: develop
ms.topic: conceptual
ms.workload: identity
ms.date: 02/15/2021
ms.author: ryanwi
ms.custom: aaddev, identityplatformtop40
ms.reviewer: sureshja
ms.openlocfilehash: 358e066631304e727d18d092bd4b9a5b2a0bb89a
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "103199611"
---
# <a name="application-and-service-principal-objects-in-azure-active-directory"></a>Объекты приложения и субъекта-службы в Azure Active Directory

В этой статье описывается регистрация приложений, объекты приложений и субъекты-службы в Azure Active Directory: что они представляют, как они используются и как они связаны друг с другом. Также представлен пример сценария с несколькими клиентами, иллюстрирующий связь между объектом приложения приложения и соответствующими объектами субъекта-службы.

## <a name="application-registration"></a>Регистрация приложения
Чтобы делегировать функции управления удостоверениями и доступом в Azure AD, приложение должно быть зарегистрировано в [клиенте](developer-glossary.md#tenant)Azure AD. При регистрации приложения в Azure AD создается конфигурация удостоверений для приложения, которая позволяет интегрировать его с Azure AD. При регистрации приложения в [портал Azure][AZURE-Portal]вы выбираете, является ли он единственным клиентом (доступным в вашем клиенте) или несколькими клиентами (доступным в других клиентах), и при необходимости может задать универсальный код ресурса (URI) перенаправления (куда отправляются маркеры доступа).

Пошаговые инструкции по регистрации приложения см. в [руководстве по регистрации приложений](quickstart-register-app.md).

После завершения регистрации приложения вы получите глобальный уникальный экземпляр приложения ( [объект приложения](#application-object)), который находится в вашем домашнем клиенте или каталоге.  У вас также есть глобальный уникальный идентификатор приложения (идентификатор приложения или клиента).  Затем на портале можно добавить секреты или сертификаты и области, чтобы обеспечить работу приложения, настроить фирменную символику приложения в диалоговом окне входа и многое другое.

При регистрации приложения на портале в домашнем клиенте автоматически создаются объект приложения, а также объект субъекта-службы.  Если вы регистрируете или создаете приложение с помощью Microsoft Graph API, создание объекта субъекта-службы выполняется на отдельном шаге.

## <a name="application-object"></a>Объект приложения
Приложение Azure AD определяется его одним и только объектом приложения, которое находится в клиенте Azure AD, где зарегистрировано приложение (это называется "домашним клиентом").  Объект приложения используется в качестве шаблона или схемы для создания одного или нескольких объектов субъекта-службы.  Субъект-служба создается в каждом клиенте, где используется приложение. Аналогично классу в объектно-ориентированном программировании объект приложения имеет некоторые статические свойства, которые применяются ко всем созданным субъектам-службам (или экземплярам приложения).

Объект приложения описывает три аспекта приложения: как служба может выдавать маркеры для доступа к приложению, ресурсы, к которым может потребоваться доступ приложению, и действия, которые может предпринять приложение.

Колонка **Регистрация приложений** в [портал Azure][AZURE-Portal] используется для перечисления и управления объектами приложения в домашнем клиенте.

![Колонка Регистрация приложений](./media/app-objects-and-service-principals/app-registrations-blade.png)

[Сущность приложения][MS-Graph-App-Entity] Microsoft Graph определяет схему для свойств объекта приложения.

## <a name="service-principal-object"></a>Объект субъекта-службы
Чтобы получить доступ к ресурсам, которые защищены с помощью клиента Azure AD, сущность, которой требуется доступ, должна быть представлена субъектом безопасности. Это требование справедливо и для пользователей (субъекта-пользователя), и для приложений (субъекта-службы). Субъект безопасности определяет политику доступа и разрешения для пользователя или приложения в клиенте Azure AD. Это обеспечивает базовые функции, включая аутентификацию пользователя или приложения во время входа, а также авторизацию во время получения доступа к ресурсам.

Субъект-служба — это локальное представление или экземпляр приложения глобального объекта приложения в одном клиенте или каталоге. Субъект-служба — это конкретный экземпляр, созданный из объекта приложения и наследующий определенные свойства от этого объекта приложения. Субъект-служба создается в каждом клиенте, где используется приложение, и ссылается на глобальный уникальный объект приложения.  Объект субъекта-службы определяет, что приложение может реально выполнять в конкретном клиенте, кто имеет доступ к приложению и какие ресурсы приложение может получить.

Когда приложение получает разрешение на доступ к ресурсам в клиенте (при регистрации или [предоставлении согласия](developer-glossary.md#consent)), создается объект субъекта службы. Вы также можете создавать объекты субъекта-службы в клиенте с помощью [Azure PowerShell](howto-authenticate-service-principal-powershell.md), [Azure CLI](/cli/azure/create-an-azure-service-principal-azure-cli), [Microsoft Graph](/graph/api/serviceprincipal-post-serviceprincipals?tabs=http), [портал Azure][AZURE-Portal]и других средств. При использовании портала субъект-служба создается автоматически при регистрации приложения.

Колонка **корпоративные приложения** на портале используется для перечисления субъектов-служб в клиенте и управления ими. Вы видите разрешения субъекта-службы, разрешения пользователя, которые выполнили это согласие, данные для входа и многое другое.

![Колонка "корпоративные приложения"](./media/app-objects-and-service-principals/enterprise-apps-blade.png)

[Сущность Microsoft Graph ServicePrincipal][MS-Graph-Sp-Entity] определяет схему для свойств объекта субъекта-службы.

## <a name="relationship-between-application-objects-and-service-principals"></a>Отношение между объектами приложения и субъектами-службами

Объект Application — это *глобальное* представление приложения для использования во всех клиентах, а субъект-служба — *Локальное* представление для использования в определенном клиенте.

Объект приложения служит шаблоном, который *определяет* общие свойства и свойства по умолчанию, используемые для создания соответствующих объектов субъекта-службы. Между объектом приложения и самим приложением устанавливается отношение 1:1, а между объектом приложения и соответствующими субъектами-службами — отношение "один ко многим".

Субъект-службу необходимо создать в каждом клиенте, где будет использоваться приложение, чтобы установить поставщика удостоверений для входа в систему и доступа к ресурсам, защищенным с помощью клиента. Приложение с одним клиентом будет иметь только один субъект-службу (в своем домашнем клиенте). Создание субъекта-службы и предоставление разрешения на его использование выполняется во время регистрации приложения. Приложение с несколькими клиентами также имеет субъект-службу, созданную в каждом клиенте, где пользователь из этого клиента имеет право на его использование.

### <a name="consequences-of-modifying-and-deleting-applications"></a>Последствия изменения и удаления приложений
Любые изменения, вносимые в объект приложения, также отражаются в объекте субъекта-службы только в основном клиенте приложения (клиент, на котором он был зарегистрирован). Это означает, что удаление объекта приложения также приведет к удалению объекта субъекта-службы домашнего клиента.  Однако восстановление этого объекта приложения не приведет к восстановлению соответствующего субъекта-службы. При использовании мультитенантных приложений изменения объекта приложения не отражаются в объектах субъекта-службы клиента-потребителя до тех пор, пока через [панель доступа приложения](https://myapps.microsoft.com) доступ не будет удален и предоставлен снова.

## <a name="example"></a>Пример

На следующей схеме показана связь между объектом приложения и соответствующими объектами субъекта-службы в контексте образца мультитенантного приложения под названием **Приложение по управлению персоналом**. В этом примере сценария используются три клиента Azure AD:

- **Adatum** — клиент, используемый компанией, разработавшей **приложение HR** .
- **Contoso** — клиент, используемый организацией Contoso, которая является потребителем **приложения HR** .
- **Fabrikam** — клиент, который использует компания Fabrikam, также потребляющая **приложение по управлению персоналом**.

![Отношение между объектом приложения и объектом субъекта-службы](./media/app-objects-and-service-principals/application-objects-relationship.svg)

Условия в этом примере сценария.

| Шаг | Описание |
|------|-------------|
| 1    | Это процесс создания объектов приложения и субъекта-службы в главном клиенте приложения. |
| 2    | При согласии администраторов компании Contoso и Fabrikam в клиенте Azure AD компании создается объект субъекта-службы, и ему назначаются разрешения, предоставленные администратором. Обратите внимание, что приложение по управлению персоналом можно создать или настроить для отдельных пользователей. |
| 3    | Каждый из клиентов-потребителей приложения по управлению персоналом (Contoso и Fabrikam) имеет собственный объект субъекта-службы. И каждый из них представляет использование экземпляра приложения во время выполнения. Это использование зависит от разрешений, предоставленных соответствующим администратором. |

## <a name="next-steps"></a>Следующие шаги

- Можно использовать [проводник Microsoft Graph](https://developer.microsoft.com/graph/graph-explorer) для запроса объектов приложения и субъекта-службы.
- Доступ к объекту приложения приложения можно получить с помощью Microsoft Graph API, редактора манифеста приложения [портал Azure][AZURE-Portal] или [командлетов Azure AD PowerShell](/powershell/azure/), представленных в [сущности приложения][MS-Graph-App-Entity]OData.
- Доступ к объекту субъекта-службы приложения можно получить с помощью Microsoft Graph API или [командлетов Azure AD PowerShell](/powershell/azure/), представленных в [сущности ServicePrincipal][MS-Graph-Sp-Entity]OData.

<!--Image references-->

<!--Reference style links -->
[MS-Graph-App-Entity]: /graph/api/resources/application
[MS-Graph-Sp-Entity]: /graph/api/resources/serviceprincipal
[AZURE-Portal]: https://portal.azure.com
