---
title: Маркеры безопасности | Службы
titleSuffix: Microsoft identity platform
description: Узнайте об основах маркеров безопасности на платформе Microsoft Identity.
services: active-directory
author: rwike77
manager: CelesteDG
ms.service: active-directory
ms.subservice: develop
ms.topic: conceptual
ms.workload: identity
ms.date: 05/11/2020
ms.author: ryanwi
ms.reviewer: jmprieur, saeeda, sureshja, hirsin
ms.custom: aaddev, identityplatformtop40, scenarios:getting-started
ms.openlocfilehash: 9668d3b0b57e36fb95421f8b502b9b743be8eb31
ms.sourcegitcommit: 5cdd0b378d6377b98af71ec8e886098a504f7c33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2021
ms.locfileid: "98756213"
---
# <a name="security-tokens"></a>Маркеры безопасности Центра Интернета вещей

Централизованный поставщик удостоверений особенно полезен для приложений, которые имеют пользователей по всему миру, которые не обязательно входят в сеть предприятия. Платформа удостоверений Майкрософт проверяет подлинность пользователей и предоставляет маркеры безопасности, такие как [маркер доступа](developer-glossary.md#access-token), [маркер обновления](developer-glossary.md#refresh-token)и [маркер идентификации](developer-glossary.md#id-token), которые позволяют [клиентскому приложению](developer-glossary.md#client-application) получать доступ к защищенным ресурсам на [сервере ресурсов](developer-glossary.md#resource-server).

**Маркер доступа** — это маркер безопасности, выданный [сервером авторизации](developer-glossary.md#authorization-server) в рамках потока [OAuth 2,0](active-directory-v2-protocols.md) . Он содержит сведения о пользователе и приложении, для которых предназначен маркер. который можно использовать для доступа к веб-API и другим защищенным ресурсам. Дополнительные сведения о том, как платформа удостоверений Майкрософт выдает маркеры доступа, см. в разделе [маркеры доступа](access-tokens.md).

Маркеры доступа допустимы только в течение короткого периода времени, поэтому серверы авторизации иногда выдают **маркер обновления** одновременно с выданным маркером доступа. После этого клиентское приложение может при необходимости обмениваться этим маркером обновления для нового маркера доступа. Дополнительные сведения о том, как платформа Microsoft Identity использует маркеры обновления для отзыва разрешений, см. в разделе [отзыв маркера](access-tokens.md#token-revocation).

**Маркеры идентификации** отправляются в клиентское приложение как часть потока [подключения OpenID Connect](v2-protocols-oidc.md) . Они могут отправляться вместе или вместо маркера доступа и использоваться клиентом для проверки подлинности пользователя. Дополнительные сведения о том, как платформа идентификации Майкрософт выдает маркеры идентификации, см. в разделе [маркеры идентификации](id-tokens.md).

> [!NOTE]
> В этой статье обсуждаются маркеры безопасности, используемые протоколами OAuth2 и OpenID Connect Connect. Многие корпоративные приложения используют SAML для проверки подлинности пользователей. Сведения об утверждениях SAML см. в [справочнике по маркерам SAML в Azure AD](reference-saml-tokens.md) .

## <a name="validating-security-tokens"></a>Проверка маркеров безопасности

Это приложение, для которого был создан маркер, веб-приложение, выполнившего вход пользователя или вызываемый веб-API, для проверки маркера. Маркер подписывается **сервером маркеров безопасности (STS)** с закрытым ключом. STS публикует соответствующий открытый ключ. Чтобы проверить маркер, приложение проверяет подпись с помощью открытого ключа STS, чтобы проверить, была ли подпись создана с помощью закрытого ключа.

Маркеры допустимы только в течение ограниченного периода времени. Как правило, STS предоставляет пару токенов:

* Маркер доступа для доступа к приложению или защищенному ресурсу;
* Маркер обновления, используемый для обновления маркера доступа, когда маркер доступа близок к истечению срока действия.

Маркеры доступа передаются в веб-интерфейс API в качестве токена носителя в `Authorization` заголовке. Приложение может предоставить службе STS маркер обновления, и если пользователь не отменил доступ к приложению, он получит новый маркер доступа и новый маркер обновления. Таким способом обрабатывается ситуация, когда кто-то выходит из Организации. Когда STS получает маркер обновления, он не будет выдавать другой действительный маркер доступа, если пользователь больше не является полномочным.

## <a name="json-web-tokens-jwts-and-claims"></a>Веб-маркеры JSON (JWT) и утверждения

Платформа Microsoft Identity реализует маркеры безопасности в виде **веб-маркеров JSON (JWT)** , которые содержат **утверждения**. Так как JWT используются в качестве маркеров безопасности, такая форма проверки подлинности иногда называется **проверкой подлинности JWT**.

[Утверждение](developer-glossary.md#claim) предоставляет утверждения об одной сущности, например клиентском приложении или [владельцу ресурса](developer-glossary.md#resource-owner), к другой сущности, такой как сервер ресурсов. Утверждение также можно называть утверждением JWT или утверждением JSON Web Token.

Утверждения — это пары "имя-значение", которые ретранслировать факты о субъекте маркера. Например, утверждение может содержать факты о субъекте безопасности, проверенном сервером авторизации. Утверждения, представленные в заданном маркере, зависят от многих вещей, в том числе от типа маркера, типа учетных данных, используемых для проверки подлинности субъекта, конфигурации приложения и т. д.

Приложения могут использовать утверждения для различных задач, таких как:

* Проверка маркера
* Определение [клиента](developer-glossary.md#tenant) субъекта маркера
* Отображение сведений о пользователе
* Определение авторизации субъекта

Утверждение состоит из пар «ключ-значение», которые предоставляют такие сведения, как:

* Сервер маркеров безопасности, создавший токен
* Дата создания маркера
* Тема (например, пользователь--, Кроме управляющих программ)
* Аудитория — приложение, для которого был создан маркер
* Приложение (клиент), которое запросило маркер. В случае веб-приложений это может совпадать с аудиторией

Дополнительные сведения о том, как платформа Microsoft Identity реализует токены и сведения о заявках, см. в разделе [маркеры доступа](access-tokens.md) и [идентификаторы маркеров](id-tokens.md).

## <a name="how-each-flow-emits-tokens-and-codes"></a>Как каждый поток выдает маркеры и коды

В зависимости от того, как строится клиент, он может использовать один (или несколько) потоков проверки подлинности, поддерживаемых платформой идентификации Майкрософт. Эти потоки могут создавать различные маркеры (маркеры идентификации, маркеры обновления, маркеры доступа), а также коды авторизации, и для их работы требуются разные токены. На диаграмме представлены общие сведения:

|Поток | Требования | Маркер идентификации | Twitter, | маркер обновления | Код авторизации |
|-----|----------|----------|--------------|---------------|--------------------|
|[Поток кода авторизации](v2-oauth2-auth-code-flow.md) | | x | x | x | x|
|[Неявный поток](v2-oauth2-implicit-grant-flow.md) | | x        | x    |      |                    |
|[Гибридный поток OIDC](v2-protocols-oidc.md#protocol-diagram-access-token-acquisition)| | x  | |          |            x   |
|[Активация маркера обновления](v2-oauth2-auth-code-flow.md#refresh-the-access-token) | маркер обновления | x | x | x| |
|[Поток On-Behalf-Of](v2-oauth2-on-behalf-of-flow.md) | Twitter,| x| x| x| |
|[Учетные данные клиента](v2-oauth2-client-creds-grant-flow.md) | | | x (только для приложений)| | |

Маркеры, выданные через неявный режим, имеют ограничение длины, так как они передаются обратно в браузер через URL-адрес (где `response_mode` — `query` или `fragment`).  Некоторые браузеры имеют ограничение на размер URL-адреса, который можно разместить в строке браузера, и завершаются ошибкой, если он слишком длинный.  Поэтому у этих маркеров нет утверждений `groups` или `wids`.

## <a name="next-steps"></a>Дальнейшие действия

Другие статьи по основам проверки подлинности и авторизации:

* Сведения об основных понятиях, связанных с проверкой подлинности и авторизацией на платформе удостоверений Майкрософт, см. в статье [Проверка подлинности и авторизация](authentication-vs-authorization.md).
* Сведения о процессе регистрации приложения для интеграции с платформой удостоверений Майкрософт см. в статье [Модель приложения](application-model.md).
* Сведения о последовательности входа в веб-приложения, классические и мобильные приложения с помощью платформы удостоверений Майкрософт см. в статье [Поток входа в приложение](app-sign-in-flow.md).
