---
title: Учебник по настройке Harness для автоматической подготовки пользователей с помощью Azure Active Directory | Документация Майкрософт
description: Узнайте, как настроить Azure Active Directory для автоматической подготовки и отзыва учетных записей пользователей в Harness.
services: active-directory
author: zchia
writer: zchia
manager: CelesteDG
ms.service: active-directory
ms.subservice: saas-app-tutorial
ms.workload: identity
ms.topic: tutorial
ms.date: 10/29/2019
ms.author: Zhchia
ms.openlocfilehash: 13ae960f5d259314f00f8f09b2999a36c0919bc5
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94353736"
---
# <a name="tutorial-configure-harness-for-automatic-user-provisioning"></a>Учебник по настройке Harness для автоматической подготовки пользователей

Из этой статьи вы узнаете, как настроить Azure Active Directory (Azure AD) для автоматической подготовки и отзыва учетных записей пользователей или групп в Harness.

> [!NOTE]
> В этой статье рассматриваются сведения о соединителе, созданном на основе службы подготовки пользователей Azure AD. Подробные сведения о службе, а также ответы на часто задаваемые вопросы см. в статье об [автоматизации подготовки и отзыва пользователей в приложениях SaaS с помощью Azure Active Directory](../app-provisioning/user-provisioning.md).
>
> Сейчас этот соединитель доступен в режиме предварительной версии. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="prerequisites"></a>Предварительные требования

В сценарии, описанном в этой статье, предполагается, что у вас уже имеется:

* клиент Azure AD;
* [клиент Harness](https://harness.io/pricing/);
* учетная запись пользователя в Harness с разрешениями *администратора*.

## <a name="assign-users-to-harness"></a>Назначение пользователей для Harness

В Azure Active Directory для определения того, какие пользователи должны получать доступ к выбранным приложениям, используется концепция, называемая *назначением*. В контексте автоматической подготовки синхронизируются только те пользователи или группы, которые были назначены конкретному приложению в Azure AD.

Перед настройкой и включением автоматической подготовки пользователей решите, какие пользователи или группы в Azure AD должны иметь доступ к Harness. После это вы сможете назначить этих пользователей для приложения Harness, выполнив инструкции, приведенные в статье [Назначение пользователя или группы пользователей корпоративному приложению](../manage-apps/assign-user-or-group-access-portal.md).

## <a name="important-tips-for-assigning-users-to-harness"></a>Важные рекомендации по назначению пользователей приложению Harness

* Мы рекомендуем назначить Harness одного пользователя Azure AD, чтобы проверить настройки автоматической подготовки пользователей. Дополнительных пользователей или группы можно назначить позже.

* При назначении пользователя в Harness в диалоговом окне **Назначение** необходимо выбрать действительную роль для конкретного приложения (если доступно). Пользователи с ролью *Доступ по умолчанию* исключаются из подготовки.

## <a name="set-up-harness-for-provisioning"></a>Настройка подготовки в Harness

1. Войдите в [консоль администратора Harness](https://app.harness.io/#/login), а затем перейдите в раздел **Continuous Security** (Непрерывная безопасность) > **Управление доступом**.

    ![Экран "Консоль администрирования Harness"](media/harness-provisioning-tutorial/admin.png)

1. Выберите **Ключи API**.

    ![Экран "Ссылка на пункт "Ключи API" в Harness"](media/harness-provisioning-tutorial/apikeys.png)

1. Выберите **Add API Key** (Добавить ключ API). 

    ![Экран "Ссылка на пункт "Добавить ключ API" в Harness"](media/harness-provisioning-tutorial/addkey.png)

1. На панели **Add Api Key** (Добавить ключ API) выполните следующие действия.

    ![Экран "Панель "Добавить ключ API" в Harness"](media/harness-provisioning-tutorial/title.png)
   
   а. В поле **Имя** введите имя ключа.  
   b. В раскрывающемся списке **Permissions Inherited from** (Разрешения, унаследованные от) выберите вариант. 
   
1. Нажмите кнопку **Submit** (Отправить).

1. Скопируйте **ключ** для дальнейшего использования в этом учебнике.

    ![Экран "Создание токена" в Harness"](media/harness-provisioning-tutorial/token.png)

## <a name="add-harness-from-the-gallery"></a>Добавление Harness из коллекции

Перед настройкой Harness для автоматической подготовки пользователей в Azure AD необходимо добавить Harness из коллекции приложений Azure AD в список управляемых приложений SaaS.

1. На [портале Azure](https://portal.azure.com) в области слева щелкните **Azure Active Directory**.

    ![Кнопка Azure Active Directory](common/select-azuread.png)

1. Щелкните **Корпоративные приложения** > **Все приложения**.

    ![Ссылка "Все приложения"](common/enterprise-applications.png)

1. Чтобы добавить новое приложение, в области сверху нажмите кнопку **Новое приложение**.

    ![Кнопка "Новое приложение"](common/add-new-app.png)

1. В поле поиска введите **Harness**, выберите **Harness** в области результатов и нажмите кнопку **Добавить**, чтобы добавить это приложение.

    ![Экран "Harness в списке результатов"](common/search-new-app.png)

## <a name="configure-automatic-user-provisioning-to-harness"></a>Настройка автоматической подготовки пользователей в Harness 

В этом разделе описывается, как настроить службу подготовки Azure AD для создания, обновления и отключения пользователей или групп в Harness на основе их назначений в Azure AD.

> [!TIP]
> Кроме того, для Harness можно включить единый вход на основе SAML. Для этого следуйте инструкциям, приведенным в [учебнике по единому входу в Harness](./harness-tutorial.md). Единый вход настраивается независимо от автоматической подготовки пользователей, хотя эти две возможности хорошо дополняют друг друга.

> [!NOTE]
> Дополнительные сведения о конечной точке SCIM Harness см. в статье о [ключах API Harness](https://docs.harness.io/article/smloyragsm-api-keys).

Чтобы настроить автоматическую подготовку пользователей Harness в Azure AD, сделайте следующее:

1. На [портале Azure](https://portal.azure.com) выберите **Корпоративные приложения** > **Все приложения**.

    ![Колонка "Корпоративные приложения"](common/enterprise-applications.png)

1. В списке приложений выберите **Harness**.

    ![Экран "Ссылка на Harness в списке "Приложения"](common/all-applications.png)

1. Выберите **Подготовка**.

    ![Экран "Кнопка "Подготовка"](common/provisioning.png)

1. В раскрывающемся списке **Режим подготовки к работе** выберите **Автоматически**.

    ![Экран "Раскрывающийся список "Режим подготовки к работе"](common/provisioning-automatic.png)

1. Чтобы обновить **учетные данные администратора**, сделайте следующее.

    ![URL-адрес клиента + токен](common/provisioning-testconnection-tenanturltoken.png)
 
   а. В поле **URL-адрес клиента** введите **`https://app.harness.io/gateway/api/scim/account/<your_harness_account_ID>`** . Идентификатор учетной записи Harness можно получить, перейдя по URL-адресу в браузере. При этом должен быть выполнен вход в Harness.
   b. В поле **Секретный токен** введите значение маркера проверки подлинности SCIM, сохраненное на шаге 6 раздела "Настройка подготовки в Harness".  
   c. Выберите **Проверить подключение**, чтобы убедиться, что Azure AD может подключиться к Harness. Если установить подключение не удалось, убедитесь, что в учетной записи Harness есть *разрешения администратора*, и повторите попытку.

1. В поле **Почтовое уведомление** введите адрес электронной почты пользователя или группы, которые должны получать уведомления об ошибках подготовки, а затем установите флажок **Отправить уведомление по электронной почте при сбое**.

    ![Экран "Поле "Почтовое уведомление"](common/provisioning-notification-email.png)

1. Щелкните **Сохранить**.

1. В разделе **Сопоставления** выберите **Synchronize Azure Active Directory Users to Harness** (Синхронизировать пользователей Azure Active Directory с Harness).

    ![Экран "Ссылка на пункт Synchronize Azure Active Directory Users to Harness (Синхронизировать пользователей Azure Active Directory с Harness)"](media/harness-provisioning-tutorial/usermappings.png)

1. В разделе **Сопоставления атрибутов** просмотрите атрибуты пользователей, которые синхронизируются из Azure AD в Harness. Атрибуты, выбранные как *сопоставления*, используются для сопоставления учетных записей пользователей в Harness для операций обновления. Чтобы зафиксировать изменения, щелкните **Сохранить**.

    ![Экран "Панель "Сопоставления атрибутов" пользователя Harness"](media/harness-provisioning-tutorial/userattributes.png)

1. В разделе **Сопоставления** выберите **Synchronize Azure Active Directory Groups to Harness** (Синхронизировать группы Azure Active Directory с Harness).

    ![Экран "Ссылка на пункт Synchronize Azure Active Directory Groups to Harness (Синхронизировать группы Azure Active Directory с Harness)"](media/harness-provisioning-tutorial/groupmappings.png)

1. В разделе **Сопоставления атрибутов** просмотрите атрибуты групп, которые синхронизируются из Azure AD в Harness. Атрибуты, выбранные как *сопоставления*, используются для сопоставления групп в Harness для операций обновления. Чтобы зафиксировать изменения, щелкните **Сохранить**.

    ![Экран "Панель "Сопоставления атрибутов" групп Harness"](media/harness-provisioning-tutorial/groupattributes.png)

1. Чтобы узнать о том, как настроить фильтры области, см. статью [Подготовка приложений на основе атрибутов с использованием фильтров области](../app-provisioning/define-conditional-rules-for-provisioning-user-accounts.md).

1. Чтобы включить службу подготовки Azure AD для Harness, в разделе **Параметры** измените значение параметра **Состояние подготовки** на **Включено**.

    ![Экран "Переключение значения параметра "Состояние подготовки" на "Включено"](common/provisioning-toggle-on.png)

1. В разделе **Параметры** выберите в раскрывающемся списке **Область** способ синхронизации пользователей или групп, которые вы намерены подготовить для Harness.

    ![Область действия подготовки](common/provisioning-scope.png)

1. Когда будете готовы выполнить подготовку, нажмите кнопку **Сохранить**.

    ![Экран "Кнопка "Сохранить" для начала подготовки"](common/provisioning-configuration-save.png)

Эта операция приведет к запуску начальной синхронизации пользователей или групп, которые вы подготавливаете. Процесс начальной синхронизации будет выполняться дольше, чем последующие операции синхронизации. Такие операции происходят примерно каждые 40 минут, пока выполняется служба подготовки Azure AD. Вы можете отслеживать ход выполнения в разделе **Сведения о синхронизации**. Доступны также ссылки для просмотра отчетов о подготовке, в которых зафиксированы все действия, выполняемые службой подготовки Azure AD с приложением Harness.

Дополнительные сведения о чтении журналов подготовки Azure AD см. в руководстве по [созданию отчетов об автоматической подготовке учетных записей пользователя](../app-provisioning/check-status-user-account-provisioning.md).

## <a name="additional-resources"></a>Дополнительные ресурсы

* [Managing user account provisioning for enterprise apps in the Azure portal](../app-provisioning/configure-automatic-user-provisioning-portal.md) (Управление подготовкой учетных записей пользователей для корпоративных приложений на портале Azure)
* [Что такое доступ к приложениям и единый вход с помощью Azure Active Directory?](../manage-apps/what-is-single-sign-on.md)

## <a name="next-steps"></a>Дальнейшие действия

* [Сведения о просмотре журналов и получении отчетов о действиях по подготовке](../app-provisioning/check-status-user-account-provisioning.md)