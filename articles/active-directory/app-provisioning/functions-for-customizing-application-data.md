---
title: Справочник по написанию выражений для сопоставлений атрибутов в Azure Active Directory
description: Узнайте, как использовать сопоставление выражений для преобразования значений атрибутов в допустимый формат при автоматической подготовке объектов приложения SaaS в Azure Active Directory. Содержит справочный список функций.
services: active-directory
author: kenwith
manager: daveba
ms.service: active-directory
ms.subservice: app-provisioning
ms.workload: identity
ms.topic: reference
ms.date: 03/04/2021
ms.author: kenwith
ms.custom: contperf-fy21q2
ms.openlocfilehash: 0334f52b87071c8f363a0dfcc793170316747096
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102198512"
---
# <a name="reference-for-writing-expressions-for-attribute-mappings-in-azure-ad"></a>Справочник по написанию выражений для сопоставления атрибутов в Azure AD

При настройке подготовки для приложения SaaS одним из типов сопоставления атрибутов, которые можно указать, является сопоставление выражений. Для этого необходимо написать выражение, похожее на сценарий, которое позволяет преобразовывать данные пользователей в форматы, которые более приемлемы для приложения SaaS.

## <a name="syntax-overview"></a>Общие сведения о синтаксисе

Синтаксис выражений для сопоставления атрибутов напоминает функции Visual Basic для приложений (VBA).

* Выражение целиком должно быть определено в терминах функций, которые состоят из имени, за которым следуют аргументы в круглых скобках: *FunctionName ( `<<argument 1>>` , `<<argument N>>` )*
* Функции можно вкладывать одну в другую. Например:  *функтиононе (функтионтво ( `<<argument1>>` ))*
* В функцию можно передавать следующие три типа аргументов.
  
  1. Атрибуты, которые должны быть заключены в квадратные скобки. Например: [имя_атрибута].
  2. Строковые константы, которые должны быть заключены в двойные кавычки. Например: "США".
  3. Другие функции. Например: Функтиононе ( `<<argument1>>` , функтионтво ( `<<argument2>>` ))
* Если в строковых константах необходимо использовать обратную косую черту (\) или кавычки (""), такие символы следует экранировать обратной косой чертой (\). Например: "название компании: \\ " Contoso \\ ""
* В синтаксисе учитывается регистр символов, который следует учитывать при вводе строк в функции VS Copy, вставляя их непосредственно отсюда. 

## <a name="list-of-functions"></a>Список функций

[](#append) &nbsp; &nbsp; Добавить &nbsp; &nbsp; [](#bitand) &nbsp; &nbsp; BitAnd &nbsp; &nbsp; [](#cbool) &nbsp; &nbsp; CBool &nbsp; &nbsp; [](#coalesce) &nbsp; &nbsp; Объединение &nbsp; &nbsp; [](#converttobase64) &nbsp; &nbsp; ConvertToBase64 &nbsp; &nbsp; [](#converttoutf8hex) &nbsp; &nbsp; ConvertToUTF8Hex &nbsp; &nbsp; [](#count) &nbsp; &nbsp; Количество &nbsp; &nbsp; [](#cstr) &nbsp; &nbsp; CStr &nbsp; &nbsp; [Датефромнум](#datefromnum) &nbsp; [](#formatdatetime) &nbsp; &nbsp; FormatDateTime &nbsp; &nbsp; [Идентификатор](#guid) &nbsp; &nbsp; GUID &nbsp; &nbsp; [](#iif) &nbsp; &nbsp; IIf &nbsp; &nbsp; [](#instr) &nbsp; &nbsp; InStr &nbsp; &nbsp; [](#isnull) &nbsp; &nbsp; IsNull &nbsp; &nbsp; [](#isnullorempty) &nbsp; &nbsp; IsNullOrEmpty &nbsp; &nbsp; [](#ispresent) &nbsp; &nbsp; Present &nbsp; &nbsp; [](#isstring) &nbsp; &nbsp; Substring &nbsp; &nbsp; [](#item) &nbsp; &nbsp; Элемент &nbsp; &nbsp; [](#join) &nbsp; &nbsp; Соединение &nbsp; &nbsp; По [левому краю](#left) &nbsp; &nbsp; &nbsp; &nbsp; [MID](#mid) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [нормализедиакритикс](#normalizediacritics) [Not](#not) &nbsp; &nbsp; &nbsp; &nbsp; [нумфромдате](#numfromdate) &nbsp; &nbsp; &nbsp; &nbsp; [RemoveDuplicates](#removeduplicates) &nbsp; &nbsp; &nbsp; &nbsp; [Replace](#replace) &nbsp; &nbsp; &nbsp; &nbsp; [селектуникуевалуе](#selectuniquevalue) &nbsp; &nbsp; &nbsp; &nbsp; [синглеаппролеассигнмент](#singleapproleassignment) &nbsp; &nbsp; &nbsp; &nbsp; [Split](#split) &nbsp; &nbsp; &nbsp; &nbsp; [стрипспацес](#stripspaces) &nbsp; &nbsp; &nbsp; &nbsp; [switch](#switch) &nbsp; &nbsp; &nbsp; &nbsp; [ToLower](#tolower) &nbsp; &nbsp; &nbsp; &nbsp; [ToUpper](#toupper) &nbsp; &nbsp; &nbsp; &nbsp; [Word](#word)

---
### <a name="append"></a>Добавление

**Функция:** Append (источник, суффикс)

**Описание:** Принимает исходное строковое значение и добавляет суффикс к концу.

**Вход**

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **suffix** |Обязательно |Строка |Строка, которую необходимо присоединить к концу исходного значения. |


### <a name="append-constant-suffix-to-user-name"></a>Добавление суффикса константы к имени пользователя
Пример. при использовании песочницы Salesforce может потребоваться добавить дополнительный суффикс ко всем именам пользователей, прежде чем синхронизировать их.

**Выражение** 
`Append([userPrincipalName], ".test")`

**Пример ввода и вывода:** 

* **Входные данные**: (userPrincipalName): "John.Doe@contoso.com"
* **Выходные данные**: " John.Doe@contoso.com.test "


---
### <a name="bitand"></a>BitAnd
**Функция:** BitAnd (значение1, значение2)

**Описание:** Эта функция преобразует оба параметра в двоичное представление и задает для бита значение:

- 0 — если один или оба соответствующих бита в value1 и value2 равны 0;
- 1 — если оба соответствующих бита равны 1.

Другими словами, функция возвращает значение 0 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 1.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value1** |Обязательно |num |Числовое значение, которое должно быть двух с value2|
| **value2** |Обязательно |num |Числовое значение, которое должно быть двух с значение1|

**Например**
`BitAnd(&HF, &HF7)`

11110111 и 00000111 = 00000111 `BitAnd` , то есть возвращает 7, двоичное значение 00000111.

---
### <a name="cbool"></a>CBool
**Функций** 
`CBool(Expression)`

**Описание:**  
 `CBool` Возвращает логическое значение на основе вычисленного выражения. Если результатом вычисления выражения является ненулевое значение, `CBool` возвращается значение *true*, а в противном случае возвращается *значение false*.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательно | expression | Любое допустимое выражение |

**Пример:** 
`CBool([attribute1] = [attribute2])`                                                                    
Возвращает значение True, если оба атрибута имеют одинаковое значение.

---
### <a name="coalesce"></a>Coalesce
**Функция:** Объединение (Source1, source2,..., defaultValue)

**Описание:** Возвращает первое исходное значение, не равное NULL. Если все аргументы имеют значение NULL и имеется defaultValue, будет возвращено значение defaultValue. Если все аргументы равны NULL и значение defaultValue отсутствует, функция объединения возвращает значение NULL.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source1  … sourceN** | Обязательно | Строка |Обязательно, переменное число раз. Как правило, имя атрибута из исходного объекта. |
| **defaultValue** | Необязательный | Строка | Значение по умолчанию, используемое, если все исходные значения имеют значение NULL. Может быть пустой строкой ("").

### <a name="flow-mail-value-if-not-null-otherwise-flow-userprincipalname"></a>Значение потока сообщений, если не равно NULL, в противном случае поток userPrincipalName
Пример. вы хотите передать атрибут mail, если он существует. Если это не так, вместо этого нужно передать значение userPrincipalName.

**Выражение** 
`Coalesce([mail],[userPrincipalName])`

**Пример ввода и вывода:** 

* **Входные данные** (почта): NULL
* **Входные данные** (userPrincipalName): " John.Doe@contoso.com "
* **Выходные данные**: " John.Doe@contoso.com "


---
### <a name="converttobase64"></a>ConvertToBase64
**Функция:** ConvertToBase64 (источник)

**Описание:** Функция ConvertToBase64 преобразует строку в строку Юникода в кодировке Base64.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Строка, которая должна быть преобразована в Base 64|

**Например**
`ConvertToBase64("Hello world!")`

 Возвращает SABlAGwAbABvACAAdwBvAHIAbABkACEA.

---
### <a name="converttoutf8hex"></a>ConvertToUTF8Hex
**Функция:** ConvertToUTF8Hex (источник)

**Описание:** Функция ConvertToUTF8Hex преобразует строку в закодированное шестнадцатеричное значение UTF8.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Строка для преобразования в шестнадцатеричное значение UTF8|

**Например**
`ConvertToUTF8Hex("Hello world!")`

 Возвращает 48656C6C6F20776F726C6421.

---
### <a name="count"></a>Count
**Функция:** Count (атрибут)

**Описание:** Функция Count возвращает количество элементов в атрибуте с несколькими значениями.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **версию** |Обязательно |Атрибут |Многозначный атрибут, для которого будут учитываться элементы|

---
### <a name="cstr"></a>CStr
**Функция:** CStr (Value)

**Описание:** Функция CStr преобразует значение в строковый тип данных.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательно | Числовой, ссылочный или логический | может быть числовым значением, ссылочным атрибутом или логическим значением. |

**Например**
`CStr([dn])`

Возвращает "CN = Joe, DC = contoso, DC = com"

---
### <a name="datefromnum"></a>DateFromNum
**Функция:** Датефромнум (значение)

**Описание:** Функция Датефромнум преобразует значение в формате даты AD в тип DateTime.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательно | Дата | Дата объявления для преобразования в тип DateTime |

**Например**
`DateFromNum([lastLogonTimestamp])`

`DateFromNum(129699324000000000)`

Возвращает значение типа DateTime, представляющее 1 января 2012 в 11:12:00.

---
### <a name="formatdatetime"></a>FormatDateTime
**Функция:** FormatDateTime (Source, dateTimeStyles, Инпутформат, outputFormat)

**Описание:** Принимает строку даты из одного формата и преобразует ее в другой формат.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **dateTimeStyles** | Необязательный | Строка | Используйте этот параметр, чтобы указать параметры форматирования, которые настраивают синтаксический анализ строк для некоторых методов синтаксического анализа даты и времени. Поддерживаемые значения см. в разделе [DateTimeStyles doc](/dotnet/api/system.globalization.datetimestyles). Если оставить это поле пустым, используется значение по умолчанию DateTimeStyles. RoundtripKind, DateTimeStyles. AllowLeadingWhite, DateTimeStyles. AllowTrailingWhite  |
| **инпутформат** |Обязательно |Строка |Предполагаемый формат исходного значения. Поддерживаемые форматы см. в разделе [/дотнет/Стандард/Басе-типес/кустом-дате-Анд-Тиме-формат-стрингс](/dotnet/standard/base-types/custom-date-and-time-format-strings). |
| **outputFormat** |Обязательно |Строка |Формат вывода даты. |



### <a name="output-date-as-a-string-in-a-certain-format"></a>Вывод даты в виде строки в определенном формате
Пример. вы хотите отправить даты в приложение SaaS, например ServiceNow, в определенном формате. Можно использовать следующее выражение. 

**Выражение** 

`FormatDateTime([extensionAttribute1], , "yyyyMMddHHmmss.fZ", "yyyy-MM-dd")`

**Пример ввода и вывода:**

* **ВВОД** : (extensionAttribute1): "20150123105347.1Z"
* **Выходные данные**: "2015-01-23"


---
### <a name="guid"></a>Guid
**Функция:** GUID ()

**Описание:** GUID функции создает новый случайный идентификатор GUID

---
### <a name="iif"></a>IIF
**Функция:** IIF (Condition, true, значение для false)

**Описание:** Функция IIF возвращает один из набора возможных значений на основе указанного условия.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **выполняет** |Обязательно |Переменная или выражение |Любое значение или выражение, результатом которого может быть значение True или False. |
| **True** |Обязательно |Переменная или строка | возвращаемое значение, если условие принимает значение true. |
| **Значение для false** |Обязательно |Переменная или строка |возвращаемое значение, если условие принимает значение false.|

**Например**
`IIF([country]="USA",[country],[department])`

---
### <a name="instr"></a>InStr
**Функция:** InStr (значение1, значение2, начало, Компаретипе)

**Описание:** Функция InStr находит первое вхождение подстроки в строке

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value1** |Обязательно |Строка |Строка для поиска |
| **value2** |Обязательно |Строка |Строка для поиска |
| **start** |Необязательный |Целое число |Начальная Расположение для поиска подстроки|
| **компаретипе** |Необязательно |Перечисление |Может быть Вбтексткомпаре или Вббинарикомпаре |

**Например**
`InStr("The quick brown fox","quick")`

Принимает значение 5

`InStr("repEated","e",3,vbBinaryCompare)`

 Принимает значение 7.

---
### <a name="isnull"></a>IsNull
**Функция:** IsNull (выражение)

**Описание:** Если результатом вычисления выражения является значение null, функция IsNull возвращает значение true.  Значение NULL для атрибута выражается в отсутствии атрибута.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательно |expression |Вычисляемое выражение |

**Например**
`IsNull([displayName])`

Возвращает значение true, если атрибут отсутствует.

---
### <a name="isnullorempty"></a>IsNullorEmpty
**Функция:** IsNullOrEmpty (выражение)

**Описание:** Если выражение имеет значение null или является пустой строкой, функция IsNullOrEmpty возвращает значение true. Для атрибута это будет значение True, если атрибут отсутствует или же присутствует, но является пустой строкой.
Обратной функцией этой функции является IsPresent.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательно |expression |Вычисляемое выражение |

**Например**
`IsNullOrEmpty([displayName])`

Возвращает значение true, если атрибут отсутствует или является пустой строкой.

---
### <a name="ispresent"></a>IsPresent
**Функция:** Present (выражение)

**Описание:** Если результатом вычисления выражения является строка, которая не имеет значение NULL и не пуста, функция Present возвращает значение true.  Обратной функцией этой функции является IsNullOrEmpty.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательно |expression |Вычисляемое выражение |

**Например**
`Switch(IsPresent([directManager]),[directManager], IsPresent([skiplevelManager]),[skiplevelManager], IsPresent([director]),[director])`

---
### <a name="isstring"></a>IsString
**Функция:** Substring (выражение)

**Описание:** Если выражение может быть вычислено в строковый тип, функция GetString возвращает значение true.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **expression** |Обязательно |expression |Вычисляемое выражение |

---
### <a name="item"></a>Элемент
**Функция:** Элемент (атрибут, индекс)

**Описание:** Функция Item возвращает один элемент из многозначной строки или атрибута.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **версию** |Обязательно |Атрибут |Атрибут с несколькими значениями для поиска |
| **index** |Обязательный |Целое число | Индексирование элемента в строке с несколькими значениями|

**Пример:** 
 `Item([proxyAddresses], 1)` Возвращает второй элемент в атрибуте с несколькими значениями.

---
### <a name="join"></a>Присоединиться
**Функция:** Соединение (разделитель, source1, source2,...)

**Описание:** Join () аналогичен Append (), за исключением того, что он может объединить несколько **исходных** строковых значений в одну строку, и каждое значение будет разделяться строкой- **разделителем** .

Если одно из исходных значений является атрибутом с несколькими значениями, все значения в этом атрибуте будут объединены, а между ними будет значение разделителя.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **separator** язательно, количество |Обязательно |Строка |Строка, используемая для разделения исходных значений, когда они объединяются в одну строку. Если разделитель не требуется, может не иметь значения (""). |
| **source1  … sourceN** |Обязательно, количество повторов может меняться. |Строка |Строковые значения для объединения. |

---
### <a name="left"></a>Левый
**Функция:** Left (строка, NumChars)

**Описание:** Функция Left возвращает указанное количество символов слева от строки. если numChars = 0, возвращается пустая строка;
если numChars < 0, возвращается введенная строка;
если строка имеет значение Null, возвращается пустая строка.
Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений (т. е. содержащая все символы в параметре 1).

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **String** |Обязательно |Атрибут | Строка, из которой возвращаются символы |
| **NumChars** |Обязательный |Целое число | Число, определяющее количество символов, возвращаемых с начала (слева) строки|

**Например**
`Left("John Doe", 3)`

 Возвращает значение Joh.

---
### <a name="mid"></a>Mid
**Функция:** MID (источник, начало, длина)

**Описание:** Возвращает подстроку исходного значения. Подстрокой является строка, содержащая только некоторые символы из исходной строки.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Как правило, имя атрибута. |
| **start** |Обязательно |Целое число |Индекс положения начала подстроки в **исходной** строке. Первый символ в строке будет иметь индекс 1, второй символ — индекс 2 и т. д. |
| **length** |Обязательно |Целое число |Длина подстроки. Длина подстроки. Если она превышает размер строки **source**, функция возвращает подстроку от индекса **start** до конца строки **source**. |

---
### <a name="normalizediacritics"></a>NormalizeDiacritics
**Функция:** Нормализедиакритикс (источник)

**Описание:** Требуется один строковый аргумент. Возвращает строку, в которой все символы с диакритическими знаками заменены эквивалентами без диакритических знаков. Обычно используется для преобразования имен и фамилий с диакритическими знаками в допустимые значения, которые могут использоваться в различных идентификаторах пользователя, таких как имена участников-пользователей, имена учетных записей SAM и адреса электронной почты.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка | Обычно атрибут имени или фамилии. |


### <a name="remove-diacritics-from-a-string"></a>Удаление диакритических знаков из строки
Пример. необходимо заменить символы, содержащие диакритические знаки, эквивалентными символами, которые не содержат диакритические знаки.

**Выражение:** Нормализедиакритикс ([givenName])

**Пример ввода и вывода:** 

* **ВВОД** (givenName): "Zoë"
* **Выходные данные**: "Zoe".


---
### <a name="not"></a>Not
**Функция:** Не (источник)

**Описание:** Переворачивает логическое значение **источника**. Если **Source** value имеет значение true, возвращает значение false. В противном случае возвращает значение true.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Логическая строка |Предполагаемые **исходные** значения — "True" или "False". |

---
### <a name="numfromdate"></a>NumFromDate
**Функция:** Нумфромдате (значение)

**Описание:** Функция Нумфромдате преобразует значение DateTime в формат Active Directory, необходимый для задания таких атрибутов, как [accountExpires](/windows/win32/adschema/a-accountexpires). Эта функция используется для преобразования значений DateTime, полученных из облачных приложений отдела кадров, таких как Workday и SuccessFactors, в эквивалентное представление AD. 

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **value** |Обязательно | Строка | Строка даты и времени в поддерживаемом формате. Поддерживаемые форматы см. по адресу https://msdn.microsoft.com/library/8kb3ddd4%28v=vs.110%29.aspx. |

**Пример**.
* Например, предположим, что вы хотите сопоставить атрибут *контрактенддате* из workday, который находится в поле Format *2020-12-31-08:00* to *accountExpires* в AD, вот как можно использовать эту функцию и изменить смещение часового пояса в соответствии с языковым стандартом. 
  `NumFromDate(Join("", FormatDateTime([ContractEndDate], ,"yyyy-MM-ddzzz", "yyyy-MM-dd"), "T23:59:59-08:00"))`

* В SuccessFactors примере, предполагая, что вы хотите сопоставить атрибут *EndDate* из SuccessFactors, который находится в поле Format *M/d/гггг чч: мм: СС TT* to *accountExpires* в AD, вот как можно использовать эту функцию и изменить смещение часового пояса в соответствии с языковым стандартом.
  `NumFromDate(Join("",FormatDateTime([endDate], ,"M/d/yyyy hh:mm:ss tt","yyyy-MM-dd"),"T23:59:59-08:00"))`


---
### <a name="removeduplicates"></a>RemoveDuplicates
**Функция:** RemoveDuplicates (атрибут)

**Описание:** Функция RemoveDuplicates принимает строку с несколькими значениями и гарантирует уникальность каждого значения.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **версию** |Обязательно |Атрибут с несколькими значениями |Многозначный атрибут, в котором будут удалены дубликаты|

**Пример:** 
 `RemoveDuplicates([proxyAddresses])` Возвращает исключенный атрибут proxyAddress, в котором были удалены все дублирующиеся значения.

---
### <a name="replace"></a>Заменить
**Функция:** Replace (Source, oldValue, regexPattern, regexGroupName, replacementValue, Реплацементаттрибутенаме, шаблон)

**Описание:** Заменяет значения в строке с учетом регистра. Функция ведет себя по-разному в зависимости от указанных параметров:

* Если указаны параметры **старое_значение** и **заменяющее_значение**:
  
  * заменяет все вхождения параметра **oldValue** в **source** параметром **replacementValue**.
* Если указаны параметры **старое_значение** и **шаблон**:
  
  * Заменяет все вхождения **старого значения** в **шаблоне** на **исходное** значение
* Если указаны параметры **regexPattern** и **replacementValue**:

  * функция применяет параметр **regexPattern** к строке **source** и вы можете использовать имена групп регулярных выражений для создания строки для параметра **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementValue**:
  
  * функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, на **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementAttributeName**:
  
  * Если для **source** не указано значение, возвращается **source**.
  * Если для **source** указано значение, функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, значением, связанным с **replacementAttributeName**.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Обычно это имя атрибута из **исходного** объекта. |
| **oldValue** |Необязательный |Строка |Значение для замены в **source** или **template**. |
| **regexPattern** |Необязательный |Строка |Шаблон регулярного выражения для значения, которое должно быть заменено в **источнике**. Или, при использовании **replacementPropertyName**, шаблон для извлечения значения из **replacementPropertyName**. |
| **regexGroupName** |Необязательный |Строка |Имя группы в **regexPattern**. Значение этой группы будет извлечено из **replacementPropertyName** как **replacementValue**, только если используется **replacementPropertyName**. |
| **replacementValue** |Необязательный |Строка |Новое значение для замены старого. |
| **replacementAttributeName** |Необязательный |Строка |Имя атрибута, используемого для значения замены. |
| **шаблон** |Необязательный |Строка |Если указано значение **template**, будет выполнен поиск **oldValue** в шаблоне с последующей заменой значением **source**. |

### <a name="replace-characters-using-a-regular-expression"></a>Замените символы с помощью регулярного выражения
Пример. необходимо найти символы, которые соответствуют значению регулярного выражения, и удалить их.

**Выражение** 

Replace([mailNickname], , "[a-zA-Z_]*", , "", , )

**Пример ввода и вывода:**

* **Входные данные** (mailNickname: "john_doe72"
* **Выходные данные**: "72"


---
### <a name="selectuniquevalue"></a>SelectUniqueValue
**Функция:** Селектуникуевалуе (uniqueValueRule1, uniqueValueRule2, uniqueValueRule3,...)

**Описание:** Требуется как минимум два аргумента, которые являются уникальными правилами создания значений, определенными с помощью выражений. Функция вычисляет каждое правило, а затем проверяет сформированное значение на уникальность в целевом приложении/каталоге. Будет возвращено первое найденное уникальное значение. Если все значения уже существуют в целевом объекте, запись будет дополнительно обработана, а причина записана в журналы аудита. Предельной границы числа аргументов, которые можно указать, не существует.


 - Это функция верхнего уровня, которую нельзя вложить.
 - Функцию нельзя применить к атрибутам, имеющим приоритет сопоставления.     
 - Эта функция предназначена только для создания записей. При использовании ее с атрибутом задайте для свойства **Apply Mapping** (Применить сопоставление) значение **Только в ходе создания объектов**.
 - Эта функция в настоящее время поддерживается только для Active Directory подготовки пользователей "Workday" и "SuccessFactors to Active Directory подготовки пользователей". Ее нельзя использовать с другими приложениями подготовки. 


**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **uniqueValueRule1... uniqueValueRuleN** |Требуется не менее 2, нет верхней границы |Строка | Список правил формирования уникальных значений для оценки. |

### <a name="generate-unique-value-for-userprincipalname-upn-attribute"></a>Создание уникального значения для атрибута userPrincipalName (имя участника-пользователя)
Пример. на основе имени, отчество и фамилии пользователя необходимо создать значение для атрибута UPN и проверить его уникальность в целевом каталоге Active Directory перед тем, как назначить значение атрибуту UPN.

**Выражение** 

```ad-attr-mapping-expr
    SelectUniqueValue( 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"), 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 1), [PreferredLastName]))), "contoso.com"),
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 2), [PreferredLastName]))), "contoso.com")
    )
```

**Пример ввода и вывода:**

* **Входные данные** (предпочитаемое имя): "John".
* **Входные данные** (предпочитаемая фамилия): "Smith".
* **Выходные данные**: " John.Smith@contoso.com ", если значение UPN John.Smith@contoso.com еще не существует в каталоге
* **Выходные данные**: J.Smith@contoso.com Если значение UPN John.Smith@contoso.com уже существует в каталоге
* **Выходные данные**: Jo.Smith@contoso.com Если в каталоге уже существуют два значения имени участника-пользователя,



---
### <a name="singleapproleassignment"></a>SingleAppRoleAssignment
**Функция:** Синглеаппролеассигнмент ([appRoleAssignments])

**Описание:** Возвращает один appRoleAssignment из списка всех appRoleAssignments, назначенных пользователю для данного приложения. Эта функция необходима для преобразования объекта appRoleAssignment в отдельную строку имени роли. Обратите внимание на то, что рекомендуется назначать только один объект appRoleAssignment одному пользователю одновременно. При назначении нескольких ролей невозможно предсказать возвращаемую строку роли. 

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **[appRoleAssignments]** |Обязательно |Строка |Объект **[appRoleAssignments]**. |

---
### <a name="split"></a>Разделение
**Функция:** Разделить (источник, разделитель)

**Описание:** Разделяет строку на многозначный массив, используя указанный символ-разделитель.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |**источник** — обновляемое значение. |
| **разделитель** |Обязательно |Строка |Задает символ, который будет использоваться для разделения строки (к примеру, ",") |

### <a name="split-a-string-into-a-multi-valued-array"></a>Разделение строки на многозначный массив
Пример. необходимо взять список строк с разделителями-запятыми и разбить их на массив, который можно подключить к многозначному атрибуту, например к атрибуту Пермиссионсетс Salesforce. В этом примере список наборов разрешений заполнен в extensionAttribute5 в Azure AD.

**Выражение:** Split ([extensionAttribute5], ",")

**Пример ввода и вывода:** 

* **Входные данные** (extensionAttribute5): "Пермиссионсетоне, пермиссионсеттво"
* **Выходные данные**:  ["PermissionSetOne", "PermissionSetTwo"]


---
### <a name="stripspaces"></a>StripSpaces
**Функция:** Стрипспацес (источник)

**Описание:** Удаляет все символы пробела ("") из исходной строки.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |**источник** — обновляемое значение. |

---
### <a name="switch"></a>Коммутатор
**Функция:** Switch (Source, defaultValue, Key1, Значение1, Key2, значение2,...)

**Описание:** Если значение **источника** соответствует **ключу**, возвращает **значение** для этого **ключа**. Если значение **источника** не совпадает ни с одним ключом, возвращает **значение по умолчанию**.  Параметры **key** и **value** должны всегда быть парными. Для функции необходимо всегда использовать четное количество параметров. Функция не должна использоваться для ссылочных атрибутов, таких как диспетчер. 

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Значение **source**, которое необходимо обновить |
| **defaultValue** |Необязательный |Строка |Значение по умолчанию, которое необходимо использовать, если значение source не соответствует ни одному ключу. Может быть пустой строкой (""). |
| **key** |Обязательно |Строка |Параметр **key**, с которым сравнивается значение **source** |
| **value** |Обязательно |Строка |Значение, которым заменяется значение **source** , соответствующее ключу. |

### <a name="replace-a-value-based-on-predefined-set-of-options"></a>Замена значения на основе предопределенного набора параметров
Пример. необходимо определить часовой пояс пользователя на основе кода состояния, хранящегося в Azure AD.  Если код государства не совпадает с предопределенными параметрами, используйте значение по умолчанию «Australia/Sydney».

**Выражение** 
`Switch([state], "Australia/Sydney", "NSW", "Australia/Sydney","QLD", "Australia/Brisbane", "SA", "Australia/Adelaide")`

**Пример ввода и вывода:**

* **ВВОД** : (state): "QLD"
* **ВЫВОД**: "Australia/Brisbane"


---
### <a name="tolower"></a>ToLower
**Функция:** ToLower (источник, язык и региональные параметры)

**Описание:** Принимает *исходное* строковое значение и преобразует его в нижний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **culture** |Необязательный |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

### <a name="convert-generated-userprincipalname-upn-value-to-lower-case"></a>Преобразование созданного значения userPrincipalName (UPN) в нижний регистр
Пример. вы хотите создать значение имени участника-пользователя путем сцепления полей источника Osnovnoyeimya и Преферредластнаме и преобразования всех символов в нижний регистр. 

`ToLower(Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"))`

**Пример ввода и вывода:**

* **Входные данные** (предпочитаемое имя): "John".
* **Входные данные** (предпочитаемая фамилия): "Smith".
* **Выходные данные**: " john.smith@contoso.com "


---
### <a name="toupper"></a>ToUpper
**Функция:** ToUpper (исходный, язык и региональные параметры)

**Описание:** Принимает *исходное* строковое значение и преобразует его в верхний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
| **culture** |Необязательный |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---
### <a name="word"></a>Word
**Функция:** Word (String, Ворднумбер, разделители)

**Описание:** Функция Word возвращает слово, содержащееся в строке, на основе параметров, описывающих разделители, и возвращаемого числа слов.  Каждая строка символов в строке, разделенной одним из символов-разделителей, определяется как слово:

если number < 1, возвращается пустая строка;
если string имеет значение Null, возвращается пустая строка.
Если строка содержит меньше слов, чем number, или строка не содержит слов, идентифицируемых с помощью разделителей, возвращается пустая строка.

**Вход** 

| Имя | Обязательно/повторяется | Type | Примечания |
| --- | --- | --- | --- |
| **String** |Обязательно |Атрибут с несколькими значениями |Строка, из которой возвращается слово.|
| **ворднумбер** |Обязательный | Целое число | Номер, указывающий, какой номер слова должен возвращаться|
| **разделители** |Обязательно |Строка| Строка, представляющая разделители, которые должны использоваться для поиска слов|

**Например**
`Word("The quick brown fox",3," ")`

Возвращает значение "Иванов".

`Word("This,string!has&many separators",3,",!&#")`

Возвращает значение "имеет".

---

## <a name="examples"></a>Примеры
В этом разделе приведены дополнительные примеры использования функций выражений. 

### <a name="strip-known-domain-name"></a>Извлечение известного доменного имени
Чтобы получить имя пользователя, необходимо удалить известное доменное имя из адреса электронной почты пользователя.  Например, если домен — contoso.com, можно использовать следующее выражение:

**Выражение** 
`Replace([mail], "@contoso.com", , ,"", ,)`

**Пример ввода и вывода:** 

* **Входные данные** (mail): "john.doe@contoso.com"
* **Выходные данные**: john.doe


### <a name="generate-user-alias-by-concatenating-parts-of-first-and-last-name"></a>Создание псевдонима пользователя путем сцепления частей имени и фамилии
Необходимо создать псевдоним пользователя, используя первые три буквы имени и первые пять букв фамилии пользователя.

**Выражение** 
`Append(Mid([givenName], 1, 3), Mid([surname], 1, 5))`

**Пример ввода и вывода:** 

* **ВВОД** : (givenName): "John"
* **ВВОД** : (surname): "Doe"
* **Выходные данные**: "JohDoe"


## <a name="related-articles"></a>Связанные статьи
* [Автоматическая подготовка пользователей и ее отзыв для приложений SaaS](../app-provisioning/user-provisioning.md)
* [Настройка сопоставлений атрибутов для подготовки пользователей](../app-provisioning/customize-application-attributes.md)
* [Фильтры области для подготовки пользователей](define-conditional-rules-for-provisioning-user-accounts.md)
* [Автоматическая подготовка пользователей и групп из Azure Active Directory в приложениях с использованием SCIM](../app-provisioning/use-scim-to-provision-users-and-groups.md)
* [Уведомления о подготовке учетных записей](../app-provisioning/user-provisioning.md)
* [Список учебников по интеграции приложений SaaS](../saas-apps/tutorial-list.md)
