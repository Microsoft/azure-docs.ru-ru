---
title: Azure AD Connect выражений и Справочника по функциям облачной синхронизации
description: reference
services: active-directory
author: billmath
manager: daveba
ms.service: active-directory
ms.workload: identity
ms.topic: reference
ms.date: 12/02/2019
ms.subservice: hybrid
ms.author: billmath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 869d60d4ccb3bae58924fe4221f83b1b0125ae04
ms.sourcegitcommit: 8a74ab1beba4522367aef8cb39c92c1147d5ec13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/20/2021
ms.locfileid: "98614023"
---
# <a name="writing-expressions-for-attribute-mappings-in-azure-active-directory"></a>Запись выражений для сопоставления атрибутов в Azure Active Directory
При настройке синхронизации в облаке один из типов сопоставлений атрибутов, которые можно указать, является сопоставлением выражений. 

Сопоставление выражений позволяет настраивать атрибуты с помощью выражения, похожего на скрипт.  Это позволяет преобразовать локальные данные в новое или другое значение.  Например, вам может потребоваться объединить два атрибута в один, потому что этот один атрибут используется одним из облачных приложений.

В следующем документе будут рассмотрены выражения, похожие на скрипт, которые используются для преобразования данных.  Это только часть процесса.  Затем вам нужно будет использовать это выражение и поместить его в веб-запрос клиенту.  Дополнительные сведения см. в статье о [преобразованиях](how-to-transformation.md).

## <a name="syntax-overview"></a>Общие сведения о синтаксисе
Синтаксис выражений для сопоставления атрибутов напоминает функции Visual Basic для приложений (VBA).

* Все выражение должно определяться функциями, состоящими из имени и следующих за ним в скобках аргументов: <br>
  *FunctionName(`<<argument 1>>`,`<<argument N>>`)*
* Функции можно вкладывать одну в другую. Пример: <br> *FunctionOne(FunctionTwo(`<<argument1>>`))*
* В функцию можно передавать следующие три типа аргументов.
  
  1. Атрибуты, которые должны быть заключены в квадратные скобки. Например: [имя_атрибута].
  2. Строковые константы, которые должны быть заключены в двойные кавычки. Пример: "Соединенные Штаты"
  3. Другие функции. Пример: FunctionOne(`<<argument1>>`, FunctionTwo(`<<argument2>>`))
* Если в строковых константах необходимо использовать обратную косую черту (\) или кавычки (""), такие символы следует экранировать обратной косой чертой (\). Пример: "Название организации: \\Contoso\\"

## <a name="list-of-functions"></a>Список функций
| Список функций | Описание |
|-----|----|
|[Append](#append)|Получает исходное строковое значение и присоединяет к его концу суффикс.|
|[BitAnd](#bitand)|Функция BitAnd задает конкретное значение для битов.|
|[CBool](#cbool)|Функция CBool возвращает логическое значение на основе вычисленного выражения.|
|[ConvertFromBase64](#convertfrombase64)|Функция ConvertFromBase64 преобразует значение в кодировке Base64 в обычную строку.|
|[ConvertToBase64](#converttobase64)|Функция ConvertToBase64 преобразует строку в строку Юникода в кодировке base64. |
|[ConvertToUTF8Hex](#converttoutf8hex)|Функция ConvertToUTF8Hex преобразует строку в значение в шестнадцатеричной кодировке UTF8.|
|[Count](#count)|Функция Count возвращает количество элементов в атрибуте с несколькими значениями.|
|[CStr](#cstr)|Функция CStr преобразует данные в строковый тип данных.|
|[DateFromNum](#datefromnum)|Функция DateFromNum преобразует значение даты в формате AD в тип DateTime.|
|[DNComponent](#dncomponent)|Функция DNComponent возвращает значение указанного компонента различающегося имени начиная с левого края.|
|[Error](#error)|Функция Error используется для возвращения пользовательских ошибок.|
|[FormatDateTime](#formatdatetime) |Преобразовывает строку даты из одного формата в другой.| 
|[GUID](#guid)|Функция Guid создает случайный идентификатор GUID.|           
|[IIF](#iif)|Функция IIF возвращает одно из набора возможных значений на основе заданного условия.|
|[InStr](#instr)|Функция InStr находит первое вхождение подстроки в строке.|
|[IsNull](#isnull)|Функция IsNull возвращает значение True, если выражение принимает значение NULL.|
|[IsNullOrEmpty](#isnullorempty)|Функция IsNullOrEmpty возвращает значение True, если выражение имеет значение NULL или является пустой строкой.|         
|[IsPresent](#ispresent)|Функция IsPresent возвращает значение True, если результат выражения — строка, которая не имеет значение NULL и не является пустой.|    
|[IsString](#isstring)|Функция IsString возвращает значение True, если выражение может принимать значение строкового типа.|
|[Item](#item)|Функция Item возвращает один элемент из строки или атрибута с несколькими значениями.|
|[Join](#join) |Функция Join() схожа с функцией Append() за исключением того, что она может объединять несколько строковых значений **source** в одну строку. При этом каждое значение разделяется строкой **separator**.| 
|[Left](#left)|Функция Left возвращает указанное количество символов из левой части строки.|
|[Mid](#mid) |Возвращает подстроку исходного значения. Подстрокой является строка, содержащая только некоторые символы из исходной строки.|
|[NormalizeDiacritics](#normalizediacritics)|Требуется один строковый аргумент. Возвращает строку, в которой все символы с диакритическими знаками заменены эквивалентами без диакритических знаков.|
|[Not](#not) |Обращает логическое значение **source**. Если значение **source** равно *True*, возвращается значение *False*. В противном случае возвращает значение *True*.| 
|[RemoveDuplicates](#removeduplicates)|Функция RemoveDuplicates принимает строку с несколькими значениями и проверяет, чтобы каждое значение было уникальным.| 
|[Replace](#replace) |Заменяет значения в пределах строки. | 
|[SelectUniqueValue](#selectuniquevalue)|Требуется как минимум два аргумента, которые являются правилами формирования уникальных значений, определенными с помощью выражений. Функция вычисляет каждое правило, а затем проверяет сформированное значение на уникальность в целевом приложении/каталоге.| 
|[SingleAppRoleAssignment](#singleapproleassignment)|Возвращает один объект appRoleAssignment из списка всех объектов appRoleAssignment, назначенных пользователю для заданного приложения.| 
|[Split](#split)|Разделяет строку на многозначный массив с помощью определенного символа разделителя.|
|[StringFromSID](#stringfromsid)|Функция StringFromSid преобразует массив байтов с идентификатором безопасности в строку.| 
|[StripSpaces](#stripspaces) |Удаляет все пробелы (" ") из исходной строки.| 
|[Параметр](#switch)|Если значение **source** соответствует **key**, возвращается **value** для этого параметра **key**. | 
|[ToLower](#tolower)|Принимает строковое значение *source* и преобразует его в нижний регистр, используя указанные правила языка и региональных параметров.| 
|[ToUpper](#toupper)|Принимает строковое значение *source* и преобразует его в верхний регистр, используя указанные правила языка и региональных параметров.|
|[Trim](#trim)|Функция Trim удаляет пробелы в начале и конце строки.|
|[Word](#word)|Функция Word возвращает слово, содержащееся внутри строки, в зависимости от параметров, описывающих разделители и количество слов для возврата.|

---
### <a name="append"></a>Append
**Функция:**<br> Append(source, suffix)

**Описание.**<br> Получает исходное строковое значение и присоединяет к его концу суффикс.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
   | **suffix** |Обязательно |Строка |Строка, которую необходимо присоединить к концу исходного значения. |

---
### <a name="bitand"></a>BitAnd
**Описание.**  
Функция BitAnd задает конкретное значение для битов.

**Синтаксис**  
`num BitAnd(num value1, num value2)`

* value1, value2: числовые значения, которые должны быть соединены оператором AND.

**Примечания:**  
Эта функция преобразует оба параметра в двоичное представление и устанавливает для бита следующие значения:

* 0 — если один или оба соответствующих бита в *value1* и *value2* равны 0;
* 1 — если оба соответствующих бита равны 1.

Другими словами, функция возвращает значение 0 всегда, за исключением случаев, когда соответствующие биты обоих параметров равны 1.

**Пример**.  
 
 `BitAnd(&HF, &HF7)`</br>
 Возвращает 7, так как шестнадцатеричные F и F7 преобразовываются в это значение.

---

### <a name="cbool"></a>CBool
**Описание.**  
Функция CBool возвращает логическое значение на основе вычисленного выражения.

**Синтаксис**  
`bool CBool(exp Expression)`

**Примечания:**  
Если выражение преобразуется в ненулевое значение, функция CBool возвращает значение True, в противном случае она возвращает значение False.

**Пример**.  
`CBool([attrib1] = [attrib2])`  

Возвращает значение True, если оба атрибута имеют одинаковое значение.

---
### <a name="convertfrombase64"></a>ConvertFromBase64
**Описание.**  
Функция ConvertFromBase64 преобразует значение в кодировке Base64 в обычную строку.

**Синтаксис**  
`str ConvertFromBase64(str source)` — здесь предполагается кодирование Юникодом.  
`str ConvertFromBase64(str source, enum Encoding)`

* source: строка в кодировке Base64  
* Encoding: Юникод, ASCII, UTF8.

**Пример**  
`ConvertFromBase64("SABlAGwAbABvACAAdwBvAHIAbABkACEA")`  
`ConvertFromBase64("SGVsbG8gd29ybGQh", UTF8)`

Оба примера возвращают сообщение "*Hello world!* ".

---
### <a name="converttobase64"></a>ConvertToBase64
**Описание.**  
Функция ConvertToBase64 преобразует строку в строку Юникода в кодировке base64.  
Преобразует значение массива целых чисел в эквивалентное строковое представление в кодировке знаков base64.

**Синтаксис**  
`str ConvertToBase64(str source)`

**Пример**.  
`ConvertToBase64("Hello world!")`  
Возвращает SABlAGwAbABvACAAdwBvAHIAbABkACEA.

---
### <a name="converttoutf8hex"></a>ConvertToUTF8Hex
**Описание.**  
Функция ConvertToUTF8Hex преобразует строку в значение в шестнадцатеричной кодировке UTF8.

**Синтаксис**  
`str ConvertToUTF8Hex(str source)`

**Примечания:**  
Azure Active Directory использует формат вывода этой функции в качестве формата атрибута различающегося имени.

**Пример**.  
`ConvertToUTF8Hex("Hello world!")`  
Возвращает 48656C6C6F20776F726C6421.

---
### <a name="count"></a>Count
**Описание.**  
Функция Count возвращает количество элементов в атрибуте с несколькими значениями.

**Синтаксис**  
`num Count(mvstr attribute)`

---
### <a name="cstr"></a>CStr
**Описание.**  
Функция CStr преобразует данные в строковый тип данных.

**Синтаксис**  
`str CStr(num value)`  
`str CStr(ref value)`  
`str CStr(bool value)`  

* value. может быть числовым значением, ссылочным атрибутом или логическим значением.

**Пример**.  
`CStr([dn])`  
Может вернуть cn=Joe,dc=contoso,dc=com.

---
### <a name="datefromnum"></a>DateFromNum
**Описание.**  
Функция DateFromNum преобразует значение даты в формате AD в тип DateTime.

**Синтаксис**  
`dt DateFromNum(num value)`

**Пример**.  
`DateFromNum([lastLogonTimestamp])`  
`DateFromNum(129699324000000000)`  
Возвращает значение DateTime, равное 2012-01-01 23:00:00.

---
### <a name="dncomponent"></a>DNComponent
**Описание.**  
Функция DNComponent возвращает значение указанного компонента различающегося имени начиная с левого края.

**Синтаксис**  
`str DNComponent(ref dn, num ComponentNumber)`

* dn: ссылочный атрибут для интерпретации.
* ComponentNumber: компонент в различающемся имени для возврата.

**Пример**.  
`DNComponent(CRef([dn]),1)`  
Если значение различающегося имени равно cn=Joe,ou=…, функция возвращает Joe.

---
### <a name="error"></a>Error
**Описание.**  
Функция Error используется для возвращения пользовательских ошибок.

**Синтаксис**  
`void Error(str ErrorMessage)`

**Пример**.  
`IIF(IsPresent([accountName]),[accountName],Error("AccountName is required"))`  
Если атрибут accountName отсутствует, в объекте возникает ошибка.

---
### <a name="formatdatetime"></a>FormatDateTime
**Функция:**<br> FormatDateTime(source, inputFormat, outputFormat)

**Описание.**<br> Преобразовывает строку даты из одного формата в другой.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
   | **inputFormat** |Обязательно |Строка |Предполагаемый формат исходного значения. Поддерживаемые форматы см. в разделе [/дотнет/Стандард/Басе-типес/кустом-дате-Анд-Тиме-формат-стрингс](/dotnet/standard/base-types/custom-date-and-time-format-strings). |
   | **outputFormat** |Обязательно |Строка |Формат вывода даты. |

---
### <a name="guid"></a>Guid
**Описание.**  
Функция Guid создает случайный идентификатор GUID.

**Синтаксис**  
`str Guid()`

---
### <a name="iif"></a>IIF
**Описание.**  
Функция IIF возвращает одно из набора возможных значений на основе заданного условия.

**Синтаксис**  
`var IIF(exp condition, var valueIfTrue, var valueIfFalse)`

* condition: любое значение или выражение, которое может принять значение true или false.
* valueIfTrue: возвращаемое значение, если условие принимает значение true.
* valueIfFalse: возвращаемое значение, если условие принимает значение false.

**Пример**.  
`IIF([employeeType]="Intern","t-" & [alias],[alias])`  
 Возвращает псевдоним пользователя с префиксом t-, если пользователь является интерном, в противном случае возвращает псевдоним пользователя как есть.

---
### <a name="instr"></a>InStr
**Описание.**  
Функция InStr находит первое вхождение подстроки в строке.

**Синтаксис**  

`num InStr(str stringcheck, str stringmatch)`  
`num InStr(str stringcheck, str stringmatch, num start)`  
`num InStr(str stringcheck, str stringmatch, num start, enum compare)`

* stringcheck: строка для поиска
* stringmatch: строка, которая должна быть найдена
* start: начальная позиция для поиска подстроки
* compare: vbTextCompare или vbBinaryCompare.

**Примечания:**  
Возвращает позицию, в которой найдена подстрока, или значение 0, если подстрока не найдена.

**Пример**.  
`InStr("The quick brown fox","quick")`  
Принимает значение 5.

`InStr("repEated","e",3,vbBinaryCompare)`  
Принимает значение 7.

---
### <a name="isnull"></a>IsNull
**Описание.**  
Функция IsNull возвращает значение True, если выражение принимает значение NULL.

**Синтаксис**  
`bool IsNull(var Expression)`

**Примечания:**  
Значение NULL для атрибута выражается в отсутствии атрибута.

**Пример**.  
`IsNull([displayName])`  
Возвращает значение True, если атрибут не присутствует в CS или MV.

---
### <a name="isnullorempty"></a>IsNullOrEmpty
**Описание.**  
Функция IsNullOrEmpty возвращает значение True, если выражение имеет значение NULL или является пустой строкой.

**Синтаксис**  
`bool IsNullOrEmpty(var Expression)`

**Примечания:**  
Для атрибута это будет значение True, если атрибут отсутствует или же присутствует, но является пустой строкой.  
Обратной функцией этой функции является IsPresent.

**Пример**.  
`IsNullOrEmpty([displayName])`  
Возвращает значение True, если атрибут не присутствует или является пустой строкой в CS или MV.

---
### <a name="ispresent"></a>IsPresent
**Описание.**  
Функция IsPresent возвращает значение True, если результат выражения — строка, которая не имеет значение NULL и не является пустой.

**Синтаксис**  
`bool IsPresent(var expression)`

**Примечания:**  
Обратной функцией этой функции является IsNullOrEmpty.

**Пример**.  
`Switch(IsPresent([directManager]),[directManager], IsPresent([skiplevelManager]),[skiplevelManager], IsPresent([director]),[director])`

---
### <a name="item"></a>Item
**Описание.**  
Функция Item возвращает один элемент из строки или атрибута с несколькими значениями.

**Синтаксис**  
`var Item(mvstr attribute, num index)`

* attribute: атрибут с несколькими значениями
* index: индекс элемента в строке с несколькими значениями.

**Примечания:**  
Функцию Item удобно использовать с функцией Contains, так как последняя возвращает индекс элемента в атрибуте с несколькими значениями.

Вызывает ошибку, если индекс выходит за допустимые пределы.

**Пример**.  
`Mid(Item([proxyAddresses],Contains([proxyAddresses], "SMTP:")),6)`  
Возвращает основной адрес электронной почты.

---
### <a name="isstring"></a>IsString
**Описание.**  
Функция IsString возвращает значение True, если выражение может принимать значение строкового типа.

**Синтаксис**  
`bool IsString(var expression)`

**Примечания:**  
Используется для определения, сможет ли функция CStr() успешно проанализировать выражение.

---
### <a name="join"></a>Join
**Функция:**<br> Join(separator, source1, source2, …)

**Описание.**<br> Функция Join() схожа с функцией Append() за исключением того, что она может объединять несколько строковых значений **source** в одну строку. При этом каждое значение разделяется строкой **separator**.

Если одно из исходных значений является атрибутом с несколькими значениями, все значения в этом атрибуте будут объединены, а между ними будет значение разделителя.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **separator** язательно, количество |Обязательно |Строка |Строка, используемая для разделения исходных значений, когда они объединяются в одну строку. Если разделитель не требуется, может не иметь значения (""). |
   | **source1  … sourceN** |Обязательно, количество повторов может меняться. |Строка |Строковые значения для объединения. |

---
### <a name="left"></a>Слева
**Описание.**  
Функция Left возвращает указанное количество символов из левой части строки.

**Синтаксис**  
`str Left(str string, num NumChars)`

* string: строка, из которой возвращаются символы.
* NumChars: число, определяющее количество символов для возврата из начала строки (слева).

**Примечания:**  
Строка, содержащая первые numChars символов в строке:

* если numChars = 0, возвращается пустая строка;
* если numChars < 0, возвращается введенная строка;
* если строка имеет значение Null, возвращается пустая строка.

Если строка содержит меньше символов, чем указано в numChars, возвращается строка без изменений (т. е. содержащая все символы в параметре 1).

**Пример**.  
`Left("John Doe", 3)`  
Возвращает `Joh`.

---
### <a name="mid"></a>Mid
**Функция:**<br> Mid(source, start, length)

**Описание.**<br> Возвращает подстроку исходного значения. Подстрокой является строка, содержащая только некоторые символы из исходной строки.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Как правило, имя атрибута. |
   | **start** |Обязательно |Целое число |Индекс положения в строке **source**, откуда должна начинаться подстрока. Первый символ в строке будет иметь индекс 1, второй символ — индекс 2 и т. д. |
   | **length** |Обязательно |Целое число |Длина подстроки. Длина подстроки. Если она превышает размер строки **source**, функция возвращает подстроку от индекса **start** до конца строки **source**. |

---
### <a name="normalizediacritics"></a>NormalizeDiacritics
**Функция:**<br> NormalizeDiacritics(source)

**Описание.**<br> Требуется один строковый аргумент. Возвращает строку, в которой все символы с диакритическими знаками заменены эквивалентами без диакритических знаков. Обычно используется для преобразования имен и фамилий с диакритическими знаками в допустимые значения, которые могут использоваться в различных идентификаторах пользователя, таких как имена участников-пользователей, имена учетных записей SAM и адреса электронной почты.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка | Обычно атрибут имени или фамилии. |

---
### <a name="not"></a>Not
**Функция:**<br> Not(source)

**Описание.**<br> Обращает логическое значение **source**. Если значение **source** равно *True*, возвращается значение *False*. В противном случае возвращает значение *True*.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Логическая строка |Предполагаемые значения **source**: True или False. |

---
### <a name="removeduplicates"></a>RemoveDuplicates
**Описание.**  
Функция RemoveDuplicates принимает строку с несколькими значениями и проверяет, чтобы каждое значение было уникальным.

**Синтаксис**  
`mvstr RemoveDuplicates(mvstr attribute)`

**Пример**.  
`RemoveDuplicates([proxyAddresses])`  
Возвращает очищенный атрибут proxyAddress, в котором удалены все повторяющиеся значения.

---
### <a name="replace"></a>Replace
**Функция:**<br> Replace(source, oldValue, regexPattern, regexGroupName, replacementValue, replacementAttributeName, template)

**Описание.**<br>
Заменяет значения в пределах строки. Ее работа зависит от указанных параметров.

* Если указаны параметры **oldValue** и **replacementValue**:
  
  * заменяет все вхождения параметра **oldValue** в **source** параметром **replacementValue**.
* Если указаны параметры **oldValue** и **template**:
  
  * заменяет все экземпляры **oldValue** в **template** значением **source**.
* Если указаны параметры **regexPattern** и **replacementValue**:

  * функция применяет параметр **regexPattern** к строке **source** и вы можете использовать имена групп регулярных выражений для создания строки для параметра **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementValue**:
  
  * функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, на **replacementValue**.
* Если указаны параметры **regexPattern**, **regexGroupName**, **replacementAttributeName**:
  
  * Если для **source** не указано значение, возвращается **source**.
  * Если для **source** указано значение, функция применяет параметр **regexPattern** к строке **source** и заменяет все значения, соответствующие параметру **regexGroupName**, значением, связанным с **replacementAttributeName**.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Как правило, имя атрибута из объекта **source**. |
   | **oldValue** |Необязательно |Строка |Значение для замены в **source** или **template**. |
   | **regexPattern** |Необязательно |Строка |Шаблон регулярного выражения для значения, заменяемого в **source**. Или, при использовании **replacementPropertyName**, шаблон для извлечения значения из **replacementPropertyName**. |
   | **regexGroupName** |Необязательно |Строка |Имя группы в **regexPattern**. Значение этой группы будет извлечено из **replacementPropertyName** как **replacementValue**, только если используется **replacementPropertyName**. |
   | **replacementValue** |Необязательно |Строка |Новое значение для замены старого. |
   | **replacementAttributeName** |Необязательно |Строка |Имя атрибута, используемого для значения замены. |
   | **template** |Необязательно |Строка |Если указано значение **template**, будет выполнен поиск **oldValue** в шаблоне с последующей заменой значением **source**. |

---
### <a name="selectuniquevalue"></a>SelectUniqueValue
**Функция:**<br> SelectUniqueValue(uniqueValueRule1, uniqueValueRule2, uniqueValueRule3, …)

**Описание.**<br> Требуется как минимум два аргумента, которые являются правилами формирования уникальных значений, определенными с помощью выражений. Функция вычисляет каждое правило, а затем проверяет сформированное значение на уникальность в целевом приложении/каталоге. Будет возвращено первое найденное уникальное значение. Если все значения уже существуют в целевом объекте, запись будет дополнительно обработана, а причина записана в журналы аудита. Предельной границы числа аргументов, которые можно указать, не существует.

> [!NOTE]
> - Это функция верхнего уровня, которую нельзя вложить.
> - Функцию нельзя применить к атрибутам, имеющим приоритет сопоставления.  
> - Эта функция предназначена только для создания записей. При использовании ее с атрибутом задайте для свойства **Apply Mapping** (Применить сопоставление) значение **Только в ходе создания объектов**.
> - В настоящее время эта функция поддерживается только для приложения Workday to Active Directory User Provisioning. Ее нельзя использовать с другими приложениями подготовки. 


**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **uniqueValueRule1... uniqueValueRuleN** |Требуется не менее 2, нет верхней границы |Строка | Список правил формирования уникальных значений для оценки. |


---
### <a name="singleapproleassignment"></a>SingleAppRoleAssignment
**Функция:**<br> SingleAppRoleAssignment([appRoleAssignments])

**Описание.**<br> Возвращает один объект appRoleAssignment из списка всех объектов appRoleAssignment, назначенных пользователю для заданного приложения. Эта функция необходима для преобразования объекта appRoleAssignment в отдельную строку имени роли. Обратите внимание на то, что рекомендуется назначать только один объект appRoleAssignment одному пользователю одновременно. При назначении нескольких ролей невозможно предсказать возвращаемую строку роли. 

**Параметры:**<br> 

  | Имя | Обязательно/повторяется | Тип | Примечания |
  |--- | --- | --- | --- |
  | **[appRoleAssignments]** |Обязательно |Строка |Объект **[appRoleAssignments]** . |

---
### <a name="split"></a>Split
**Функция:**<br> Split(source, delimiter)

**Описание.**<br> Разделяет строку на многозначный массив с помощью определенного символа разделителя.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Значение **source**, которое необходимо обновить |
   | **разделитель** |Обязательно |Строка |Задает символ, который будет использоваться для разделения строки (к примеру, ",") |

---
### <a name="stringfromsid"></a>StringFromSid
**Описание.**  
Функция StringFromSid преобразует массив байтов с идентификатором безопасности в строку.

**Синтаксис**  
`str StringFromSid(bin ObjectSID)`  

---
### <a name="stripspaces"></a>StripSpaces
**Функция:**<br> StripSpaces(source)

**Описание.**<br> Удаляет все пробелы (« ») из исходной строки.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Значение **source**, которое необходимо обновить |

---
### <a name="switch"></a>Параметр
**Функция:**<br> Switch(source, defaultValue, key1, value1, key2, value2, …)

**Описание.**<br> Если значение **source** соответствует **key**, возвращается **value** для этого параметра **key**. Если значение **source** не соответствует ни одному параметру, то возвращается **defaultValue**.  Параметры **key** и **value** должны всегда быть парными. Для функции необходимо всегда использовать четное количество параметров.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Значение **Source**, которое нужно проверить. |
   | **defaultValue** |Необязательно |Строка |Значение по умолчанию, которое необходимо использовать, если значение source не соответствует ни одному ключу. Может быть пустой строкой (""). |
   | **key** |Обязательно |Строка |Параметр **key**, с которым сравнивается значение **source** |
   | **value** |Обязательно |Строка |Значение, которым заменяется значение **source** , соответствующее ключу. |

---
### <a name="tolower"></a>ToLower
**Функция:**<br> ToLower(source, culture)

**Описание.**<br> Принимает строковое значение *source* и преобразует его в нижний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Параметры:**<br> 

   | Имя | Обязательно/повторяется | Тип | Примечания |
   | --- | --- | --- | --- |
   | **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
   | **culture** |Необязательно |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---

### <a name="toupper"></a>ToUpper
**Функция:**<br> ToUpper(source, culture)

**Описание.**<br> Принимает строковое значение *source* и преобразует его в верхний регистр, используя указанные правила языка и региональных параметров. Если не указаны сведения о *языке и региональных параметрах*, будут использоваться инвариантные язык и региональные параметры.

**Параметры:**<br> 

  | Имя | Обязательно/повторяется | Тип | Примечания |
  | --- | --- | --- | --- |
  | **source** |Обязательно |Строка |Как правило, имя атрибута из исходного объекта. |
  | **culture** |Необязательно |Строка |Форматом названия языка и региональных параметров в соответствии с RFC 4646 является *languagecode2-country/regioncode2*, где *languagecode2* — это двухбуквенный код языка, а *country/regioncode2* — двухбуквенный код субкультуры. Примеры включают в себя ja-JP для японского языка (Япония) и en-US для английского (США). В случаях, когда двухбуквенный код языка недоступен, используется трехбуквенный код на основе ISO 639-2.|

---

### <a name="trim"></a>Trim
**Описание.**  
Функция Trim удаляет пробелы в начале и конце строки.

**Синтаксис**  
`str Trim(str value)`  

**Пример**.  
`Trim(" Test ")`  
Возвращает значение Test.

`Trim([proxyAddresses])`  
Удаляет начальные и конечные пробелы для каждого значения в атрибуте proxyAddress.

---
### <a name="word"></a>Word
**Описание.**  
Функция Word возвращает слово, содержащееся внутри строки, в зависимости от параметров, описывающих разделители и количество слов для возврата.

**Синтаксис**  
`str Word(str string, num WordNumber, str delimiters)`

* string: строка, из которой возвращаются слова.
* WordNumber: число, определяющее номер слова, которое должно быть возвращено.
* delimiters: строка, представляющая разделители, которые должны использоваться для идентификации слов.

**Примечания:**  
Каждая строка символов в строке, разделенной одним из символов-разделителей, определяется как слово:

* если number < 1, возвращается пустая строка;
* если string имеет значение Null, возвращается пустая строка.

Если строка содержит меньше слов, чем number, или строка не содержит слов, идентифицируемых с помощью разделителей, возвращается пустая строка.

**Пример**.  
`Word("The quick brown fox",3," ")`  
Возвращает значение "brown".

`Word("This,string!has&many separators",3,",!&#")`  
Вернет значение "has".

## <a name="examples"></a>Примеры
### <a name="strip-known-domain-name"></a>Извлечение известного доменного имени
Необходимо извлечь известное доменное имя из адреса электронной почты пользователя, чтобы получить имя пользователя. <br>
Например, если домен — contoso.com, можно использовать следующее выражение:

**Выражение:** <br>
`Replace([mail], "@contoso.com", , ,"", ,)`

**Пример ввода и вывода:** <br>

* **Входные данные** (mail): "john.doe@contoso.com"
* **Выходные данные**: john.doe

### <a name="append-constant-suffix-to-user-name"></a>Добавление суффикса константы к имени пользователя
При использовании Salesforce Sandbox может потребоваться добавить дополнительный суффикс ко всем именам пользователей перед их синхронизацией.

**Выражение:** <br>
`Append([userPrincipalName], ".test")`

**Пример ввода и вывода:** <br>

* **Входные данные**: (userPrincipalName): "John.Doe@contoso.com"
* **Выходные данные**: "John.Doe@contoso.com.test"

### <a name="generate-user-alias-by-concatenating-parts-of-first-and-last-name"></a>Создание псевдонима пользователя путем сцепления частей имени и фамилии
Необходимо создать псевдоним пользователя, используя первые три буквы имени и первые пять букв фамилии пользователя.

**Выражение:** <br>
`Append(Mid([givenName], 1, 3), Mid([surname], 1, 5))`

**Пример ввода и вывода:** <br>

* **Входные данные** (givenName): "John"
* **Входные данные** (surname): "Doe"
* **Выходные данные**:  "JohDoe"

### <a name="remove-diacritics-from-a-string"></a>Удаление диакритических знаков из строки
Вам нужно заменить символы с диакритическими знаками эквивалентами без диакритических знаков.

**Выражение:** <br>
NormalizeDiacritics([givenName])

**Пример ввода и вывода:** <br>

* **Входные данные** (givenName): "Zoë"
* **Выходные данные**:  "Zoe"

### <a name="split-a-string-into-a-multi-valued-array"></a>Разделение строки на многозначный массив
Выберите список строк с разделителями-запятыми и разделите их на массив, который можно подключить к такому многозначному атрибуту, как, например, атрибут PermissionSets компании Salesforce. В этом примере список наборов разрешений заполнен в extensionAttribute5 в Azure AD.

**Выражение:** <br>
Split([extensionAttribute5], ",")

**Пример ввода и вывода:** <br>

* **Входные данные** (extensionAttribute5): "Пермиссионсетоне, пермиссионсеттво"
* **Выходные данные**:  ["PermissionSetOne", "PermissionSetTwo"]

### <a name="output-date-as-a-string-in-a-certain-format"></a>Вывод даты в виде строки в определенном формате
Необходимо отправить в приложение SaaS даты в определенном формате. <br>
Например, требуется отформатировать даты для ServiceNow.

**Выражение:** <br>

`FormatDateTime([extensionAttribute1], "yyyyMMddHHmmss.fZ", "yyyy-MM-dd")`

**Пример ввода и вывода:**

* **Входные данные** (extensionAttribute1): "20150123105347.1Z"
* **Выходные данные**:  "2015-01-23"

### <a name="replace-a-value-based-on-predefined-set-of-options"></a>Замена значения на основе предопределенного набора параметров

Необходимо определить часовой пояс пользователя на основе кода государства, сохраненного в Azure AD. <br>
Если код государства не совпадает с предопределенными параметрами, используйте значение по умолчанию «Australia/Sydney».

**Выражение:** <br>
`Switch([state], "Australia/Sydney", "NSW", "Australia/Sydney","QLD", "Australia/Brisbane", "SA", "Australia/Adelaide")`

**Пример ввода и вывода:**

* **Входные данные** (state): "QLD"
* **Выходные данные**: "Australia/Brisbane"

### <a name="replace-characters-using-a-regular-expression"></a>Замените символы с помощью регулярного выражения
Необходимо определить символы, соответствующие значению регулярного выражения, и удалить их.

**Выражение:** <br>

Replace([mailNickname], , "[a-zA-Z_]*", , "", , )

**Пример ввода и вывода:**

* **Входные данные** (mailNickname: "john_doe72"
* **Выходные данные**: "72"

### <a name="convert-generated-userprincipalname-upn-value-to-lower-case"></a>Преобразование созданного значения userPrincipalName (UPN) в нижний регистр
В приведенном ниже примере значение UPN создается путем объединения полей источника данных PreferredFirstName и PreferredLastName, а функция ToLower использует строку для преобразования всех знаков в нижний регистр. 

`ToLower(Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"))`

**Пример ввода и вывода:**

* **Входные данные** (PreferredFirstName): "John"
* **Входные данные** (PreferredLastName): "Smith"
* **Выходные данные**: "john.smith@contoso.com"

### <a name="generate-unique-value-for-userprincipalname-upn-attribute"></a>Создание уникального значения для атрибута userPrincipalName (имя участника-пользователя)
На основе имени, отчества и фамилии пользователя необходимо создать значение для атрибута имени участника-пользователя и проверить его на уникальность в целевом каталоге AD перед присвоением этого значения атрибуту имени участника-пользователя.

**Выражение:** <br>

```ad-attr-mapping-expr
    SelectUniqueValue( 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  [PreferredFirstName], [PreferredLastName]))), "contoso.com"), 
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 1), [PreferredLastName]))), "contoso.com"),
        Join("@", NormalizeDiacritics(StripSpaces(Join(".",  Mid([PreferredFirstName], 1, 2), [PreferredLastName]))), "contoso.com")
    )
```

**Пример ввода и вывода:**

* **Входные данные** (PreferredFirstName): "John"
* **Входные данные** (PreferredLastName): "Smith"
* **Выходные данные**: "John.Smith@contoso.com", если значение имени участника-пользователя John.Smith@contoso.com еще не существует в каталоге.
* **Выходные данные**: "J.Smith@contoso.com", если значение John.Smith@contoso.com уже существует в каталоге.
* **Выходные данные**: "Jo.Smith@contoso.com", если два указанные выше значения имени участника-пользователя уже существуют в каталоге.


## <a name="next-steps"></a>Дальнейшие действия 

- [Что собой представляет подготовка?](what-is-provisioning.md)
- [Что такое Azure AD Connect синхронизации в облаке?](what-is-cloud-sync.md)