---
title: Способы единого входа в Azure AD
description: Узнайте о способах единого входа, доступных в Azure Active Directory.
services: active-directory
author: iantheninja
manager: CelesteDG
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.topic: conceptual
ms.date: 12/03/2019
ms.author: iangithinji
ms.reviewer: arvindh, japere
ms.openlocfilehash: d81ad34c81a451f1faecb6cb33c0cc427567f122
ms.sourcegitcommit: 2654d8d7490720a05e5304bc9a7c2b41eb4ae007
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2021
ms.locfileid: "107379610"
---
# <a name="single-sign-on-options-in-azure-ad"></a>Способы единого входа в Azure AD

Единый вход предоставляет множество преимуществ в сравнении с традиционными методами входа.

- **С единым входом** пользователи входят один раз, используя одну учетную запись, и получают доступ к присоединенным к домену устройствам, ресурсам компании, приложениям SaaS (программное обеспечение как услуга) и веб-приложениям. После входа пользователь может запускать приложения на портале Office 365 или в разделе "Мои приложения". Администраторы могут централизовать управление учетными записями пользователей и автоматически добавлять или удалять доступ пользователей к приложениям с учетом членства в группах.

- **Без единого входа** пользователям приходится запоминать пароли для приложений и входить в каждое из них отдельно. ИТ-персоналу необходимо создавать и обновлять учетные записи пользователей для каждого приложения, например Microsoft 365, Box и Salesforce. Пользователям приходится запоминать свои пароли, а также тратить время на вход в каждое приложение.

Дополнительные сведения о едином входе см. в статье [Что собой представляет единый вход?](what-is-single-sign-on.md)

## <a name="choosing-a-single-sign-on-method"></a>Выбор способа единого входа

Настроить приложение для единого входа можно несколькими способами. Выбор способа единого входа зависит от того, как приложение настроено для аутентификации.

- В облачных приложениях может использоваться единый вход на основе OpenID Connect, OAuth, SAML или паролей либо связанный способ. Единый вход также можно отключить. 
- В локальных приложениях можно использовать единый вход на основе паролей, встроенной проверки подлинности Windows или заголовков либо связанный способ, а также можно отключить единый вход. Локальные варианты работают в том случае, если настроен прокси приложения.

Эта блок-схема поможет вам выбрать наиболее подходящий способ единого входа для вашей ситуации.

![Блок-схема принятия решений о реализации единого входа](./media/what-is-single-sign-on/choose-single-sign-on-method-040419.png)

В приведенной ниже таблице представлена сводка способов единого входа, а также ссылки на дополнительные сведения.

| Способ единого входа | Типы приложений | Назначение |
| :------ | :------- | :----- |
| [OpenID Connect и OAuth](#openid-connect-and-oauth) | В облаке и локальной среде | Используйте OpenID Connect и OAuth при разработке нового приложения. Эти протоколы упрощают настройку приложения, имеют простые пакеты SDK и позволяют приложению использовать MS Graph.
| [SAML](#saml-sso) | В облаке и локальной среде | По возможности выбирайте SAML для существующих приложений, которые не используют OpenID Connect или OAuth. SAML работает с приложениями, которые аутентифицируются с помощью одного из протоколов SAML.|
| [На основе пароля](#password-based-sso) | В облаке и локальной среде | Выберите способ на основе пароля, если в приложении выполняется аутентификация с помощью имени пользователя и пароля. Единый вход на основе пароля позволяет безопасно хранить пароли приложений и воспроизводить его с помощью расширения веб-браузера или мобильного приложения. Этот способ использует существующий процесс входа, предоставляемый приложением, однако позволяет администраторам управлять паролями. |
| [Связанный](#linked-sign-on) | В облаке и локальной среде | Используйте связанный вход, если для приложения настроен единый вход через службу другого поставщика удостоверений. При выборе этого варианта единый вход для приложения не настраивается. Однако для приложения может уже быть настроен единый вход с использованием другой службы, например служб федерации Active Directory.|
| [Отключено](#disabled-sso) | В облаке и локальной среде | Отключайте единый вход, если приложение не готово к настройке для единого входа. Этот режим используется по умолчанию при создании приложения.|
| [Встроенная проверка подлинности Windows (IWA)](#integrated-windows-authentication-iwa-sso) | Только в локальной среде | Используйте этот способ единого входа для приложений, использующих [встроенную проверку подлинности Windows (IWA)](/aspnet/web-api/overview/security/integrated-windows-authentication) или поддерживающих утверждения. Для IWA соединители прокси приложений используют ограниченное делегирование Kerberos (KCD) для аутентификации пользователей в приложении. |
| [На основе заголовков](#header-based-sso) | Только в локальной среде | Используйте единый вход на основе заголовков, если приложение использует заголовки для проверки подлинности. Прокси приложения использует Azure AD для проверки подлинности пользователя, а затем передает трафик через службу соединителей.  |

## <a name="openid-connect-and-oauth"></a>OpenID Connect и OAuth

При разработке новых приложений используйте современные протоколы, такие как OpenID Connect и OAuth, чтобы оптимально использовать единый вход для своего приложения на различных платформах устройств. OAuth позволяет пользователям и администраторам [предоставлять согласие](configure-user-consent.md) для защищенных ресурсов, таких как [Microsoft Graph](/graph/overview). Мы предоставляем простые в настройке [пакеты SDK](../develop/reference-v2-libraries.md) для вашего приложения. Кроме того, приложение будет готово к использованию [Microsoft Graph](/graph/overview).

Дополнительные сведения см. в разделе:

- [OAuth 2.0](../develop/v2-oauth2-auth-code-flow.md)
- [OpenID Connect 1.0](../develop/v2-protocols-oidc.md)
- [Руководство по платформе удостоверений Майкрософт для разработчиков](../develop/index.yml)

## <a name="saml-sso"></a>Единый вход SAML

С **единым входом на основе SAML** Azure AD проходит проверку подлинности в приложении, используя учетную запись Azure AD пользователя. Azure AD передает приложению данные для входа через протокол соединения. Если используется единый вход на основе SAML, вы можете сопоставлять пользователей с конкретными ролями приложений согласно правилам, определенным в утверждениях SAML.

Выберите единый вход на основе SAML, если приложение поддерживает его.

Единый вход на основе SAML поддерживается для приложений, использующих любые из следующих протоколов:

- SAML 2.0
- WS-Federation

Сведения о том, как настроить в приложении SaaS единый вход на основе SAML, см. в статье [Настройка единого входа на основе SAML](configure-saml-single-sign-on.md). Кроме того, многие приложения SaaS имеют руководства [для определенных приложений](../saas-apps/tutorial-list.md), которые позволяют пошагово выполнить настройку единого входа на основе SAML.

Чтобы настроить приложение для использования WS-Federation, выполните те же инструкции по настройке единого входа на основе SAML для приложения. На этапе настройки Azure AD в приложении вместо URL-адреса входа в Azure AD укажите конечную точку WS-Federation `https://login.microsoftonline.com/<tenant-ID>/wsfed`.

Сведения о настройке единого входа на основе SAML в локальном приложении см. в статье [Единый вход на основе SAML для локальных приложений с помощью прокси приложения](application-proxy-configure-single-sign-on-on-premises-apps.md).

Дополнительные сведения о принципе работы протокола SAML см. в статье [Протокол единого входа SAML](../develop/single-sign-on-saml-protocol.md).

## <a name="password-based-sso"></a>Единый вход на основе пароля

При использовании входа по паролю пользователям, чтобы войти в приложение, необходимо ввести имя пользователя и пароль при первом обращении к нему. После первого входа Azure AD предоставляет приложению имя пользователя и пароль.

Для единого входа на основе паролей используется имеющийся процесс проверки подлинности, предоставляемый приложением. Когда включается единый вход на основе паролей для приложения, служба Azure AD собирает и безопасно сохраняет имена пользователей и пароли для этого приложения. Учетные данные пользователей хранятся в каталоге в зашифрованном виде.

Выберите единый вход на основе пароля, если:

- приложение не поддерживает протокол единого входа SAML.
- приложение выполняет проверку подлинности с помощью имени пользователя и пароля, а не маркеров доступа и заголовков.

>[!NOTE]
>Для единого входа на основе пароля вы не сможете применить политики условного доступа или многофакторную проверку подлинности.

Единый вход на основе пароля поддерживается для любого облачного приложения со страницей входа на базе HTML. Пользователь может использовать любой из следующих браузеров:

- Internet Explorer 11 (в Windows 7 или более поздней версии);
   > [!NOTE]
   > Для браузера Internet Explorer доступна ограниченная поддержка — обновления программного обеспечения больше не доступны. Рекомендуется использовать браузер Microsoft Edge.

- Microsoft Edge в Windows 10 Anniversary Edition или более поздней версии;
- Microsoft Edge для iOS и Android;
- Intune Managed Browser;
- Chrome в ОС Windows 7 или более поздней версии и macOS X или более поздней версии;
- Firefox 26.0 или более поздней версии в ОС Windows XP с пакетом обновления 2 (SP2) или более поздней версии и macOS X 10.6 или более поздней версии;

Сведения о том, как настроить облачное приложение для единого входа на основе паролей, см. в статье о [настройке единого входа на основе пароля](configure-password-single-sign-on-non-gallery-applications.md).

Сведения о том, как настроить локальное приложение для единого входа через прокси приложения, см. в статье [Хранение паролей для единого входа с помощью прокси приложения](application-proxy-configure-single-sign-on-password-vaulting.md).

### <a name="how-authentication-works-for-password-based-sso"></a>Как работает аутентификация для единого входа на основе пароля

Чтобы выполнить аутентификацию пользователя в приложении, Azure AD получает учетные данные пользователя из каталога и вводит их на странице входа в приложение.  Azure AD безопасно передает учетные данные пользователя через расширение веб-браузера или мобильное приложение. Этот процесс позволяет администратору управлять учетными данными пользователей и не требует, чтобы пользователи запоминали свои пароли.

> [!IMPORTANT]
> Учетные данные маскируются от пользователя в процессе автоматического входа. Однако учетные данные можно обнаруживать с помощью средств веб-отладки. Пользователи и администраторы должны следовать тем же политикам безопасности, что и в том случае, когда учетные данные были введены непосредственно пользователем.

### <a name="managing-credentials-for-password-based-sso"></a>Управление учетными данными для единого входа на основе паролей

Паролями для каждого управления могут управлять администратор Azure AD или пользователи.

Когда администратор Azure AD управляет учетными данными:  

- пользователю не нужно сбрасывать или запоминать имя и пароль. Пользователь может получить доступ к приложению, выбрав его в разделе "Мои приложения" или по предоставленной ссылке.
- администратор может выполнять задачи управления с учетными данными. Например, администратор может обновлять доступ к приложениям в соответствии с членством пользователей в группах и состоянием сотрудников;
- администратор может использовать учетные данные администратора для предоставления доступа к приложениям, доступным множеству пользователей. Например, администратор может разрешить всем, у кого есть доступ к приложению, получать доступ к приложению для работы социальными сетями или совместного доступа к документам.

Когда пользователь управляет учетными данными:

- пользователи могут управлять своими паролями, при необходимости обновляя или удаляя их;
- администраторы по-прежнему могут задавать новые учетные данные для приложения.

## <a name="linked-sign-on"></a>Связанный единый вход
Связанный единый вход позволяет службе Azure AD добавлять возможность единого входа в приложение, которое уже настроено для единого входа в другой службе. Связанное приложение может быть видно пользователям на портале Office 365 или портале Azure AD MyApps. Например, пользователь может запустить приложение, настроенное для единого входа в службах федерации Active Directory 2.0 (AD FS) на портале Office 365. Для связанных приложений, запускаемых с портала Office 365 или Azure AD MyApps, также доступна дополнительная отчетность. Сведения о настройке связанного входа в приложении см. в статье [Настройка связанного единого входа](configure-linked-sign-on.md).

### <a name="linked-sign-on-for-application-migration"></a>Связанный единый вход для миграции приложений

Связанный вход предоставляет согласованный пользовательский интерфейс при переносе приложений в течение определенного времени. Если вы переносите приложения в Azure Active Directory, вы можете использовать связанный вход, чтобы быстро опубликовать ссылки на все приложения, которые планируется перенести.  Пользователи могут найти все ссылки на [портале MyApps](../user-help/my-apps-portal-end-user-access.md) или в [средстве запуска приложений Microsoft 365](https://support.office.com/article/meet-the-office-365-app-launcher-79f12104-6fed-442f-96a0-eb089a3f476a). Пользователи не знают, получают ли они доступ к связанному или перенесенному приложению.  

Когда пользователь пройдет проверку подлинности в связанном приложении, необходимо создать учетную запись, чтобы пользователь получил доступ к единому входу. Эта учетная запись может быть подготовлена либо автоматически, либо вручную администратором.

>[!NOTE]
>Для связанного приложения вы не сможете применить политики условного доступа или многофакторную проверку подлинности, так как связанное приложение не поддерживает единый вход через Azure AD. При настройке связанного приложения вы только добавляете ссылку, которая будет отображаться в средстве запуска приложений или на портале MyApps. 

## <a name="disabled-sso"></a>Отключенный единый вход

Отключенный режим означает, что для приложения не используется единый вход. Если единый вход отключен, пользователям может потребоваться пройти проверку подлинности дважды. Сначала пользователи проходят проверку подлинности в Azure AD, а затем входят в приложение.

Используйте режим отключенного единого входа:

- если вы не готовы интегрировать это приложение с единым входом Azure AD;
- если вы тестируете другие аспекты приложения;
- в качестве уровня защиты для локального приложения, которое не требует проверки подлинности пользователей. Если единый вход отключен, пользователь должен проходить проверку подлинности.

Обратите внимание, что, если вы настроили в приложении единый вход на основе SAML, инициированного поставщиком служб, а затем отключаете режим единого входа, это не помешает пользователям входить в приложение в обход портала MyApps. Чтобы полностью запретить вход, нужно [отключить возможность входа пользователей](disable-user-sign-in-portal.md).

## <a name="integrated-windows-authentication-iwa-sso"></a>Единый вход со встроенной проверкой подлинности Windows (IWA)

[Прокси приложения](application-proxy.md) предоставляет единый вход для приложений, которые используют [встроенную проверку подлинности Windows (IWA)](/aspnet/web-api/overview/security/integrated-windows-authentication) или поддерживают утверждения. Если приложение использует встроенную аутентификацию Windows, прокси приложения выполняет проверку подлинности в приложении с помощью ограниченного делегирования Kerberos (KCD). В случае приложения с поддержкой утверждений, которое доверяет Azure Active Directory, единый вход для приложения работает, так как пользователь уже прошел проверку подлинности с помощью Azure AD.

Выберите режим единого входа со Встроенной проверкой подлинности Windows (IWA), чтобы обеспечить единый вход в локальное приложение, которое выполняет проверку подлинности с помощью IWA.

Сведения о том, как настроить локальное приложение для IWA, см. в статье [Ограниченное делегирование Kerberos для единого входа в приложения с помощью прокси приложений](application-proxy-configure-single-sign-on-with-kcd.md).

### <a name="how-single-sign-on-with-kcd-works"></a>Принцип работы единого входа с применением KCD
На схеме показан процесс, в ходе которого пользователь получает доступ к локальному приложению, использующему IWA.

![Схема процесса проверки подлинности Microsoft Azure AD](./media/application-proxy-configure-single-sign-on-with-kcd/AuthDiagram.png)

1. Пользователь вводит URL-адрес для получения доступа к локальному приложению через Application Proxy.
1. Прокси приложения перенаправляет запрос в службы проверки подлинности Azure AD, чтобы выполнить предварительную проверку подлинности. На этом этапе Azure AD применяет все применимые политики проверки подлинности и авторизации, например многофакторную проверку подлинности. Если пользователь проверен, Azure AD создает токен и отправляет его пользователю.
1. Пользователь передает токен в прокси приложения.
1. Прокси приложения проверяет токен и получает из него имя участника-пользователя (UPN). Затем он отправляет запрос, UPN и имя субъекта-службы (SPN) соединителю через безопасный канал с двойной проверкой подлинности.
1. Соединитель использует согласование ограниченного делегирования Kerberos с локальной службой AD, олицетворяя пользователя, чтобы получить токен Kerberos для приложения.
1. Active Directory отправляет токен Kerberos для приложения соединителю.
1. Соединитель отправляет исходный запрос на сервер приложений, используя токен Kerberos, полученный от AD.
1. Приложение отправляет соединителю ответ, который затем возвращается службе прокси приложения и пользователю.

## <a name="header-based-sso"></a>Единый вход на основе заголовков

Единый вход на основе заголовков работает для приложений, использующих заголовки HTTP для проверки подлинности.

Выберите единый вход на основе заголовка, если для локального приложения настроена функция Application Proxy.

Дополнительные сведения о проверке подлинности на основе заголовка см. в статье о [едином входе на основе заголовка](application-proxy-configure-single-sign-on-with-headers.md).


## <a name="next-steps"></a>Дальнейшие действия
* [Серия кратких руководств по управлению приложениями](view-applications-portal.md)
* [Планирование развертывания единого входа](plan-sso-deployment.md)
* [Единый вход с локальными приложениями](application-proxy-config-sso-how-to.md)