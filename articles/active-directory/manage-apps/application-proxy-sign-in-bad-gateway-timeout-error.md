---
title: Ошибка "Can't Access this Corporate Application" (Нет доступа к этому корпоративному приложению) при использовании приложения прокси приложения
description: Устранение распространенных проблем доступа в приложениях прокси приложения Azure AD.
services: active-directory
documentationcenter: ''
author: kenwith
manager: daveba
ms.assetid: ''
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: troubleshooting
ms.date: 05/21/2019
ms.author: kenwith
ms.reviewer: asteen
ms.collection: M365-identity-device-management
ms.openlocfilehash: 0b9fb68643c48c685194fa7ba1f1e5050d2d3cc7
ms.sourcegitcommit: d49bd223e44ade094264b4c58f7192a57729bada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2021
ms.locfileid: "99254937"
---
# <a name="cant-access-this-corporate-application-error-when-using-an-application-proxy-application"></a>Ошибка "Can't Access this Corporate Application" (Не удается обратиться к этому корпоративному приложению) при использовании приложения прокси приложения

Эта статья помогает устранять распространенные проблемы при появлении ошибки This corporate app can't be accessed (Доступ к этому корпоративному приложению невозможен) в приложении прокси приложения Azure AD.

## <a name="overview"></a>Обзор

При появлении этой ошибки найдите на странице код состояния. Этот код, скорее всего, является одним из следующих кодов состояния:

- **Истекло время ожидания шлюза**. Службе прокси приложения не удается подключиться к соединителю. Эта ошибка обычно указывает на проблему с назначением соединителя, самим соединителем либо связанными с ним сетевыми правилами.
- **Недопустимый шлюз**. Соединителю не удается связаться с серверным приложением. Эта ошибка может указывать на неправильную настройку приложения.
- **Запрещено**. Пользователь не имеет права на доступ к приложению. Эта ошибка может произойти, если пользователь не назначен приложению в Azure Active Directory или если в серверной части у пользователя нет разрешения на доступ к приложению.

Чтобы найти код, просмотрите текст в левом нижнем углу сообщения об ошибке для поля "код состояния". Кроме того, ознакомьтесь с дополнительными советами в самом конце страницы.

![Пример Ошибка при истечении времени ожидания шлюза](./media/application-proxy-sign-in-bad-gateway-timeout-error/connection-problem.png)

Сведения об устранении первопричины этих ошибок и рекомендуемых исправлениях см. в соответствующем разделе ниже.

## <a name="gateway-timeout-errors"></a>Ошибки при истечении времени ожидания шлюза

Время ожидания шлюза истекает, когда службе не удается связаться с соединителем в течение определенного периода. Обычно эта ошибка вызвана тем, что приложение назначено группе соединителей без работающих соединителей либо закрыты некоторые необходимые соединителю порты.

## <a name="bad-gateway-errors"></a>Ошибки с недопустимым шлюзом

Ошибка с недопустимым шлюзом указывает, что соединителю не удается связаться с серверным приложением. Убедитесь, что опубликовано нужное приложение. Распространенные ошибки, вызывающие эту ошибку:

- Опечатка или ошибка во внутреннем URL-адресе
- Исключение корневого каталога приложения из публикации. Например, публикуется `http://expenses/reimbursement`, а обращение выполняется к `http://expenses`.
- Проблемы с конфигурацией ограниченного делегирования Kerberos (KCD)
- Проблемы с серверным приложением

## <a name="forbidden-errors"></a>Ошибка с запретом

Если вы видите ошибку с запретом, значит пользователь не назначен этому приложению. Эта ошибка может возникнуть либо в Azure Active Directory, либо в серверном приложении.

Чтобы узнать, как назначить пользователям приложению в Azure, см. [документацию по конфигурации](application-proxy-add-on-premises-application.md#test-the-application).

Если вы подтверждаете, что пользователь назначен приложению в Azure, проверьте конфигурацию пользователей в серверном приложении. При использовании ограниченного делегирования Kerberos или встроенной проверки подлинности Windows рекомендации можно получить на странице устранения неполадок с KCD.

## <a name="check-the-applications-internal-url"></a>Проверка внутреннего URL-адреса приложения

В качестве первого шага перепроверьте и исправьте внутренний URL-адрес, открыв приложение через функцию **Корпоративные приложения**, а затем выбрав меню **Прокси приложения**. Убедитесь, что для доступа к приложению используется внутренний URL-адрес из локальной сети.

## <a name="check-the-application-is-assigned-to-a-working-connector-group"></a>Проверка назначения приложения рабочей группе соединителей

Убедитесь, что приложение назначено рабочей группе соединителей:

1. Откройте приложение на портале, перейдя в **Azure Active Directory** и выбрав **Корпоративные приложения** и затем **Все приложения.** Откройте приложение, а затем выберите **Прокси приложения** в меню слева.
1. Взгляните на поле "Группа соединителей". Если в группе нет активных соединителей, отображается предупреждение. Если вы не видите предупреждения, перейдите к разделу Проверка того, что все [необходимые порты](application-proxy-add-on-premises-application.md) разрешены.
1. Если отображается неправильная группа соединителей, выберите подходящую группу с помощью раскрывающегося списка и убедитесь, что предупреждения больше не отображаются. Если это нужная группа соединителей, щелкните предупреждение, чтобы открыть страницу с функциями управления соединителями.
1. Здесь работу можно продолжить несколькими способами:

   - Переместите активный соединитель в группу. Если у вас есть активный соединитель, который должен принадлежать к этой группе и находится в прямой видимости для серверного приложения, можно перенести соединитель в назначенную группу. Для этого щелкните соединитель. В поле "Группа соединителей" выберите нужную группу в раскрывающемся списке и нажмите кнопку Сохранить.
   - Скачайте новый соединитель для этой группы. На этой странице можно получить ссылку для [скачивания нового соединителя](https://download.msappproxy.net/Subscription/d3c8b69d-6bf7-42be-a529-3fe9c2e70c90/Connector/Download). Установите соединитель на компьютере, находящемся в пределах "прямой видимости" для серверного приложения. Обычно соединитель устанавливается на том же сервере, что и приложение. Используйте ссылку на скачивание соединителя, чтобы скачать соединитель на целевой компьютер. Затем щелкните соединитель и используйте раскрывающийся список "Группа соединителей", чтобы убедиться, что он принадлежит к правой группе.
   - Проверьте неактивный соединитель. Если соединитель отображается как неактивный, значит ему не удалось подключиться к службе. Обычно эта ошибка возникает, потому что заблокированы некоторые необходимые порты. Чтобы устранить проблему, переходите к проверке того, что нужные порты внесены в список разрешенных.

Выполнив эти действия по назначению приложения группе с работающими соединителями, проверьте приложение еще раз. Если оно по-прежнему не работает, перейдите к следующему разделу.

## <a name="check-all-required-ports-are-open"></a>Проверка того, что нужные порты внесены в список разрешенных

Убедитесь, что все необходимые порты открыты. Необходимые порты см. в разделе "открытые порты" [руководства по добавлению локального приложения для удаленного доступа через прокси приложения в Azure Active Directory](application-proxy-add-on-premises-application.md). Если все нужные порты открыты, перейдите к следующему разделу.

## <a name="check-for-other-connector-errors"></a>Проверка других ошибок соединителя

Если ничего из приведенного выше не позволяет устранить неполадку, нужно искать проблемы или ошибки в самом соединителе. Некоторые распространенные ошибки приведены в [документе по устранению неполадок](./application-proxy-troubleshoot.md#connector-errors).

Для выявления ошибок можно просмотреть журналы соединителя. Многие сообщения об ошибках содержат более конкретные рекомендации по устранению неполадок. Сведения о просмотре журналов см. в разделе [Как все устроено](application-proxy-connectors.md#under-the-hood).

## <a name="additional-resolutions"></a>Дополнительные ресурсы

Если описанная выше проблема не привела к устранению проблемы, существует несколько различных возможных причин. Для определение проблемы сделайте следующее:

Если приложение настроено для использования встроенной проверки подлинности Windows, протестируйте приложение без единого входа. В противном случае перейдите к следующему абзацу. Чтобы проверить приложение без единого входа, откройте приложение с помощью функции **Корпоративные приложения** и перейдите в меню **Единый вход**. Измените раскрывающийся список "встроенная проверка подлинности Windows" на "единый вход Azure AD Disabled".

Откройте браузер и попробуйте обратиться к приложению еще раз. При этом должен появиться запрос проверки подлинности с последующим входом в приложение. Если аутентификация выполняется, проблема связана с конфигурацией ограниченного делегирования Kerberos (KCD), которая обеспечивает единый вход. Дополнительные сведения см. на странице, посвященной устранению неполадок KCD.

Если эта ошибка продолжает отображаться, перейдите на компьютер, где установлен соединитель, откройте браузер и попытайтесь подключиться по внутреннему URL-адресу, используемому для приложения. Соединитель выступает в качестве другого клиента с того же компьютера. Если вы не можете связаться с приложением, выясните, почему компьютеру не удается подключиться к приложению, или используйте соединитель на сервере, который может получить доступ к приложению.

Если вы можете связаться с приложением с этого компьютера, нужно искать проблемы или ошибки в самом соединителе. Некоторые распространенные ошибки приведены в [документе по устранению неполадок](application-proxy-troubleshoot.md#connector-errors). Для выявления ошибок можно просмотреть журналы соединителя. Многие из наших сообщений об ошибках содержат более конкретные рекомендации по устранению неполадок. Чтобы научиться просматривать журналы, см. [нашу документацию по соединителям](application-proxy-connectors.md#under-the-hood).

## <a name="next-steps"></a>Дальнейшие действия

[Сведения о соединителях прокси приложения Azure AD](application-proxy-connectors.md)