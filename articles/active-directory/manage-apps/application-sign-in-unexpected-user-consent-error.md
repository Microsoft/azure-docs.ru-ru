---
title: Непредвиденная ошибка при предоставлении согласия для приложения | Документы Майкрософт
description: Здесь описаны ошибки, возникающие при предоставлении согласия для приложения, и способы их устранения.
services: active-directory
documentationcenter: ''
author: kenwith
manager: daveba
ms.assetid: ''
ms.service: active-directory
ms.subservice: app-mgmt
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: troubleshooting
ms.date: 07/11/2017
ms.author: kenwith
ms.reviewer: asteen
ms.collection: M365-identity-device-management
ms.openlocfilehash: 9f829672f88ea848e4611000b54d9cc200bc166d
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99259983"
---
# <a name="unexpected-error-when-performing-consent-to-an-application"></a>Непредвиденная ошибка при предоставлении согласия для приложения

В этой статье описаны ошибки, возникающие при предоставлении согласия для приложения. Если вы получаете непредвиденные запросы на продолжение, не содержащие сообщения об ошибках, см. статью [Сценарии проверки подлинности в Azure AD](../develop/authentication-vs-authorization.md).

Для правильной работы многим приложениям, интегрирующимся с Azure Active Directory, нужны разрешения на доступ к другим ресурсам. Если эти ресурсы также интегрированы с Azure Active Directory, доступ к ним часто запрашивается с помощью общей инфраструктуры согласия. Поступает запрос на продолжение, что обычно происходит при первом использовании приложения, но может встречаться и при дальнейшем использовании.

Чтобы пользователь дал согласие на необходимые приложению разрешения, должны выполняться определенные условия. Иначе могут происходить указанные ниже ошибки.

## <a name="requesting-not-authorized-permissions-error"></a>Ошибка при запросе неавторизованных разрешений
* **AADSTS90093:** &lt;clientAppDisplayName&gt; is requesting one or more permissions that you are not authorized to grant. Contact an administrator, who can consent to this application on your behalf. ("clientAppDisplayName" запрашивает одно или несколько разрешений, которые вы не имеете права предоставлять. Обратитесь к администратору, который может дать согласие для этого приложения от вашего имени.)
* **AADSTS90094:** &lt;clientAppDisplayName&gt; требуются разрешения на доступ к ресурсам в вашей организации, которые может предоставить только администратор. Попросите администратора предоставить разрешение для этого приложения, прежде чем его можно будет использовать.

Эта ошибка возникает, когда пользователь, не являющийся глобальным администратором, пытается использовать приложение, запрашивающее разрешения, которые может предоставить только администратор. Администратор может устранить эту ошибку, предоставив доступ к приложению от имени своей организации.

Эта ошибка также может возникать, когда пользователю запрещено отсылать приложения из-за того, что корпорация Майкрософт обнаруживает, что запрос разрешений является рискованным. В этом случае событие аудита также будет регистрироваться с категорией "Аппликатионманажемент", типом действия "согласие на приложение" и состоянием "обнаружено рискованное приложение".

Другой сценарий, в котором может возникнуть Эта ошибка, заключается в том, что для приложения требуется назначение пользователя, но не предоставлено согласие администратора. В этом случае администратор должен сначала предоставить согласие администратора.   

## <a name="policy-prevents-granting-permissions-error"></a>Ошибка при блокировке назначения разрешений политикой
* **AADSTS90093:** An administrator of &lt;tenantDisplayName&gt; has set a policy that prevents you from granting &lt;name of app&gt; the permissions it is requesting. Contact an administrator of &lt;tenantDisplayName&gt;, who can grant permissions to this app on your behalf. (Администратор "tenantDisplayName" задал политику, которая запрещает предоставление разрешений, запрошенных "имя приложения". Обратитесь к администратору "tenantDisplayName", который может предоставить разрешения для этого приложения от вашего имени.)

Эта ошибка возникает, когда глобальный администратор отключает возможность пользователей получать согласие на использование приложений, а пользователь без прав администратора пытается использовать приложение, которому требуется согласие. Администратор может устранить эту ошибку, предоставив доступ к приложению от имени своей организации.

## <a name="intermittent-problem-error"></a>Ошибка, связанная с периодически возникающей проблемой
* **AADSTS90090:** It looks like the sign-in process encountered an intermittent problem recording the permissions you attempted to grant to &lt;clientAppDisplayName&gt;. Try again later. (Похоже, мы столкнулись с периодически возникающей проблемой при записи разрешений, которые вы пытались предоставить "clientAppDisplayName". Повторите попытку позже.)

Эта ошибка указывает на наличие периодически возникающей проблемы на стороне службы. Для ее решения можно еще раз попытаться предоставить согласие для приложения.

## <a name="resource-not-available-error"></a>Ошибка при недоступном ресурсе
* **AADSTS65005:** The app &lt;clientAppDisplayName&gt; requested permissions to access a resource &lt;resourceAppDisplayName&gt; that is not available. (Приложение "clientAppDisplayName" запросило разрешения для обращения к недоступному ресурсу "resourceAppDisplayName".) 

Свяжитесь с разработчиком приложения.

##  <a name="resource-not-available-in-tenant-error"></a>Ошибка при недоступном ресурсе в клиенте
* **AADSTS65005:** &lt;clientAppDisplayName&gt; is requesting access to a resource &lt;resourceAppDisplayName&gt; that is not available in your organization &lt;tenantDisplayName&gt;. ("clientAppDisplayName" запрашивает доступ к ресурсу "resourceAppDisplayName", который недоступен в вашей организации "tenantDisplayName".) 

Убедитесь, что этот ресурс доступен, или обратитесь к администратору &lt;tenantDisplayName&gt;.

## <a name="permissions-mismatch-error"></a>Ошибка при несовпадении разрешений
* **AADSTS65005:** The app requested consent to access resource &lt;resourceAppDisplayName&gt;. This request failed because it does not match how the app was pre-configured during app registration. Contact the app vendor.** (Приложение запросило согласие на обращение к ресурсу "resourceAppDisplayName". Выполнить этот запрос не удалось, так как он не соответствует предварительной настройке приложения, заданной при регистрации. Обратитесь к поставщику.)

Эти ошибки всегда возникают, когда приложение, для которого пользователь пытается предоставить согласие, запрашивает разрешения на доступ к приложению-ресурсу, отсутствующее в каталоге организации (клиенте). Такая ситуация может возникнуть по нескольким причинам:

-   Разработчик клиентского приложения неправильно настроил его, в результате чего оно запрашивает доступ к недопустимому ресурсу. В этом случае разработчику нужно обновить конфигурации клиентского приложения для устранения этой проблемы.

-   Субъект-служба, представляющий целевое приложение-ресурс, которое отсутствует в организации либо было удалено. Чтобы устранить эту проблему, в организации нужно подготовить субъект-службу для приложения-ресурса, после чего клиентское приложение сможет запросить для него права. Есть несколько способов подготовки субъекта-службы, выбор которых зависит от типа приложения. Среди них:

    -   Приобретение подписки для приложения-ресурса (приложения, опубликованные корпорацией Майкрософт)

    -   Предоставление согласия для приложения-ресурса

    -   Предоставление разрешений для приложения с помощью портала Azure

    -   Добавление приложения из коллекции приложений Azure AD

## <a name="risky-app-error-and-warning"></a>Ошибка и предупреждение о рискованном приложении
* **AADSTS900941:** Требуется согласие администратора. Приложение считается рискованным. (Админконсентрекуиреддуеторискяпп)
* Это приложение может быть рискованным. Если вы доверяете этому приложению, обратитесь к администратору, чтобы предоставить вам доступ.
* **AADSTS900981:** Запрос согласия администратора был получен для рискованного приложения. (Админконсентрекуестрискяппварнинг)
* Это приложение может быть рискованным. Продолжайте только в том случае, если вы доверяете этому приложению.

Оба эти сообщения будут отображаться, когда корпорация Майкрософт определит, что запрос согласия может быть рискованным. Среди многих других факторов это может произойти, если [проверенный издатель](../develop/publisher-verification-overview.md) не был добавлен в регистрацию приложения. Первый код ошибки и сообщение будут отображаться для конечных пользователей при отключенном [рабочем процессе согласия администратора](configure-admin-consent-workflow.md) . Второй код и сообщение будут отображаться для конечных пользователей, когда включен рабочий процесс согласия администратора и для администраторов. 

Конечные пользователи не смогут предоставить согласие для приложений, которые были обнаружены как рискованные. Администраторы могут, но должны оценивать приложение очень осторожно и продолжить работу. Если приложение кажется подозрительным при дальнейшей проверке, его можно сообщить в корпорацию Майкрософт на экране согласия. 

## <a name="next-steps"></a>Дальнейшие действия 

[Приложения, разрешения и согласие в Azure Active Directory (конечная точка версии 1)](../develop/quickstart-register-app.md)<br>

[Области, разрешения и согласие в Azure Active Directory (конечная точка версии 2.0)](../develop/v2-permissions-and-consent.md)