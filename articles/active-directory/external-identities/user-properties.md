---
title: Свойства гостевого пользователя B2B — Azure Active Directory | Документация Майкрософт
description: Свойства и состояния гостевых пользователей Azure Active Directory B2B до и после активации приглашения
services: active-directory
ms.service: active-directory
ms.subservice: B2B
ms.topic: how-to
ms.date: 03/18/2021
ms.author: mimart
author: msmimart
manager: celestedg
ms.reviewer: mal
ms.custom: it-pro, seo-update-azuread-jan, seoapril2019
ms.collection: M365-identity-device-management
ms.openlocfilehash: 08ed02c65db201e18ce710633b421edb5ecb2db0
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104655705"
---
# <a name="properties-of-an-azure-active-directory-b2b-collaboration-user"></a>Свойства пользователя службы совместной работы Azure Active Directory B2B

В этой статье описываются свойства и состояния объекта гостевого пользователя B2B в Azure Active Directory (Azure AD) до и после активации приглашения. Пользователь службы совместной работы Azure AD "бизнес-бизнес" (B2B) — это пользователь с UserType = Guest. Обычно такой пользователь является представителем партнерской организации и по умолчанию имеет ограниченные права в каталоге приглашающей организации.

В зависимости от потребностей приглашающей организации пользователь службы совместной работы Azure AD B2B может пребывать в одном из следующих состояний учетной записи.

- Состояние 1. Пользователь размещен во внешнем экземпляре Azure AD и представлен в приглашающей организации как гостевой пользователь. В этом случае пользователь B2B входит в систему с учетной записью Azure AD, принадлежащей приглашенному клиенту. Если партнерская организация не использует Azure AD, то создается гостевой пользователь в Azure AD. Для этого требуется, чтобы пользователь активировал приглашение, а служба Azure AD проверила его адрес электронной почты. Такой подход также называется JIT-клиентом или вирусным клиентом.

   > [!IMPORTANT]
   > **Начиная с октября 2021 г.** корпорация Майкрософт прекратит поддержку активации через приглашение при создании неуправляемых учетных записей и арендаторов Azure AD для сценариев совместной работы B2B. В ходе подготовки мы советуем клиентам перейти на [проверку подлинности с использованием одноразового секретного кода](one-time-passcode.md). Мы будем рады вашим отзывам об этой функции, предоставляемой в общедоступной предварительной версии, и с радостью создадим другие способы для совместной работы.

- Состояние 2: размещено в Microsoft или другой учетной записи и представляется в качестве гостевого пользователя в Организации узла. В этом случае гостевой пользователь входит в систему, используя учетную запись Майкрософт или учетную запись социальной сети (google.com или аналогичной). Удостоверение приглашенного пользователя создается как учетная запись Майкрософт в каталоге приглашающей организации во время активации предложения.

- Состояние 3. Пользователь размещен в локальном каталоге Active Directory главной организации и синхронизируется с каталогом Azure AD главной организации. Вы можете использовать службу Azure AD Connect для синхронизации партнерских учетных записей с облаком в качестве пользователей Azure AD B2B, у которых атрибут UserType имеет значение Guest. Ознакомьтесь со статьей [Предоставление локально управляемым партнерским учетным записям доступа к облачным ресурсам через службу совместной работы Azure Active Directory B2B](hybrid-on-premises-to-cloud.md).

- Состояние 4. размещено в Azure AD главной организации с помощью UserType = Guest и учетных данных, которыми управляет Организация узла.

  ![Схема, отображающая четыре состояния пользователей](media/user-properties/redemption-diagram.png)


Теперь давайте рассмотрим, как в Azure AD выглядит пользователь службы совместной работы Azure AD B2B.

### <a name="before-invitation-redemption"></a>До активации приглашения

Учетные записи с состоянием 1 и 2 являются результатом приглашения гостевых пользователей для совместной работы с помощью гостевых учетных данных. После изначальной отправки приглашения пользователю-гостю в вашем каталоге создается учетная запись. С ней не связаны учетные данные, так как проверку подлинности гостевого пользователя выполняет поставщик удостоверений. Свойство **Источник** учетной записи гостевого пользователя в каталоге имеет значение **Приглашенный пользователь**. 

![Снимок экрана, показывающий свойства пользователя до активации предложения](media/user-properties/before-redemption.png)

### <a name="after-invitation-redemption"></a>После активации приглашения

После того, как гостевой пользователь принимает приглашение, свойство **Источник** обновляется в зависимости от поставщика удостоверений гостевого пользователя.

Для гостевых пользователей с состоянием 1 **Источник** — это **внешний Azure Active Directory**.

![Гостевой пользователь с состоянием 1 после активации предложения](media/user-properties/after-redemption-state1.png)

Для гостевых пользователей с состоянием 2 **Источник** — это **учетная запись Майкрософт**.

![Гостевой пользователь с состоянием 2 после активации предложения](media/user-properties/after-redemption-state2.png)

Для гостевых пользователей с состоянием 3 и 4 для свойства **Источник** задано значение **Azure Active Directory** или **Windows Server Active Directory**, как описано в следующем разделе.

## <a name="key-properties-of-the-azure-ad-b2b-collaboration-user"></a>Основные свойства пользователя службы совместной работы Azure AD B2B
### <a name="usertype"></a>UserType
Это свойство указывает связь пользователя с главным клиентом. Оно может иметь два значения:
- Member (Участник). Это сотрудник главной организации, получающий зарплату в этой организации. Например, это пользователь, которому нужен доступ к сайтам только для внутреннего использования. Этот пользователь не считается внешним сотрудником.

- Гость. это значение указывает пользователя, который не считается внутренним для компании, например внешним участником совместной работы, партнером или клиентом. Такой пользователь не должен, например, получать служебных записок от генерального директора или пользоваться социальным пакетом компании.

  > [!NOTE]
  > Свойство UserType не влияет на то, как пользователь выполняет вход, какие роли он получает в каталоге и т. д. Оно только показывает связь пользователя с главной организацией, и организация может применять политики в зависимости от значения этого свойства.

Сведения о ценах см. на [Azure Active Directory ценах](https://azure.microsoft.com/pricing/details/active-directory).

### <a name="source"></a>Источник
Это свойство указывает, как пользователь выполняет вход.

- Приглашенный пользователь. Это пользователь, который был приглашен, но еще не активировал свое приглашение.

- Внешние Azure Active Directory. Этот пользователь находится во внешней организации и проходит проверку подлинности с помощью учетной записи Azure AD, которая принадлежит другой организации. Этот тип входа соответствует состоянию 1.

- Учетная запись Майкрософт. У этого пользователя есть учетная запись Майкрософт, которую он использует для проверки подлинности. Этот тип входа соответствует состоянию 2.

- Windows Server Active Directory. Этот пользователь выполняет вход из локального каталога Active Directory, принадлежащего этой организации. Этот тип входа соответствует состоянию 3.

- Azure Active Directory. Этот пользователь проходит проверку подлинности с помощью учетной записи Azure AD, принадлежащей этой организации. Этот тип входа соответствует состоянию 4.
  > [!NOTE]
  > Свойства Source и UserType не зависят друг от друга. Значение атрибута Source не подразумевает определенного значения UserType.

## <a name="can-azure-ad-b2b-users-be-added-as-members-instead-of-guests"></a>Можно ли добавить пользователей Azure AD B2B в качестве участников (Member), а не гостей (Guest)?
Как правило, понятия "пользователь службы Azure AD B2B" и "гостевой пользователь" являются синонимами. Поэтому пользователь службы совместной работы Azure AD B2B по умолчанию добавляется как гостевой пользователь (UserType = Guest). Однако в некоторых случаях партнерская организация может входить наряду с главной организацией в более крупную организацию. В таких случаях главная организация может рассматривать пользователей из партнерской организации как участников, а не гостей. Воспользуйтесь API-интерфейсами диспетчера приглашений Azure AD B2B, чтобы добавить или пригласить пользователя из партнерской организации в главную организацию как участника.

## <a name="filter-for-guest-users-in-the-directory"></a>Фильтрация гостевых пользователей в каталоге

![Снимок экрана, показывающий фильтр для гостевых пользователей](media/user-properties/filter-guest-users.png)

## <a name="convert-usertype"></a>Преобразование UserType
Преобразовать тип пользователей, меняя значение свойства UserType с Member на Guest и обратно, можно с помощью PowerShell. Однако при этом свойство UserType достоверно отражает связь пользователя с организацией. Поэтому это свойство следует изменять, только если изменяется связь пользователя с организацией. Если изменяется связь пользователя, следует ли изменять имя участника-пользователя? Сохранит ли пользователь доступ к тем же ресурсам? Нужно ли назначить почтовый ящик? Мы не рекомендуем изменять UserType с помощью PowerShell без связи с другими действиями. Кроме того, мы советуем не полагаться на использование этого свойства, так как возможность изменять его с помощью PowerShell может быть отключена.

## <a name="remove-guest-user-limitations"></a>Снятие ограничений для гостевых пользователей
В определенных случаях требуется предоставить гостевым пользователям привилегии более высокого уровня. Можно добавить гостевого пользователя в любую роль или даже удалить заданные по умолчанию ограничения для гостевых пользователей в каталоге. Это позволит ему пользоваться такими же привилегиями, как у участников.

Ограничения, заданные по умолчанию, можно отключить. При этом гостевой пользователь получит те же разрешения в каталоге компании, что и участник.

![Снимок экрана с параметром внешних пользователей в параметрах пользователя](media/user-properties/remove-guest-limitations.png)

## <a name="can-i-make-guest-users-visible-in-the-exchange-global-address-list"></a>Можно ли сделать так, чтобы гостевые пользователи отображались в глобальном списке адресов Exchange?
Да. По умолчанию гостевые объекты не отображаются в списке глобальных адресов вашей организации, но их можно сделать видимыми с помощью Azure Active Directory PowerShell. Дополнительные сведения см. в разделе "Добавление гостей в глобальный список адресов" [статьи Microsoft 365 гостевой доступ для каждой группы](/microsoft-365/solutions/per-group-guest-access).

## <a name="can-i-update-a-guest-users-email-address"></a>Можно ли обновить адрес электронной почты гостевого пользователя?

Если гостевой пользователь принимает ваше приглашение и впоследствии изменяет свой адрес электронной почты, новое сообщение не будет автоматически синхронизироваться с объектом гостевого пользователя в вашем каталоге. Свойство mail создается с помощью [Microsoft Graph API](/graph/api/resources/user). Свойство Mail можно обновить с помощью Microsoft Graph API, центра администрирования Exchange или [Exchange Online PowerShell](/powershell/module/exchange/users-and-groups/set-mailuser). Изменение будет отражено в объекте гостевого пользователя Azure AD.

## <a name="next-steps"></a>Дальнейшие действия

* [Что такое служба совместной работы Azure AD B2B?](what-is-b2b.md)
* [Основные сведения о токенах пользователей в службе совместной работы Azure Active Directory B2B](user-token.md)
* [Сопоставление утверждений пользователя службы совместной работы B2B в Azure Active Directory](claims-mapping.md)
