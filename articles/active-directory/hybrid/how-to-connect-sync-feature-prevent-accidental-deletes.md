---
title: 'Синхронизация Azure AD Connect: предотвращение случайного удаления | Документация Майкрософт'
description: В этом разделе описывается функция предотвращения случайного удаления в Azure AD Connect.
services: active-directory
documentationcenter: ''
author: billmath
manager: daveba
editor: ''
ms.assetid: 6b852cb4-2850-40a1-8280-8724081601f7
ms.service: active-directory
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 07/12/2017
ms.subservice: hybrid
ms.author: billmath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 16d48cda87b8226ebc3bbab179c1034abf0a486f
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "90084615"
---
# <a name="azure-ad-connect-sync-prevent-accidental-deletes"></a>Синхронизация Azure AD Connect: предотвращение случайного удаления
В этом разделе описывается функция предотвращения случайного удаления в Azure AD Connect.

При установке Azure AD Connect функция предотвращения случайного удаления включается по умолчанию с настроенным запретом экспортировать более 500 операций удаления. Эта функция защищает от случайных изменений конфигурации и изменений в локальном каталоге, которые могут повлиять на большое количество пользователей и других объектов.

## <a name="what-is-prevent-accidental-deletes"></a>Предотвращение случайного удаления
Распространенные сценарии включают следующие:

* изменения [фильтрации](how-to-connect-sync-configure-filtering.md), когда целое [подразделение](how-to-connect-sync-configure-filtering.md#organizational-unitbased-filtering) или [домен](how-to-connect-sync-configure-filtering.md#domain-based-filtering) остаются невыбранными;
* удаление всех объектов в подразделении;
* подразделение переименовывается так, что все объекты в нем становятся исключенными из области синхронизации.

Значение по умолчанию 500 можно изменить с помощью PowerShell командой `Enable-ADSyncExportDeletionThreshold`, которая входит в состав модуля AD Sync, устанавливаемого вместе с Azure Active Directory Connect. Это значение необходимо задать в соответствии с размером вашей организации. Так как планировщик синхронизации запускается каждые 30 минут, это значение равно числу операций удаления, выполненных за 30 минут.

Если в Azure AD готовится экспорт избыточного числа операций удаления, такой экспорт будет остановлен, а вы получите следующее сообщение электронной почты:

![Сообщение электронной почты "Предотвращение случайного удаления"](./media/how-to-connect-sync-feature-prevent-accidental-deletes/email.png)

> *(Контактное лицо по техническим вопросам), здравствуйте! В (время) служба синхронизации удостоверений обнаружила, что число удалений превысило указанное в настройках пороговое значение удалений для компании (название организации). В рамках этого запуска синхронизации удостоверений для удаления было отправлено всего (число) об. Это число соответствует пороговому значению удаления объектов, равному (число), или превышает его. Нам необходимо получить от вас подтверждение, что эти удаления следует обработать, прежде чем мы продолжим. Дополнительные сведения об указанной в этом сообщении ошибке см. в разделе "Предотвращение случайных удалений".*
>
> 

При поиске профиля экспорта в пользовательском интерфейсе **Synchronization Service Manager** также может отобразиться состояние `stopped-deletion-threshold-exceeded`.
![Предотвращение случайного удаления в пользовательском интерфейсе Synchronization Service Manager](./media/how-to-connect-sync-feature-prevent-accidental-deletes/syncservicemanager.png)

Если эта ситуация оказалась непредвиденной, выясните причину и выполните все действия для ее устранения. Чтобы увидеть, какие объекты должны быть удалены, выполните следующие действия.

1. Запустите **Службу синхронизации** из меню «Пуск».
2. Выберите **Соединители**.
3. Выберите соединитель типа **Azure Active Directory**.
4. В разделе **Действия** справа выберите **Пространство поиска соединителя**.
5. Во всплывающем окне в разделе **Область** выберите **Отключенные с** и укажите момент времени в прошлом. Нажмите кнопку **Поиск**. Вы получите список всех объектов, которые будут удалены. Щелкнув каждый объект, вы получите дополнительные сведения. Также можно щелкнуть **Column Setting** (Настройка столбца), чтобы добавить дополнительные атрибуты, отображаемые в сетке.

![Пространство поиска соединителя](./media/how-to-connect-sync-feature-prevent-accidental-deletes/searchcs.png)

[!NOTE] Если вы не уверены в том, что все операции удаления нужны, и хотите перейти к более безопасному маршруту. Вы можете использовать командлет PowerShell: `Enable-ADSyncExportDeletionThreshold` для установки нового порогового значения вместо отключения порогового значения, которое может привести к нежелательным удалениям. 

## <a name="if-all-deletes-are-desired"></a>Если требуется все удаления
Если удаление необходимо, сделайте следующее.

1. Чтобы получить текущее пороговое значение удаления, выполните командлет PowerShell `Get-ADSyncExportDeletionThreshold`. Укажите имя учетной записи и пароль глобального администратора Azure AD. Значение по умолчанию — 500.
2. Чтобы временно отключить защиту и выполнить удаление, запустите следующий командлет PowerShell: `Disable-ADSyncExportDeletionThreshold`. Укажите имя учетной записи и пароль глобального администратора Azure AD.
   ![На снимке экрана показано диалоговое окно ввода имени пользователя и пароля глобального администратора Azure AD.](./media/how-to-connect-sync-feature-prevent-accidental-deletes/credentials.png)
3. С выбранным соединителем Azure Active Directory укажите действие **Запустить** и затем выберите **Экспорт**.
4. Чтобы повторно включить защиту, запустите командлет PowerShell: `Enable-ADSyncExportDeletionThreshold -DeletionThreshold 500`. Замените 500 значением, которое вы записали при получении текущего порогового значения удаления. Укажите имя учетной записи и пароль глобального администратора Azure AD.

## <a name="next-steps"></a>Дальнейшие действия
**Обзорные статьи**

* [Синхронизация Azure AD Connect: общие сведений о синхронизации и ее настройка](how-to-connect-sync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](whatis-hybrid-identity.md)
