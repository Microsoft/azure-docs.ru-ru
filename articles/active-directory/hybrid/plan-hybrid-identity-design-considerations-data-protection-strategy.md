---
title: 'Проектирование гибридных удостоверений: стратегия защиты данных в Azure | Документация Майкрософт'
description: С помощью этой статьи вы сможете определить стратегию защиты данных для гибридных решений идентификации, соответствующую вашим бизнес-критериям.
documentationcenter: ''
services: active-directory
author: billmath
manager: daveba
editor: ''
ms.assetid: e76fd1f4-340a-492a-84d9-e05f3b7cc396
ms.service: active-directory
ms.devlang: na
ms.topic: conceptual
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/29/2019
ms.subservice: hybrid
ms.author: billmath
ms.custom: seohack1
ms.collection: M365-identity-device-management
ms.openlocfilehash: bac3f53def6db1038a6dd7e45d7933daa22df9f0
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "98703858"
---
# <a name="define-data-protection-strategy-for-your-hybrid-identity-solution"></a>Определение стратегии защиты данных для гибридного решения идентификации
В этой статье вы определите стратегию защиты данных для гибридных решений идентификации, которая соответствует требованиям, выработанным с помощью таких статей:

* [Определение требований к защите данных](plan-hybrid-identity-design-considerations-dataprotection-requirements.md)
* [Определение требований к управлению содержимым](plan-hybrid-identity-design-considerations-contentmgt-requirements.md)
* [Определение требований к управлению доступом](plan-hybrid-identity-design-considerations-accesscontrol-requirements.md)
* [Определение требований по реагированию на инциденты](plan-hybrid-identity-design-considerations-incident-response-requirements.md)

## <a name="define-data-protection-options"></a>Определение вариантов защиты данных
Как указано в статье [Определение требований к синхронизации каталога](plan-hybrid-identity-design-considerations-directory-sync-requirements.md), Microsoft Azure AD поддерживает синхронизацию с локальными доменными службами Active Directory (AD DS). Такая интеграция позволяет организациям использовать Azure AD для проверки учетных данных пользователей, которые обращаются к корпоративным ресурсам. Поддерживаются оба сценария хранения данных: локальный и облачный. Доступ к данным в Azure AD требует проверки подлинности пользователя через службу маркеров безопасности.

При аутентификации из маркера проверки подлинности считывается имя участника-пользователя. Затем система авторизации определяет реплицированную секцию и контейнер, которые соответствуют домену пользователя. Система авторизации определяет, имеет ли пользователь в этом сеансе право на доступ к целевому клиенту, обрабатывая информацию о существовании, состоянии активности и роли этого пользователя. Для некоторых действий (в частности, для создания пользователя и сброса пароля) создается журнал аудита, который в дальнейшем используется администратором клиента для обеспечения соответствия или при расследованиях.

Перенос данных из локального центра обработки данных в службу хранилища Azure через интернет-соединение может быть невозможен из-за большого объема данных, низкой пропускной способности канала или по другим причинам. [Служба импорта и экспорта хранилища Azure](../../import-export/storage-import-export-service.md) позволяет использовать аппаратное решение для размещения или извлечения больших объемов данных в хранилище больших двоичных объектов. Она обеспечивает пересылку жестких дисков, [зашифрованных BitLocker](/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn306081(v=ws.11)#BKMK_BL2012R2), напрямую в центр данных Azure, где операторы облака переносят эти данные в вашу учетную запись хранения. Также операторы могут сохранить данные из облака Azure на физические диски, чтобы передать их вам. Для этого годятся только зашифрованные диски (при этом используется ключ BitLocker, создаваемый службой во время установки). Этот ключ BitLocker предоставляется в Azure отдельно, и это делает возможным внеполосный совместный доступ к ключам.

Передача данных может выполняться в различных сценариях, и здесь важно помнить, что Microsoft Azure использует для изолирования трафика клиентов друг от друга [виртуальные сети](https://azure.microsoft.com/documentation/services/virtual-network/). Служба применяет такие меры, как брандмауэры на уровне узла или посетителя, фильтрацию IP-пакетов, блокировку портов и поддержку HTTPS на конечных точках. Впрочем, шифруется и значительная часть внутренних коммуникаций Azure, в том числе передача данных между инфраструктурами и от инфраструктуры к клиенту (к локальному расположению). Еще один важный сценарий — передача данных внутри центров обработки данных Azure. Сети корпорации Майкрософт организованы так, что ни одна виртуальная машина не может олицетворять или подслушивать чужой IP-адрес. При доступе к службе хранилища Azure или к базам данных SQL, а также при подключении к облачным службам используется протокол TLS/SSL. В этом случае администратор клиента обязан получить сертификат TLS/SSL и развернуть его в клиентской инфраструктуре. Перемещение данных через виртуальную сеть Microsoft Azure между виртуальными машинами в одном развертывании или между клиентами в одном развертывании можно защитить протоколом шифрования соединений, например HTTPS, SSL/TLS или любым другим.

Теперь на основании ваших ответов на вопросы в статье об [определении требований к защите данных](plan-hybrid-identity-design-considerations-dataprotection-requirements.md) вы можете выбрать подходящий способ защиты и определить, чем вам может помочь гибридное решение для идентификации. В следующей таблице представлены варианты, которые Azure поддерживает для каждого сценария защиты данных:

| Варианты защиты данных | При хранении в облаке | При локальном хранении | В пути |
| --- | --- | --- | --- |
| Шифрование диска BitLocker |X |X | |
| Шифрование баз данных на сервере SQL Server |X |X | |
| Шифрование трафика между виртуальными машинами | | |X |
| SSL/TLS; | | |X |
| VPN | | |X |

> [!NOTE]
> Ознакомьтесь со статьей [Соответствие продуктов требованиям](https://azure.microsoft.com/support/trust-center/services/) в [центре управления безопасностью Microsoft Azure](https://azure.microsoft.com/support/trust-center/), которая расскажет о том, каким сертификатам соответствует каждая служба Azure.
> Указанные варианты защиты данных подразумевают многоуровневый подход, поэтому их сравнение в рамках этой статьи невозможно. Постарайтесь использовать все доступные возможности для каждого состояния данных.
>
>

## <a name="define-content-management-options"></a>Определение параметров управления содержимым

Использование Azure AD для управления гибридной инфраструктурой идентификации имеет важное преимущество: полностью прозрачный для конечного пользователя процесс. Пользователь обращается к общему ресурсу, ресурс подает запрос на аутентификацию, пользователь отправляет в Azure AD запрос на аутентификацию и получает маркер, предоставляющий доступ к ресурсу. Весь процесс происходит в фоновом режиме, без прямого участия пользователя. 

Организации, которые уделяют внимание конфиденциальности данных, обычно выбирают решения, которые позволяют классифицировать данные. Если в локальной инфраструктуре уже применяется классификация данных, вы можете использовать Azure AD как основной репозиторий учетных данных пользователей. Для классификации данных в локальных службах широко используется [набор средств классификации данных](/previous-versions/tn-archive/hh204743(v=technet.10)) , который входит в состав Windows Server 2012 R2. Этот набор помогает идентифицировать, классифицировать и защищать данные на файловых серверах частного облака. Кроме того, для этих целей можно применять [автоматическую классификацию файлов](/windows-server/identity/solution-guides/deploy-automatic-file-classification--demonstration-steps-) Windows Server 2012.

Если в вашей организации не используется классификация данных, но есть необходимость защищать конфиденциальные файлы, не добавляя новые локальные серверы, то можно использовать [службу Microsoft Azure Rights Management](/azure/information-protection/what-is-azure-rms).  Эта служба использует для защиты файлов и электронной почты шифрование, удостоверения и политики авторизации. Она может работать на различных устройствах — телефонах, планшетных и настольных компьютерах. Служба управления правами Azure является облачной службой, поэтому для использования защищенных данных совместно с другими организациями не нужно отдельно настраивать отношения доверия. Если у них уже есть Microsoft 365 или каталог Azure AD, совместная работа между организациями будет автоматически поддерживаться. Вы также можете синхронизировать только те атрибуты каталога, которые Azure RMS должны поддерживать общее удостоверение для локальных учетных записей Active Directory, используя службы синхронизации Azure Active Directory (Azure AD Sync) или Azure AD Connect.

Для управления содержимым важно хорошо понимать, кто обращается к каким ресурсам, поэтому в хорошем решении по управлению идентификацией следует создать широкие возможности для ведения журналов. Azure AD поддерживает журналы за 30 дней, в которых сохраняются:

* изменения членства в ролях (например, добавление пользователя в роль глобального администратора);
* изменение учетных данных (например, изменение пароля);
* управление доменами (например, проверка пользовательского домена или удаление домена);
* добавление и удаление приложений;
* управление пользователями (например, добавление, удаление или обновление пользователя);
* добавление и удаление лицензий.

> [!NOTE]
> Дополнительные сведения о возможности ведения журналов в Azure вы найдете в документе [Управление журналами безопасности и аудита Microsoft Azure](https://download.microsoft.com/download/B/6/C/B6C0A98B-D34A-417C-826E-3EA28CDFC9DD/AzureSecurityandAuditLogManagement_11132014.pdf) .
> Теперь на основании ваших ответов на вопросы раздела [Определения требований к управлению содержимым](plan-hybrid-identity-design-considerations-contentmgt-requirements.md)вы можете выбрать подходящий способ управления содержимым в гибридном решении идентификации. Azure AD может интегрироваться с любым вариантом, который представлен в таблице 6, но вам важно выбрать наиболее подходящий для целей вашего бизнеса.
>
>

| Варианты управления содержимым | Преимущества | Недостатки |
| --- | --- | --- |
| Централизованное локальное управление (сервер управления правами Active Directory) |Полный контроль над серверной инфраструктурой, отвечающей за классификацию данных. <br> Встроенная возможность в Windows Server, не требующая дополнительных лицензий или подписок. <br> Возможность интеграции с Azure AD в гибридном сценарии. <br> Поддерживает возможности управления правами на доступ к данным (IRM) в службах Microsoft Online Services, таких как Exchange Online и SharePoint Online, а также Microsoft 365 <br> Поддерживает локальные серверные продукты корпорации Майкрософт, например Exchange Server, SharePoint Server и файловые серверы под управлением Windows Server с инфраструктурой классификации файлов (FCI). |Повышенные потребности в обслуживании (отслеживание обновлений, настройка и изменение конфигурации), так как за сервер отвечает ИТ-служба. <br> Требует локальной серверной инфраструктуры.<br> Нет встроенной поддержки возможностей Azure. |
| Централизованное управление в облаке (Azure RMS) |Упрощенное управление по сравнению с локальным решением. <br> Возможность интеграции с AD DS в гибридном сценарии. <br>  Полная интеграция с Azure AD. <br> Не требует локальной серверной инфраструктуры для развертывания службы. <br> Поддерживает локальные серверные продукты корпорации Майкрософт, например Exchange Server, SharePoint Server и файловые серверы под управлением Windows Server с инфраструктурой классификации файлов (FCI). <br> ИТ-служба полностью контролирует клиентские ключи, поддерживается сценарий BYOK. |У организации должна быть облачная подписка с поддержкой RMS. <br> У организации должен быть каталог Azure AD, чтобы организовать аутентификацию пользователя для RMS. |
| Гибридное управление (служба Azure RMS, интегрированная с локальным сервером Active Directory Rights Management) |Этот сценарий объединяет преимущества обоих предыдущих: централизованное локальное управление и централизованное управление в облаке. |У организации должна быть облачная подписка с поддержкой RMS. <br> У организации должен быть каталог Azure AD, чтобы организовать аутентификацию пользователя для RMS. <br> Требует наличия связи между облачной службой Azure и локальной инфраструктурой. |

## <a name="define-access-control-options"></a>Определение параметров управления доступом
Возможности аутентификации, авторизации и управления доступом, которые предоставляет Azure AD, позволят вашей организации использовать центральный репозиторий идентификации и предоставить единый вход для пользователей и партнеров, как показано на этой схеме.

![централизованное управление](./media/plan-hybrid-identity-design-considerations/centralized-management.png)

Централизованное управление и полная интеграция с другими каталогами

Azure Active Directory предоставляет единый вход для тысяч приложений SaaS и локальных веб-приложений. В статье [Список совместимости с федерацией Azure Active Directory: использование сторонних поставщиков удостоверений для реализации единого входа](how-to-connect-fed-compatibility.md) вы найдете сведения о сторонних приложениях, для которых корпорация Майкрософт уже проверила возможность единого входа. Эта возможность позволяет организации реализовать различные сценарии «бизнес-бизнес», сохраняя контроль над управлением идентификацией и доступом. При разработке решения B2B важно выяснить, какой метод аутентификации использует ваш партнер, и проверить поддержку этого метода Azure. В настоящее время Azure AD поддерживает следующие методы:

* Security Assertion Markup Language (SAML)
* OAuth
* Kerberos
* Токены
* Сертификаты

> [!NOTE]
> Каждый их этих протоколов и возможности их применения в Azure описаны в статье [Протоколы аутентификации Azure Active Directory](/previous-versions/azure/dn151124(v=azure.100)) .
>
>

При поддержке Azure AD мобильные бизнес-приложения могут предоставлять такие же простые возможности аутентификации мобильных служб. Это позволяет сотрудникам входить в мобильные приложения, используя корпоративные учетные данные Active Directory. Эта функция позволяет зарегистрировать Azure AD в качестве поставщика удостоверений в мобильных службах наряду с другими поддерживаемыми поставщиками удостоверений (в том числе учетные записи Майкрософт и идентификаторы пользователей Facebook, Google и Twitter). Если в локальном приложении используются учетные данные пользователей, размещенные в корпоративной доменной службе Active Directory, доступ для партнеров и пользователей в облаке должен быть прозрачным. Вы можете управлять условным доступом пользователя к веб-приложениям (в облаке), веб-API, облачным службам Майкрософт, сторонним приложениям SaaS и собственным (мобильным) клиентским приложениям, а также иметь преимущества безопасности, аудита и создания отчетов в одном месте. Но мы рекомендуем сначала проверить такие решения в тестовой среде или с ограниченным количеством пользователей.

> [!TIP]
> Важно отметить, что Azure AD, в отличие от AD DS, не поддерживает групповые политики. Чтобы применить политику к устройствам, вам потребуется отдельное решение для управления мобильными устройствами, например [Microsoft Intune](/mem/intune/).
>
>

После аутентификации пользователя в Azure AD важно оценить предоставленный ему уровень доступа. Пользователь может иметь разные уровни доступа к ресурсу. Служба Azure AD повышает уровень защиты, контролируя доступ к некоторым ресурсам. Но не забывайте, что ресурс может иметь собственный список управления доступом, например список контроля доступа к файлам на файловом сервере. На следующей схеме представлены уровни управления доступом, которые можно использовать в гибридном сценарии:

![Управление доступом](./media/plan-hybrid-identity-design-considerations/accesscontrol.png)

Каждое взаимодействие, отображенное в схеме на рисунке X, представляет собой один сценарий контроля доступом, который может выполнять служба Azure AD. Ниже мы приводим описание каждого сценария:

1. Условный доступ к приложениям, размещенным локально. Для зарегистрированных устройств можно применять политики доступа к приложениям, настройки которых позволяют использовать службы федерации Active Directory в Windows Server 2012 R2.

2. Управление доступом к портал Azure. Azure также позволяет управлять доступом к порталу с помощью управления доступом на основе ролей Azure (Azure RBAC). Организация может использовать этот метод, чтобы ограничить число операций, которые пользователь может выполнить на портале Azure. С помощью Azure RBAC для управления доступом к порталу ИТ администраторы могут делегировать доступ с помощью следующих подходов к управлению доступом:

   - Назначение ролей на основе групп: доступ можно предоставлять группам Azure AD, которые синхронизируются с локальной службой Active Directory. Это позволяет эффективно применить средства и процессы, которые уже созданы в организации для управления группами. Можно также использовать функцию делегирования управления группой, которая есть в Azure AD Premium.
   - Использование встроенных ролей Azure. Вы можете использовать три готовые роли (владельца, участника и читателя), чтобы предоставить пользователям и группам права на выполнение только тех задач, которые касаются работы.
   -  Детальный доступ к ресурсам. Можно назначить роли пользователям и группам для конкретной подписки, группы ресурсов или отдельного ресурса Azure, например веб-сайта или базы данных. Это позволит гарантировать, что пользователи имеют доступ ко всем нужным ресурсам и не имеют доступа к тем ресурсам, которыми не должны управлять.

   > [!NOTE]
   > Разработчики, которые создают приложения и желают настроить для них управление доступом, могут использовать роли приложений Azure AD для авторизации. Изучите этот [пример WebApp-RoleClaims-DotNet](https://github.com/AzureADSamples/WebApp-RoleClaims-DotNet) , который демонстрирует, как создать приложение с такой функцией.


3. Условный доступ для Microsoft 365 приложений с Microsoft Intune: ИТ администраторы могут подготавливать политики условного доступа для защиты корпоративных ресурсов, в то же время позволяя информационным работникам на соответствующих устройствах получать доступ к службам. 
  
4. Условный доступ для приложений SaaS. [Эта функция](https://cloudblogs.microsoft.com/enterprisemobility/2015/06/25/azure-ad-conditional-access-preview-update-more-apps-and-blocking-access-for-users-not-at-work/) позволяет настроить правила доступа с многофакторной аутентификацией каждого приложения и блокировать доступ пользователей из сетей, не входящих в список доверенных. Правила многофакторной проверки подлинности могут применяться для всех пользователей, назначенных приложению, или только для пользователей в указанных группах безопасности. Пользователи могут быть исключены из требования многофакторной проверки подлинности, если они получают доступ к приложению с IP-адреса в сети организации.

Указанные варианты контроля доступа подразумевают многоуровневый подход, поэтому их сравнение в рамках этой статьи невозможно. Постарайтесь использовать все возможные варианты для каждого сценария, в котором требуется контроль доступа к ресурсам.

## <a name="define-incident-response-options"></a>Определение вариантов реагирования на инциденты
Azure AD помогает ИТ-специалистам выявить в среде потенциальные угрозы безопасности, контролируя действия пользователей. Отчеты Azure Active Directory об использовании и получении доступа помогут оценить целостность и защищенность каталога данных в вашей организации. C помощью этой информации ИТ-администратор может более точно определить источники рисков безопасности и принять соответствующие меры для их смягчения.  [Подписка Azure AD Premium](../fundamentals/active-directory-get-started-premium.md) включает несколько отчетов о безопасности, которые позволят получить такие сведения. [Отчеты Azure AD](../reports-monitoring/overview-reports.md) делятся на следующие категории:

* **Отчеты об аномалиях** содержат сведения о событиях входа, которые мы считаем необычными. Мы информируем вас о таких событиях и позволяем самостоятельно определять, является ли то или иное событие подозрительным.
* **Отчеты о встроенных приложениях** предоставляют информацию о том, как ваша организация использует облачные приложения. Azure Active Directory обеспечивает интеграцию с множеством облачных приложений.
* **Отчеты об ошибках** демонстрируют ошибки, которые возникают при подготовке учетных записей для внешних приложений.
* **Пользовательские отчеты**— это отчеты, которые предоставляют данные об использование устройства или случаях входа для конкретного пользователя.
* **Журналы действий** содержат записи обо всех событиях аудита за последние 24 часа, 7 дней или 30 дней, а также записи об изменениях в составе групп, событиях сброса пароля и регистрации.

> [!TIP]
> Еще один отчет может помочь в расследовании инцидентов. Это отчет о [пользователях с утечкой учетных данных](https://cloudblogs.microsoft.com/enterprisemobility/2015/06/15/azure-active-directory-premium-reporting-now-detects-leaked-credentials/). Этот отчет выявит любые совпадения между списком пользователей с утечкой учетных данных и вашими клиентами.
>


При расследовании инцидентов можно использовать еще несколько важных отчетов, встроенных в Azure AD:

* Отчет **Действия по сбросу пароля** дает администратору информацию о том, как используется в организации функция сброса паролей.
* Отчет **Действия по регистрации методов сброса пароля** предоставляет информацию о том, какие пользователи указали методы сброса пароля и какие именно методы они выбрали.
* Отчет **Действия с группами** содержит журнал изменений в составе групп (например, добавление или удаление пользователей), выполненных через панель доступа.

Помимо базовых возможностей Azure AD Premium по созданию отчетов, которые вы можете использовать при расследовании инцидентов, для ИТ-служб предоставляется отчет аудита со следующими сведениями:

* изменения членства в ролях (например, добавление пользователя в роль глобального администратора);
* изменение учетных данных (например, изменение пароля);
* управление доменами (например, проверка пользовательского домена или удаление домена);
* добавление и удаление приложений;
* управление пользователями (например, добавление, удаление или обновление пользователя);
* добавление и удаление лицензий.

Любое реагирование на инциденты подразумевает многоуровневый подход, поэтому сравнение вариантов выходит далеко за пределы этой статьи. Постарайтесь использовать все возможные варианты для каждого сценария, в котором корпоративная политика реагирования на инциденты требует использовать возможности Azure AD по созданию отчетов.

## <a name="next-steps"></a>Дальнейшие действия
[Определение задач управления гибридной идентификацией](plan-hybrid-identity-design-considerations-hybrid-id-management-tasks.md)

## <a name="see-also"></a>См. также:
[Обзор рекомендаций по проектированию](plan-hybrid-identity-design-considerations-overview.md)