---
title: 'Azure AD Connect: выражения декларативной подготовки | Документация Майкрософт'
description: Описание выражений декларативной подготовки.
services: active-directory
documentationcenter: ''
author: billmath
manager: daveba
editor: ''
ms.assetid: e3ea53c8-3801-4acf-a297-0fb9bb1bf11d
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 07/18/2017
ms.subservice: hybrid
ms.author: billmath
ms.collection: M365-identity-device-management
ms.openlocfilehash: 02490839a9e35695ae2e8b3f750e139ad7413aa4
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "89280219"
---
# <a name="azure-ad-connect-sync-understanding-declarative-provisioning-expressions"></a>Служба синхронизации Azure AD Connect: общие сведения о выражениях декларативной подготовки
Служба синхронизации Azure AD Connect основана на принципах декларативной подготовки, впервые представленной в Forefront Identity Manager 2010. Эта функция позволяет реализовать бизнес-логику интеграции идентификации без необходимости написания компилируемого кода.

Важной частью декларативной подготовки является язык выражений, используемый в потоке атрибутов. Это подмножество Microsoft® Visual Basic® для приложений (VBA). Этот язык используется в Microsoft Office и знаком пользователи, имеющим опыт работы с VBScript. Язык выражений декларативной подготовки не структурированный и использует только функции, но не методы или инструкции. Вместо этого функции вложены в поток программы.

Подробнее об этом см. в статье [Справочник по языку Office VBA](/office/vba/api/overview/language-reference).

Атрибуты являются строго типизированными. Функция принимает только атрибуты правильного типа. Регистр символов также учитывается. Имена функций и атрибутов должны указываться с учетом регистра, иначе произойдет ошибка.

## <a name="language-definitions-and-identifiers"></a>Определения и идентификаторы языка
* У функции есть имя, за которым следует список аргументов в скобках: имя_функции(аргумент 1, аргумент N).
* Атрибуты заключаются в квадратные скобки: [имя_атрибута].
* Параметры задаются знаком процента: %имя_параметра%.
* Строковые константы заключаются в кавычки, например "Contoso" (обратите внимание, что необходимо использовать прямые (""), а не парные (“”) кавычки).
* Числовые значения приводятся без кавычек; они считаются десятичными. Шестнадцатеричные значения должны иметь префикс &H. Например, 98052, &HFF.
* Логические значения выражаются константами True и False.
* Встроенные константы и литералы выражаются только своим именем: NULL, CRLF, IgnoreThisFlow.

### <a name="functions"></a>Функции
Декларативная подготовка использует множество функций для преобразования значений атрибутов. Эти функции могут быть вложенными, так что результат из одной функции передается в другую функцию.

`Function1(Function2(Function3()))`

Полный список функций можно найти в [справочнике по функциям](reference-connect-sync-functions-reference.md).

### <a name="parameters"></a>Параметры
Параметр задается соединителем или администратором с помощью PowerShell. Обычно параметры содержат значения, которые отличаются в разных системах, например имя домена, в котором находится пользователь. Эти параметры могут использоваться в потоках атрибутов.

Соединитель Active Directory предоставляет следующие параметры для входящих правил синхронизации.

| имени параметра | Комментировать |
| --- | --- |
| Domain.Netbios |Формат NetBIOS импортируемого домена, например FABRIKAMSALES |
| Domain.FQDN |Формат FQDN импортируемого домена, например sales.fabrikam.com |
| Domain.LDAP |Формат LDAP импортируемого домена, например DC=sales,DC=fabrikam,DC=com |
| Forest.Netbios |Формат NetBIOS импортируемого имени леса, например FABRIKAMCORP |
| Forest.FQDN |Формат FQDN импортируемого имени леса, например fabrikam.com |
| Forest.LDAP |Формат LDAP импортируемого имени леса, например DC=fabrikam,DC=com |

Система предоставляет следующий параметр, который используется для получения идентификатора запущенного соединителя:  
`Connector.ID`

Ниже приведен пример, где атрибут метавселенной domain заполнен NetBIOS-именем домена, в котором расположен пользователь.  
`domain` <- `%Domain.Netbios%`

### <a name="operators"></a>Операторы
Могут использоваться следующие операторы.

* **Сравнение**: <, <=, <>, =, >, >=
* **Математические**: +, -, \*, -
* **Строковые**: & (сцепление)
* **Логические**: && (и), || (или)
* **Порядок вычисления**: ( )

Операторы выполняются в порядке слева направо и имеют одинаковый приоритет вычисления. Это значит, что умножение (\*) не вычисляется до вычитания (–). 2\*(5+3) не равно 2\*5+3. Скобки () используются, чтобы изменить порядок вычислений, когда порядок вычислений слева направо не подходит.

## <a name="multi-valued-attributes"></a>Многозначные атрибуты
Функции могут работать с однозначными и многозначными атрибутами. Для многозначных атрибутов функция работает с каждым отдельным значением и применяет одну и ту же функцию к каждому отдельному значению.

Например:  
`Trim([proxyAddresses])` выполняет обрезку (Trim) для каждого значения атрибута proxyAddress.  
`Word([proxyAddresses],1,"@") & "@contoso.com"` Для каждого значения со знаком @-sign замените домен @contoso.com.  
`IIF(InStr([proxyAddresses],"SIP:")=1,NULL,[proxyAddresses])` Найдите SIP-адрес и удалите его из значений.

## <a name="next-steps"></a>Дальнейшие действия
* Дополнительные сведения о модели конфигурации, см. в статье о [принципах декларативной подготовки](concept-azure-ad-connect-sync-declarative-provisioning.md).
* Примеры стандартного использования декларативной подготовки см. в статье [Службы синхронизации Azure AD Connect: рекомендации по изменению конфигурации по умолчанию](concept-azure-ad-connect-sync-default-configuration.md).
* Инструкции по практическим изменениям с помощью декларативной подготовки см. в статье [Службы синхронизации Azure AD Connect: изменение конфигурации по умолчанию](how-to-connect-sync-change-the-configuration.md).

**Обзорные статьи**

* [Синхронизация Azure AD Connect: общие сведений о синхронизации и ее настройка](how-to-connect-sync-whatis.md)
* [Интеграция локальных удостоверений с Azure Active Directory](whatis-hybrid-identity.md)

**Справочные материалы**

* [Синхронизация Azure AD Connect: справочник по функциям](reference-connect-sync-functions-reference.md)