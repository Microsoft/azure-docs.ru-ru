---
title: Предотвращение атак с помощью интеллектуальной блокировки Azure Active Directory
description: Узнайте, как Azure Active Directory Smart-блокировка помогает защитить организацию от атак методом подбора, которые пытаются угадать пароли пользователей.
services: active-directory
ms.service: active-directory
ms.subservice: authentication
ms.topic: how-to
ms.date: 07/20/2020
ms.author: justinha
author: justinha
manager: daveba
ms.reviewer: rogoya
ms.collection: M365-identity-device-management
ms.openlocfilehash: a5f501c19da3c2ddc06ad89fe5649789477af7ec
ms.sourcegitcommit: d49bd223e44ade094264b4c58f7192a57729bada
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/02/2021
ms.locfileid: "99255379"
---
# <a name="protect-user-accounts-from-attacks-with-azure-active-directory-smart-lockout"></a>Защита учетных записей пользователей от атак с помощью Azure Active Directory Smart-блокировки

Смарт-Блокировка позволяет блокировать неправильные субъекты, которые пытаются угадать пароли пользователей или использовать методы подбора для получения. Смарт-блокировка может распознавать входы, полученные от действительных пользователей, и обрабатывать их иначе, чем злоумышленники и другие неизвестные источники. Злоумышленники блокируются, а пользователи продолжают получать доступ к своим учетным записям и работать эффективно.

## <a name="how-smart-lockout-works"></a>Как работает интеллектуальная блокировка

По умолчанию после 10 неудачных попыток смарт-блокировка блокирует учетную запись от попыток входа в систему на одну минуту. Учетная запись повторно блокируется после каждой последующей неудачной попытки входа (сначала доступ отсутствует одну минуту, а при последующих попытках — дольше). Чтобы максимально ограничить способы, с помощью которых злоумышленник может работать с этим поведением, мы не раскрываем скорость, с которой будет расти период блокировки по сравнению с дополнительными неудачными попытками входа.

Смарт-блокировка отслеживает хэши последних трех попыток неправильного ввода пароля во избежание повторного увеличения счетчика блокировки для того же пароля. Если пользователь введет один и тот же неправильный пароль несколько раз, это не приведет к блокировке учетной записи.

> [!NOTE]
> Функция отслеживания хэша недоступна для клиентов с включенной сквозной проверкой подлинности, так как аутентификация выполняется локально, а не в облаке.

Федеративные развертывания, использующие AD FS 2016 и AF FS 2019, могут обеспечить аналогичные преимущества с помощью [AD FS блокировки экстрасети и Smart-блокировки экстрасети](/windows-server/identity/ad-fs/operations/configure-ad-fs-extranet-smart-lockout-protection).

Интеллектуальная блокировка всегда включена для всех клиентов Azure AD, и эти параметры по умолчанию обеспечивают правильную защиту и удобство использования. Для настройки параметров смарт-блокировки со значениями, характерными для вашей организации, требуется Azure AD Premium P1 или более высокие лицензии для пользователей.

Использование интеллектуальной блокировки не гарантирует, что подлинное пользователь никогда не будет заблокирован. Если смарт-Блокировка блокирует учетную запись пользователя, мы пытаемся не блокировать подлинную версию пользователя. Служба блокировки попытается убедиться, что неверные субъекты не могут получить доступ к подлинной учетной записи пользователя. Действительны следующие условия.

* Каждый центр обработки данных Azure AD отслеживает блокировку независимо друг от друга. Пользователь имеет (*threshold_limit * datacenter_count*) число попыток, если пользователь обращается к каждому центру обработки данных.
* Смарт-блокировка различает злоумышленников и подлинных пользователей по расположению (неизвестное и известное). Незнакомые и привычные расположения имеют отдельные счетчики блокировки.

Интеллектуальная блокировка может интегрироваться с гибридными развертываниями, которые используют синхронизацию хэша паролей или сквозную проверку подлинности для защиты локальных учетных записей домен Active Directory служб (AD DS) от злоумышленников. Настроив политики интеллектуальной блокировки в Azure AD соответствующим образом, можно отфильтровать атаки, прежде чем они будут доступны в локальной AD DS.

При использовании [сквозной проверки подлинности](../hybrid/how-to-connect-pta.md)применяются следующие соображения.

* Пороговое значение блокировки Azure AD **меньше** порогового значения блокировки учетной записи AD DS. Задайте значения, чтобы AD DS порог блокировки учетной записи не менее двух или трех раз дольше порогового значения блокировки Azure AD.
* Длительность блокировки Azure AD должна быть задана дольше, чем счетчик блокировки AD DS сброса учетной записи после длительности. Длительность Azure AD задается в секундах, а длительность рекламы задается в минутах.

Например, если вы хотите, чтобы значение счетчика Azure AD было выше AD DS, Azure AD будет 120 секунд (2 минуты), а локальное AD — 1 минута (60 секунд).

> [!IMPORTANT]
> В настоящее время администратор не может разблокировать облачные учетные записи пользователей, если они были заблокированы с помощью функции смарт-блокировки. Администраторы должны подождать, пока не завершится срок действия блокировки. Тем не менее пользователь может разблокировать с помощью самостоятельного сброса пароля (SSPR) из доверенного устройства или расположения.

## <a name="verify-on-premises-account-lockout-policy"></a>Проверка локальных политик блокировки учетных записей

Чтобы проверить локальную AD DS политики блокировки учетных записей, выполните следующие действия из системы, присоединенной к домену, с правами администратора:

1. Откройте средства управления групповыми политиками.
2. Измените групповую политику, включающую политику блокировки учетной записи организации, например **политику домена по умолчанию**.
3. Перейдите к параметрам **конфигурации компьютера**  >  **политики**  >  **Windows параметры**  >  **безопасности** политики  >  **учетных** записей  >  **Политика блокировки учетной записи**.
4. Проверьте **порог блокировки учетной записи** и **сбросьте счетчик блокировки учетной записи после** значений.

![Изменение политики блокировки локальной учетной записи Active Directory](./media/howto-password-smart-lockout/active-directory-on-premises-account-lockout-policy.png)

## <a name="manage-azure-ad-smart-lockout-values"></a>Управление значениями смарт-блокировки Azure AD

В зависимости от требований организации можно настроить значения смарт-блокировки Azure AD. Для настройки параметров смарт-блокировки со значениями, характерными для вашей организации, требуется Azure AD Premium P1 или более высокие лицензии для пользователей.

Чтобы проверить или изменить значения смарт-блокировки для вашей организации, выполните следующие действия.

1. Войдите на [портал Azure](https://portal.azure.com).
1. Найдите и выберите *Azure Active Directory*, а затем выберите   >  **методы проверки подлинности** безопасности  >  **пароль защита пароля**.
1. В зависимости от того, сколько попыток неудачного входа разрешено до первой блокировки учетной записи, установите **пороговое значение блокировки**.

    Значение по умолчанию равно 10.

1. Чтобы указать время для каждой блокировки (в секундах), установите параметр **Длительность блокировки в секундах**.

    Значение по умолчанию — 60 секунд (одна минута).

> [!NOTE]
> Если первый вход после блокировки завершится ошибкой, учетная запись будет снова заблокирована. Если учетная запись будет заблокирована несколько раз, продолжительность блокировки увеличится.

![Настройка политики смарт-блокировки Azure AD на портале Azure](./media/howto-password-smart-lockout/azure-active-directory-custom-smart-lockout-policy.png)

## <a name="how-to-determine-if-the-smart-lockout-feature-is-working-or-not"></a>Как определить, работает ли функция смарт-блокировки

При активации порога Smart-блокировки при блокировке учетной записи будет получено следующее сообщение:

*Ваша учетная запись временно заблокирована, чтобы предотвратить несанкционированное использование. Повторите попытку позже. Если у вас по-прежнему возникают проблемы, обратитесь к администратору.*

При тестировании смарт-блокировки запросы на вход могут обрабатываться различными центрами обработки данных в связи с геораспределенной нагрузкой и характером балансировки нагрузки службы проверки подлинности Azure AD. В этом сценарии, поскольку каждый центр обработки данных Azure AD отслеживает блокировку независимо друг от друга, может потребоваться больше, чем заданное пороговое значение блокировки число попыток, вызывающих блокировку. Пользователь имеет (*threshold_limit * datacenter_count*) число неудачных попыток, если пользователь обращается к каждому центру обработки данных до возникновения блокировки.

## <a name="next-steps"></a>Дальнейшие действия

Для дальнейшей настройки интерфейса можно [настроить настраиваемые пароли для защиты паролей Azure AD](tutorial-configure-custom-password-protection.md).

Чтобы помочь пользователям сбросить или изменить пароль из веб-браузера, можно [настроить самостоятельный сброс пароля в Azure AD](tutorial-enable-sspr.md).
