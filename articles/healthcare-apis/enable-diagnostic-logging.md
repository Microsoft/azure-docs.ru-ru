---
title: Включение ведения журнала диагностики в Azure API для FHIR
description: В этой статье объясняется, как включить ведение журнала диагностики в Azure API для FHIR®
services: healthcare-apis
ms.service: healthcare-apis
ms.subservice: fhir
ms.topic: conceptual
ms.reviewer: dseven
ms.author: cavoeg
author: CaitlinV39
ms.date: 02/03/2021
ms.openlocfilehash: 220618f93d23ec71ee3246e8bd68bfd724860696
ms.sourcegitcommit: e559daa1f7115d703bfa1b87da1cf267bf6ae9e8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "100581965"
---
# <a name="enable-diagnostic-logging-in-azure-api-for-fhir"></a>Включение ведения журнала диагностики в Azure API для FHIR

В этой статье вы узнаете, как включить ведение журнала диагностики в Azure API для FHIR и получить возможность просматривать примеры запросов для этих журналов. Доступ к журналам диагностики важен для любой службы здравоохранения, где соответствие нормативным требованиям (например, HIPAA) является обязательным. Функция в API Azure для FHIR, которая включает журналы диагностики, — это [**параметры диагностики**](../azure-monitor/essentials/diagnostic-settings.md) в портал Azure. 

## <a name="enable-audit-logs"></a>Включить журналы аудита
1. Чтобы включить ведение журнала диагностики в Azure API для FHIR, выберите службу API Azure для службы FHIR в портал Azure 
2. Выберите параметры диагностики **параметры диагностики**  
 ![](media/diagnostic-logging/diagnostic-settings-screen.png) 

3. Выберите **+ Добавить параметр диагностики**

4. Введите имя параметра

5. Выберите метод, который вы хотите использовать для доступа к журналам диагностики:

    1. **Архивация в учетную запись хранения** для аудита или проверки вручную. Учетная запись хранения, которую вы хотите использовать, должна быть уже создана.
    2. **Поток в концентратор событий** для приема от сторонней службы или пользовательского аналитического решения. Прежде чем можно будет настроить этот шаг, необходимо создать пространство имен концентратора событий и политику концентратора событий.
    3. **Поток** в рабочую область Log Analytics в Azure Monitor. Чтобы выбрать этот параметр, необходимо создать рабочую область журналы Analytics.

6. Выберите **AuditLogs** и (или) **аллметрикс**. Метрики включают имя службы, доступность, размер данных, общую задержку, общее количество запросов, общее число ошибок и отметку времени.

   :::image type="content" source="media/diagnostic-logging/fhir-diagnostic-setting.png" alt-text="Параметры диагностики Azure FHIR. Выберите AuditLogs и (или) Аллметрикс." lightbox="media/diagnostic-logging/fhir-diagnostic-setting.png":::

7. Нажмите кнопку **Сохранить**.


> [!Note] 
> Для отображения первых журналов в Log Analytics может потребоваться до 15 минут.  
 
Дополнительные сведения о работе с журналами диагностики см. в [документации по журналу ресурсов Azure](../azure-monitor/essentials/platform-logs-overview.md) .

## <a name="audit-log-details"></a>Сведения о журнале аудита
В настоящее время API Azure для службы FHIR возвращает следующие поля в журнале аудита: 

|Имя поля  |Type  |Примечания  |
|---------|---------|---------|
|каллеридентити|Динамический|Контейнер универсальных свойств, содержащий сведения об удостоверении
|каллеридентитиссуер|Строка|Издатель 
|каллеридентитйобжектид|Строка|Object_Id 
|каллерипаддресс|Строка|IP-адрес вызывающего 
|CorrelationId|Строка| Идентификатор корреляции
|фхирресаурцетипе|Строка|Тип ресурса, для которого была выполнена операция
|логкатегори|Строка|Категория журнала (в настоящее время возвращается "AuditLogs" Логкатегори)
|Расположение|Строка|Расположение сервера, который обработал запрос (например, Юго-Центральный регион США)
|оператиондуратион|Int|Время, затраченное на выполнение этого запроса в секундах
|OperationName|Строка| Описывает тип операции (например, обновление, тип поиска).
|RequestUri|Строка|URI запроса 
|ResultType|Строка|Доступные значения в настоящее время **запущены**, **успешно** или **не пройдены**
|StatusCode|Int|Код состояния HTTP. (например, 200) 
|TimeGenerated|Дата и время|Дата и время события|
|Свойства|Строка| Описание свойств Фхирресаурцетипе
|SourceSystem|Строка| Исходная система (в этом случае всегда используется Azure)
|TenantId|Строка|Tenant ID
|Тип|Строка|Тип журнала (всегда Микрософсеалскареаписаудитлог в этом случае)
|_ResourceId|Строка|Сведения о ресурсе

## <a name="sample-queries"></a>Примеры запросов

Ниже приведено несколько базовых Application Insights запросов, которые можно использовать для просмотра данных журнала.

Выполните этот запрос, чтобы просмотреть **100 последних** журналов:

```Application Insights
MicrosoftHealthcareApisAuditLogs
| limit 100
```

Выполните этот запрос, чтобы сгруппировать операции по **типу ресурса FHIR**:

```Application Insights
MicrosoftHealthcareApisAuditLogs 
| summarize count() by FhirResourceType
```

Выполните этот запрос, чтобы получить все **Невыполненные результаты** .

```Application Insights
MicrosoftHealthcareApisAuditLogs 
| where ResultType == "Failed" 
```

## <a name="conclusion"></a>Заключение 
Доступ к журналам диагностики необходим для мониторинга службы и предоставления отчетов о соответствии. API Azure для FHIR позволяет выполнять эти действия с помощью журналов диагностики. 
 
FHIR — это зарегистрированная торговая марка организации HL7, которая используется с разрешения HL7.

## <a name="next-steps"></a>Дальнейшие шаги
В этой статье вы узнали, как включить журналы аудита для Azure API для FHIR. Далее вы узнаете о других дополнительных параметрах, которые можно настроить в API Azure для FHIR.
 
>[!div class="nextstepaction"]
>[Дополнительные параметры](azure-api-for-fhir-additional-settings.md)
