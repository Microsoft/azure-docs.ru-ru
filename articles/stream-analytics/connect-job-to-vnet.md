---
title: Подключение заданий Stream Analytics к ресурсам в виртуальной сети Azure
description: В этой статье описывается, как подключить задание Azure Stream Analytics с ресурсами, которые находятся в виртуальной сети.
author: sidramadoss
ms.author: sidram
ms.service: stream-analytics
ms.topic: conceptual
ms.date: 01/04/2021
ms.custom: devx-track-js
ms.openlocfilehash: 4701cb4122b4196b08b2a427b34d49c7784b91a7
ms.sourcegitcommit: aaa65bd769eb2e234e42cfb07d7d459a2cc273ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/27/2021
ms.locfileid: "98878245"
---
# <a name="connect-stream-analytics-jobs-to-resources-in-an-azure-virtual-network-vnet"></a>Подключение заданий Stream Analytics к ресурсам в виртуальной сети Azure

Задания Stream Analytics выполняют исходящие подключения к входным и выходным ресурсам Azure для обработки данных в режиме реального времени и получения результатов. Эти входные и выходные ресурсы (например, концентраторы событий Azure и база данных SQL Azure) могут находиться за брандмауэром Azure или виртуальной сетью Azure (VNet). Stream Analytics служба работает из сетей, которые не могут быть непосредственно добавлены в правила сети.

Однако существует два способа безопасного подключения заданий Stream Analytics к входным и выходным ресурсам в таких сценариях.
* Использование частных конечных точек в кластерах Stream Analytics.
* Использование режима проверки подлинности управляемого удостоверения в сочетании с параметром "разрешить работу с сетью доверенных служб".

Задание Stream Analytics не принимает входящих подключений.

## <a name="private-endpoints-in-stream-analytics-clusters"></a>Частные конечные точки в кластерах Stream Analytics.
[Stream Analytics кластерах](./cluster-overview.md) — это выделенный клиентский кластер с одним клиентом, в котором можно выполнять задания Stream Analytics. Вы можете создавать управляемые частные конечные точки в кластере Stream Analytics, что позволяет любым заданиям, выполняемым в кластере, устанавливать безопасное исходящее подключение к входным и выходным ресурсам.

Создание частных конечных точек в кластере Stream Analytics выполняется в [два этапа](./private-endpoints.md). Этот вариант лучше всего подходит для средних и крупных потоковых рабочих нагрузок, так как минимальный размер кластера Stream Analytics составляет 36 SUs (хотя службы SUs 36 могут совместно использоваться разными заданиями в различных подписках или средах, таких как разработка, тестирование и производство).

## <a name="managed-identity-authentication-with-allow-trusted-services-configuration"></a>Аутентификация управляемого удостоверения с помощью конфигурации "Разрешить доверенные службы"
Некоторые службы Azure предоставляют доступ к параметрам сети " **Разрешить доверенные службы Майкрософт** ", которые при включении позволяют заданиям Stream Analytics безопасно подключаться к ресурсу с помощью строгой проверки подлинности. Этот параметр позволяет подключать задания к входным и выходным ресурсам, не требуя Stream Analytics кластера и частных конечных точек. Настройка задания для использования этой методики является 2-шаговой операцией:
* Используйте режим проверки подлинности управляемого удостоверения при настройке ввода или вывода в задании Stream Analytics.
* Предоставьте конкретным Stream Analyticsным заданиям явный доступ к целевым ресурсам, назначив роль Azure управляемому удостоверению задания, назначенному системой. 

Включение параметра **Разрешить доверенные службы Майкрософт** не предоставляет общий доступ к любому заданию. Это дает полный контроль над тем, какие конкретные задания Stream Analytics могут безопасно получать доступ к ресурсам. 

Ваши задания могут подключаться к следующим службам Azure с помощью этого метода:
1. [Хранилище BLOB-объектов или Azure Data Lake Storage 2-го поколения](./blob-output-managed-identity.md) — может быть учетной записью хранения задания, входными потоками или выходными данными.
2. [Концентраторы событий Azure](./event-hubs-managed-identity.md) — могут быть входными потоками или выходными данными задания.

Если заданиям требуется подключаться к другим типам входных или выходных данных, можно сначала выполнить запись из Stream Analytics в список выходных данных концентраторов событий, а затем в любое целевое назначение с помощью функций Azure. Если вы хотите напрямую записывать данные из Stream Analytics в другие типы выходных данных, защищенные в виртуальной сети или брандмауэре, единственным вариантом является использование частных конечных точек в кластерах Stream Analytics.

## <a name="next-steps"></a>Дальнейшие действия

* [Создание и удаление частных конечных точек в кластерах Stream Analytics](./private-endpoints.md)
* [Подключение к концентраторам событий в виртуальной сети с помощью управляемого удостоверения аутентификации](./event-hubs-managed-identity.md)
* [Подключение к хранилищу BLOB-объектов и ADLS 2-го поколения в виртуальной сети с помощью проверки подлинности управляемого удостоверения](./blob-output-managed-identity.md)