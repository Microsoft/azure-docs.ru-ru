---
title: Отладка запросов Azure Stream Analytics локально с помощью схемы заданий в Visual Studio Code
description: В этой статье описывается, как выполнить локальную отладку запросов с помощью схемы задания в расширении Azure Stream Analytics для Visual Studio Code.
author: su-jie
ms.author: sujie
ms.service: stream-analytics
ms.topic: how-to
ms.date: 06/23/2020
ms.openlocfilehash: 25ad696ad345fbf672f6bf26eb3f35a13fb03ea5
ms.sourcegitcommit: 42a4d0e8fa84609bec0f6c241abe1c20036b9575
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "98019505"
---
# <a name="debug-azure-stream-analytics-queries-locally-using-job-diagram-in-visual-studio-code"></a>Отладка запросов Azure Stream Analytics локально с помощью схемы заданий в Visual Studio Code

Задания потоковой передачи, которые не выводят результаты или непредвиденные результаты, часто требуют устранения неполадок. Расширение Visual Studio Code для Azure Stream Analytics интегрирует схемы заданий, метрики, журналы диагностики и промежуточные результаты, помогающие быстро изолировать источник проблемы. Вы можете использовать схему заданий при локальном тестировании запроса, чтобы изучить промежуточный результирующий набор и метрики для каждого шага.

## <a name="debug-a-query-using-job-diagram"></a>Отладка запроса с помощью схемы задания

Для преобразования входных данных в выходные данные используется скрипт Azure Stream Analytics. На схеме задания показано, как потоки данных из источников ввода, такие как концентраторы событий или центр Интернета вещей, проходят через несколько шагов запроса для вывода приемников. Каждый шаг запроса сопоставляется с временным результирующим набором, определенным в скрипте с помощью `WITH` инструкции. Вы можете просмотреть данные, а также метрики каждого шага запроса в каждом промежуточном результирующем наборе, чтобы найти источник проблемы.

> [!NOTE]
> Эта схема заданий показывает только данные и метрики для локального тестирования в одном узле. Его не следует использовать для настройки производительности и устранения неполадок.

### <a name="start-local-testing"></a>Запуск локального тестирования

Используйте это [Краткое руководство](quick-create-visual-studio-code.md) , чтобы узнать, как создать задание Stream Analytics с помощью Visual Studio Code или [экспортировать существующее задание в локальный проект](visual-studio-code-explore-jobs.md). Учетные данные для входных и выходных данных автоматически заполняются для экспортированных заданий.

Если вы хотите протестировать запрос с локальными входными данными, выполните следующие [инструкции](visual-studio-code-local-run.md). Если вы хотите протестировать с помощью Live input, [Настройте входные данные](stream-analytics-add-inputs.md) , чтобы перейти к следующему шагу. 

Откройте файл скрипта *\. asaql* и выберите **запустить локально**. Затем выберите **использовать локальный вход** или **использовать динамический вход**. Схема задания отображается в правой части окна.

### <a name="view-the-output-and-intermediate-result-set"></a>Просмотр выходного и промежуточного результирующего набора  

1. Все выходные данные задания отображаются в окне результатов в нижней правой части окна Visual Studio Code.

   > [!div class="mx-imgBorder"]
   > ![Результаты выходных данных задания](./media/debug-locally-using-job-diagram-vs-code/job-output-results.png)

2. Выберите шаг запроса, чтобы перейти к скрипту. Вы автоматически направляете соответствующий скрипт в редакторе слева. Промежуточный результат отображается в окне результатов в нижней правой части окна Visual Studio Code.

   > [!div class="mx-imgBorder"]
   > ![Просмотр результатов в схеме заданий](./media/debug-locally-using-job-diagram-vs-code/preview-result.png)

### <a name="view-metrics"></a>Просмотр метрик

В этом разделе вы изучите метрики, доступные для каждой части схемы.

1. Выберите вкладку **Метрика** рядом с вкладкой **результат** в нижней правой части окна Visual Studio Code.

2. Выберите **Задание** из раскрывающегося списка. Можно выбрать любое пустое пространство на узле графа, чтобы переходить к метрикам уровня задания. Это представление содержит все метрики, которые обновляются каждые 10 секунд при выполнении задания. Можно выбрать или отменить выбор метрик в правой части, чтобы просмотреть их на диаграммах.

   > [!div class="mx-imgBorder"]
   > ![Метрики схемы заданий](./media/debug-locally-using-job-diagram-vs-code/job-metrics.png)

3. Выберите имя источника входных данных из раскрывающегося списка, чтобы просмотреть входные метрики. Источник входных данных на следующем снимке экрана называется *кавычками*. Дополнительные сведения о входных метриках см. в статьях сведения о [мониторинге Stream Analytics заданий и наблюдении за запросами](stream-analytics-monitoring.md).

   > [!div class="mx-imgBorder"]
   > ![Метрики входных данных схемы заданий](./media/debug-locally-using-job-diagram-vs-code/input-metrics.png)

4. Выберите шаг запроса на схеме задания или выберите имя шага из раскрывающегося списка, чтобы просмотреть метрики уровня шага. Единственная доступная метрика шага — задержка водяного знака.

   > [!div class="mx-imgBorder"]
   > ![Метрики шага](./media/debug-locally-using-job-diagram-vs-code/step-metrics.png)

5. Выберите выход на диаграмме или из раскрывающегося списка, чтобы просмотреть метрики, связанные с выводом. Дополнительные сведения о метриках выходных данных см. в статьях сведения о [мониторинге Stream Analytics заданий и наблюдении за запросами](stream-analytics-monitoring.md). Приемники выходных данных в реальном времени не поддерживаются.

   > [!div class="mx-imgBorder"]
   > ![Метрики выходных данных](./media/debug-locally-using-job-diagram-vs-code/output-metrics.png)

### <a name="view-diagnostic-logs"></a>просмотр журналов диагностики;

Журналы диагностики уровня задания содержат диагностические сведения для источников входных данных и приемников вывода. При выборе входного узла или выходного узла отображаются только соответствующие журналы. При выборе шага запроса журналы не отображаются. Вы можете найти все журналы на уровне задания, а также отфильтровать журналы по серьезности и времени.

   > [!div class="mx-imgBorder"]
   > ![Журналы диагностики](./media/debug-locally-using-job-diagram-vs-code/diagnostic-logs.png)

   Выберите запись журнала, чтобы просмотреть все сообщение.

   > [!div class="mx-imgBorder"]
   > ![Сообщение журналов диагностики](./media/debug-locally-using-job-diagram-vs-code/diagnostic-logs-message.png)


## <a name="other-job-diagram-features"></a>Другие функции схемы заданий

При необходимости можно выбрать **остановить** или **приостановить** на панели инструментов. После приостановки задания его можно возобновить с последнего вывода.

> [!div class="mx-imgBorder"]
> ![Остановка или приостановка задания](./media/debug-locally-using-job-diagram-vs-code/stop-pause-job.png)

Щелкните **Сводка по заданиям** в правом верхнем углу схемы задания, чтобы просмотреть свойства и конфигурации для локального задания.

> [!div class="mx-imgBorder"]
> ![Сводка по локальному заданию](./media/debug-locally-using-job-diagram-vs-code/job-summary.png)

## <a name="limitations"></a>Ограничения

* Приемники выходных данных в режиме реального времени не поддерживаются при локальном запуске.

* Запуск задания локально с помощью функции JavaScript поддерживается только в операционной системе Windows.

* Пользовательский код и функции Машинное обучение Azure C# не поддерживаются. 

* Только облачные входные параметры имеют поддержку [политик времени](./stream-analytics-time-handling.md) , а локальные параметры ввода — нет.

## <a name="next-steps"></a>Дальнейшие действия

* [Краткое руководство. Создание задания Stream Analytics с помощью Visual Studio Code](quick-create-visual-studio-code.md)
* [Изучение Azure Stream Analytics с Visual Studio Code](visual-studio-code-explore-jobs.md)
* [Локальное тестирование запросов Stream Analytics с использованием примера данных и Visual Studio Code](visual-studio-code-local-run.md)
* [Тестирование Azure Stream Analytics заданий локально с входными данными в режиме реального времени с помощью Visual Studio Code](visual-studio-code-local-run-live-input.md)