---
title: Просмотр относительных задержек в регионах Azure из указанных расположений
description: Узнайте, как просмотреть относительные задержки по интернет-провайдерам в регионах Azure из определенных расположений.
services: network-watcher
documentationcenter: ''
author: damendo
ms.service: virtual-network
ms.devlang: NA
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/14/2017
ms.author: damendo
ms.custom: ''
ms.openlocfilehash: 938315dac80ae51984851083753a9cb8f77662b2
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "84737909"
---
# <a name="view-relative-latency-to-azure-regions-from-specific-locations"></a>Просмотр относительных задержек в регионах Azure из определенных расположений

> [!WARNING]
> Сейчас эта функция находится на этапе предварительной версии и по-прежнему проверяется на стабильность.

Из этого руководства вы узнаете, как использовать службу [Наблюдатель за сетями](network-watcher-monitoring-overview.md) Azure, чтобы определиться, в какой регион Azure развернуть приложение или службу, руководствуясь демографическим анализом пользователей. Кроме того, вы можете использовать его, чтобы оценить подключения поставщиков услуг к Azure.  
        

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

## <a name="create-a-network-watcher"></a>Создание наблюдателя за сетями

Если у вас уже есть наблюдатель за сетями как минимум в одном [регионе](https://azure.microsoft.com/regions) Azure, вы можете пропустить задачи в этом разделе. Создайте группу ресурсов для наблюдателя за сетями. В этом примере группа ресурсов создается в регионе "Восточная часть США", но вы можете создать ее в любом регионе Azure.

```powershell
New-AzResourceGroup -Name NetworkWatcherRG -Location eastus
```

Создайте наблюдатель за сетями. Необходимо создать наблюдатель за сетями как минимум в одном регионе Azure. В этом примере наблюдатель за сетями создается в регионе Azure — "Восточная часть США".

```powershell
New-AzNetworkWatcher -Name NetworkWatcher_eastus -ResourceGroupName NetworkWatcherRG -Location eastus
```

## <a name="compare-relative-network-latencies-to-a-single-azure-region-from-a-specific-location"></a>Сравнение относительных сетевых задержек в одном регионе Azure из определенного расположения

Оцените поставщиков служб или устраните неполадки, связанные с пользовательским сообщением о неполадке "сайт был слишком длительный", из определенного расположения в регион Azure, в котором развернута служба. Например, команда ниже возвращает средние относительные задержки поставщика услуг Интернета между штатом Вашингтон в США и регионом Azure "Западная часть США 2" за период 13–15 декабря 2017 года:

```powershell
Get-AzNetworkWatcherReachabilityReport `
  -NetworkWatcherName NetworkWatcher_eastus `
  -ResourceGroupName NetworkWatcherRG `
  -Location "West US 2" `
  -Country "United States" `
  -State "washington" `
  -StartTime "2017-12-13" `
  -EndTime "2017-12-15"
```

> [!NOTE]
> Регион, указанный в команде выше, может отличаться от региона, указанного при получении наблюдателя за сетями. Для предыдущей команды просто необходимо указать имеющийся наблюдатель за сетями. Наблюдатель за сетями может находиться в любом регионе. Необходимо указать допустимые значения для `-Country` и `-State`. Эти значения чувствительны к регистру. Данные доступны для ограниченного числа стран, регионов, Штатов и городов. Выполните команды в [области Просмотр доступных стран и регионов, Штатов, городов и поставщиков](#view-available) , чтобы просмотреть список доступных стран, регионов, городов и состояний, которые можно использовать с предыдущей командой. 

> [!WARNING]
> Для `-StartTime` и `-EndTime` необходимо указать дату за последние 30 дней. Если вы укажете более раннюю дату, вы не сможете получать данные

Выходные данные из предыдущей команды будут выглядеть примерно так:

```powershell
AggregationLevel   : State
ProviderLocation   : {
                       "Country": "United States",
                       "State": "washington"
                     }
ReachabilityReport : [
                       {
                         "Provider": "Qwest Communications Company, LLC - ASN 209",
                         "AzureLocation": "West US 2",
                         "Latencies": [
                           {
                             "TimeStamp": "2017-12-14T00:00:00Z",
                             "Score": 92
                           },
                           {
                             "TimeStamp": "2017-12-13T00:00:00Z",
                             "Score": 92
                           }
                         ]
                       },
                       {
                         "Provider": "Comcast Cable Communications, LLC - ASN 7922",
                         "AzureLocation": "West US 2",
                         "Latencies": [
                           {
                             "TimeStamp": "2017-12-14T00:00:00Z",
                             "Score": 96
                           },
                           {
                             "TimeStamp": "2017-12-13T00:00:00Z",
                             "Score": 96
                           }
                         ]
                       }
                     ]
```

В выходных данных значение для параметра **Оценка** представляет собой относительную задержку между регионами и поставщиками. Показатель 1 — это худшая (наивысшая) задержка, в то время как 100 представляет собой наименьшее значение задержки. Относительные задержки представляют собой усредненное значение за день. В предыдущем примере помимо очевидно, что для указанного диапазона дат задержки одинаковы, существует небольшая разница между задержками для двух поставщиков, а также значения задержки для двух поставщиков достаточно низкие по шкале 1–100. Хотя эти результаты и являются ожидаемыми, так как штат Вашингтон в США физически ближе к региону Azure "Западная часть США 2", некоторые результаты предугадать невозможно. Чем больший диапазон дат вы указываете, тем большую среднюю задержку можно вычислить за указанный период времени.

## <a name="compare-relative-network-latencies-across-azure-regions-from-a-specific-location"></a>Сравнение относительных сетевых задержек в регионах Azure из определенного расположения

Вместо указания относительных задержек между определенным расположением и определенным регионом Azure с помощью параметра `-Location` можно определить относительные задержки для всех регионов Azure из определенного физического расположения. Например, с помощью следующей команды можно оценить, в какой регион Azure развернуть службу, если основные пользователи являются пользователями Comcast, размещенными в штате Вашингтон:

```powershell
Get-AzNetworkWatcherReachabilityReport `
  -NetworkWatcherName NetworkWatcher_eastus `
  -ResourceGroupName NetworkWatcherRG `
  -Provider "Comcast Cable Communications, LLC - ASN 7922" `
  -Country "United States" `
  -State "washington" `
  -StartTime "2017-12-13" `
  -EndTime "2017-12-15"
```

> [!NOTE]
> В отличие от случая, когда вы указываете отдельное расположение, если вы не указываете расположение или указываете несколько, например "Западная часть США 2", "Западная часть США", при выполнении команды следует указать поставщик услуг Интернета. 

## <a name="view-available-countriesregions-states-cities-and-providers"></a><a name="view-available"></a>Просмотр доступных стран и регионов, Штатов, городов и поставщиков

Данные доступны для конкретных поставщиков услуг Интернета, стран и регионов, Штатов и городов. Чтобы просмотреть список всех доступных поставщиков услуг Интернета, стран и регионов, Штатов и городов, для которых можно просмотреть данные, введите следующую команду:

```powershell
Get-AzNetworkWatcherReachabilityProvidersList -NetworkWatcherName NetworkWatcher_eastus -ResourceGroupName NetworkWatcherRG
```

Данные доступны только для стран, регионов, Штатов и городов, возвращенных предыдущей командой. Для предыдущей команды необходимо указать имеющийся Наблюдатель за сетями. В примере указывается Наблюдатель за сетями *NetworkWatcher_eastus* в группе ресурсов с именем *NetworkWatcherRG*, но вы можете указать любой имеющийся Наблюдатель за сетями. Если у вас его нет, создайте его, выполнив задачи, описанные в разделе о [создании наблюдателя за сетями](#create-a-network-watcher). 

После выполнения предыдущей команды можно отфильтровать выходные данные, указав при необходимости допустимые значения для параметров **страны**, **штата** и **города**.  Например, чтобы просмотреть список поставщиков услуг Интернета, доступных в Сиэтле, штат Вашингтон, США, введите следующую команду:

```powershell
Get-AzNetworkWatcherReachabilityProvidersList `
  -NetworkWatcherName NetworkWatcher_eastus `
  -ResourceGroupName NetworkWatcherRG `
  -City Seattle `
  -Country "United States" `
  -State washington
```

> [!WARNING]
> Значение, указанное для параметра **страны** должно содержать прописные и строчные буквы. Значения, указанные для параметров **штата** и **города** должны содержать строчные буквы. Значения должны перечисляться в выходных данных, возвращенных после выполнения команды без значений для параметров **страны**, **штата** и **города**. Если указать неверный регистр или указать значение для **страны**, **штата** или **города**, отсутствующее в выходных данных, возвращенных после выполнения команды без значений для этих свойств, возращенные выходные данные не будут содержать результатов.
