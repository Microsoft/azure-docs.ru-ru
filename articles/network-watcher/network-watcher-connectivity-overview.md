---
title: Общие сведения об устранении неполадок подключения в службе "Наблюдатель за сетями Azure" | Документация Майкрософт
description: Эта страница содержит обзор возможностей службы "Наблюдатель за сетями" по устранению неполадок подключения.
services: network-watcher
documentationcenter: na
author: damendo
ms.service: network-watcher
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/11/2017
ms.author: damendo
ms.openlocfilehash: 9c855fff9e5791b9c0cf870acfc6de53e7a700b2
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97654002"
---
# <a name="introduction-to-connection-troubleshoot-in-azure-network-watcher"></a>Общие сведения об устранении неполадок подключения в службе "Наблюдатель за сетями Azure"

Функция устранения неполадок подключения службы "Наблюдатель за сетями" предоставляет возможность проверять прямое подключение TCP от виртуальной машины к виртуальной машине, полное доменное имя, универсальный код ресурса или адрес IPv4. Сетевые сценарии сложные. Они реализуются с помощью групп безопасности сети, брандмауэров, определяемых пользователем маршрутов и ресурсов, предоставляемых Azure. Сложные конфигурации делают устранение неполадок, связанных с подключением, непростой задачей. Наблюдатель за сетями помогает сократить время поиска и обнаружения проблем с подключением. Полученные результаты могут дать представление о том, с чем связана проблема подключения: с платформой или конфигурацией пользователя. Подключение можно проверить с помощью [PowerShell](network-watcher-connectivity-powershell.md), [Azure CLI](network-watcher-connectivity-cli.md) и [REST API](network-watcher-connectivity-rest.md).

> [!IMPORTANT]
> Чтобы устранить неполадки подключения на виртуальной машине, установите на ней расширение `AzureNetworkWatcherExtension`. Информацию об установке расширения для виртуальной машины Windows см. в статье [Расширение виртуальной машины агента Наблюдателя за сетями для Windows](../virtual-machines/extensions/network-watcher-windows.md?toc=%2fazure%2fnetwork-watcher%2ftoc.json), а для виртуальной машины Linux — в статье [Расширение виртуальной машины агента Наблюдателя за сетями для Linux](../virtual-machines/extensions/network-watcher-linux.md?toc=%2fazure%2fnetwork-watcher%2ftoc.json). Эта расширение не нужно устанавливать на целевой конечной точке.

## <a name="response"></a>Ответ

В таблице ниже приведены свойства, возвращаемые после устранения неполадок подключения.

|Свойство.  |Описание  |
|---------|---------|
|ConnectionStatus     | Состояние проверки подключения. Возможные результаты: **Reachable** и **Unreachable**.        |
|AvgLatencyInMs     | Среднее время задержки при проверке подключения в миллисекундах. (Возвращается, только если подключение доступно.)        |
|MinLatencyInMs     | Минимальное время задержки при проверке подключения в миллисекундах. (Возвращается, только если подключение доступно.)        |
|MaxLatencyInMs     | Максимальное время задержки при проверке подключения в миллисекундах. (Возвращается, только если подключение доступно.)        |
|ProbesSent     | Число проб, отправленных во время проверки. Максимальное значение — 100.        |
|ProbesFailed     | Число проб, которые завершились сбоем во время проверки. Максимальное значение — 100.        |
|Hops     | Путь по прыжкам от источника к назначению.        |
|Hops[].Type     | Тип ресурса. Возможные значения: **Source**, **VirtualAppliance**, **VnetLocal** и **Internet**.        |
|Hops[].Id | Уникальный идентификатор прыжка.|
|Hops[].Address | IP-адрес прыжка.|
|Hops[].ResourceId | ResourceID прыжка, если прыжок — это ресурс Azure. Если это ресурс интернета, ResourceID — это **Интернет**. |
|Hops[].NextHopIds | Уникальный идентификатор следующего выполненного прыжка.|
|Hops[].Issues | Набор проблем, возникших во время проверки этого прыжка. Если проблем не обнаружено, значение будет пустым.|
|Hops[].Issues[].Origin | Текущий прыжок, где возникла проблем. Возможны следующие значения:<br/> **Inbound**. Проблема обнаружена в пути от предыдущего прыжка к текущему.<br/>**Outbound**. Проблема обнаружена в пути от текущего прыжка к следующему.<br/>**Local**. Проблема возникла на текущем прыжке.|
|Hops[].Issues[].Severity | Степень серьезности обнаруженной проблемы. Возможные значения: **Error** и **Warning**. |
|Hops[].Issues[].Type |Тип обнаруженной проблемы. Возможны следующие значения: <br/>**ЦП**<br/>**Память**<br/>**гуестфиревалл**<br/>**днсресолутион**<br/>**нетворксекуритируле**<br/>**усердефинедрауте** |
|Hops[].Issues[].Context |Сведения об обнаруженной проблеме.|
|Hops[].Issues[].Context[].key |Возвращенный ключ из пары "ключ — значение".|
|Hops[].Issues[].Context[].value |Возвращенное значение из пары "ключ — значение".|

Ниже приведен пример проблемы, обнаруженной при прыжке.

```json
"Issues": [
    {
        "Origin": "Outbound",
        "Severity": "Error",
        "Type": "NetworkSecurityRule",
        "Context": [
            {
                "key": "RuleName",
                "value": "UserRule_Port80"
            }
        ]
    }
]
```
## <a name="fault-types"></a>Типы ошибок

Устранение неполадок подключения возвращает типы ошибок подключения. Следующая таблица предоставляет список возвращаемых типов текущих ошибок.

|Type  |Описание  |
|---------|---------|
|ЦП     | Высокая загрузка ЦП.       |
|Память     | Высокий уровень использования памяти.       |
|GuestFirewall     | Трафик блокируется из-за конфигурации брандмауэра виртуальной машины.        |
|DnsResolution     | Сбой разрешения DNS для адреса назначения.        |
|NetworkSecurityRule    | Трафик блокируется правилом группы безопасности сети (возвращается правило).        |
|UserDefinedRoute|Трафик сбрасывается из-за определенного пользователем или системой маршрута. |

### <a name="next-steps"></a>Дальнейшие действия

Узнайте, как устранить неполадки подключения с помощью [портала Azure](network-watcher-connectivity-portal.md), [PowerShell](network-watcher-connectivity-powershell.md), [Azure CLI](network-watcher-connectivity-cli.md) или [REST API](network-watcher-connectivity-rest.md).