---
title: Высокая доступность и аварийное восстановление
description: Узнайте, как разработать приложение пакетной службы при региональном простое.
ms.topic: how-to
ms.date: 12/30/2020
ms.openlocfilehash: 51bcb0cfa35aacd24c0f79082491ef1fc7040889
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97831012"
---
# <a name="design-your-batch-application-for-high-availability"></a>Проектирование приложения пакетной службы для обеспечения высокой доступности

Пакетная служба Azure доступна во всех регионах Azure, но при ее создании учетная запись пакетной службы должна быть связана с одним конкретным регионом. Все операции для учетной записи пакетной службы затем применяются к этому региону. Например, пулы и связанные виртуальные машины создаются в том же регионе, что и учетная запись пакетной службы.

При разработке приложения, использующего пакетную службу, необходимо учитывать возможность недоступности пакетной службы в регионе. Может возникнуть редкий случай, когда существует проблема с регионом в целом, вся Пакетная служба в регионе или учетная запись пакетной службы.

Чтобы приложение или решение, использующее пакетную службу, всегда было доступным, его необходимо спроектировать так, чтобы оно либо переключалось на другой регион, либо всегда распределяло рабочую нагрузку между двумя или более регионами. Для обоих подходов требуется как минимум две учетные записи пакетной службы, причем каждая учетная запись расположена в своем регионе.

## <a name="multiple-batch-accounts-in-multiple-regions"></a>Несколько учетных записей пакетной службы в нескольких регионах

Использование нескольких учетных записей пакетной службы в различных регионах позволяет приложению продолжать работу, если учетная запись пакетной служба в одном регионе становится недоступной. Если ваше приложение должно быть высокодоступным, особенно важно иметь несколько учетных записей.

В некоторых случаях приложения могут быть разработаны для намеренного использования двух или более регионов. Например, когда вам требуется значительный объем емкости, использование нескольких регионов может понадобиться для обработки либо крупномасштабного приложения, либо для удовлетворения будущего роста. Для этих приложений также потребуется несколько учетных записей пакетной службы (по одной на регион).

## <a name="design-considerations-for-providing-failover"></a>Рекомендации по проектированию для обеспечения отработки отказа

При предоставлении возможности отработки отказа в другой регион необходимо учитывать все компоненты в решении. недостаточно просто иметь вторую учетную запись пакетной службы. Например, в большинстве приложений пакетной службы требуется учетная запись хранения Azure, а учетная запись хранения и учетная запись пакетной службы должны находиться в одном регионе для обеспечения приемлемой производительности.

При разработке решения, способного обеспечить отработку отказа, необходимо учитывать следующее.

- Предварительно создайте все необходимые учетные записи в каждом регионе, например учетную запись пакетной службы и учетную запись хранения. Часто плата за создание учетных записей не взимается, а расходы начисляются только при использовании учетной записи или при хранении данных.
- Убедитесь, что соответствующие [квоты](batch-quota-limit.md) установлены для всех учетных записей заранее, поэтому вы можете выделить необходимое количество ядер с помощью учетной записи пакетной службы.
- Используйте шаблоны и (или) сценарии для автоматизации развертывания приложения в регионе.
- Постоянно обновляйте двоичные файлы приложения и эталонные данные во всех регионах. Постоянное обновление позволит быстро подключить регион к сети, не дожидаясь загрузки и развертывания файлов. Например, если пользовательское приложение хранится для установки на узлах пула и на него ссылаются с помощью приложений пакетной службы, то при создании новой версии приложения его необходимо загрузить на каждую учетную запись пакетной службы и на него должна ссылаться конфигурация пула (или необходимо сделать новую версию по умолчанию).
- В приложении, вызывающем пакет, хранилище и другие службы, упростите переключение клиентов или нагрузки в разные регионы.
- Рекомендуется часто переключаться на альтернативный регион в рамках нормальной работы. Например, при двух развертываниях в отдельных регионах переключаться на альтернативный регион каждый месяц.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения см. в статьях [Создание учетной записи пакетной службы на портале Azure](batch-account-create-portal.md), [Примеры использования Azure CLI для пакетной службы Azure](./scripts/batch-cli-sample-create-account.md), [Управление ресурсами пакетной службы с помощью командлетов PowerShell](batch-powershell-cmdlets-get-started.md) или [Управление учетными записями и квотами пакетной службы с помощью клиентской библиотеки .NET для управления пакетной службой](batch-management-dotnet.md).
- Сведения о [квотах по умолчанию, связанных с учетной записью пакетной службы](batch-quota-limit.md) , и о том, как можно увеличить квоты.
