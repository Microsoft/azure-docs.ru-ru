---
title: Анализ затрат и бюджеты
description: Узнайте, как получить анализ затрат, установить бюджет и снизить затраты на базовые ресурсы вычислений и лицензии на программное обеспечение, используемые для выполнения рабочих нагрузок пакетной службы.
ms.topic: how-to
ms.date: 01/21/2021
ms.openlocfilehash: 1a950f23b7ecee11dd7da5414b7eed9e87277850
ms.sourcegitcommit: b39cf769ce8e2eb7ea74cfdac6759a17a048b331
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2021
ms.locfileid: "98679325"
---
# <a name="cost-analysis-and-budgets-for-azure-batch"></a>Анализ затрат и бюджеты для пакетной службы Azure

Нет никаких затрат на использование самой пакетной службы Azure, хотя могут взиматься платежи для базовых ресурсов вычислений и лицензий на программное обеспечение, используемых для выполнения пакетных рабочих нагрузок. Стоимость может быть вызвана виртуальными машинами в пуле, переносом данных из виртуальной машины или любыми входными или выходными данными, хранящимися в облаке. Этот раздел поможет понять, откуда берутся затраты, как задать бюджет для пула или учетной записи пакетной службы, а также способ снизить затраты на пакетную обработку.

## <a name="batch-resources"></a>Ресурсы пакетной службы

Виртуальные машины — наиболее важный ресурс, используемый для пакетной обработки. Стоимость использования виртуальных машин в пакетной службе вычисляется исходя из типа ВМ, их количества и продолжительности использования. Для оплаты виртуальных машин доступны такие варианты, как [оплата по мере использования](https://azure.microsoft.com/offers/ms-azr-0003p/) и [резервирование](../cost-management-billing/reservations/save-compute-costs-reservations.md) (предварительная оплата). Оба варианта оплаты имеют разные преимущества в зависимости от рабочей нагрузки, и они повлияют на ваш счет по-разному.

При развертывании приложений на узлах пакетной службы (ВМ) с помощью [пакетов приложений](batch-application-packages.md) также взимается плата за ресурсы службы хранилища Azure, используемые пакетами приложений. Кроме того, взимается плата за хранение всех файлов с входными или выходными данными, например файлов ресурсов и данных журналов. Как правило, стоимость хранения данных, связанных с пакетной службой, значительно ниже, чем стоимость вычислительных ресурсов. Каждая виртуальная машина в пуле, созданная с помощью [конфигурации виртуальной машины](nodes-and-pools.md#virtual-machine-configuration) , имеет связанный диск ОС, использующий управляемые Azure диски. Диски, управляемые Azure, также оплачиваются, и каждому уровню производительности диска соответствует свой ценовой уровень.

Пулы пакетной службы используют сетевые ресурсы. В частности, для пулов **VirtualMachineConfiguration** используются стандартные подсистемы балансировки нагрузки, для которых требуются статические IP-адреса. Подсистемы балансировки нагрузки, используемые пакетной службой, доступны для учетных записей **пользовательской подписки**, но не доступны для учетных записей **пакетной службы**. При использовании стандартных подсистем балансировки нагрузки плата взимается за все данные, передаваемые в виртуальные машины пула пакетной службы или из них. Кроме того, взимается плата за API пакетной службы, которые получают данные из узлов пула (например, получают файл задачи или узла); взимается плата за пакеты приложений задач, файлы ресурсов и файлы с выходными данными, а также образы контейнеров.

### <a name="additional-services"></a>Дополнительные службы

В ваши затраты на учетную запись пакетной службы также могут добавляться затраты на службы, не связанные с виртуальными машинами и хранением данных.

Другие службы, обычно используемые вместе с пакетной службой:

- Application Insights
- Фабрика данных
- Azure Monitor
- Виртуальная сеть
- Виртуальные машины с графическими приложениями

С вас может взиматься дополнительная плата в зависимости от того, какими службами вы пользуетесь в рамках решения с пакетной службой. Для расчета стоимости каждой дополнительной службы воспользуйтесь [калькулятором цен](https://azure.microsoft.com/pricing/calculator/).

## <a name="cost-analysis-and-budget-for-a-pool"></a>Анализ затрат и бюджет для пула

В портал Azure можно создавать бюджеты и тратить оповещения для пулов пакетной службы или учетных записей пакетной службы. Бюджеты и оповещения полезны для уведомления заинтересованных лиц о любых рисках чрезмерной траты, хотя это может привести к задержке при расходе оповещений и слегка превышению бюджета.

В следующем примере мы рассмотрим анализ затрат для отдельного пула пакетной службы.

1. В портал Azure введите или выберите **Управление затратами + выставление счетов** .
1. Выберите свою подписку в разделе **области выставления счетов** .
1. В **Управление затратами** выберите **Анализ затрат**.
1. Выберите **Добавить фильтр**. В первом раскрывающемся списке выберите **ресурс** .
1. Во втором раскрывающемся списке выберите пул пакетной службы. Выбрав пул, вы увидите анализ затрат для пула, как показано в примере ниже.
    ![Снимок экрана, показывающий анализ затрат пула в портал Azure.](./media/batch-budget/pool-cost-analysis.png)

После проведения анализа затрат отображается стоимость пула и список ресурсов, влияющих на эту стоимость. В данном примере виртуальные машины, используемые в пуле, являются наиболее дорогостоящим ресурсом.

Чтобы создать бюджет для пула, выберите **бюджет: нет**, а затем выберите **создать новый бюджет >**. Теперь используйте окно для [настройки бюджета](../cost-management-billing/costs/tutorial-acm-create-budgets.md) , специально предназначенного для пула.

> [!NOTE]
> Пакетная служба Azure основана на технологии виртуальных машин Azure и облачных служб Azure. При выборе режима **Конфигурация облачных служб** плата взимается в зависимости от структуры цен на облачные службы. При выборе режима **Конфигурация виртуальной машины** плата взимается в зависимости от структуры цен на виртуальные машины. В примере на этой странице используется **Конфигурация виртуальной машины**, которая рекомендуется для большинства пулов пакетной службы.

## <a name="minimize-cost"></a>Сокращение затрат

Использование нескольких виртуальных машин и служб Azure в течение продолжительного периода времени может оказаться дорогостоящей процедурой. Рассмотрите возможность использования этих стратегий для повышения эффективности рабочих нагрузок и снижения затрат.

### <a name="low-priority-virtual-machines"></a>Низкоприоритетные виртуальные машины

[Виртуальные машины с низким приоритетом](batch-low-pri-vms.md) снижают затраты на рабочие нагрузки пакетной службы, используя преимущества избыточных вычислительных ресурсов в Azure. Если в пулах вы указали низкоприоритетные виртуальные машины, пакетная служба использует для запуска рабочей нагрузки избыточные вычислительные ресурсы. При использовании виртуальных машин с низким приоритетом вместо выделенных виртуальных машин возможна значительная экономия затрат.

### <a name="virtual-machine-os-disk-type"></a>Тип системного диска для виртуальной машины

Azure предлагает несколько [типов дисков ОС виртуальной машины](../virtual-machines/disks-types.md). Большинство серий виртуальных машин имеют размеры, позволяющие использовать хранилища категории "Премиум" и "Стандарт". Если для пула выбран размер виртуальной машины, пакетная Настройка дисков с ОС SSD класса Premium. При выборе размера виртуальной машины "не-s" используется более дешевый тип диска "Стандартный HDD". Например, SSD-диски ОС категории "Премиум" используются для `Standard_D2s_v3`, а стандартные жесткие диски ОС используются для `Standard_D2_v3`.

SSD (цен. категория "Премиум") диски ОС более дороги, но имеют более высокую производительность. Виртуальные машины с дисков уровня "Премиум" могут запускаться немного быстрее, чем виртуальные машины с дисковыми накопителями стандартного жесткого диска. При использовании пакетной службы диск ОС часто не используется, так как приложения и файлы задач расположены на временном диске SSD виртуальной машины. По этой причине можно часто выбрать размер виртуальной машины "не-s", чтобы не оплачивать увеличенную стоимость твердотельного накопителя уровня "Премиум", подготовленного при указании размера виртуальной машины.

### <a name="reserved-virtual-machine-instances"></a>Зарезервированные экземпляры виртуальной машины

Если вы планируете использовать пакет в течение длительного периода времени, вы можете снизить затраты на виртуальные машины, используя [резервирование Azure](../cost-management-billing/reservations/save-compute-costs-reservations.md) для рабочих нагрузок. Тарифы резервирования значительно ниже, чем тарифы при оплате по мере использования. Для экземпляров виртуальных машин, используемых без резервирования, взимается плата с оплатой по мере использования. При покупке резервирования применяется скидка на резервирование.

### <a name="automatic-scaling"></a>Автоматическое масштабирование

[Автоматическое масштабирование](batch-automatic-scaling.md) позволяет динамически изменять количество виртуальных машин в пуле пакетной службы в зависимости от потребностей текущего задания. При масштабировании пула на основе времени существования задания автоматическое масштабирование гарантирует, что виртуальные машины масштабируются и используются только при наличии задания. После завершения задания или при отсутствии заданий виртуальные машины автоматически масштабируются для сохранения ресурсов вычислений. Масштабирование позволяет снизить общую стоимость решения пакетной службы за счет использования только необходимых ресурсов.

## <a name="next-steps"></a>Дальнейшие действия

- См. дополнительные сведения об [API-интерфейсах и средствах пакетной службы](batch-apis-tools.md) для сборки и мониторинга решений пакетной службы.  
- Узнайте об [использовании виртуальных машин с низким приоритетом с помощью пакетной](batch-low-pri-vms.md)службы.
