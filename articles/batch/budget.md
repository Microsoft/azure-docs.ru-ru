---
title: Получение анализа затрат и задание бюджетов для пакетной службы Azure
description: Узнайте, как получить анализ затрат, установить бюджет и снизить затраты на базовые ресурсы вычислений и лицензии на программное обеспечение, используемые для выполнения рабочих нагрузок пакетной службы.
ms.topic: how-to
ms.date: 01/29/2021
ms.openlocfilehash: d1fc2d15a7037e56a8056efa67d2017badb77ffd
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99091333"
---
# <a name="get-cost-analysis-and-set-budgets-for-azure-batch"></a>Получение анализа затрат и задание бюджетов для пакетной службы Azure

Этот раздел поможет вам понять затраты, которые могут быть связаны с пакетной службой Azure, как настроить бюджет для пула или учетной записи пакетной службы, а также способы снижения затрат на рабочие нагрузки пакета.

## <a name="understand-costs-associated-with-batch-resources"></a>Общие сведения о затратах, связанных с ресурсами пакетной службы

Нет никаких затрат на использование самой пакетной службы Azure, хотя могут взиматься платежи для базовых ресурсов вычислений и лицензий на программное обеспечение, используемых для выполнения пакетных рабочих нагрузок. Стоимость может быть вызвана виртуальными машинами в пуле, переносом данных из виртуальной машины или любыми входными или выходными данными, хранящимися в облаке.

### <a name="virtual-machines"></a>Виртуальные машины

Виртуальные машины — наиболее важный ресурс, используемый для пакетной обработки. Стоимость использования виртуальных машин в пакетной службе вычисляется исходя из типа ВМ, их количества и продолжительности использования. Для оплаты виртуальных машин доступны такие варианты, как [оплата по мере использования](https://azure.microsoft.com/offers/ms-azr-0003p/) и [резервирование](../cost-management-billing/reservations/save-compute-costs-reservations.md) (предварительная оплата). Оба варианта оплаты имеют разные преимущества в зависимости от рабочей нагрузки, и они повлияют на ваш счет по-разному.

Каждая виртуальная машина в пуле, созданная с помощью [конфигурации виртуальной машины](nodes-and-pools.md#virtual-machine-configuration) , имеет связанный диск ОС, использующий управляемые Azure диски. Диски, управляемые Azure, также оплачиваются, и каждому уровню производительности диска соответствует свой ценовой уровень.

### <a name="storage"></a>Служба хранилища

При развертывании приложений на узлах пакетной службы (ВМ) с помощью [пакетов приложений](batch-application-packages.md) также взимается плата за ресурсы службы хранилища Azure, используемые пакетами приложений. Кроме того, взимается плата за хранение любых входных или выходных файлов, таких как файлы ресурсов и другие данные журнала.

Как правило, стоимость хранения данных, связанных с пакетной службой, значительно ниже, чем стоимость вычислительных ресурсов.

### <a name="networking-resources"></a>Сетевые ресурсы

Пулы пакетной службы используют сетевые ресурсы, некоторые из которых имеют связанные затраты. В частности, для пулов конфигурации виртуальных машин используются стандартные подсистемы балансировки нагрузки, для которых требуются статические IP-адреса. Подсистемы балансировки нагрузки, используемые пакетом, видимы для [учетных записей](accounts.md#batch-accounts) , настроенных в режиме пользовательской подписки, но не в режиме пакетной службы.

Плата за стандартные подсистемы балансировки нагрузки взимается за все данные, передаваемые в виртуальные машины пула пакетной службы и из нее. Выберите API пакетной службы, которые извлекают данные из узлов пула (например, получение файла задачи или узла), пакеты приложений задач, файлы ресурсов и выходных данных, а также образы контейнеров.

### <a name="additional-services"></a>Дополнительные службы

С вас может взиматься дополнительная плата в зависимости от того, какими службами вы пользуетесь в рамках решения с пакетной службой. Для расчета стоимости каждой дополнительной службы воспользуйтесь [калькулятором цен](https://azure.microsoft.com/pricing/calculator/). Службы, обычно используемые с пакетом, которые могут иметь связанные затраты, включают:

- Application Insights
- Фабрика данных
- Azure Monitor
- Виртуальная сеть
- Виртуальные машины с графическими приложениями

## <a name="view-cost-analysis-and-create-a-budget-for-a-pool"></a>Просмотр анализа затрат и создание бюджета для пула

В портал Azure можно создавать бюджеты и тратить оповещения для пулов пакетной службы или учетных записей пакетной службы. Бюджеты и оповещения полезны для уведомления заинтересованных лиц о любых рисках чрезмерной траты, хотя это может привести к задержке при расходе оповещений и слегка превышению бюджета.

> [!NOTE]
> В этом примере пул использует **конфигурацию виртуальной машины**, которая рекомендуется для большинства пулов и оплачивается в зависимости от структуры ценообразования виртуальных машин. Плата за пулы, в которых используется **Конфигурация облачных служб** , зависит от структуры ценообразования облачных служб.

### <a name="view-cost-analysis-for-a-batch-pool"></a>Просмотр анализа затрат для пула пакетной службы

1. В портал Azure введите или выберите **Управление затратами + выставление счетов** .
1. Выберите свою подписку в разделе **области выставления счетов** .
1. В **Управление затратами** выберите **Анализ затрат**.
1. Выберите **Добавить фильтр**. В первом раскрывающемся списке выберите **ресурс** .
1. Во втором раскрывающемся списке выберите пул пакетной службы. Выбрав пул, вы увидите анализ затрат для пула, как показано в примере ниже.
    ![Снимок экрана, показывающий анализ затрат пула в портал Azure.](./media/batch-budget/pool-cost-analysis.png)

После проведения анализа затрат отображается стоимость пула и список ресурсов, влияющих на эту стоимость. В данном примере виртуальные машины, используемые в пуле, являются наиболее дорогостоящим ресурсом.

### <a name="create-a-budget-for-a-batch-pool"></a>Создание бюджета для пула пакетной службы

1. На странице **анализ затрат** выберите **бюджет: нет**.
1. Выберите **создать новый бюджет >**.
1. Используйте полученное окно для настройки бюджета, специально предназначенного для пула. Дополнительные сведения см. в разделе [учебник. создание бюджетов Azure и управление ими](../cost-management-billing/costs/tutorial-acm-create-budgets.md).

## <a name="minimize-costs-associated-with-azure-batch"></a>Сокращение затрат, связанных с пакетной службой Azure

В зависимости от вашего сценария может потребоваться уменьшить издержки, насколько это возможно. Рассмотрите возможность использования одной или нескольких стратегий для повышения эффективности рабочих нагрузок и снижения потенциальных затрат.

### <a name="use-low-priority-virtual-machines"></a>Использование виртуальных машин с низким приоритетом

[Виртуальные машины с низким приоритетом](batch-low-pri-vms.md) снижают затраты на рабочие нагрузки пакетной службы, используя преимущества избыточных вычислительных ресурсов в Azure. Если в пулах вы указали низкоприоритетные виртуальные машины, пакетная служба использует для запуска рабочей нагрузки избыточные вычислительные ресурсы. При использовании виртуальных машин с низким приоритетом вместо выделенных виртуальных машин возможна значительная экономия затрат.

### <a name="select-a-standard-virtual-machine-os-disk-type"></a>Выберите тип диска ОС виртуальной машины "Стандартный"

Azure предлагает несколько [типов дисков ОС виртуальной машины](../virtual-machines/disks-types.md). Большинство серий виртуальных машин имеют размеры, позволяющие использовать хранилища категории "Премиум" и "Стандарт". Если для пула выбран размер виртуальной машины, пакетная Настройка дисков с ОС SSD класса Premium. При выборе размера виртуальной машины "не-s" используется более дешевый тип диска "Стандартный HDD". Например, SSD-диски ОС категории "Премиум" используются для `Standard_D2s_v3`, а стандартные жесткие диски ОС используются для `Standard_D2_v3`.

SSD (цен. категория "Премиум") диски ОС более дороги, но имеют более высокую производительность. Виртуальные машины с дисков уровня "Премиум" могут запускаться немного быстрее, чем виртуальные машины с дисковыми накопителями стандартного жесткого диска. При использовании пакетной службы диск ОС часто не используется, так как приложения и файлы задач расположены на временном диске SSD виртуальной машины. По этой причине можно часто выбрать размер виртуальной машины "не-s", чтобы не оплачивать увеличенную стоимость твердотельного накопителя уровня "Премиум", подготовленного при указании размера виртуальной машины.

### <a name="purchase-reservations-for-virtual-machine-instances"></a>Покупка резервирований для экземпляров виртуальных машин

Если вы планируете использовать пакет в течение длительного периода времени, вы можете снизить затраты на виртуальные машины, используя [резервирование Azure](../cost-management-billing/reservations/save-compute-costs-reservations.md) для рабочих нагрузок. Тарифы резервирования значительно ниже, чем тарифы при оплате по мере использования. Для экземпляров виртуальных машин, используемых без резервирования, взимается плата с оплатой по мере использования. При покупке резервирования применяется скидка на резервирование.

### <a name="use-automatic-scaling"></a>Использовать автоматическое масштабирование

[Автоматическое масштабирование](batch-automatic-scaling.md) позволяет динамически изменять количество виртуальных машин в пуле пакетной службы в зависимости от потребностей текущего задания. При масштабировании пула на основе времени существования задания автоматическое масштабирование гарантирует, что виртуальные машины масштабируются и используются только при наличии задания. После завершения задания или при отсутствии заданий виртуальные машины автоматически масштабируются для сохранения ресурсов вычислений. Масштабирование позволяет снизить общую стоимость решения пакетной службы за счет использования только необходимых ресурсов.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [службе "Управление затратами Azure" + "выставление счетов](../cost-management-billing/cost-management-billing-overview.md) "
- Узнайте об [использовании виртуальных машин с низким приоритетом с помощью пакетной](batch-low-pri-vms.md)службы.
