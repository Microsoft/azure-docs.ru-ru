---
title: Переменные среды выполнения задания
description: Справочник по переменным среды выполнения задания и справочник по пакетной аналитики Azure.
ms.topic: conceptual
ms.date: 12/30/2020
ms.openlocfilehash: c1d9ffb3fe6775b061863656adcb7f45f8840997
ms.sourcegitcommit: beacda0b2b4b3a415b16ac2f58ddfb03dd1a04cf
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/31/2020
ms.locfileid: "97830893"
---
# <a name="azure-batch-runtime-environment-variables"></a>Переменные среды выполнения пакетной службы Azure

[Пакетная служба Azure](https://azure.microsoft.com/services/batch/) задает на вычислительных узлах указанные ниже переменные среды. Вы можете ссылаться на них в командных строках задач, а также в программах и сценариях, запускаемых этими командными строками.

Подробные сведения об использовании переменных среды в пакетной службе см. в статье [Параметры среды для задач](jobs-and-tasks.md#environment-settings-for-tasks).

## <a name="environment-variable-visibility"></a>Видимость переменных среды

Эти переменные среды видимы только в контексте **пользователя задачи**, который является учетной записью пользователя на узле, в котором выполняется задача. Эти переменные не будут отображаться при [удаленном подключении](./error-handling.md#connect-to-compute-nodes) к кластерному узлу с помощью протокол удаленного рабочего стола (RDP) или Secure Shell (SSH) и перечисления переменных среды. Это вызвано тем, что учетная запись, используемая для удаленного подключения, отличается от учетной записи, используемой задачей.

Чтобы получить текущее значение переменной среды, запустите `cmd.exe` на вычислительном узле Windows или `/bin/sh` на узле Linux:

`cmd /c set <ENV_VARIABLE_NAME>`

`/bin/sh -c "printenv <ENV_VARIABLE_NAME>"`

## <a name="command-line-expansion-of-environment-variables"></a>Расширение переменных среды в командной строке

Командные строки, выполняемые задачами на расчетных узлах, не выполняются в оболочке. Это означает, что эти командные строки не могут использовать встроенные функции оболочки, такие как расширение переменных среды (включая `PATH` ). Чтобы использовать эти функции, необходимо вызвать оболочку в командной строке. Например, запустите `cmd.exe` на вычислительных узлах Windows или `/bin/sh` на узлах Linux:

`cmd /c MyTaskApplication.exe %MY_ENV_VAR%`

`/bin/sh -c "MyTaskApplication $MY_ENV_VAR"`

## <a name="environment-variables"></a>Переменные среды

| Имя переменной                     | Описание                                                              | Доступность | Пример |
|-----------------------------------|--------------------------------------------------------------------------|--------------|---------|
| AZ_BATCH_ACCOUNT_NAME           | Имя учетной записи пакетной службы, к которой относится задача.                  | Все задачи.   | mybatchaccount |
| AZ_BATCH_ACCOUNT_URL            | URL-адрес учетной записи пакетной службы. | Все задачи. | `https://myaccount.westus.batch.azure.com` |
| AZ_BATCH_APP_PACKAGE            | Префикс всех переменных среды пакета приложения. Например, если приложение "Foo" версии "1" установлено в пуле, переменная окружения будет AZ_BATCH_APP_PACKAGE_FOO_1 (в Linux) или AZ_BATCH_APP_PACKAGE_FOO#1 (в Windows). AZ_BATCH_APP_PACKAGE_FOO_1 указывает на местоположение, в которое был загружен пакет (папка). При использовании версии пакета приложения по умолчанию используйте переменную среды AZ_BATCH_APP_PACKAGE без номеров версий. В Linux, если имя пакета приложения — "Agent-Linux-x64", а версия — "1.1.46.0", фактическое имя среды будет следующим: AZ_BATCH_APP_PACKAGE_agent_linux_x64_1_1_46_0 (с символами подчеркивания и буквами в нижнем регистре). Дополнительные сведения см. [в разделе выполнение установленных приложений](batch-application-packages.md#execute-the-installed-applications) для получения дополнительных сведений. | Любую задачу с помощью пакета связанного приложения. Доступно также для всех задач, если сам узел имеет пакеты приложений. | AZ_BATCH_APP_PACKAGE_FOO_1 (Linux) или AZ_BATCH_APP_PACKAGE_FOO#1 (Windows) |
| AZ_BATCH_AUTHENTICATION_TOKEN   | Маркер проверки подлинности, который предоставляет доступ к ограниченному набору операций пакетной службы. Эта переменная среды присутствует, только если [authenticationTokenSettings](/rest/api/batchservice/task/add#authenticationtokensettings) устанавливается при [добавлении задачи](/rest/api/batchservice/task/add#request-body). В API пакетной службы, например в [API BatchClient.Open() для .NET](/dotnet/api/microsoft.azure.batch.batchclient.open#Microsoft_Azure_Batch_BatchClient_Open_Microsoft_Azure_Batch_Auth_BatchTokenCredentials_), значение маркера используется в качестве учетных данных для создания клиента пакетной службы. | Все задачи. | Маркер доступа OAuth2 |
| AZ_BATCH_CERTIFICATES_DIR       | Каталог в [рабочем каталоге задачи](files-and-directories.md), где хранятся сертификаты для вычислительных узлов Linux. Эта переменная среды не применяется к вычислительным узлам Windows.                                                  | Все задачи.   |  /mnt/batch/tasks/workitems/batchjob001/job-1/task001/certs |
| AZ_BATCH_HOST_LIST              | Список узлов, выделяемых для [задачи с несколькими экземплярами](batch-mpi.md), в формате `nodeIP,nodeIP`. | Основные задачи и подзадачи с несколькими экземплярами. | `10.0.0.4,10.0.0.5` |
| AZ_BATCH_IS_CURRENT_NODE_MASTER | Указывает, является ли текущий узел главным для [задачи с несколькими экземплярами](batch-mpi.md). Возможные значения: `true` и `false`.| Основные задачи и подзадачи с несколькими экземплярами. | `true` |
| AZ_BATCH_JOB_ID                 | Идентификатор задания, к которому относится задача | Все задачи, кроме задачи запуска. | batchjob001 |
| AZ_BATCH_JOB_PREP_DIR           | Полный путь к [каталогу задачи](files-and-directories.md) подготовки задания на узле. | Все задачи, кроме задачи запуска и задачи подготовки задания. Доступна, только если для задания настроена задача подготовки задания. | C:\user\tasks\workitems\jobprepreleasesamplejob\job-1\jobpreparation |
| AZ_BATCH_JOB_PREP_WORKING_DIR   | Полный путь к [рабочему каталогу задачи](files-and-directories.md) подготовки задания на узле. | Все задачи, кроме задачи запуска и задачи подготовки задания. Доступна, только если для задания настроена задача подготовки задания. | C:\user\tasks\workitems\jobprepreleasesamplejob\job-1\jobpreparation\wd |
| AZ_BATCH_MASTER_NODE            | IP-адрес и порт вычислительного узла, где выполняется основная задача для [задачи с несколькими экземплярами](batch-mpi.md). Не используйте указанный здесь порт для связи MPI или NCCL, поскольку он зарезервирован для пакетной службы Azure. Вместо этого можно использовать переменную MASTER_PORT, задав для нее значение, передаваемое через аргумент командной строки (по умолчанию подойдет порт 6105), или использовать значение, задаваемое AML, если оно задается. | Основные задачи и подзадачи с несколькими экземплярами. | `10.0.0.4:6000` |
| AZ_BATCH_NODE_ID                | Идентификатор узла, которому назначена задача. | Все задачи. | tvm-1219235766_3-20160919t172711z |
| AZ_BATCH_NODE_IS_DEDICATED      | Если имеет значение `true`, то текущий узел является выделенным. Если имеет значение `false`, то это [низкоприоритетный узел](batch-low-pri-vms.md). | Все задачи. | `true` |
| AZ_BATCH_NODE_LIST              | Список узлов, выделяемых для [задачи с несколькими экземплярами](batch-mpi.md), в формате `nodeIP;nodeIP`. | Основные задачи и подзадачи с несколькими экземплярами. | `10.0.0.4;10.0.0.5` |
| AZ_BATCH_NODE_MOUNTS_DIR        | Полный путь к расположению [подключения файловой системы](virtual-file-mount.md) уровня узла, где находятся все каталоги подключения. Общие папки Windows используют букву диска, поэтому для Windows диск подключения является частью устройств и дисков.  |  Все задачи, включая начальную задачу, имеют доступ к пользователю при условии, что у пользователя есть разрешения на подключение к подключенному каталогу. | Например, в Ubuntu это следующее расположение: `/mnt/batch/tasks/fsmounts` |
| AZ_BATCH_NODE_ROOT_DIR          | Полный путь к корневому каталогу всех [каталогов пакетной службы](files-and-directories.md) на узле. | Все задачи. | C:\user\tasks |
| AZ_BATCH_NODE_SHARED_DIR        | Полный путь к [общему каталогу](files-and-directories.md) на узле. Все задачи, которые выполняются на узле, имеют доступ на чтение и запись для этого каталога. У задач, выполняемых на других узлах, нет удаленного доступа к этому каталогу (это не "общий" сетевой каталог). | Все задачи. | C:\user\tasks\shared |
| AZ_BATCH_NODE_STARTUP_DIR       | Полный путь к [каталогу запуска задачи](files-and-directories.md) на узле. | Все задачи. | C:\user\tasks\startup |
| AZ_BATCH_POOL_ID                | Идентификатор пула, в котором выполняется задача | Все задачи. | batchpool001 |
| AZ_BATCH_TASK_DIR               | Полный путь к [каталогу задачи](files-and-directories.md) на узле. Этот каталог содержит `stdout.txt` и `stderr.txt` для задачи, а также AZ_BATCH_TASK_WORKING_DIR. | Все задачи. | C:\user\tasks\workitems\batchjob001\job-1\task001 |
| AZ_BATCH_TASK_ID                | Идентификатор текущей задачи. | Все задачи, кроме задачи запуска. | task001 |
| AZ_BATCH_TASK_SHARED_DIR | Путь к каталогу, идентичный для основной задачи и всех подзадач [задачи с несколькими экземплярами](batch-mpi.md). Путь существует на каждом узле, на котором выполняется задача с несколькими экземплярами и доступен для чтения и записи в командах задач, выполняемых на этом узле (как [команда координации](batch-mpi.md#coordination-command) , так и [Команда приложения](batch-mpi.md#application-command)). У подзадач или основной задачи, выполняемых на других узлах, нет удаленного доступа к этому каталогу (это не "общий" сетевой каталог). | Основные задачи и подзадачи с несколькими экземплярами. | C:\user\tasks\workitems\multiinstancesamplejob\job-1\multiinstancesampletask |
| AZ_BATCH_TASK_WORKING_DIR       | Полный путь к [рабочему каталогу задачи](files-and-directories.md) на узле. Выполняемая задача имеет доступ на чтение и запись для этого каталога. | Все задачи. | C:\user\tasks\workitems\batchjob001\job-1\task001\wd |
| CCP_NODES                       | Список узлов и число ядер на узел, выделяемых для [задачи с несколькими экземплярами](batch-mpi.md). Узлы и ядра указаны в формате `numNodes<space>node1IP<space>node1Cores<space>`<br/>`node2IP<space>node2Cores<space> ...`, где за числом узлов следует один или несколько IP-адресов узла, а также число ядер для каждого узла. |  Основные задачи и подзадачи с несколькими экземплярами. |`2 10.0.0.4 1 10.0.0.5 1` |

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [использовать переменные среды с пакетной службой](jobs-and-tasks.md#environment-settings-for-tasks).
- Дополнительные сведения о [файлах и каталогах в пакетной](files-and-directories.md) службе
- Дополнительные сведения о [задачах с несколькими экземплярами](batch-mpi.md).
