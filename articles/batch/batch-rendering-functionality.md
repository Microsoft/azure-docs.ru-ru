---
title: Возможности рендеринга
description: Стандартные возможности пакетной службы Azure используются для запуска рабочих нагрузок рендеринга и приложений. Пакетная служба также включает в себя определенные компоненты для поддержки рабочих нагрузок рендеринга.
author: mscurrell
ms.author: markscu
ms.date: 03/12/2021
ms.topic: how-to
ms.openlocfilehash: a2e2cfb71999bd5ab83591448342d4bac1dabdd5
ms.sourcegitcommit: 4bda786435578ec7d6d94c72ca8642ce47ac628a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2021
ms.locfileid: "103496343"
---
# <a name="azure-batch-rendering-capabilities"></a>Возможности рендеринга в пакетной службе Azure

Стандартные возможности пакетной службы Azure используются для запуска рабочих нагрузок рендеринга и приложений. Пакетная служба также включает в себя определенные компоненты для поддержки рабочих нагрузок рендеринга.

Общие сведения о понятиях пакетной службы, включая пулы, задания и задачи, см. в [этой статье](./batch-service-workflow-features.md).

## <a name="batch-pools-using-custom-vm-images-and-standard-application-licensing"></a>Пулы пакетной службы, использующие пользовательские образы виртуальных машин и лицензирование стандартных приложений

Как и в случае с другими рабочими нагрузками и типами приложений, можно создать пользовательский образ виртуальной машины с необходимыми приложениями и подключаемыми модулями подготовки к просмотру. Пользовательский образ виртуальной машины помещается в [коллекцию общих образов](../virtual-machines/shared-image-galleries.md) и [может использоваться для создания пулов пакетной](batch-sig-images.md)службы.

Строки командной строки задачи должны ссылаться на приложения и пути, используемые при создании пользовательского образа виртуальной машины.

Большинству приложений для подготовки к просмотру требуются лицензии, полученные с сервера лицензирования. Если имеется существующий локальный сервер лицензирования, то пул и сервер лицензирования должны находиться в одной [виртуальной сети](../virtual-network/virtual-networks-overview.md). Можно также запустить сервер лицензирования на виртуальной машине Azure, если пул пакетной службы и виртуальная машина сервера лицензирования находятся в одной виртуальной сети.

## <a name="batch-pools-using-rendering-vm-images"></a>Пулы пакетной службы с использованием подготовки к просмотру образов виртуальных машин

> [!IMPORTANT]
> Образы виртуальных машин для подготовки к просмотру и лицензирование с оплатой за использование являются [устаревшими и будут прекращены на 29 февраля 2024](https://azure.microsoft.com/updates/azure-batch-rendering-vm-images-licensing-will-be-retired-on-29-february-2024/). Чтобы использовать пакет для подготовки к просмотру, [следует использовать пользовательский образ виртуальной машины и лицензирование стандартного приложения.](batch-rendering-functionality.md#batch-pools-using-custom-vm-images-and-standard-application-licensing)

### <a name="rendering-application-installation"></a>Установка приложения для рендеринга

Образ виртуальной машины для рендеринга из Azure Marketplace можно указать в конфигурации пула, если необходимо использовать только предварительно установленные приложения.

Существует образ Windows и образ CentOS.  Образы виртуальных машин можно найти в [Azure Marketplace](https://azuremarketplace.microsoft.com), задав в окне поиска "рендеринг в пакетной службе".

Пример конфигурации пула см. в [руководстве по отрисовке с использованием Azure CLI](./tutorial-rendering-cli.md).  Портал Azure и Batch Explorer предоставляют средства графического пользовательского интерфейса для выбора образа виртуальной машины для рендеринга при создании пула.  В случае использования API пакетной службы при создании пула укажите следующие значения свойств для [ImageReference](/rest/api/batchservice/pool/add#imagereference):

| Издатель | ПРЕДЛОЖЕНИЕ | Sku | Версия |
|---------|---------|---------|--------|
| пакет (1) | rendering-centos73 | rendering | последняя |
| пакет (1) | rendering-windows2016 | rendering | последняя |

Если на виртуальных машинах пула необходимы дополнительные приложения, то доступны другие варианты:

* Пользовательский образ из общей коллекции образов
  * Этот параметр позволяет настроить виртуальную машину с нужными приложениями и конкретными версиями. Дополнительные сведения см. в [Создание пула с использованием службы "Общая коллекция образов"](batch-sig-images.md). Autodesk и Chaos Group изменили Arnold и V-Ray соответственно, чтобы проверить соответствие службе лицензирования пакетной службы Azure. Убедитесь, что у вас установлены версии приложений, для которых предоставляется эта поддержка. В противном случае вы не сможете использовать лицензирование с оплатой по мере использования. Текущим версиям Maya или 3ds Max не требуется сервер лицензирования при автономном запуске (в пакетном режиме или в режиме командной строки). Если вы не знаете, как использовать эту возможность, обратитесь в службу поддержки Azure.
* [Пакеты приложений](./batch-application-packages.md):
  * Упакуйте файлы приложения, используя один или несколько ZIP-файлов, отправьте через портал Azure и укажите пакет в конфигурации пула. При создании виртуальных машин пула можно загрузить ZIP-архивы, а затем извлечь из них файлы.
* Файлы ресурсов:
  * Файлы приложения передаются в хранилище BLOB-объектов Azure, а вы указываете ссылки на файлы в [задаче запуска пула](/rest/api/batchservice/pool/add#starttask). После создания виртуальных машин пула файлы ресурсов загружаются на каждую виртуальную машину.

### <a name="pay-for-use-licensing-for-pre-installed-applications"></a>Предварительно установленные приложения с лицензиями, предусматривающими оплату по мере использования

Приложения со стоимостью лицензирования, которые будут использоваться, должны быть заданы в конфигурации пула.

* Укажите свойство `applicationLicenses` при [создании пула](/rest/api/batchservice/pool/add#request-body).  В массиве строк можно указать следующие значения: "vray", "arnold", "3dsmax", "maya".
* При указании одного или нескольких приложений стоимость этих приложений добавляется к стоимости виртуальных машин.  Цены на приложения цены указаны на [странице с ценами на пакетную службу Azure](https://azure.microsoft.com/pricing/details/batch/#graphic-rendering).

> [!NOTE]
> Если же вы подключаетесь к серверу лицензирования, чтобы использовать приложения для рендеринга, не указывайте свойство `applicationLicenses`.

Вы можете использовать портал Azure или Batch Explorer для выбора приложений и отображения цен на них.

Если предпринята попытка использовать приложение, но оно еще не было указано в свойстве `applicationLicenses` конфигурации пула или не может получить доступ к серверу лицензирования, тогда выполнение приложения завершится сбоем с ошибкой лицензирования и ненулевым кодом завершения.

### <a name="environment-variables-for-pre-installed-applications"></a>Переменные среды для предварительно установленных приложений

Чтобы иметь возможность создать командную строку для задач рендеринга, необходимо указать расположение установки исполняемых файлов приложений для рендеринга.  В образах виртуальных машин, включенных в Azure Marketplace, созданы системные переменные среды, которые можно использовать вместо того, чтобы указывать фактические пути.  Эти переменные среды являются дополнением к [стандартным переменным среды пакетной службы](./batch-compute-node-environment-variables.md), созданным для каждой задачи.

|Приложение|Исполняемый файл приложения|Переменная среды|
|---------|---------|---------|
|Autodesk 3ds Max 2021|3dsmaxcmdio.exe|3DSMAX_2021_EXEC|
|Autodesk Maya 2020|render.exe|MAYA_2020_EXEC|
|Chaos Group V-Ray Standalone|vray.exe|VRAY_4 VRAY_4.10.03_EXEC|
|Командная строка Arnold 2020|kick.exe|ARNOLD_2020_EXEC|
|Blender|blender.exe|BLENDER_2018_EXEC|

## <a name="azure-vm-families"></a>Семейства виртуальных машин Azure

Как в других рабочих нагрузках, требования к системе приложений для рендеринга различаются, как и требования к производительности для заданий и проектов.  В Azure доступны разнообразные семейства виртуальных машин для удовлетворения любых требований — наименьшие затраты, лучшее соотношение цены и производительности и т. д.
Некоторые приложения для рендеринга, например Arnold, основаны на использовании ресурсов ЦП. Другие, такие как V-Ray и Blender Cycles, могут использовать ЦП и (или) GPU.
Описание доступных семейств виртуальных машин и их размеры см. [здесь](../virtual-machines/sizes.md).

## <a name="low-priority-vms"></a>Виртуальные машины с низким приоритетом

Как и в других рабочих нагрузках, низкоприоритетные виртуальные машины могут использоваться в пулах пакетной службы для рендеринга.  Низкоприоритетные виртуальные машины выполняют то же, что и обычные выделенные виртуальные машины, но используют избыточные ресурсы Azure и доступны со значительной скидкой.  Недостатком использования виртуальных машин с низким приоритетом является то, что эти виртуальные машины могут быть недоступны для выделения или могут быть замещены в любое время, в зависимости от доступной емкости. По этой причине низкоприоритетные виртуальные машины не вполне подходят для всех заданий рендеринга. Например, если для рендеринга образов требуется много часов, скорее всего, прерывание и перезапуск рендеринга этих образов из-за замещения виртуальных машин будет неприемлемым.

Дополнительные сведения о характеристиках низкоприоритетных виртуальных машин и способах их настройки с помощью пакетной службы см. [здесь](./batch-low-pri-vms.md).

## <a name="jobs-and-tasks"></a>Задания и задачи

Для заданий и задач не требуется специальная поддержка для рендеринга.  Основной элемент конфигурации — это командная строка задачи, которая должна ссылаться на нужное приложение.
При использовании образов виртуальных машин, включенных в Azure Marketplace, рекомендуется указать путь и исполняемый файл приложения с помощью переменных среды.

## <a name="next-steps"></a>Дальнейшие действия

Примеры с применением рендеринга пакетной службы вы найдете в следующих руководствах:

* [Рендеринг с использованием Azure CLI](./tutorial-rendering-cli.md);
* [Рендеринг с использованием Batch Explorer](./tutorial-rendering-batchexplorer-blender.md).