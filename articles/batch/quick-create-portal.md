---
title: Краткое руководство Azure по выполнению первого пакетного задания на портале Azure
description: В этом кратком руководстве показано, как использовать портал Azure для создания учетной записи пакетной службы, пула вычислительных узлов и задания, выполняющего основные задачи в пуле.
ms.date: 08/17/2020
ms.topic: quickstart
ms.custom:
- mvc
- mode-portal
ms.openlocfilehash: 3333097b4bd55173725aa33bc4bfbae318510cf1
ms.sourcegitcommit: 49b2069d9bcee4ee7dd77b9f1791588fe2a23937
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2021
ms.locfileid: "107538547"
---
# <a name="quickstart-run-your-first-batch-job-in-the-azure-portal"></a>Краткое руководство по выполнению первого пакетного задания на портале Azure

Начните работу с пакетной службой Azure, чтобы с помощью портала Azure создать учетную запись пакетной службы, пул вычислительных узлов (виртуальных машин) и задание, выполняющее задачи в пуле. Выполняя действия из этого краткого руководства, вы изучите основные понятия пакетной службы и сможете использовать ее с более реалистичными рабочими нагрузками в большем масштабе.

## <a name="prerequisites"></a>Предварительные требования

- Учетная запись Azure с активной подпиской. [Создайте учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) бесплатно.

## <a name="create-a-batch-account"></a>Создание учетной записи Пакетной службы

Выполните следующие действия, чтобы создать образец учетной записи пакетной службы для тестирования. Учетная запись пакетной службы необходима для создания пулов и заданий. Как показано ниже, учетную запись хранения Azure можно связать с учетной записью пакетной службы. Хоть наличие учетной записи хранения и не является обязательным условием для работы с этим кратким руководством, она применяется при развертывании приложений и для хранения входных и выходных данных в большинстве реальных рабочих нагрузок.

1. На [портале Azure](https://portal.azure.com) последовательно выберите **Создать ресурс** > **Вычисления** > **Пакетная служба**. 

   :::image type="content" source="media/quick-create-portal/marketplace-batch.png" alt-text="Снимок экрана с изображением пакетной службы в Azure Marketplace.":::

1. Поле **Группа ресурсов** выберите **Создать** и введите имя группы ресурсов.

1. Введите значение в поле **Имя учетной записи**. Это имя должно быть уникальным в пределах выбранного **расположения** Azure. Оно может содержать только буквы в нижнем регистре и цифры и иметь длину от 3 до 24 символов.

1. В разделе **Учетная запись хранения** выберите имеющуюся учетную запись хранения или создайте новую.

1. Не изменяйте остальные параметры. Щелкните **Просмотр и создание**, а затем выберите **Создать**, чтобы создать учетную запись пакетной службы.

Когда отобразится сообщение **Развертывание прошло успешно**, перейдите к созданной учетной записи пакетной службы.

## <a name="create-a-pool-of-compute-nodes"></a>Создание пула вычислительных узлов

После создания учетной записи пакетной службы создайте образец пула вычислительных узлов Windows для тестирования. В этом кратком примере пул содержит два узла, выполняемых в образе Windows Server 2019 из Azure Marketplace.

1. В учетной записи пакетной службы выберите **Пулы** > **Добавить**.

1. В поле **Идентификатор пула** введите *mypool*.

1. В разделе **Operating System** (Операционные системы) выберите следующие параметры (вы можете ознакомиться с другими параметрами).
  
   |Параметр  |Значение  |
   |---------|---------|
   |**Тип образа**|Marketplace|
   |**Издатель**     |microsoftwindowsserver|
   |**Предложение**     |windowsserver|
   |**SKU**     |2019-datacenter-core-smalldisk|

1. Прокрутите вниз, чтобы задать параметры в разделах **Размер узла** и **Scale** (Масштаб). Предлагаемый размер узла в этом кратком руководстве обеспечивает оптимальный баланс производительности и стоимости.
  
   |Параметр  |Значение  |
   |---------|---------|
   |**Ценовая категория узла**     |Standard A1|
   |**Целевые выделенные узлы**     |2|

1. Оставьте значения по умолчанию для остальных параметров и нажмите кнопку **ОК**, чтобы создать пул.

В пакетной службе сразу же создается пул, но для выделения и запуска вычислительных узлов понадобится несколько минут. В течение этого времени **состояние выделения** пула будет **Resizing** (Изменение размера). Во время изменения размера пула вы можете начать создавать задание и задачи.

Через несколько минут значение состояния выделения пула изменится на **Устойчивое** и узлы запустятся. Чтобы проверить состояние узлов, выберите пул, а затем выберите **Узлы**. Если состояние узла — **Idle** (Неактивен), он готов к выполнению задач.

## <a name="create-a-job"></a>Создание задания

Получив пул, создайте задание, которое будет выполняться в нем. Пакетное задание — это логическая группа, состоящая из одной или нескольких задач. Задание включает в себя параметры, общие для задач (например, приоритет и пул для запуска задач). Изначально у задания нет задач.

1. В представлении учетной записи пакетной службы выберите **Задания** > **Добавить**.

1. В поле **Job ID** (Идентификатор задания) введите *myjob*. В разделе **Pool** (Пул) выберите *mypool*. Оставьте значения по умолчанию для остальных параметров и нажмите кнопку **ОК**.

## <a name="create-tasks"></a>Создание задач

Теперь выберите задание, чтобы открыть страницу **Задачи**. На ней вы создадите образец задач для запуска в задании. Обычно создается несколько задач, которые пакетная служба помещает в очередь и распределяет для запуска на вычислительных узлах. В этом примере создается две идентичные задачи. Каждая задача выполняет командную строку для отображения переменных среды пакетной службы на вычислительном узле, а затем ждет 90 секунд.

При использовании пакетной службы в командной строке задайте приложение или скрипт. В пакетной службе предусмотрен ряд способов для развертывания приложений и скриптов на вычислительных узлах.

Чтобы создать первую задачу, сделайте следующее:

1. Выберите **Добавить**.

1. В поле **Идентификатор задачи** введите *mytask*.

1. В **командной строке** введите `cmd /c "set AZ_BATCH & timeout /t 90 > NUL"`. Оставьте значения по умолчанию для остальных параметров и нажмите кнопку **Отправить**.

После создания задачи пакетная служба помещает ее в очередь для запуска в пуле. Если узел доступен для запуска, задание выполняется.

Чтобы создать вторую задачу, повторите описанные выше действия. Введите другой **идентификатор задачи**, но укажите ту же командную строку. Если первая задача по-прежнему выполняется, пакетная служба выполняет вторую задачу на другом узле в пуле.

## <a name="view-task-output"></a>Просмотр выходных данных задачи

Созданные вами примеры задач будут выполнены в течение нескольких минут. Чтобы просмотреть выходные данные завершенной задачи, выберите ее, а затем нажмите **Файлы на узле**. Выберите файл `stdout.txt`, чтобы просмотреть стандартные выходные данные задачи. Его содержимое должно выглядеть следующим образом:

:::image type="content" source="media/quick-create-portal/task-output.png" alt-text="Снимок экрана, на котором показаны выходные данные завершенной задачи.":::

В этом файле содержатся сведения о переменных среды пакетной службы, установленных на узле. При создании пакетных заданий и задач вы можете ссылаться на них в командных строках задач, а также в приложениях и скриптах, запускаемых этими командными строками.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы хотите продолжить изучение примеров и руководств по пакетной службе, используйте учетную запись пакетной службы и связанную учетную запись хранения, созданную при выполнении инструкций в этом кратком руководстве. Плата за использование самой пакетной службы не взимается.

Но если во время работы узлов используется пул, плата взимается даже если задания не запланированы. Если вы больше не будете использовать пул, удалите его. В представлении учетной записи выберите **Пулы**, а затем имя пула. Теперь щелкните **Удалить**.  При удалении пула удаляются все выходные данные задачи на узлах.

Ставшие ненужными группу ресурсов, учетную запись пакетной службы и все связанные ресурсы можно удалить. Для этого выберите группу ресурсов для учетной записи пакетной службы и выберите **Удалить группу ресурсов**.

## <a name="next-steps"></a>Дальнейшие действия

В этом кратком руководстве вы создали учетную запись и пул пакетной службы, а также пакетное задание. Это задание запустило образцы задач, и вы просмотрели выходные данные на одном узле. Изучив основные понятия пакетной службы, вы сможете использовать ее с более реалистичными рабочими нагрузками в большем масштабе. Чтобы узнать больше о пакетной службе Azure, изучите следующие руководства.

> [!div class="nextstepaction"]
> [Руководства по пакетной службе Azure](./tutorial-parallel-dotnet.md)
