---
title: Устранение неполадок при оценке и визуализации зависимостей в службе "миграция Azure"
description: Получите справку по оценке и визуализации зависимостей в службе "миграция Azure".
author: rashi-ms
ms.author: rajosh
ms.manager: abhemraj
ms.topic: troubleshooting
ms.date: 01/02/2020
ms.openlocfilehash: 09fbc97b84365cc1d6d40b8e1147e1b8e951cc1f
ms.sourcegitcommit: f611b3f57027a21f7b229edf8a5b4f4c75f76331
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104780707"
---
# <a name="troubleshoot-assessmentdependency-visualization"></a>Устранение неполадок с визуализацией оценок и зависимостей

Эта статья поможет вам устранить проблемы с оценкой и визуализацией зависимостей с помощью службы ["миграция Azure": обнаружение и оценка](migrate-services-overview.md#azure-migrate-server-assessment-tool).


## <a name="assessment-readiness-issues"></a>Проблемы готовности к оценке

Устраните проблемы готовности к оценке, как показано ниже.

**Проблема** | **Исправление**
--- | ---
Неподдерживаемый тип загрузки | Azure не поддерживает виртуальные машины с типом загрузки EFI. Перед выполнением миграции рекомендуется преобразовать тип загрузки в BIOS. <br/><br/>Миграцию таких виртуальных машин можно выполнить с помощью миграции сервера Azure Migration. Во время миграции тип загрузки виртуальной машины будет преобразован в BIOS.
Условно поддерживаемая операционная система Windows | Операционная система прошла дату окончания поддержки, и для [поддержки в Azure](/troubleshoot/azure/virtual-machines/server-software-support)требуется специальное соглашение о поддержке (CSA). Перед миграцией в Azure рассмотрите возможность обновления. Ознакомьтесь со сведениями о [подготовке серверов под Windows Server 2003](prepare-windows-server-2003-migration.md) для миграции в Azure.
Неподдерживаемая операционная система Windows | Azure поддерживает только [Выбранные версии ОС Windows](/troubleshoot/azure/virtual-machines/server-software-support). Рекомендуется обновить сервер перед миграцией в Azure.
Условно поддерживаемая ОС Linux | Azure подтверждает только [Выбранные версии ОС Linux](../virtual-machines/linux/endorsed-distros.md). Рекомендуется обновить сервер перед миграцией в Azure. Дополнительные сведения см. [здесь](#linux-vms-are-conditionally-ready-in-an-azure-vm-assessment) .
Неподдерживаемая ОС Linux | Сервер может запускаться в Azure, но Azure не поддерживает операционные системы. Перед миграцией в Azure рассмотрите возможность обновления до рекомендованной [версии Linux](../virtual-machines/linux/endorsed-distros.md) .
Неизвестная операционная система | Операционная система виртуальной машины была указана в vCenter Server как "другая". Это поведение блокирует миграцию Azure для проверки готовности виртуальной машины к работе в Azure. Перед переносом сервера убедитесь, что операционная система [поддерживается](./migrate-support-matrix-vmware-migration.md#azure-vm-requirements) Azure.
Неподдерживаемая разрядная версия | Виртуальные машины с 32-разрядными операционными системами могут загружаться в Azure, но перед миграцией в Azure рекомендуется выполнить обновление до 64-разрядной версии.
Требуется подписка Microsoft Visual Studio | Сервер работает под управлением клиентской операционной системы Windows, которая поддерживается только в рамках подписки Visual Studio.
Не найдена виртуальная машина для требуемой производительности хранилища | Производительность хранилища (количество операций ввода-вывода в секунду, пропускная способность), необходимая для сервера, превышает поддержку виртуальной машины Azure. Сократите требования к хранилищу для сервера перед миграцией.
Не найдена виртуальная машина для требуемой производительности сети | Производительность сети (в/с), необходимая для сервера, превышает поддержку виртуальных машин Azure. Сократите требования к сети для сервера.
Виртуальная машина не найдена в указанном расположении | Используйте другое целевое расположение, прежде чем выполнять миграцию.
Один или несколько несоответствующих дисков | Один или несколько дисков, подключенных к виртуальной машине, не соответствуют требованиям Azure. Конкретного<br/><br/> Служба "миграция Azure". сейчас обнаружение и оценка не поддерживают SSD (цен. категория "Ультра") диски и оценивают диски в соответствии с ограничениями дисков для управляемых дисков уровня "Премиум" (32 ТБ).<br/><br/> Для каждого диска, подключенного к виртуальной машине, убедитесь, что размер диска составляет < 64 ТБ (поддерживается SSD (цен. категория "Ультра") дисками).<br/><br/> Если это не так, сократите размер диска перед миграцией в Azure или используйте несколько дисков в Azure и разработайте [их вместе](../virtual-machines/premium-storage-performance.md#disk-striping) , чтобы получить более высокие ограничения хранилища. Убедитесь, что производительность (операций ввода-вывода и пропускная способность), необходимая для каждого диска, поддерживается [дисками виртуальной машины под управлением](../azure-resource-manager/management/azure-subscription-service-limits.md#storage-limits)Azure.
Один или несколько неподходящих сетевых адаптеров. | Удалите неиспользуемые сетевые адаптеры с сервера перед миграцией.
Число дисков превышает ограничение | Удалите неиспользуемые диски с сервера перед миграцией.
Размер диска превышает ограничение | Служба "миграция Azure". сейчас обнаружение и оценка не поддерживают SSD (цен. категория "Ультра") диски и оценивают диски на основе ограничений по лимиту дисков уровня "Премиум" (32 ТБ).<br/><br/> Однако Azure поддерживает диски размером до 64 ТБ (поддерживается SSD (цен. категория "Ультра") дисков). Сократите диски до 64 ТБ перед миграцией или используйте несколько дисков в Azure и разработайте [их вместе](../virtual-machines/premium-storage-performance.md#disk-striping) , чтобы получить более высокие ограничения хранилища.
Диск недоступен в указанном расположении | Убедитесь, что диск доступен в целевом расположении, прежде чем выполнять миграцию.
Недоступен диск для обеспечения указанной избыточности | Диск должен использовать тип избыточности хранилища, указанный в параметрах оценки (по умолчанию — LRS).
Не удалось определить пригодность диска из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Виртуальная машина с требуемым числом ядер и объемом памяти не найдена | Azure не удалось найти подходящий тип виртуальной машины. Перед миграцией сократите объем памяти и число ядер локального сервера.
Не удалось определить пригодность виртуальной машины из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Не удалось определить пригодность для одного или нескольких дисков из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Не удалось определить пригодность для одного или нескольких сетевых адаптеров из-за внутренней ошибки | Попробуйте создать новую оценку для группы.
Не найден размер виртуальной машины для зарезервированного экземпляра валюты предложения | Сервер помечен как непригодный, так как размер виртуальной машины не был найден для выбранной комбинации RI, предложения и валюты. Измените свойства оценки, чтобы выбрать допустимые сочетания и повторно рассчитать оценку. 
Условно готовый протокол IP | Применимо только к оценкам решения Azure VMware (AVS). AVS не поддерживает IPv6-адреса в Интернете. Если сервер обнаружен с помощью IPv6, обратитесь к группе AVS, чтобы получить рекомендации по исправлению.

## <a name="suggested-migration-tool-in-import-based-avs-assessment-marked-as-unknown"></a>Предлагаемое средство миграции в оценке AVS на основе импорта помечено как неизвестное

Для серверов, импортированных с помощью CSV-файла, средство миграции по умолчанию в и оценка AVS неизвестны. Однако для серверов в среде VMware рекомендуется использовать решение гибридного облака VMware (ХККС). [Подробнее](../azure-vmware/tutorial-deploy-vmware-hcx.md)

## <a name="linux-vms-are-conditionally-ready-in-an-azure-vm-assessment"></a>Виртуальные машины Linux — "условно готовые" в оценке виртуальных машин Azure.

В случае виртуальных машин VMware и Hyper-V Оценка ВИРТУАЛЬНЫХ машин Azure помечает виртуальные машины Linux как "условно готовые" из-за известного промежутка. 

- Разрыв предотвращает обнаружение дополнительной версии ОС Linux, установленной на локальных виртуальных машинах.
- Например, для RHEL 6,10 в настоящее время оценка виртуальных машин Azure обнаруживает только RHEL 6 в качестве версии ОС. Это связано с тем, что vCenter Server AR узла Hyper-V не предоставляет версию ядра для операционных систем Linux на виртуальных машинах.
-  Поскольку Azure поддерживает только определенные версии Linux, виртуальные машины Linux в настоящее время отмечены как условно готовые к использованию в оценке виртуальных машин Azure.
- Вы можете определить, будет ли операционная система Linux, работающая на локальной виртуальной машине, одобрена в Azure, просмотрев [поддержку Linux в Azure](../virtual-machines/linux/endorsed-distros.md).
-  Убедившись в подтвержденном распространении, можно проигнорировать это предупреждение.

Этот разрыв можно устранить, включив [Обнаружение приложений](./how-to-discover-applications.md) на виртуальных машинах VMware. Оценка виртуальных машин Azure использует операционную систему, обнаруженную на виртуальной машине, с помощью указанных учетных данных гостя. Эти данные операционной системы определяют правильные сведения о ОС в случае виртуальных машин Windows и Linux.

## <a name="operating-system-version-not-available"></a>Версия операционной системы недоступна

Для физических серверов должны быть доступны дополнительные сведения о версии операционной системы. Если оно недоступно, обратитесь в служба поддержки Майкрософт. Для серверов в среде VMware служба "миграция Azure" использует сведения об операционной системе, указанные для виртуальной машины, в vCenter Server. Однако vCenter Server не предоставляет дополнительный номер версии для операционных систем. Чтобы найти дополнительный номер версии, необходимо настроить [Обнаружение приложений](./how-to-discover-applications.md). Для виртуальных машин Hyper-V обнаружение дополнительных версий операционной системы не поддерживается. 

## <a name="azure-skus-bigger-than-on-premises-in-an-azure-vm-assessment"></a>Номера SKU Azure больше, чем в локальной среде, в оценке виртуальных машин Azure.

Оценка виртуальных машин Azure может рекомендовать номера SKU виртуальных машин Azure с большим количеством ядер и памяти, чем текущее локальное выделение в зависимости от типа оценки:

- Рекомендации по SKU виртуальной машины зависят от свойств оценки.
- Это зависит от типа оценки, выполняемой при оценке виртуальной машины Azure: на *основе производительности* или *в локальной среде*.
- Для оценки на основе производительности Оценка ВИРТУАЛЬНЫХ машин Azure учитывает данные об использовании локальных виртуальных машин (ЦП, памяти, диска и использования сети), чтобы определить правильный номер SKU целевой виртуальной машины для локальных виртуальных машин. Оно также добавляет фактор комфорта при определении эффективного использования.
- Для локального изменения размера данные о производительности не учитываются, и рекомендуется использовать целевой номер SKU на основе локального выделения.

Чтобы продемонстрировать, как это может повлиять на рекомендации, давайте рассмотрим пример.

У нас есть локальная виртуальная машина с четырьмя ядрами и восемью ГБ памяти, с 50% использования ЦП и 50% использования памяти и заданным комфортным фактором 1,3.

-  Если оценка является **локальной**, то рекомендуется использовать номер SKU виртуальной машины Azure с четырьмя ядрами и 8 ГБ памяти.
- Если оценка основана на производительности, то в зависимости от эффективности использования ЦП и памяти (50% от 4 ядер * 1,3 = 2,6 ядер и 50% от 8 ГБ памяти * 1,3 = 5,3 ГБ памяти) рекомендуется использовать самый дешевый номер SKU для четырех ядер (ближайшее поддерживаемое число ядер) и восемь Гб памяти (ближайший поддерживаемый объем памяти).
- Дополнительные [сведения](concepts-assessment-calculation.md#types-of-assessments) о размере оценки.

## <a name="why-is-the-recommended-azure-disk-skus-bigger-than-on-premises-in-an-azure-vm-assessment"></a>Почему рекомендованные номера SKU дисков Azure больше, чем в локальной среде, в оценке виртуальных машин Azure?

Оценка виртуальных машин Azure может порекомендовать больший диск в зависимости от типа оценки.
- Размер диска зависит от двух свойств оценки: критериев изменения размера и типа хранилища.
- Если критерии изменения размера **основаны на производительности**, а для типа хранилища задано значение **автоматически**, значения операций ввода-вывода и пропускной способности диска учитываются при определении типа целевого диска (HDD (цен. Категория "Стандартный"), SSD (цен. Категория "Стандартный") или Premium). Рекомендуется использовать дисковый номер SKU из типа диска, и в рекомендации учитываются требования к размеру локального диска.
- Если критерии изменения размера **основаны на производительности**, а тип хранилища — **Premium**, рекомендуется использовать номер SKU диска уровня "Премиум" в Azure на основе требований к операциям ввода-вывода, пропускной способности и размеру локального диска. Та же логика используется для создания размера диска, если критерий изменения размера — **локально** , а тип хранилища — **HDD (цен. Категория "Стандартный")**, **SSD (цен. Категория "Стандартный")** или **Premium**.

Например, если у вас есть локальный диск с 32 ГБ памяти, но агрегированные операции чтения и записи для диска имеют 800 операций ввода-вывода, то Azure VM предлагает диск уровня "Премиум" (из-за более высоких требований к операциям ввода-вывода), а затем рекомендует номер SKU диска, поддерживающий требуемые операции ввода-вывода и размер. Наиболее подходящий вариант в этом примере будет P15 (256 ГБ и 1100 операций ввода-вывода). Несмотря на то, что размер, необходимый для локального диска, составляет 32 ГБ, оценка виртуальной машины Azure рекомендует диск большего размера из-за высокого требования к операции ввода-вывода в секунду для локального диска.

## <a name="why-is-performance-data-missing-for-someall-vms-in-my-assessment-report"></a>Почему в отчете об оценке отсутствуют данные производительности для некоторых или всех виртуальных машин?

Если устройство службы "Миграция Azure" не может собрать данные производительности для локальных виртуальных машин, для оценки на основе производительности в экспорте отчета об оценке будет присутствовать запись PercentageOfCoresUtilizedMissing или PercentageOfMemoryUtilizedMissing. Необходимо, чтобы:

- Виртуальные машины были включены на период времени, для которого создается оценка.
- Если вы оцениваете виртуальные машины Hyper-V и для них нет только показателей счетчиков памяти, проверьте, включена ли на этих машинах динамическая память. Сейчас есть известная проблема, из-за которой устройство службы "Миграция Azure" не может собирать данные об использовании памяти для таких виртуальных машин.
- Если все счетчики производительности отсутствуют, убедитесь, что выполнены требования к доступу к портам для оценки. Дополнительные сведения о требованиях к доступу к портам для [VMware](./migrate-support-matrix-vmware.md#port-access-requirements), [Hyper-V](./migrate-support-matrix-hyper-v.md#port-access) и [физической](./migrate-support-matrix-physical.md#port-access) оценке.
Примечание. Если отсутствуют какие-либо счетчики производительности, служба "миграция Azure" переходит к выделенным ядрам и памяти в локальной среде, а также рекомендует размер виртуальной машины соответствующим образом.

## <a name="why-is-performance-data-missing-for-someall-servers-in-my-azure-vm-andor-avs-assessment-report"></a>Почему отсутствуют данные о производительности для некоторых или всех серверов в отчете об оценке виртуальных машин Azure и (или) AVS?

Для оценки "на основе производительности" при экспорте отчета об оценке указывается "Перцентажеофкоресутилизедмиссинг" или "Перцентажеофмеморютилизедмиссинг", когда устройству миграции Azure не удается выполнить репликацию данных о производительности для локальных серверов. Необходимо, чтобы:

- Если серверы включены в течение периода, для которого создается Оценка
- Если отсутствуют только счетчики памяти и вы пытаетесь оценить серверы в среде Hyper-V. В этом сценарии включите динамическую память на серверах и повторно Вычислите оценку, чтобы отразить последние изменения. Устройство может получать значения использования памяти для серверов в среде Hyper-V только в том случае, если на сервере включена динамическая память.

- Если все счетчики производительности отсутствуют, убедитесь, что исходящие подключения через порты 443 (HTTPS) разрешены.

    > [!Note]
    > Если какой-либо из счетчиков производительности отсутствует, служба "миграция Azure" переходит к выделенным ядрам и памяти в локальной среде, а также рекомендует размер виртуальной машины соответствующим образом.


## <a name="why-is-performance-data-missing-for-someall-sql-instancesdatabases-in-my-azure-sql-assessment"></a>Почему в оценке Azure SQL отсутствуют данные о производительности для некоторых или всех экземпляров или баз данных SQL?

Чтобы обеспечить сбор данных о производительности, проверьте следующее:

- Если серверы SQL Server включены в течение времени, в течение которого создается Оценка
- Если состояние подключения агента SQL в службе "миграция Azure" — "подключено", проверьте последний пульс. 
- Если состояние подключения "миграция Azure" для всех экземпляров SQL — "Connected" (подключено) в колонке обнаруженный экземпляр SQL Server
- Если все счетчики производительности отсутствуют, убедитесь, что исходящие подключения через порты 443 (HTTPS) разрешены.

Если какой-либо из счетчиков производительности отсутствует, оценка Azure SQL рекомендует минимальную конфигурацию SQL Azure для этого экземпляра или базы данных.

## <a name="why-is-the-confidence-rating-of-my-assessment-low"></a>Почему оценка имеет низкий рейтинг достоверности?

Оценка достоверности вычисляется для оценки на основе производительности, основываясь на проценте [доступных точек данных](./concepts-assessment-calculation.md#ratings), необходимых для вычисления оценки. Ниже приведены причины, по которым мог быть получен низкий рейтинг достоверности.

- Среда не была профилирована на период времени, для которого создается оценка. Например, если вы создаете оценку с периодом анализа производительности в одну неделю, нужно подождать как минимум неделю после запуска обнаружения для сбора всех точек данных. Если вы не можете дождаться длительности, измените длительность производительности до меньшего периода и повторите **Вычисление** оценки.
 
- Функция оценки не сможет собрать данные производительности для некоторых или всех серверов за период оценки. Для оценки высокой достоверности убедитесь, что: 
    - Серверы включены на время оценки
    - Исходящие подключения к портам 443 разрешены
    - Для серверов Hyper-V включена динамическая память 
    - Состояние подключения агентов в службе "миграция Azure" — "подключено" и проверьте последний пульс.
    - Для оценки Azure SQL состояние подключения к службе "миграция Azure" для всех экземпляров SQL — "подключено" в колонке "обнаруженный экземпляр SQL".

    **Пересчитайте** оценку, чтобы отразить последние изменения оценки достоверности.

- Для оценок виртуальных машин Azure и AVS было создано несколько серверов после начала обнаружения. Например, если вы создаете оценку для журнала производительности за последний месяц, но несколько серверов были созданы в среде только неделю назад. В этом случае данные о производительности для новых серверов будут недоступны для всей продолжительности, а Оценка достоверности будет низкой. [Дополнительные сведения](./concepts-assessment-calculation.md#confidence-ratings-performance-based)

- При оценке SQL Azure некоторые экземпляры или базы данных SQL были созданы после начала обнаружения. Например, если вы создаете оценку для журнала производительности за последний месяц, но несколько экземпляров или баз данных SQL были созданы в среде только неделю назад. В этом случае данные о производительности для новых серверов будут недоступны для всей продолжительности, а Оценка достоверности будет низкой. [Дополнительные сведения](./concepts-azure-sql-assessment-calculation.md#confidence-ratings)

## <a name="is-the-operating-system-license-included-in-an-azure-vm-assessment"></a>Включена ли лицензия операционной системы в оценку виртуальной машины Azure?

Оценка виртуальных машин Azure в настоящее время учитывает затраты на лицензии операционной системы только для серверов Windows. Затраты на лицензии для серверов Linux в настоящее время не рассматриваются.

## <a name="how-does-performance-based-sizing-work-in-an-azure-vm-assessment"></a>Как работает масштабирование на основе производительности в оценке виртуальных машин Azure?

Оценка виртуальных машин Azure непрерывно собирает данные о производительности локальных серверов и использует их для рекомендуемого номера SKU виртуальной машины и номера SKU диска в Azure. [Узнайте, как](concepts-assessment-calculation.md#calculate-sizing-performance-based) собираются данные на основе производительности.

## <a name="why-is-my-assessment-showing-a-warning-that-it-was-created-with-an-invalid-combination-of-reserved-instances-vm-uptime-and-discount-"></a>Почему моя оценка отображает предупреждение о том, что она была создана с недопустимым сочетанием зарезервированных экземпляров, времени доступности и скидки виртуальной машины (%)?
При выборе "зарезервированные экземпляры" скидка (%) и свойства "время работы виртуальной машины" неприменимы. При создании оценки с недопустимым сочетанием этих свойств кнопки "Изменить" и "повторное вычисление" отключаются. Создайте новую оценку. [Подробнее.](./concepts-assessment-calculation.md#whats-an-assessment)

## <a name="i-do-not-see-performance-data-for-some-network-adapters-on-my-physical-servers"></a>Я не вижу данные производительности для некоторых сетевых адаптеров на моих физических серверах

Это может произойти, если на физическом сервере включена виртуализация Hyper-V. На этих серверах из-за разрыва продукта служба "миграция Azure" в настоящее время обнаруживает как физические, так и виртуальные сетевые адаптеры. Пропускная способность сети захватывается только для обнаруженных виртуальных сетевых адаптеров.

## <a name="recommended-azure-vm-sku-for-my-physical-server-is-oversized"></a>Размер SKU виртуальной машины Azure, рекомендуемый для физического сервера, слишком изменен

Это может произойти, если на физическом сервере включена виртуализация Hyper-V. На этих серверах сейчас служба "миграция Azure" обнаруживает как физические, так и виртуальные сетевые адаптеры. Следовательно, нет. обнаруженных сетевых адаптеров выше фактического. Так как оценка виртуальных машин Azure выбирает виртуальную машину Azure, которая может поддерживать необходимое количество сетевых адаптеров, это может привести к созданию виртуальной машины с повышенным размером. [Узнайте больше](./concepts-assessment-calculation.md#calculating-sizing) о влиянии этого отсутствия. сетевых адаптеров при изменении размера. Это разрыв продукта, который будет рассмотрен в дальнейшем.

## <a name="readiness-category-not-ready-for-my-physical-server"></a>Категория готовности "не готова" для физического сервера

Категория готовности может быть неправильно помечена как "неготовая" в случае физического сервера с включенной виртуализацией Hyper-V. На этих серверах из-за разрыва продукта служба "миграция Azure" в настоящее время обнаруживает как физические, так и виртуальные адаптеры. Следовательно, нет. обнаруженных сетевых адаптеров выше фактического. Как в локальной, так и на основе оценки производительности, оценка виртуальных машин Azure выбирает виртуальную машину Azure, которая может поддерживать необходимое количество сетевых адаптеров. Если количество сетевых адаптеров превышает 32, максимальное значение — No. Сетевых адаптеров, поддерживаемых на виртуальных машинах Azure, сервер будет помечен как "не готов".  [Узнайте больше](./concepts-assessment-calculation.md#calculating-sizing) о влиянии этого отсутствия. Сетевых карт при изменении размера.


## <a name="number-of-discovered-nics-higher-than-actual-for-physical-servers"></a>Число обнаруженных сетевых карт выше, чем фактически для физических серверов

Это может произойти, если на физическом сервере включена виртуализация Hyper-V. На этих серверах сейчас служба "миграция Azure" обнаруживает как физические, так и виртуальные адаптеры. Следовательно, нет. обнаруженных сетевых адаптеров выше, чем фактически.

## <a name="dependency-visualization-in-azure-government"></a>Визуализация зависимостей в Azure для государственных организаций

Анализ зависимостей на основе агента не поддерживается в Azure для государственных организаций. Используйте анализ зависимостей без агента.


## <a name="dependencies-dont-show-after-agent-install"></a>Зависимости не отображаются после установки агента

После установки агентов визуализации зависимостей на локальных виртуальных машинах для отображения зависимостей на портале Служба "миграция Azure" обычно занимает 15-30 минут. Если вы ожидали более 30 минут, убедитесь, что Microsoft Monitoring Agent (MMA) может подключаться к рабочей области Log Analytics.

Для виртуальных машин Windows:
1. На панели управления запустите MMA.
2. В **свойствах Microsoft Monitoring Agent**  >  **Azure log Analytics (OMS)** убедитесь, что **состояние** рабочей области — зеленый.
3. Если состояние не является зеленым, попробуйте удалить рабочую область и добавить ее снова в MMA.

    ![Состояние MMA](./media/troubleshoot-assessment/mma-properties.png)

Для виртуальных машин Linux убедитесь, что команды установки для MMA и агент зависимостей были успешной. Дополнительные рекомендации по устранению неполадок см. [здесь](../azure-monitor/vm/service-map.md#post-installation-issues).

## <a name="supported-operating-systems"></a>Поддерживаемые операционные системы

- **MMS Agent**: Ознакомьтесь с поддерживаемыми операционными системами [Windows](../azure-monitor/agents/agents-overview.md#supported-operating-systems)и [Linux](../azure-monitor/agents/agents-overview.md#supported-operating-systems) .
- **Агент зависимостей**. Поддерживаемые операционные системы [Windows и Linux](../azure-monitor/vm/vminsights-enable-overview.md#supported-operating-systems) .

## <a name="visualize-dependencies-for--1-hour"></a>Визуализировать зависимости для > 1 час

С помощью анализа зависимостей без агента можно визуализировать зависимости или экспортировать их на карте в течение 30 дней.

При анализе зависимостей на основе агента, хотя служба "миграция Azure" позволяет вернуться к определенной дате в прошлом месяце, максимальная продолжительность, для которой можно визуализировать зависимости, составляет один час. Например, можно использовать функцию длительности времени в сопоставлении зависимостей для просмотра зависимостей за вчерашний период, но их можно просмотреть только в течение одного часа. Однако можно использовать журналы Azure Monitor для [запроса данных зависимости](./how-to-create-group-machine-dependencies.md) в течение более длительного времени.

## <a name="visualized-dependencies-for--10-servers"></a>Наглядные зависимости для > 10 серверов

В службе "миграция Azure" с помощью анализа зависимостей на основе агентов можно [визуализировать зависимости для групп](./how-to-create-a-group.md#refine-a-group-with-dependency-mapping) с 10 виртуальными машинами. Для более крупных групп рекомендуется разделить виртуальные машины на более мелкие группы, чтобы визуализировать зависимости.


## <a name="servers-show-install-agent"></a>Серверы отображают "установить агент"

После миграции серверов с включенной визуализацией зависимостей в Azure серверы могут отобразить действие "установить агент" вместо "Просмотр зависимостей" из-за следующего поведения:

- После миграции в Azure локальные серверы отключаются, а аналогичные виртуальные машины загружаются в Azure. Эти серверы получают другой MAC-адрес.
- Серверы могут также иметь разные IP-адреса в зависимости от того, был ли сохранен локальный IP-адрес.
- Если MAC и IP-адреса отличаются от локальных, служба "миграция Azure" не связывает локальные серверы с данными зависимостей Сопоставление служб. В этом случае будет показан параметр для установки агента, а не для просмотра зависимостей.
- После выполнения тестовой миграции в Azure локальные серверы остаются включенными, как и ожидалось. Аналогичные серверы запрашиваются в Azure для получения другого MAC-адреса и могут получать разные IP адреса. Если вы не блокируете исходящий трафик журнала Azure Monitor с этих серверов, служба "миграция Azure" не будет связывать локальные серверы с данными зависимостей Сопоставление служб, поэтому в этом случае будет показан параметр установки агентов, а не для просмотра зависимостей.

## <a name="dependencies-export-csv-shows-unknown-process"></a>Экспорт зависимостей CSV показывает "Неизвестный процесс"
В режиме безагентного анализа зависимостей имена процессов записываются на основе наилучшего решения. В некоторых сценариях, несмотря на то, что имена исходного и целевого серверов и порт назначения фиксируются, невозможно определить имена процессов на обоих концах зависимости. В таких случаях процесс помечается как "Неизвестный процесс".

## <a name="my-log-analytics-workspace-is-not-listed-when-trying-to-configure-the-workspace-in-azure-migrate"></a>Рабочая область "Моя Log Analytics" не отображается при попытке настроить рабочую область в службе "миграция Azure"
Сейчас Миграция Azure поддерживает создание рабочей области OMS в регионах "Восточная часть США", "Юго-Восточная Азия" и "Западная Европа". Если Рабочая область создана за пределами службы "миграция Azure" в любом другом регионе, она сейчас не может быть связана с проектом "миграция Azure".


## <a name="capture-network-traffic"></a>Запись сетевого трафика

Собирайте журналы сетевого трафика следующим образом:

1. Войдите на [портал Azure](https://portal.azure.com).
2. Нажмите клавишу F12, чтобы запустить Средства для разработчиков. При необходимости снимите флажок  **Очистить записи в** параметрах навигации.
3. Перейдите на вкладку **сеть** и запустите запись сетевого трафика.
   - В Chrome установите флажок **Preserve log** (Сохранить журнал). Запись должна начаться автоматически. Красный кружок означает, что трафик перехватывается. Если красный круг не отображается, выберите черный круг для начала.
   - В Microsoft ребр и Internet Explorer запись должна запускаться автоматически. Если это не так, нажмите зеленую кнопку воспроизведения.
4. Попробуйте воспроизвести ошибку.
5. Если при записи возникла ошибка, остановите запись и сохраните копию записанных действий.
   - В Chrome щелкните правой кнопкой мыши и выберите **Сохранить как HAR с содержимым**. Это действие сжимает и экспортирует журналы как HAR-файл.
   - В Microsoft ребр или Internet Explorer выберите параметр **экспортировать захваченный трафик** . Это действие сжимает и экспортирует журнал.
6. Перейдите на вкладку **консоль** , чтобы проверить наличие предупреждений или ошибок. Чтобы сохранить журнал консоли, сделайте следующее.
   - В Chrome щелкните правой кнопкой мыши в любом месте в журнале консоли. Выберите **Сохранить как**, экспорт и заархивировать журнал.
   - В Microsoft ребр или Internet Explorer щелкните ошибки правой кнопкой мыши и выберите команду **Копировать все**.
7. Закройте средства для разработчиков.


## <a name="where-is-the-operating-system-data-in-my-assessment-discovered-from"></a>Где находятся данные операционной системы в процессе оценки?

- Для виртуальных машин VMware по умолчанию это данные операционной системы, предоставляемые vCenter. 
   - Для виртуальных машин VMware Linux, если обнаружение приложений включено, сведения о ОС будут получены с гостевой виртуальной машины. Чтобы узнать, какие сведения о ОС необходимо оценить, перейдите к представлению обнаруженные серверы и наведите указатель мыши на значение в столбце "операционная система". В появившемся тексте появится возможность узнать, собираются ли данные ОС с сервера vCenter или с гостевой виртуальной машины, используя учетные данные виртуальной машины. 
   - Для виртуальных машин Windows сведения об операционной системе всегда извлекаться из vCenter Server.
- Для виртуальных машин Hyper-V данные операционной системы собираются с узла Hyper-V.
- Для физических серверов он извлекается с сервера.

## <a name="next-steps"></a>Следующие шаги

[Создание](how-to-create-assessment.md) или [Настройка](how-to-modify-assessment.md) оценки.