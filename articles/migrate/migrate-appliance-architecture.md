---
title: Архитектура устройства службы "Миграция Azure"
description: Содержит общие сведения об устройстве миграции Azure, используемом при обнаружении, оценке и миграции сервера.
author: vineetvikram
ms.author: vivikram
ms.manager: abhemraj
ms.topic: conceptual
ms.date: 03/18/2021
ms.openlocfilehash: f3a94576ef58eabf9d747c6e6c3a6372569d4cf1
ms.sourcegitcommit: f611b3f57027a21f7b229edf8a5b4f4c75f76331
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104785246"
---
# <a name="azure-migrate-appliance-architecture"></a>Архитектура устройства службы "Миграция Azure"

В этой статье описывается архитектура и процессы устройства "миграция Azure". Устройство миграции Azure — это упрощенное устройство, которое развертывается локально, чтобы обнаружить серверы для миграции в Azure.

## <a name="deployment-scenarios"></a>Сценарии развертывания

Устройство Миграции Azure используется в приведенных ниже сценариях.

**Сценарий** | **Инструмент** | **Используется для**
--- | --- | ---
**Обнаружение и оценка серверов, работающих в среде VMware** | Служба "миграция Azure": обнаружение и оценка | Обнаружение серверов, работающих в среде VMware<br/><br/> Выполняет обнаружение установленного программного обеспечения, анализ зависимостей без агента и обнаружение экземпляров и баз данных SQL Server.<br/><br/> Получение метаданных конфигурации сервера и производительности для оценки.
**Миграция серверов, работающих в среде VMware без агента** | Миграция Azure: миграция серверов | Обнаружение серверов, работающих в среде VMware.<br/><br/> Репликация серверов без установки агентов.
**Обнаружение и оценка серверов, работающих в среде Hyper-V** | Служба "миграция Azure": обнаружение и оценка | Обнаружение серверов, работающих в среде Hyper-V.<br/><br/> Получение метаданных конфигурации сервера и производительности для оценки.
**Обнаружение и оценка физических или виртуализованных серверов в локальной среде** |  Служба "миграция Azure": обнаружение и оценка |  Обнаружение физических или виртуализованных серверов в локальной среде.<br/><br/> Получение метаданных конфигурации сервера и производительности для оценки.

## <a name="deployment-methods"></a>Методы развертывания

Устройство можно развернуть с помощью нескольких методов.

- Устройство можно развернуть с помощью шаблона для серверов, работающих в среде VMware или Hyper-V ([шаблон OVA для VMware](how-to-set-up-appliance-vmware.md) или [VHD для Hyper-v](how-to-set-up-appliance-hyper-v.md)).
- Если вы не хотите использовать шаблон, можно развернуть устройство для среды VMware или Hyper-V с помощью [скрипта установщика PowerShell](deploy-appliance-script.md).
- В Azure для государственных организаций необходимо развернуть устройство с помощью скрипта установщика PowerShell. Инструкции по развертыванию см. [здесь](deploy-appliance-script-government.md).
- Для физических или виртуализованных серверов в локальной среде или любом другом облаке устройство всегда развертывается с помощью скрипта установщика PowerShell. Инструкции по развертыванию см. [здесь](how-to-set-up-appliance-physical.md).
- Ссылки для скачивания доступны в таблицах ниже.

## <a name="appliance-services"></a>Службы устройств

Устройство имеет следующие службы:

- **Диспетчер конфигурации устройств**: это веб-приложение, которое можно настроить с помощью сведений об источнике, чтобы начать обнаружение и оценку серверов. 
- **Агент обнаружения**. агент собирает метаданные конфигурации сервера, которые можно использовать для создания локальных оценок.
- **Агент оценки**. агент собирает метаданные производительности сервера, которые можно использовать для создания оценок на основе производительности.
- **Служба автоматического обновления**. служба хранит все агенты, выполняющиеся на устройстве, в актуальном состоянии. Он автоматически выполняется каждые 24 часа.
- **Агент DRA**: управляет репликацией сервера и координирует взаимодействие между реплицированными серверами и Azure. Используется только при репликации серверов в Azure с помощью миграции без агента.
- **Шлюз**. Отправляет реплицированные данные в Azure. Используется только при репликации серверов в Azure с помощью миграции без агента.
- **Агент обнаружения и оценки SQL**: отправляет метаданные конфигурации и производительности SQL Server экземпляров и баз данных в Azure.

> [!Note]
> Последние 3 службы доступны только в устройстве, используемом для обнаружения и оценки серверов, работающих в среде VMware.<br/> Возможности обнаружения и оценки экземпляров и баз данных SQL Server, работающих в среде VMware, сейчас предоставляются в предварительной версии. Чтобы опробовать эту функцию, воспользуйтесь [**этой ссылкой**](https://aka.ms/AzureMigrate/SQL) для создания проекта в регионе **Восточная Австралия**. Если у вас уже есть проект в регионе "Восточная Австралия" и вы хотите опробовать эту функцию, убедитесь, что вы выполнили [**эти предварительные требования**](how-to-discover-sql-existing-project.md) на портале.

## <a name="discovery-and-collection-process"></a>Процесс обнаружения и сбора

:::image type="content" source="./media/migrate-appliance-architecture/architecture1.png" alt-text="Архитектура устройства":::

Устройство взаимодействует с источниками обнаружения, используя следующий процесс.

**Процесс** | **Устройство VMware** | **Устройство Hyper-V** | **Физическое устройство**
---|---|---|---
**Начать обнаружение** | По умолчанию устройство обменивается данными с сервером vCenter через TCP-порт 443. Если сервер vCenter Server прослушивает другой порт, его можно настроить в диспетчере конфигурации устройства. | Устройство взаимодействует с узлами Hyper-V на порте WinRM 5985 (HTTP). | Устройство взаимодействует с серверами Windows через порт WinRM 5985 (HTTP) с серверами Linux через порт 22 (TCP).
**Сбор метаданных конфигурации и производительности** | Устройство собирает метаданные серверов, работающих на vCenter Server с помощью API-интерфейсов vSphere, подключаясь через порт 443 (порт по умолчанию) или любой другой порт vCenter Server прослушивается. | Устройство собирает метаданные серверов, работающих на узлах Hyper-V, с помощью сеанса модель CIM (CIM) с узлами по порту 5985.| Устройство собирает метаданные с серверов Windows, используя сеансы модель CIM (CIM) с серверами через порт 5985 и с серверов Linux, используя подключение SSH через порт 22.
**Отправка данных обнаружения** | Устройство отправляет собранные данные в службу "миграция Azure": обнаружение и оценка и миграция Azure: миграция сервера через SSL-порт 443.<br/><br/> Устройство может подключаться к Azure через Интернет или через ExpressRoute (требуется пиринг Майкрософт). | Устройство отправляет собранные данные в службу "миграция Azure": обнаружение и оценка через порт SSL 443.<br/><br/> Устройство может подключаться к Azure через Интернет или через ExpressRoute (требуется пиринг Майкрософт).| Устройство отправляет собранные данные в службу "миграция Azure": обнаружение и оценка через порт SSL 443.<br/><br/> Устройство может подключаться к Azure через Интернет или через ExpressRoute (требуется пиринг Майкрософт).
**Частота сбора данных** | Метаданные конфигурации собираются и отправляются каждые 30 минут. <br/><br/> Метаданные производительности собираются каждые 20 секунд и объединяются для отправки точки данных в Azure каждые 10 минут. <br/><br/> Данные инвентаризации программного обеспечения отправляются в Azure каждые 12 часов. <br/><br/> Данные зависимостей без агента собираются каждые 5 минут, объединяются на устройстве и отправляются в Azure каждые 6 часов. <br/><br/> Данные конфигурации SQL Server обновляются каждые 24 часа, а данные о производительности фиксируются каждые 30 секунд.| Метаданные конфигурации собираются и отправляются каждые 30 минут. <br/><br/> Метаданные производительности собираются каждые 30 секунд и объединяются для отправки точки данных в Azure каждые 10 минут.|  Метаданные конфигурации собираются и отправляются каждые 30 минут. <br/><br/> Метаданные производительности собираются каждые 5 минут и объединяются для отправки точки данных в Azure каждые 10 минут.
**Оценка и миграция** | Вы можете создавать оценки на основе метаданных, собранных устройством с помощью средства "миграция Azure": средство обнаружения и оценки.<br/><br/>Кроме того, можно также начать миграцию серверов, запущенных в среде VMware, с помощью средства миграции Azure: средство переноса сервера для управления репликацией серверов без агента.| Вы можете создавать оценки на основе метаданных, собранных устройством с помощью средства "миграция Azure": средство обнаружения и оценки. | Вы можете создавать оценки на основе метаданных, собранных устройством с помощью средства "миграция Azure": средство обнаружения и оценки.

## <a name="next-steps"></a>Следующие шаги

[Ознакомьтесь](migrate-appliance.md) с матрицей поддержки устройств.