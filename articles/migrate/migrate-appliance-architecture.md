---
title: Архитектура устройства службы "Миграция Azure"
description: Общие сведения об устройстве Миграции Azure, используемом для оценки и миграции серверов.
author: vikram1988
ms.author: vibansa
ms.manager: abhemraj
ms.topic: conceptual
ms.date: 06/09/2020
ms.openlocfilehash: 9a7a3a603944970a5e78a24ca4042f97b1c43fcc
ms.sourcegitcommit: f3ec73fb5f8de72fe483995bd4bbad9b74a9cc9f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2021
ms.locfileid: "102047865"
---
# <a name="azure-migrate-appliance-architecture"></a>Архитектура устройства службы "Миграция Azure"

В этой статье описывается архитектура и процессы устройства "миграция Azure". Устройство миграции Azure — это упрощенное устройство, которое развертывается локально, чтобы обнаружить виртуальные машины и физические серверы для миграции в Azure.

## <a name="deployment-scenarios"></a>Сценарии развертывания

Устройство Миграции Azure используется в приведенных ниже сценариях.

**Сценарий** | **Инструмент** | **Используется для** 
--- | --- | ---
**Обнаружение и оценка серверов, работающих в среде VMware** | Миграция Azure: оценка серверов | Обнаружение серверов, работающих в среде VMware<br/><br/> Выполняет обнаружение установленных приложений, анализ зависимостей без агента и обнаружение экземпляров и баз данных SQL Server.<br/><br/> Получение метаданных конфигурации сервера и производительности для оценки.
**Миграция серверов, работающих в среде VMware без агента** | Миграция Azure: миграция серверов | Обнаружение серверов, работающих в среде VMware.<br/><br/> Репликация серверов без установки агентов.
**Обнаружение и оценка серверов, работающих в среде Hyper-V** | Миграция Azure: оценка серверов | Обнаружение серверов, работающих в среде Hyper-V.<br/><br/> Получение метаданных конфигурации сервера и производительности для оценки.
**Обнаружение и оценка физических или виртуализованных серверов в локальной среде** |  Миграция Azure: оценка серверов |  Обнаружение физических или виртуализованных серверов в локальной среде.<br/><br/> Получение метаданных конфигурации сервера и производительности для оценки.

## <a name="deployment-methods"></a>Методы развертывания

Устройство можно развернуть с помощью нескольких методов.

- Устройство можно развернуть с помощью шаблона для серверов, работающих в среде VMware или Hyper-V ([шаблон OVA для VMware](how-to-set-up-appliance-vmware.md) или [VHD для Hyper-v](how-to-set-up-appliance-hyper-v.md)).
- Если вы не хотите использовать шаблон, можно развернуть устройство для среды VMware или Hyper-V с помощью [скрипта установщика PowerShell](deploy-appliance-script.md).
- В Azure для государственных организаций необходимо развернуть устройство с помощью скрипта установщика PowerShell. Инструкции по развертыванию см. [здесь](deploy-appliance-script-government.md).
- Для физических или виртуализованных серверов в локальной среде или любом другом облаке устройство всегда развертывается с помощью скрипта установщика PowerShell. Инструкции по развертыванию см. [здесь](how-to-set-up-appliance-physical.md).
- Ссылки для скачивания доступны в таблицах ниже.

## <a name="appliance-services"></a>Службы устройств

Устройство имеет следующие службы:

- **Диспетчер конфигурации устройств**: это веб-приложение, которое можно настроить с помощью сведений об источнике, чтобы начать обнаружение и оценку серверов. 
- **Агент обнаружения**. агент собирает метаданные конфигурации сервера, которые можно использовать для создания локальных оценок.
- **Агент оценки**. агент собирает метаданные производительности сервера, которые можно использовать для создания оценок на основе производительности.
- **Служба автоматического обновления**. служба хранит все агенты, выполняющиеся на устройстве, в актуальном состоянии. Он автоматически выполняется каждые 24 часа.
- **Агент DRA**: управляет репликацией сервера и координирует взаимодействие между реплицированными серверами и Azure. Используется только при репликации серверов в Azure с помощью миграции без агента.
- **Шлюз**. Отправляет реплицированные данные в Azure. Используется только при репликации серверов в Azure с помощью миграции без агента.
- **Агент обнаружения и оценки SQL**: отправляет метаданные конфигурации и производительности SQL Server экземпляров и баз данных в Azure.

> [!Note]
> Последние 3 службы доступны только в устройстве, используемом для обнаружения и оценки серверов, работающих в среде VMware.<br/> Обнаружение и оценка SQL Server экземпляров и баз данных, работающих в среде VMware, теперь находится на этапе предварительной версии. Чтобы испытать эту функцию, используйте [**эту ссылку**](https://aka.ms/AzureMigrate/SQL) для создания проекта в **Восточная Австралияном** регионе. Если у вас уже есть проект в Восточная Австралия и вы хотите испытать эту функцию, убедитесь, что вы выполнили эти [**Предварительные требования**](how-to-discover-sql-existing-project.md) на портале.


## <a name="discovery-and-collection-process"></a>Процесс обнаружения и сбора

:::image type="content" source="./media/migrate-appliance-architecture/architecture1.png" alt-text="Архитектура устройства":::

Устройство взаимодействует с источниками обнаружения, используя следующий процесс.

**Процесс** | **Устройство VMware** | **Устройство Hyper-V** | **Физическое устройство**
---|---|---|---
**Запустить обнаружение**| По умолчанию устройство обменивается данными с сервером vCenter через TCP-порт 443. Если сервер vCenter Server прослушивает другой порт, его можно настроить в диспетчере конфигурации устройства. | Устройство взаимодействует с узлами Hyper-V на порте WinRM 5985 (HTTP). | Устройство взаимодействует с серверами Windows через порт WinRM 5985 (HTTP) с серверами Linux через порт 22 (TCP).
**Сбор метаданных конфигурации и производительности** | Устройство собирает метаданные серверов, работающих на vCenter Server с помощью API-интерфейсов vSphere, подключаясь через порт 443 (порт по умолчанию) или любой другой порт vCenter Server прослушивается. | Устройство собирает метаданные серверов, работающих на узлах Hyper-V, с помощью сеанса модель CIM (CIM) с узлами по порту 5985.| Устройство собирает метаданные с серверов Windows, используя сеансы модель CIM (CIM) с серверами через порт 5985 и с серверов Linux, используя подключение SSH через порт 22.
**Отправка данных обнаружения** | Устройство отправляет собранные данные в службу "миграция Azure": "Оценка сервера" и "миграция Azure": миграция сервера через SSL-порт 443.<br/><br/> Устройство может подключаться к Azure через Интернет или через ExpressRoute (требуется пиринг Майкрософт). | Устройство отправляет собранные данные в службу "миграция Azure": Оценка серверов через SSL-порт 443.<br/><br/> Устройство может подключаться к Azure через Интернет или через ExpressRoute (требуется пиринг Майкрософт).| Устройство отправляет собранные данные в службу "миграция Azure": Оценка серверов через SSL-порт 443.<br/><br/> Устройство может подключаться к Azure через Интернет или через ExpressRoute (требуется пиринг Майкрософт).
**Частота сбора данных** | Метаданные конфигурации собираются и отправляются каждые 30 минут. <br/><br/> Метаданные производительности собираются каждые 20 секунд и объединяются для отправки точки данных в Azure каждые 10 минут. <br/><br/> Данные инвентаризации программного обеспечения отправляются в Azure каждые 12 часов. <br/><br/> Данные зависимостей без агента собираются каждые 5 минут, объединяются на устройстве и отправляются в Azure каждые 6 часов. <br/><br/> Данные конфигурации SQL Server обновляются каждые 24 часа, а данные о производительности фиксируются каждые 30 секунд.| Метаданные конфигурации собираются и отправляются каждые 30 минут. <br/><br/> Метаданные производительности собираются каждые 30 секунд и объединяются для отправки точки данных в Azure каждые 10 минут.|  Метаданные конфигурации собираются и отправляются каждые 30 минут. <br/><br/> Метаданные производительности собираются каждые 5 минут и объединяются для отправки точки данных в Azure каждые 10 минут.
**Оценка и миграция** | Вы можете создавать оценки на основе метаданных, собранных устройством с помощью службы "миграция Azure": средство оценки серверов.<br/><br/>Кроме того, можно также начать миграцию серверов, запущенных в среде VMware, с помощью средства миграции Azure: средство переноса сервера для управления репликацией серверов без агента.| Вы можете создавать оценки на основе метаданных, собранных устройством с помощью службы "миграция Azure": средство оценки серверов. | Вы можете создавать оценки на основе метаданных, собранных устройством с помощью службы "миграция Azure": средство оценки серверов.

## <a name="next-steps"></a>Дальнейшие действия

[Ознакомьтесь](migrate-appliance.md) с матрицей поддержки устройств.