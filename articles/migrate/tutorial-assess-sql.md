---
title: Учебник по оценке экземпляров SQL для миграции в Управляемый экземпляр SQL Azure и Базу данных SQL Azure
description: Узнайте, как создать оценку для Azure SQL в службе "Миграция Azure"
author: rashi-ms
ms.author: rajosh
ms.topic: tutorial
ms.date: 02/07/2021
ms.openlocfilehash: 9b33890d53f67eee870b42462a65b4a0b7ba9981
ms.sourcegitcommit: f3ec73fb5f8de72fe483995bd4bbad9b74a9cc9f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2021
ms.locfileid: "102053708"
---
# <a name="tutorial-assess-sql-instances-for-migration-to-azure-sql"></a>Учебник по оценке готовности экземпляров SQL к переносу в Azure SQL

В рамках перехода на Azure вам нужно оценить локальные рабочие нагрузки, чтобы измерить готовность облака, определить риски и оценить затраты и сложность.
В этой статье содержатся сведения о том, как оценивать обнаруженные базы данных экземпляров SQL Server при подготовке к миграции в Azure SQL с помощью средства обнаружения и оценки службы "Миграция Azure".

> [!Note]
> Возможности обнаружения и оценки экземпляров и баз данных SQL Server, работающих в среде VMware, сейчас предоставляются в предварительной версии. Чтобы опробовать эту функцию, воспользуйтесь [**этой ссылкой**](https://aka.ms/AzureMigrate/SQL) для создания проекта в регионе **Восточная Австралия**. Если у вас уже есть проект в регионе "Восточная Австралия" и вы хотите опробовать эту функцию, убедитесь, что вы выполнили [**эти предварительные требования**](how-to-discover-sql-existing-project.md) на портале.

В этом руководстве описано следующее:

> [!div class="checklist"]
> * Запуск оценки на основе конфигурации сервера данных производительности.
> * Просмотр оценки для Azure SQL 

> [!NOTE]
> В учебниках показан самый быстрый способ выполнения сценария и используются параметры по умолчанию, где это возможно. 


## <a name="prerequisites"></a>Предварительные требования

- Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/pricing/free-trial/), прежде чем начинать работу.

- Прежде чем приступить к работе с этим учебником для оценки готовности экземпляров SQL Server к миграции в Azure SQL, необходимо обнаружить экземпляры SQL, которые требуется оценить с помощью устройства службы "Миграция Azure", [выполнив указания из этого учебника](tutorial-discover-vmware.md).

## <a name="run-an-assessment"></a>Запуск оценки
Запустите оценку следующим образом:
1. На странице **Обзор** выберите **Windows, Linux and SQL Server** (Windows, Linux и SQL Server) и выберите **Оценка и миграция серверов**.
    :::image type="content" source="./media/tutorial-assess-sql/assess-migrate.png" alt-text="Страница обзора для службы &quot;Миграция Azure&quot;":::
2. В разделе **Azure Migrate: Discovery and assessment** (Миграция Azure. Обнаружение и оценка) щелкните **Оценка** и выберите тип оценки **Azure SQL**.
    :::image type="content" source="./media/tutorial-assess-sql/assess.png" alt-text="Раскрывающийся список для выбора типа оценки Azure SQL":::
3. На странице **Оценка серверов** отображается предварительно выбранный тип оценки **Azure SQL** и источник обнаружения, который по умолчанию имеет значение **Servers discovered from Azure Migrate appliance** (Серверы, обнаруженные на устройстве службы "Миграция Azure").

4. Щелкните **Изменить**, чтобы просмотреть свойства оценки.
     :::image type="content" source="./media/tutorial-assess-sql/assess-servers-sql.png" alt-text="Кнопка &quot;Изменить&quot;, с помощью которой можно настроить свойства оценки":::
5. В разделе "Свойства оценки" выберите **Свойства целевого объекта**:
    - В поле **Целевое расположение** выберите регион Azure, в который необходимо выполнить миграцию. 
        - Рекомендации по конфигурации и стоимости Azure SQL основаны на указанном вами расположении. 
    - В разделе **Target deployment type** (Целевой тип развертывания) сделайте следующее.
        - Выберите **Рекомендуется**, если вы хотите, чтобы служба "Миграция Azure" оценила готовность экземпляров SQL к миграции в Управляемый экземпляр и Базу данных Azure SQL и рекомендовала наиболее подходящий вариант целевого развертывания, целевой уровень, конфигурацию Azure SQL и ежемесячные оценки. [Подробнее](concepts-azure-sql-assessment-calculation.md)
        - Выберите **БД SQL Azure**, если вы хотите оценить готовность экземпляров SQL к миграции только в Базы данных SQL Azure и просмотреть целевой уровень, конфигурацию Azure SQL и ежемесячные оценки.
        - Выберите **Azure SQL MI** (Управляемый экземпляр Azure SQL), если вы хотите оценить готовность экземпляров SQL к миграции только в Управляемый экземпляр SQL Azure и просмотреть целевой уровень, конфигурацию Azure SQL и ежемесячные оценки.
    - В поле **Зарезервированная емкость** укажите, следует ли использовать зарезервированную емкость для сервера SQL после миграции.
        - Если выбран параметр зарезервированной емкости, нельзя указать скидку (%).

6. В свойствах оценки выберите **критерии оценки**.
    - По умолчанию для определения размера используется критерий **На основе производительности**. Это означает, что служба "Миграция Azure" соберет метрики производительности, относящиеся к экземплярам SQL и управляемым ими базам данных, чтобы рекомендовать оптимальный размер Базы данных SQL Azure и (или) Управляемого экземпляра SQL Azure. Можно указать:
        - **Журнал производительности**. Укажите в этом поле период, данные за который должны стать основой для оценки. (Значение по умолчанию — один день.)
        - **Использование процентиля**. Укажите в этом поле значение процентиля, которое будет использоваться в качестве примера производительности. (Значение по умолчанию — 95-й процентиль.)
    - В поле **Фактор комфорта** укажите буфер, который вы хотите использовать во время оценки. Он учитывается, например, для сезонного использования и малого количества записей в журнале с потенциальным повышением в будущем. Например, если вы используете фактор комфорта "2": 
        
        **Компонент** | **Эффективное использование** | **Добавление фактора комфорта (2.0)**
        --- | --- | ---
        Ядра | 2  | 4
        Память | 8 ГБ | 16 Гб
   
7. В разделе **Цены**:
    - В поле **Offer/Licensing program** (Предложение/программа лицензирования) укажите предложение Azure, если вы зарегистрировались. В настоящее время вы можете выбрать только оплату по мере использования или разработку и тестирование с оплатой по мере использования. 
        - Применив зарезервированную емкость и Преимущество гибридного использования Azure на основе предложения с оплатой по мере использования, можно получить дополнительную скидку. 
        - Вы можете применить Преимущество гибридного использования Azure поверх предложения "Разработка и тестирование" с оплатой по мере использования. Сейчас оценка не поддерживает применение зарезервированной емкости на основе предложения "Разработка и тестирование" с оплатой по мере использования.
    - В поле **Уровень обслуживания** выберите наиболее подходящий вариант уровня служб, чтобы удовлетворить потребности вашего бизнеса при миграции в Базу данных SQL Azure и (или) Управляемый экземпляр SQL Azure. 
        - Выберите **Рекомендуется**, если вы хотите, чтобы служба "Миграция Azure" рекомендовала оптимальный уровень служб для серверов. Это может быть "Общего назначения" или "Критически важный для бизнеса". Подробнее
        - Выберите **Общего назначения**, если требуется настроить конфигурацию Azure SQL для рабочих нагрузок, ориентированных на бюджет.
        - Выберите **Критически важный для бизнеса**, если требуется настроить конфигурацию SQL Azure для рабочих нагрузок с низкой задержкой, высокой устойчивостью к сбоям и быстрой отработкой отказа.
    - В поле **Скидка (%)** добавьте все скидки, относящиеся к подписке и предоставляемые в рамках предложения Azure. Значение по умолчанию — 0 %.
    - В поле **Валюта** выберите валюту выставления счетов для своей учетной записи.
    - В поле **Преимущество гибридного использования Azure** укажите, есть ли у вас лицензия SQL Server. Если вы это сделаете и на них будет распространяться действие Software Assurance для подписок на SQL Server, вы сможете применить Преимущество гибридного использования Azure при миграции лицензий в Azure.
    - При внесении изменений нажмите кнопку Сохранить.
     :::image type="content" source="./media/tutorial-assess-sql/view-all.png" alt-text="Кнопка &quot;Сохранить&quot; в свойствах оценки":::
8. В разделе **Оценка серверов** щелкните "Далее".
9.  В разделе **Select servers to assess** (Выбор серверов для оценки) > **Имя оценки** укажите имя для оценки.
10. В разделе **Создание или выбор группы** выберите **Создать** и укажите имя группы.
     :::image type="content" source="./media/tutorial-assess-sql/assessment-add-servers.png" alt-text="Расположение кнопки &quot;Новая группа&quot;":::
11. Выберите устройство, а также серверы, которые необходимо добавить в группу. Затем нажмите кнопку "Далее".
12. На странице **Review + create assessment** (Проверка и создание оценки) проверьте сведения об оценке и щелкните Создать оценку, чтобы создать группу и запустить оценку.
     :::image type="content" source="./media/tutorial-assess-sql/assessment-create.png" alt-text="Расположение кнопки &quot;Проверка и создание оценки&quot;":::
13. После создания оценки перейдите к плитке **Windows, Linux и SQL Server** > **Azure Migrate: Discovery and assessment** (Миграция Azure: обнаружение и оценка) и щелкните номер рядом с оценкой Azure SQL.
     :::image type="content" source="./media/tutorial-assess-sql/assessment-sql-navigation.png" alt-text="Переход к созданной оценке":::
15. Щелкните имя оценки, которое вы хотите просмотреть.

> [!NOTE]
> Поскольку оценки Azure SQL выполняются на основе производительности, рекомендуется подождать по крайней мере один день после запуска обнаружения, прежде чем создавать оценку. Благодаря этому вы сможете получить данные о производительности с большей достоверностью. Если обнаружение все еще выполняется, готовность экземпляров SQL будет помечена как **Неизвестно**. В идеале после запуска обнаружения следует **дождаться заданной длительности производительности (день/неделя/месяц)** , чтобы создать или повторно выполнить оценку, обеспечивающую высокую достоверность. 

## <a name="review-an-assessment"></a>Проверка оценки

**Чтобы просмотреть оценку, сделайте следующее**.

1. Выберите **Windows, Linux и SQL Server** > **Azure Migrate: Discovery and assessment** (Миграция Azure: обнаружение и оценка) и щелкните номер рядом с оценкой Azure SQL.
2. Щелкните имя оценки, которое вы хотите просмотреть. Ниже приведен пример (расчеты и затраты указаны только для примера): :::image type="content" source="./media/tutorial-assess-sql/assessment-sql-summary.png" alt-text="Обзор оценки SQL":::
3. Проверьте сводку по оценке. Вы можете также изменить свойства оценки или выполнить ее повторно.

#### <a name="discovered-items"></a>Обнаруженные элементы

Здесь указывается количество серверов SQL Server, экземпляров и баз данных, оцененных в этой оценке.
    
#### <a name="azure-readiness"></a>Готовность к работе в Azure

Здесь указывается распределение оцененных экземпляров SQL: 
    
**Целевой тип развертывания (в свойствах оценки)** | **Готовность**   
--- | --- |
**Рекомендуемые требования** |  Готовность к работе с Базой данных SQL Azure, готовность к работе с Управляемым экземпляром SQL Azure, потенциальная готовность к работе с виртуальной машиной Azure, степень готовности к работе неизвестна (если выполняется обнаружение или возникли проблемы с обнаружением, которые требуется устранить)
**База данных SQL Azure** или **Управляемый экземпляр SQL Azure** | Готовность к работе с Базой данных SQL Azure или Управляемым экземпляром SQL Azure, неготовность к работе с Базой данных SQL Azure или Управляемым экземпляром SQL Azure, степень готовности к работе неизвестна (если выполняется обнаружение или возникли проблемы с обнаружением, которые требуется устранить)
     
Вы можете развернуть представление, чтобы просмотреть подробные сведения и предупреждения о проблемах миграции, которые можно устранить перед миграцией в Azure SQL. [Дополнительные сведения](concepts-azure-sql-assessment-calculation.md). Вы также можете ознакомиться с рекомендуемыми конфигурациями Azure SQL для миграции в базы данных SQL Azure и (или) Управляемые экземпляры.
    
#### <a name="azure-sql-database-and-managed-instance-cost-details"></a>Сведения о затратах на Базу данных SQL Azure и Управляемый экземпляр

Примерная стоимость в месяц включает в себя затраты на вычисление и хранение для конфигураций SQL Azure, соответствующих рекомендуемому типу развертывания Базы данных SQL Azure и (или) Управляемого экземпляра SQL Azure. [Подробнее](concepts-azure-sql-assessment-calculation.md#calculate-monthly-costs)


### <a name="review-readiness"></a>Готовность к рассмотрению

1. Нажмите **Azure SQL readiness** (Готовность к работе с Azure SQL).
    :::image type="content" source="./media/tutorial-assess-sql/assessment-sql-readiness.png" alt-text="Сведения о готовности к работе с Azure SQL":::
1. В разделе готовности к работе с Azure SQL проверьте **готовность к работе с Базой данных SQL Azure** и **готовность к работе с Управляемым экземпляром SQL Azure** оцененных экземпляров SQL:
    - **Готово**. Экземпляр готов к переносу в Базу данных или Управляемый экземпляр SQL Azure без каких-либо проблем или предупреждений в связи с миграцией. 
        - Готово (текст в формате гиперссылки и синий информационный значок). Экземпляр готов к переносу в Базу данных или Управляемый экземпляр SQL Azure без каких-либо проблем с миграцией, но с предупреждениями касательно миграции, с которыми необходимо ознакомиться. Щелкнув гиперссылку, можно ознакомиться с предупреждениями о миграции и рекомендациями по исправлению. :::image type="content" source="./media/tutorial-assess-sql/assess-ready.png" alt-text="Оценка с данными о состоянии готовности":::       
    - **Не готово**. У экземпляра есть одна или несколько проблем с миграцией для миграции в Базу данных или Управляемый экземпляр SQL Azure. Щелкнув гиперссылку, можно ознакомиться с проблемами миграции и рекомендациями по исправлению.
    - **Неизвестно**. Служба "Миграция Azure" не может оценить готовность, так как выполняется обнаружение или во время обнаружения возникли проблемы, которые необходимо устранить, воспользовавшись колонкой уведомлений. Если проблема будет повторяться, обратитесь в службу поддержки Майкрософт. 
1. Проверьте рекомендуемый тип развертывания для экземпляра SQL, который определяется в соответствии с таблицей ниже.

    - **Целевой тип развертывания** (выбран в свойствах оценки): **Рекомендуется**

        **Готовность к работе с базой данных SQL Azure** | **Готовность к работе с Управляемым экземпляром SQL Azure** | **Рекомендуемый тип развертывания** | **Выполнена ли оценка конфигурации и стоимости Azure SQL?**
         --- | --- | --- | --- |
        Ready | Ready | База данных или Управляемый экземпляр SQL Azure ([дополнительные сведения](concepts-azure-sql-assessment-calculation.md#recommended-deployment-type)) | Да
        Ready | Не готово или неизвестно | БД SQL Azure | Да
        Не готово или неизвестно | Ready | Управляемый экземпляр SQL Azure | Да
        Не готов | Не готов | Потенциально готово к работе с виртуальной машиной Azure ([дополнительные сведения](concepts-azure-sql-assessment-calculation.md#potentially-ready-for-azure-vm)) | Нет
        Не готово или неизвестно | Не готово или неизвестно | Неизвестно | Нет
    
    - **Целевой тип развертывания** (выбран в свойствах оценки): **База данных SQL Azure**
    
        **Готовность к работе с базой данных SQL Azure** | **Выполнена ли оценка конфигурации и стоимости Azure SQL?**
        --- | --- |
        Ready | Да
        Не готов | Нет
        Неизвестно | Нет
    
    - **Целевой тип развертывания** (выбран в свойствах оценки): **Управляемый экземпляр SQL Azure**
    
        **Готовность к работе с Управляемым экземпляром SQL Azure** | **Выполнена ли оценка конфигурации и стоимости Azure SQL?**
         --- | --- |
        Ready | Да
        Не готов | Нет
        Неизвестно | Нет

4. Если щелкнуть имя экземпляра, отобразятся подробные сведения, в том числе количество пользовательских баз данных, сведения об экземпляре, включая свойства экземпляра, а также данные о вычислительных ресурсах (с областью действия в пределах экземпляра) и хранилище базы данных-источника.
5. Щелкните число пользовательских баз данных, чтобы просмотреть список баз данных и сведения о них. Ниже приведет пример (расчеты и затраты указаны только для примера): :::image type="content" source="./media/tutorial-assess-sql/assessment-db.png" alt-text="Сведения об экземпляре SQL":::
5. Щелкните ссылку для просмотра сведения в столбце "Проблемы миграции", чтобы ознакомиться с проблемами миграции и предупреждениями для определенного целевого типа развертывания. 
    :::image type="content" source="./media/tutorial-assess-sql/assessment-db-issues.png" alt-text="Проблемы и предупреждения при миграции базы данных":::

### <a name="review-cost-estimates"></a>Проверка оценки стоимости
В сводке оценки отображаются оценочные ежемесячные затраты на вычисления и хранение для конфигураций Azure SQL, соответствующих рекомендуемому типу развертывания баз данных SQL Azure и (или) Управляемых экземпляров.

1. Просмотрите общую сумму ежемесячных расходов. Затраты суммируются для всех экземпляров SQL в оцениваемой группе.
    - Оценка затрат основана на рекомендуемой конфигурации Azure SQL для экземпляра. 
    - Показана расчетная месячная стоимость вычислений и хранения. В качестве примера (расчеты и затраты указаны только для примера):
    
    :::image type="content" source="./media/tutorial-assess-sql/assessment-sql-cost.png" alt-text="Сведения о затратах":::

1. Чтобы просмотреть конфигурацию Azure SQL и оценки затрат на уровне экземпляра, можно детализировать данные только на этом уровне.  
1. Если рекомендуется использовать конфигурацию Базы данных SQL Azure, для просмотра конфигурации Azure SQL и оценки затрат на базу данных можно перейти к списку баз данных.

### <a name="review-confidence-rating"></a>Просмотр рейтинга достоверности
Служба "Миграция Azure" назначает оценки достоверности всем оценкам Azure SQL на основе доступности точек данных о производительности и использовании, необходимых для вычисления оценки по всем экземплярам и базам данных SQL. Оценка — от одной звезды (самая низкая) до пяти звезд (самая высокая).
Оценка достоверности помогает определить надежность рекомендаций по выбору размера в оценке. Ниже приведены оценки достоверности.

**Доступность точки данных** | **Оценка достоверности**
--- | ---
0–20 % | 1 звезда
21–40 % | 2 звезды
41–60 % | 3 звезды
61–80 % | 4 звезды
81–100 % | 5 звезд

[Подробнее](concepts-azure-sql-assessment-calculation.md#confidence-ratings) о рейтингах достоверности.


## <a name="next-steps"></a>Дальнейшие действия

- [Узнайте больше](concepts-azure-sql-assessment-calculation.md) о вычислении оценок Azure SQL.
- Начните миграцию экземпляров и баз данных SQL с помощью [Azure Database Migration Service](https://docs.microsoft.com/azure/dms/dms-overview).
