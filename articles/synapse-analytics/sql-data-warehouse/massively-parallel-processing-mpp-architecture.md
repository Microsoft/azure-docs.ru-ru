---
title: Архитектура выделенного пула SQL (прежнее название — SQL DW)
description: Узнайте, как выделенный пул SQL (ранее — хранилище данных SQL) в Azure синапсе Analytics сочетает возможности обработки распределенных запросов с хранилищем Azure для достижения высокой производительности и масштабируемости.
services: synapse-analytics
author: mlee3gsd
manager: craigg
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: sql-dw
ms.date: 11/04/2019
ms.author: martinle
ms.reviewer: igorstan
ms.openlocfilehash: c537d3109f770c1ce77be6495bdacd24270dad5f
ms.sourcegitcommit: aacbf77e4e40266e497b6073679642d97d110cda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "98119600"
---
# <a name="dedicated-sql-pool-formerly-sql-dw-architecture-in-azure-synapse-analytics"></a>Архитектура выделенного пула SQL (ранее — хранилище данных SQL) в Azure синапсе Analytics

Azure Synapse Analytics — это служба аналитики, которая объединяет корпоративные хранилища данных и аналитику больших данных. Это дает возможность запрашивать данные на своих условиях.

> [!NOTE]
>Изучите [документацию по Azure Synapse Analytics](../overview-what-is.md).
>


> [!VIDEO https://www.youtube.com/embed/PlyQ8yOb8kc]

## <a name="synapse-sql-architecture-components"></a>Компоненты архитектуры Synapse SQL

[Выделенный пул SQL (ранее — хранилище данных SQL)](sql-data-warehouse-overview-what-is.md) использует архитектуру масштабирования для распределения вычислительной обработки данных между несколькими узлами. Единица масштабирования представляет собой абстракцию вычислительной мощности, известную как [единица использования хранилища данных](what-is-a-data-warehouse-unit-dwu-cdwu.md). Вычислительные ресурсы отделены от ресурсов хранилища, что дает возможность масштабировать вычислительные ресурсы независимо от данных в системе.

![Архитектура выделенного пула SQL (прежнее название — SQL DW)](./media/massively-parallel-processing-mpp-architecture/massively-parallel-processing-mpp-architecture.png)

Выделенный пул SQL (ранее — хранилище данных SQL) использует архитектуру на основе узлов. Приложения подключаются и выдают команды T-SQL управляющему узлу. Управляющий узел размещает механизм распределенных запросов, который оптимизирует запросы для параллельной обработки, а затем передает операции вычислительным узлам для параллельной работы.

Вычислительные узлы хранят все данные пользователей в службе хранилища Azure и выполняют параллельные запросы. Служба перемещения данных (DMS) представляет собой внутреннюю службу на уровне системы, которая перемещает данные между узлами, что необходимо для выполнения параллельных запросов и возвращения точных результатов.

В случае с несвязанным хранилищем и вычислением при использовании выделенного пула SQL (ранее — хранилища данных SQL) одно из следующих действий может:

- определение объема вычислительных ресурсов независимого от потребностей хранилища;
- Расширяйте или уменьшайте мощность вычислений в выделенном пуле SQL (ранее — в хранилище данных SQL), не перемещая данные.
- приостановка вычислений без изменения данных (вы платите только за хранилище);
- возобновление вычислений во время рабочих часов.

### <a name="azure-storage"></a>Хранилище Azure

Выделенный SQL пул SQL (прежнее название — хранилище данных SQL) использует службу хранилища Azure для безопасного хранения в пользовательских данные.  Так как ваши данные хранятся в службе хранилища Azure и управляются ею, предусмотрена отдельная плата за использование хранилища. Для оптимизации производительности системы данные сегментированы по **областям распределения**. При определении таблицы вы можете выбрать шаблон сегментирования, который будет использоваться для распределения данных. Поддерживаются следующие шаблоны сегментирования:

- Хэш
- Циклический перебор
- Репликация

### <a name="control-node"></a>Управляющий узел

Управляющий узел в этой архитектуре отвечает за все решения. Это внешний интерфейс, который взаимодействует со всеми приложениями и подключениями. Механизм распределенных запросов выполняется на управляющем узле для оптимизации и координации параллельных запросов. При отправке запроса T-SQL управляющий узел преобразует его в запросы, которые будут выполняться на каждом вычислительном узле в параллельном режиме.

### <a name="compute-nodes"></a>Вычислительные узлы

Вычислительные узлы обеспечивают вычислительную мощность. Чтобы выполнить обработку, дистрибутивы сопоставляются с вычислительными узлами. Когда вы оплачиваете увеличение вычислительных ресурсов, распределения повторно сопоставляются с доступными вычислительными узлами. Число вычислительных узлов колеблется от 1 до 60 и определяется уровнем обслуживания Synapse SQL.

У каждого вычислительного узла есть идентификатор узла, который видно в представлениях системы. Идентификатор вычислительного узла можно увидеть в столбце node_id в системных представлениях, имена которых начинаются с sys.pdw_nodes. Список этих системных представлений см. в разделе [СИНАПСЕ SQL System views](/sql/relational-databases/system-catalog-views/sql-data-warehouse-and-parallel-data-warehouse-catalog-views?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json&view=azure-sqldw-latest).

### <a name="data-movement-service"></a>Служба перемещения данных

Служба перемещения данных (DMS) — это технология перемещения данных, которая координирует перемещение данных между вычислительными узлами. Некоторым запросам требуется перемещение данных, чтобы параллельные запросы вернули точные результаты. При необходимости перемещения данных DMS гарантирует, что нужные данные окажутся в нужном расположении.

## <a name="distributions"></a>Дистрибутивы

Распределение представляет собой базовую единицу хранения и обработки параллельных запросов, выполняемых для распределенных данных. При выполнении запроса в Synapse SQL формируются 60 небольших запросов, которые выполняются параллельно.

Каждый из этих 60 небольших запросов выполняется в одном из распределений данных. Каждый вычислительный узел управляет одним или несколькими из 60 распределений. Выделенный пул SQL (ранее — хранилище данных SQL) с максимальными ресурсами вычислений имеет одно распределение на один расчетный узел. Выделенный пул SQL (ранее — хранилище данных SQL) с минимальными ресурсами вычислений имеет все распределения на одном из вычислений.  

## <a name="hash-distributed-tables"></a>Таблицы с хэш-распределением

С помощью распределенной хэш-таблицы можно обеспечить наибольшую производительность запроса для операций объединения и агрегирования для больших таблиц.

Чтобы сегментировать данные в распределенную хэш-таблицу, используется хэш-функция для детерминированного назначения каждой строки отдельному распределению. В определении таблицы один из столбцов определяется как столбец распределения. Хэш-функция использует значения в столбце распределения для присвоения каждой строки распределению.

На следующей схеме показано, как полная (нераспределенная) таблица хранится в качестве хэш-распределенной.

![Распределенная таблица](./media/massively-parallel-processing-mpp-architecture/hash-distributed-table.png "Распределенная таблица")  

- Каждая строка относится к одному распределению.  
- Детерминированный хэш-алгоритм присваивает каждую строку одному распределению.  
- Количество строк таблицы в распределении зависит от размеров таблиц (как показано на схеме).

Существуют влияющие на производительность факторы, которые учитываются при выборе столбца распределения. Например, определенность, неравномерное смещение данных и типы запросов, выполняемых в системе.

## <a name="round-robin-distributed-tables"></a>Таблицы с распределением методом циклического перебора

Таблица с распределением методом циклического перебора — это самая простая таблица для создания и обеспечения высокой производительности, если ее использовать как промежуточную таблицу для нагрузок.

В таблице с распределением методом циклического перебора данные распределяются равномерно, но без какой-либо последующей оптимизации. Распределение сначала выбирается случайным образом, а затем буферы строк назначаются распределениям последовательно. Вы можете быстро загрузить данные в таблицу с распределением методом циклического перебора, но производительность запроса будет лучше, если использовать распределенные хэш-таблицы. Для объединения таблиц с распределением методом циклического перебора требуется перегруппировка данных, что требует дополнительного времени.

## <a name="replicated-tables"></a>Реплицированные таблицы

Реплицированная таблица обеспечивает наилучшую производительность запросов для небольших таблиц.

Полная копия реплицированной таблицы хранится на каждом вычислительном узле. В результате репликация таблицы устраняет необходимость передавать данные между вычислительными узлами перед операциями соединения или агрегирования. Реплицированные таблицы лучше всего использовать для небольших таблиц. При записи данных требуются дополнительное хранилище и дополнительные расходы, что делает использование больших таблиц нецелесообразным.  

На следующей схеме представлена реплицированная таблица, которая кэшируется при первом распределении на каждом вычислительном узле.  

![Реплицированная таблица](./media/massively-parallel-processing-mpp-architecture/replicated-table.png "Реплицированная таблица")

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы уже знакомы с Azure синапсе, Узнайте, как быстро [создать выделенный пул SQL (ранее — хранилище данных SQL)](create-data-warehouse-portal.md) и [загрузить демонстрационные данные](./load-data-from-azure-blob-storage-using-copy.md). Если вы раньше не работали с Azure, используйте [глоссарий Azure Глоссарий](../../azure-glossary-cloud-terminology.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json) , чтобы узнать значение новых терминов. Или ознакомьтесь со следующими ресурсами, посвященными Azure Synapse.  

- [Истории успеха клиентов](https://azure.microsoft.com/case-studies/?service=sql-data-warehouse)
- [Блоги](https://azure.microsoft.com/blog/tag/azure-sql-data-warehouse/)
- [Запросы функций](https://feedback.azure.com/forums/307516-sql-data-warehouse)
- [Видео](https://azure.microsoft.com/documentation/videos/index/?services=sql-data-warehouse)
- [Создание запроса в службу поддержки](sql-data-warehouse-get-started-create-support-ticket.md)
- [Раздел вопросов и ответов на сайте Майкрософт](/answers/topics/azure-synapse-analytics.html)
- [Форум Stack Overflow](https://stackoverflow.com/questions/tagged/azure-sqldw)
- [Twitter](https://twitter.com/hashtag/SQLDW)