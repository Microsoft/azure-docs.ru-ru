---
title: 'Действия запросов и использование ресурсов: управляемость и мониторинг'
description: Узнайте о доступных возможностях мониторинга и управления в Azure Synapse Analytics. Используйте портал Azure и динамические административные представления (DMV), чтобы понять действия запросов и использование ресурсов хранилища данных.
services: synapse-analytics
author: kevinvngo
manager: craigg-msft
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: sql-dw
ms.date: 04/09/2020
ms.author: kevin
ms.reviewer: jrasnick
ms.custom: azure-synapse
ms.openlocfilehash: 75c0058f2d4878016281656935cbd82f79b859fd
ms.sourcegitcommit: aacbf77e4e40266e497b6073679642d97d110cda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "98120008"
---
# <a name="monitoring-resource-utilization-and-query-activity-in-azure-synapse-analytics"></a>Мониторинг использования ресурсов и действий запросов в Azure Synapse Analytics

Azure Synapse Analytics предоставляет широкие возможности мониторинга в рамках портала Azure, позволяя просматривать аналитические сведения о рабочей нагрузке хранилища данных. Портал Azure — рекомендуемый инструмент мониторинга хранилища данных, так как он предоставляет настраиваемые периоды хранения, оповещения, рекомендации, индивидуальные диаграммы и панели мониторинга для метрик и журналов. На портале можно также выполнить интеграцию с другими службами мониторинга Azure, такими как Azure Monitor (журналы) и Log Analytics, чтобы обеспечить комплексные возможности мониторинга не только для хранилища данных, но и для всей платформы аналитики Azure. В этой документации описывается, какие возможности мониторинга доступны для оптимизации вашей платформы аналитики и управления ею при использовании Synapse SQL.

## <a name="resource-utilization"></a>Использование ресурсов

На портале Azure доступны указанные ниже метрики Synapse SQL. Эти метрики отслеживаются с помощью [Azure Monitor](../../azure-monitor/platform/data-platform.md?bc=%2fazure%2fsynapse-analytics%2fsql-data-warehouse%2fbreadcrumb%2ftoc.json&toc=%2fazure%2fsynapse-analytics%2fsql-data-warehouse%2ftoc.json#metrics).

| Имя метрики             | Описание                                                  | Тип статистической обработки |
| ----------------------- | ------------------------------------------------------------ | ---------------- |
| Процент использования ЦП          | Загрузка ЦП во всех узлах хранилища данных      | Avg, Min, Max    |
| Процент операций ввода/вывода данных      | Использование операций ввода-вывода во всех узлах хранилища данных       | Avg, Min, Max    |
| Процент использования памяти       | Использование памяти (SQL Server) на всех узлах хранилища данных. | Avg, Min, Max   |
| Активные запросы          | Число активных запросов, выполненных в системе.             | SUM              |
| Запросы в очереди          | Число запросов в очереди, ожидающих выполнения.          | SUM              |
| Успешные подключения  | Число успешных подключений (операций входа) к базе данных. | Sum, Count       |
| Неудачные подключения      | Число неудачных подключений (операций входа) к базе данных. | Sum, Count       |
| Заблокировано брандмауэром     | Количество заблокированных операций входа в хранилище данных     | Sum, Count       |
| Лимит DWU               | Целевой уровень обслуживания хранилища данных                | Avg, Min, Max    |
| DWU percentage          | Максимальная разница между процентом использования ЦП и процентом операций ввода-вывода данных        | Avg, Min, Max    |
| DWU used                | Лимит DWU * процент DWU                                   | Avg, Min, Max    |
| Cache hit percentage (Процент попаданий в кэш)    | (попадания в кэш / промахи кэша) * 100, где попадания в кэш — это сумма всех попаданий сегментов columnstore в локальный кэш SSD, а промах кэша — это промахи сегментов columnstore в локальный кэш SSD, суммированные по всем узлам | Avg, Min, Max    |
| Cache used percentage (Процент использования кэша)   | (кэш использований / кэш емкости) * 100, где кэш использований представляет собой сумму всех байтов в локальном кэше SSD на всех узлах, а кэш емкости — сумму объема локального диска SSD, кэшированную на всех узлах. | Avg, Min, Max    |
| Local tempdb percentage (Процент использования локальной базы данных tempdb) | Использование локальной базы данных tempdb на всех вычислительных узлах (значения генерируются каждые пять минут) | Avg, Min, Max    |

Факторы, которые следует учитывать при просмотре метрик и настройке оповещений.

- Число использованных DWU дает только **общее представление** об использовании ресурсов в пуле SQL и не является исчерпывающим индикатором использования. Чтобы определить, следует ли увеличивать или уменьшать масштаб, нужно учесть все факторы, на которые может повлиять число DWU, такие как параллелизм, память, tempdb и емкость адаптивного кэша. Рекомендуется [выполнить рабочую нагрузку с разными параметрами DWU](sql-data-warehouse-manage-compute-overview.md#finding-the-right-size-of-data-warehouse-units), чтобы определить, что лучше соответствует вашим бизнес-целям.
- Ошибки и успешные подключения выводятся для определенного хранилища данных, а не для самого сервера.
- Процент использования памяти отражает использование, даже если хранилище данных находится в состоянии простоя. Эта метрика не отражает потребление памяти активной рабочей нагрузкой. Включите и отслеживайте эту метрику вместе с другими метриками (для tempdb и кэша 2-го поколения), чтобы принять комплексное решение о масштабировании и определить, увеличит ли дополнительная емкость кэша производительность рабочей нагрузки в соответствии с вашими требованиями.

## <a name="query-activity"></a>Действие запроса

Для программного взаимодействия при мониторинге Synapse SQL с помощью T-SQL служба предоставляет набор динамических административных представлений (DMV). Эти представления полезны в том случае, если вы активно устраняете неполадки и выявляете узкие места производительности в рабочей нагрузке.

Чтобы просмотреть список динамических административных представлений, которые относятся к Synapse SQL, ознакомьтесь с этой [документацией](../sql/reference-tsql-system-views.md#dedicated-sql-pool-dynamic-management-views-dmvs). 

## <a name="metrics-and-diagnostics-logging"></a>Метрики и журналы диагностики 

Можно экспортировать метрики и журналы в Azure Monitor, в частности в [журналы Azure Monitor](../../azure-monitor/log-query/log-query-overview.md?toc=/azure/synapse-analytics/sql-data-warehouse/toc.json&bc=/azure/synapse-analytics/sql-data-warehouse/breadcrumb/toc.json), и программно обращаться к ним посредством [запросов к журналам](../../azure-monitor/log-query/log-analytics-tutorial.md?bc=%2fazure%2fsynapse-analytics%2fsql-data-warehouse%2fbreadcrumb%2ftoc.json&toc=%2fazure%2fsynapse-analytics%2fsql-data-warehouse%2ftoc.json). Задержка журнала для Synapse SQL составляет примерно 10–15 минут. Дополнительные сведения о факторах, влияющих на задержку, приведены в указанной ниже документации.

## <a name="next-steps"></a>Дальнейшие действия

В следующем практическом руководстве описаны распространенные сценарии и варианты использования при мониторинге хранилища данных и управлении им:

- [Мониторинг рабочей нагрузки с помощью динамических административных представлений](sql-data-warehouse-manage-monitor.md)