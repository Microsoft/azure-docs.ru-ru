---
title: Шифрование Azure синапсе Analytics
description: Статья, объясняющая шифрование в Azure синапсе Analytics
author: nanditavalsan
ms.service: synapse-analytics
ms.topic: conceptual
ms.subservice: security
ms.date: 11/19/2020
ms.author: nanditav
ms.reviewer: jrasnick
ms.openlocfilehash: d4bc59a9bd5299698bff9949aaaa881fbdf385ee
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100526278"
---
# <a name="encryption-for-azure-synapse-analytics-workspaces"></a>Шифрование для рабочих областей Azure Synapse Analytics

В этой статье описываются:
* Шифрование неактивных данных в рабочих областях синапсе Analytics.
* Настройка рабочих областей синапсе для включения шифрования с помощью управляемого клиентом ключа.
* Управление ключами, используемыми для шифрования данных в рабочих областях.

## <a name="encryption-of-data-at-rest"></a>Шифрование неактивных данных

Полное шифрование неактивных решений гарантирует, что данные никогда не сохраняются в незашифрованном виде. Двойное шифрование неактивных данных снижает риски с двумя отдельными уровнями шифрования для защиты от угроз любого отдельного слоя. Azure синапсе Analytics предлагает второй уровень шифрования данных в рабочей области с помощью управляемого клиентом ключа. Этот ключ защищается в [Azure Key Vault](../../key-vault/general/overview.md), что позволяет стать владельцем управления ключами и их смены.

Первый уровень шифрования для служб Azure включен с ключами, управляемыми платформой. По умолчанию диски Azure и данные в учетных записях хранения Azure автоматически шифруются при хранении. Дополнительные сведения об использовании шифрования в Microsoft Azure см. в статье [Общие сведения о шифровании Azure](../../security/fundamentals/encryption-overview.md).

## <a name="azure-synapse-encryption"></a>Шифрование Azure синапсе

Этот раздел поможет лучше понять, как включено и применяется шифрование ключей, управляемых клиентом, в рабочих областях синапсе. Это шифрование использует существующие ключи или новые ключи, созданные в Azure Key Vault. Для шифрования всех данных в рабочей области используется один ключ. Рабочие области синапсе поддерживают ключи RSA с 2048 и 3072 ключами размером в байтах.

> [!NOTE]
> Рабочие области синапсе не поддерживают использование ключей шифрования (ECC) Elliptic-Curve.

Данные в следующих компонентах синапсе шифруются с помощью управляемого клиентом ключа, настроенного на уровне рабочей области:
* Пулы SQL
 * Выделенные пулы SQL
 * Бессерверные пулы SQL
* Пулы Apache Spark
* Среды выполнения интеграции фабрики данных Azure, конвейеры, наборы данных.

## <a name="workspace-encryption-configuration"></a>Конфигурация шифрования рабочей области

Рабочие области можно настроить для включения двойного шифрования с помощью ключа, управляемого клиентом, во время создания рабочей области. Выберите параметр "включить двойное шифрование с помощью управляемого пользователем ключа" на вкладке "безопасность" при создании рабочей области. Можно указать URI идентификатора ключа или выбрать его из списка хранилищ ключей в том **же регионе** , что и Рабочая область. Для Key Vault необходимо **включить защиту от удаления**.

> [!IMPORTANT]
> Параметр конфигурации для двойного шифрования нельзя изменить после создания рабочей области.

:::image type="content" source="./media/workspaces-encryption/workspaces-encryption.png" alt-text="На этой диаграмме показан параметр, который должен быть выбран для включения рабочей области для двойного шифрования с помощью ключа, управляемого клиентом.":::

### <a name="key-access-and-workspace-activation"></a>Доступ к ключам и активация рабочей области

Модель шифрования Azure синапсе с ключами, управляемыми клиентом, включает в себя доступ к ключам в Azure Key Vault для шифрования и расшифровки по мере необходимости. Ключи становятся доступными для рабочей области либо с помощью политики доступа, либо [Azure Key Vault доступа RBAC](../../key-vault/general/rbac-guide.md). При предоставлении разрешений через политику доступа Azure Key Vault выберите параметр ["только приложение"](../../key-vault/general/secure-your-key-vault.md#key-vault-authentication-options) во время создания политики (выберите управляемое удостоверение рабочей области и не добавляйте его в качестве разрешенного приложения).

 Прежде чем можно будет активировать рабочую область, управляемое удостоверение рабочей области должно предоставить необходимые разрешения в хранилище ключей. Этот поэтапный подход к активации рабочей области гарантирует, что данные в рабочей области шифруются с помощью управляемого клиентом ключа. Обратите внимание, что шифрование может быть включено или отключено для выделенных пулов SQL. по умолчанию для каждого пула не включено шифрование.

#### <a name="permissions"></a>Разрешения

Чтобы зашифровать или расшифровать неактивных данных, управляемое удостоверение рабочей области должно иметь следующие разрешения.
* WrapKey (для вставки ключа в Key Vault при создании нового ключа).
* UnwrapKey (для получения ключа расшифровки).
* Get (для чтения открытой части ключа)

#### <a name="workspace-activation"></a>Активация рабочей области

После создания рабочей области (с включенным двойным шифрованием) она остается в состоянии "ожидание" до тех пор, пока активация не будет выполнена. Чтобы полностью использовать все функциональные возможности, необходимо активировать рабочую область. Например, можно создать только новый выделенный пул SQL после того, как активация будет выполнена. Предоставьте управляемому удостоверению рабочей области доступ к хранилищу ключей и щелкните ссылку активации в области портал Azure баннер. После успешного завершения активации Рабочая область готова к использованию с гарантией того, что все данные в ней защищаются с помощью ключа, управляемого клиентом. Как уже отмечалось, для успешности активации в хранилище ключей должна быть включена защита от очистки.

:::image type="content" source="./media/workspaces-encryption/workspace-activation.png" alt-text="На этой схеме показан баннер с ссылкой активации для рабочей области.":::


### <a name="manage-the-workspace-customer-managed-key"></a>Управление ключом, управляемым клиентом рабочей области 

Вы можете изменить управляемый клиентом ключ, используемый для шифрования данных со страницы **Шифрование** в портал Azure. Здесь также можно выбрать новый ключ с помощью идентификатора ключа или выбрать из хранилища ключей, к которым у вас есть доступ в том же регионе, что и Рабочая область. Если вы выбираете ключ в другом хранилище ключей из ранее использованных, предоставьте им разрешения управляемое удостоверение "Get", "переносить" и "разворачивать" для нового хранилища ключей. Рабочая область будет проверять доступ к новому хранилищу ключей, и все данные в рабочей области будут повторно зашифрованы с помощью нового ключа.

:::image type="content" source="./media/workspaces-encryption/workspace-encryption-management.png" alt-text="На этой схеме показан раздел &quot;шифрование рабочей области&quot; в портал Azure.":::

>[!IMPORTANT]
>При изменении ключа шифрования рабочей области следует хранить ключ до тех пор, пока он не будет заменен в рабочей области новым ключом. Это позволяет расшифровывать данные с помощью старого ключа до их повторного шифрования с помощью нового ключа.

Политики хранилища ключей Azure для автоматического, периодического вращения ключей или действий с ключами могут привести к созданию новых версий ключей. Вы можете повторно зашифровать все данные в рабочей области с помощью последней версии активного ключа. Для повторного шифрования измените ключ в портал Azure на временный ключ, а затем переключитесь обратно на ключ, который вы хотите использовать для шифрования. Например, чтобы обновить шифрование данных с помощью последней версии активного ключа Key1, измените ключ, управляемый клиентом рабочей области, на временный ключ Key2. Дождитесь завершения шифрования с помощью Key2. Затем переключитесь с управляемого клиента рабочей области обратно на key1-данные в рабочей области будут повторно зашифрованы с помощью последней версии key1.

> [!NOTE]
> Azure синапсе Analytics активно работает над добавлением функций для автоматического повторного шифрования данных при создании новых версий ключей. Пока эта функция не будет доступна, для обеспечения согласованности в рабочей области принудительно выполните повторное шифрование данных с помощью описанного выше процесса.

#### <a name="sql-transparent-data-encryption-with-service-managed-keys"></a>Прозрачное шифрование данных SQL с ключами, управляемыми службой

SQL прозрачное шифрование данных (TDE) доступен для выделенных пулов SQL в рабочих областях, для которых *не* включено двойное шифрование. В рабочей области этого типа ключ, управляемый службой, используется для обеспечения двойного шифрования данных в выделенных пулах SQL. TDE с ключом, управляемым службой, можно включить или отключить для отдельных выделенных пулов SQL.

## <a name="next-steps"></a>Дальнейшие действия

[Использование встроенных политик Azure для реализации защиты шифрования для рабочих областей синапсе](../policy-reference.md)

