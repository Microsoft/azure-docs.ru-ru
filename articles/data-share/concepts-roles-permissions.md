---
title: Роли и требования для Azure Data Share
description: Сведения о разрешениях, необходимых для обмена данными и их получения с помощью общего ресурса данных Azure.
author: jifems
ms.author: jife
ms.service: data-share
ms.topic: conceptual
ms.date: 03/24/2021
ms.openlocfilehash: a832c8956f7a3d4f8669209d7ed311e7555e1e75
ms.sourcegitcommit: c8b50a8aa8d9596ee3d4f3905bde94c984fc8aa2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2021
ms.locfileid: "105644250"
---
# <a name="roles-and-requirements-for-azure-data-share"></a>Роли и требования для Azure Data Share 

В этой статье описываются роли и разрешения, необходимые для совместного использования и получения данных с помощью службы общего доступа к данным Azure. 

## <a name="roles-and-requirements"></a>Роли и требования

С помощью службы совместного использования данных Azure можно обмениваться данными без обмена учетными данными между поставщиком данных и потребителем. Для совместного использования на основе моментальных снимков служба общего ресурса данных Azure использует управляемые удостоверения (ранее известные как MSI) для проверки подлинности в хранилище данных Azure. Управляемому удостоверению общего ресурса Azure Data Share необходимо предоставить доступ к хранилищу данных Azure для чтения или записи данных.

Для предоставления общего доступа или получения данных из хранилища данных Azure пользователь должен иметь по крайней мере следующие разрешения. 

* Разрешение на запись в хранилище данных Azure. Как правило, это разрешение существует в роли **участника** .

Для службы хранилища и совместного использования на основе моментальных снимков Data Lake необходимо также разрешение на создание назначения ролей в хранилище данных Azure. Как правило, разрешение на создание назначений ролей существует в роли **владельца** , в роли администратора доступа пользователей или в пользовательской роли с помощью *Microsoft. Authorization, назначение ролей или* разрешение на запись. Это разрешение не требуется, если управляемому удостоверению ресурса общего доступа к данным уже предоставлен доступ к хранилищу данных Azure. Ниже приведена сводка ролей, назначенных управляемому удостоверению ресурса общего доступа к данным:

|**Тип хранилища данных**|**Хранилище данных источника поставщика данных**|**Целевое хранилище данных потребителя данных**|
|---|---|---|
|хранилище BLOB-объектов Azure| Читатель данных больших двоичных объектов хранилища | Участник данных BLOB-объектов хранилища
|Azure Data Lake 1-го поколения | Владелец | Не поддерживается
|Azure Data Lake 2-го поколения | Читатель данных больших двоичных объектов хранилища | Участник данных BLOB-объектов хранилища
|

Для совместного использования на основе моментального снимка SQL пользователь SQL должен быть создан из внешнего поставщика в базе данных SQL Azure с тем же именем, что и ресурс общего ресурса данных Azure. Для создания этого пользователя требуется разрешение администратора Azure Active Directory. Ниже приведена сводка разрешений, необходимых пользователю SQL.

|**Тип базы данных SQL**|**Разрешение пользователя SQL для поставщика данных**|**Разрешение пользователя SQL для потребителя данных**|
|---|---|---|
|База данных SQL Azure | db_datareader, | db_datareader, db_datawriter db_ddladmin
|Azure Synapse Analytics | db_datareader, | db_datareader, db_datawriter db_ddladmin
|

### <a name="data-provider"></a>Поставщик данных
Для добавления набора данных в общий ресурс хранилища данных Azure, управляемый идентификатор общего ресурса данных поставщика, необходимо предоставить доступ к исходному хранилищу данных Azure. Например, в случае учетной записи хранения управляемое удостоверение ресурса общей папки предоставляет роль *читателя данных BLOB-объекта хранилища* . Это выполняется автоматически службой общих ресурсов данных Azure, когда пользователь добавляет набор данных через портал Azure и пользователь имеет соответствующее разрешение. Например, пользователь является владельцем хранилища данных Azure или членом пользовательской роли, которой назначено разрешение *Microsoft. Authorization, роли/запись* . 

Кроме того, пользователь может быть владельцем хранилища данных Azure, добавляя управляемое удостоверение ресурса общих ресурсов в хранилище данных Azure вручную. Это действие необходимо выполнить только один раз для каждого ресурса в общем ресурсе. Чтобы создать назначение роли для управляемого удостоверения ресурса ресурса данных вручную, выполните следующие действия.  

1. Перейдите к хранилищу данных Azure.
1. Выберите **Управление доступом (IAM)** .
1. Выберите **добавить назначение ролей**.
1. В разделе *роль* выберите роль в таблице назначение ролей (например, для учетной записи хранения выберите *модуль чтения данных BLOB-объекта хранилища*).
1. В поле *выбрать* введите имя общего ресурса данных Azure.
1. Выберите команду *Сохранить*.

Дополнительные сведения о назначении ролей см. в разделе [назначение ролей Azure с помощью портал Azure](../role-based-access-control/role-assignments-portal.md). Если вы предоставляете общий доступ к данным с помощью интерфейсов API, вы можете создать назначение ролей с помощью API-интерфейса, обратившись [к назначению ролей Azure с помощью REST API](../role-based-access-control/role-assignments-rest.md). 

Для совместного использования на основе моментальных снимков SQL пользователь SQL должен быть создан из внешнего поставщика в базе данных SQL с тем же именем, что и ресурс общего ресурса данных Azure при подключении к базе данных SQL с использованием Azure Active Directory проверки подлинности. Этому пользователю необходимо предоставить разрешение *db_datareader* . Пример скрипта, а также другие необходимые компоненты для совместного использования на основе SQL можно найти в руководстве по [базе данных SQL Azure или Azure синапсе Analytics](how-to-share-from-sql.md) . 

### <a name="data-consumer"></a>Потребитель данных
Чтобы получать данные в учетную запись хранения, управляемому удостоверению ресурса-источника данных потребителя необходимо предоставить доступ к целевой учетной записи хранения. Управляемому удостоверению общего ресурса данных должна быть предоставлена роль *участника данных BLOB-объекта хранилища* . Это выполняется автоматически службой общего ресурса данных Azure, если пользователь указывает целевую учетную запись хранения с помощью портал Azure и пользователь имеет соответствующее разрешение. Например, пользователь является владельцем учетной записи хранения или членом пользовательской роли, которой назначено разрешение *Microsoft. Authorization, роли/запись* . 

Кроме того, пользователь может иметь права владельца учетной записи хранения, добавлять управляемое удостоверение ресурса общих ресурсов в учетную запись хранения вручную. Это действие необходимо выполнить только один раз для каждого ресурса в общем ресурсе. Чтобы создать назначение роли для управляемого удостоверения ресурса ресурса данных вручную, выполните следующие действия. 

1. Перейдите к хранилищу данных Azure.
1. Выберите **Управление доступом (IAM)** .
1. Выберите **добавить назначение ролей**.
1. В разделе *роль* выберите роль в таблице назначение ролей (например, для учетной записи хранения выберите *модуль чтения данных BLOB-объекта хранилища*).
1. В поле *выбрать* введите имя общего ресурса данных Azure.
1. Выберите команду *Сохранить*.

Дополнительные сведения о назначении ролей см. в разделе [назначение ролей Azure с помощью портал Azure](../role-based-access-control/role-assignments-portal.md). Если вы получаете данные с помощью интерфейсов API, вы можете создать назначение ролей с помощью API-интерфейса, обратившись [к назначению ролей Azure с помощью REST API](../role-based-access-control/role-assignments-rest.md). 

Для целевого объекта на основе SQL пользователь SQL должен быть создан из внешнего поставщика в базе данных SQL с тем же именем, что и ресурс общего ресурса данных Azure, при подключении к базе данных SQL с использованием Azure Active Directory проверки подлинности. Этому пользователю необходимо предоставить разрешения *db_datareader, db_datawriter, db_ddladmin* . Пример скрипта, а также другие необходимые компоненты для совместного использования на основе SQL можно найти в руководстве по [базе данных SQL Azure или Azure синапсе Analytics](how-to-share-from-sql.md) . 

## <a name="resource-provider-registration"></a>Регистрация поставщика ресурсов 

Возможно, потребуется вручную зарегистрировать поставщик ресурсов Microsoft. на ресурсе в подписке Azure в следующих сценариях: 

* Просмотр приглашения на общий ресурс Azure в первый раз в клиенте Azure
* Совместное использование данных из хранилища данных Azure в другой подписке Azure из общего ресурса данных Azure
* Получение данных в хранилище данных Azure в другой подписке Azure из общего ресурса данных Azure

Выполните следующие действия, чтобы зарегистрировать поставщик ресурсов Microsoft. данных в подписке Azure. Для регистрации поставщика ресурсов необходимо иметь доступ *участника* к подписке Azure.

1. В портал Azure перейдите к разделу **подписки**.
1. Выберите подписку, которую вы используете для общего ресурса данных Azure.
1. Щелкните **поставщики ресурсов**.
1. Найдите файл Microsoft.
1. Щелкните **Зарегистрировать**.
 
Дополнительные сведения о поставщике ресурсов см. в статье [поставщики и типы ресурсов Azure](../azure-resource-manager/management/resource-providers-and-types.md).

## <a name="next-steps"></a>Дальнейшие шаги

- Подробнее о ролях в Azure. Общие сведения об [определениях ролей Azure](../role-based-access-control/role-definitions.md)