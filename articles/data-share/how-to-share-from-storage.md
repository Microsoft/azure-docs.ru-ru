---
title: Совместное использование данных и их получение из Хранилища BLOB-объектов Azure и Azure Data Lake Storage
description: Сведения о совместном использовании и получении данных из хранилища BLOB-объектов Azure и Azure Data Lake Storage.
author: jifems
ms.author: jife
ms.service: data-share
ms.topic: how-to
ms.date: 12/16/2020
ms.openlocfilehash: 242980ac1b89345ed9d8ff903e65129cff3cb917
ms.sourcegitcommit: f6f928180504444470af713c32e7df667c17ac20
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "97964105"
---
# <a name="share-and-receive-data-from-azure-blob-storage-and-azure-data-lake-storage"></a>Совместное использование данных и их получение из Хранилища BLOB-объектов Azure и Azure Data Lake Storage

[!INCLUDE[appliesto-storage](includes/appliesto-storage.md)]

Общий ресурс данных Azure поддерживает общий доступ на основе моментальных снимков из учетной записи хранения. В этой статье объясняется, как предоставить общий доступ и получить данные из хранилища BLOB-объектов Azure, Azure Data Lake Storage 1-го поколения и Azure Data Lake Storage 2-го поколения.

Общая папка данных Azure поддерживает общий доступ к файлам, папкам и файловым системам Azure Data Lake Gen1 и Azure Data Lake Gen2. Он также поддерживает общий доступ к BLOB-объектам, папкам и контейнерам из хранилища BLOB-объектов Azure. В настоящее время поддерживаются только блочные BLOB-объекты. Данные, общие для этих источников, можно получить, Azure Data Lake Gen2 или хранилище BLOB-объектов Azure.

Если файловые системы, контейнеры или папки используются совместно с общим доступом на основе моментальных снимков, потребители данных могут создать полную копию общих данных. Или же они могут использовать возможность добавочного моментального снимка для копирования только новых или обновленных файлов. Возможность добавочного моментального снимка основана на времени последнего изменения файлов. 

Существующие файлы с одинаковыми именами перезаписываются во время создания моментального снимка. Файл, который удаляется из источника, не удаляется на целевом объекте. Пустые вложенные папки в источнике не копируются на целевой объект. 
## <a name="share-data"></a>Совместное использование данных

Используйте сведения в следующих разделах для предоставления общего доступа к данным с помощью общего ресурса данных Azure. 
### <a name="prerequisites-to-share-data"></a>Необходимые условия для совместного использования данных

* Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/), прежде чем начинать работу.
* Найдите адрес электронной почты Azure для входа получателя. Псевдоним электронной почты получателя не подходит для ваших целей.
* Если исходное хранилище данных Azure находится в другой подписке Azure, чем та, где вы создадите ресурс общих ресурсов, зарегистрируйте [поставщик ресурсов Microsoft.](concepts-roles-permissions.md#resource-provider-registration) DataSource в подписке, в которой находится хранилище данных Azure. 

### <a name="prerequisites-for-the-source-storage-account"></a>Необходимые условия для исходной учетной записи хранения

* Учетная запись хранения Azure. Если у вас еще нет учетной записи, [создайте ее](../storage/common/storage-account-create.md).
* Разрешение на запись в учетную запись хранения. Разрешение на запись находится в *Microsoft. Storage, storageAccounts/Write*. Он является частью роли участника.
* Разрешение на добавление назначения ролей в учетную запись хранения. Это разрешение предоставляется в *Microsoft. Authorization, назначение ролей и запись*. Он является частью роли владельца. 

### <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портал Azure](https://portal.azure.com/).

### <a name="create-a-data-share-account"></a>Создание учетной записи общей папки данных

Создайте ресурс Azure Data Share в группе ресурсов Azure.

1. В левом верхнем углу портала откройте меню и выберите **создать ресурс** (+).

1. Найдите *Data Share*.

1. Выберите **общий доступ к данным** и **Создайте**.

1. Укажите основные сведения о ресурсе общего ресурса данных Azure: 

     **Параметр** | **Рекомендуемое значение** | **Описание поля**
    |---|---|---|
    | Подписка | Ваша подписка | Выберите подписку Azure для учетной записи общего ресурса данных.|
    | Группа ресурсов | *test-resource-group* | Используйте существующую группу ресурсов или создайте группу ресурсов. |
    | Расположение | *Восточная часть США 2* | Выберите регион для учетной записи Data Share.
    | Имя | *datashareaccount* | Назовите учетную запись общего ресурса. |
    | | |

1. Выберите **проверить и создать**  >  **создать** , чтобы предоставить учетную запись общей папки данных. Подготовка новой учетной записи общего доступа к данным обычно занимает около 2 минут. 

1. После завершения развертывания выберите **Перейти к ресурсу**.

### <a name="create-a-share"></a>Создание общей папки

1. Перейдите на страницу **обзора** общих данных.

   :::image type="content" source="./media/share-receive-data.png" alt-text="Снимок экрана, показывающий общие сведения об общем ресурсе данных.":::

1. Выберите команду **Начать совместное использование данных**.

1. Нажмите кнопку **создания**.   

1. Укажите сведения о вашей общей папке. Укажите имя, тип совместного использования, описание содержимого и условия использования (необязательно). 

    ![Снимок экрана, показывающий сведения об общем ресурсе данных.](./media/enter-share-details.png "Введите сведения об общем ресурсе данных.") 

1. Выберите **Continue** (Продолжить).

1. Чтобы добавить наборы данных в общую папку, выберите **добавить наборы данных**. 

    ![Снимок экрана, показывающий, как добавить наборы данных в общую папку.](./media/datasets.png "Наборы данных.")

1. Выберите тип набора данных для добавления. Список типов наборов данных зависит от того, выбран ли на предыдущем шаге общий доступ на основе моментального снимка или общий доступ к месту на месте. 

    ![Снимок экрана, на котором показано, где выбрать тип набора данных.](./media/add-datasets.png "Добавление наборов данных.")    

1. Перейдите к объекту, к которому необходимо предоставить общий доступ. Затем выберите **добавить наборы данных**. 

    ![Снимок экрана, показывающий, как выбрать объект для совместного использования.](./media/select-datasets.png "Выберите наборы данных.")    

1. На вкладке **получатели** добавьте адрес электронной почты потребителя данных, нажав кнопку **Добавить получателя**. 

    ![Снимок экрана, показывающий, как добавить адреса электронной почты получателей.](./media/add-recipient.png "Добавление получателей.") 

1. Выберите **Continue** (Продолжить).

1. Если выбран тип общего ресурса моментального снимка, можно настроить расписание моментальных снимков для обновления данных для потребителя данных. 

    ![Снимок экрана, показывающий параметры расписания моментальных снимков.](./media/enable-snapshots.png "Включить моментальные снимки.") 

1. Выберите время начала и интервал повторения. 

1. Выберите **Continue** (Продолжить).

1. На вкладке " **Проверка и создание** " проверьте содержимое пакета, параметры, получателей и параметры синхронизации. Щелкните **Создать**.

Вы создали общую папку данных Azure. Получатель вашей общей папки данных может принять ваше приглашение. 

## <a name="receive-data"></a>Получение данных

В следующих разделах описано, как получить общие данные.
### <a name="prerequisites-to-receive-data"></a>Необходимые условия для получения данных
Прежде чем принять приглашение на обмен данными, убедитесь, что у вас есть следующие необходимые компоненты. 

* Подписка Azure. Если у вас нет подписки, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/).
* Приглашение из Azure. Тема сообщения электронной почты должна быть "приглашение к общему ресурсу данных Azure *\<yourdataprovider\@domain.com>* ".
* Зарегистрированный [поставщик ресурсов Microsoft. для совместного использования](concepts-roles-permissions.md#resource-provider-registration) в:
    * Подписка Azure, в которой вы создадите ресурс общего ресурса данных.
    * Подписка Azure, в которой находятся целевые хранилища данных Azure.

### <a name="prerequisites-for-a-target-storage-account"></a>Необходимые условия для целевой учетной записи хранения

* Учетная запись хранения Azure. Если у вас еще нет [учетной записи, создайте](../storage/common/storage-account-create.md)ее. 
* Разрешение на запись в учетную запись хранения. Это разрешение находится в *Microsoft. Storage, storageAccounts/Write*. Он является частью роли участника. 
* Разрешение на добавление назначения ролей в учетную запись хранения. Это назначение входит в *состав Microsoft. Authorization, назначение ролей и запись*. Он является частью роли владельца.  

### <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

Войдите на [портал Azure](https://portal.azure.com/).

### <a name="open-an-invitation"></a>Открытие приглашения

Вы можете открыть приглашение из электронной почты или непосредственно из портал Azure.

1. Чтобы открыть приглашение из сообщения электронной почты, проверьте папку "Входящие" на наличие приглашения от поставщика данных. Приглашение от Microsoft Azure озаглавлено "приглашение к общему ресурсу данных Azure из *\<yourdataprovider\@domain.com>* ". Выберите **просмотреть приглашение** , чтобы просмотреть приглашение в Azure. 

   Чтобы открыть приглашение из портал Azure, выполните поиск *приглашений на обмен данными*. Появится список приглашений для совместного использования данных.

   ![Снимок экрана, показывающий список приглашений в портал Azure.](./media/invitations.png "Список приглашений.") 

1. Выберите общую папку, которую нужно просмотреть. 

### <a name="accept-an-invitation"></a>Принять приглашение
1. Проверьте все поля, включая **условия использования**. Если вы согласны с условиями, установите флажок. 

   ![Снимок экрана, показывающий область Условия использования.](./media/terms-of-use.png "Условия использования.") 

1. В разделе **Целевая учетная запись общего ресурса** выберите подписку и группу ресурсов, в которых будет развернут общий ресурс данных. Затем заполните следующие поля:

   * В поле **Общая учетная запись данных** выберите **создать** , если у вас нет учетной записи общего ресурса. В противном случае выберите существующую учетную запись общего ресурса, которая будет принимать вашу общую папку данных. 

   * В поле **полученное имя общего ресурса** оставьте значение по умолчанию, указанное поставщиком данных, или укажите новое имя для полученного общего ресурса. 

1. Выберите **принять и настроить**. Создается общая подписка. 

   ![Снимок экрана, на котором показано, где можно принять параметры конфигурации.](./media/accept-options.png "Принятие параметров") 

    Полученный общий ресурс отображается в учетной записи общего ресурса данных. 

    Если вы не хотите принимать приглашение, выберите **отклонить**. 

### <a name="configure-a-received-share"></a>Настройка полученного общего ресурса
Выполните действия, описанные в этом разделе, чтобы настроить расположение для получения данных.

1. На вкладке **наборы** данных установите флажок рядом со списком, в котором нужно назначить назначение. Чтобы выбрать целевое хранилище данных, выберите пункт **соотнести с целевым объектом** . 

   ![Снимок экрана, показывающий, как сопоставляться с целевым объектом.](./media/dataset-map-target.png "Сопоставьте с целевым объектом.") 

1. Выберите целевое хранилище данных для данных. Файлы в целевом хранилище данных, имеющие тот же путь и имя, что и файлы в полученных данных, будут перезаписаны. 

   ![Снимок экрана, на котором показано, где выбрать целевую учетную запись хранения.](./media/map-target.png "Целевое хранилище.") 

1. Для совместного использования на основе моментальных снимков, если поставщик данных использует расписание моментальных снимков для регулярного обновления данных, можно включить расписание на вкладке **расписание моментальных снимков** . Установите флажок рядом с расписанием моментальных снимков. Нажмите кнопку **Включить**.

   ![Снимок экрана, показывающий, как включить расписание моментальных снимков.](./media/enable-snapshot-schedule.png "Включите расписание моментальных снимков.")

### <a name="trigger-a-snapshot"></a>Активация создания моментальных снимков
Действия, описанные в этом разделе, применимы только к общему доступу на основе моментальных снимков.

1. Моментальный снимок можно активировать на вкладке **сведения** . На вкладке выберите **триггер моментальный снимок**. Можно выбрать Запуск полного моментального снимка или добавочного моментального снимка данных. Если вы получаете данные от поставщика данных в первый раз, выберите **полная копия**. 

   ![Снимок экрана с выбором снимка триггера.](./media/trigger-snapshot.png "Триггер моментального снимка.") 

1. Когда состояние последнего запуска будет *успешным*, перейдите к целевому хранилищу данных, чтобы просмотреть полученные данные. Выберите **наборы данных**, а затем щелкните ссылку целевой путь. 

   ![Снимок экрана, показывающий сопоставление набора данных потребителя.](./media/consumer-datasets.png "Сопоставление набора данных потребителя.") 

### <a name="view-history"></a>Просмотр истории
Журнал моментальных снимков можно просмотреть только при совместном использовании на основе моментальных снимков. Чтобы просмотреть журнал, откройте вкладку **Журнал** . Здесь вы видите историю всех моментальных снимков, созданных за последние 30 дней. 

## <a name="next-steps"></a>Дальнейшие действия
Вы узнали, как совместно использовать и принимать данные из учетной записи хранения с помощью службы общего доступа к данным Azure. Дополнительные сведения о совместном использовании из других источников данных см. в разделе [Поддерживаемые хранилища данных](supported-data-stores.md).