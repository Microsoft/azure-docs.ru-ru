---
title: Руководство. Копирование данных в Azure Data Box Heavy с помощью службы копирования данных
description: В этом руководстве вы узнаете, как копировать данные на устройство Azure Data Box Heavy с помощью службы копирования данных
services: databox
author: alkohli
ms.service: databox
ms.subservice: heavy
ms.topic: tutorial
ms.date: 07/03/2019
ms.author: alkohli
ms.openlocfilehash: 601e5cf15c47b16c53ff9ca81a56cb613bcfc3f5
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96006565"
---
# <a name="tutorial-use-the-data-copy-service-to-copy-data-into-azure-data-box-heavy-preview"></a>Руководство. Копирование данных в Azure Data Box Heavy (предварительная версия) с помощью службы копирования данных

Это руководство содержит инструкции по приему данных с использованием службы копирования данных без наличия промежуточного узла. Служба копирования данных запускается локально в службе Azure Data Box Heavy подключается к запоминающему устройству, подключаемому к сети (NAS) по протоколу SMB и копирует данные в Data Box Heavy

Использование службы копирования данных:

- В средах NAS, где промежуточные узлы могут быть недоступны.
- Для небольших файлов, прием и передача данных которых занимает недели. Эта служба копирования данных значительно сокращает время приема и передачи данных для небольших файлов.

В этом руководстве описано следующее:

> [!div class="checklist"]
> * копирование данных в Data Box Heavy.

## <a name="prerequisites"></a>Предварительные требования

Перед тем как начать, убедитесь в следующем.

1. Вы завершили работу с этим руководством: [Руководство. Присоединение кабелей и подключение к Azure Data Box Heavy](data-box-heavy-deploy-set-up.md).
2. Вы получили устройство Data Box Heavy (состояние заказа на портале — **Доставлено**).
3. У вас есть учетные данные исходного устройства NAS, к которому вы выполняете подключение для копирования данных.
4. Ваш компьютер подключен к высокоскоростной сети. Чтобы ускорить копирование, можно параллельно использовать два подключения 40 GbE (по одному на каждый узел). Если у вас нет доступного подключения на 40 GbE, мы рекомендуем использовать хотя бы два подключения 10 GbE (по одному на каждый узел). 

## <a name="copy-data-to-data-box-heavy"></a>копирование данных в Data Box Heavy.

После подключения к запоминающему устройству NAS можно скопировать данные. Прежде чем начать копирование данных, ознакомьтесь со следующими моментами.

- При копировании данных убедитесь, что размер данных соответствует ограничениям на размер, указанным в статье [Руководство по присоединению кабелей и подключению к устройству Azure Data Box Heavy (предварительная версия)](data-box-heavy-limits.md).
- Если данные, отправляемые Data Box Heavy одновременно отправляются другими приложениями за пределами Data Box Heavy случается сбой заданий отправки и повреждаются данные.
- Если данные изменяются во время их считывания службой копирования данных, могут происходить сбои или их повреждение.

Чтобы скопировать данные с помощью службы копирования данных, необходимо создать задание:

1. В локальном пользовательском интерфейсе устройства Data Box Heavy перейдите в раздел **Управление** > **Копирование данных**.
2. На странице **Копирование данных** нажмите кнопку **Создание**.

    ![Нажатие кнопки "Создание" на странице "Копирование данных"](media/data-box-deploy-copy-data-via-copy-service/click-create.png)

3. В диалоговом окне **Настройка задания и запуск** заполните следующие поля:
    
    |Поле                          |Значение    |
    |-------------------------------|---------|
    |**Имя задания**                       |Уникальное имя для задания, содержащее менее 230 символов. В имени задания нельзя использовать символы \<, \>, \|, \?, \*, \\, \:, \/ и \\\.         |
    |**Исходное расположение**                |Укажите путь SMB к источнику данных в формате `\\<ServerIPAddress>\<ShareName>` или `\\<ServerName>\<ShareName>`.        |
    |**Имя пользователя**                       |Имя пользователя в формате `\\<DomainName><UserName>` для доступа к источнику данных. При подключении локальному администратору потребуются явные разрешения. Щелкните папку правой кнопкой мыши, выберите **Свойства**, а затем **Безопасность**. При этом локальный администратор будет добавлен на вкладку **Безопасность**.       |
    |**Пароль**                       |Пароль для доступа к источнику данных.           |
    |**Целевая учетная запись хранения**    |Выберите целевую учетную запись хранения для передачи данных из списка.         |
    |**Конечный тип**       |Выберите из списка тип целевого хранилища: **Блочный BLOB-объект**, **Страничный BLOB-объект** или **Файлы Azure**.        |
    |**Целевой контейнер или общая папка**    |Введите имя контейнера или общей папки для отправки данных в целевую учетную запись хранения. Вы можете указать имя общей папки или контейнера. Например, воспользуйтесь `myshare` или `mycontainer`. Вы также можете ввести имя в формате `sharename\directory_name` или `containername\virtual_directory_name`.        |
    |**Копировать файлы, соответствующие шаблону**    | Вы можете ввести соответствующий шаблон имени файла следующими двумя способами:<ul><li>**Используйте выражения с подстановочными знаками:** в выражениях с подстановочными знаками поддерживаются только `*` и `?`. Например, `*.vhd` в выражении соответствует всем файлам с расширением `.vhd`. Аналогичным образом `*.dl?` соответствует всем файлам с расширением `.dl` или файлам, которые начинаются с `.dl`, таким как `.dll`. Точно так же `*foo` соответствует всем файлам, имена которых заканчиваются на `foo`.<br>Выражение с подстановочными знаками можно ввести непосредственно в поле. По умолчанию значение, введенное в поле, рассматривается как выражение с подстановочными знаками.</li><li>**Использование регулярных выражений:** поддерживаются регулярные выражения на основе POSIX. Например, регулярное выражение `.*\.vhd` будет соответствовать всем файлам с расширением `.vhd`. Для регулярных выражений предоставьте `<pattern>` непосредственно в качестве `regex(<pattern>)`. Дополнительные сведения о регулярных выражениях см. в статье [Элементы языка регулярных выражений — краткий справочник](/dotnet/standard/base-types/regular-expression-language-quick-reference).</li><ul>|
    |**Оптимизация файлов**              |Если эта функция включена, файлы размером меньше 1 МБ упаковываются во время приема. Эта упаковка ускоряет копирование данных для небольших файлов. Кроме того, экономится значительная часть времени, если количество файлов существенно превышает количество каталогов.        |
 
4. Щелкните **Запуск**. При использовании этого параметра выполняется проверка входных данных, и, если проверка прошла успешно, запускается задание. Запуск задания может занять несколько минут.

    ![Запуск задания из диалогового окна "Настройка задания и запуск"](media/data-box-deploy-copy-data-via-copy-service/configure-and-start.png)

5. Создано задание с указанными настройками. Вы можете приостановить, возобновить, отменить или перезапустить задание. Установите флажок рядом с именем задания и нажмите соответствующую кнопку.

    ![Управление заданием на странице копирования данных](media/data-box-deploy-copy-data-via-copy-service/select-job.png)
    
    - Вы можете приостановить задание, если оно влияет на ресурсы устройства NAS в часы наивысшей нагрузки:

        ![Приостановка задания на странице копирования данных](media/data-box-deploy-copy-data-via-copy-service/pause-job.png)

        Позже вы можете возобновить выполнение задания во время наименьшей нагрузки:

        ![Возобновление задания на странице копирования данных](media/data-box-deploy-copy-data-via-copy-service/resume-job.png)

    - Выполнение задания можно отменить в любое время:

        ![Отмена задания на странице копирования данных](media/data-box-deploy-copy-data-via-copy-service/cancel-job.png)
        
        При отмене задания необходимо подтвердить действие:

        ![Подтверждение отмены задания](media/data-box-deploy-copy-data-via-copy-service/confirm-cancel-job.png)

        Если вы решите отменить задание, уже скопированные данные не удаляются. Чтобы удалить любые данные, скопированные на устройство Data Box, сбросьте настройки устройства.

        ![Сброс настроек устройства](media/data-box-deploy-copy-data-via-copy-service/reset-device.png)

        >[!NOTE]
        > Если отменить или приостановить задание, большие файлы могут быть скопированы только частично. Эти частично скопированные файлы отправляются в Azure в том же состоянии. Отменяя или приостанавливая задание, убедитесь, что ваши файлы скопированы правильно. Чтобы проверить файлы, просмотрите папки SMB или скачайте файл метки порядка байтов (BOM).

    - Вы можете перезапустить задание, если при его выполнении случился внезапный сбой из-за временной ошибки, например из-за сбоя сети. Но вы не можете перезапустить задание, если оно достигло конечного состояния (например, **Успешно** или **Завершено с ошибками**). Сбои заданий могут быть вызваны проблемами именования файлов или размера файла. Эти ошибки регистрируются, но после завершения задания его невозможно перезапустить.

        ![Перезапуск невыполненного задания](media/data-box-deploy-copy-data-via-copy-service/restart-failed-job.png)

        Если возникнет сбой и вам не удастся перезапустить задание, скачайте журналы ошибок и просмотрите ошибки в файлах журнала. После устранения проблемы создайте задание копирования файлов. Вы также можете [скопировать файлы по протоколу SMB](data-box-deploy-copy-data.md).
    
    - В этом выпуске нельзя удалять задание.
    
    - Вы можете создать неограниченное количество заданий, но параллельно запускать можно только до 10 заданий в любой момент времени.
    - Если включена **оптимизация файлов**, для повышения производительности копирования небольшие файлы упаковываются при приеме. В таких случаях вы увидите упакованный файл (с GUID, используемым в качестве имени файла). Не удаляйте этот файл. Он будет распакован во время передачи.

6. Во время выполнения задания на странице **Копирование данных** могут отображаться следующие данные:

    - В столбце **Состояние** вы можете просмотреть состояние задания копирования. Состояние может быть следующим:
        - **Выполнение**
        - **Сбой**
        - **Успешно**
        - **Переход в режим приостановки**
        - **Приостановлено**
        - **Идет отмена**
        - **Canceled**
        - **Завершено с ошибками**
    - В столбце **Файлы** отобразится количество и размер копируемых файлов.
    - В столбце **Обработано** отобразится количество и размер всех обработанных файлов.
    - В столбце **Сведения** нажмите кнопку **View** (Представление), чтобы просмотреть сведения задания.
    - Если во время копирования происходят ошибки, как показано в столбце **Число ошибок**, перейдите к столбцу **Журнал ошибок** и скачайте журналы ошибок для устранения неполадок.

Дождитесь окончания заданий копирования. Так как некоторые ошибки регистрируются только на странице **Подключиться и копировать**, убедитесь, что задания копирования завершены без ошибок, прежде чем переходить к выполнению следующего шага.

![Отсутствие ошибок на странице "Подключиться и копировать"](media/data-box-deploy-copy-data-via-copy-service/verify-no-errors-on-connect-and-copy.png)

Чтобы обеспечить целостность данных, при их копировании система вычисляет их контрольные суммы. По завершении копирования нажмите кнопку **Просмотреть панель мониторинга**, чтобы проверить используемое и свободное место на устройстве.
    
![Проверка свободного и использованного места на панели мониторинга](media/data-box-deploy-copy-data-via-copy-service/verify-used-space-dashboard.png)

> [!IMPORTANT]
> Повторите те же инструкции, чтобы скопировать данные на второй узел Data Box Heavy.

После завершения задания копирования можно нажать кнопку **Подготовка к отправке**.

>[!NOTE]
> **Подготовка к отправке** недоступна во время выполнения заданий копирования.

## <a name="next-steps"></a>Дальнейшие действия

Перейдите к следующему руководству, чтобы узнать, как отправить свое устройство Data Box Heavy обратно в корпорацию Майкрософт.

> [!div class="nextstepaction"]
> [Руководство по Возврат устройства Azure Data Box Heavy и проверка корректности передачи данных в Azure (предварительная версия)](./data-box-heavy-deploy-picked-up.md)