---
title: Использование собственных сертификатов с устройствами Azure Data Box и Azure Data Box Heavy
description: Как использовать собственные сертификаты для доступа к локальному веб-ИНТЕРФЕЙСу и хранилищу блога на Data Box или Data Box Heavy устройстве.
services: databox
author: v-dalc
ms.service: databox
ms.subservice: pod
ms.topic: article
ms.date: 12/11/2020
ms.author: alkohli
ms.openlocfilehash: 1836ed57305fd7e168961eb81670b56d4ce296cd
ms.sourcegitcommit: 5a999764e98bd71653ad12918c09def7ecd92cf6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/16/2021
ms.locfileid: "100545179"
---
# <a name="use-your-own-certificates-with-data-box-and-data-box-heavy-devices"></a>Использование собственных сертификатов с устройствами Data Box и Data Box Heavy

Во время обработки заказов самозаверяющие сертификаты создаются для доступа к локальному веб-ИНТЕРФЕЙСу и хранилищу больших двоичных объектов для Data Box или Data Box Heavy устройства. Если вы предпочитаете обмениваться данными с устройством через доверенный канал, можно использовать собственные сертификаты.

В статье описывается, как установить собственные сертификаты и как вернуться к сертификатам по умолчанию перед возвратом устройства в центр обработки данных. В нем также приводится сводка требований к сертификатам.

## <a name="about-certificates"></a>Сведения о сертификатах

Сертификат предоставляет ссылку между **открытым ключом** и сущностью (например, доменное имя), которые **подписаны** (проверены) доверенной сторонней стороной, такой как **центр сертификации**.  Сертификат предоставляет удобный способ распространения доверенных открытых ключей шифрования. Таким образом, сертификаты гарантируют, что связь является доверенной и вы отправляете зашифрованную информацию на нужный сервер.

При первоначальной настройке устройства Data Box автоматически создаются самозаверяющие сертификаты. При необходимости можно привести собственные сертификаты. Существуют рекомендации, которые необходимо выполнить, если планируется использовать собственные сертификаты.

На устройстве Data Box или Data Box Heavy используются два типа сертификатов конечной точки:

- Сертификат хранилища BLOB-объектов
- Локальный сертификат пользовательского интерфейса

### <a name="certificate-requirements"></a>Требования к сертификатам

Сертификаты должны соответствовать следующим требованиям.

- Сертификат конечной точки должен быть в `.pfx` формате с закрытым ключом, который можно экспортировать.
- Для каждой конечной точки можно использовать отдельный сертификат, многодоменный сертификат для нескольких конечных точек или сертификат конечной точки с подстановочными знаками.
- Свойства сертификата конечной точки похожи на свойства стандартного SSL-сертификата.
- На клиентском компьютере требуется соответствующий сертификат в формате DER ( `.cer` расширение имени файла).
- После отправки локального сертификата пользовательского интерфейса необходимо перезапустить браузер и очистить кэш. Ознакомьтесь с конкретными инструкциями в браузере.
- Сертификаты должны быть изменены при изменении имени устройства или доменного имени DNS.
- При создании сертификатов конечной точки используйте следующую таблицу:

  |Тип |Имя субъекта (SN)  |Альтернативное имя субъекта (SAN)  |Пример имени субъекта |
  |---------|---------|---------|---------|
  |Локальный пользовательский интерфейс| `<DeviceName>.<DNSdomain>`|`<DeviceName>.<DNSdomain>`| `mydevice1.microsoftdatabox.com` |
  |Хранилище BLOB-объектов|`*.blob.<DeviceName>.<DNSdomain>`|`*.blob.< DeviceName>.<DNSdomain>`|`*.blob.mydevice1.microsoftdatabox.com` |
  |Один сертификат для нескольких сетей SAN|`<DeviceName>.<DNSdomain>`|`<DeviceName>.<DNSdomain>`<br>`*.blob.<DeviceName>.<DNSdomain>`|`mydevice1.microsoftdatabox.com` |

Дополнительные сведения см. в разделе [требования к сертификатам](../../articles/databox-online/azure-stack-edge-gpu-certificate-requirements.md).

## <a name="add-certificates-to-device"></a>Добавление сертификатов на устройство

Вы можете использовать собственные сертификаты для доступа к локальному веб-ИНТЕРФЕЙСу и для доступа к хранилищу больших двоичных объектов.

> [!IMPORTANT]
> При изменении имени устройства или домена DNS необходимо создать новые сертификаты. После этого сертификаты клиентов и сертификаты устройств должны быть обновлены с учетом нового имени устройства и DNS-домена.

Чтобы добавить собственный сертификат на устройство, выполните следующие действия.

1. Перейдите к разделу **Управление**  >  **сертификатами**.

   **Название** отображает имя устройства. **Домен DNS** отображает доменное имя DNS-сервера.

   В нижней части экрана показаны используемые в данный момент сертификаты. Для нового устройства вы увидите самозаверяющие сертификаты, созданные во время обработки заказа.

   ![Страница «сертификаты» для устройства Data Box](media/data-box-bring-your-own-certificates/certificates-manage-certs.png)

2. Если вам нужно изменить **имя** (имя устройства) или **домен DNS** (домен DNS-сервера для устройства), сделайте это сейчас перед добавлением сертификата. Затем выберите **Применить**.

   Сертификат должен быть изменен при изменении имени устройства или доменного имени DNS.

   ![Применение нового имени устройства и DNS-домена для Data Box](media/data-box-bring-your-own-certificates/certificates-device-name-dns.png)

3. Чтобы добавить сертификат, щелкните **Добавить сертификат** , чтобы открыть панель **Добавление сертификата** . Затем выберите **тип сертификата** — **хранилище BLOB-объектов** или **локальный веб-интерфейс**.

   ![Панель "Добавление сертификатов" на странице "сертификаты" для Data Box устройства](media/data-box-bring-your-own-certificates/certificates-add-certificate-cert-type.png)

4. Выберите файл сертификата (в `.pfx` формате) и введите пароль, который был задан при экспорте сертификата. Затем выберите **проверить & добавить**.

   ![Параметры для добавления сертификата конечной точки BLOB-объекта в Data Box](media/data-box-bring-your-own-certificates/certificates-add-blob-cert.png)

   После успешного добавления сертификата на экране **Сертификаты** отображается отпечаток для нового сертификата. Сертификат имеет **допустимое** состояние.

   ![Допустимый новый сертификат, который был успешно добавлен](media/data-box-bring-your-own-certificates/certificates-view-new-certificate.png)

5. Чтобы просмотреть сведения о сертификате, выберите и щелкните имя сертификата. Срок действия сертификата истечет через год.

   ![Просмотр сведений о сертификате для Data Box устройства](media/data-box-bring-your-own-certificates/certificates-cert-details.png)

   <!--If you changed the local web UI certificate, you'll see the following error. This error will go away when you install the new certificate on the client computer.

   ![Error after a new Local web UI certificate is added to a Data Box device](media/data-box-bring-your-own-certificates/certificates-unable-to-communicate-error.png) TEST. RESTORE IF ERROR IS REPRODUCED.-->

6. Если вы изменили сертификат для локального веб-интерфейса, необходимо перезапустить браузер, а затем локальный веб-интерфейс. Этот шаг необходим, чтобы избежать проблем с кэшем SSL.

  <!-- TESTING THIS - The communication error should be gone from the **Certificates** screen.-->

7. Установите новый сертификат на клиентском компьютере, который вы используете для доступа к локальному веб-ИНТЕРФЕЙСу. Инструкции см. [в разделе Импорт сертификатов в клиент](#import-certificates-to-client).


## <a name="import-certificates-to-client"></a>Импорт сертификатов в клиент

После добавления сертификата на устройство Data Box необходимо импортировать сертификат на клиентский компьютер, который используется для доступа к устройству. Вы импортируете сертификат в хранилище доверенного корневого центра сертификации для локального компьютера.

Чтобы импортировать сертификат в клиенте Windows, выполните следующие действия.

1. В проводнике щелкните правой кнопкой мыши файл сертификата (с `.cer` форматом) и выберите **установить сертификат**. Запустится мастер импорта сертификатов.

    ![Импорт сертификата 1](media/data-box-bring-your-own-certificates/import-cert-01.png)

2. В качестве **расположения хранилища** выберите **локальный компьютер**, а затем нажмите кнопку **Далее**.

    ![Выбор локального компьютера в качестве расположения хранилища в мастере импорта сертификатов](media/data-box-bring-your-own-certificates/import-cert-02.png)

3. Выберите **поместить все сертификаты в следующее хранилище**, выберите **доверенный корневой центр сертификации**, а затем нажмите кнопку **Далее**.

   ![Выберите хранилище доверенных корневых центров сертификации в мастере импорта сертификатов.](media/data-box-bring-your-own-certificates/import-cert-03.png)

4. Проверьте параметры и нажмите кнопку **Готово**. Появится сообщение об успешном импорте.

   ![Проверьте параметры сертификата и завершите работу мастера импорта сертификатов.](media/data-box-bring-your-own-certificates/import-cert-04.png)

## <a name="revert-to-default-certificates"></a>Вернуться к сертификатам по умолчанию

Перед возвратом устройства в центр обработки данных Azure следует вернуться к исходным сертификатам, которые были созданы во время выполнения заказа.

Чтобы вернуться к сертификатам, созданным во время обработки заказа, выполните следующие действия.

1. Перейдите в раздел **Управление**  >  **сертификатами** и выберите **отменить сертификаты**.

   Возврат сертификатов осуществляется с помощью самозаверяющих сертификатов, созданных во время обработки заказа. Ваши собственные сертификаты удаляются с устройства.

   ![Параметр "восстановить сертификаты" в окне "Управление сертификатами" для Data Box устройства](media/data-box-bring-your-own-certificates/certificates-revert-certificates.png)

2. После успешного завершения повторной версии сертификата перейдите в раздел **Завершение работы или перезагрузка** и выберите **перезапустить**. Этот шаг необходим, чтобы избежать проблем с кэшем SSL.

   ![Завершение работы или перезапуск локального веб-интерфейса после возврата сертификатов на устройстве Data Box](media/data-box-bring-your-own-certificates/certificates-restart-ui.png)

   Подождите несколько минут, а затем снова войдите в локальный веб-интерфейс.
