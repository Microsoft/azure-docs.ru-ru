---
title: Преимущества использования Azure NetApp Files для развертывания SQL Server | Документация Майкрософт
description: Показывает более подробные сведения о производительности анализа затрат при использовании Azure NetApp Files для развертывания SQL Server.
services: azure-netapp-files
documentationcenter: ''
author: b-juche
manager: ''
editor: ''
ms.assetid: ''
ms.service: azure-netapp-files
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 03/19/2021
ms.author: b-juche
ms.openlocfilehash: 46fe7570b7b9ea9446918d407dbe87596b8d0496
ms.sourcegitcommit: 42e4f986ccd4090581a059969b74c461b70bcac0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2021
ms.locfileid: "104863910"
---
#  <a name="benefits-of-using-azure-netapp-files-for-sql-server-deployment"></a>Преимущества использования Azure NetApp Files для развертывания SQL Server

Azure NetApp Files сокращает SQL Server совокупной стоимости владения (TCO) по сравнению с решениями на хранение блоков.  При использовании блочного хранилища виртуальные машины накладывают ограничения на операции ввода-вывода и пропускную способность для операций с дисками, только ограничения пропускной способности сети применяются только к Azure NetApp Files.  Иными словами, для Azure NetApp Files не применяются ограничения ввода-вывода на уровне виртуальной машины. Без этих ограничений ввода-вывода SQL Server, выполняющиеся на небольших виртуальных машинах, подключенных к Azure NetApp Files, могут работать, а SQL Server работать на больших виртуальных машинах. При изменении размера экземпляров уменьшается стоимость вычислений до 25% от прежнего тега цены.  *Затраты на вычисление можно сократить с помощью Azure NetApp Files.*  

Однако затраты на вычислительные ресурсы невелики по сравнению с SQL Server стоимостью лицензии.  [Лицензирование](https://download.microsoft.com/download/B/C/0/BC0B2EA7-D99D-42FB-9439-2C56880CAFF4/SQL_Server_2017_Licensing_Datasheet.pdf) Microsoft SQL Server связано с физическим числом ядер. Таким образом, уменьшение размера экземпляра представляет собой еще больше затрат на сохранение для лицензирования программного обеспечения. *Вы можете сократить затраты на лицензии на программное обеспечение с помощью Azure NetApp Files.*

Стоимость хранилища зависит от фактического размера базы данных. Независимо от выбранного хранилища, емкость имеет стоимость управляемого диска или файлового ресурса.  По мере увеличения размера базы данных и увеличения затрат хранилище повышает совокупную стоимость владения, что влияет на общую стоимость.  Таким образом, утверждение корректируется следующим образом: *затраты на развертывание SQL Server можно сократить с помощью Azure NetApp Files.* 

В этой статье приводятся подробные сведения об анализе затрат и преимуществах использования Azure NetApp Files для развертывания SQL Server. Не только небольшие экземпляры имеют достаточный объем процессора для работы с базой данных только с блоками на больших экземплярах *. во многих случаях меньшие экземпляры еще более производительны, чем их крупные, в связи с Azure NetApp Files.* 

## <a name="detailed-cost-analysis"></a>Подробный анализ затрат 

Два набора графических объектов в этом разделе показывают пример TCO.  Количество и тип управляемых дисков, уровень обслуживания Azure NetApp Files и емкость каждого сценария были выбраны для достижения наилучшей производительности цены и емкости.  Каждая графика состоит из сгруппированных компьютеров (D16 с Azure NetApp Files, по сравнению с D64 с управляемым диском по образцу), и цены разбиваются для каждого типа машины.  

Первый набор графики показывает общую стоимость решения, используя размер базы данных Тиб, сравнивая D16s_v3 с D64, D8 для D32 и D4 до D16. Планируемые операции ввода-вывода в секунду для каждой конфигурации обозначены зеленой или желтой линией и соответствуют правой оси Y.

[![График, показывающий общую стоимость решения с использованием размера базы данных Тиб 1. ](../media/azure-netapp-files/solution-sql-server-cost-1-tib.png)](../media/azure-netapp-files/solution-sql-server-cost-1-tib.png#lightbox)


Во втором наборе показана общая стоимость использования базы данных 50-тиб. В противном случае сравнения — D16 по сравнению с Azure NetApp Files и D64 с Block по образцу. 

[![Рисунок, показывающий общую стоимость при использовании размера базы данных 50-тиб. ](../media/azure-netapp-files/solution-sql-server-cost-50-tib.png)](../media/azure-netapp-files/solution-sql-server-cost-50-tib.png#lightbox)
 
## <a name="performance-and-lots-of-it"></a>Производительность и многие из них  

Для доставки значительных затрат на снижение стоимости требуется много производительности — самые крупные экземпляры в общей службе поддержки инвентаризации Azure 80 000 дисковых операций ввода-вывода в секунду. Один Azure NetApp Files том может достичь 80 000 операций ввода-вывода в базу данных, и такие экземпляры, как D16, могут использовать одинаковые. D16, как правило, поддерживает 25 600 операций ввода-вывода на диск, составляет 25% от размера D64.  D64s_v3 поддерживает 80 000 операций ввода-вывода на диск, и, таким образом, предоставляет отличную точку сравнения верхнего уровня.

D16s_v3 может вычислить Azure NetApp Files тома до 80 000 операций ввода-вывода в базу данных. Как проверено средством тестирования производительности хранилища SQL (SSB), экземпляр D16 достигает рабочей нагрузки 125% больше, чем достижимая на диск из экземпляра D64.  Дополнительные сведения о средстве см. в разделе [средство тестирования SSB](#ssb-testing-tool) .

Используя размер рабочего набора Тиб и 80% обновления, 20% обновлений SQL Server, производительность большинства экземпляров в классе экземпляра D измерена. Большинство, не все, так как сами экземпляры D2 и D64 были исключены из тестирования. Первый из них был оставлен, так как он не поддерживает ускорение работы в сети, а второй — это точка сравнения. Ознакомьтесь со следующей диаграммой, чтобы узнать об ограничениях D4s_v3, D8s_v3, D16s_v3 и D32s_v3 соответственно.  Тесты хранилища управляемых дисков не отображаются на графике. Значения сравнения выводятся непосредственно из [таблицы ограничений виртуальной машины Azure](../virtual-machines/dv3-dsv3-series.md) для типа экземпляра класса D.

С Azure NetApp Files каждый экземпляр в классе D может соответствовать или превышать возможности производительности дисков экземпляров в два раза больше.  *Azure NetApp Files может значительно снизить затраты на лицензии на программное обеспечение.*  

* Значение D4 в 75% использования ЦП соответствует возможностям диска D16.  
    * Частота D16 ограничена в 25 600 дисковых операций ввода-вывода.  
* D8 на уровне 75% загрузки ЦП соответствует возможностям диска d32.  
    * Частота d32 ограничена в 51 200 дисковых операций ввода-вывода.  
* D16 при загрузке ЦП на 55% соответствует возможностям диска D64.  
    * Частота D64 ограничена в 80 000 дисковых операций ввода-вывода.  
* D32 с использованием процессора на 15% соответствует возможностям диска D64.  
    * D64, как указано выше, имеет ограничение частоты в 80 000 операций ввода-вывода на диск.  

### <a name="s3b-cpu-limits-test--performance-versus-processing-power"></a>Тестирование ограничений S3B ЦП — производительность и вычислительная мощность

На следующей диаграмме приведена сводка по тестированию ограничений ЦП S3B.

![Схема, показывающая средний процент использования ЦП для SQL Server с одним экземпляром Azure NetApp Files.](../media/azure-netapp-files/solution-sql-server-single-instance-average-cpu.png)

Масштабируемость является лишь частью истории. Другая часть — задержка.  Это одно из целей для небольших виртуальных машин, чтобы иметь возможность значительно повысить скорость ввода-вывода, это еще одна вещь, с низкой задержкой в одну цифру, как показано ниже.  

* Значение D4, 26 000 операций ввода-вывода в секунду с Azure NetApp Files при 2,3-МС задержке.  
* D8 найдет 51 000 операций ввода-вывода в секунду для Azure NetApp Files с 2,0-MS задержкой.  
* D16 найдет 88 000 операций ввода-вывода в Azure NetApp Files секунду в течение 2,8-MS задержка.
* D32 найдет 80 000 операций ввода-вывода в Azure NetApp Files секунду в течение 2,4-MS задержка.  

### <a name="s3b-per-instance-type-latency-results"></a>Результаты задержки типа S3B для каждого экземпляра

На следующей схеме показана задержка для SQL Server с одним экземпляром Azure NetApp Files:

![Схема, показывающая задержку для SQL Server с одним экземпляром Azure NetApp Files.](../media/azure-netapp-files/solution-sql-server-single-instance-latency.png)

## <a name="ssb-testing-tool"></a>Средство тестирования SSB 
 
Средство создания тестов производительности [TPC-E](http://www.tpc.org/tpce/) позволяет нагрузить *Вычисление* , а не *хранилище*. Результаты теста, приведенные в этом разделе, основаны на средстве стресс-тестирования, именуемом тестовым результатом хранилища SQL (SSB).  SQL Server тестовое хранилище позволяет выполнять крупномасштабное выполнение SQL в базе данных SQL Server для имитации рабочей нагрузки OLTP, аналогично [средству производительности SLOB2 Oracle](https://kevinclosson.net/slob/). 

Средство SSB создает рабочую нагрузку SELECT и UPDATE, выполняя выдаваемые инструкции непосредственно в SQL Server базу данных, работающую на виртуальной машине Azure.  Для этого проекта рабочие нагрузки SSB повышены с 1 до 100 SQL Server пользователей, с 10 или 12 средними точками по 15 минут на число пользователей.  Все метрики производительности, полученные от этих запусков, были получены с точки зрения PerfMon, что для повторяемости SSB выполнялось три раза в сценарии. 

Сами тесты были настроены как 80% SELECT и 20% инструкции UPDATE, поэтому 90% случайных чтений.  База данных, созданная SSB, была в размере 1000 ГБ. Он состоит из 15 пользовательских таблиц и 9 000 000 строк на каждую пользовательскую таблицу и 8192 байт на строку. 

Тест производительности SSB — это средство с открытым исходным кодом.  Его можно бесплатно получить на [странице GitHub теста производительности хранилища SQL](https://github.com/NetApp/SQL_Storage_Benchmark.git).  


## <a name="in-summary"></a>В сводке  

С Azure NetApp Files можно повысить производительность SQL Server, одновременно уменьшая совокупную стоимость владения. 

## <a name="next-steps"></a>Next Steps

* [Создание тома SMB для Azure NetApp Files](azure-netapp-files-create-volumes-smb.md) 
* [Архитектуры решений с использованием Azure NetApp Files — SQL Server](azure-netapp-files-solution-architectures.md#sql-server) 

