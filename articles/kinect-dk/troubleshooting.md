---
title: Известные проблемы и устранение неполадок в Azure Kinect
description: Ознакомьтесь с некоторыми известными проблемами и советами по устранению неполадок при использовании пакета SDK для датчиков с Azure Kinect DK.
author: tesych
ms.author: tesych
ms.prod: kinect-dk
ms.date: 06/26/2019
ms.topic: conceptual
keywords: Устранение неполадок, обновление, ошибка, Kinect, обратная связь, восстановление, ведение журнала, советы
ms.openlocfilehash: 5f13815b8f8b26f6a08da28181a4a6164b7b89a3
ms.sourcegitcommit: f3ec73fb5f8de72fe483995bd4bbad9b74a9cc9f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2021
ms.locfileid: "102038826"
---
# <a name="azure-kinect-known-issues-and-troubleshooting"></a>Известные проблемы и устранение неполадок в Azure Kinect

На этой странице содержатся известные проблемы и советы по устранению неполадок при использовании пакета SDK для датчика с Azure Kinect DK. Дополнительные сведения о проблемах, связанных с оборудованием продукта, см. на [странице поддержки продукта](./index.yml) .

## <a name="known-issues"></a>Известные проблемы

- Проблемы совместимости с Асмедиа USB Host Controllers (например, набор микросхем ASM1142)
  - В некоторых случаях с помощью драйвера Microsoft USB можно разблокировать
  - Многие компьютеры также имеют альтернативные контроллеры узлов и изменение порта USB3 может помочь

Дополнительные сведения [о проблемах,](https://github.com/Microsoft/Azure-Kinect-Sensor-SDK/issues) связанных с пакетом SDK для датчика, см. в этой теме.

## <a name="collecting-logs"></a>Сбор журналов

Ведение журнала для K4A.dll включается с помощью переменных среды. По умолчанию журнал отправляется в stdout, и создаются только ошибки и критические сообщения. Эти параметры можно изменить, чтобы ведение журнала перейдет в файл. Уровень детализации также можно настроить по мере необходимости. Ниже приведен пример для Windows, позволяющий вести журнал в файле с именем k4a. log и записывать предупреждения и сообщения более высокого уровня.

1. `set K4A_ENABLE_LOG_TO_A_FILE=k4a.log`
2. `set K4A_LOG_LEVEL=w`
3. Запуск сценария из командной строки (например, запуск средства просмотра)
4. Перейдите в k4a. log и предоставьте общий доступ к файлу.

Дополнительные сведения см. в разделе ниже клипа из файла заголовка:

```console
/**
* environment variables
* K4A_ENABLE_LOG_TO_A_FILE =
*    0    - completely disable logging to a file
*    log\custom.log - log all messages to the path and file specified - must end in '.log' to
*                     be considered a valid entry
*    ** When enabled this takes precedence over the value of K4A_ENABLE_LOG_TO_STDOUT
*
* K4A_ENABLE_LOG_TO_STDOUT =
*    0    - disable logging to stdout
*    all else  - log all messages to stdout
*
* K4A_LOG_LEVEL =
*    'c'  - log all messages of level 'critical' criticality
*    'e'  - log all messages of level 'error' or higher criticality
*    'w'  - log all messages of level 'warning' or higher criticality
*    'i'  - log all messages of level 'info' or higher criticality
*    't'  - log all messages of level 'trace' or higher criticality
*    DEFAULT - log all message of level 'error' or higher criticality
*/
```

Ведение журнала для пакета SDK для отслеживания текста K4ABT.dll аналогично, за исключением того, что пользователи должны изменить другой набор имен переменных среды:

```console
/**
* environment variables
* K4ABT_ENABLE_LOG_TO_A_FILE =
*    0    - completely disable logging to a file
*    log\custom.log - log all messages to the path and file specified - must end in '.log' to
*                     be considered a valid entry
*    ** When enabled this takes precedence over the value of K4A_ENABLE_LOG_TO_STDOUT
*
* K4ABT_ENABLE_LOG_TO_STDOUT =
*    0    - disable logging to stdout
*    all else  - log all messages to stdout
*
* K4ABT_LOG_LEVEL =
*    'c'  - log all messages of level 'critical' criticality
*    'e'  - log all messages of level 'error' or higher criticality
*    'w'  - log all messages of level 'warning' or higher criticality
*    'i'  - log all messages of level 'info' or higher criticality
*    't'  - log all messages of level 'trace' or higher criticality
*    DEFAULT - log all message of level 'error' or higher criticality
*/
```

## <a name="device-doesnt-enumerate-in-device-manager"></a>Устройство не перечислено в диспетчере устройств

- Проверьте индикатор состояния на устройстве. Если он мигает оранжевый, у вас возникла проблема с подключением по USB, и он не получит достаточно энергии. Кабель источника питания должен быть подключен к предоставленному адаптеру питания. В то время как кабель питания имеет подключенный тип USB, устройство требует больше энергии, чем может предоставить USB-порт компьютера. Поэтому не подключайте его к порту ПК или USB-концентратору.
- Убедитесь, что кабель питания подключен и для данных используется порт USB3.
- Попробуйте изменить порт USB3 для подключения к данным (рекомендуется использовать порт USB близко к материнской плате, например, на задней стороне ПК).
- Проверка кабеля, поврежденного или низкого качества кабелей может привести к ненадежному перечислению (устройство продолжает мигать в диспетчере устройств).
- Если вы подключились к ноутбуку и заработали аккумулятор, это может привести к регулированию мощности порта.
- Перезагрузка главного компьютера.
- Если проблема будет повторяться, может возникнуть проблема совместимости.
- Если во время обновления встроенного по произошел сбой и устройство не было восстановлено самостоятельно, выполните [Сброс параметров до заводских настроек](https://support.microsoft.com/help/4494277/reset-azure-kinect-dk).

## <a name="azure-kinect-viewer-fails-to-open"></a>Не удается открыть средство просмотра Kinect для Azure

- Сначала убедитесь, что устройство перечисляется в Windows диспетчер устройств.

    ![Kinect камер Azure в диспетчере устройств Windows](./media/resources/viewer-fails.png)

- Проверьте, есть ли у вас какое-либо другое приложение, использующее устройство (например, приложение камеры Windows). Доступ к устройству может получить только одно приложение за раз.
- Проверьте журнал k4aviewer. ERR на наличие сообщений об ошибках.
- Откройте приложение камеры Windows и проверьте его работоспособность.
- Power Cycle (устройство), ожидание потоковой передачи привело к выключению питания перед использованием устройства.
- Перезагрузка главного компьютера.
- Убедитесь, что вы используете последние версии графических драйверов на компьютере.
- Если вы используете собственную сборку пакета SDK, попробуйте использовать официально выпущенную версию, если она решает проблему.
- Если проблема сохраняется, [собирайте журналы](troubleshooting.md#collecting-logs) и отзывы файлов.

## <a name="cannot-find-microphone"></a>Не удается найти микрофон

- Сначала убедитесь, что массив микрофонов перечислен в диспетчер устройств.
- Если устройство перечислено и правильно работает в Windows в ином случае, это может быть вызвано тем, что после обновления встроенного по будет назначен другой идентификатор контейнера для камеры глубины.
- Вы можете попытаться сбросить его, перейдя в диспетчер устройств, щелкнув правой кнопкой мыши "массив микрофонов Azure Kinect" и выбрав "удалить устройство". После завершения этого датчика отсоедините и снова подключите датчик.

    ![Массив MIC Kinect для Azure](./media/resources/mic-not-found.png)

- После этого перезапустите средство просмотра Azure Kinect Viewer и повторите попытку.

## <a name="device-firmware-update-issues"></a>Проблемы с обновлением встроенного по устройства

- Если после обновления не отображается правильный номер версии, возможно, потребуется выключить устройство.
- Если обновление встроенного по прервано, оно может стать недопустимым и не будет перечисляться. Отсоедините и повторно подключите устройство и подождите 60 секунд, чтобы проверить, возможно ли его восстановление.
Если не выполнять сброс до [заводских настроек](https://support.microsoft.com/help/4494277/reset-azure-kinect-dk)

## <a name="image-quality-issues"></a>Проблемы с качеством изображения

- Запустите [средство просмотра Kinect Azure](azure-kinect-viewer.md) и проверьте расположение устройства на наличие помех или убедитесь, что датчик заблокирован или объектив является грязным.
- Попробуйте использовать разные режимы работы, чтобы уменьшить масштаб, если в определенном режиме происходит ошибка.
- Для совместного использования проблем с качеством изображений в команде можно:

1) Приостановите просмотр в [средстве просмотра Kinect Azure](azure-kinect-viewer.md) и сделайте снимок экрана или
2) Выполните запись с помощью [средства записи Azure Kinect](azure-kinect-recorder.md), например `k4arecorder.exe -l 5 -r 5 output.mkv`

## <a name="inconsistent-or-unexpected-device-timestamps"></a>Несоответствие или непредвиденные метки времени устройства

Вызов ```k4a_device_set_color_control``` может временно вызвать временные изменения на устройстве, для стабилизации которого может потребоваться несколько захватов. Избегайте вызова API в цикле записи образа, чтобы избежать сброса внутренних расчетов времени с каждым новым образом. Вместо этого вызовите API перед запуском камеры или просто при необходимости изменения значения в цикле записи образа. В частности, избегайте вызова ```k4a_device_set_color_control(K4A_COLOR_CONTROL_AUTO_EXPOSURE_PRIORITY)``` .

## <a name="usb3-host-controller-compatibility"></a>Совместимость с контроллером узла USB3

Если устройство не перечислено в диспетчере устройств, оно может быть связано с тем, что он подключен к неподдерживаемому контроллеру USB3. 

Для Azure Kinect DK в **Windows,** *поддерживаются только контроллеры узлов* Intel, **Texas Instruments (TI)** и **Renesas** . Пакет SDK для Azure Kinect на платформах Windows основывается на унифицированном ИДЕНТИФИКАТОРе контейнера, и он должен охватывать устройства USB 2,0 и 3,0, чтобы пакет SDK мог найти глубину, цвет и аудиоустройства, которые физически расположены на одном устройстве. В Linux могут поддерживаться дополнительные контроллеры узлов, так как эта платформа не зависит от идентификатора контейнера и других серийных номеров устройств. 

Раздел контроллеров узлов USB становится еще более сложным, если на компьютере установлено несколько хост-контроллеров. При смешении контроллеров узлов пользователь может столкнуться с проблемами, когда некоторые порты работают нормально, а другие не работают. В зависимости от того, как порты подключены к регистру, вы можете увидеть, что у всех внешних портов есть проблемы с Azure Kinect.

**Windows:** Чтобы узнать, какой контроллер узла открыт диспетчер устройств

1. Просмотр-> устройств по типу 
2. С помощью подключенной службы Azure Kinect SELECT камеры — >Kinect 4-килобайтной камеры Azure
3. Просмотр — > устройства по подключению

![Устранение неполадок USB-портов](./media/resources/usb-troubleshooting.png)

Чтобы лучше понять, какой USB-порт подключен к компьютеру, повторите эти действия для каждого USB-порта при подключении Azure Kinect DK к разным портам USB на компьютере.

## <a name="depth-camera-auto-powers-down"></a>Автоматический выбор камеры с глубиной

Лазерная камера, используемая камерой для вычисления данных глубины изображения, имеет ограниченный срок существования. Чтобы максимально увеличить время жизни лучами, Камера глубины определит, когда данные глубины не используются. При потоковой передаче устройства в течение нескольких минут питание камеры становится недоступным, но главный компьютер не считывает данные. Он также влияет на синхронизацию нескольких устройств, когда подчиненные устройства запускаются в состоянии, когда камера с глубиной потоковая передача и кадры глубины активно помогают ожидать, пока основное устройство не начнет синхронизировать записи. Чтобы избежать этой проблемы в сценариях создания нескольких устройств, убедитесь, что основное устройство начинается в течение минуты первого запуска. 

## <a name="using-body-tracking-sdk-with-unreal"></a>Использование пакета SDK для отслеживания текста с нереальными данными

Чтобы использовать пакет SDK для отслеживания текста с нереальными данными, убедитесь, что вы добавили `<SDK Installation Path>\tools` в переменную среды `PATH` и скопировали `dnn_model_2_0.onnx` и `cudnn64_7.dll` в `Program Files/Epic Games/UE_4.23/Engine/Binaries/Win64` .

## <a name="using-azure-kinect-on-headless-linux-system"></a>Использование Azure Kinect в системе с автономной системой Linux

Подсистема глубины Azure Kinect в Linux использует OpenGL. Для OpenGL требуется экземпляр окна, который требует, чтобы монитор был подключен к системе. Обходной путь для этой проблемы:

1. Включите автоматический вход в учетную запись пользователя, которую планируется использовать. Инструкции по включению автоматического входа см. в [этой](https://vitux.com/how-to-enable-disable-automatic-login-in-ubuntu-18-04-lts/) статье.
2. Выключите систему, отключите монитор и включите систему. Автоматический вход приводит к принудительному созданию сеанса x-Server.
2. Подключение через SSH и задание переменной среды дисплея `export DISPLAY=:0`
3. Запустите приложение Azure Kinect.

Служебную программу [кстрлокк](http://manpages.ubuntu.com/manpages/xenial/man1/xtrlock.1x.html) можно использовать для немедленной блокировки экрана после автоматического входа. Добавьте следующую команду в приложение запуска или системную службу:

`bash -c “xtrlock -b”` 

## <a name="missing-c-documentation"></a>Отсутствует документация по C#

Документация по пакету SDK для датчика C# находится [здесь](https://microsoft.github.io/Azure-Kinect-Sensor-SDK/master/namespace_microsoft_1_1_azure_1_1_kinect_1_1_sensor.html).

Документация по пакету SDK для отслеживания текста находится [здесь](https://microsoft.github.io/Azure-Kinect-Body-Tracking/release/1.x.x/namespace_microsoft_1_1_azure_1_1_kinect_1_1_body_tracking.html).

## <a name="next-steps"></a>Дальнейшие действия

[Дополнительные сведения о поддержке](support.md)