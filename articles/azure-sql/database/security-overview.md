---
title: Общие сведения о безопасности
titleSuffix: Azure SQL Database & Azure SQL Managed Instance
description: Сведения о безопасности в базе данных SQL Azure и Управляемый экземпляре SQL Azure, включая отличия от SQL Server.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=2
ms.devlang: ''
ms.topic: conceptual
author: jaszymas
ms.author: jaszymas
ms.reviewer: vanto, emlisa
ms.date: 10/26/2020
ms.openlocfilehash: 39119f62fa938f5f4f6529539d4ca9a84bdf8fd7
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94989196"
---
# <a name="an-overview-of-azure-sql-database-and-sql-managed-instance-security-capabilities"></a>Общие сведения о базе данных SQL Azure и возможностях безопасности SQL Управляемый экземпляр
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

В этой статье описаны основы защиты уровня данных приложения с помощью [базы данных SQL Azure](sql-database-paas-overview.md), [управляемый экземпляр Azure SQL](../managed-instance/sql-managed-instance-paas-overview.md)и [Azure синапсе Analytics](../../synapse-analytics/sql-data-warehouse/sql-data-warehouse-overview-what-is.md). Эта стратегия безопасности использует многоуровневый подход (эшелонированная защита), который представлен на следующем рисунке (уровни рассматриваются, начиная с наружного):

![Схема многоуровневой защиты на уровне подробностей. Данные клиентов — заключен на уровнях сетевой безопасности, управления доступом и угроз и защиты информации.](./media/security-overview/sql-security-layer.png)

## <a name="network-security"></a>Безопасность сети

База данных SQL Microsoft Azure, Управляемый экземпляр SQL и Azure синапсе Analytics предоставляют службу реляционной базы данных для облачных и корпоративных приложений. Для защиты данных клиентов брандмауэры предотвращают сетевой доступ к серверу, пока доступ не будет явно предоставлен на основе IP-адреса или источника трафика виртуальной сети Azure.

### <a name="ip-firewall-rules"></a>Правила брандмауэра для IP-адресов

Правила брандмауэра для IP-адресов предоставляют доступ к базам данным на основе исходного IP-адреса каждого запроса. Дополнительные сведения см. в статье Общие сведения о [правилах брандмауэра базы данных SQL Azure и Azure синапсе Analytics](firewall-configure.md).

### <a name="virtual-network-firewall-rules"></a>Правила брандмауэра для виртуальной сети

[Конечные точки службы виртуальной сети](../../virtual-network/virtual-network-service-endpoints-overview.md) расширяют возможности подключения к виртуальной сети по магистрали Azure и позволяют базе данных SQL Azure обнаруживать подсеть виртуальной сети, из которой исходит трафик. Чтобы трафик поступал в базу данных SQL Azure, используйте [теги служб](../../virtual-network/network-security-groups-overview.md) SQL, которые разрешают исходящий трафик через механизм групп безопасности сети.

[Правила виртуальной сети](vnet-service-endpoint-rule-overview.md) позволяют базе данных SQL Azure принимать только подключения, отправленные из выбранных подсетей в виртуальной сети.

> [!NOTE]
> Управление доступом с помощью правил брандмауэра *не* применяется к **SQL управляемый экземпляр**. Дополнительные сведения о необходимой конфигурации сети см. в разделе [Подключение к управляемому экземпляру](../managed-instance/connect-application-instance.md) .

## <a name="access-management"></a>Управление доступом

> [!IMPORTANT]
> Управление базами данных и серверами в Azure осуществляется путем назначения ролей учетной записи пользователя портала. Дополнительные сведения об [управлении доступом на основе ролей в портал Azure](../../role-based-access-control/overview.md)см. в этой статье.

### <a name="authentication"></a>Аутентификация

Аутентификацией называют процесс подтверждения личности пользователя. База данных SQL Azure и SQL Управляемый экземпляр поддерживают два типа проверки подлинности:

- **Проверка подлинности SQL**:

    Проверка подлинности SQL означает проверку подлинности пользователя при подключении к базе данных SQL Azure или Azure SQL Управляемый экземпляр с использованием имени пользователя и пароля. При создании сервера необходимо указать имя для входа **администратора сервера** с именем пользователя и паролем. Используя эти учетные данные, **Администратор сервера** может пройти проверку подлинности в любой базе данных на этом сервере или экземпляре в качестве владельца базы данных. После этого администратор сервера сможет создать дополнительные имена входа и пользователей SQL, чтобы позволить пользователям подключаться с выделенными для них именами пользователей и паролями.

- **Azure Active Directory проверка подлинности**:

    Azure Active Directoryная проверка подлинности — это механизм подключения к [базе данных SQL Azure](sql-database-paas-overview.md), [Azure SQL управляемый экземпляр](../managed-instance/sql-managed-instance-paas-overview.md) и [Azure синапсе Analytics](../../synapse-analytics/sql-data-warehouse/sql-data-warehouse-overview-what-is.md) с помощью удостоверений в Azure Active Directory (Azure AD). Аутентификация Azure AD позволяет администраторам централизованно управлять удостоверениями и разрешениями пользователей базы данных вместе с другими службами Azure в одном централизованном расположении. Это снижает количество хранимых паролей, а также позволяет применять централизованные политики их смены.

     Чтобы применить для Базы данных SQL аутентификацию Azure AD, необходимо создать администратора сервера, который в этом контексте называется **администратором Active Directory**. См. дополнительные сведения об [использовании аутентификации Azure Active Directory для аутентификации с помощью SQL](authentication-aad-overview.md). Аутентификация Azure AD поддерживает как управляемые, так и федеративные учетные записи. Федеративные учетные записи применимы для пользователей и групп Windows в пользовательских доменах, для которых настроена федерация с Azure AD.

    Кроме того, для аутентификации Azure Active Directory доступны [универсальная аутентификация Active Directory для SQL Server Management Studio](authentication-mfa-ssms-overview.md), которая поддерживает [многофакторную проверку подлинности](../../active-directory/authentication/concept-mfa-howitworks.md), и [условный доступ](conditional-access-configure.md).

> [!IMPORTANT]
> Управление базами данных и серверами в Azure осуществляется путем назначения ролей учетной записи пользователя портала. Дополнительные сведения об [управлении доступом на основе ролей в Azure](../../role-based-access-control/overview.md)см. в статье портал Azure. Управление доступом с помощью правил брандмауэра *не* применяется к **SQL управляемый экземпляр**. Дополнительные сведения о необходимой конфигурации сети см. в следующей статье о [подключении к управляемому экземпляру](../managed-instance/connect-application-instance.md) .

## <a name="authorization"></a>Авторизация

Авторизация относится к разрешениям, назначенным пользователю в базе данных SQL Azure или Управляемый экземпляр Azure SQL, и определяет, что разрешено выполнять пользователю. Управление разрешениями осуществляется путем добавления учетных записей пользователей в [роли базы данных](/sql/relational-databases/security/authentication-access/database-level-roles) и назначения им разрешений уровня базы данных для этих ролей или предоставления пользователю определенных [разрешений на уровне объектов](/sql/relational-databases/security/permissions-database-engine). См. дополнительные сведения об [операциях входа и пользователях](logins-create-manage.md).

Рекомендуется создавать пользовательские роли при необходимости. Добавьте пользователей к роли с минимальными привилегиями, необходимыми для работы их функций. Не назначайте разрешения пользователям напрямую. Учетная запись администратора сервера является членом встроенной роли db_owner, которая обладает широкими разрешениями и должна предоставляться только некоторым пользователям с административными обязанностями. Для приложений используйте [инструкцию EXECUTE AS](/sql/t-sql/statements/execute-as-clause-transact-sql) , чтобы указать контекст выполнения вызванного модуля или использовать [роли приложения](/sql/relational-databases/security/authentication-access/application-roles) с ограниченными разрешениями. Такой подход гарантирует, что приложение, которое подключается к базе данных, имеет минимальные привилегии, необходимые для приложения. Следующие рекомендации также способствуют разделению обязанностей.

### <a name="row-level-security"></a>Безопасность на уровне строк

Безопасность на уровне строк позволяет клиентам контролировать доступ к строкам в таблице базы данных в зависимости от характеристик пользователя, выполняющего запрос (например, от членства в группах или контекста выполнения). Row-Level безопасность может также использоваться для реализации пользовательских концепций безопасности на основе меток. Дополнительные сведения см. в разделе [безопасность на уровне строк](/sql/relational-databases/security/row-level-security).

![Схема, показывающая, что Row-Level безопасности изолирует отдельные строки базы данных SQL от доступа пользователей через клиентское приложение.](./media/security-overview/azure-database-rls.png)

## <a name="threat-protection"></a>Защита от угроз

База данных SQL и SQL Управляемый экземпляр безопасность данных клиентов, предоставляя возможности аудита и обнаружения угроз.

### <a name="sql-auditing-in-azure-monitor-logs-and-event-hubs"></a>Аудит SQL в журналах Azure Monitor и концентраторах событий

Аудит базы данных SQL и SQL Управляемый экземпляр отслеживает действия базы данных и помогает поддерживать соответствие стандартам безопасности, записывая события базы данных в журнал аудита в учетной записи хранения Azure, принадлежащей клиенту. Благодаря аудиту пользователи могут в реальном времени отслеживать действия в базе данных, а также анализировать и изучать действия за прошедшие периоды, чтобы выявить потенциальные угрозы, возможные нарушения и риски безопасности. Дополнительные сведения см. в статье Приступая к работе с [аудитом базы данных SQL](../../azure-sql/database/auditing-overview.md).  

### <a name="advanced-threat-protection"></a>Расширенная защита от угроз

С помощью расширенной защиты от угроз выполняется анализ журналов, чтобы обнаружить необычное поведение и потенциально опасные попытки доступа к базам данных или их использования. Оповещения создаются для подозрительных действий, таких как атака путем внедрения кода SQL, потенциальных несанкционированного доступа данных, атак методом подбора или аномалий в шаблонах доступа для перехвата укрупнений привилегий и использования учетных данных. Оповещения просматриваются из  [центра безопасности Azure](https://azure.microsoft.com/services/security-center/), где указаны сведения о подозрительных действиях, а также рекомендации по устранению угроз для дальнейшего изучения. Расширенную защиту от угроз можно включить для каждого сервера за дополнительную плату. Дополнительные сведения см. в статье [Приступая к работе с расширенной защитой угроз базы данных SQL](threat-detection-configure.md).

![Схема, на которой показан доступ мониторинга угроз SQL к базе данных SQL для веб-приложения от внешнего злоумышленника и вредоносной предварительной оценки.](./media/security-overview/azure-database-td.jpg)

## <a name="information-protection-and-encryption"></a>Защита и шифрование информации

### <a name="transport-layer-security-encryption-in-transit"></a>Безопасность транспортного уровня (шифрование во время передачи)

База данных SQL, SQL Управляемый экземпляр и Azure синапсе Analytics защищают данные клиентов путем шифрования данных в движении с помощью [протокола TLS](https://support.microsoft.com/help/3135244/tls-1-2-support-for-microsoft-sql-server).

База данных SQL, SQL Управляемый экземпляр и Azure синапсе Analytics принудительно применяют шифрование (SSL/TLS) для всех подключений. Это гарантирует, что все данные шифруются "при передаче" между клиентом и сервером независимо от значения параметра **Encrypt** или **TrustServerCertificate** в строке подключения.

Рекомендуется, чтобы в строке подключения, используемой приложением, было указано зашифрованное соединение и сертификат сервера _**не**_ является доверенным. Это заставляет приложение проверять сертификат сервера и, таким образом, предотвращает возможность уязвимости приложения для атак типа "злоумышленник в середине".

Например, при использовании драйвера ADO.NET это выполняется с помощью функции  **Encrypt = true** и **TrustServerCertificate = false**. Строка подключения, полученная с портала Azure, будет содержать правильные параметры.

> [!IMPORTANT]
> Обратите внимание, что некоторые драйверы сторонних производителей могут не использовать TLS по умолчанию или полагаться на более старую версию TLS (<1,2) для работы. В этом случае сервер по-прежнему позволяет подключаться к базе данных. Однако рекомендуется оценить риски безопасности, позволяющие таким драйверам и приложениям подключаться к базе данных SQL, особенно если вы храните конфиденциальные данные.
>
> Дополнительные сведения о TLS и подключении см. в статье [рекомендации по TLS](connect-query-content-reference-guide.md#tls-considerations-for-database-connectivity) .

### <a name="transparent-data-encryption-encryption-at-rest"></a>Прозрачное шифрование данных (шифрование при хранении)

[Прозрачное шифрование данных (TDE) для базы данных SQL, sql управляемый экземпляр и Azure синапсе Analytics](transparent-data-encryption-tde-overview.md) добавляет уровень безопасности, позволяющий защитить недоступные или автономные данные от несанкционированного доступа к необработанным файлам или резервным копиям. Распространенные сценарии включают в себя кражу центра обработки данных или небезопасное удаление оборудования или носителей, например дисков и лент резервных копий.TDE шифрует всю базу данных с помощью алгоритма шифрования AES, который не требует от разработчиков приложений вносить изменения в существующие приложения.

В Azure все вновь созданные базы данных шифруются по умолчанию, а ключ шифрования базы данных защищен встроенным сертификатом сервера.  Обслуживание и смена сертификатов управляются службой и не требует от пользователя никаких входных данных. Если клиент предпочитает самостоятельно контролировать ключи шифрования, он может управлять ими через [Azure Key Vault](../../key-vault/general/secure-your-key-vault.md).

### <a name="key-management-with-azure-key-vault"></a>Управление ключами с помощью Azure Key Vault

Поддержка [Создание собственных ключей](transparent-data-encryption-byok-overview.md) (BYOK) для [прозрачное шифрование данных](/sql/relational-databases/security/encryption/transparent-data-encryption) (TDE) позволяет клиентам становиться владельцами управления ключами и вращения с помощью [Azure Key Vault](../../key-vault/general/secure-your-key-vault.md), облачной системы управления внешними ключами Azure. В случае отзыва доступа базы данных к хранилищу ключей расшифровка и считывание такой базы данных станет невозможным. Azure Key Vault предоставляет централизованную платформу для управления ключами, которая использует тщательно отслеживаемые аппаратные модули безопасности (HSM) и позволяет разделять обязанности по управлению ключами и данными, обеспечивая соответствие требованиям безопасности.

### <a name="always-encrypted-encryption-in-use"></a>Always Encrypted (шифрование при использовании)

![Схема, на которой показаны основные сведения о функции Always Encrypted. Доступ к базе данных SQL с блокировкой осуществляется только приложением, содержащим ключ.](./media/security-overview/azure-database-ae.png)

Функция [Always Encrypted](/sql/relational-databases/security/encryption/always-encrypted-database-engine) разработана для защиты от доступа к конфиденциальным данным, которые хранятся в определенных столбцах базы данных (например, номера кредитных карт или персональные коды, а также данные, доступ к которым предоставляется _строго ограниченному кругу лиц_). Например, администраторы баз данных или другие привилегированные пользователи имеют доступ к базе данных для выполнения задач управления, но с точки зрения бизнеса им не нужен доступ к конкретным данным в зашифрованных столбцах. Данные всегда зашифрованы и расшифровываются только для обработки в клиентских приложениях, которые имеют доступ к ключу шифрования. Ключ шифрования никогда не предоставляется для базы данных SQL или SQL Управляемый экземпляр и может храниться либо в [хранилище сертификатов Windows](always-encrypted-certificate-store-configure.md) , либо в [Azure Key Vault](always-encrypted-azure-key-vault-configure.md).

### <a name="dynamic-data-masking"></a>Динамическое маскирование данных

![Схема, показывающая динамическое Маскирование данных. Бизнес-приложение отправляет данные в базу данных SQL, которая маскирует данные перед их отправкой в бизнес-приложение.](./media/security-overview/azure-database-ddm.png)

Динамическое маскирование данных ограничивает возможность раскрытия конфиденциальных данных за счет маскирования этих данных для непривилегированных пользователей. Динамическое маскирование данных автоматически обнаруживает потенциально конфиденциальные данные в базе данных SQL Azure и Управляемый экземпляр SQL и предоставляет практические рекомендации для маскирования этих полей с минимальным влиянием на уровень приложения. Эта функция работает по принципу обсфукации, скрывая конфиденциальные данные в результирующем наборе запроса по заданным полям базы данных, не меняя сами данные в базе данных. Дополнительные сведения см. в [статьях Приступая к работе с базой данных SQL и sql управляемый экземпляр динамическое Маскирование данных](dynamic-data-masking-overview.md).

## <a name="security-management"></a>Управление безопасностью

### <a name="vulnerability-assessment"></a>Оценка уязвимостей

[Оценка уязвимостей](sql-vulnerability-assessment.md) — это легко настраиваемая служба, которая помогает обнаруживать, отслеживать и устранять потенциальные уязвимости, что позволяет предварительно повышать общую защиту базы данных. Оценка уязвимостей является частью предложения "защитник Azure для SQL", которое является единым пакетом для расширенных возможностей обеспечения безопасности SQL. Доступ к оценке уязвимостей и управление ими можно получить с помощью центрального портала Azure Defender для SQL.

### <a name="data-discovery-and-classification"></a>Обнаружение и классификация данных

Обнаружение и классификация данных (в настоящее время в предварительной версии) предоставляет расширенные возможности, встроенные в базу данных SQL Azure и Управляемый экземпляр SQL, для обнаружения, классификации, добавления меток и защиты конфиденциальных данных в базах данных. Обнаружение и классификация конфиденциальных данных (деловых или финансовых, медицинских, персональных данных и т. д.) может играть ключевую роль в концепции защиты информации вашей организации. На основе этих процессов может формироваться инфраструктура для решения следующих задач:

- Различные сценарии безопасности, такие как мониторинг (аудит) и оповещение об аномальном доступе к конфиденциальным данным.
- Управление доступом к базам данных, содержащим конфиденциальные данные, и усиление их защиты.
- соблюдение стандартов конфиденциальности данных и нормативных требований;

Дополнительные сведения см. в статье [Приступая к работе с обнаружением и классификацией данных](data-discovery-and-classification-overview.md).

### <a name="compliance"></a>Соответствие нормативным требованиям

В дополнение к приведенным выше функциям и возможностям, которые помогают выполнять требования к безопасности приложений, в отношении Базы данных SQL Azure регулярно проводится аудит, а сама база данных сертифицирована в соответствии с рядом стандартов. Дополнительные сведения см. в [центре управления безопасностью Microsoft Azure](https://www.microsoft.com/trust-center/compliance/compliance-overview) , где можно найти самый актуальный список сертификатов соответствия базы данных SQL.

## <a name="next-steps"></a>Дальнейшие действия

- Обсуждение использования имен входа, учетных записей пользователей, ролей базы данных и разрешений в базе данных SQL и Управляемый экземпляр SQL см. в статье [Управление именами входа и учетными записями пользователей](logins-create-manage.md).
- Описание аудита базы данных см. в разделе [Audit](../../azure-sql/database/auditing-overview.md).
- Обсуждение обнаружения угроз см. в разделе [обнаружение угроз](threat-detection-configure.md).