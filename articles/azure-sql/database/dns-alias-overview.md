---
title: Псевдоним DNS
description: Приложения могут подключаться к псевдониму для имени сервера базы данных SQL Azure. Кроме того, в любое время можно изменить базу данных SQL, на которую указывает псевдоним, чтобы упростить тестирование и т. д.
services: sql-database
ms.service: sql-database
ms.subservice: operations
ms.custom: seo-lt-2019 sqldbrb=1
ms.devlang: ''
ms.topic: conceptual
author: rohitnayakmsft
ms.author: rohitna
ms.reviewer: genemi, jrasnick, vanto
ms.date: 06/26/2019
ms.openlocfilehash: 25c2157a8de237d0ec66caa72d59c810d419ac76
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94989128"
---
# <a name="dns-alias-for-azure-sql-database"></a>Псевдоним DNS для Базы данных SQL Azure
[!INCLUDE[appliesto-sqldb-asa](../includes/appliesto-sqldb-asa.md)]

Для Базы данных SQL Azure существует сервер службы доменных имен (DNS). Интерфейсы PowerShell и API-интерфейсов RESTFUL принимают [вызовы для создания псевдонимов DNS](#anchor-powershell-code-62x) для [логического имени SQL Server](logical-servers.md) и управления ими.

Вместо имени сервера можно использовать *DNS-псевдоним* . Клиентские программы могут использовать псевдоним в строке подключения. Псевдоним DNS предоставляет слой преобразования, который может перенаправить клиентские программы на разные сервера. Этот слой избавляет вас от необходимости находить и редактировать все клиенты и их строки подключения.

Далее представлены общие случаи использования псевдонимов DNS:

- Создайте легко запоминающееся имя для сервера.
- Во время начальной разработки ваш псевдоним может ссылаться на тестовый сервер. После активации приложения вы можете изменить псевдоним, чтобы он ссылался на рабочий сервер. Переход от теста к рабочей среде не требует изменения конфигураций нескольких клиентов, подключающихся к серверу.
- Предположим, что единственная база данных в приложении перемещается на другой сервер. Псевдоним можно изменить без изменения конфигурации нескольких клиентов.
- Во время регионального сбоя вы используете геовосстановление для восстановления базы данных в другом сервере и регионе. Существующий псевдоним можно изменить, чтобы он указывал на новый сервер, чтобы существующее клиентское приложение могло повторно подключиться к нему.

## <a name="domain-name-system-dns-of-the-internet"></a>Служба доменных имен (DNS) Интернета

Интернет использует службу доменных имен (DNS). DNS преобразует понятные имена в имя сервера.

## <a name="scenarios-with-one-dns-alias"></a>Сценарии с одним псевдонимом DNS

Предположим, что необходимо переключить систему на новый сервер. Раньше вам нужно было найти и обновить каждую строку подключения в каждой клиентской программе. Но теперь, если в строках подключения используется псевдоним DNS, необходимо обновить только свойство "псевдоним".

Компонент "псевдоним" DNS Базы данных SQL Azure можно использовать в следующих сценариях.

### <a name="test-to-production"></a>Переход от тестовой к рабочей среде

Включите использование псевдонима DNS в строках подключения в разработку клиентских программ. Вы сделаете свойства точки псевдонима тестовой версией сервера.

Позже, когда новая система будет находиться в рабочей среде, можно обновить свойства псевдонима, чтобы он указывал на рабочий сервер. Никаких изменений в клиентских программах не требуется.

### <a name="cross-region-support"></a>Поддержка перехода в другой регион

Аварийное восстановление может привести к смене сервера на другой географический регион. Для системы, в которой использовался псевдоним DNS, можно избежать необходимости найти и обновить все строки подключения для всех клиентов. Вместо этого можно обновить псевдоним, чтобы он ссылался на новый сервер, на котором теперь размещена база данных SQL Azure.

## <a name="properties-of-a-dns-alias"></a>Свойства псевдонима DNS

Следующие свойства применяются к каждому DNS-псевдониму сервера.

- *Уникальное имя:* Каждое создаваемое имя псевдонима уникально на всех серверах, как и имена серверов.
- *Необходим сервер.* Псевдоним DNS обязательно должен ссылаться на имеющийся сервер. В противном случае создать псевдоним невозможно. Обновленный псевдоним должен всегда ссылаться только на один имеющийся сервер.
  - При удалении сервера система Azure также удаляет все псевдонимы DNS, которые ссылаются на сервер.
- *Отсутствие привязки к какому-либо региону.* Псевдонимы DNS не привязаны к региону. Любые псевдонимы DNS могут быть обновлены для ссылки на сервер, находящийся в любом географическом регионе.
  - Однако при этом оба сервера должны находится в одной *подписке* Azure.
- *Разрешения.* Для управления псевдонимом DNS пользователю нужно разрешение *Участник на уровне сервера* или разрешение с большими правами. Дополнительные сведения см. в статье Начало [работы с управлением доступом на основе ролей Azure в портал Azure](../../role-based-access-control/overview.md).

## <a name="manage-your-dns-aliases"></a>Управление псевдонимами DNS

Для программного управления псевдонимами DNS доступны командлеты REST API и PowerShell.

### <a name="rest-apis-for-managing-your-dns-aliases"></a>REST API для управления псевдонимами DNS

Документация по REST API доступна в следующей статье:

- [Azure SQL Database REST API](/rest/api/sql/) (REST API Базы данных SQL Azure)

Кроме того, ознакомиться с REST API можно на сайте GitHub:

- [Интерфейсы API-интерфейсов службы DNS для базы данных SQL Azure](https://github.com/Azure/azure-rest-api-specs/blob/master/specification/sql/resource-manager/Microsoft.Sql/preview/2017-03-01-preview/serverDnsAliases.json)

<a name="anchor-powershell-code-62x"></a>

### <a name="powershell-for-managing-your-dns-aliases"></a>PowerShell для управления псевдонимами DNS

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Модуль PowerShell Azure Resource Manager по-прежнему поддерживается, но вся будущая разработка предназначена для модуля AZ. SQL. Сведения об этих командлетах см. в разделе [AzureRM.Sql](/powershell/module/AzureRM.Sql/). Аргументы команд в модулях Az и AzureRm практически идентичны.

Доступны командлеты PowerShell, которые вызывают REST API.

Пример кода командлетов PowerShell, используемых для управления псевдонимами DNS, приведен в следующей статье:

- [Управление псевдонимом DNS для Базы данных SQL Azure с помощью PowerShell](dns-alias-powershell-create.md)

В примере кода используются следующие командлеты:

- [New-азсклсерверднсалиас](/powershell/module/az.Sql/New-azSqlServerDnsAlias): создает новый псевдоним DNS в системе службы базы данных SQL Azure. Псевдоним относится к серверу 1.
- [Get-азсклсерверднсалиас](/powershell/module/az.Sql/Get-azSqlServerDnsAlias): получение и перечисление всех псевдонимов DNS, назначенных серверу 1.
- [Set-азсклсерверднсалиас](/powershell/module/az.Sql/Set-azSqlServerDnsAlias): изменяет имя сервера, на который ссылается псевдоним, с сервера 1 на сервер 2.
- [Remove-азсклсерверднсалиас](/powershell/module/az.Sql/Remove-azSqlServerDnsAlias). Удалите DNS-псевдоним с сервера 2, используя имя псевдонима.

## <a name="limitations-during-preview"></a>Ограничения для предварительной версии

Сейчас для псевдонима DNS существуют следующие ограничения:

- *Задержка до 2 минут.* Для обновления или удаления псевдонима DNS требуется до 2 минут.
  - Независимо от задержки (даже небольшой), псевдоним немедленно прекращает ссылаться на клиентские подключения к устаревшему серверу.
- *Поиск DNS.*[Поиск DNS](/windows-server/administration/windows-commands/nslookup) — это единственный надежный способ проверить, на какой сервер ссылается псевдоним DNS.
- _Аудит таблиц не поддерживается:_ Нельзя использовать псевдоним DNS на сервере, на котором включен *Аудит таблиц* для базы данных.
  - Аудит таблиц не рекомендуется.
  - Рекомендуем использовать [аудит больших двоичных объектов](../../azure-sql/database/auditing-overview.md).

## <a name="related-resources"></a>Связанные ресурсы

- Сведения об аварийном восстановлении см. в статье [Обзор обеспечения непрерывности бизнес-процессов с помощью Базы данных SQL Azure](business-continuity-high-availability-disaster-recover-hadr-overview.md).
- [Справочник по REST API Azure](/rest/api/azure/)
- [API-псевдонимы сервера DNS](/rest/api/sql/serverdnsaliases)

## <a name="next-steps"></a>Дальнейшие действия

- [Управление псевдонимом DNS для Базы данных SQL Azure с помощью PowerShell](dns-alias-powershell-create.md)