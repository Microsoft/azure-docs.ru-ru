---
title: Уровни служб — модель приобретения на основе DTU
description: Узнайте об уровнях обслуживания в модели приобретения на основе DTU для базы данных SQL Azure, чтобы обеспечить размеры вычислений и хранилища.
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: references_regions
ms.devlang: ''
ms.topic: conceptual
author: stevestein
ms.author: sstein
ms.date: 10/15/2020
ms.reviewer: ''
ms.openlocfilehash: 19178359d1eeb935499a01828f7c53b123e17571
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92793183"
---
# <a name="service-tiers-in-the-dtu-based-purchase-model"></a>Уровни службы в модели приобретения на основе единицы DTU
[!INCLUDE[appliesto-sqldb](../includes/appliesto-sqldb.md)]

Уровни службы в модели приобретения на основе единицы DTU отличаются диапазоном объемов вычислительных ресурсов с фиксированным включенным объемом хранилища, фиксированным сроком хранения резервных копий и фиксированной ценой. Все уровни служб в модели приобретения на основе DTU обеспечивают гибкость изменения размеров вычислений с минимальным [временем простоя](https://azure.microsoft.com/support/legal/sla/sql-database/v1_2/); Тем не менее в течение короткого промежутка времени, которое можно уменьшить с помощью логики повторных попыток, существует переключение между периодами, в которых подключение к базе данных теряется. Плата за отдельные базы данных и эластичные пулы начисляется за каждый час использования в соответствии с уровнем служб и объемом вычислительных ресурсов.

> [!IMPORTANT]
> [Управляемый экземпляр Azure SQL](../managed-instance/sql-managed-instance-paas-overview.md) не поддерживает модель приобретения на основе DTU. 


> [!NOTE]
> Дополнительные сведения об уровнях служб на основе виртуальных ядер см. в разделе [Уровни служб на основе виртуальных ядер](service-tiers-vcore.md). Сведения о том, как различать уровни служб на основе DTU и уровни служб на основе виртуальное ядро, см. в разделе [модели приобретения](purchasing-models.md).

## <a name="compare-the-dtu-based-service-tiers"></a>Сравнение уровней служб на основе числа DTU

Выбор уровня служб зависит главным образом от требований к непрерывности бизнес-процессов, хранилищу и производительности.

||Basic|Standard|Premium|
| :-- | --: |--:| --:|
|**Целевая рабочая нагрузка**|Разработка и применение в рабочей среде.|Разработка и применение в рабочей среде.|Разработка и применение в рабочей среде.|
|**Соглашение об уровне обслуживания с гарантией времени непрерывной работы**|99,99 %|99,99 %|99,99 %|
|**Максимальное хранение резервных копий**|7 дней|35 дней|35 дней|
|**ЦП**|Низкий|Низкий, средний, высокий|Средний, высокий|
|**Операций ввода-вывода (приблизительно)**\* |1-4 операций ввода-вывода на единицу DTU| 1-4 операций ввода-вывода на единицу DTU | 25 операций ввода-вывода на единицу DTU|
|**Задержка ввода-вывода (приблизительно)**|5 мс (чтение), 10 мс (запись)|5 мс (чтение), 10 мс (запись)|2 мс (чтение и запись)|
|**Индексирование columnstore** |Н/Д|S3 и выше|Поддерживается|
|**Выполняющаяся в памяти OLTP**|Н/Д|Н/Д|Поддерживается|

\* Все операции чтения и записи в секунду для файлов данных, включая фоновый ввод-вывод (контрольная точка и отложенный модуль записи)

> [!IMPORTANT]
> Цели служб Basic, S0, S1 и S2 предоставляют менее одного Виртуальное ядро (ЦП).  Для рабочих нагрузок с интенсивным использованием ЦП рекомендуется использовать уровень обслуживания S3 или выше. 
>
> В целевых показателях служб Basic, S0 и S1 файлы базы данных хранятся в хранилище Azure уровня "Стандартный", использующем носитель для хранения на основе жесткого диска (HDD). Эти цели службы лучше всего подходят для разработки, тестирования и других редко используемых рабочих нагрузок, которые менее чувствительны к изменчивости производительности.
>

> [!TIP]
> Чтобы просмотреть фактические ограничения управления [ресурсами](resource-limits-logical-server.md#resource-governance) для базы данных или эластичного пула, запросите представление [sys.dm_user_db_resource_governance](/sql/relational-databases/system-dynamic-management-views/sys-dm-user-db-resource-governor-azure-sql-database) .

> [!NOTE]
> Вы можете получить бесплатную базу данных в базе данных SQL Azure на уровне "базовый" службы в сочетании с бесплатной учетной записью Azure для изучения Azure. Сведения см. в разделе [Создание управляемой облачной базы данных с помощью бесплатной учетной записи Azure](https://azure.microsoft.com/free/services/sql-database/).

## <a name="single-database-dtu-and-storage-limits"></a>DTU отдельной базы данных и ограничения хранилища

Объем вычислительных ресурсов выражается в единицах транзакций базы данных (DTU) для отдельных баз данных, а для эластичных пулов — в единицах транзакций эластичной базы данных (eDTU). Дополнительные сведения об DTU и Edtu см. в разделе [модель приобретения на основе DTU](purchasing-models.md#dtu-based-purchasing-model).

||Basic|Standard|Premium|
| :-- | --: | --: | --: |
| **Максимальный размер хранилища** | 2 ГБ | 1 TБ | 4 TБ  |
| **Максимальное число DTU** | 5 | 3000 | 4000 |

> [!IMPORTANT]
> Иногда требуется сжать базу данных, чтобы освободить неиспользуемое пространство. Дополнительные сведения см. [в статье Управление дисковым пространством в базе данных SQL Azure](file-space-manage.md).

## <a name="elastic-pool-edtu-storage-and-pooled-database-limits"></a>eDTU эластичного пула, хранилище и пределы для базы данных в пуле

|| **Основной** | **Standard Edition** | **Премиальный** |
| :-- | --: | --: | --: |
| **Максимальный размер хранилища на базу данных**  | 2 ГБ | 1 ТБ | 1 ТБ |
| **Максимальный размер хранилища на пул** | 156 ГБ | 4 TБ | 4 TБ |
| **Максимальное число eDTU на базу данных** | 5 | 3000 | 4000 |
| **Максимальное число eDTU на пул** | 1600 | 3000 | 4000 |
| **Максимальное количество баз данных на пул** | 500  | 500 | 100 |

> [!IMPORTANT]
> Более 1 ТБ хранилища на уровне "Премиум" в настоящее время доступны во всех регионах, кроме: Восточный Китай, Северный Китай, Центрально-Центральный регион и Северо-Восточная Германия. В этих регионах максимальный объем хранилища категории "Премиум" ограничен 1 ТБ.  Дополнительные сведения см. в разделе [о действующих ограничениях для P11-P15](single-database-scale.md#p11-and-p15-constraints-when-max-size-greater-than-1-tb).  
> [!IMPORTANT]
> Иногда требуется сжать базу данных, чтобы освободить неиспользуемое пространство. Дополнительные сведения см. [в статье Управление дисковым пространством в базе данных SQL Azure](file-space-manage.md).

## <a name="dtu-benchmark"></a>Тест производительности DTU

Физические характеристики (ЦП, память, ввод-вывод), связанные с каждым измерением DTU, калибруются с использованием теста производительности, который имитирует рабочую нагрузку реальной базы данных.

### <a name="correlating-benchmark-results-to-real-world-database-performance"></a>Соотнесение результатов тестирования производительности с реальной производительностью базы данных

Важно понимать, что все тесты производительности являются лишь показательными и ориентировочными. Показатели скорости транзакций, достигнутые приложением тестирования производительности, будут отличаться от таких показателей других приложений. Тест производительности состоит из набора транзакций разных типов, выполняемых в схеме, которая содержит целый ряд таблиц и типов данных. Хотя тест производительности выполняет основные операции, свойственные для всех рабочих нагрузок OLTP, он не представляет какой-либо определенный класс базы данных или приложения. Цель тестирования производительности заключается в предоставлении приемлемых рекомендаций для относительной производительности базы данных, которую можно ожидать при переходе на более высокий или более низкий объем вычислительных ресурсов. На самом деле базы данных имеют разные размеры и сложность, обрабатывают разные сочетания рабочих нагрузок и реагируют разными способами. Например, приложение с большим объемом операций ввода-вывода может быстрее достигнуть порогового значения таких операций или приложение с интенсивной нагрузкой ЦП может быстрее достигнуть порогового значения такой нагрузки. Нет никакой гарантии, что конкретная база данных будет увеличиваться так же, как это показывает тест производительности при увеличении нагрузки.

Тест производительности и его методология подробно описаны ниже.

### <a name="benchmark-summary"></a>Сводка о тесте производительности

Тест производительности измеряет производительность набора основных операций базы данных, выполняемых чаще всего при рабочих нагрузках оперативной обработки транзакций (OLTP). Хотя тест производительности разрабатывался для облачных вычислений, схемы базы данных, заполнение данными и транзакции рассчитаны на максимально широкий уровень репрезентативности основных элементов, которые чаще всего используются в рабочих нагрузках OLTP.

### <a name="schema"></a>схема

Схема разработана таким образом, чтобы предоставить достаточную степень разнообразия и сложности для поддержки широкого диапазона операций. Тест производительности выполняется в базе данных, состоящей из шести таблиц. Эти таблицы делятся на три категории: фиксированного размера, масштабируемые и расширяемые. Есть две таблицы фиксированного размера, три масштабируемые таблицы и одна расширяемая таблица. Таблицы фиксированного размера имеют неизменное количество строк. Масштабируемые таблицы имеют кратность, пропорциональную производительности базы данных, но не изменяемую во время тестирования производительности. Расширяемая таблица имеет такой же размер, что и масштабируемая таблица при начальной нагрузке, но затем в процессе тестирования производительности кратность изменяется по мере добавления и удаления строк.

Схема включает сочетание типов данных, в том числе целое число, цифру, символ, а также дату и время. Схема включает первичные и вторичные ключи, но не имеет внешних ключей, т. е. между таблицами нет ограничений ссылочной целостности.

Программа формирования данных создает данные для исходной базы данных. Целочисленные и числовые данные создаются с помощью разных стратегий. В некоторых случаях значения случайным образом распределяются в диапазоне. Чтобы гарантировать соблюдение конкретного распределения в других случаях, набор значений переставляется случайным образом. Текстовые поля создаются из взвешенного списка слов для формирования реалистичных данных.

Размер базы данных устанавливается в соответствии с «коэффициентом масштабирования». Коэффициент масштабирования (сокращенно SF) определяет кратность элементов в масштабируемых и растущих таблицах. Как описано ниже, в разделе «Пользователи и пошаговое продвижение», размер базы данных, количество пользователей и максимальная производительность масштабируются пропорционально друг к другу.

### <a name="transactions"></a>Transactions

Рабочая нагрузка состоит из девяти типов транзакций, как показано в следующей таблице. Каждая транзакция должна подчеркивать определенный набор системных характеристик в ядре СУБД и системном оборудовании. При этом она должна явно отличаться от других транзакций. Такой подход упрощает оценку влияния различных компонентов на общую производительность. Например, транзакция «Чтение, высокая интенсивность» создает значительное число операций чтения с диска.

| Тип транзакции | Описание |
| --- | --- |
| Чтение, низкая интенсивность |ВЫБОР; в памяти; только для чтения |
| Носитель для чтения |ВЫБОР; в основном в памяти; только для чтения |
| Чтение, высокая интенсивность |ВЫБОР; в основном не в памяти; только для чтения |
| Обновление, низкая интенсивность |ОБНОВЛЕНИЕ; в памяти; чтение и запись |
| Обновление, высокая интенсивность |ОБНОВЛЕНИЕ; в основном не в памяти; чтение и запись |
| Вставка, низкая интенсивность |ВСТАВКА; в памяти; чтение и запись |
| Вставка, высокая интенсивность |ВСТАВКА; в основном не в памяти; чтение и запись |
| Удалить |УДАЛЕНИЕ; сочетание в памяти и не в памяти; чтение и запись |
| ЦП, высокая интенсивность |ВЫБОР; в памяти; относительно высокая загрузка ЦП; только для чтения |

### <a name="workload-mix"></a>Сочетание рабочих нагрузок

Транзакции выбираются случайным образом из взвешенного распределения следующего общего сочетания. Обще сочетание имеет соотношение чтения и записи 2:1.

| Тип транзакции | Процент от сочетания |
| --- | --- |
| Чтение, низкая интенсивность |35 |
| Носитель для чтения |20 |
| Чтение, высокая интенсивность |5 |
| Обновление, низкая интенсивность |20 |
| Обновление, высокая интенсивность |3 |
| Вставка, низкая интенсивность |3 |
| Вставка, высокая интенсивность |2 |
| Удалить |2 |
| ЦП, высокая интенсивность |10 |

### <a name="users-and-pacing"></a>Пользователи и пошаговое продвижение

Рабочая нагрузка теста производительности определяется с помощью средства, которое передает транзакции через ряд подключений для имитации работы определенного количества одновременных пользователей. Хотя все подключения и транзакции создаются компьютером, для простоты мы называем эти подключения «пользователи». Несмотря на то, что каждый пользователь работает независимо от других пользователей, все они выполняют одинаковый цикл, показанный ниже:

1. Установление подключения к базе данных.
2. Повторение до получения сигнала выхода:
   - случайный выбор транзакций (из взвешенного распределения);
   - выполнение выбранной транзакции и измерение времени ответа;
   - ожидание задержки шага.
3. Завершение подключения к базе данных.
4. Выйти.

Задержка шага (в действии 2в) выбирается случайным образом, однако с распределением со средним значением в 1,0 секунду. Таким образом, в среднем каждый пользователь может создавать максимум одну транзакцию в секунду.

### <a name="scaling-rules"></a>Правила масштабирования

Количество пользователей определяется размером базы данных (в единицах коэффициента масштабирования). Существует один пользователь на каждые пять единиц коэффициента масштабирования. Из-за задержки шага один пользователь может в среднем создавать не более одной транзакции в секунду.

Например, база данных с коэффициентом масштабирования 500 (SF=500) будет иметь 100 пользователей и может достичь максимальной скорости в 100 транзакций в секунду. Для более высокой скорости требуется больше пользователей и большие размеры базы данных.

### <a name="measurement-duration"></a>Продолжительность измерения

Для правильного выполнения теста производительности требуется измерять устойчивое состояние по крайней мере один час.

### <a name="metrics"></a>Метрики

Ключевыми показателями теста производительности являются пропускная способность и время ответа.

- Пропускная способность — это важный показатель производительности в тесте производительности. Пропускная способность измеряется в транзакциях в единицу времени, учитывая все типы транзакций.
- Время отклика — это показатель прогнозируемости производительности. Ограничение времени ответа зависит от класса службы. Более высокие классы службы имеют более строгие требования ко времени ответа, как показано ниже.

| Класс службы | Единица пропускной способности | Требование ко времени ответа |
| --- | --- | --- |
| Premium |Транзакций в секунду |95-й процентиль при 0,5 секунды |
| Стандартный |Транзакций в минуту |90-й процентиль при 1,0 секунде |
| Basic |Транзакций в час |80-й процентиль при 2,0 секундах |

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о конкретных объемах вычислительных ресурсов и доступных размерах хранилища для отдельной базы данных см. в [этом разделе](resource-limits-dtu-single-databases.md#single-database-storage-sizes-and-compute-sizes).
- Дополнительные сведения о конкретных объемах вычислительных ресурсов и доступных размерах хранилища эластичных пулов см. в разделе [Эластичный пул: размеры хранилища и объемы вычислительных ресурсов](resource-limits-dtu-elastic-pools.md#elastic-pool-storage-sizes-and-compute-sizes).