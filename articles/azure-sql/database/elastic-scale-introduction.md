---
title: Развертывание
description: Разработчики программного обеспечения как услуги (SaaS) могут с легкостью создавать эластичные и масштабируемые базы данных в облаке, используя следующие средства
services: sql-database
ms.service: sql-database
ms.subservice: scale-out
ms.topic: conceptual
ms.custom: sqldbrb=1
author: stevestein
ms.author: sstein
ms.date: 01/25/2019
ms.openlocfilehash: 3f00b2c1a8a8264267aa8ae68d80890adeb642ea
ms.sourcegitcommit: 31cfd3782a448068c0ff1105abe06035ee7b672a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/10/2021
ms.locfileid: "98059151"
---
# <a name="scaling-out-with-azure-sql-database"></a>Развертывание с помощью Базы данных SQL Azure
[!INCLUDE[appliesto-sqldb](../includes/appliesto-sqldb.md)]

Базы данных SQL Azure можно легко масштабировать с помощью инструментов **эластичных баз данных** . Эти инструменты и компоненты позволяют использовать ресурсы **Базы данных SQL Azure** для создания решений для транзакционных рабочих нагрузок и, в частности, приложений SaaS (программное обеспечение как услуга). Возможности эластичных баз данных включают в себя следующее.

* [Клиентская библиотека эластичной базы данных](elastic-database-client-library.md) является компонентом, который позволяет создавать и обслуживать сегментированные базы данных.  См. статью [Приступая к работе с инструментами эластичных баз данных](elastic-scale-get-started.md).
* [Инструмент разбиения и объединения эластичной базы данных](elastic-scale-overview-split-and-merge.md) перемещает данные между сегментированными базами данных. Это средство позволяет легко перемещать данные из мультитенантной базы данных в базу данных с одним клиентом (или наоборот). См. [руководство по инструменту разбиения и объединения эластичной базы данных](elastic-scale-configure-deploy-split-and-merge.md).
* [Задания обработки эластичных баз данных](elastic-jobs-overview.md) (Предварительная версия). Используйте задания для управления большим количеством баз данных в базе данных SQL Azure. Легко выполняйте административные операции, такие как изменение схем, управление учетными данными, обновления ссылочных данных, сбор данных о производительности или сбор данных телеметрии клиента (пользователя) с помощью заданий.
* [Запрос к эластичной базе данных](elastic-query-overview.md) (предварительная версия) позволяет выполнять запросы Transact-SQL, охватывающие несколько баз данных. Это позволяет подключить средства создания отчетов, например Excel, Power BI, Tableau и т. д.
* [Эластичные транзакции](elastic-transactions-overview.md). Эта функция позволяет выполнять транзакции, охватывающие несколько баз данных. Транзакции эластичной базы данных доступны для приложений .NET, использующих ADO.NET. Кроме того, транзакции можно объединить с уже знакомыми приемами программирования, используя [классы System.Transaction](/dotnet/api/system.transactions).

На рисунке ниже показана архитектура, которая включает в себя **возможности эластичных баз данных** по отношению к коллекции баз данных.

Цвета баз данных на этой иллюстрации представляют схемы. Базы данных одного цвета используют одинаковые схемы.

1. Набор **баз данных SQL** размещается в Azure с использованием архитектуры сегментирования.
2. **Клиентская библиотека эластичных баз данных** используется для управления набором сегментов.
3. Подмножество баз данных помещается в **эластичный пул**. (См. статью [Что такое пул эластичных БД Azure?](elastic-pool-overview.md))
4. **Задание обработки эластичных баз данных** запускает запланированные или динамические сценарии T-SQL для всех баз данных.
5. **Служба разбиения на части и объединения** используется для перемещения данных из одного сегмента в другой.
6. **Запрос к эластичной базе данных** позволяет создать запрос, который охватывает все базы данных в наборе сегментов.
7. **Эластичные транзакции** позволяют выполнять транзакции, охватывающие несколько баз данных. 

![Инструменты эластичных баз данных][1]

## <a name="why-use-the-tools"></a>Зачем использовать эти инструменты?

Для виртуальных машин и хранилища BLOB-объектов эластичность и масштабирование облачных приложений легко реализуются путем простого добавления и удаления вычислительных единиц либо увеличения мощности. Однако для обработки данных в реляционных базах данных с отслеживанием состояния их реализация по-прежнему представляет сложности. Сложности появились в следующих сценариях.

* Увеличение и уменьшение производительности реляционной базы данных как части рабочей нагрузки решения.
* Управление хот-спотами при влиянии на конкретное подмножество данных, например загруженный пользователь (клиент).

Обычно такие сценарии были устранены благодаря инвестиции в крупномасштабные серверы для поддержки приложения. Тем не менее реализация этого варианта ограничена облаком, в котором вся обработка выполняется на предустановленном стандартном оборудовании. Использование вместо этого распределения и обработки данных в нескольких идентично структурированных базах данных (метод масштабирования, известный как сегментирование) является убедительной альтернативой традиционным подходам к масштабированию с точки зрения затрат и гибкости.

## <a name="horizontal-and-vertical-scaling"></a>Горизонтальное и вертикальное масштабирование

На рисунке ниже показаны горизонтальные и вертикальные измерения масштабирования, которые представляют собой базовые способы масштабирования эластичных баз данных.

![Горизонтальное и вертикальное масштабирование][2]

Горизонтальное масштабирование означает добавление или удаление баз данных для настройки емкости или общей производительности, также называемой «горизонтальным масштабированием». Сегментирование, в которым данные разделяются по набору идентично структурированных баз данных, является наиболее распространенным методом горизонтального масштабирования.  

Вертикальное масштабирование означает увеличение или уменьшение размера вычислений отдельной базы данных, также известного как "увеличение масштаба".

В большей части баз данных облачных приложений для масштабирования используется сочетание этих двух стратегий. Например, программное обеспечение как приложение службы может использовать горизонтальное масштабирование для предоставления новых конечных клиентов и вертикального масштабирования, что позволяет каждой базе данных конечных пользователей увеличивать или уменьшать ресурсы по мере необходимости в рабочей нагрузке.

* Для управления горизонтальным масштабированием используется [клиентская библиотека эластичных баз данных](elastic-database-client-library.md).
* Вертикальное масштабирование осуществляется с помощью командлетов Azure PowerShell для изменения уровня служб или путем помещения баз данных в пул эластичных БД.

## <a name="sharding"></a>Сегментирование

*Сегментирование* — это способ распределения больших объемов одинаково структурированных данных по нескольким независимым базам данных. Она пользуется особенной популярностью среди разработчиков облачных технологий, создающих решения SaaS для пользователей или предприятий. Эти конечные пользователи часто называются "клиентами". Сегментирование может потребоваться по ряду причин:  

* общий объем данных слишком велик для размещения в пределах отдельной базы данных;
* пропускная способность транзакций общей рабочей нагрузки превышает возможности отдельной базы данных;
* клиентам может потребоваться физическая изоляция друг от друга, для чего требуются отдельные базы данных для каждого клиента;
* разные части базы данных могут размещаться в разных регионах по соображениям соответствия требованиям законодательства, производительности или по геополитическим причинам.

В других сценариях, например в приеме данных из распределенных устройств, сегментирование может использоваться для заполнения набора баз данных по временному признаку. Например, отдельная база данных может выделяться под каждый день или неделю. В этом случае ключом сегментирования может быть целое число, представляющее дату (присутствующую во всех строках сегментированных таблиц), а запросы получения информации о диапазоне дат должны передаваться приложением в подмножество баз данных, которые покрывают рассматриваемый диапазон.

Сегментирование лучше всего работает, когда каждая транзакция в приложении может ограничиваться одним значением ключа сегментирования. Это гарантирует, что все транзакции будут осуществляться в пределах отдельной базы данных.

## <a name="multi-tenant-and-single-tenant"></a>Мультитенантные и с одним клиентом

Некоторые приложения используют простой способ создания отдельной базы данных для каждого клиента. Это **шаблон сегментирования для одного клиента**, который предоставляет возможность изолирования, архивации и восстановления, а также масштабирования ресурсов в соответствии со степенью детализации клиента. Благодаря сегментированию для одного клиента каждая база данных привязывается к отдельному идентификатору клиента (или значению ключа клиента), но этот ключ не должен постоянно присутствовать в самих данных. Это обязанность приложения для маршрутизации каждого запроса в соответствующую базу данных, и клиентская библиотека может упростить это.

![Сравнение многопользовательских версий одного клиента][4]

Другие сценарии объединяют несколько клиентов вместе в базах данных вместо изолирования их в отдельных базах данных. Это типичный **шаблон сегментирования для нескольких клиентов**. Он может использоваться при обработке приложением большого числа маленьких клиентов. При сегментировании на несколько клиентов строки таблиц базы данных спроектированы для хранения ключа, идентифицирующего пользователя, или ключа сегментирования. Опять же, уровень приложения отвечает за маршрутизацию запроса клиента в соответствующую базу данных, и эта библиотека может поддерживаться клиентской библиотекой эластичной базы данных. Кроме того, для ограничения строк, доступных для каждого клиента, можно воспользоваться безопасностью на уровне строк. Дополнительные сведения см. в статье [Мультитенантные приложения со средствами эластичных баз данных и безопасностью на уровне строк](saas-tenancy-elastic-tools-multi-tenant-row-level-security.md). Перераспределение данных между базами данных может потребоваться при использовании шаблона многопользовательского сегментирования и обеспечивается службой разбиения и объединения эластичной базы данных. Дополнительные сведения о шаблонах разработки для приложений SaaS, использующих пулы эластичных БД, см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием Базы данных Azure SQL](saas-tenancy-app-design-patterns.md).

### <a name="move-data-from-multiple-to-single-tenancy-databases"></a>Перемещение данных из многопользовательских баз данных в однопользовательскую базу данных
При создании приложения SaaS потенциальным клиентам обычно предлагается пробная версия программного обеспечения. В этом случае для хранения данных экономически выгодно использовать многопользовательскую базу данных. Однако, когда потенциальный клиент становится реальным, предпочтительнее однопользовательская база данных, так как она обеспечивает лучшую производительность. Если клиент создал данные в течение пробного периода, используйте [средство разбиения и объединения](elastic-scale-overview-split-and-merge.md) для перемещения данных из базы данных с несколькими клиентами в новую базу данных с одним клиентом.

## <a name="next-steps"></a>Дальнейшие действия
Пример приложения, демонстрирующий клиентскую библиотеку, приведен в статье [Приступая к работе с инструментами эластичных баз данных](elastic-scale-get-started.md).

Сведения о том, как преобразовать имеющиеся базы данных, чтобы использовать эти инструменты, см. в статье [Перенос существующих баз данных для масштабирования](elastic-convert-to-use-elastic-tools.md).

Сведения об особенностях эластичного пула см. в статье [Когда следует использовать эластичный пул?](elastic-pool-overview.md). Вы можете также создать [эластичные пулы](elastic-pool-manage.md).  

[!INCLUDE [elastic-scale-include](../../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/elastic-scale-introduction/tools.png
[2]:./media/elastic-scale-introduction/h_versus_vert.png
[3]:./media/elastic-scale-introduction/overview.png
[4]:./media/elastic-scale-introduction/single_v_multi_tenant.png
