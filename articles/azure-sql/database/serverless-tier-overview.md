---
title: Уровень бессерверных вычислений
description: В этой статье описывается новый несерверный расчетный уровень и сравнивается с существующим подготовленным уровнем вычислений для базы данных SQL Azure.
services: sql-database
ms.service: sql-database
ms.subservice: service
ms.custom: test sqldbrb=1, devx-track-azurecli
ms.devlang: ''
ms.topic: conceptual
author: oslake
ms.author: moslake
ms.reviewer: sstein
ms.date: 2/22/2021
ms.openlocfilehash: 4dd7bbe613b30df2611bfe6631950e121235204a
ms.sourcegitcommit: b4647f06c0953435af3cb24baaf6d15a5a761a9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2021
ms.locfileid: "101658594"
---
# <a name="azure-sql-database-serverless"></a>Сервер базы данных SQL Azure
[!INCLUDE[appliesto-sqldb](../includes/appliesto-sqldb.md)]

Бессерверный уровень — это степень вычислений для отдельных баз данных в службе SQL Azure, которая автоматически масштабирует вычисление на основе потребностей рабочей нагрузки и выставляет счета за количество вычислений, используемых в секунду. Уровень бессерверных вычислений также автоматически приостанавливает базы данных в периоды отсутствия активности, когда оплачивается только хранилище, и автоматически возобновляет работу баз данных, когда активность восстанавливается.

## <a name="serverless-compute-tier"></a>Уровень бессерверных вычислений

Независимый от сервера уровень вычислений для отдельных баз данных в базе данных SQL Azure параметризован с помощью диапазона автоматического масштабирования вычислений и задержки автоматической паузы. Конфигурация этих параметров определяет производительность базы данных и стоимость вычислений.

![Выставление счетов за бессерверные вычисления](./media/serverless-tier-overview/serverless-billing.png)

### <a name="performance-configuration"></a>Конфигурация производительности

- **Минимальный виртуальных ядер** и **максимальный виртуальных ядер** являются настраиваемыми параметрами, определяющими диапазон ресурсов вычислений, доступных для базы данных. Ограничения памяти и операций ввода-вывода пропорциональны указанному диапазону виртуальных ядер.  
- **Задержка автоматической приостановки** — это настраиваемый параметр, определяющий период времени, в течение которого база данных должна быть неактивной до того, как она будет автоматически приостановлена. База данных автоматически возобновляется при следующем входе или выполнении другого действия.  Кроме того, можно отключить автоматическую приостановку.

### <a name="cost"></a>Стоимость

- Затраты на бессерверную базу данных — это совокупность стоимости вычислений и затрат на хранение.
- При использовании вычислений между минимальным и максимальным ограничениями Расчетная стоимость основана на виртуальное ядро и используемой памяти.
- Если использование вычислений ниже минимальных установленных ограничений, затраты на вычисление основываются на параметре min виртуальных ядер и min memory.
- При приостановке базы данных стоимость вычислений будет равна нулю, а только затраты на хранение.
- Стоимость хранилища определяется так же, как и в подготовленном уровне вычислений.

Дополнительные сведения о затратах см. в разделе [выставление счетов](serverless-tier-overview.md#billing).

## <a name="scenarios"></a>Сценарии

Бессерверные вычисления — это рентабельное и оптимизированное для высокой производительности решение для отдельных баз данных с нестабильным и непредсказуемым использованием, для которых допустима некоторая задержка при подготовке вычислительных ресурсов после периодов простоя. В отличие от этого, уровень подготовленных вычислений — это рентабельное и оптимизированное для высокой производительности решение для отдельных баз данных или нескольких баз данных в составе эластичного пула с большей средней загрузкой, для которых задержка при подготовке вычислительных ресурсов недопустима.

### <a name="scenarios-well-suited-for-serverless-compute"></a>Сценарии, которые хорошо подходят для бессерверных вычислений

- Отдельные базы данных с временными, непредсказуемыми шаблонами использования, направленными на периоды бездействия и снижения среднего использования вычислений с течением времени.
- Отдельные базы данных на подготовленном уровне вычислений, которые часто масштабируются повторно, и клиенты, предпочитающие делегировать перемасштабирование вычислений в службу.
- Новые одиночные базы данных без журнала использования, где размер вычислений сложно или невозможно оценить до развертывания в базе данных SQL.

### <a name="scenarios-well-suited-for-provisioned-compute"></a>Сценарии, которые хорошо подходят для подготовленных вычислений

- Отдельные базы данных с более обычными прогнозируемыми шаблонами использования и высокой средней степенью использования вычислений с течением времени.
- Базы данных, которые не допускают компромиссов производительности из-за более частого обрезки памяти или задержки при возобновлении работы из приостановленного состояния.
- Несколько баз данных с временными, непредсказуемыми шаблонами использования, которые можно консолидировать в эластичные пулы для лучшей оптимизации по ценам.

## <a name="comparison-with-provisioned-compute-tier"></a>Сравнение с уровнем подготовленных вычислений

В следующей таблице перечислены различия между уровнями бессерверных вычислений и подготовленных вычислений:

| | **Бессерверные вычисления** | **Подготовленные вычисления** |
|:---|:---|:---|
|**Шаблон использования базы данных**| Нерегулярное, непредсказуемое использование с более низким средним использованием вычислений с течением времени. | Более обычные шаблоны использования с более высоким средним использованием вычислений за определенный период времени или несколько баз данных, использующих эластичные пулы.|
| **Затраты на управление производительностью** |Ниже|Выше|
|**Масштабирование вычислительных ресурсов**|Автоматически|Вручную|
|**Скорость включения вычислительных ресурсов**|Низкая после периодов бездействия|Интерпретация|
|**Тарификация**|посекундно.|Почасовая|

## <a name="purchasing-model-and-service-tier"></a>Модель приобретения и уровень служб

Бессерверная База данных SQL сейчас поддерживается только на уровне общего назначения платформы 5-го поколения в рамках модели приобретения виртуальных ядер.

## <a name="autoscaling"></a>Автомасштабирование

### <a name="scaling-responsiveness"></a>Скорость масштабирования

В целом, бессерверные базы данных запускаются на компьютере с достаточной емкостью для удовлетворения спроса на ресурсы без прерывания для любого количества запрошенных вычислений в пределах ограничений, заданных максимальным значением виртуальных ядер. В некоторых случаях автоматически выполняется балансировка нагрузки, если компьютер не может удовлетворить потребность в ресурсах в течение нескольких минут. Например, если потребность в ресурсах равна 4 виртуальных ядер, но доступно только 2 виртуальных ядер, то для балансировки нагрузки до 4 виртуальных ядер может потребоваться до нескольких минут. База данных остается доступной по сети во время балансировки нагрузки, кроме непродолжительного периода в конце операции, когда подключение прерывается.

### <a name="memory-management"></a>Управление памятью

Память для бессерверных баз данных освобождается чаще, чем для подготовленных вычислений баз данных. Такое поведение важно для управления затратами на бессерверные и может повлиять на производительность.

#### <a name="cache-reclamation"></a>Освобождение кэша

В отличие от подготовленных вычислительных баз данных, память из кэша SQL освобождается из базы данных, бессерверной, если загрузка ЦП или активного кэша мала.

- Использование активного кэша считается низким, если общий размер последних использованных записей кэша падает ниже порогового значения в течение определенного периода времени.
- При активации реорганизации кэша целевой размер кэша уменьшается постепенно до доли предыдущего размера и освобождается, только если использование остается низким.
- При возникновении ревосстановления кэша политика выбора записей кэша будет той же, что и для подготовленных баз данных вычислений, когда интенсивность памяти высока.
- Размер кэша никогда не уменьшается ниже ограничения min memory, как определено в параметре min виртуальных ядер, который можно настроить.

В бессерверных и подготовленных базах данных вычислений записи кэша могут быть вытеснены, если используется вся доступная память.

Обратите внимание, что при низком использовании ЦП использование активного кэша может быть велико в зависимости от шаблона использования и предотвращения его реорганизации.  Кроме того, после остановки действия пользователя могут возникать дополнительные задержки, прежде чем в результате выполнения периодических фоновых процессов, реагирующих на предыдущие действия пользователя.  Например, задачи удаления и очистки QDS создают фантомные записи, которые помечены для удаления, но физически не удаляются до тех пор, пока не будет запущен процесс очистки фантомных данных, который может задействовать считывание страниц с данными в кэш.

#### <a name="cache-hydration"></a>Расконсервации кэша

Кэш SQL растет по мере того, как данные извлекаться с диска таким же образом и с той же скоростью, что и для подготовленных баз данных. Когда база данных занята, размер кэша может увеличиваться в неограниченном объеме до максимального предела памяти.

## <a name="auto-pausing-and-auto-resuming"></a>Автоматическая приостановка и автоматическое возобновление

### <a name="auto-pausing"></a>Автоматическая приостановка

Автоматическая приостановка запускается, если выполняются все перечисленные ниже условия в течение задержки автоматической паузы.

- количество сеансов — 0;
- ЦП = 0 для рабочей нагрузки пользователя, выполняемой в пуле пользователей

Для отключения автоматической приостановки при необходимости можно указать параметр.

Следующие функции не поддерживают автоматическую приостановку, но поддерживают автоматическое масштабирование.  Если используются следующие компоненты, то Автоматическая приостановка должна быть отключена, а база данных останется в сети независимо от длительности бездействия базы данных:

- Георепликация (активная Георепликация и группы автоматической отработки отказа).
- Долгосрочное хранение резервных копий (LTR).
- База данных синхронизации, используемая в синхронизации данных SQL.  В отличие от баз данных синхронизации, концентраторы и базы данных-члены поддерживают автоматическую приостановку.
- DNS-псевдонимы
- База данных заданий, используемая в заданиях обработки эластичных БД (Предварительная версия).

Автоматическая приостановка во время развертывания некоторых обновлений службы, требующих, чтобы база данных была подключена к сети, временно не заблокировалась.  В таких случаях Автоматическая приостановка будет разрешена после завершения обновления службы.

### <a name="auto-resuming"></a>Автоматическое возобновление

Автоматическое возобновление активируется, если в любое время выполняется одно из следующих условий:

|Функция|Триггер автоматического возобновления|
|---|---|
|Аутентификация и авторизация|Имя входа|
|Обнаружение угроз|Включение и отключение параметров обнаружения угроз на уровне базы данных или сервера.<br>Изменение параметров обнаружения угроз на уровне базы данных или сервера.|
|Обнаружение и классификация данных|Добавление, изменение, удаление или просмотр меток конфиденциальности.|
|Аудит|Просмотр записей аудита.<br>Обновление или просмотр политики аудита.|
|Маскирование данных|Добавление, изменение, удаление или просмотр правил маскирования данных.|
|Прозрачное шифрование данных|Просмотр состояния или состояния прозрачного шифрования данных|
|Оценка уязвимостей|Нерегламентированные проверки и периодическое сканирование, если включено|
|Запросы к хранилищу данных (производительность)|Изменение или Просмотр параметров хранилища запросов|
|Рекомендации по производительности|Просмотр или применение рекомендаций по производительности|
|Автоматическая настройка|Применение и проверка рекомендаций по автоматической настройке, таких как автоматическая индексация|
|Копирование базы данных|Создать базу данных как копию.<br>Экспорт в BACPAC-файл.|
|Синхронизация данных SQL|Синхронизация между центральной и рядовыми базами данных, которая запускается по настраиваемому расписанию или вручную.|
|Изменение некоторых метаданных базы данных|Добавление новых тегов базы данных.<br>Изменение Max виртуальных ядер, min виртуальных ядер или задержка приостановки.|
|SQL Server Management Studio (SSMS)|Использование SSMS версий, предшествующих 18,1, и открытие нового окна запроса для любой базы данных на сервере приведет к возобновлению работы любой базы данных, приостановленной на том же сервере. Такое поведение не возникает при использовании SSMS версии 18,1 или более поздней.|

Мониторинг, управление и другие решения, выполняющие любые операции, перечисленные выше, активируют автоматическое возобновление.

Автоматическое возобновление также запускается во время развертывания некоторых обновлений службы, требующих, чтобы база данных была в сети.

### <a name="connectivity"></a>Соединение

Если база данных без сервера приостанавливается, то первое имя входа возобновляет базу данных и возвращает сообщение об ошибке, сообщающее, что база данных недоступна, код ошибки 40613. Когда работа базы данных будет возобновлена, нужно повторно выполнить вход, чтобы установить подключение. Клиенты базы данных, для которых поддерживается логика повторных попыток подключения, не нужно изменять.

### <a name="latency"></a>Задержка

Задержка автоматического возобновления и автоматического приостановки серверной базы данных обычно составляет 1 минуту для автоматического возобновления и 1-10 минут для автоматической приостановки.

### <a name="customer-managed-transparent-data-encryption-byok"></a>Прозрачное шифрование данных, управляемое клиентом (BYOK)

Если используется [управляемое клиентом прозрачное шифрование данных](transparent-data-encryption-byok-overview.md) (BYOK) и Автоматическая приостановка работы базы данных без сервера происходит при удалении или отзыве ключа, то база данных остается в состоянии автоматического приостановки.  В этом случае после возобновления работы базы данных база данных становится недоступной в течение примерно 10 минут.  После того как база данных станет недоступной, процесс восстановления будет таким же, как и для подготовленных вычислений баз данных.  Если база данных без сервера находится в режиме «в сети» при удалении или отзыве ключа, то база данных также становится недоступной в течение примерно 10 минут так же, как и для подготовленных баз данных вычислений.

## <a name="onboarding-into-serverless-compute-tier"></a>Переход на бессерверный уровень вычислений

Создание новой базы данных или перемещение существующей базы данных на серверный уровень вычислений следует той же схеме, что и при создании новой базы данных на подготовленном уровне вычислений, и включает в себя следующие два шага.

1. Укажите цель обслуживания. Цель службы предписывает уровень служб, поколение оборудования и максимальное виртуальных ядер. Сведения о параметрах цели обслуживания см. в статье [ограничения ресурсов, бессерверных](resource-limits-vcore-single-databases.md#general-purpose---serverless-compute---gen5)


2. При необходимости укажите минимальное виртуальных ядер и задержку приостановки, чтобы изменить значения по умолчанию. В таблице ниже показаны доступные значения для этих параметров.

   |Параметр|Варианты значений|Значение по умолчанию|
   |---|---|---|---|
   |Min виртуальных ядер|Зависит от параметра max виртуальных ядер — см. раздел [ограничения ресурсов](resource-limits-vcore-single-databases.md#general-purpose---serverless-compute---gen5).|0,5 виртуального ядра|
   |Задержка автоматической приостановки работы|Минимум: 60 мин (1 час)<br>Максимум: 10080 мин (7 дней)<br>Приращения: 10 минут<br>Отключение автоматической приостановки: -1|60 минут|


### <a name="create-a-new-database-in-the-serverless-compute-tier"></a>Создание новой базы данных на уровне бессерверных вычислений

В следующих примерах создается новая база данных на уровне бессерверных вычислений.

#### <a name="use-the-azure-portal"></a>Использование портала Azure

См. раздел [Краткое руководство. Создание отдельной базы данных в базе данных SQL Azure с помощью портал Azure](single-database-create-quickstart.md).


#### <a name="use-powershell"></a>Использование PowerShell

```powershell
New-AzSqlDatabase -ResourceGroupName $resourceGroupName -ServerName $serverName -DatabaseName $databaseName `
  -ComputeModel Serverless -Edition GeneralPurpose -ComputeGeneration Gen5 `
  -MinVcore 0.5 -MaxVcore 2 -AutoPauseDelayInMinutes 720
```
#### <a name="use-the-azure-cli"></a>Использование Azure CLI

```azurecli
az sql db create -g $resourceGroupName -s $serverName -n $databaseName `
  -e GeneralPurpose -f Gen5 --min-capacity 0.5 -c 2 --compute-model Serverless --auto-pause-delay 720
```


#### <a name="use-transact-sql-t-sql"></a>Использовать Transact-SQL (T-SQL)

При использовании T-SQL значения по умолчанию применяются к минимальным виртуальных ядер и задержкам приостановки.

```sql
CREATE DATABASE testdb
( EDITION = 'GeneralPurpose', SERVICE_OBJECTIVE = 'GP_S_Gen5_1' ) ;
```

Дополнительные сведения см. в разделе [Создание базы данных](/sql/t-sql/statements/create-database-transact-sql?view=azuresqldb-current&preserve-view=true).  

### <a name="move-a-database-from-the-provisioned-compute-tier-into-the-serverless-compute-tier"></a>Перемещение базы данных из подготовленного уровня вычислений в бессерверный уровень вычислений

В следующих примерах база данных перемещается из подготовленного уровня вычислений в бессерверный уровень вычислений.

#### <a name="use-powershell"></a>Использование PowerShell


```powershell
Set-AzSqlDatabase -ResourceGroupName $resourceGroupName -ServerName $serverName -DatabaseName $databaseName `
  -Edition GeneralPurpose -ComputeModel Serverless -ComputeGeneration Gen5 `
  -MinVcore 1 -MaxVcore 4 -AutoPauseDelayInMinutes 1440
```

#### <a name="use-the-azure-cli"></a>Использование Azure CLI

```azurecli
az sql db update -g $resourceGroupName -s $serverName -n $databaseName `
  --edition GeneralPurpose --min-capacity 1 --capacity 4 --family Gen5 --compute-model Serverless --auto-pause-delay 1440
```


#### <a name="use-transact-sql-t-sql"></a>Использовать Transact-SQL (T-SQL)

При использовании T-SQL значения по умолчанию применяются к задержкам min виртуальных ядер и автоматической приостановки.

```sql
ALTER DATABASE testdb 
MODIFY ( SERVICE_OBJECTIVE = 'GP_S_Gen5_1') ;
```

Дополнительные сведения см. в разделе [ALTER DATABASE](/sql/t-sql/statements/alter-database-transact-sql?view=azuresqldb-current&preserve-view=true).

### <a name="move-a-database-from-the-serverless-compute-tier-into-the-provisioned-compute-tier"></a>Перемещение базы данных с бессерверного уровня вычислений в подготовленный уровень вычислений

Перемещение бессерверной базы данных на уровень подготовленных вычислений выполняется так же, как и перемещение подготовленной базы данных на уровень бессерверных вычислений.

## <a name="modifying-serverless-configuration"></a>Изменение бессерверной конфигурации

### <a name="use-powershell"></a>Использование PowerShell

Изменение максимальной или минимальной виртуальных ядер и задержки приостановки выполняется с помощью команды [Set-азсклдатабасе](/powershell/module/az.sql/set-azsqldatabase) в PowerShell с помощью `MaxVcore` `MinVcore` аргументов, и `AutoPauseDelayInMinutes` .

### <a name="use-the-azure-cli"></a>Использование Azure CLI

Изменение максимальной или минимальной виртуальных ядер и задержки приостановки выполняется с помощью команды [AZ SQL DB Update](/cli/azure/sql/db#az-sql-db-update) в Azure CLI с помощью `capacity` `min-capacity` аргументов, и `auto-pause-delay` .


## <a name="monitoring"></a>Наблюдение

### <a name="resources-used-and-billed"></a>Используемые и тарифицируемые ресурсы

Ресурсы базы данных, не связанные с сервером, инкапсулируются с помощью пакета приложения, экземпляра SQL и сущностей пользовательского пула ресурсов.

#### <a name="app-package"></a>Пакет приложения

Пакет приложения представляет внешнюю границу управления для большинства ресурсов базы данных, независимо от того, на каком уровне находится база данных (бессерверные или подготовленные вычисления). Пакет приложения содержит экземпляр SQL и внешние службы, которые вместе определяют область применения всех пользовательских и системных ресурсов, используемых базой данных в Базе данных SQL. Внешние службы включают компоненты R и функцию полнотекстового поиска. Экземпляр SQL обычно управляет общим использованием ресурсов в пакете приложения.

#### <a name="user-resource-pool"></a>Пул пользовательских ресурсов

Пул пользовательских ресурсов представляет внутреннюю границу управления для большинства ресурсов базы данных, независимо от того, на каком уровне находится база данных (бессерверные или подготовленные вычисления). Пул пользовательских ресурсов ограничивает ЦП и операции ввода-вывода для пользовательской рабочей нагрузки, создаваемой запросами DDL, такими как запросы CREATE, ALTER и DML, такие как SELECT, INSERT, UPDATE и DELETE. Эти запросы обычно представляют самые распространенные операции, потребляющие ресурсы в пакете приложения.

### <a name="metrics"></a>Метрики

Метрики для мониторинга использования ресурсов пакета приложения и пула пользователей для бессерверной базы данных перечислены в следующей таблице.

|Сущность|Метрика|Описание|единиц(ы)|
|---|---|---|---|
|Пакет приложения|app_cpu_percent|Количество виртуальных ядер, используемых в приложении относительно максимального количества виртуальных ядер, которое можно использовать в приложении.|Процент|
|Пакет приложения|app_cpu_billed|Объем вычислительных ресурсов, тарифицируемых для приложения в отчетный период. Сумма, которая насчитывается за этот период, является произведением этого показателя и стоимости виртуального ядра. <br><br>Значение этого показателя вычисляется с учетом потребления максимального количества ресурсов ЦП и памяти в каждую секунду. Если используемые количество виртуальных ядер и объем ресурсов памяти меньше, чем минимальный подготовленный объем, плата взимается за подготовленные ресурсы.Чтобы сравнить, как взимается плата за ресурсы ЦП и памяти, представьте, что объем памяти нормализуется с учетом виртуальных ядер путем преобразования объема памяти в ГБ в количество виртуальных ядер по 3 ГБ.|Время использования виртуальных ядер в секундах|
|Пакет приложения|app_memory_percent|Объем памяти, используемый в приложении, относительно максимального объема памяти, который можно использовать в приложении.|Процент|
|Пользовательский пул|cpu_percent|Количество виртуальных ядер, используемых пользовательской рабочей нагрузкой, относительно максимального количества виртуальных ядер, которое можно использовать в пользовательской рабочей нагрузке.|Процент|
|Пользовательский пул|data_IO_percent|Количество операций ввода-вывода, используемых пользовательской рабочей нагрузкой, относительно максимального количества операций ввода-вывода, которое можно использовать в пользовательской рабочей нагрузке.|Процент|
|Пользовательский пул|log_IO_percent|Количество записанных в журнал МБ/с, используемых пользовательской рабочей нагрузкой, относительно максимального количества записанных в журнал МБ/с, которое можно использовать в пользовательской рабочей нагрузке.|Процент|
|Пользовательский пул|workers_percent|Количество рабочих ролей, используемых пользовательской рабочей нагрузкой, относительно максимального количества рабочих ролей, которое можно использовать в пользовательской рабочей нагрузке.|Процент|
|Пользовательский пул|sessions_percent|Количество сеансов, используемых пользовательской рабочей нагрузкой, относительно максимального количества сеансов, которое можно использовать в пользовательской рабочей нагрузке.|Процент|

### <a name="pause-and-resume-status"></a>Состояние приостановки и возобновления работы

На портале Azure состояние базы данных отображается в разделе "Обзор" для сервера, содержащего список баз данных. Состояние базы данных также отображается в разделе "Обзор" для базы данных.

Используйте следующие команды для запроса состояния приостановки и возобновления базы данных:

#### <a name="use-powershell"></a>Использование PowerShell

```powershell
Get-AzSqlDatabase -ResourceGroupName $resourcegroupname -ServerName $servername -DatabaseName $databasename `
  | Select -ExpandProperty "Status"
```

#### <a name="use-the-azure-cli"></a>Использование Azure CLI

```azurecli
az sql db show --name $databasename --resource-group $resourcegroupname --server $servername --query 'status' -o json
```


## <a name="resource-limits"></a>Ограничения ресурсов

Сведения об ограничениях ресурсов см. в разделе " [бессерверный уровень вычислений](resource-limits-vcore-single-databases.md#general-purpose---serverless-compute---gen5)".

## <a name="billing"></a>Выставление счетов

Объем оплачиваемых вычислительных ресурсов зависит от максимального объема ресурсов ЦП и памяти, используемых каждую секунду. Если используемый объем ЦП и памяти меньше, чем минимальный подготовленный объем, плата взимается за подготовленные ресурсы. Чтобы сравнить, как взимается плата за ресурсы ЦП и памяти, представьте, что объем памяти нормализуется с учетом виртуальных ядер путем преобразования объема памяти в ГБ в количество виртуальных ядер по 3 ГБ.

- **Плата за ресурсы**: ЦП и память
- **Сумма счета**: Виртуальное ядро Цена за единицу * максимум (мин виртуальных ядер, виртуальных ядер используется, минимальный объем памяти, гб * 1/3, использованный объем памяти * 1/3) 
- **Частота выставления счетов**: в секунду

Цена за единицу Виртуальное ядро — это стоимость за Виртуальное ядро в секунду. См. подробнее на [странице с ценами на Базу данных SQL Azure](https://azure.microsoft.com/pricing/details/sql-database/single/), где приведены цены за потребленные единицы ресурсов в заданном регионе.

Объем тарифицируемых вычислительных ресурсов определяется следующим показателем:

- **Показатель**: app_cpu_billed (виртуальное ядро в секунду).
- **Определение**: максимальный объем ресурсов (минимальное количество виртуальных ядер, используемое количество виртуальных ядер, минимальный объем памяти в ГБ * 1/3, используемый объем памяти в ГБ * 1/3).
- **Периодичность создания отчетов**: в минуту

Это количество вычисляется каждую секунду и суммируется за 1 минуту.

### <a name="minimum-compute-bill"></a>Минимальная расчетная ведомость

Если база данных без сервера приостановлена, то расчетная ведомость равна нулю.  Если база данных без сервера не приостановлена, минимальное значение расчетного счета не меньше, чем количество виртуальных ядер, основанное на Max (min виртуальных ядер, min memory ГБ * 1/3).

Примеры:

- Предположим, что база данных без сервера не приостановлена и не настроена с 8 максимальным виртуальных ядер и 1 мин Виртуальное ядро, соответствующей объему памяти 3,0 ГБ.  Затем минимальный расчетный счет основывается на Макс. (1 Виртуальное ядро, 3,0 ГБ * 1 Виртуальное ядро/3 ГБ) = 1 Виртуальное ядро.
- Предположим, что база данных без сервера не приостановлена и не настроена с 4 максимальным числом виртуальных ядер и 0,5 мин виртуальных ядер, соответствующим 2,1 ГБ памяти.  Затем минимальный расчетный счет основывается на Max (0,5 виртуальных ядер, 2,1 ГБ * 1 Виртуальное ядро/3 ГБ) = 0,7 виртуальных ядер.

[Калькулятор цен на базу данных SQL Azure](https://azure.microsoft.com/pricing/calculator/?service=sql-database) для бессерверной модели можно использовать, чтобы определить минимальный объем памяти, настраиваемый в зависимости от числа настроенных максимальных и минимальных виртуальных ядер.  Как правило, если настроенная минимальная виртуальных ядер превышает 0,5 виртуальных ядер, то минимальный расчетный счет не зависит от минимально настроенной памяти и основывается только на количестве мин виртуальных ядер, настроенных.

### <a name="example-scenario"></a>Пример сценария

Рассмотрим бессерверную базу данных с 1 min Виртуальное ядро и 4 Max виртуальных ядер.  Это соответствует примерно 3 ГБ памяти и максимальный объем памяти, равный 12 ГБ.  Предположим, что задержка автоматической приостановки равна 6 часам, а Рабочая нагрузка базы данных активна в течение первых 2 часов в 24-часовом периоде и иным образом неактивна.    

В этом случае база данных оплачивается для вычислений и хранения в течение первых 8 часов.  Несмотря на то, что база данных неактивна, начиная с второго часа, она по-прежнему оплачивается за вычислительные ресурсы в течение последующих 6 часов на основе минимальной подготовленной вычислительной среды, когда база данных находится в режиме «в сети».  В течение оставшейся части 24-часового периода во время приостановки базы данных оплачивается только хранилище.

Точнее, расчетный счет в этом примере вычисляется следующим образом:

|Интервал времени|Виртуальных ядер используется в секунду|ГБ использовано в секунду|Расчетное измерение выставляется|Виртуальное ядро с оплатой по интервалу времени|
|---|---|---|---|---|
|0:00-1:00|4|9|используется виртуальных ядер|4 виртуальных ядер * 3600 секунд = 14400 Виртуальное ядро секунды|
|1:00-2:00|1|12|Используемая память|12 ГБ * 1/3 * 3600 секунд = 14400 Виртуальное ядро с|
|2:00-8:00|0|0|Минимальный объем памяти, подготовленный|3 ГБ * 1/3 * 21600 секунд = 21600 Виртуальное ядро с|
|8:00-24:00|0|0|При приостановленном расчете не выставляется счет|0 Виртуальное ядро секунд|
|Общее количество Виртуальное ядро секунд, выставленных за 24 часа||||50400 Виртуальное ядро секунд|

Предположим, что цена единицы вычислений — $0.000145/Виртуальное ядро/сек.  Затем выплата за этот 24-часовой период будет выставляться по цене за единицу вычислений и виртуальное ядро за считанные секунды: $0.000145/Виртуальное ядро/Second * 50400 Виртуальное ядро секунд ~ $7,31

### <a name="azure-hybrid-benefit-and-reserved-capacity"></a>Преимущество гибридного использования Azure и зарезервированная емкость

Преимущество гибридного использования Azure (АХБ) и зарезервированные скидки не применяются к уровню вычислений без сервера.

## <a name="available-regions"></a>Доступные регионы

Уровень бессерверных вычислений доступен по всему миру, за исключением следующих регионов: Восточный Китай, Северный Китай, Центральная Германия, Северо-Восточная Германия и US Gov Central (Айова).

## <a name="next-steps"></a>Дальнейшие действия

- Чтобы начать работу, см. [краткое руководство по Создание отдельной базы данных в Базе данных SQL с помощью портала Azure](single-database-create-quickstart.md).
- См. подробнее об [ограничениях ресурсов уровня бессерверных вычислений](resource-limits-vcore-single-databases.md#general-purpose---serverless-compute---gen5).
