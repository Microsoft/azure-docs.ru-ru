---
title: Вопросы и ответы по масштабированию базы данных SQL Azure
description: Ответы на часто задаваемые вопросы клиенты запрашивают о базе данных в базе данных SQL на уровне службы "масштабирование", обычно называемом базой данных для масштабирования.
services: sql-database
ms.service: sql-database
ms.subservice: ''
ms.custom: sqldbrb=1
ms.devlang: ''
ms.topic: conceptual
author: dimitri-furman
ms.author: dfurman
ms.reviewer: ''
ms.date: 02/03/2021
ms.openlocfilehash: c6faa1703b0935d66d291281f33027b3a66a59d4
ms.sourcegitcommit: ea822acf5b7141d26a3776d7ed59630bf7ac9532
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "99526828"
---
# <a name="azure-sql-database-hyperscale-faq"></a>Вопросы и ответы по масштабированию базы данных SQL Azure
[!INCLUDE[appliesto-sqldb](../includes/appliesto-sqldb.md)]

В этой статье приводятся ответы на часто задаваемые вопросы о клиентах, которые рассматривали базу данных на уровне служб SQL Azure "горизонтальное масштабирование", так как в оставшейся части часто задаваемых вопросов просто масштабируется. В этой статье описываются сценарии, которые поддерживает функция масштабирования, а также функции, совместимые с возможностями масштабирования.

- Эта статья предназначена для читателей, которые получили базовые сведения об уровне служб "Гипермасштабирование" и ищут ответы на конкретные вопросы.
- Эта часто задаваемые вопросы не являются гуидебук или ответы на вопросы о том, как использовать базу данных с масштабированием. Чтобы получить общие сведения о масштабировании, мы рекомендуем ознакомиться с документацией по [масштабированию базы данных SQL Azure](service-tier-hyperscale.md) .

## <a name="general-questions"></a>Общие вопросы

### <a name="what-is-a-hyperscale-database"></a>Что такое база данных уровня "Гипермасштабирование"

База данных для масштабирования — это база данных в базе данных SQL на уровне служб с масштабированием, которая поддерживается технологией горизонтального масштабирования хранилища. База данных уровня "Гипермасштабирование" поддерживает размещение до 100 ТБ данных и обеспечивает высокую пропускную способность и производительность, а также быстрое масштабирование, чтобы адаптироваться к требованиям рабочей нагрузки. Масштабирование прозрачно для приложения — возможность подключения, обработки запросов и т. д. работает аналогично любой другой базе данных в базе данных SQL Azure.

### <a name="what-resource-types-and-purchasing-models-support-hyperscale"></a>Какие типы ресурсов и модели приобретения поддерживает уровень "Гипермасштабирование"

Уровень службы "Гипермасштабирование" доступен только для отдельных баз данных в рамках модели приобретения на основе виртуальных ядер в Базе данных SQL Azure.  

### <a name="how-does-the-hyperscale-service-tier-differ-from-the-general-purpose-and-business-critical-service-tiers"></a>Чем уровень служб "Гипермасштабирование" отличается от уровней "Критически важный для бизнеса" и "Общее назначение"

Уровни служб на основе виртуальное ядро отличаются в зависимости от доступности базы данных, типа хранилища, производительности и максимального размера, как описано в следующей таблице.

| | Тип ресурса | Общего назначения |  Уровень "Гипермасштабирование" | Уровень "Критически важный для бизнеса" |
|:---:|:---:|:---:|:---:|:---:|
| **Сценарии применения** |Все|Предлагает бюджетные сбалансированные варианты вычислительных ресурсов и ресурсов хранилища.|Большинства рабочих нагрузок. Автоматическое масштабирование размера хранилища до 100 ТБ, быстрое вертикальное и горизонтальное масштабирование вычислений, быстрое восстановление базы данных.|Приложения OLTP с высокой частотой транзакций и низкой задержкой операций ввода-вывода. Обеспечивает наивысшую устойчивость к сбоям и быструю отработку отказа, используя несколько синхронно обновленных реплик.|
|  **Тип ресурса** ||База данных SQL или SQL Управляемый экземпляр | Отдельная база данных | База данных SQL или SQL Управляемый экземпляр |
| **Объем вычислительных ресурсов**|База данных SQL * | От 1 до 80 виртуальных ядер | От 1 до 80 виртуальных ядер* | От 1 до 80 виртуальных ядер |
| **Объем вычислительных ресурсов**|Управляемый экземпляр SQL | 8, 16, 24, 32, 40, 64, 80 виртуальных ядер | Недоступно | 8, 16, 24, 32, 40, 64, 80 виртуальных ядер |
| **Тип хранилища** | Все |Удаленное хранилище класса Premium (для каждого экземпляра) | Не связанное хранилище с локальным кэшем SSD (для каждого экземпляра) | Сверхбыстрое локальное хранилище SSD (для каждого экземпляра) |
| **Объем памяти** | База данных SQL *| От 5 ГБ до 4 ТБ | До 100 ТБ | От 5 ГБ до 4 ТБ |
| **Объем памяти** | Управляемый экземпляр SQL  | От 32 ГБ до 8 ТБ | Недоступно | От 32 ГБ до 4 ТБ |
| **ОПЕРАЦИЙ ВВОДА-ВЫВОДА** | Отдельная база данных | 500 операций ввода-вывода в секунду на виртуальное ядро с максимальным количеством 7000 | Масштабирование — многоуровневая архитектура с кэшированием на нескольких уровнях. Действующие операции ввода-вывода будут зависеть от рабочей нагрузки. | 5000 операций ввода-вывода с максимальным значением 200 000 операций ввода-вывода|
| **ОПЕРАЦИЙ ВВОДА-ВЫВОДА** | Управляемый экземпляр SQL | Зависит от размера файла | Недоступно | 1375 операций ввода-вывода в секунду/Виртуальное ядро |
|**Доступность**|Все|1 реплика, без масштабирования для чтения, без локального кэша | Несколько реплик, до 4 горизонтального масштабирования для чтения, частичный локальный кэш | 3 реплики, 1 горизонтальное масштабирование чтения, высокая доступность в зоне, полное локальное хранилище |
|**Резервные копии**|Все|RA-GRS, срок хранения 7-35 дней (по умолчанию — 7 дней)| RA-GRS, период удержания в течение 7 дней, постоянное восстановление до точки во времени (PITR) | RA-GRS, срок хранения 7-35 дней (по умолчанию — 7 дней) |

\* Эластичные пулы не поддерживаются на уровне службы "масштабирование"

### <a name="who-should-use-the-hyperscale-service-tier"></a>Кому рекомендуется использовать уровень служб "Гипермасштабирование"

Уровень службы "линейка" предназначен для клиентов, которые имеют большие локальные SQL Server базы данных и хотят модернизировать свои приложения, перемещаясь в облако или для клиентов, которые уже используют базу данных SQL Azure и хотят значительно расширить потенциал роста базы данных. Он также предназначен для клиентов, которым нужна высокая производительность и масштабируемость. Уровень "Гипермасштабирование" представляет следующие возможности:

- Размер базы данных до 100 ТБ
- Быстрое резервное копирование базы данных независимо от размера базы данных (резервные копии основаны на моментальных снимках хранилища);
- Быстрое восстановление базы данных независимо от размера базы данных (восстановления из моментальных снимков хранилища)
- Более высокая пропускная способность журнала независимо от размера базы данных и количества виртуальных ядер
- Масштабирование для чтения с использованием одной или нескольких реплик только для чтения, используемых для разгрузки и использования в качестве горячего резервирования.
- Быстрое постоянное увеличение масштаба вычислительных ресурсов позволяет увеличить мощность для обработки высокой рабочей нагрузки и мгновенное уменьшение масштаба. Это похоже на увеличение и уменьшение масштаба между P6 и P11, например, но намного быстрее, так как это не размер операции с данными.

### <a name="what-regions-currently-support-hyperscale"></a>Какие регионы сейчас поддерживают уровень "Гипермасштабирование"

Уровень службы "масштабирование" в настоящее время доступен в регионах, перечисленных в разделе [Общие сведения о масштабировании базы данных SQL Azure](service-tier-hyperscale.md#regions).

### <a name="can-i-create-multiple-hyperscale-databases-per-server"></a>Можно ли создать несколько баз данных для масштабирования на один сервер

Да. Дополнительные сведения и ограничения на количество масштабируемых баз данных на сервере см. в разделе [ограничения ресурсов базы данных SQL для отдельных баз данных и в составе пула на сервере](resource-limits-logical-server.md).

### <a name="what-are-the-performance-characteristics-of-a-hyperscale-database"></a>Каковы характеристики производительности базы данных с масштабированием

Архитектура с масштабированием обеспечивает высокую производительность и пропускную способность при поддержке больших размеров баз данных.

### <a name="what-is-the-scalability-of-a-hyperscale-database"></a>Какова масштабируемость баз данных уровня "Гипермасштабирование"

Масштабирование обеспечивает быструю масштабируемость в зависимости от потребностей рабочей нагрузки.

- **Увеличение и уменьшение масштаба**

  С помощью масштабирования можно масштабировать основной размер вычислений с точки зрения ресурсов, таких как ЦП и память, а затем уменьшать масштаб в постоянное время. Так как хранилище является общим, увеличение и уменьшение масштаба — это не размер операции с данными.  
- **Свертывание и развертывание**

  С помощью функции масштабирования вы также получаете возможность подготовки одной или нескольких дополнительных реплик вычислений, которые можно использовать для обслуживания запросов на чтение. Это означает, что эти дополнительные расчетные реплики можно использовать в качестве реплик только для чтения для разгрузки рабочей нагрузки чтения из основных вычислений. В дополнение к доступу только для чтения, эти реплики также служат в качестве горячего резерва в случае отработки отказа с основного.

  Подготовка каждой из этих дополнительных реплик вычислений может выполняться за постоянное время и является оперативной операцией. Можно подключиться к этим дополнительным репликам вычислений только для чтения, задав для `ApplicationIntent` аргумента в строке подключения значение `ReadOnly` . Все соединения с `ReadOnly` намерением приложения автоматически направляются в одну из дополнительных доступных для чтения реплик.

## <a name="deep-dive-questions"></a>Детализированные вопросы

### <a name="can-i-mix-hyperscale-and-single-databases-in-a-single-server"></a>Можно ли сочетать масштабирование и отдельные базы данных на одном сервере

Да, можно.

### <a name="does-hyperscale-require-my-application-programming-model-to-change"></a>Требуется ли для уровня "Гипермасштабирование" менять модель программирования приложения

Нет, модель программирования приложения остается как есть. Строка подключения используется как обычно, а другие обычные способы взаимодействия с базой данных с масштабированием.

### <a name="what-transaction-isolation-level-is-the-default-in-a-hyperscale-database"></a>Какой уровень изоляции транзакций используется по умолчанию в базе данных для масштабирования

На первичной реплике по умолчанию используется уровень изоляции транзакций RCSI (изоляция моментальных снимков READ COMMITTED). На вторичных репликах с масштабным масштабированием по умолчанию используется уровень изоляции SNAPSHOT.

### <a name="can-i-bring-my-on-premises-or-iaas-sql-server-license-to-hyperscale"></a>Можно ли перенести локальную или IaaS SQL Server лицензию в "масштабирование"

Да, [Преимущество гибридного использования Azure](https://azure.microsoft.com/pricing/hybrid-benefit/) доступно на уровне "Гипермасштабирование". Каждое ядро SQL Server Standard можно сопоставить с 1 виртуальным ядром уровня "Гипермасштабирование". Каждое ядро SQL Server Enterprise можно сопоставить с 4 виртуальными ядрами уровня "Гипермасштабирование". Для вторичных реплик не требуется лицензия SQL. Преимущество гибридного использования Azureная цена будет автоматически применена к горизонтальным (дополнительным) репликам для чтения.

### <a name="what-kind-of-workloads-is-hyperscale-designed-for"></a>Для какого рода рабочих нагрузок предназначено масштабирование для

Масштабирование поддерживает все SQL Server рабочие нагрузки, но в основном оптимизировано для OLTP. Вы также можете перенести гибридные рабочие нагрузки (HTAP) и аналитические (киоски данных).

### <a name="how-can-i-choose-between-azure-synapse-analytics-and-azure-sql-database-hyperscale"></a>Как можно выбрать между Azure синапсе Analytics и масштабированием базы данных SQL Azure

Если в настоящее время выполняются интерактивные аналитические запросы с помощью SQL Server в качестве хранилища данных, то это отличный вариант, так как можно разместить небольшие и средние хранилища данных (например, несколько ТБ до 100 ТБ) с более низкими затратами. Кроме того, можно перенести SQL Server рабочие нагрузки хранилища данных в режим масштабирования с минимальными изменениями кода T-SQL.

Если вы используете аналитику данных в крупном масштабе с помощью сложных запросов и высокие тарифы на прием данных, превышающие 100 МБ/с, или с помощью хранилища данных Parallel Data Warehouse (PDW), Teradata или другого объема (MPP), Azure синапсе Analytics может быть лучшим выбором.
  
## <a name="hyperscale-compute-questions"></a>Вопросы вычислений по масштабированию

### <a name="can-i-pause-my-compute-at-any-time"></a>Можно ли приостановить вычисления в любое время

В настоящее время вы можете масштабировать вычисление и количество реплик, чтобы снизить затраты во время непикового времени.

### <a name="can-i-provision-a-compute-replica-with-extra-ram-for-my-memory-intensive-workload"></a>Можно ли подготавливать вычислительную реплику с дополнительной памятью для рабочей нагрузки с интенсивным использованием памяти

Нет. Для увеличения объема ОЗУ необходимо использовать более высокий уровень объема вычислительных ресурсов. Дополнительные сведения см. в разделе [Уровень служб "Гипермасштабирование" (предварительная версия)](resource-limits-vcore-single-databases.md#hyperscale---provisioned-compute---gen5).

### <a name="can-i-provision-multiple-compute-replicas-of-different-sizes"></a>Можно ли подготавливать несколько реплик вычислений разного размера

Нет.

### <a name="how-many-read-scale-out-replicas-are-supported"></a>Сколько реплик масштабирования чтения поддерживается

Базы данных с масштабированием создаются с одной репликой горизонтального масштабирования чтения (по умолчанию — две реплики, включая первичную). Количество реплик только для чтения можно масштабировать между 0 и 4 с помощью [портал Azure](https://portal.azure.com) или [REST API](/rest/api/sql/databases/createorupdate).

### <a name="for-high-availability-do-i-need-to-provision-additional-compute-replicas"></a>Для обеспечения высокой доступности необходимо подготавливать дополнительные реплики вычислений

В масштабах баз данных устойчивость данных обеспечивается на уровне хранилища. Для обеспечения устойчивости требуется только одна реплика. Когда реплика вычисления выходит из строя, новая реплика создается автоматически без потери данных.

Однако, если есть только одна реплика, может потребоваться некоторое время для создания локального кэша в новой реплике после отработки отказа. На этапе перестроения кэша база данных извлекает данные непосредственно с серверов страниц, что приводит к более высокой задержке хранилища и снижению производительности запросов.

Для критически важных приложений, требующих высокой доступности с минимальным влиянием на отработку отказа, необходимо подготавливать по крайней мере 2 реплики вычислений, включая основную реплику вычислений. Это конфигурация по умолчанию. Таким образом доступна реплика "горячее ожидание", которая служит целью отработки отказа.

## <a name="data-size-and-storage-questions"></a>Вопросы по размеру и хранению данных

### <a name="what-is-the-maximum-database-size-supported-with-hyperscale"></a>Каков максимальный размер базы данных, поддерживаемой при масштабировании

100 ТБ.

### <a name="what-is-the-size-of-the-transaction-log-with-hyperscale"></a>Каков размер журнала транзакций на уровне "Гипермасштабирование"

На уровне "Гипермасштабирование" журнал транзакций практически бесконечен. Вам не нужно беспокоиться об исчерпании пространства журнала в системе с высокой пропускной способностью журнала. Однако скорость создания журнала может регулироваться для непрерывного создания рабочих нагрузок. Пиковая скорость создания журнала составляет 100 МБ/с.

### <a name="does-my-tempdb-scale-as-my-database-grows"></a>`tempdb`Масштабируется ли масштаб по мере роста базы данных

Ваша `tempdb` база данных находится в локальном хранилище SSD и имеет размер пропорционально рассчитанному размеру. `tempdb`Оптимизация обеспечивает максимальную производительность. `tempdb` размер не настраивается и управляется вами.

### <a name="does-my-database-size-automatically-grow-or-do-i-have-to-manage-the-size-of-data-files"></a>Растет ли размер базы данных автоматически или нужно управлять размером файлов данных

Размер вашей базы данных автоматически увеличивается, когда вы вставляете или принимаете дополнительные данные.

### <a name="what-is-the-smallest-database-size-that-hyperscale-supports-or-starts-with"></a>Каков наименьший размер базы данных, который поддерживает или начинает масштабирование

40 ГБ. База данных с масштабированием создается с начальным размером 10 ГБ. Затем он начинает увеличиваться на 10 ГБ каждые 10 минут, пока не достигнет размера 40 ГБ. Каждый из этих блоков размером 10 ГБ выделяется на другом сервере, чтобы обеспечить больше операций ввода-вывода в секунду и более высокого параллелизма операций ввода/вывода. В связи с этой оптимизацией, даже если выбрать размер начальной базы данных меньше 40 ГБ, база данных будет автоматически увеличиваться по крайней мере на 40 ГБ.

### <a name="in-what-increments-does-my-database-size-grow"></a>На сколько увеличивается размер базы данных за раз

Размер каждого файла данных увеличивается на 10 ГБ. Одновременно может расти несколько файлов данных.

### <a name="is-the-storage-in-hyperscale-local-or-remote"></a>Является ли хранилище в локальном или удаленном масштабе.

На уровне "Гипермасштабирование" файлы данных хранятся в стандартном хранилище Azure. Данные полностью кэшируются в локальном хранилище SSD, на серверах страниц, которые находятся ближе к вычисленным репликам. Кроме того, реплики вычислений имеют кэш данных на локальном SSD и в памяти, что позволяет уменьшить частоту выборки данных с серверов удаленных страниц.

### <a name="can-i-manage-or-define-files-or-filegroups-with-hyperscale"></a>Можно ли управлять файлами или файловыми группами или определять их на уровне "Гипермасштабирование"

Нет. Файлы данных добавляются автоматически. Распространенные причины для создания дополнительных файловых групп не применяются в архитектуре хранилища с масштабированием.

### <a name="can-i-provision-a-hard-cap-on-the-data-growth-for-my-database"></a>Можно ли задать жестко фиксированное увеличение объема данных в базе данных

Нет.

### <a name="how-are-data-files-laid-out-with-hyperscale"></a>Как файлы данных строятся с помощью масштабирования

Файлы данных управляются серверами страниц, с одним сервером страниц на каждый файл данных. По мере роста размера данных добавляются файлы данных и связанные серверы страниц.

### <a name="is-database-shrink-supported"></a>Поддерживается ли уменьшение базы данных

Нет.

### <a name="is-data-compression-supported"></a>Поддерживается сжатие данных

Да, включая сжатие строк, страниц и columnstore.

### <a name="if-i-have-a-huge-table-does-my-table-data-get-spread-out-across-multiple-data-files"></a>Распространяются ли данные в огромной таблице по нескольким файлам данных

Да. Страницы данных, связанные с заданной таблицей, могут оказаться в нескольких файлах данных, которые входят в одну файловую группу. SQL Server использует [пропорциональную стратегию заполнения](/sql/relational-databases/databases/database-files-and-filegroups#file-and-filegroup-fill-strategy) для распределения данных по файлам данных.

## <a name="data-migration-questions"></a>Вопросы, связанные с миграцией данных

### <a name="can-i-move-my-existing-databases-in-azure-sql-database-to-the-hyperscale-service-tier"></a>Можно ли переместить существующие базы данных в базе данных SQL Azure на уровень службы "масштабирование"

Да. Вы можете переместить существующие базы данных в базе данных SQL Azure в масштабе. Это односторонняя миграция. Невозможно переместить базы данных с уровня служб "Гипермасштабирование" на другой уровень служб. Для подтверждения концепции (POC) рекомендуется создать копию базы данных и перенести копию в ее масштаб. 

Время, необходимое для перемещения существующей базы данных в масштабе, состоит из времени копирования данных и времени воспроизведения изменений, внесенных в базу данных источника при копировании данных. Время копирования данных пропорционально размеру данных. Время воспроизведения изменений будет короче, если перемещение выполняется в течение периода низкой активности записи.
  
### <a name="can-i-move-my-hyperscale-databases-to-other-service-tiers"></a>Можно ли переместить базы данных с масштабированием на другие уровни служб

Нет. В настоящее время невозможно переместить базу данных с масштабированием на другой уровень служб.

### <a name="do-i-lose-any-functionality-or-capabilities-after-migration-to-the-hyperscale-service-tier"></a>Будут ли утеряны функции или возможности после миграции на уровень служб "Гипермасштабирование"

Да. Некоторые функции базы данных SQL Azure пока не поддерживаются в масштабе, включая, помимо прочего, долгосрочное хранение резервных копий. После переноса баз данных на уровень "Гипермасштабирование" эти функции перестают работать.  Мы планируем, чтобы эти ограничения были временными.

### <a name="can-i-move-my-on-premises-sql-server-database-or-my-sql-server-database-in-a-cloud-virtual-machine-to-hyperscale"></a>Можно ли переместить локальную базу данных SQL Server или базу данных SQL Server в облачную виртуальную машину для масштабирования

Да. Можно использовать все существующие технологии миграции для перехода на масштабирование, включая репликацию транзакций, а также любые другие технологии перемещения данных (массового копирования, фабрики данных Azure, Azure Databricks, SSIS). См. также [Azure Database Migration Service](../../dms/dms-overview.md), поддерживающий многие сценарии миграции.

### <a name="what-is-my-downtime-during-migration-from-an-on-premises-or-virtual-machine-environment-to-hyperscale-and-how-can-i-minimize-it"></a>Что такое простой во время миграции из локальной среды или окружения виртуальной машины в масштабирование, а также как ее можно свернуть

Время простоя при переходе на масштабирование не отличается от времени простоя при переносе баз данных на другие уровни служб базы данных SQL Azure. Вы можете использовать [репликацию транзакций](replication-to-sql-database.md#data-migration-scenario
), чтобы минимизировать время простоя при миграции баз данных размером до нескольких TБ. Для очень больших баз данных (10 ТБ) можно подумать о переносе данных с помощью ADF, Spark или других технологий перемещения данных.

### <a name="how-much-time-would-it-take-to-bring-in-x-amount-of-data-to-hyperscale"></a>Сколько времени займет масштабирование X объемов данных для масштабирования

С помощью функции масштабирования можно использовать 100 МБ/с для новых или измененных данных, но время, необходимое для перемещения данных в базы данных SQL Azure, также зависит от доступной пропускной способности сети, скорости чтения исходного кода и целевого показателя уровня обслуживания целевой базы данных.

### <a name="can-i-read-data-from-blob-storage-and-do-fast-load-like-polybase-in-azure-synapse-analytics"></a>Можно ли читать данные из хранилища BLOB-объектов и выполнять быструю загрузку (например, polybase в Azure синапсе Analytics)

Клиентское приложение может считывать данные из службы хранилища Azure и загружать их в базу данных для масштабирования (как и в случае с любой другой базой данных в базе данных SQL Azure). В настоящее время polybase не поддерживается в базе данных SQL Azure. В качестве альтернативы для быстрой загрузки можно использовать [фабрику данных Azure](../../data-factory/index.yml)или использовать задание Spark в [Azure Databricks](/azure/azure-databricks/) с [соединителем Spark для SQL](spark-connector.md). Соединитель Spark для SQL поддерживает массовую вставку.

Кроме того, можно выполнить полное чтение данных из хранилища больших двоичных объектов Azure с помощью BULK INSERT или OPENROWSET: [примеры небольшого доступа к данным в хранилище BLOB-объектов Azure](/sql/relational-databases/import-export/examples-of-bulk-access-to-data-in-azure-blob-storage#accessing-data-in-a-csv-file-referencing-an-azure-blob-storage-location).

На уровне "Гипермасштабирование" не поддерживается простая модель восстановления или массового ведения журнала. Для обеспечения высокой доступности и восстановления на момент времени требуется модель полного восстановления. Однако архитектура журнала с масштабированием обеспечивает лучшую скорость приема данных по сравнению с другими уровнями служб базы данных SQL Azure.

### <a name="does-hyperscale-allow-provisioning-multiple-nodes-for-parallel-ingesting-of-large-amounts-of-data"></a>Допускает подготовку нескольких узлов для параллельного приема больших объемов данных.

Нет. Масштабирование представляет собой симметричную архитектуру с несколькими обработкой (SMP) и не является архитектурой массовой параллельной обработки (MPP) или архитектуры с несколькими хозяевами. Вы можете создать всего несколько реплик для развертывания рабочих нагрузок только для чтения.

### <a name="what-is-the-oldest-sql-server-version-supported-for-migration-to-hyperscale"></a>Какова самая старая версия SQL Server, поддерживаемая для миграции на масштабирование

SQL Server 2005. Дополнительные сведения см. в разделе [Перенос в отдельную базу данных или базу данных в пуле](migrate-to-database-from-sql-server.md#migrate-to-a-single-database-or-a-pooled-database). Дополнительные сведения см. в разделе [Устранение проблем совместимости при миграции базы данных](migrate-to-database-from-sql-server.md#resolving-database-migration-compatibility-issues).

### <a name="does-hyperscale-support-migration-from-other-data-sources-such-as-amazon-aurora-mysql-postgresql-oracle-db2-and-other-database-platforms"></a>Поддерживает ли масштабируемый перенос из других источников данных, таких как Amazon Aurora, MySQL, PostgreSQL, Oracle, DB2 и другие платформы баз данных.

Да. [Azure Database Migration Service](../../dms/dms-overview.md) поддерживает многие сценарии миграции.

## <a name="business-continuity-and-disaster-recovery-questions"></a>Вопросы о непрерывности бизнес-процессов и аварийном восстановлении

### <a name="what-slas-are-provided-for-a-hyperscale-database"></a>Какие соглашения об уровне обслуживания предоставляются для базы данных с масштабированием

См. раздел [соглашение об уровне обслуживания для базы данных SQL Azure](https://azure.microsoft.com/support/legal/sla/sql-database/v1_4/). Дополнительные вторичные реплики дополнительных ресурсов увеличивают доступность до 99,99% для базы данных с двумя или более вторичными репликами вычислений.

### <a name="are-the-database-backups-managed-for-me-by-azure-sql-database"></a>Являются резервными копиями баз данных, которыми управляет служба "база данных SQL Azure"

Да.

### <a name="how-often-are-the-database-backups-taken"></a>Как часто создаются резервные копии баз данных

Для баз данных с масштабированием не существует традиционных полных, разностных и резервных копий журналов. Вместо этого существуют обычные моментальные снимки хранилища файлов данных. Создаваемый журнал просто сохраняется как есть для настроенного срока хранения, что позволяет выполнить восстановление в любой момент времени в течение срока хранения.

### <a name="does-hyperscale-support-point-in-time-restore"></a>Поддерживает ли масштабное восстановление до точки во времени

Да.

### <a name="what-is-the-recovery-point-objective-rporecovery-time-objective-rto-for-database-restore-in-hyperscale"></a>Цель точки восстановления (RPO)/Рековери времени (RTO) для восстановления базы данных в масштабе

Значение RPO — 0 мин. Большинство операций восстановления выполняются в течение 60 минут независимо от размера базы данных. Время восстановления может быть больше для больших баз данных, и если база данных имела значительные существенные операции записи до точки восстановления во времени.

### <a name="does-database-backup-affect-compute-performance-on-my-primary-or-secondary-replicas"></a>Влияет ли резервное копирование базы данных на производительность вычислений на первичной или вторичной репликах

Нет. Резервные копии управляются подсистемой хранения и используют моментальные снимки хранилища. Они не влияют на рабочие нагрузки пользователей.

### <a name="can-i-perform-geo-restore-with-a-hyperscale-database"></a>Можно ли выполнить геовосстановление с помощью базы данных для масштабирования

Да. Географическое восстановление поддерживается полностью. В отличие от восстановления до точки во времени, для геовосстановления требуется операция с размером данных. Файлы данных копируются параллельно, поэтому длительность этой операции зависит главным образом от размера самого крупного файла в базе данных, а не от общего размера базы данных. Время геовосстановления будет значительно короче, если база данных восстановлена в регионе Azure [, связанном с](../../best-practices-availability-paired-regions.md) регионом базы данных-источника.

### <a name="can-i-set-up-geo-replication-with-hyperscale-database"></a>Можно ли настроить георепликацию с помощью базы данных для масштабирования

На данный момент нет.

### <a name="can-i-take-a-hyperscale-database-backup-and-restore-it-to-my-on-premises-server-or-on-sql-server-in-a-vm"></a>Можно ли выполнить масштабирование резервной копии базы данных и восстановить ее на локальный сервер или на SQL Server на виртуальной машине

Нет. Формат хранения для баз данных с масштабированием отличается от формата любой выпущенной версии SQL Server, и вы не контролируете резервное копирование и не имеете к ним доступа. Чтобы извлечь данные из базы данных с использованием технологии масштабирования, можно извлекать данные с помощью любых технологий перемещения данных, например фабрики данных Azure, Azure Databricks, SSIS и т. д.

## <a name="cross-feature-questions"></a>Вопросы по перекрестным функциям

### <a name="do-i-lose-any-functionality-or-capabilities-after-migration-to-the-hyperscale-service-tier"></a>Будут ли утеряны функции или возможности после миграции на уровень служб "Гипермасштабирование"

Да. Некоторые функции базы данных SQL Azure не поддерживаются в масштабах, включая, помимо прочего, долгосрочное хранение резервных копий. После переноса баз данных на уровень "Гипермасштабирование" эти функции перестают работать.

### <a name="will-polybase-work-with-hyperscale"></a>Будет работа polybase с масштабированием

Нет. Polybase не поддерживается в базе данных SQL Azure.

### <a name="does-hyperscale-have-support-for-r-and-python"></a>Поддерживает ли R и Python

На данный момент нет.

### <a name="are-compute-nodes-containerized"></a>Являются контейнерными выстраивать узлы

Нет. Процессы обработки и масштабирования выполняются на [Service Fabric](https://azure.microsoft.com/services/service-fabric/) узлах (ВМ), а не в контейнерах.

## <a name="performance-questions"></a>Вопросы о производительности

### <a name="how-much-write-throughput-can-i-push-in-a-hyperscale-database"></a>Сколько пропускной способности записи можно отправить в базу данных для масштабирования

Ограничение пропускной способности журнала транзакций равно 100 МБ/с для любого размера вычислений. Возможность достижения этой ставки зависит от нескольких факторов, в том числе от типа рабочей нагрузки, конфигурации клиента и наличия достаточной мощности вычислений на основной реплике вычислений для получения журнала.

### <a name="how-many-iops-do-i-get-on-the-largest-compute"></a>Сколько операций ввода-вывода в секунду для самых крупных вычислений

Время ожидания операций ввода-вывода в секунду и операций с вводом-выводом зависит от шаблонов рабочей нагрузки. Если данные, к которым осуществляется доступ, кэшируются в реплике вычислений, вы увидите такую же производительность ввода-вывода, как и локальный SSD.

### <a name="does-my-throughput-get-affected-by-backups"></a>Влияет ли резервное копирование на пропускную способность

Нет. Вычисление отделено от уровня хранилища. Это устраняет влияние резервного копирования на производительность.

### <a name="does-my-throughput-get-affected-as-i-provision-additional-compute-replicas"></a>Повлияет ли пропускная способность при подготовке дополнительных реплик вычислений

Так как хранилище является общим и между первичной и вторичной репликами не происходит прямой физической репликации, пропускная способность первичной реплики не будет напрямую затронута добавлением вторичных реплик. Тем не менее мы можем регулировать непрерывное создание рабочей нагрузки на сервере-источнике, чтобы разрешить ведение журнала на вторичных репликах и серверах страниц, чтобы избежать низкой производительности чтения во вторичных репликах.

### <a name="how-do-i-diagnose-and-troubleshoot-performance-problems-in-a-hyperscale-database"></a>Разделы справки диагностике и устранению проблем с производительностью в базе данных с масштабированием

Для большинства проблем с производительностью, особенно тех, которые не основаны на производительности хранилища, применяются общие инструкции диагностики SQL и устранения неполадок. Сведения о диагностике хранилища для конкретного масштаба см. в [статье Диагностика устранения неполадок производительности в SQL](hyperscale-performance-diagnostics.md).

## <a name="scalability-questions"></a>Вопросы о масштабируемости

### <a name="how-long-would-it-take-to-scale-up-and-down-a-compute-replica"></a>Сколько времени потребуется для увеличения и уменьшения масштаба вычислений в реплике

Увеличение или уменьшение масштаба вычислений обычно занимает до 2 минут независимо от размера данных.

### <a name="is-my-database-offline-while-the-scaling-updown-operation-is-in-progress"></a>Переходит ли база данных в автономный режим при увеличении и уменьшении масштаба

Нет. Увеличение и уменьшение масштаба будет выполнятся в сетевом режиме.

### <a name="should-i-expect-connection-drop-when-the-scaling-operations-are-in-progress"></a>Прервется ли соединение при выполнении операции масштабирования

Увеличение или уменьшение масштаба приводит к удалению существующих подключений, когда отработка отказа происходит в конце операции масштабирования. Добавление вторичных реплик не приводит к падению соединения.

### <a name="is-the-scaling-up-and-down-of-compute-replicas-automatic-or-end-user-triggered-operation"></a>Выполняется ли масштабирование для автоматических и непроизводительных реплик вычислений или операций, активируемых конечным пользователем.

Масштабированием управляет пользователь. Оно не автоматическое.  

### <a name="does-the-size-of-my-tempdb-database-and-rbpex-cache-also-grow-as-the-compute-is-scaled-up"></a>Растет ли размер `tempdb` базы данных и кэша RBPEX по мере масштабирования вычислений

Да. `tempdb`Размер базы данных и [кэш RBPEX](service-tier-hyperscale.md#distributed-functions-architecture) на масштабных узлах будут автоматически масштабироваться по мере увеличения числа ядер.

### <a name="can-i-provision-multiple-primary-compute-replicas-such-as-a-multi-master-system-where-multiple-primary-compute-heads-can-drive-a-higher-level-of-concurrency"></a>Можно ли подготавливать несколько основных тестовых реплик, таких как система с несколькими хозяевами, где несколько основных процессорных головок могут обеспечить более высокий уровень параллелизма.

Нет. Только первичная вычислительная реплика принимает запросы на чтение и запись. Вторичные расчетные реплики принимают только запросы только для чтения.

## <a name="read-scale-out-questions"></a>Вопросы масштабирования для чтения

### <a name="how-many-secondary-compute-replicas-can-i-provision"></a>Сколько вторичных реплик можно подготавливать

По умолчанию мы создаем одну вторичную реплику для баз данных с масштабированием. Если вы хотите изменить количество реплик, это можно сделать с помощью [портал Azure](https://portal.azure.com) или [REST API](/rest/api/sql/databases/createorupdate).

### <a name="how-do-i-connect-to-these-secondary-compute-replicas"></a>Разделы справки подключиться к этим дополнительным репликам вычислений

Можно подключиться к этим дополнительным репликам вычислений только для чтения, задав для `ApplicationIntent` аргумента в строке подключения значение `ReadOnly` . Все подключения, помеченные с помощью `ReadOnly` , автоматически направляются в одну из дополнительных доступных для чтения реплик. Дополнительные сведения см. [в разделе Использование реплик только для чтения для разгрузки рабочих нагрузок запросов только для чтения](read-scale-out.md).

### <a name="how-do-i-validate-if-i-have-successfully-connected-to-secondary-compute-replica-using-ssms-or-other-client-tools"></a>Разделы справки проверить, успешно ли выполнено подключение к вторичной реплике вычислений с помощью SSMS или других клиентских средств?

Можно выполнить следующий запрос T-SQL: `SELECT DATABASEPROPERTYEX ('<database_name>', 'Updateability')` .
В результате `READ_ONLY` вы подключаетесь к вторичной реплике только для чтения и `READ_WRITE` при подключении к первичной реплике. Обратите внимание, что для контекста базы данных необходимо задать имя базы данных, а не `master` базу данных.

### <a name="can-i-create-a-dedicated-endpoint-for-a-read-scale-out-replica"></a>Можно ли создать выделенную конечную точку для масштабируемой реплики чтения

Нет. Можно подключиться только к масштабируемым репликам для чтения, указав `ApplicationIntent=ReadOnly` .

### <a name="does-the-system-do-intelligent-load-balancing-of-the-read-workload"></a>Выполняет ли система интеллектуальную балансировку рабочей нагрузки чтения

Нет. Новое подключение с намерением только для чтения перенаправляется на произвольную реплику масштабирования чтения.

### <a name="can-i-scale-updown-the-secondary-compute-replicas-independently-of-the-primary-replica"></a>Можно ли масштабировать вторичные расчетные реплики независимо от первичной реплики

Нет. Вторичная реплика также используется в качестве целей отработки отказа высокого уровня доступности, поэтому они должны иметь ту же конфигурацию, что и база данных-источник, чтобы обеспечить ожидаемую производительность после отработки отказа.

### <a name="do-i-get-different-tempdb-sizing-for-my-primary-compute-and-my-additional-secondary-compute-replicas"></a>Я получаю другое `tempdb` Определение для моих основных вычислений и дополнительных вторичных реплик вычислений

Нет. Ваша `tempdb` база данных настраивается на основе подготовки размера вычислений. вторичные расчетные реплики имеют тот же размер, что и основное вычисление.

### <a name="can-i-add-indexes-and-views-on-my-secondary-compute-replicas"></a>Можно ли добавлять индексы и представления во вторичных репликах вычислений

Нет. Масштабируемые базы данных имеют общее хранилище, то есть все реплики вычислений видят одни и те же таблицы, индексы и представления. Если требуется, чтобы дополнительные индексы были оптимизированы для чтения на вторичном сервере, их необходимо добавить в базу данных-источник.

### <a name="how-much-delay-is-there-going-to-be-between-the-primary-and-secondary-compute-replicas"></a>Какая задержка должна находиться между первичной и вторичной репликами вычислений

Задержка данных с момента фиксации транзакции на сервере-источнике во время его чтения на вторичном сервере зависит от текущей частоты создания журнала, размера транзакции, нагрузки на реплику и других факторов. Типичная задержка данных для малых транзакций составляет десятки миллисекунд, однако верхняя граница задержки данных отсутствует. Данные на данной вторичной реплике всегда являются транзакционно согласованными. Однако в определенный момент времени задержка данных может отличаться для разных вторичных реплик. Рабочие нагрузки, которым необходимо немедленно считывать зафиксированные данные, должны выполняться на первичной реплике.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о уровне службы "масштабирование" см. в разделе " [уровень служб](service-tier-hyperscale.md)".