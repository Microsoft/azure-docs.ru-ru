---
title: Группы доверия сервера
titleSuffix: Azure SQL Managed Instance
description: Сведения о группе доверия сервера и управлении доверием между управляемыми экземплярами Azure SQL.
services: sql-database
ms.service: sql-managed-instance
ms.subservice: operations
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: sasapopo
ms.author: sasapopo
ms.reviewer: sstein, bonova
ms.date: 10/08/2020
ms.openlocfilehash: f9d5528746a85668677ab122d98e954bd39cd163
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92790735"
---
# <a name="use-server-trust-groups-to-set-up-and-manage-trust-between-sql-managed-instances"></a>Использование групп доверия серверов для установки отношений доверия между управляемыми экземплярами SQL и управления ими
[!INCLUDE[appliesto-sqlmi](../includes/appliesto-sqlmi.md)]

Группа доверия серверов — это концепция, используемая для управления доверием между управляемыми экземплярами Azure SQL. При создании группы между его членами устанавливается отношение доверия на основе сертификата. Это отношение доверия можно использовать для различных сценариев с несколькими экземплярами. Удаление серверов из группы или удаление группы приводит к удалению отношения доверия между серверами. Для создания или удаления группы доверия сервера пользователь должен иметь разрешения на запись в Управляемый экземпляр.
[Группа доверия серверов](/azure/templates/microsoft.sql/allversions) — это объект Azure Resource Manager, помеченный как **Группа доверия SQL** в портал Azure.

> [!NOTE]
> Группа доверия серверов появилась в общедоступной предварительной версии распределенных транзакций между управляемыми экземплярами Azure SQL и в настоящее время имеет некоторые ограничения, которые будут описаны далее в этой статье.

## <a name="server-trust-group-setup"></a>Установка группы доверия сервера

В следующем разделе описывается настройка группы доверия сервера.

1. Перейдите на [портал Microsoft Azure](https://portal.azure.com/).

2. Перейдите к Управляемый экземпляр Azure SQL, который планируется добавить во вновь созданную группу доверия серверов.

3. На вкладке Параметры **безопасности** перейдите на вкладку **группы доверия SQL** .

   :::image type="content" source="./media/server-trust-group-overview/security-sql-trust-groups.png" alt-text="Группы доверия сервера":::

4. На странице Конфигурация группы доверия сервера щелкните значок **создать группу** .

   :::image type="content" source="./media/server-trust-group-overview/server-trust-group-create-new-group.png" alt-text="Новая группа":::

5. В колонке создание **группы доверия SQL** задайте **имя группы**. Он должен быть уникальным во всех регионах, где находятся члены группы. **Область доверия** определяет тип сценария для перекрестного экземпляра, включенного в группу доверия сервера. В предварительной версии единственной применимой областью доверия являются **распределенные транзакции**, поэтому она не может быть изменена. Все **члены группы** должны принадлежать к одной **подписке** , но могут находиться в разных группах ресурсов. Выберите **группу ресурсов** и **SQL Server или экземпляр** , чтобы выбрать управляемый экземпляр SQL Azure, который будет входить в группу.

   :::image type="content" source="./media/server-trust-group-overview/server-trust-group-create-blade.png" alt-text="Колонка создания группы доверия серверов":::

6. После заполнения всех обязательных полей нажмите кнопку **сохранить**.

## <a name="server-trust-group-maintenance-and-deletion"></a>Обслуживание и удаление группы доверия сервера

Не удается изменить группу доверия серверов. Чтобы удалить Управляемый экземпляр из группы, необходимо удалить группу и создать новую.

В следующем разделе описывается процесс удаления группы доверия сервера. 
1. Перейдите на портал Azure.
2. Перейдите к Управляемый экземпляр, который принадлежит к группе доверия.
3. На вкладке Параметры **безопасности** перейдите на вкладку **группы доверия SQL** .
4. Выберите группу доверия, которую нужно удалить.
   :::image type="content" source="./media/server-trust-group-overview/server-trust-group-manage-select.png" alt-text="Выбор группы доверия сервера":::
5. Нажмите кнопку **Удалить группу**.
   :::image type="content" source="./media/server-trust-group-overview/server-trust-group-manage-delete.png" alt-text="Удаление группы доверия сервера":::
6. Введите имя группы доверия сервера, чтобы подтвердить удаление, и нажмите кнопку **Удалить**.
   :::image type="content" source="./media/server-trust-group-overview/server-trust-group-manage-delete-confirm.png" alt-text="Подтверждение удаления группы доверия сервера":::

> [!NOTE]
> Удаление группы доверия сервера может не сразу удалить доверие между двумя управляемыми экземплярами. Удаление доверия может быть применено путем вызова [отработки отказа](/powershell/module/az.sql/Invoke-AzSqlInstanceFailover) управляемых экземпляров. Ознакомьтесь с [известными проблемами](../database/doc-changes-updates-release-notes.md?tabs=managed-instance#known-issues) для последних обновлений.

## <a name="limitations"></a>Ограничения

Во время общедоступной предварительной версии к группам доверия сервера применяются следующие ограничения.
 * Имя группы доверия сервера должно быть уникальным во всех регионах, где находятся ее члены.
 * Группа может содержать только управляемые экземпляры SQL Azure, и они должны быть в одной подписке Azure.
 * В предварительной версии группа может иметь ровно два управляемых экземпляра. Для выполнения распределенных транзакций в более чем двух управляемых экземплярах необходимо создать группу доверенных серверов для каждой пары управляемых экземпляров.
 * Распределенные транзакции — единственная применимая область для групп доверия сервера.
 * Группу доверия сервера можно управлять только из портал Azure. Поддержка PowerShell и интерфейса командной строки будет происходить позже.
 * Невозможно изменить группу доверия серверов на портал Azure. Его можно создать или удалить.
 * Дополнительные ограничения распределенных транзакций могут быть связаны с вашим сценарием. Самое важное состоит в том, что между управляемыми экземплярами и частными конечными точками должно быть подключение через пиринг ВИРТУАЛЬНОЙ сети или виртуальной сети. Убедитесь, что у вас есть [сведения об ограничениях на текущие распределенные транзакции для управляемый экземпляр](../database/elastic-transactions-overview.md#limitations).

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о распределенных транзакциях в Управляемый экземпляр SQL Azure см. в разделе [распределенные транзакции](../database/elastic-transactions-overview.md).
* Сведения о состоянии обновлений выпуска и известных проблемах см. в разделе [управляемый экземпляр заметки о выпуске](../database/doc-changes-updates-release-notes.md).
* При наличии запросов на функции добавьте их на [форум управляемый экземпляр](https://feedback.azure.com/forums/915676-sql-managed-instance).