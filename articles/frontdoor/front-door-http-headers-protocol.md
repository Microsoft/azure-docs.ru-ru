---
title: Поддержка протокола для заголовков HTTP в передней дверце Azure | Документация Майкрософт
description: В этой статье описываются протоколы HTTP Header, поддерживаемые интерфейсом front двери.
services: frontdoor
documentationcenter: ''
author: duongau
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 12/04/2020
ms.author: duau
ms.openlocfilehash: 7f40b48473c04238d504288307039948fcacf90a
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97511150"
---
# <a name="protocol-support-for-http-headers-in-azure-front-door"></a>Поддержка протокола для заголовков HTTP в передней дверце Azure
В этой статье описывается протокол, который поддерживает передняя дверь с частями пути вызова (см. изображение). В следующих разделах содержатся дополнительные сведения о заголовках HTTP, поддерживаемых передней дверцей.

:::image type="content" source="./media/front-door-http-headers-protocol/front-door-protocol-summary.png" alt-text="Протокол заголовков HTTP для передней дверцы Azure":::

>[!IMPORTANT]
>Передняя дверца не удостоверяет все заголовки HTTP, которые здесь не описаны.

## <a name="client-to-front-door"></a>Клиент — Front Door
Передняя дверца принимает большинство заголовков для входящего запроса, не изменяя их. Некоторые зарезервированные заголовки удаляются из входящего запроса, если он отправлен, включая заголовки с префиксом X-демон-*.

## <a name="front-door-to-backend"></a>Front Door — серверная система

Передняя дверца включает заголовки для входящего запроса, если они не удалены из-за ограничений. Передняя дверца также добавляет следующие заголовки:

| Header  | Пример и описание |
| ------------- | ------------- |
| Via |  *Via: 1,1 Azure* </br> Передняя дверь добавляет версию HTTP клиента, а затем *Azure* в качестве значения для заголовка Via. Этот заголовок указывает версию HTTP клиента, и эта Передняя дверца является промежуточным получателем для запроса между клиентом и серверной частью.  |
| X-Azure-ClientIP | *X-Azure-ClientIP: 127.0.0.1* </br> Представляет IP-адрес клиента, связанный с обрабатываемым запросом. Например, запрос, поступающий от прокси-сервера, может добавить заголовок X-Forwardd-for, чтобы указать IP-адрес исходного вызывающего объекта. |
| X-Azure-Соккетип |  *X-Azure-Соккетип: 127.0.0.1* </br> Представляет IP-адрес сокета, связанный с подключением TCP, из которого был получен текущий запрос. IP-адрес клиента запроса может не совпадать с IP-адресом сокета, так как он может быть произвольно перезаписан пользователем.|
| X — Azure-ref | *X-Azure-ref: 0zxV + XAAAAABKMMOjBv2NT4TY6SQVjC0zV1NURURHRTA2MTkANDM3YzgyY2QtMzYwYS00YTU0LTk0YzMtNWZmNzA3NjQ3Nzgz* </br> Уникальная строка ссылки, идентифицирующая запрос, обслуживаемый передней дверцей. Он используется для поиска в журналах доступа и критически важных для устранения неполадок.|
| X-Azure-Рекуестчаин | *X-Azure-Рекуестчаин: прыжков = 1* </br> Заголовок, который используется интерфейсной дверцей для обнаружения циклов запросов, и пользователи не должны зависеть от него. |
| X-Azure-ФДИД | *X-Azure-ФДИД: 55ce4ed1-4b06-4bf1-b40e-4638452104da* <br/> Строка ссылки, идентифицирующая запрос, поступил из определенного ресурса передней дверцы. Значение можно увидеть в портал Azure или получить с помощью API управления. Этот заголовок можно использовать в сочетании с списками ACL IP-адресов, чтобы заблокировать конечную точку, чтобы принимать запросы только от конкретного ресурса передней дверцы. [Дополнительные сведения](front-door-faq.md#how-do-i-lock-down-the-access-to-my-backend-to-only-azure-front-door) см. в часто задаваемых вопросах |
| X-Forwarded-For | *X-переслано — для: 127.0.0.1* </br> Поле заголовка HTTP X-Forwardd-for (КСФФ) часто определяет исходный IP-адрес клиента, подключающегося к веб-серверу через прокси-сервер HTTP или подсистему балансировки нагрузки. Если имеется существующий заголовок КСФФ, то передняя дверь добавляет к нему IP-адрес сокета клиента или добавляет заголовок КСФФ с IP-адресом сокета клиента. |
| X-Forwarded-Host | *X-Forwarded — узел: contoso.azurefd.net* </br> Поле заголовка HTTP X-Forwardd-Host НТТР является общим методом, используемым для обнаружения исходного узла, запрошенного клиентом в заголовке HTTP-запроса узла. Это связано с тем, что имя узла из передней дверцы может отличаться для внутреннего сервера, обрабатывающего запрос. |
| X-Forwarded-Proto | *X-Forwarded-определяемое: http* </br> Для обнаружения исходного протокола HTTP-запроса часто используется поле заголовка HTTP с пересылкой по оси X. Передняя дверца на основе конфигурации может взаимодействовать с серверной частью с помощью протокола HTTPS. Это справедливо, даже если запрос к обратным прокси-серверу имеет значение HTTP. |
| X-демон-HealthProbe | Поле заголовка HTTP X-демо-HealthProbe используется для определения пробы работоспособности из передней дверцы. Если для этого заголовка задано значение 1, то запрос является зондом работоспособности. Вы можете использовать, если вы хотите ограничивать доступ из определенной передней дверцы с помощью поля заголовка X-Forwardd-Host. |
| X-Azure-ФДИД | *Заголовок X-Azure-ФДИД: 437c82cd-360A-4a54-94c3-5ff707647783* </br> Это поле содержит Фронтдурид, которые можно использовать для указания, из какой передней дверцы получен входящий запрос. Это поле заполняется службой "Передняя дверь". | 

## <a name="front-door-to-client"></a>Front Door — клиент

Все заголовки, отправленные в переднюю дверцу из серверной части, также передаются клиенту. Ниже приведены заголовки, отправляемые с передней дверцы клиентам.

| Header  | Пример и описание |
| ------------- | ------------- |
| X — Azure-ref |  *X-Azure-ref: 0zxV + XAAAAABKMMOjBv2NT4TY6SQVjC0zV1NURURHRTA2MTkANDM3YzgyY2QtMzYwYS00YTU0LTk0YzMtNWZmNzA3NjQ3Nzgz* </br> Это уникальная строка ссылки, которая определяет запрос, обслуживаемый передней дверцей, который является критически важным для устранения неполадок, так как он используется для поиска в журналах доступа.|
| Кэш X | *Кэш X: TCP_HIT* </br> В этом заголовке описывается состояние кэша запроса, которое позволяет узнать, обслуживается ли содержимое ответа из кэша передней дверцы. |

Для включения следующих необязательных заголовков ответа необходимо отправить заголовок запроса X-Azure-Дебугинфо: 1.

| Header  | Пример и описание |
| ------------- | ------------- |
| X-Azure-Оригинстатускоде |  *X-Azure-Оригинстатускоде: 503* </br> Этот заголовок содержит код состояния HTTP, возвращаемый серверной частью. С помощью этого заголовка можно задать код состояния HTTP, возвращаемый приложением, выполняемым в серверной части, без перехода к внутренним журналам. Этот код состояния может отличаться от кода состояния HTTP в ответе, отправляемом клиенту через переднюю дверь. Этот заголовок позволяет определить, является ли сервер неправильным поведением, или же проблема связана со службой Front двери. |
| X-Azure-Интерналеррор | В этом заголовке будет содержаться код ошибки, поступающий в переднюю дверцу при обработке запроса. Эта ошибка указывает на то, что проблема является внутренней для службы и инфраструктуры передней дверцы. Сообщите о проблемах в службу поддержки.  |
| X-Azure-Екстерналеррор | *X-Azure-Екстерналеррор: 0x830c1011, центр сертификации не знаком.* </br> В этом заголовке показан код ошибки, с которой поступают серверы передней дверцы при установлении подключения к внутреннему серверу для обработки запроса. Этот заголовок поможет определить проблемы подключения между передней дверцей и серверным приложением. В этот заголовок будет включено подробное сообщение об ошибке, помогающее определить проблемы с подключением к серверной части (например, разрешение DNS, недопустимый сертификат и т. д.). |

## <a name="next-steps"></a>Дальнейшие действия

- [Создание профиля Front Door](quickstart-create-front-door.md)
- [Принцип работы передней дверцы](front-door-routing-architecture.md)
