---
title: Учебник по добавлению личного домена к конфигурации Azure Front Door
description: В этом руководстве вы узнаете, как подключить личный домен к службе Azure Front Door.
services: frontdoor
documentationcenter: ''
author: duongau
editor: ''
ms.service: frontdoor
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 09/24/2020
ms.author: duau
ms.openlocfilehash: e153edd807dcb119c34f60dc34e33fed510916bb
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96011529"
---
# <a name="tutorial-add-a-custom-domain-to-your-front-door"></a>Руководство по Добавление личного домена в службу Front Door
В этом руководстве показано, как добавить личный домен в службу Front Door. При использовании службы Azure Front Door для доставки приложения, если вы хотите обеспечить видимость своего доменного имени в запросе пользователя, требуется личный домен. Видимое доменное имя удобно для клиентов и эффективно используется для популяризации бренда.

После создания Front Door стандартный узел внешнего интерфейса, который является поддоменом `azurefd.net`, по умолчанию включается в URL-адрес для доставки содержимого Front Door из серверной части (например, https:\//contoso-frontend.azurefd.net/activeusers.htm). Для удобства Azure Front Door предоставляет возможность связать личный домен с узлом по умолчанию. Благодаря этой возможности можно отправить содержимое с личным доменом в URL-адресе, а не именем домена владельца Front Door (например, https:\//www.contoso.com/photo.png). 

В этом руководстве описано следующее:
> [!div class="checklist"]
> - создание записи CNAME DNS;
> - связывание личного домена с Front Door.
> - проверка личного домена.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

> [!NOTE]
> Front Door **не поддерживает** личные домены с символами [punycode](https://en.wikipedia.org/wiki/Punycode). 

## <a name="prerequisites"></a>Предварительные требования

* Прежде чем перейти к выполнению шагов в этом руководстве, создайте службу Front Door. Дополнительные сведения см. в [кратком руководстве Создание профиля Front Door для высокодоступного глобального веб-приложения](quickstart-create-front-door.md).

* Если у вас еще нет личного домена, сначала нужно приобрести его у поставщика доменов. Например, ознакомьтесь с руководством [Приобретение имени личного домена для веб-приложений Azure](../app-service/manage-custom-dns-buy-domain.md).

* Если вы используете Azure для размещения [доменов DNS](../dns/dns-overview.md), вам следует делегировать систему доменного имени поставщика домена (DNS) в Azure DNS. Дополнительные сведения см. в статье [Делегирование домена в Azure DNS](../dns/dns-delegate-domain-azure-dns.md). В противном случае при использовании поставщика доменов для обработки домена DNS перейдите к разделу [создания записей CNAME DNS](#create-a-cname-dns-record).


## <a name="create-a-cname-dns-record"></a>Создание записи CNAME DNS

Перед использованием личного домена с Front Door сначала необходимо создать запись канонического имени (CNAME) поставщика домена для указания узла внешнего интерфейса Front Door по умолчанию (например contoso.azurefd.net). Запись CNAME — это тип записи DNS, позволяющий сопоставить имена исходного и конечного доменов. Для Azure Front Door исходное доменное имя является именем вашего личного домена, а имя домена назначения представляет собой имя узла Front Door по умолчанию. После того как Front Door проверит созданную запись CNAME, трафик, адресованный исходному личному домену (например, www\.contoso.com), будет направлен к указанному узлу внешнего интерфейса Front Door по умолчанию (например, contoso-frontend.azurefd.net). 

Личный домен и его поддомен можно связать только с одной службой Front Door за раз. Однако можно использовать разные поддомены одного и того же личного домена для разных служб Front Door с помощью нескольких записей CNAME. Кроме того, можно сопоставить личный домен с разными поддоменами с одной службой Front Door.


## <a name="map-the-temporary-afdverify-subdomain"></a>Сопоставление временного поддомена afdverify

При сопоставлении имеющегося в рабочей среде домена стоит обратить внимание на следующее. При регистрации личного домена на портале Azure может возникнуть короткий период простоя домена. Во избежание прерывания веб-трафика сначала сопоставьте личный домен с именем узла внешнего интерфейса Front Door по умолчанию с поддоменом afdverify Azure, чтобы создать временное сопоставление CNAME. С помощью этого метода пользователи могут беспрепятственно получить доступ к вашему домену во время сопоставления DNS.

В противном случае, если вы впервые используете свой личный домен и у него нет рабочего трафика, его можно напрямую сопоставить с Front Door. Ознакомьтесь с разделом о [сопоставлении постоянного личного домена](#map-the-permanent-custom-domain).

Чтобы создать запись CNAME с поддоменом afdverify, сделайте следующее:

1. Войдите на веб-сайт поставщика своего личного домена.

2. Найдите страницу для управления записями DNS. Для этого ознакомьтесь с документацией поставщика или поищите области веб-сайта, обозначенные как **Доменное имя**, **DNS** или **Name Server Management** (Управление сервером доменных имен). 

3. Создайте запись CNAME для своего личного домена и заполните поля, как показано в таблице ниже (имена полей могут отличаться):

    | Источник                    | Тип  | Назначение                     |
    |---------------------------|-------|---------------------------------|
    | afdverify. www.contoso.com | CNAME | afdverify.contoso-frontend.azurefd.net |

    - Источник: введите имя своего личного домена, включая поддомен afdverify, в следующем формате: afdverify. _&lt;имя личного домена&gt;_ . Например, afdverify. www.contoso.com.

    - Тип: введите *CNAME*.

    - Назначение: введите узел внешнего интерфейса Front Door по умолчанию, включая поддомен afdverify, в следующем формате: afdverify. _&lt;имя конечной точки&gt;_ .azurefd.net. Например, afdverify.contoso-frontend.azurefd.net.

4. Сохраните изменения.

Например, процедура для регистратора домена GoDaddy выглядит следующим образом:

1. Войдите в систему и выберите личный домен, который нужно использовать.

2. В разделе доменов выберите **Управление**, а затем — **DNS** | **Manage Zones** (Управление зонами).

3. Для **доменного имени** введите свой личный домен, а затем выберите **Поиск**.

4. На странице **управления DNS** выберите **Добавить**, а затем в списке **типа** выберите **CNAME**.

5. Заполните следующие поля записи CNAME:

    - Тип: оставьте выбранное значение *CNAME*.

    - "Узел": введите поддомен своего личного домена, в том числе имя поддомена afdverify. Например, afdverify. www.

    - Points to (Указывает на): введите имя узла внешнего интерфейса Front Door по умолчанию, включая имя поддомена afdverify. Например, afdverify.contoso-frontend.azurefd.net. 

    - "Срок жизни": оставьте выбранным значение *Один час*.

6. Щелкните **Сохранить**.
 
    Запись CNAME добавится к таблице записей DNS.


## <a name="associate-the-custom-domain-with-your-front-door"></a>Связывание личного домена с Front Door

После регистрации личного домена его можно добавить в службу Front Door.

1. Войдите на [портал Azure](https://portal.azure.com/) и перейдите к службе Front Door, в которой содержится узел внешнего интерфейса, который нужно сопоставить с личным доменом.
    
2. На странице **Front Door designer** (Конструктор Front Door) щелкните "+", чтобы добавить личный домен.
    
3. Укажите **личный домен**. 

4. **Узел внешнего интерфейса**, используемый в качестве целевого домена записи CNAME, предварительно заполняется и выводится из службы Front Door: *&lt;имя узла по умолчанию&gt;* .azurefd.net. Их невозможно изменить.

5. Для параметра **Пользовательское имя узла** укажите личный домен (включая дочерний домен), который будет использоваться в качестве исходного домена записи CNAME. Например, www\.contoso.com или cdn.contoso.com. Не используйте имя поддомена afdverify.

6. Выберите **Добавить**.

   Azure проверит наличие записи CNAME для введенного имени личного домена. Если запись CNAME правильна, пользовательский домен пройдет проверку.

>[!WARNING]
> Вы **должны** убедиться, что каждый из узлов внешнего интерфейса (включая личные домены) в службе Front Door имеет правило маршрутизации со связанным с ним путем по умолчанию ("/\*"). То есть среди всех правил маршрутизации должно быть по крайней мере одно правило для каждого из узлов внешнего интерфейса, определенных в пути по умолчанию ("/\*"). В противном случае это может привести к неправильной маршрутизации трафика пользователя.

## <a name="verify-the-custom-domain"></a>Проверка личного домена.

После завершения регистрации личного домена убедитесь, что он ссылается на узел внешнего интерфейса Front Door по умолчанию.
 
В браузере перейдите по адресу файла с помощью личного домена. Например, если вашим личным доменом является robotics.contoso.com, URL-адрес кэшированного файла будет похож на следующий URL-адрес: http:\//robotics.contoso.com/my-public-container/my-file.jpg. Убедитесь, что результат такой же, как при доступе к Front Door непосредственно по адресу *&lt;Узел Front Door&gt;* .azurefd.net.


## <a name="map-the-permanent-custom-domain"></a>Сопоставление постоянного личного домена

После проверки успешного сопоставления поддомена afdverify с Front Door (или при использовании нового личного домена, который размещается не в рабочей среде) можно затем сопоставить личный домен напрямую с узлом внешнего интерфейса Front Door по умолчанию.

Чтобы создать запись CNAME для личного домена, сделайте следующее.

1. Войдите на веб-сайт поставщика своего личного домена.

2. Найдите страницу для управления записями DNS. Для этого ознакомьтесь с документацией поставщика или поищите области веб-сайта, обозначенные как **Доменное имя**, **DNS** или **Name Server Management** (Управление сервером доменных имен). 

3. Создайте запись CNAME для своего личного домена и заполните поля, как показано в таблице ниже (имена полей могут отличаться):

    | Источник          | Тип  | Назначение           |
    |-----------------|-------|-----------------------|
    | <www.contoso.com> | CNAME | contoso-frontend.azurefd.net |

   - Источник: введите имя личного домена (например, www\.contoso.com).

   - Тип: введите *CNAME*.

   - Назначение: введите узел внешнего интерфейса Front Door по умолчанию. Должен использоваться следующий формат: _&lt;имя узла&gt;_ .azurefd.net. Например, contoso-frontend.azurefd.net.

4. Сохраните изменения.

5. Если вы ранее создали временную запись CNAME поддомена afdverify, удалите ее. 

6. Если вы используете этот личный домен в рабочей среде впервые, выполните действия для [связывания личного домена с Front Door](#associate-the-custom-domain-with-your-front-door) и [проверки этого личного домена](#verify-the-custom-domain).

Например, процедура для регистратора домена GoDaddy выглядит следующим образом:

1. Войдите в систему и выберите личный домен, который нужно использовать.

2. В разделе доменов выберите **Управление**, а затем — **DNS** | **Manage Zones** (Управление зонами).

3. Для **доменного имени** введите свой личный домен, а затем выберите **Поиск**.

4. На странице **управления DNS** выберите **Добавить**, а затем в списке **типа** выберите **CNAME**.

5. Заполните следующие поля записи CNAME:

    - Тип: оставьте выбранное значение *CNAME*.

    - "Узел": введите поддомен личного домена. Например, www или профиль.

    - Points to (Указывает на): введите имя узла Front Door по умолчанию. Например, contoso.azurefd.net. 

    - "Срок жизни": оставьте выбранным значение *Один час*.

6. Щелкните **Сохранить**.
 
    Запись CNAME добавится к таблице записей DNS.

7. Если у вас есть запись CNAME afdverify, нажмите значок карандаша рядом с ней, а затем выберите значок урны.

8. Выберите **Удалить**, чтобы удалить запись CNAME.


## <a name="clean-up-resources"></a>Очистка ресурсов

Ранее вы добавили личный домен к Front Door. Если вы больше не хотите связывать Front Door с личным доменом, этот домен можно удалить, выполнив действия ниже:
 
1. В конструкторе Front Door выберите личный домен, который нужно удалить.

2. Нажмите кнопку "Удалить" в контекстном меню для личного домена.  

   Личный домен отсоединится от конечной точки.


## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:

* создание записи CNAME DNS;
* связывание личного домена с Front Door.
* проверка личного домена.

Чтобы узнать, как включить протокол HTTPS для личного домена, перейдите к следующему руководству.

> [!div class="nextstepaction"]
> [Включение HTTPS для личного домена](front-door-custom-domain-https.md)