---
title: Передняя дверца Azure — балансировка нагрузки с помощью пакета доставки приложений Azure | Документация Майкрософт
description: Эта статья поможет вам узнать о том, как Azure рекомендует выполнять балансировку нагрузки с помощью пакета доставки приложений.
services: frontdoor
documentationcenter: ''
author: duongau
ms.service: frontdoor
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/28/2020
ms.author: duau
ms.openlocfilehash: 50e047325ad17710794b1640715ab1938373fe85
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96019469"
---
# <a name="load-balancing-with-azures-application-delivery-suite"></a>Балансировка нагрузки с помощью набора служб Azure для предоставления приложения

## <a name="introduction"></a>Введение
Microsoft Azure предоставляет различные глобальные и региональные службы для управления распределением сетевого трафика и балансировкой нагрузки. 

* Шлюз приложений
* Front Door 
* Load Balancer  
* Диспетчер трафика

Вместе с множеством регионов и зональные архитектуры Azure использование этих служб совместно позволяет создавать надежные, масштабируемые и высокопроизводительные приложения.

:::image type="content" source="./media/front-door-lb-with-azure-app-delivery-suite/application-delivery-figure1.png" alt-text="Набор служб для предоставления приложений":::
 
Эти службы разбиваются на две категории.
1. **Глобальные службы балансировки нагрузки** , такие как диспетчер трафика и передняя дверца, распределяют трафик от конечных пользователей по региональным серверам, по облакам и даже к гибридным локальным службам. Глобальная балансировка нагрузки направляет трафик на ближайшую серверную часть службы и реагирует на изменения в надежности службы, чтобы обеспечить постоянную доступность и высокую производительность пользователей. 
1. **Региональные службы балансировки нагрузки** , такие как балансировщик нагрузки и шлюзы приложений, обеспечивают возможность распределять трафик между виртуальными машинами в виртуальной сети (виртуальных сетей) или конечными точками службы в пределах региона.

При объединении этих глобальных и региональных служб приложение будет использовать надежный и защищенный сквозной трафик, который отправляется конечным пользователям в IaaS, PaaS или локальные службы. В следующем разделе описывается каждая из этих служб.

## <a name="global-load-balancing"></a>глобальная балансировка нагрузки.
**Диспетчер трафика** выполняет глобальную балансировку нагрузки на уровне DNS. Он просматривает входящие запросы DNS и реагирует на работоспособную серверную часть, следуя политике маршрутизации, выбранной клиентом. Используются следующие методы маршрутизации:
- * * Маршрутизация производительности отправляет запросы на ближайший сервер с наименьшей задержкой.
- **Маршрутизация по приоритетам** направляет весь трафик на серверную часть, а другие серверы в качестве резервного копирования.
- **Взвешенный циклический маршрут** распределяет трафик на основе весов, назначенных каждой серверной части.
- **Географическая маршрутизация** гарантирует, что запросы, получаемые из конкретных географических регионов, обрабатываются с помощью невыполненных запросов. (Например, все запросы из Испании должны направляться в Центральный регион Azure для Франции).
- **Маршрутизация подсетей** позволяет сопоставлять диапазоны IP-адресов с серверными элементами, чтобы входящие запросы к этим IP-адресам отправлялись на конкретную внутреннюю часть. (Например, любые пользователи, подключающиеся из диапазона IP-адресов корпоративного офиса, должны получать разные веб-содержимое, чем общие пользователи).

Клиент подключается напрямую к указанной серверной части. Если серверная часть неработоспособна, диспетчер трафика Azure обнаружит это и перенаправит клиентов на другой работающий экземпляр. Дополнительные сведения о службе см. в документации по [диспетчеру трафика Azure](../traffic-manager/traffic-manager-overview.md) .

**Передняя дверца Azure** обеспечивает динамическое ускорение веб-сайтов (DSA), включая глобальную балансировку нагрузки HTTP.  Она просматривает входящие HTTP-запросы, направленные в ближайшую серверную часть или регион для указанного имени узла, URL-адреса и настроенных правил.  
Front Door завершает HTTP-запросы на границе сети Майкрософт и активно проверяет приложения или инфраструктуры на наличие изменений работоспособности или задержки.  Затем служба Front Door направляет трафик в наиболее быструю и доступную серверную часть (работоспособную). Дополнительные сведения о службе см. в статьях, посвященных [архитектуре маршрутизации](front-door-routing-architecture.md) и [методам маршрутизации Front Door](front-door-routing-methods.md).

## <a name="regional-load-balancing"></a>Региональная балансировка нагрузки
Шлюз приложений предоставляет контроллер доставки приложений (ADC) как услугу, предлагая для приложения разные функции балансировки нагрузки уровня 7. С его помощью клиенты могут оптимизировать производительность веб-фермы за счет разгрузки прерывания TLS с интенсивным использованием ЦП в шлюз приложений. Другие дополнительные возможности маршрутизации уровня 7 также включают циклическое распределение входящего трафика, сходство сеансов на основе файлов cookie, маршрутизацию на основе URL-путей и возможность размещения нескольких веб-сайтов за одним шлюзом приложений. Шлюз приложений можно настроить как конечную точку с выходом в Интернет, конечную точку только для внутреннего использования или сочетание обоих параметров. Шлюз приложений полностью управляется Azure, обеспечивая масштабируемость и высокую доступность. Для более эффективного управления предоставляется широкий набор возможностей ведения журнала и диагностики.

Подсистемы балансировки нагрузки являются неотъемлемой частью стека Azure SDN, который обеспечивает высокопроизводительные службы балансировки нагрузки уровня 4 с низкой задержкой для всех протоколов UDP и TCP. Можно настроить общедоступные или внутренние конечные точки с балансировкой нагрузки, определив правила, которые сопоставляют входящие подключения к внутренним пулам. Мониторинг работоспособности с помощью протокола TCP или HTTPS помогает управлять доступностью службы.

## <a name="choosing-a-global-load-balancer"></a>Выбор глобальной подсистемы балансировки нагрузки
При выборе глобальной подсистемы балансировки нагрузки для глобальной маршрутизации между диспетчером трафика и Azure Front Door следует учитывать сходства и отличия между двумя службами.   Обе службы обеспечивают:
- **Множественная географическая избыточность:** Если один регион выходит из обслуживания, трафик плавно направляется в ближайший регион без вмешательства с владельца приложения.
- **Маршрутизацию в ближайший регион.** Трафик автоматически направляется в ближайший регион.

</br>В следующей таблице описаны различия между диспетчером трафика и передней дверцей Azure.</br>

| Диспетчер трафика | Azure Front Door |
| --------------- | ------------------------ |
|**Любой протокол:** Так как диспетчер трафика работает на уровне DNS, можно маршрутизировать любой тип сетевого трафика. HTTP, TCP, UDP и т. д. | **Ускорение http:** При использовании передней дверцы трафик помещается по периметру сети Microsoft. Запросы HTTP/S увидят улучшения задержки и пропускной способности, что сокращает задержку согласования TLS.|
|**Локальная маршрутизация:** При маршрутизации на уровне DNS трафик всегда переходит от точки к точке.  Маршрутизация из офиса филиала в локальный центр обработки данных может получить прямой путь; даже в собственной сети с помощью диспетчера трафика. | **Независимая масштабируемость:** Так как передняя дверца работает с HTTP-запросом, запросы к различным URL-путям можно перенаправлять в разные пулы внутренних и региональных служб (микрослужбы) на основе правил и работоспособности каждой микрослужбы приложения.|
|**Формат выставления счетов.** Выставление счетов на основе DNS, которое масштабируется в соответствии с числом пользователей. Для служб с большим количеством пользователей с помощью такой модели можно сократить затраты при высоком уровне использования. |**Встроенная безопасность.** Front Door включает правила, например ограничение частоты и применение списка управления доступом для IP-адресов, позволяя защитить серверные части перед тем, как трафик достигнет приложения. 

</br>Мы рекомендуем клиентам использовать переднюю дверцу для своей рабочей нагрузки HTTP в связи с производительностью, безопасностью и преимуществами безопасности, которые протокол HTTP работает с передней дверцей. Диспетчер трафика и Front Door можно использовать в параллельном режиме для обработки всего трафика вашего приложения. 

## <a name="building-with-azures-application-delivery-suite"></a>Сборка с помощью набора служб Azure для предоставления приложения 
Рекомендуется, чтобы все веб-сайты, API, службы были географически избыточными, чтобы по возможности передавать трафик пользователям из ближайшего расположения.  Объединение нескольких служб балансировки нагрузки позволяет создавать географические и зональные избыточность для повышения надежности и производительности.

На следующей схеме описан пример архитектуры, в которой для создания глобальной веб-службы используется сочетание всех этих служб. Архитектор использовал диспетчер трафика для маршрутизации трафика в глобальные конечные точки для доставки файлов и объектов. При использовании передней дверцы для глобального маршрута URL-путей, соответствующих шаблону/Сторе/*, со службой, которая была перенесена в службу приложений. Наконец, перенаправление всех остальных запросов в региональные шлюзы приложений.

В каждом регионе службы IaaS разработчик приложения решил, что все URL-адреса, соответствующие шаблону/Images/*, поступают из выделенного пула виртуальных машин. Этот пул виртуальных машин отличается от остальной части веб-фермы.

Кроме того, пул виртуальных машин по умолчанию, который предоставляет динамически генерируемый контент, должен взаимодействовать с серверной базой данных, размещенной в высокодоступном кластере. Все развертывание настраивается с помощью Azure Resource Manager.

На следующей схеме показана архитектура этой системы.

:::image type="content" source="./media/front-door-lb-with-azure-app-delivery-suite/application-delivery-figure2.png" alt-text="Подробная архитектура набора для предоставления приложения":::

> [!NOTE]
> Этот пример демонстрирует лишь одну из многих возможных конфигураций, которые можно реализовать с использованием служб Azure для балансировки нагрузки. Диспетчер трафика, Front Door, Шлюз приложений и Load Balancer можно использовать совместно в зависимости от ваших потребностей. Например, если не требуется разгрузка TLS/SSL или обработка уровня 7, Load Balancer можно использовать вместо шлюза приложений.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [создании Front Door](quickstart-create-front-door.md).
- Дополнительные сведения о том, [как работает Front Door](front-door-routing-architecture.md).
