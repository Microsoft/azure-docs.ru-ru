---
title: 'Передняя дверца Azure: часто задаваемые вопросы'
description: На этой странице приводятся ответы на часто задаваемые вопросы о интерфейсе передней дверцы Azure Standard/Premium.
services: frontdoor
author: duongau
ms.service: frontdoor
ms.topic: conceptual
ms.workload: infrastructure-services
ms.date: 02/18/2021
ms.author: duau
ms.openlocfilehash: 6f6d71dec9726f009ab9a56e0a49ba21f5d218fd
ms.sourcegitcommit: 24a12d4692c4a4c97f6e31a5fbda971695c4cd68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102181029"
---
# <a name="frequently-asked-questions-for-azure-front-door-standardpremium-preview"></a>Часто задаваемые вопросы о передней дверце Azure уровня "Стандартный" или "Премиум" (Предварительная версия)

В этой статье содержатся ответы на часто задаваемые вопросы о функциях и функциях передней дверцы Azure.

## <a name="general"></a>Общие сведения

### <a name="what-is-azure-front-door"></a>Что такое Azure Front Door?

Передняя дверца Azure — это быстрая, надежная и безопасная современная облачная сеть CDN с интеллектуальной защитой угроз. Он предоставляет статическое и динамическое ускорение содержимого, глобальную балансировку нагрузки и улучшенную безопасность для глобальных приложений с поддержкой Hyper-Scale, API, веб-сайтов и облачных служб с помощью интеллектуальной защиты от угроз.

### <a name="what-features-does-azure-front-door-support"></a>Какие функции поддерживает Передняя дверца Azure?

Передняя дверца Azure поддерживает:

* Статическое содержимое и ускорение динамического приложения
* Разгрузка TLS/SSL и сквозной протокол TLS
* Брандмауэр веб-приложения
* сходство сеансов на основе файлов cookie;
* Маршрутизация на основе URL-пути
* Бесплатные сертификаты и управление несколькими доменами

Полный список поддерживаемых функций см. в статье [Обзор передней дверцы Azure](overview.md).

### <a name="what-is-the-difference-between-azure-front-door-and-azure-application-gateway"></a>В чем разница между фронтальной дверцей Azure и шлюзом приложений Azure?

Хотя как передняя дверь, так и шлюз приложений являются подсистемами балансировки нагрузки уровня 7 (HTTP/HTTPS), основное различие заключается в том, что передняя дверца — это глобальная служба. Шлюз приложений — это региональная служба. В то время как передняя дверца может распределять нагрузку между различными единицами масштабирования, кластерами и единицами отметок в разных регионах, шлюз приложений позволяет распределять нагрузку между виртуальными машинами или контейнерами, которые находятся в пределах единицы масштабирования.

### <a name="when-should-we-deploy-an-application-gateway-behind-front-door"></a>Когда следует развертывать Шлюз приложений за пределами передней дверцы?

Основные сценарии, по которым следует использовать шлюз приложений за пределами передней дверцы:

* Передняя дверца может выполнять балансировку нагрузки на основе пути только на глобальном уровне, но если требуется балансировка нагрузки трафика еще дальше в пределах своей виртуальной сети (VNET), они должны использовать шлюз приложений.
* Так как передняя дверца не работает на уровне виртуальной машины или контейнера, она не может выполнять сток подключений. Однако Шлюз приложений позволяет выполнять сток подключений. 
* С помощью шлюза приложений, расположенного на передней дверце, можно достичь разгрузки 100% TLS/SSL и направить только HTTP-запросы в своей виртуальной сети (VNET).
* Интерфейсная дверца и шлюз приложений поддерживают сходство сеансов. Передняя дверца может направить трафик из сеанса пользователя в тот же кластер или серверную часть в заданном регионе. Шлюз приложений может направлять привязать трафика на тот же сервер в кластере.  

### <a name="can-we-deploy-azure-load-balancer-behind-front-door"></a>Можно ли развернуть Azure Load Balancer позади передней дверцы?

Для передачи трафика в переднюю дверь Azure требуется общедоступный виртуальный IP-адрес или общедоступное имя DNS. Развертывание Azure Load Balancer позади передней дверцы является распространенным вариантом использования.

### <a name="what-protocols-does-azure-front-door-support"></a>Какие протоколы поддерживает интерфейс передней дверцы Azure?

Передняя дверца Azure поддерживает HTTP, HTTPS и HTTP/2.

### <a name="how-does-azure-front-door-support-http2"></a>Как передняя дверца Azure поддерживает HTTP/2?

Поддержка протокола HTTP/2 доступна только для клиентов, подключающихся к передней дверце Azure. Обмен данными с серверными интерфейсами во внутреннем пуле выполняется по протоколу HTTP/1.1. Поддержка HTTP/2 включена по умолчанию.

### <a name="what-resources-are-supported-today-as-part-of-origin-group"></a>Какие ресурсы поддерживаются в настоящее время как часть исходной группы?

Исходная группа может состоять из хранилища, веб-приложения, экземпляров Kubernetes или любого другого пользовательского имени узла, имеющего общедоступное подключение. Для работы передней дверцы Azure необходимо, чтобы источники были определены через общедоступный IP-адрес или общедоступное разрешение DNS-имени узла. Члены исходной группы могут быть между зонами, регионами или даже за пределами Azure, если они имеют общедоступное подключение.

### <a name="what-regions-is-the-service-available-in"></a>В каких регионах доступна служба?

Передняя дверца Azure — это глобальная служба, которая не привязана к конкретному региону Azure. При создании передней дверцы необходимо указать единственное расположение для группы ресурсов. В этом расположении по сути указывается, где будут храниться метаданные для группы ресурсов. Сам ресурс «передняя дверь» создается как глобальный ресурс, а конфигурация развертывается глобально для всех POP (точек присутствия). 

### <a name="what-are-the-pop-locations-for-azure-front-door"></a>Что такое расположения POP для передней дверцы Azure?

Передняя дверца Azure имеет тот же список расположений POP (точек присутствия), что и Azure CDN от Майкрософт. Полный список точек подключения см. в [Azure CDN расположениях POP корпорации Майкрософт](../../cdn/cdn-pop-locations.md).

### <a name="is-azure-front-door-a-dedicated-deployment-for-my-application-or-is-it-shared-across-customers"></a>Является ли внешняя дверца Azure выделенным развертыванием для моего приложения или оно совместно используется клиентами?

Передняя дверца Azure — это глобально распределенная служба с несколькими клиентами. Инфраструктура для передней дверцы является общей для всех ее клиентов. Создавая профиль передней дверцы, вы определяете конкретную конфигурацию, необходимую для вашего приложения. Изменения, вносимые в переднюю дверцу, не влияют на другие конфигурации передней дверцы.

### <a name="is-http-https-redirection-supported"></a>Поддерживается ли перенаправление протоколов HTTP -> HTTPS?

Да. На самом деле, передняя дверца Azure поддерживает узел, путь, Перенаправление строки запроса и часть перенаправления URL-адреса. Дополнительные сведения о [перенаправлении URL-адресов](concept-rule-set-url-redirect-and-rewrite.md). 

### <a name="how-do-i-lock-down-the-access-to-my-backend-to-only-azure-front-door"></a>Разделы справки заблокировать доступ к моему серверу только к передней дверце Azure?

Лучший способ заблокировать приложение, чтобы принимать трафик только от конкретного экземпляра передней дверцы, — опубликовать приложение с помощью частной конечной точки. Сетевой трафик между передней дверцей и приложением проходит по виртуальной сети и частной ссылке на магистральную сеть Майкрософт, что устраняет уязвимость в общедоступном Интернете.

Дополнительные сведения об [источнике защиты для передней дверцы с помощью частной ссылки](concept-private-link.md).  

В качестве альтернативного способа блокировки приложения для приема трафика только от конкретной передней дверцы необходимо настроить списки ACL IP-адресов для серверной части. Затем Ограничьте трафик серверной части до указанного значения заголовка "X-Azure-ФДИД", отправленного с помощью передней дверцы. Эти действия описаны ниже.

* Настройте IP адресам для своей серверной части, чтобы принимать трафик из пространства внутреннего IP-адреса внутренней дверцы Azure и только служб инфраструктуры Azure. См. сведения об IP-адресе ниже для адресам своей серверной части:
 
    * См. раздел *азурефронтдур. сервер* в разделе [диапазоны IP-адресов и теги службы](https://www.microsoft.com/download/details.aspx?id=56519) для внутреннего диапазона IP-адреса внутренней дверцы в интерфейсе IPv4. Вы также можете использовать тег службы *азурефронтдур. внутренний* в [группах безопасности сети](../../virtual-network/network-security-groups-overview.md#security-rules).
    * [Основные службы инфраструктуры](../../virtual-network/network-security-groups-overview.md#azure-platform-considerations) Azure через ВИРТУАЛИЗИРОВАННЫЕ IP-адреса узлов: `168.63.129.16` и `169.254.169.254` .

    > [!WARNING]
    > Внутреннее IP-пространство серверной двери может измениться позже, однако мы будем уверенным в том, что до этого произойдет интеграция с [диапазонами IP-адресов и тегами служб Azure](https://www.microsoft.com/download/details.aspx?id=56519). Мы рекомендуем подписываться на [диапазоны IP-адресов и теги службы Azure](https://www.microsoft.com/download/details.aspx?id=56519) для любых изменений или обновлений.

* Выполните операцию GET на передней дверце с помощью API `2020-01-01` или более поздней версии. В вызове API найдите `frontdoorID` поле. Отфильтруйте входящий заголовок "**X-Azure-ФДИД**", отправленный с передней дверцы на серверную часть со значением поля `frontdoorID` . Можно также найти `Front Door ID` значение в разделе Обзор на странице портала передней дверцы. 

* Примените фильтрацию правил на внутреннем веб-сервере, чтобы ограничить трафик на основе полученного значения заголовка X-Azure-ФДИД.

  Ниже приведен пример для [Microsoft службы IIS (IIS)](https://www.iis.net/):

    ``` xml
    <?xml version="1.0" encoding="UTF-8"?>
    <configuration>
        <system.webServer>
            <rewrite>
                <rules>
                    <rule name="Filter_X-Azure-FDID" patternSyntax="Wildcard" stopProcessing="true">
                        <match url="*" />
                        <conditions>
                            <add input="{HTTP_X_AZURE_FDID}" pattern="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" negate="true" />
                        </conditions>
                        <action type="AbortRequest" />
                    </rule>
                </rules>
            </rewrite>
        </system.webServer>
    </configuration>
    ```

### <a name="can-the-anycast-ip-change-over-the-lifetime-of-my-front-door"></a>Может ли изменение IP-адреса неразрешенной рассылки в течение времени жизни своей передней дверцы?

IP-адрес недоступности переднего плана для передней дверцы обычно не изменяется и может оставаться статичным в течение времени существования передней дверцы. Однако гарантии для этого **не** существует. Поле донезависимо от IP-адреса не принимает никаких прямых зависимостей.

### <a name="does-azure-front-door-support-static-or-dedicated-ips"></a>Поддерживает ли Передняя дверца Azure статические или выделенные IP-адреса?

Нет, в настоящее время первая дверца Azure не поддерживает статические или выделенные IP-адреса многоадресной рассылки. 

### <a name="does-azure-front-door-support-x-forwarded-for-headers"></a>Поддержка передней дверцы Azure x-forwardd-for Headers?

Да, передняя дверца Azure поддерживает заголовки X-forwardd-for, X-Forwarded-Host и X-Forwarded-названия. Для перенаправления по оси X: Если заголовок уже существует, то передняя дверца добавляет к нему IP-адрес сокета клиента. В противном случае он добавляет заголовок с IP-адресом сокета клиента в качестве значения. Для узлов, пересылаемых по оси X и пересылаемых по оси x, значение переопределяется.  

### <a name="how-long-does-it-take-to-deploy-an-azure-front-door-does-my-front-door-still-work-when-being-updated"></a>Сколько времени займет развертывание передней дверцы Azure? Все еще работает ли моя Передняя дверца при обновлении?

Для глобального развертывания новый процесс создания передней дверцы или обновления существующей передней дверцы занимает около 3 – 5 минут. Это означает, что в течение 3 – 5 минут конфигурация передней дверцы будет развернута на всех наших POP глобально.

Примечание. для использования настраиваемых обновлений TLS/SSL необходимо установить глобально 30 минут.

Любые обновления маршрутов или серверных пулов работают беспрепятственно, что приведет к нулевому простою (если новая конфигурация верна). Обновления сертификатов не приведут к сбою, если только вы не перейдете с "внешняя дверца Azure" на "использовать собственный сертификат" или наоборот.


## <a name="configuration"></a>Конфигурация

### <a name="can-azure-front-door-load-balance-or-route-traffic-within-a-virtual-network"></a>Может ли балансировка нагрузки для передней дверцы Azure или маршрутизация трафика в виртуальной сети?

Для маршрутизации трафика в переднюю дверцу Azure (АФД) требуется общедоступный IP-адрес или общедоступное DNS-имя. Передняя дверца Azure не может напрямую маршрутизироваться к ресурсам в виртуальной сети. Для решения этой проблемы можно использовать шлюз приложений или Azure Load Balancer с общедоступным IP-адресом.

### <a name="what-are-the-various-timeouts-and-limits-for-azure-front-door"></a>Каковы различные времена ожидания и ограничения для передней дверцы Azure?

Ознакомьтесь с задокументированными [временами ожидания и ограничениями для передней дверцы Azure](../../azure-resource-manager/management/azure-subscription-service-limits.md#azure-front-door-service-limits).

### <a name="how-long-does-it-take-for-a-rule-to-take-effect-after-being-added-to-the-front-door-rules-engine"></a>Сколько времени займет действие правила после добавления в обработчик правил передней дверцы?

Для завершения обновления Конфигурация обработчика правил занимает около 10 – 15 минут. Вы можете дождаться, когда правило вступит в силу сразу после завершения обновления. 

### <a name="can-i-configure-azure-cdn-behind-my-front-door-profile-or-front-door-behind-my-azure-cdn"></a>Можно ли настроить Azure CDN за профилем передней дверцы или с передней дверцей на моем Azure CDN?

Невозможно настроить переднюю дверцу Azure и Azure CDN, так как обе службы используют одни и те же сайты Azure, когда отвечают на запросы. 

## <a name="performance"></a>Производительность

### <a name="how-does-azure-front-door-support-high-availability-and-scalability"></a>Как передняя дверца Azure поддерживает высокий уровень доступности и масштабируемость?

Передняя дверца Azure — это глобально распределенная многоклиентская платформа с огромным объемом ресурсов, необходимых для обеспечения масштабируемости вашего приложения. С самого края глобальной сети корпорации Майкрософт Передняя дверца предоставляет возможность глобальной балансировки нагрузки, позволяющую отработку отказа всего приложения или даже отдельных микрослужб в регионах или в разных облаках.

## <a name="tls-configuration"></a>Конфигурация протокола TLS

### <a name="what-tls-versions-are-supported-by-azure-front-door"></a>Какие версии TLS поддерживаются в передней дверце Azure?

Все профили передней дверцы, созданные после сентября 2019, используют TLS 1,2 как минимум по умолчанию.

Передняя дверь поддерживает версии TLS 1,0, 1,1 и 1,2. TLS 1,3 пока не поддерживается.

### <a name="what-certificates-are-supported-on-azure-front-door"></a>Какие сертификаты поддерживаются в передней дверце Azure?

Чтобы включить протокол HTTPS в пользовательском домене передней дверцы, можно выбрать сертификат, который будет управляться внешней дверцей Azure, или использовать собственный сертификат.
Управляемый параметр Front дверь подготавливает стандартный сертификат TLS/SSL через DigiCert и хранится в Key Vaultах на передней дверце. Если вы решили использовать собственный сертификат, то можете подключить сертификат из поддерживаемого центра сертификации, который может быть стандартным протоколом TLS, сертификатом расширенной проверки или даже сертификатом с подстановочными знаками. Самозаверяющие сертификаты не поддерживаются.

### <a name="does-front-door-support-autorotation-of-certificates"></a>Поддерживает ли интерфейс Front дверь Автоповорот сертификатов?

Для параметра "управляемый сертификат для передней дверцы" сертификаты переворачиваются с помощью передней дверцы. Если вы используете управляемый сертификат на основе передней дверцы и видите, что срок действия сертификата составляет менее 60 дней, отправьте запрос в службу поддержки.

Для собственного пользовательского сертификата TLS/SSL не поддерживается Автоповорот. Аналогично тому, как вы впервые настраиваете для данного личного домена, вам потребуется указать в Key Vault начальную дверь на правильную версию сертификата. Убедитесь, что субъект-служба для передней дверцы все еще имеет доступ к Key Vault. Эта обновленная операция развертывания сертификата в начале дверцы не приводит к тому, что в рабочем окружении не будет указано имя субъекта или SAN для сертификата.

### <a name="what-are-the-current-cipher-suites-supported-by-azure-front-door"></a>Каковы текущие комплекты шифров, поддерживаемые внешней дверцей Azure?

Для TLS 1.2 поддерживаются следующие комплекты шифров: 

- TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
- TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
- TLS_DHE_RSA_WITH_AES_256_GCM_SHA384
- TLS_DHE_RSA_WITH_AES_128_GCM_SHA256

Использование пользовательских доменов с включенным протоколом TLS 1.0/1.1 поддерживаются следующие комплекты шифров:

- TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
- TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
- TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
- TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
- TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
- TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
- TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
- TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA
- TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
- TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA
- TLS_RSA_WITH_AES_256_GCM_SHA384
- TLS_RSA_WITH_AES_128_GCM_SHA256
- TLS_RSA_WITH_AES_256_CBC_SHA256
- TLS_RSA_WITH_AES_128_CBC_SHA256
- TLS_RSA_WITH_AES_256_CBC_SHA
- TLS_RSA_WITH_AES_128_CBC_SHA
- TLS_DHE_RSA_WITH_AES_128_GCM_SHA256
- TLS_DHE_RSA_WITH_AES_256_GCM_SHA384

### <a name="can-i-configure-tls-policy-to-control-tls-protocol-versions"></a>Можно ли настроить политику TLS для управления версиями протокола TLS?

Вы можете настроить минимальную версию TLS в настройках интерфейса пользователя Azure в пользовательском домене с помощью портал Azure или [Azure REST API](/rest/api/frontdoorservice/frontdoor/frontdoors/createorupdate#minimumtlsversion). В настоящее время можно выбрать от 1,0 до 1,2.

### <a name="can-i-configure-front-door-to-only-support-specific-cipher-suites"></a>Можно ли настроить переднюю дверцу для поддержки только определенных комплектов шифров?

Нет, Настройка передней дверцы для определенных комплектов шифров не поддерживается. Вы можете получить собственный пользовательский сертификат TLS/SSL из центра сертификации (например, VeriSign, Entrust или DigiCert). Затем для сертификата помечаются определенные комплекты шифров при его создании. 

### <a name="does-front-door-support-ocsp-stapling"></a>Поддерживает ли Front двери прикрепление OCSP?

Да, Ассоциация OCSP поддерживается по умолчанию в передней дверце, а настройка не требуется.

### <a name="does-azure-front-door-also-support-re-encryption-of-traffic-to-the-backend"></a>Поддерживает ли Передняя дверца Azure повторное шифрование трафика для серверной части?

Да, передняя дверца Azure поддерживает разгрузку TLS/SSL и сквозной протокол TLS, который повторно шифрует трафик на серверную часть. Так как подключения к серверной части выполняются по общедоступному IP-адресу, рекомендуется настроить переднюю дверцу для использования протокола HTTPS по протоколу переадресации.

### <a name="does-front-door-support-self-signed-certificates-on-the-backend-for-https-connection"></a>Поддерживает ли Передняя дверца самозаверяющие сертификаты на серверной части для HTTPS-подключения?

Нет, самозаверяющие сертификаты не поддерживаются на передней дверце, а ограничение применяется к обоим:

* Серверная **служба: вы** не можете использовать самозаверяющие сертификаты при пересылке трафика в качестве проверки работоспособности HTTPS или HTTPS или при заполнении кэша для правил маршрутизации с включенным кэшированием.
* **Интерфейсный** сервер. Вы не можете использовать самозаверяющие сертификаты при использовании собственного ПОЛЬЗОВАТЕЛЬСКОГО сертификата TLS/SSL для включения протокола HTTPS в пользовательском домене.

### <a name="why-is-https-traffic-to-my-backend-failing"></a>Почему происходит сбой HTTPS-трафика на серверной части?

Для успешного подключения по протоколу HTTPS к серверной части при проверке работоспособности или пересылке запросов может возникнуть две причины, по которым может произойти сбой трафика HTTPS:

* **Несоответствие имени субъекта сертификата**: для подключений по протоколу HTTPS, первая дверца ожидает, что серверная часть представляет сертификат из допустимого ЦС с именами субъектов, соответствующими имени узла серверной части. Например, если для серверного узла задано значение `myapp-centralus.contosonews.net` и сертификат, представленный серверной частью во время подтверждения TLS, не имеет `myapp-centralus.contosonews.net` или `*myapp-centralus*.contosonews.net` находится в имени субъекта. Затем передняя дверца отклоняет подключение и приведет к ошибке. 
    * **Решение**. не рекомендуется с точки зрения соответствия, но можно обойти эту ошибку, отключив проверку имени субъекта сертификата для своей передней дверцы. Этот параметр можно найти в разделе Параметры в портал Azure и в разделе Баккендпулссеттингс в API.
* **Внутренний сертификат размещения из недопустимого центра сертификации**: в серверной части с передней дверцей можно использовать только сертификаты из [допустимых центров сертификации](troubleshoot-allowed-certificate-authority.md) . Сертификаты из внутренних центров сертификации или самозаверяющие сертификаты запрещены.

### <a name="can-i-use-clientmutual-authentication-with-azure-front-door"></a>Можно ли использовать клиентскую или взаимную проверку подлинности с помощью передней дверцы Azure?

Нет. Хотя Передняя дверца Azure поддерживает TLS 1,2, в которой в [RFC 5246](https://tools.ietf.org/html/rfc5246)появилась клиентская или взаимная проверка подлинности, в настоящее время Передняя дверца Azure не поддерживает клиентскую или взаимную проверку подлинности

## <a name="diagnostics-and-logging"></a>Диагностика и ведение журнала

### <a name="what-types-of-metrics-and-logs-are-available-with-azure-front-door"></a>Какие типы метрик и журналов доступны в передней дверце Azure?

Сведения о журналах и других возможностях диагностики см. в статье мониторинг метрик и журналов для передней дверцы.

### <a name="what-is-the-retention-policy-on-the-diagnostics-logs"></a>Что такое политика хранения журналов диагностики?

Журналы диагностики находятся в учетных записях хранения клиентов, и клиенты могут задать политику хранения в зависимости от своих предпочтений. Журналы диагностики также можно отправить в концентратор событий или журналы Azure Monitor. Дополнительные сведения см. в статье [ведение журнала для передней дверцы Azure](how-to-logs.md).

### <a name="how-do-i-get-audit-logs-for-azure-front-door"></a>Разделы справки получить журналы аудита для передней дверцы Azure?

Журналы аудита доступны для передней дверцы Azure. На портале на странице меню передней дверцы выберите **Журнал действий** , чтобы получить доступ к журналу аудита. 

### <a name="can-i-set-alerts-with-azure-front-door"></a>Можно ли настроить оповещения с помощью передней дверцы Azure?

Да, передняя дверца Azure поддерживает оповещения. Оповещения настраиваются на основе метрик. 

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как [создать переднюю дверь уровня "Стандартный" или "Премиум](create-front-door-portal.md)".
