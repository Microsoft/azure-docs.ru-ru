---
title: Устранение неполадок конфигурации "Стандартный" и "Премиум" для передней дверцы Azure
description: В этом руководстве вы узнаете, как устранять некоторые распространенные проблемы, которые могут возникнуть при работе с экземпляром уровня "Стандартный" или "Премиум" для передней дверцы Azure.
services: frontdoor
author: duongau
ms.service: frontdoor
ms.topic: how-to
ms.date: 02/18/2021
ms.author: qixwang
ms.openlocfilehash: 4690a513494d794377ee0c2e8cfb101e8fd66a0f
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "101100203"
---
# <a name="troubleshooting-common-routing-problems-with-azure-front-door-standardpremium"></a>Устранение распространенных проблем маршрутизации с помощью передней дверцы Azure уровня "Стандартный" или "Премиум"

В этой статье описывается, как устранять распространенные проблемы маршрутизации, которые могут возникнуть при настройке передней дверцы Azure.

## <a name="503-response-from-azure-front-door-after-a-few-seconds"></a>503. ответ от передней дверцы Azure через несколько секунд

### <a name="symptom"></a>Симптом

* Обычные запросы, отправляемые на серверную часть, не проходят через переднюю дверцу Azure. При переходе через переднюю дверцу Azure выводятся сообщения об ошибках 503.
* Сбой передней дверцы Azure обычно отображается через 30 секунд.

### <a name="cause"></a>Причина

Причиной этой проблемы может быть одно из двух действий:
 
* Ваш источник занимает больше времени, чем настроенное время ожидания (по умолчанию 30 секунд), чтобы получить запрос от передней дверцы Azure.
* Время, необходимое для отправки ответа на запрос от передней дверцы Azure, занимает больше времени, чем время ожидания. 

### <a name="troubleshooting-steps"></a>Действия по устранению неполадок

* Отправьте запрос непосредственно в серверную часть (без перехода на переднюю дверцу Azure). Узнайте, как долго будет реагировать Серверная часть.
* Отправьте запрос через переднюю дверцу Azure и посмотрите, получаете ли вы ответы 503. В противном случае проблема может не быть проблемой времени ожидания. Обратитесь в службу поддержки.
* При переходе на переднюю дверцу Azure в коде ответа ошибки 503 настройте `sendReceiveTimeout` поле для передней дверцы Azure. Время ожидания по умолчанию можно продлить до 4 минут (240 секунд). Параметр находится в разделе `Endpoint Setting` и называется `Origin response timeout` . 

## <a name="requests-sent-to-the-custom-domain-return-a-400-status-code"></a>Запросы, отправленные в пользовательский домен, возвращают код состояния 400

### <a name="symptom"></a>Симптом

* Вы создали экземпляр передней дверцы Azure, но запрос к домену или ведущему узлу возвращает код состояния HTTP 400.
* Вы создали сопоставление DNS для пользовательского домена с настроенным интерфейсным узлом. Однако при отправке запроса в имя узла пользовательского домена возвращается код состояния HTTP 400. Он не направляется в настроенную серверную часть.

### <a name="cause"></a>Причина

Проблема возникает, если вы не настроили правило маршрутизации для пользовательского домена, добавленного в качестве внешнего узла. Для этого внешнего узла необходимо явно добавить правило маршрутизации. Это справедливо даже в том случае, если правило маршрутизации уже настроено для внешнего узла в поддомена передней дверцы Azure (*. azurefd.net).

### <a name="troubleshooting-steps"></a>Действия по устранению неполадок

Добавьте правило маршрутизации для пользовательского домена, чтобы направить трафик в выбранную группу источника.

## <a name="azure-front-door-doesnt-redirect-http-to-https"></a>Передняя дверца Azure не перенаправляет HTTP на HTTPS

### <a name="symptom"></a>Симптом

Передняя дверца Azure имеет правило маршрутизации, которое перенаправляет HTTP-HTTPS, но доступ к домену по-прежнему поддерживает протокол HTTP в качестве протокола.

### <a name="cause"></a>Причина

Это может произойти, если вы неправильно настроили правила маршрутизации для передней дверцы Azure. По сути, текущая конфигурация не зависит и может иметь конфликтующие правила.

### <a name="troubleshooting-steps"></a>Действия по устранению неполадок


## <a name="request-to-the-frontend-host-name-returns-a-411-status-code"></a>Запрос имени внешнего узла возвращает код состояния 411.

### <a name="symptom"></a>Симптом

Вы создали экземпляр уровня "Стандартный" или "Премиум" для передней дверцы Azure и настроили внешний хост-узел, группу-источник с по крайней мере одним источником в ней и правило маршрутизации, соединяющее интерфейсный узел с группой-источником. Содержимое не будет доступно, когда запрос переходит на настроенный интерфейсный узел, так как возвращается код состояния HTTP 411.

Ответы на эти запросы могут также содержать HTML-страницу ошибок в тексте ответа, который содержит пояснительную инструкцию. Например, `HTTP Error 411. The request must be chunked or have a content length`.

### <a name="cause"></a>Причина

Существует несколько возможных причин этого симптома. Общая причина заключается в том, что HTTP-запрос не полностью совместим с RFC. 

Примером несоответствия является запрос, который `POST` отправляется без `Content-Length` заголовка или (например `Transfer-Encoding` , с помощью `curl -X POST https://example-front-door.domain.com` ). Этот запрос не соответствует требованиям, заданным в [RFC 7230](https://tools.ietf.org/html/rfc7230#section-3.3.2). Передняя дверца Azure заблокировала его с ответом HTTP 411.

Это поведение отличается от функции брандмауэра веб-приложения (WAF) в передней дверце Azure. В настоящее время отключить это поведение невозможно. Все HTTP-запросы должны соответствовать требованиям, даже если функция WAF не используется.

### <a name="troubleshooting-steps"></a>Действия по устранению неполадок

- Убедитесь, что ваши запросы соответствуют требованиям, заданным в соответствующих документах RFC.

- Запишите текст сообщения в формате HTML, возвращаемый в ответ на запрос. Текст сообщения часто объясняет, *как* запрос не соответствует требованиям.

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как [создать переднюю дверь уровня "Стандартный" или "Премиум](create-front-door-portal.md)".
