---
title: Перенаправление URL-адреса и перезапись URL-адреса с помощью передней дверцы Azure Standard/Premium (Предварительная версия)
description: Эта статья поможет вам понять, как передняя дверца Azure поддерживает перенаправление URL-адресов и переписывание URL-адресов с помощью набора правил для передней дверцы Azure.
services: frontdoor
author: duongau
ms.service: frontdoor
ms.topic: article
ms.date: 02/18/2021
ms.author: yuajia
ms.openlocfilehash: 382a4c040c7a519462ee3e35119b9471031e0724
ms.sourcegitcommit: 97c48e630ec22edc12a0f8e4e592d1676323d7b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2021
ms.locfileid: "101100004"
---
# <a name="url-redirect-and-url-rewrite-with-azure-front-door-standardpremium-preview"></a>Перенаправление URL-адреса и перезапись URL-адреса с помощью передней дверцы Azure Standard/Premium (Предварительная версия)

> [!Note]
> Эта документация предназначена для передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия). Ищете информацию о передней дверце Azure? Просмотреть [здесь](../front-door-overview.md).

Эта статья поможет вам разобраться с тем, как передняя дверца Azure поддерживает перенаправление URL-адресов и переписывание URL-адресов, используемое в наборе правил.

> [!IMPORTANT]
> Передняя дверца Azure Standard/Premium (Предварительная версия) в настоящее время доступна в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="url-redirect"></a>Перенаправление URL-адресов

Передняя дверца Azure может перенаправлять трафик на каждом из следующих уровней: протокол, имя узла, путь, строка запроса и фрагмент. Эти возможности можно настроить для отдельной микрослужбы, так как перенаправление основано на пути. Перенаправление URL-адреса позволяет упростить настройку приложений, оптимизируя использование ресурсов, а также поддерживает новые сценарии перенаправления, включая глобальное перенаправление на основе пути.

Перенаправление URL-адреса можно настроить с помощью набора правил.

:::image type="content" source="../media/concept-url-redirect-and-rewrite/front-door-url-redirect.png" alt-text="Снимок экрана создания перенаправления URL-адреса с набором правил." lightbox="../media/concept-url-redirect-and-rewrite/front-door-url-redirect-expanded.png":::

### <a name="redirection-types"></a>Типы перенаправлений
Тип перенаправления задает код состояния ответа для клиентов, чтобы понять назначение перенаправления. Поддерживаются следующие типы перенаправления:

* **301 (перемещен навсегда)**: указывает, что целевому ресурсу был назначен новый постоянный URI. Все будущие ссылки на этот ресурс будут использовать один из заключенных в него URI. Используйте код состояния 301 для перенаправления HTTP в HTTPS.
* **302 (найдено)**: указывает, что целевой ресурс временно находится под другим URI. Так как перенаправление может измениться в некоторых случаях, клиент должен продолжать использовать действующий URI запроса для будущих запросов.
* **307 (временное перенаправление)**: указывает, что целевой ресурс временно находится под другим URI. Агент пользователя не должен изменять метод запроса, если он выполняет автоматическое перенаправление на этот URI. Так как перенаправление может измениться со временем, клиент должен продолжать использовать исходный действующий URI запроса для будущих запросов.
* **308 (постоянное перенаправление)**: указывает, что целевому ресурсу был назначен новый постоянный URI. Все будущие ссылки на этот ресурс должны использовать один из заключенных в него URI.

### <a name="redirection-protocol"></a>Протокол перенаправления
Можно задать протокол, который будет использоваться для перенаправления. Наиболее распространенными вариантами использования функции перенаправления является установка перенаправления HTTP на HTTPS.

* **Только HTTPS**. Установите протокол только для протокола HTTPS, если хотите перенаправить трафик с HTTP на HTTPS. Передняя дверца Azure рекомендует всегда устанавливать перенаправление только по протоколу HTTPS.
* **Только HTTP**: перенаправляет входящий запрос на HTTP. Используйте это значение только в том случае, если необходимо обеспечить незашифрованный трафик HTTP.
* **Запрос Match**. Этот параметр сохраняет протокол, используемый входящим запросом. Таким образом, HTTP-запрос остается в формате HTTP, а HTTPS-запрос — после перенаправления HTTPS.

### <a name="destination-host"></a>Узел назначения
В рамках настройки маршрутизации перенаправления можно также изменить имя узла или домен для запроса на перенаправление. Это поле можно задать, чтобы изменить имя узла в URL-адресе для перенаправления или иным образом сохранить имя узла из входящего запроса. Таким образом, с помощью этого поля можно перенаправить все запросы, отправленные в `https://www.contoso.com/*` `https://www.fabrikam.com/*` .

### <a name="destination-path"></a>Конечный путь
В случаях, когда необходимо заменить сегмент пути URL-адреса в рамках перенаправления, можно задать для этого поля новое значение пути. В противном случае можно сохранить значение пути как часть перенаправления. Таким образом, с помощью этого поля можно перенаправить все запросы, отправленные в `https://www.contoso.com/\*`  `https://www.contoso.com/redirected-site` .

### <a name="query-string-parameters"></a>Параметры строки запроса
Можно также заменить параметры строки запроса в URL-адресе перенаправления. Чтобы заменить любую существующую строку запроса из URL-адреса входящего запроса, установите для этого поля значение "заменить", а затем задайте нужное. В противном случае можно сохранить исходный набор строк запроса, задав для поля значение "preserve". Например, с помощью этого поля можно перенаправить весь трафик, отправленный `https://www.contoso.com/foo/bar` в `https://www.contoso.com/foo/bar?&utm_referrer=https%3A%2F%2Fwww.bing.com%2F` . 

### <a name="destination-fragment"></a>Фрагмент места назначения
Фрагмент назначения — это часть URL-адреса после "#", которая используется браузером для указания определенного раздела веб-страницы. Это поле можно задать, чтобы добавить фрагмент в URL-адрес перенаправления.

## <a name="url-rewrite"></a>Переопределение URL-адресов

Передняя дверца Azure поддерживает перезапись URL-адресов, чтобы перезаписать путь к вашему источнику запроса, который является коротким. Переопределение URL-адресов позволяет добавлять условия, чтобы обеспечить перезапись URL-адреса или указанных заголовков только при выполнении определенных условий. Эти условия основываются на сведениях о запросе и ответе.

С помощью этой функции можно перенаправить пользователей на разные источники в зависимости от ситуации, типа устройства и требуемого типа файлов.

Перенаправление URL-адреса можно настроить с помощью набора правил.

:::image type="content" source="../media/concept-url-redirect-and-rewrite/front-door-url-rewrite.png" alt-text="Снимок экрана создания перезаписи URL-адреса с набором правил." lightbox="../media/concept-url-redirect-and-rewrite/front-door-url-rewrite-expanded.png":::

### <a name="source-pattern"></a>Исходный шаблон

Исходный шаблон — это URL-путь в исходном запросе для замены. В настоящее время исходный шаблон использует сопоставление на основе префикса. Чтобы сопоставить все URL-пути, используйте косую черту (/) в качестве исходного значения шаблона.

### <a name="destination"></a>Назначение

Можно определить целевой путь, который будет использоваться в перезаписи. Целевой путь перезаписывает исходный шаблон.

### <a name="preserve-unmatched-path"></a>Сохранить непарный путь

Сохранить непарный путь позволяет добавить оставшийся путь после исходного шаблона к новому пути.

Например, если установить для параметра **сохранить непарный путь значение Да**.
* Если входящий запрос — `www.contoso.com/sub/1.jpg` , исходный шаблон получает значение, параметру `/` назначения присваивается значение `/foo/` , а содержимое из `/foo/sub/1` . jpg извлекается из источника.

* Если входящий запрос — `www.contoso.com/sub/image/1.jpg` , исходный шаблон получает значение, а `/sub/` целевой параметр Get имеет значение `/foo/` , содержимое которого поступает из `/foo/image/1.jpg` источника.

Например, если установить для параметра **сохранить непарный путь значение нет**.
* Если входящий запрос — `www.contoso.com/sub/image/1.jpg` , исходный шаблон получает значение, а `/sub/` целевой параметр Get имеет значение `/foo/2.jpg` , содержимое всегда будет обрабатываться из источника независимо от того, `/foo/2.jpg` какие пути следуют `wwww.contoso.com/sub/` .

## <a name="next-steps"></a>Следующие шаги

* Дополнительные сведения о [наборе правил Azure "Стандартный" или "Премиум" для передней дверцы](concept-rule-set.md).
