---
title: 'Передняя дверца Azure: набор правил'
description: В этой статье приводятся общие сведения о функции набора правил для передней дверцы Azure уровня "Стандартный" или "Премиум".
services: front-door
author: duongau
ms.service: frontdoor
ms.topic: conceptual
ms.date: 02/18/2021
ms.author: yuajia
ms.openlocfilehash: 8e6ceebc9e92dabe66baeb9aeff0ae9692e2bdad
ms.sourcegitcommit: 97c48e630ec22edc12a0f8e4e592d1676323d7b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2021
ms.locfileid: "101099973"
---
# <a name="what-is-a-rule-set-for-azure-front-door-standardpremium-preview"></a>Что такое набор правил для передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия)?

> [!Note]
> Эта документация предназначена для передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия). Ищете информацию о передней дверце Azure? Просмотреть [здесь](../front-door-overview.md).

Набор правил — это настраиваемая подсистема правил, которая группирует сочетания правил в один набор, который можно связать с несколькими маршрутами. Набор правил позволяет настроить обработку запросов на границе и то, как клиентская дверца Azure обрабатывает эти запросы.

> [!IMPORTANT]
> Передняя дверца Azure Standard/Premium (Предварительная версия) в настоящее время доступна в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="common-supported-scenarios"></a>Распространенные поддерживаемые сценарии

* Реализация заголовков безопасности для предотвращения уязвимостей браузеров, таких как HTTP-протоколы HTTPS-Transport-Security (HSTS), X-XSS-Protection, Content-Security-Policy, X-FRAMESET-Options и Access-Control-Allow-Origin, для сценариев общего доступа к ресурсам в разных источниках (CORS). Атрибуты для системы безопасности можно также определять с помощью файлов cookie.

* Направлять запросы к мобильным или настольным версиям приложения на основе типа клиентского устройства.

* Использование возможностей перенаправления для возврата 301, 302, 307 и 308 перенаправляет их в новые имена узлов, пути, строки запроса или протоколы.

* Динамическое изменение конфигурации кэширования маршрута на основе входящих запросов.

* Перепишите путь URL-адреса запроса и перенаправляет запрос в соответствующий источник в настроенной группе источника.

* Добавьте, измените или удалите заголовок запроса или ответа, чтобы скрыть конфиденциальные сведения или записать важные сведения через заголовки.

* Поддержка переменных сервера для динамического изменения заголовков запросов и ответов, а также путей переопределения URL-адресов и строк запросов, например при загрузке новой страницы или при публикации формы. В настоящее время переменная Server поддерживается только для **[действий набора правил](concept-rule-set-actions.md)** .

## <a name="architecture"></a>Architecture

Набор правил обрабатывает запросы на границе. Когда запрос поступает в конечную точку передней дверцы Azure уровня "Стандартный" или "Премиум", сначала выполняется WAF, а затем параметры, настроенные в параметре Route. Эти параметры включают набор правил, связанный с маршрутом. Наборы правил обрабатываются сверху вниз в маршруте. То же относится и к правилам в наборе правил. Чтобы выполнялись все действия в каждом правиле, должны быть удовлетворены все условия соответствия в правиле. Если запрос не соответствует ни одному из условий в конфигурации набора правил, то будут выполнены только конфигурации в маршруте.

Если флажок **отключить вычисление оставшихся правил** установлен, все оставшиеся наборы правил, связанные с маршрутом, не выполняются.  

### <a name="example"></a>Пример

На следующей схеме сначала выполняются политики WAF. Набор правил настроен для добавления заголовка ответа. Затем заголовок изменяет максимальный возраст элемента управления кэшем, если выполняется условие соответствия.

:::image type="content" source="../media/concept-rule-set/front-door-rule-set-architecture-1.png" alt-text="Схема, показывающая архитектуру набора правил." lightbox="../media/concept-rule-set/front-door-rule-set-architecture-1-expanded.png":::

## <a name="terminology"></a>Терминология

С помощью набора правил "Передняя дверь" Azure можно создать сочетание конфигурации набора правил, состоящее из набора правил. Ниже приведены некоторые полезные терминов, которые вы будете использовать для настройки набора правил.

Дополнительные сведения о квотах см. в разделе [Подписка Azure и ограничения службы, квоты и ограничения](../../azure-resource-manager/management/azure-subscription-service-limits.md).

* *Набор правил*: набор правил, связанных с одним или несколькими [маршрутами](concept-route.md). Каждая конфигурация ограничена 25 правилами. Вы можете создать до 10 конфигураций.

* *Правило набора правил*: правило, состоящее из до 10 условий соответствия и 5 действий. Правила являются локальными для набора правил и не могут быть экспортированы для использования в наборах правил. Пользователи могут создать одно и то же правило в нескольких наборах правил.

* *Условие соответствия* Существует много условий соответствия, которые можно использовать для анализа входящих запросов. Правило может содержать до 10 условий соответствия. Условия соответствия оцениваются с помощью оператора **AND**. *Регулярные выражения поддерживаются в условиях*. Полный список условий соответствия можно найти в [условии набора правил](concept-rule-set-match-conditions.md).

* *Действие*: действия определяют, как АФД обрабатывает входящие запросы на основе условий сопоставления. Можно изменить поведение кэширования, изменить заголовки запросов и заголовки ответа, выполнить перезапись URL-адреса и перенаправление URL-адресов. *Переменные сервера поддерживаются в действии*. Правило может содержать до 10 условий соответствия. Полный список действий можно найти в [наборе действий набора правил](concept-rule-set-actions.md).

## <a name="next-steps"></a>Следующие шаги

* Узнайте, как [создать переднюю дверь уровня "Стандартный" или "Премиум](create-front-door-portal.md)".
* Узнайте, как настроить первый [набор правил](how-to-configure-rule-set.md).
 
