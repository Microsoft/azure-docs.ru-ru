---
title: Повышение производительности за счет сжатия файлов в интерфейсе передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия)
description: Узнайте, как улучшить скорость передачи файлов и повысить производительность загрузки страниц за счет сжатия файлов в передней дверце Azure.
services: front-door
author: duongau
ms.service: frontdoor
ms.topic: article
ms.date: 02/18/2021
ms.author: yuajia
ms.openlocfilehash: 4b526d82465862b1c0d27aed6443c6d7199bfb5b
ms.sourcegitcommit: 97c48e630ec22edc12a0f8e4e592d1676323d7b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2021
ms.locfileid: "101099674"
---
# <a name="improve-performance-by-compressing-files-in-azure-front-door-standardpremium-preview"></a>Повышение производительности за счет сжатия файлов в интерфейсе передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия)

> [!Note]
> Эта документация предназначена для передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия). Ищете информацию о передней дверце Azure? Просмотреть [здесь](../front-door-overview.md).

Сжатие файлов — это эффективный способ повысить скорость передачи файлов и повысить производительность загрузки страниц. Сжатие сокращает размер файла перед его отправкой сервером. Сжатие файлов позволяет сократить затраты на пропускную способность и повысить эффективность работы пользователей.

> [!IMPORTANT]
> Передняя дверца Azure Standard/Premium (Предварительная версия) в настоящее время доступна в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).
Сжатие файлов можно активировать двумя способами.

- Включение сжатия на сервере исходного сервера. Передняя дверца Azure передает сжатые файлы и доставляет их клиентам, которые их запрашивают.
- Включение сжатия непосредственно на серверах POP в передней дверце Azure (*Сжатие на лету*). В этом случае Передняя дверца Azure сжимает файлы и отправляет их конечным пользователям.

> [!IMPORTANT]
> Изменение конфигурации для передней дверцы Azure занимает до 10 минут для распространения по всей сети. Если вы настраиваете сжатие в первый раз для конечной точки CDN, рассмотрите возможность ожидания 1-2 часов перед устранением неполадок, чтобы убедиться, что параметры сжатия распространяются на все точки подключения.

## <a name="enabling-compression"></a>Включение сжатия

> [!Note]
> В передней дверце Azure сжатие является частью **включения кэширования** в маршруте. При **включении кэширования** можно воспользоваться преимуществами сжатия в передней дверце Azure.

Сжатие можно включить следующими способами.
* Во время быстрого создания — при включении кэширования можно включить сжатие.
* Во время пользовательского создания включите кэширование и сжатие при добавлении маршрута. 
* В маршруте диспетчера конечных точек.
* На странице Оптимизация.

### <a name="enable-compression-in-endpoint-manager"></a>Включить сжатие в диспетчере конечных точек

1. На странице профиля "Стандартный" или "Премиум" на передней дверце Azure перейдите к **диспетчеру конечных точек** и выберите конечную точку, для которой необходимо включить сжатие.

1. Выберите **изменить конечную точку**, а затем выберите **маршрут** , для которого необходимо включить сжатие. 

   :::image type="content" source="../media/how-to-compression/front-door-compression-endpoint-manager-1.png" alt-text="Снимок экрана целевой страницы диспетчера конечных точек." lightbox="../media/how-to-compression/front-door-compression-endpoint-manager-1-expanded.png":::   

1. Убедитесь, что флажок **включить кэширование** установлен, а затем установите флажок **включить сжатие**.

   :::image type="content" source="../media/how-to-compression/front-door-compression-endpoint-manager-2.png" alt-text="Включите сжатие в диспетчере конечных точек.":::   

1. Выберите **Обновить** , чтобы сохранить конфигурацию.

### <a name="enable-compression-in-optimization"></a>Включить сжатие при оптимизации

1. На странице профиля "Стандартный" или "Премиум" на передней дверце Azure перейдите в раздел " **Оптимизация** " в разделе "Параметры". Разверните конечную точку, чтобы просмотреть список маршрутов. 

1. Выберите три точки рядом с **маршрутом** , для которого *отключено* сжатие. Затем выберите **настроить маршрут**.

   :::image type="content" source="../media/how-to-compression/front-door-compression-optimization-1.png" alt-text="Экран включения сжатия на странице &quot;оптимизация&quot;." lightbox="../media/how-to-compression/front-door-compression-optimization-1-expanded.png"::: 

1. Убедитесь, что флажок **включить кэширование** установлен, а затем установите флажок **включить сжатие**.

     :::image type="content" source="../media/how-to-compression/front-door-compression-endpoint-manager-2.png" alt-text="Снимок экрана: Включение сжатия в диспетчере конечных точек."::: 

1. Нажмите кнопку **Обновить**.

## <a name="modify-compression-content-type"></a>Изменение типа содержимого сжатия

Можно изменить список по умолчанию для типов MIME на странице Оптимизация.

1. На странице профиля "Стандартный" или "Премиум" на передней дверце Azure перейдите в раздел " **Оптимизация** " в разделе "Параметры". Затем выберите **маршрут** с *включенным* сжатием.

1. Выберите три точки рядом с **маршрутом** , для которого *включено* сжатие. Затем выберите **представление типы сжатых файлов**.

   :::image type="content" source="../media/how-to-compression/front-door-compression-edit-content-type.png" alt-text="Снимок экрана со страницей &quot;оптимизация&quot;." lightbox="../media/how-to-compression/front-door-compression-edit-content-type-expanded.png"::: 

1. Удалите форматы по умолчанию или выберите **Добавить** , чтобы добавить новые типы содержимого.

   :::image type="content" source="../media/how-to-compression/front-door-compression-edit-content-type-2.png" alt-text="Снимок экрана: страница &quot;Настройка сжатия файла&quot;."::: 

1. Нажмите кнопку **сохранить**, чтобы обновить настройку сжатия.

## <a name="disabling-compression"></a>Отключение сжатия

Сжатие можно отключить следующими способами.
* Отключение сжатия в маршруте диспетчера конечных точек.
* Отключить сжатие на странице оптимизации.

### <a name="disable-compression-in-endpoint-manager"></a>Отключение сжатия в диспетчере конечных точек

1. На странице профиля "Стандартный" или "Премиум" для передней дверцы Azure перейдите к **диспетчеру конечных точек** в разделе "Параметры". Выберите конечную точку, для которой требуется отключить сжатие.

1. Выберите **изменить конечную точку** , а затем выберите **маршрут** , для которого требуется отключить сжатие. Снимите флажок **включить сжатие** .

1. Выберите **Обновить** , чтобы сохранить конфигурацию.

### <a name="disable-compression-in-optimizations"></a>Отключить сжатие при оптимизации

1. На странице профиля "Стандартный" или "Премиум" на передней дверце Azure перейдите в раздел " **Оптимизация** " в разделе "Параметры". Затем выберите **маршрут** с *включенным* сжатием.

1. Выберите три точки рядом с **маршрутом** , для которого *включено* сжатие, а затем выберите *настроить маршрут*.

    :::image type="content" source="../media/how-to-compression/front-door-disable-compression-optimization.png" alt-text="Снимок экрана: отключить сжатие на странице оптимизации."::: 

1. Снимите флажок **включить сжатие** .

    :::image type="content" source="../media/how-to-compression/front-door-disable-compression-optimization-2.png" alt-text="Снимок экрана: страница &quot;обновление маршрута&quot; для отключения сжатия."::: 

1. Выберите **Обновить** , чтобы сохранить конфигурацию.

## <a name="compression-rules"></a>Правила сжатия

В передней дверце Azure сжимаются только подходящие файлы. Сжатие допускается для следующих файлов:
* Иметь тип MIME 
* Больше 1 КБ
* Должно быть меньше 8 МБ

Эти профили поддерживают следующие алгоритмы сжатия:
* gzip (GNU zip)
* brotli 

Если запрос поддерживает несколько типов сжатия, приоритет имеет сжатие brotli.

Если запрос ресурса указывает на сжатие GZIP, а запрос приводит к промаху в кэше, то передняя дверца Azure выполняет сжатие ресурса gzip непосредственно на сервере POP. После этого сжатый файл используется из кэша.

Если источник использует поблочное кодирование передачи (CTE) для отправки сжатых данных в точку подключения к передней дверце Azure, то размер ответа больше 8 МБ не поддерживается. 

## <a name="next-steps"></a>Следующие шаги

- Узнайте, как настроить первый [набор правил](how-to-configure-rule-set.md)
- Дополнительные сведения о [условиях соответствия наборов правил](concept-rule-set-match-conditions.md)
- Дополнительные сведения о [наборе правил для передней дверцы Azure](concept-rule-set.md)
