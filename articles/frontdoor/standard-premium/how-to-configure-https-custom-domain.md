---
title: Настройка протокола HTTPS для личного домена в конфигурации "Стандартный" или "Премиум" основной версии для передней дверцы Azure
description: В этой статье вы узнаете, как подключить личный домен к SKU "Стандартный" или "Премиум" для передней дверцы Azure.
services: frontdoor
author: duongau
ms.service: frontdoor
ms.topic: article
ms.workload: infrastructure-services
ms.date: 02/18/2021
ms.author: amsriva
ms.openlocfilehash: c2edf11939996156c2b589b0b7876ae1b01466e5
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101740823"
---
# <a name="configure-https-on-a-front-door-standardpremium-sku-preview-custom-domain-using-the-azure-portal"></a>Настройка протокола HTTPS для пользовательского домена уровня "Стандартный" или "Премиум" (Предварительная версия) на передней дверце с помощью портал Azure

> [!NOTE]
> Эта документация предназначена для передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия). Ищете информацию о передней дверце Azure? Просмотреть [здесь](../front-door-overview.md).

Передняя дверца Azure уровня "Стандартный" или "Премиум" обеспечивает надежную доставку TLS в приложения по умолчанию при добавлении пользовательского домена. Используя протокол HTTPS в личном домене, вы гарантируете, что конфиденциальные данные будут надежно доставляться с шифрованием TLS/SSL при отправке через Интернет. При подключении веб-браузера к веб-сайту по протоколу HTTPS он выполняет проверку сертификата безопасности веб-сайта и подтверждает, что он выдан правомочным центром сертификации. Этот процесс обеспечивает безопасность и защиту веб-приложений от атак.

Передняя дверца Azure Standard/Premium поддерживает управляемый сертификат Azure и управляемые клиентом сертификаты. По умолчанию Передняя дверца Azure автоматически включает протокол HTTPS для всех пользовательских доменов, использующих управляемые сертификаты Azure. Для получения управляемого сертификата Azure дополнительные действия не требуются. Сертификат создается в процессе проверки домена. Вы также можете использовать собственный сертификат, интегрируя переднюю дверцу Azure с помощью Key Vault.

> [!IMPORTANT]
> Передняя дверца Azure Standard/Premium (Предварительная версия) в настоящее время доступна в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [**Дополнительные условия использования предварительных версий Microsoft Azure**](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="prerequisites"></a>Предварительные требования

* Прежде чем можно будет настроить протокол HTTPS для личного домена, необходимо сначала создать профиль "Стандартный" или "Премиум" для передней дверцы Azure. Дополнительные сведения см. в разделе [Краткое руководство. Создание профиля передней дверцы Azure уровня "Стандартный" или "Премиум"](create-front-door-portal.md).

* Если у вас еще нет личного домена, сначала необходимо приобрести его у поставщика домена. Например, ознакомьтесь с руководством [Приобретение имени личного домена для веб-приложений Azure](../../app-service/manage-custom-dns-buy-domain.md).

* Если вы используете Azure для размещения [доменов DNS](../../dns/dns-overview.md), необходимо делегировать службу доменных имен (DNS) поставщика домена в Azure DNS. Дополнительные сведения см. в статье [Делегирование домена в Azure DNS](../../dns/dns-delegate-domain-azure-dns.md). В противном случае, если вы используете поставщик домена для работы с доменом DNS, необходимо вручную проверить домен, введя запрошенные записи типа TXT DNS.

## <a name="azure-managed-certificates"></a>Управляемые сертификаты Azure

1. В разделе Параметры для профиля передней дверцы Azure уровня "Стандартный" или "Премиум" выберите **домены** , а затем нажмите кнопку **+ Добавить** , чтобы добавить новый домен.

    :::image type="content" source="../media/how-to-configure-https-custom-domain/add-new-custom-domain.png" alt-text="Снимок экрана с целевой страницей настройки домена.":::

1. На странице **Добавление домена** для параметра *Управление DNS* выберите параметр **управляемая служба DNS Azure** . 

    :::image type="content" source="../media/how-to-configure-https-custom-domain/add-domain-azure-managed.png" alt-text="Снимок экрана: Добавление страницы домена с выбранным управляемым DNS-службой Azure.":::

1. Проверьте и свяжите личный домен с конечной точкой, выполнив действия, описанные в разделе Включение [пользовательского домена](how-to-add-custom-domain.md).

1. После того как личный домен будет успешно связан с конечной точкой, управляемый сертификат Azure будет развернут на переднюю дверцу. Выполнение этого процесса может занять несколько минут.

## <a name="using-your-own-certificate"></a>Использование собственного сертификата

Вы также можете использовать собственный сертификат TLS. Этот сертификат необходимо импортировать в Azure Key Vault, прежде чем его можно будет использовать с передней дверцей Azure "Стандартный" или "Премиум". См. раздел [Импорт сертификата](../../key-vault/certificates/tutorial-import-certificate.md) в Azure Key Vault. 

#### <a name="prepare-your-azure-key-vault-account-and-certificate"></a>Подготовка учетной записи Azure Key Vault и сертификата
 
1. У вас должна быть запущена учетная запись Azure Key Vault в той же подписке, что и передняя дверца Azure уровня "Стандартный" или "Премиум", для которой вы хотите включить настраиваемый HTTPS. Если у вас ее еще нет, создайте учетную запись Azure Key Vault.

    > [!WARNING]
    > Сейчас Azure Front Door поддерживает только учетные записи Key Vault, размещенные в той же подписке, что и конфигурация Front Door. При выборе Key Vault в подписке, отличной от той, на которой настроена Передняя дверца Azure, это приведет к сбою.

1. Если у вас уже есть сертификат, его можно передать непосредственно в учетную запись Azure Key Vault. В противном случае создайте новый сертификат напрямую с помощью Azure Key Vault из одного из центров сертификации партнеров, которые Azure Key Vault интегрируется с. Отправьте сертификат как объект типа **сертификат**, а не **секрет**.

    > [!NOTE]
    > При использовании личного TLS/SSL-сертификата Front Door не поддерживает сертификаты с алгоритмами шифрования EC.

#### <a name="register-azure-front-door"></a>Регистрация Azure Front Door

Зарегистрируйте субъект-службу для Azure Front Door в качестве приложения в Azure Active Directory с помощью PowerShell.

> [!NOTE]
> Для выполнения этого действия требуются разрешения глобального администратора. Оно выполняется только **один раз** для каждого клиента.

1. При необходимости установите [Azure PowerShell](/powershell/azure/install-az-ps) в PowerShell на локальном компьютере.

1. Выполните следующую команду в PowerShell:

     `New-AzADServicePrincipal -ApplicationId "205478c0-bd83-4e1b-a9d6-db63a3e1e1c8"`              

#### <a name="grant-azure-front-door-access-to-your-key-vault"></a>Предоставление Azure Front Door доступа к хранилищу ключей
 
Предоставьте Azure Front Door разрешение на доступ к сертификатам в учетной записи Azure Key Vault.

1. В учетной записи хранилища ключей в разделе Параметры выберите **политики доступа**. Затем выберите **Добавить новый** , чтобы создать новую политику.

1. В окне **Выбор субъекта** выполните поиск по запросу **205478c0-bd83-4e1b-a9d6-db63a3e1e1c8** и выберите * * Microsoft. азурефронтдур-CDN * *. Нажмите кнопку **Выбрать**.

1. Выберите **Разрешения секрета** и **Получить**, чтобы разрешить Front Door получить сертификат.

1. Выберите **Разрешения сертификата** и **Получить**, чтобы разрешить Front Door получить сертификат.

1. Щелкните **ОК**. 

#### <a name="select-the-certificate-for-azure-front-door-to-deploy"></a>Выбор сертификата для развертывания в Azure Front Door
 
1. Вернитесь к интерфейсу передней дверцы Azure уровня "Стандартный" или "Премиум" на портале.

1. Перейдите к разделу **секреты** в разделе *Параметры* и выберите **Добавить сертификат**.

    :::image type="content" source="../media/how-to-configure-https-custom-domain/add-certificate.png" alt-text="Снимок экрана: Целевая страница секрета передней дверцы Azure.":::

1. На странице **Добавление сертификата** установите флажок для сертификата, который вы хотите добавить в переднюю дверцу Azure "Стандартный" или "Премиум". Оставьте для выбора версии значение "Последняя" и нажмите кнопку **Добавить**. 

    :::image type="content" source="../media/how-to-configure-https-custom-domain/add-certificate-page.png" alt-text="Снимок экрана: страница &quot;Добавление сертификата&quot;.":::

1. После успешного завершения подготовки сертификата его можно использовать при добавлении нового пользовательского домена.

    :::image type="content" source="../media/how-to-configure-https-custom-domain/successful-certificate-provisioned.png" alt-text="Снимок экрана: сертификат успешно добавлен в секреты.":::

1. Перейдите к **доменам** в разделе " *Параметры* " и выберите **+ добавить** , чтобы добавить новый личный домен. На странице **Добавление домена** выберите "присвоить собственный сертификат (BYOC)" для *HTTPS*. В поле *секрет* выберите сертификат, который вы хотите использовать из раскрывающегося списка. 

    > [!NOTE]
    > Выбранный сертификат должен иметь общее имя (CN), совпадающее с добавляемым пользовательским доменом.

    :::image type="content" source="../media/how-to-configure-https-custom-domain/add-custom-domain-https.png" alt-text="Снимок экрана: Добавление страницы пользовательского домена с HTTPS.":::

1. Следуйте инструкциям на экране, чтобы проверить сертификат. Затем свяжите созданный личный домен с конечной точкой, как описано в разделе [Создание пользовательского домена](how-to-add-custom-domain.md) .

#### <a name="change-from-azure-managed-to-bring-your-own-certificate-byoc"></a>Изменение из Azure, управляемой для переноса собственного сертификата (BYOC)

1. Вы можете изменить существующий управляемый сертификат Azure на сертификат, управляемый пользователем, выбрав состояние сертификата, чтобы открыть страницу **сведений о сертификате** .

    :::image type="content" source="../media/how-to-configure-https-custom-domain/domain-certificate.png" alt-text="Снимок экрана: состояние сертификата на целевой странице доменов." lightbox="../media/how-to-configure-https-custom-domain/domain-certificate-expanded.png":::

1. На странице **сведения о сертификате** можно перейти с параметра "Управление службой Azure" на "присвоить свой собственный сертификат (BYOC)". Затем выполните те же действия, что и ранее, чтобы выбрать сертификат. Выберите **Обновить** , чтобы изменить связанный сертификат с доменом.

    :::image type="content" source="../media/how-to-configure-https-custom-domain/certificate-details-page.png" alt-text="Снимок экрана со страницей сведений о сертификате.":::

## <a name="next-steps"></a>Дальнейшие действия

Узнайте о [кэшировании с помощью передней дверцы Azure уровня "Стандартный" или "Премиум](concept-caching.md)".
