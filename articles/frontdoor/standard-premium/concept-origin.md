---
title: Исходная и исходная группы в передней дверце Azure уровня "Стандартный" или "Премиум"
description: В этой статье описывается, какая исходная и исходная группы находятся в конфигурации передней дверцы Azure.
services: frontdoor
author: duongau
ms.service: frontdoor
ms.topic: conceptual
ms.date: 02/18/2021
ms.author: duau
ms.openlocfilehash: 42a9a0ea23faa481140a46ec52b2214431dd723e
ms.sourcegitcommit: 97c48e630ec22edc12a0f8e4e592d1676323d7b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/18/2021
ms.locfileid: "101100083"
---
# <a name="origin-and-origin-group-in-azure-front-door-standardpremium-preview"></a>Исходная и исходная группы в передней дверце Azure Standard/Premium (Предварительная версия)

> [!Note]
> Эта документация предназначена для передней дверцы Azure уровня "Стандартный" или "Премиум" (Предварительная версия). Ищете информацию о передней дверце Azure? Просмотреть [здесь](../front-door-overview.md).

В этой статье рассматриваются основные принципы работы развертывания веб-приложения с передней дверцей Azure уровня "Стандартный" или "Премиум". Кроме того, вы узнаете о том, что представляет *Исходная* и *Исходная группы* в конфигурации передней дверцы Azure (стандартную или расширенную).

> [!IMPORTANT]
> Передняя дверца Azure Standard/Premium (Предварительная версия) в настоящее время доступна в общедоступной предварительной версии.
> Эта предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для использования рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены.
> Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

## <a name="origin"></a>Исходный домен

Источник "Стандартный" или "Премиум" передней дверцы Azure относится к имени узла или общедоступному IP-адресу приложения, которое обслуживает запросы клиентов. Передняя дверца Azure Standard/Premium поддерживает ресурсы Azure и не Azure в исходной группе. Приложение также может размещаться в локальном центре обработки данных или в другом поставщике облачных служб. Источник не следует путать с уровнем базы данных или уровнем хранилища. Источник должен быть просмотрен как общедоступная конечная точка для серверной части приложения. При добавлении источника в группу источника "Предварительная дверца" уровня "Стандартный" или "Премиум" необходимо также добавить следующие сведения.

* **Тип источника:** Тип ресурса, который требуется добавить. Передняя дверца поддерживает автообнаружение серверной части приложения из службы приложений, облачной службы или хранилища. Если вам нужен другой ресурс в Azure или даже Серверная часть, не относящаяся к Azure, выберите **Пользовательский узел**.

    >[!IMPORTANT]
    >Во время настройки API не проверяет, недоступен ли источник из среды передней дверцы. Убедитесь, что передняя дверца может достигнуть вашего источника.

* **Имя узла подписки и источника:** Если вы не выбрали **Пользовательский узел** для типа узла серверной части, выберите свою серверную часть, выбрав соответствующую подписку и соответствующее имя внутреннего узла.

* **Заголовок узла источника:** Значение заголовка узла, отправляемое в серверную часть для каждого запроса. Дополнительные сведения см. в разделе [заголовок узла источника](#hostheader).

* **Приоритет:** Назначьте приоритеты разным источникам, если вы хотите использовать первичный источник для всего трафика. Кроме того, укажите резервные копии, если первичный или резервный источник данных недоступен. Дополнительные сведения см. в разделе [Priority](#priority).

* **Вес:** Назначьте вес разным источникам, чтобы распределить трафик между набором источников, равномерно или в соответствии с коэффициентами веса. Дополнительные сведения см. в разделе [веса](#weighted).

### <a name="origin-host-header"></a><a name = "hostheader"></a>Заголовок узла источника

Запросы, перенаправляемые с помощью передней дверцы Azure уровня "Стандартный" или "Премиум" в источник, будут включать поле заголовка узла, используемое источником для получения целевого ресурса. Значение для этого поля обычно берется из URI источника, который имеет заголовок узла и порт.

Например, запрос, отправленный для `www.contoso.com` , будет иметь заголовок узла `www.contoso.com` . Если для настройки источника используется портал Azure, значением по умолчанию для этого поля является имя узла серверной части. Если источником является `contoso-westus.azurewebsites.net` , в портал Azure автоматически заполняемое значение для заголовка узла-источника будет `contoso-westus.azurewebsites.net` . Однако если вы используете Azure Resource Manager шаблоны или другой метод без явного задания этого поля, то передняя дверца отправит входящее имя узла в качестве значения заголовка узла. Если запрос был сделан для `www.contoso.com` , а источником является `contoso-westus.azurewebsites.net` пустое поле заголовка, то передняя дверь установит заголовок узла как `www.contoso.com` .

Для большинства серверных частей приложения (веб-приложения Azure, хранилище больших двоичных объектов и облачные службы) заголовок узла должен соответствовать домену внутреннего сервера. Однако интерфейсный узел, который маршрутизирует на серверную часть, будет использовать другое имя узла, например `www.contoso.net` .

Если для источника требуется, чтобы заголовок узла совпадал с именем узла серверной части, убедитесь, что заголовок узла внутреннего сервера содержит имя узла серверной части.

#### <a name="configuring-the-origin-host-header-for-the-origin"></a>Настройка заголовка исходного узла для источника

Настройка поля **заголовка узла** источника для источника в разделе Группа происхождения:

1. Откройте ресурс "Передняя дверь" и выберите исходную группу с источником для настройки.

2. Добавьте источник, если вы этого не сделали, или измените существующий.

3. Задайте в поле заголовка узла-источника пользовательское значение или оставьте его пустым. Имя узла для входящего запроса будет использоваться в качестве значения заголовка узла.

## <a name="origin-group"></a>Исходная группа

Группа происхождения в передней дверце Azure "Стандартный"/"Премиум" относится к набору источников, которые получают подобный трафик для своего приложения. Иными словами, это логическая группировка экземпляров приложения по всему миру, которые получают одинаковый трафик и отвечают ожидаемому поведению. Эти источники можно развернуть в разных регионах или в одном регионе. Все источники могут находиться в режиме активного или активного развертывания или быть определены как Активная/пассивная конфигурация.

Группа происхождения определяет, как должны оцениваться источники с помощью проб работоспособности. Он также определяет, как происходит балансировка нагрузки между ними.

### <a name="health-probes"></a>Пробы работоспособности

Передняя дверца Azure "Стандартный" или "Премиум" отправляет периодические запросы проверки HTTP/HTTPS на каждый из настроенных источников. Запросы пробы определяют сходство и работоспособность каждого источника для балансировки нагрузки запросов конечных пользователей. Параметры проверки работоспособности для исходной группы определяют, как мы будем опрашивать состояние работоспособности незавершенных приложений. Для конфигурации балансировки нагрузки доступны следующие параметры.

* **Путь**: URL-адрес, используемый для пробных запросов для всех источников в исходной группе. Например, если один из источников имеет `contoso-westus.azurewebsites.net` значение, а путь —/пробе/тест.аспкс, то среда "Начальная дверь", при условии, что протокол является HTTP, отправит запросы проверки работоспособности в `http://contoso-westus.azurewebsites.net/probe/test.aspx` .

* **Протокол**: определяет, следует ли отсылать запросы проверки работоспособности с передней дверцы к источникам по протоколу HTTP или HTTPS.

* **Метод**: метод HTTP, используемый для отправки проб работоспособности. Параметры включают GET или HEAD (по умолчанию).
    > [!NOTE]
    > Для более низкой нагрузки и снижения стоимости работы на серверной части первая дверца рекомендует использовать ГОЛОВные запросы для проб работоспособности.

* **Интервал (в секундах)**: определяет частоту проверок работоспособности в источниках или интервалы, в течение которых каждая из сред передней дверцы отправляет зонд.

    >[!NOTE]
    >Для ускорения отработки отказа установите для интервала меньшее значение. Чем меньше это значение, тем выше объем данных проверки работоспособности, получаемый конечными точками. Например, если для интервала задано значение 30 секунд, то есть 100 точек на передней дверце, каждая серверная часть получит около 200 запросов пробы в минуту.

Дополнительные сведения см. в разделе [зонды работоспособности](concept-health-probes.md).

### <a name="load-balancing-settings"></a>Параметры балансировки нагрузки

Параметры балансировки нагрузки для исходной группы определяют, как мы оцениваем пробы работоспособности. Эти параметры определяют, является ли источник работоспособным или неработоспособным. Они также проверяют нагрузку на трафик между разными источниками в исходной группе. Для конфигурации балансировки нагрузки доступны следующие параметры.

* **Размер выборки:** Определяет, сколько примеров проверок работоспособности необходимо учитывать при оценке исправности источника.

* **Размер выборки успешно выполнен:** Определяет размер выборки, как упоминалось ранее, количество успешных выборок, необходимых для вызова источника в работоспособном состоянии. Например, предположим, что интервал проверки работоспособности передней дверцы составляет 30 секунд, размер выборки равен 5, а успешный размер выборки — 3. Каждый раз, когда оцениваются пробы работоспособности для источника, мы рассмотрим пять последних выборок за 150 секунд (5 x 30). Для объявления источника как работоспособного требуется по крайней мере три успешные проверки.

* **Чувствительность задержки (дополнительные задержки):** Определяет, следует ли использовать переднюю дверь Azure уровня "Стандартный" или "Премиум" для отправки запроса в источник в диапазоне чувствительности к измерению задержки или пересылки запроса на ближайший сервер.

Дополнительные сведения см. в разделе [метод маршрутизации на основе минимальной задержки](#latency).

## <a name="routing-methods"></a>Методы маршрутизации

Передняя дверца Azure Standard/Premium поддерживает различные типы методов маршрутизации трафика, чтобы определить, как перенаправлять трафик HTTP/HTTPS в разные конечные точки службы. Когда клиент запрашивает достижение передней дверцы, настроенный метод маршрутизации применяется, чтобы обеспечить перенаправление запросов на лучший экземпляр сервера. 

Существует четыре метода маршрутизации трафика, доступные в интерфейсе передней дверцы Azure уровня "Стандартный" или "Премиум".

* **[Задержка](#latency)**. Маршрутизация на основе задержки гарантирует, что запросы отправляются на внутренние серверы с минимальной допустимой задержкой в диапазоне чувствительности. По сути, запросы пользователей отправляются на «ближайший» набор в отношении задержки сети.
* **[Приоритет](#priority):** Если вы хотите настроить основной сервер для обслуживания всего трафика, можно назначить приоритеты для своих конечных серверов. Вторичная Серверная часть может быть резервной копией в случае, если основная Серверная часть становится недоступной.
* **[Взвешенный](#weighted):** Вы можете назначить весовые коэффициенты для своих конечных точек, если нужно распределить трафик по набору интерфейсов. Требуется ли равномерное распределение или согласно коэффициентам веса.

Все стандартные и расширенные конфигурации передней дверцы Azure включают мониторинг работоспособности серверной части и автоматическую глобальную отработку отказа. Дополнительные сведения см. в разделе [мониторинг серверной части](concept-health-probes.md). Передняя дверца может работать на основе одного метода маршрутизации. Но в зависимости от потребностей приложения можно также сочетать несколько методов маршрутизации для создания оптимальной топологии маршрутизации.

### <a name="lowest-latencies-based-traffic-routing"></a><a name = "latency"></a>Маршрутизация трафика на основе минимальной задержки

Развертывание серверной части в двух или более расположениях по всему миру может повысить скорость реагирования приложений за счет маршрутизации трафика в целевое расположение, которое является ближайшим к конечным пользователям. Метод маршрутизации трафика по умолчанию для конфигурации передней дверцы направляет запросы от конечных пользователей к ближайшему серверной части среды передней дверцы, которая получила запрос. В сочетании с архитектурой первого уровня для передней дверцы Azure этот подход гарантирует, что каждый пользователь будет получать максимальную производительность в соответствии с их расположением.

"Ближайший" серверный внутренний объект не обязательно должен быть ближе к измерению по географическому расстоянию. Вместо этого Front Door определяет ближайший внутренний сервер, измеряя сетевую задержку.

Ниже приведен общий процесс принятия решений.

| Доступные внутренние серверы | Приоритет | Задержка (с учетом пробы работоспособности) | Веса |
|-------------| ----------- | ----------- | ----------- |
| Во-первых, выберите все включенные и возвращаемые работоспособные интерфейсы (200 ОК) для проверки работоспособности. Если имеется шесть конечных элементов A, B, C, D, E и F, а между ними есть неработоспособные, а E отключено. Список доступных однодисковых интерфейсов — A, B, D и F.  | Далее выбираются однородные элементы с наивысшим приоритетом среди доступных. Если серверная часть A, B и D имеет приоритет 1, а Серверная часть F имеет приоритет 2. В этом случае выбранные элементы будут иметь значение A, B и D.| Выберите внутренние серверы с диапазоном задержки (минимальная задержка и чувствительность к задержке в миллисекундах). Если серверная часть A — 15 мс, B — 30 мс, а D — 60 мс из среды передней дверцы, где запрашивается запрос, а задержка — 30 мс, то самый низкий пул задержки состоит из серверной части A и B, так как D находится за пределами 30 мс от ближайшей серверной части. | Наконец, Front Door будет циклически перебирать трафик в окончательном выбранном пуле внутренних серверов с учетом указанных весовых коэффициентов. Например, если внутренний сервер A имеет вес 5, а внутренний сервер B имеет вес 8, то трафик между внутренним серверами A и B будет распределяться в соотношении 5:8. |

>[!NOTE]
> По умолчанию задано значение свойства чувствительности к задержке, равное 0 мс, то есть запрос всегда пересылается на самый быстрый внутренний сервер.

### <a name="priority-based-traffic-routing"></a><a name = "priority"></a>Маршрутизация трафика по приоритету

Часто Организация хочет обеспечить высокий уровень доступности для своих служб путем развертывания нескольких служб резервного копирования в случае, если основная одна из них выходит из строя. В отрасли эта топология также называется топологией развертывания "активный — резервный" или "активный — пассивный". Метод маршрутизации трафика "По приоритету" позволяет клиентам Azure легко реализовать эту схему отработки отказа.

По умолчанию Front Door содержит список внутренних серверов с одинаковым приоритетом. По умолчанию Front Door отправляет трафик только на внутренние серверы с максимальным приоритетом (наименьшим значением приоритета), то есть в основной набор внутренних серверов. Если основная Серверная часть недоступна, то передняя дверца направляет трафик на дополнительный набор серверных интерфейсов (второе наименьшее значение приоритета). Если первичная и вторичная серверные недоступны, трафик переходит к третьему и т. д. Доступность внутреннего сервера основывается на настроенном состоянии (включен или отключен) и текущем состоянии работоспособности внутреннего сервера, которое определяют пробы работоспособности.

#### <a name="configuring-priority-for-backends"></a>Настройка приоритета внутренних серверов

Каждая серверная часть серверного пула в конфигурации передней дверцы имеет свойство Priority, которое может быть числом от 1 до 5. С помощью передней дверцы Azure вы настраиваете приоритет серверной части явным образом, используя это свойство для каждой серверной части. Это свойство может принимать значения от 1 до 5. Чем меньше значение, тем выше приоритет. У внутренних серверов могут быть одинаковые значения приоритета.

### <a name="weighted-traffic-routing-method"></a><a name = "weighted"></a>Метод маршрутизации трафика со взвешиванием
Маршрутизация трафика по методу взвешивания позволяет распределять трафик равномерно или в соответствии с предустановленными весовыми коэффициентами.

При использовании метода маршрутизации трафика со взвешиванием каждому внутреннему серверу в конфигурации Front Door присваивается определенный вес. Это целое число в диапазоне от 1 до 1000. По умолчанию этот параметр задает вес, равный 50.

Список доступных серверных интерфейсов с приемлемой чувствительностью к задержке трафика распределяется с помощью механизма циклического перебора с использованием указанного коэффициента веса. Если задержка задается равным 0 миллисекундам, это свойство не вступит в силу, если не существует двух незавершенных операций с одинаковой сетевой задержкой. 

Метод взвешивания позволяет реализовать некоторые полезные сценарии.

* **Постепенное обновление приложения**: дает процент трафика для маршрутизации в новую серверную часть и постепенно увеличивает трафик, чтобы привести его в действие с другими серверными интерфейсами.
* **Перенос приложений в Azure**. Создайте внутренний пул, который включает в себя внутренние серверы, расположенные в среде Azure и за ее пределами. Настройте веса внутренних серверов так, чтобы приоритет отдавался новым внутренним серверам. Это можно делать постепенно, начиная с отключенных новых внутренних серверов, а затем назначая им наименьшие веса, медленно увеличивая их до уровня, при котором они будут принимать большую часть трафика. Затем можно будет отключить менее предпочтительные внутренние серверы и удалить их из пула.  
* **Переход в облако для получения дополнительной емкости**. Быстро расширьте локальное развертывание в облако, воспользовавшись службой Front Door. Если вам требуется дополнительная емкость в облаке, можно добавить или включить дополнительные внутренние серверы и указать, какая часть трафика направляется на каждый из них.

## <a name="next-steps"></a>Следующие шаги

Узнайте, как [создать переднюю дверь уровня "Стандартный" или "Премиум](create-front-door-portal.md) "
