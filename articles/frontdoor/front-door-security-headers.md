---
title: Руководство по Добавление заголовков безопасности с помощью обработчика правил (Azure Front Door)
description: В этом руководстве объясняется, как настроить заголовок безопасности с помощью обработчика правил в Azure Front Door.
services: frontdoor
documentationcenter: ''
author: duongau
editor: ''
ms.service: frontdoor
ms.devlang: na
ms.topic: tutorial
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/14/2020
ms.author: duau
ms.openlocfilehash: e8462b98aee1d34b6c7a2ed671667223eca45a25
ms.sourcegitcommit: b0557848d0ad9b74bf293217862525d08fe0fc1d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/07/2021
ms.locfileid: "106551923"
---
# <a name="tutorial-add-security-headers-with-rules-engine"></a>Руководство по Добавление заголовков безопасности с помощью обработчика правил

В этом учебнике показано, как реализовать заголовки безопасности, чтобы предотвратить возникновение уязвимостей в браузере, например HTTP Strict-Transport-Security (HSTS), X-XSS-Protection, Content-Security-Policy или X-Frame-Options. Атрибуты для системы безопасности можно также определять с помощью файлов cookie.

В следующем примере показано, как добавлять заголовок Content-Security-Policy ко всем входящим запросам, соответствующим определенному в маршруте пути, с которым связана конфигурация обработчика правил. В этом примере мы разрешим выполнение скриптов в приложении только с доверенного сайта **https://apiphany.portal.azure-api.net** .

В этом руководстве описано следующее:
> [!div class="checklist"]
> - Настройка политики безопасности содержимого в обработчике правил.

## <a name="prerequisites"></a>Предварительные требования

* Прежде чем перейти к выполнению шагов в этом руководстве, создайте службу Front Door. Дополнительные сведения см. в [кратком руководстве Создание профиля Front Door для высокодоступного глобального веб-приложения](quickstart-create-front-door.md).
* Если вы впервые используете функцию обработчика правил, ознакомьтесь со статьей [Настройка обработчика правил](front-door-tutorial-rules-engine.md).

## <a name="add-a-content-security-policy-header-in-azure-portal"></a>Добавление заголовка Content-Security-Policy на портале Azure

1. Щелкните **Добавить**, чтобы добавить новое правило. Введите имя для правила и щелкните **Добавить действие** > **Заголовок ответа**.

1. Для параметра "Оператор" укажите значение **Добавить**, чтобы добавлять этот заголовок в ответ на все входящие запросы по указанному маршруту.

1. Добавьте имя заголовка **Content-Security-Policy** и определите значения, которые будет принимать этот заголовок. В нашем примере это *"script-src 'self' https://apiphany.portal.azure-api.net."*

   > [!NOTE]
   > Длина значений заголовка ограничена 128 символами.

1. Завершив добавление всех правил, которые нужны для вашей конфигурации, обязательно перейдите по нужному маршруту и сопоставьте конфигурацию обработчика правил с правилом для этого маршрута. Этот шаг позволяет включить настроенное правило. 

![Пример на портале](./media/front-door-rules-engine/rules-engine-security-header-example.png)

> [!NOTE]
> В нашем примере к правилу не добавляются [условия соответствия](front-door-rules-engine-match-conditions.md). Это означает, что правило будет применяться ко всем входящим запросам, соответствующим пути, указанному в правиле маршрута. Если вы хотите применять его к некоторому подмножеству этих запросов, добавьте нужные **условия соответствия** в это правило.

## <a name="clean-up-resources"></a>Очистка ресурсов

На предыдущих шагах вы настроили заголовки безопасности с помощью обработчика правил. Если правило больше не нужно, его можно удалить, щелкнув "Удалить правило".

:::image type="content" source="./media/front-door-rules-engine/rules-engine-delete-rule.png" alt-text="Удаление правила":::

## <a name="next-steps"></a>Дальнейшие действия

Чтобы узнать, как настроить Брандмауэр веб-приложений для Front Door, перейдите к следующему учебнику.

> [!div class="nextstepaction"]
> [Брандмауэр веб-приложения и Front Door](front-door-waf.md)
