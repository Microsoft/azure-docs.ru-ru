---
title: Развертывание примера базовой схемы Azure Security Benchmark
description: Инструкции по развертыванию примера базовой схемы Azure Security Benchmark и сведения о параметрах артефактов схемы.
ms.date: 02/18/2020
ms.topic: sample
ms.openlocfilehash: e48f3da383bdb6d5c9960595f3c0fdcabc27dc75
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101740687"
---
# <a name="deploy-the-azure-security-benchmark-foundation-blueprint-sample"></a>Развертывание примера базовой схемы Azure Security Benchmark

Чтобы развернуть пример базовой схемы Azure Security Benchmark, выполните следующие действия:

> [!div class="checklist"]
> - создание схемы на основе примера;
> - установка метки копии образца **Опубликовано**;
> - назначение копии схемы существующей подписке;

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free), прежде чем начинать работу.

## <a name="create-blueprint-from-sample"></a>Создание схемы на основе примера

Для начала внедрите пример схемы, создав новую схему в среде на основе этого примера.

1. Выберите **Все службы** в левой области. Найдите и выберите пункт **Схемы**.

1. На странице **Начало работы** с левой стороны в разделе _Создание схемы_ щелкните кнопку **Создать**.

1. Найдите пример **базовой схемы Azure Security Benchmark** в разделе _Другие примеры_ и выберите **Использовать этот пример**.

1. Введите _основные данные_ образца схемы.

   - **Имя схемы**. Укажите имя для своей копии примера базовой схемы Azure Security Benchmark.
   - **Расположение определения**. Используйте кнопку с многоточием и выберите группу управления, в которой нужно сохранить копию примера.

1. В верхней части страницы выберите вкладку _Артефакты_ или внизу страницы щелкните **Далее: Артефакты**.

1. Просмотрите список артефактов, из которых состоит образец схемы. Многие артефакты имеют параметры, которые мы определим позднее. После завершения просмотра образца схемы выберите **Сохранить черновик**.

## <a name="publish-the-sample-copy"></a>Публикации копии образца

Теперь в вашей среде создана копия образца схемы. Она создана в режиме **Черновик**, и прежде чем назначить и развернуть эту копию, ее необходимо **опубликовать**. Вы можете изменить параметры своей копии этого примера схемы с учетом среды и требований, но такие изменения могут нарушить соответствие типу базовой схемы Azure Security Benchmark.

1. Выберите **Все службы** в левой области. Найдите и выберите пункт **Схемы**.

1. В меню слева выберите страницу **Определения схем**. Примените фильтры, чтобы найти копию примера схемы, и выберите его.

1. В верхней части страницы выберите **Опубликовать схему**. В правой части новой страницы укажите **версию** для копии примера схемы. Это свойство позволяет вносить изменения позднее. Укажите **сведения об изменениях**, например First version published from the Azure Security Benchmark Foundation (Первая версия, опубликованная из примера базовой схемы Azure Security Benchmark). Затем щелкните **Опубликовать** в нижней части страницы.

## <a name="assign-the-sample-copy"></a>Назначение копии образца

После успешной **публикации** копию образца схемы можно назначить подписке в группе управления, в которой ее сохранили. На этом шаге указывают параметры, которые позволяют сделать каждое развертывание образца схемы уникальным.

1. Выберите **Все службы** в левой области. Найдите и выберите пункт **Схемы**.

1. В меню слева выберите страницу **Определения схем**. Примените фильтры, чтобы найти копию примера схемы, и выберите его.

1. В верхней части страницы определения схемы выберите **Назначить схему**.

1. Укажите значения параметра для назначения схемы.

   - Основы
       - **Подписки**. Выберите одну или несколько подписок, которые находятся в группе управления, в которой вы сохранили копию образца схемы. Если вы выберите более одной подписки, для каждой из них будет создано назначение с использованием введенных параметров.
     - **Имя назначения.** Имя автоматически заполняется на основе имени схемы.
       Измените его при желании или сохраните вариант по умолчанию.
     - **Расположение.** Выберите регион, в котором будет создано управляемое удостоверение.
     - Azure Blueprint использует это управляемое удостоверение для развертывания всех артефактов в назначенную схему.
       Дополнительные сведения см. в статье [Управляемые удостоверения для ресурсов Azure](../../../../active-directory/managed-identities-azure-resources/overview.md).
     - **Версия определения схемы**. Выберите **опубликованную** версию копии примера схемы.

   - Блокировка назначения

     Выберите режим блокировки для схемы с учетом своей среды. Дополнительные сведения см. в разделе [Блокировка ресурсов схем](../../concepts/resource-locking.md).

   - Управляемое удостоверение

     Выберите вариант удостоверения по умолчанию (управляемое удостоверение, _назначаемое системой_,) или удостоверение, _назначаемое пользователем_.

   - Параметры схемы

     Параметры, определенные в этом разделе, используются многими артефактами из определения схемы. Это сделано для обеспечения согласованности.
    
     - **Префикс для ресурсов и групп ресурсов** — эта строка используется в качестве префикса для всех имен ресурсов и групп ресурсов.
     - **Имя центра** — имя для центра.
     - **Хранение журнала (в днях)**  — количество дней, в течение которых хранятся журналы; при значении "0" журналы хранятся бессрочно.
     - **Развернуть центр** — введите true или false, чтобы указать, будут ли с помощью назначения развертываться компоненты центра архитектуры.
     - **Расположение центра** — расположение группы ресурсов центра.
     - **IP-адреса назначения** — IP-адреса назначения для исходящих подключений. Это разделенный запятыми список IP-адресов или префиксов IP-диапазона.
     - **Имя Наблюдателя за сетями** — имя для ресурса Наблюдателя за сетями.
     - **Имя группы ресурсов Наблюдателя за сетями** — имя для группы ресурсов Наблюдателя за сетями.
     - **Включить защиту от атак DDoS** — введите true или false, чтобы указать, включена ли защита от атак DDoS в виртуальной сети.
     
    > [!NOTE] 
    > Если Наблюдатель за сетями уже включен, рекомендуется использовать существующую группу ресурсов Наблюдателя за сетями. Вам также необходимо указать расположение существующей группы ресурсов Наблюдателя за сетями для параметра артефакта **Расположение группы ресурсов Наблюдателя за сетями**.

   - Параметры артефакта

     Параметры, определенные в этом разделе, применяются к артефакту, под которым они определены. Поскольку эти параметры определяются во время назначения схемы, они являются [динамическими](../../concepts/parameters.md#dynamic-parameters). Полный список параметров артефактов с описаниями можно найти в [таблице параметров артефактов](#artifact-parameters-table).

1. После ввода всех параметров в нижней части страницы выберите **Назначить**. Это действие создает назначение схемы и начинает развертывание артефактов. Развертывание занимает около часа. Чтобы проверить состояние развертывания, откройте назначение схемы.

> [!WARNING]
> Служба Azure Blueprints и встроенные примеры схем предоставляются **бесплатно**. Ресурсы Azure оплачиваются согласно [тарифам на продукты](https://azure.microsoft.com/pricing/). С помощью [калькулятора цен](https://azure.microsoft.com/pricing/calculator/) вы можете оценить расходы на выполнение ресурсов, развертываемых этим примером схемы.

## <a name="artifact-parameters-table"></a>Таблица параметров артефактов

Следующая таблица содержит полный список параметров схемы:

|Имя артефакта|Тип артефакта|Имя параметра|Описание|
|-|-|-|-|
|Группа ресурсов центра|Группа ресурсов|Имя группы ресурсов|Заблокировано — добавляет префикс к имени центра|
|Группа ресурсов центра|Группа ресурсов|Расположение группы ресурсов|Заблокировано, используется расположение центра|
|Шаблон Брандмауэра Azure|Шаблон Resource Manager|Частный IP-адрес Брандмауэра Azure||
|Шаблон Azure Log Analytics и Диагностики Azure|Шаблон Resource Manager|Расположение рабочей области Log Analytics|Расположение, в котором создана рабочая область Log Analytics. Выполните `Get-AzLocation | Where-Object Providers -like 'Microsoft.OperationalInsights' | Select DisplayName` в Azure PowersShell, чтобы просмотреть доступные регионы|
|Шаблон Azure Log Analytics и Диагностики Azure|Шаблон Resource Manager|Идентификатор учетной записи службы автоматизации Azure (необязательно)|Идентификатор ресурса учетной записи службы автоматизации. Используется для создания связанной службы между Log Analytics и учетной записью службы автоматизации|
|Шаблон группы безопасности сети Azure|Шаблон Resource Manager|Включить журналы потоков NSG|Введите true или false, чтобы включить или отключить журналы потоков NSG|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса виртуальной сети|Префикс адреса виртуальной сети для виртуальной сети центра|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса подсети брандмауэра|Префикс адреса подсети брандмауэра для виртуальной сети центра|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса подсети Бастиона|Префикс адреса подсети Бастиона для виртуальной сети центра|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса подсети шлюза|Префикс адреса подсети шлюза для виртуальной сети центра|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса подсети управления|Префикс адреса подсети управления для виртуальной сети центра|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса подсети переходной среды|Префикс адреса подсети переходной среды для виртуальной сети центра|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Имена адресов подсети (необязательно)|Массив имен подсетей для развертывания в виртуальной сети центра (например, subnet1, subnet2)|
|Шаблон центра виртуальной сети Azure|Шаблон Resource Manager|Префиксы адресов подсети (необязательно)|Массив префиксов IP-адресов для дополнительных подсетей виртуальной сети центра (например, 10.0.7.0/24, 10.0.8.0/24)|
|Группа ресурсов периферийной сети|Группа ресурсов|Имя группы ресурсов|Заблокировано, добавляет префикс к имени периферийной сети|
|Группа ресурсов периферийной сети|Группа ресурсов|Расположение группы ресурсов|Заблокировано, используется расположение центра|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Развертывание периферийной сети|Введите true или false, чтобы указать, будут ли с помощью назначения развертываться компоненты периферийной сети архитектуры|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Идентификатор подписки центра|Идентификатор подписки, в которой развернут центр. Значение по умолчанию — это подписка, в которой располагается определение схемы.|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Имя периферийной сети|Имя, назначенное периферийной сети|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса виртуальной сети|Префикс адреса виртуальной сети для виртуальной периферийной сети|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Префикс адреса подсети|Префикс адреса подсети для виртуальной периферийной сети|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Имена адресов подсети (необязательно)|Массив имен подсетей для развертывания в виртуальной периферийной сети (например, subnet1, subnet2)|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Префиксы адресов подсети (необязательно)|Массив префиксов IP-адресов для дополнительных подсетей виртуальной периферийной сети (например, 10.0.7.0/24, 10.0.8.0/24)|
|Шаблон периферийной виртуальной сети Azure|Шаблон Resource Manager|Развертывание периферийной сети|Введите true или false, чтобы указать, будут ли с помощью назначения развертываться компоненты периферийной сети архитектуры|
|Шаблон Наблюдателя за сетями Azure|Шаблон Resource Manager|Расположение Наблюдателя за сетями|Расположение для ресурса Наблюдателя за сетями|
|Шаблон Наблюдателя за сетями Azure|Шаблон Resource Manager|Расположение группы ресурсов Наблюдателя за сетями|Если Наблюдатель за сетями уже включен, значение этого параметра **должно** совпадать с расположением существующей группы ресурсов Наблюдателя за сетями.|

## <a name="troubleshooting"></a>Устранение неполадок

Если возникла ошибка `The resource group 'NetworkWatcherRG' failed to deploy due to the
following error: Invalid resource group location '{location}'. The Resource group already exists in
location '{location}'.`, убедитесь, что для параметра схемы **Имя группы ресурсов Наблюдателя за сетями** указано имя существующей группы ресурсов Наблюдателя за сетями, а для параметра артефакта **Расположение группы ресурсов Наблюдателя за сетями** указано существующее расположение группы ресурсов Наблюдателя за сетями.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы ознакомились с инструкциями по развертыванию примера базовой схемы Azure Security Benchmark, перейдите к следующей статье, чтобы получить сведения об архитектуре:

> [!div class="nextstepaction"]
> [Общие сведения о базовой схеме Azure Security Benchmark](./index.md)

Дополнительные статьи о схемах и способах их использования:

- Ознакомьтесь со сведениями о [жизненном цикле схем](../../concepts/lifecycle.md).
- Узнайте, как использовать [статические и динамические параметры](../../concepts/parameters.md).
- Научитесь настраивать [последовательность схемы](../../concepts/sequencing-order.md).
- Узнайте, как применять [блокировку ресурсов схемы](../../concepts/resource-locking.md).
- Узнайте, как [обновлять существующие назначения](../../how-to/update-existing-assignments.md).
