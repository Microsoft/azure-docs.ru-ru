---
title: Расширение Политики Azure для Visual Studio Code
description: Узнайте, как использовать расширение политики Azure для Visual Studio Code поиска псевдонимов Azure Resource Manager.
ms.date: 01/11/2021
ms.topic: how-to
ms.openlocfilehash: 4c4ba0eeb0506179ff92ead0ee86f048600d157e
ms.sourcegitcommit: 48e5379c373f8bd98bc6de439482248cd07ae883
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "98107945"
---
# <a name="use-azure-policy-extension-for-visual-studio-code"></a>Использование расширения политики Azure для Visual Studio Code

> Применяется к расширению политики Azure версии **0.1.1** и более поздних версий

Узнайте, как использовать расширение политики Azure для Visual Studio Code поиска [псевдонимов](../concepts/definition-structure.md#aliases), просмотра ресурсов и политик, экспорта объектов и оценки определений политик. Сначала мы расскажем, как установить расширение политики Azure в Visual Studio Code. Затем мы рассмотрим, как искать псевдонимы.

Расширение политики Azure для Visual Studio Code можно установить в Windows.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения действий, описанных в этой статье, необходимо следующее:

- Подписка Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/), прежде чем начинать работу.
- [Visual Studio Code](https://code.visualstudio.com).

## <a name="install-and-configure-the-azure-policy-extension"></a>Установка и настройка расширения политики Azure

После выполнения необходимых условий можно установить расширение политики Azure для Visual Studio Code, выполнив следующие действия.

1. Откройте Visual Studio Code.
1. В строке меню выберите **Просмотреть**  >  **расширения**.
1. В поле поиска введите " **Политика Azure**".
1. В результатах поиска выберите пункт **Политика Azure** и нажмите кнопку **установить**.
1. При необходимости выберите **Перезагрузить**.

Для пользователя национального облака выполните следующие действия, чтобы сначала настроить среду Azure:

1. Выберите **филе\преференцес\сеттингс**.
1. Выполните поиск по следующей строке: _Azure: Cloud_
1. Выберите облако для страны из списка:

   :::image type="content" source="../media/extension-for-vscode/set-default-azure-cloud-sign-in.png" alt-text="Снимок экрана: выбор страны для входа в облако Azure для Visual Studio Code." border="false":::

## <a name="using-the-policy-extension"></a>Использование расширения политики

> [!NOTE]
> Изменения, внесенные локально в политики, просмотренные в расширении политики Azure для Visual Studio Code, не синхронизируются с Azure.

### <a name="connect-to-an-azure-account"></a>Подключение к учетной записи Azure

Чтобы оценить ресурсы и псевдонимы поиска, необходимо подключиться к учетной записи Azure. Выполните следующие действия, чтобы подключиться к Azure из Visual Studio Code.

1. Войдите в Azure с помощью расширения политики Azure или палитры команд.

   - Расширение политики Azure

     В расширении политики Azure выберите вход в **Azure**.

     :::image type="content" source="../media/extension-for-vscode/azure-cloud-sign-in-policy-extension.png" alt-text="Снимок экрана Visual Studio Code и значок для расширения политики Azure." border="false":::

   - Палитра команд

     В строке меню выберите **вид**  >  **Палитра команд** и введите **Azure: вход**.

     :::image type="content" source="../media/extension-for-vscode/azure-cloud-sign-in-command-palette.png" alt-text="Снимок экрана параметров входа в облако Azure для Visual Studio Code из палитры команд." border="false":::

1. Следуйте инструкциям по входу, чтобы войти в Azure. После подключения имя учетной записи Azure отобразится в строке состояния в нижней части окна Visual Studio Code.

### <a name="select-subscriptions"></a>Выбор пункта "Подписки"

При первом входе в расширение политики Azure загружаются только ресурсы и политики подписки по умолчанию. Чтобы добавить или удалить подписки для отображения ресурсов и политик, выполните следующие действия.

1. Запустите команду Subscription из палитры команд или нижнего колонтитула окна.

   - Палитра команд:

     В строке меню выберите **вид** > **Палитра команд** и введите **Azure: выберите подписки**.

   - Нижний колонтитул окна

     В нижнем колонтитуле окна в нижней части экрана выберите сегмент, который соответствует **Azure: \<your account\>**.

1. Используйте поле фильтра для быстрого поиска подписок по имени. Затем проверьте или удалите проверку каждой подписки, чтобы задать подписки, отображаемые расширением политики Azure. По завершении добавления или удаления подписок для показа нажмите кнопку **ОК**.

### <a name="search-for-and-view-resources"></a>Поиск и просмотр ресурсов

Расширение политики Azure Перечисляет ресурсы в выбранных подписках по поставщику ресурсов и по группе ресурсов в области **ресурсы** . TreeView содержит следующие группы ресурсов в выбранной подписке или на уровне подписки.

- **Поставщики ресурсов**
  - Каждый зарегистрированный поставщик ресурсов с ресурсами и связанными дочерними ресурсами, имеющими псевдонимы политик
- **Группы ресурсов**
  - Все ресурсы по группе ресурсов, в которой они находятся

По умолчанию расширение фильтрует часть "поставщик ресурсов" по существующим ресурсам и ресурсам, имеющим псевдонимы политик. Измените это поведение в разделе " **Параметры**  >  **расширений**  >  **Azure** ", чтобы просмотреть все поставщики ресурсов без фильтрации.

Клиенты с сотнями или тысячами ресурсов в одной подписке могут предпочесть способ поиска своих ресурсов. Расширение политики Azure позволяет выполнять поиск определенного ресурса, выполнив следующие действия.

1. Запустите интерфейс поиска из расширения политики Azure или палитры команд.

   - Расширение политики Azure

     В расширении политики Azure наведите указатель мыши на панель **ресурсы** и щелкните многоточие, а затем выберите **Поиск ресурсов**.

   - Палитра команд:

     В строке меню выберите **вид** > **Палитра команд** и введите **ресурсы: Поиск ресурсов**.

1. Если для вывода выбрано более одной подписки, используйте фильтр, чтобы выбрать подписку для поиска.

1. Используйте фильтр, чтобы выбрать группу ресурсов для поиска, которая является частью ранее выбранной подписки.

1. Используйте фильтр, чтобы выбрать отображаемый ресурс. Фильтр работает как для имени ресурса, так и для типа ресурса.

### <a name="discover-aliases-for-resource-properties"></a>Обнаружение псевдонимов для свойств ресурсов

При выборе ресурса с помощью интерфейса поиска или при выборе его в TreeView расширение политики Azure открывает JSON-файл, представляющий этот ресурс, и все его Azure Resource Manager значения свойств.

После открытия ресурса при наведении указателя мыши на имя или значение свойства диспетчер ресурсов отображается псевдоним политики Azure, если он существует. В этом примере ресурс является `Microsoft.Compute/virtualMachines` типом ресурса, а свойство **Properties. StorageProfile. imageReference. предложение** наводится на него. При наведении указателя мыши отображаются совпадающие псевдонимы.

:::image type="content" source="../media/extension-for-vscode/extension-hover-shows-property-alias.png" alt-text="Снимок экрана расширения политики Azure для Visual Studio Code наведения указателя мыши на свойство для отображения имен псевдонимов." border="false":::

> [!NOTE]
> Расширение VS Code поддерживает только оценку свойств режима диспетчер ресурсов. Дополнительные сведения о режимах см. в разделе [определения режимов](../concepts/definition-structure.md#mode).

### <a name="search-for-and-view-policies-and-assignments"></a>Поиск и Просмотр политик и назначений

Расширение политики Azure перечисляет типы политик и назначения политик как TreeView для подписок, выбранных для отображения на панели **политики** . Клиенты с сотнями или тысячами политик или назначений в одной подписке могут предпочесть способ поиска их политик или назначений. Расширение политики Azure позволяет выполнять поиск конкретной политики или назначения, выполнив следующие действия.

1. Запустите интерфейс поиска из расширения политики Azure или палитры команд.

   - Расширение политики Azure

     В расширении политики Azure наведите указатель на панель **политики** и выберите многоточие, а затем выберите **политики поиска**.

   - Палитра команд:

     В строке меню выберите **вид** > **Палитра команд** и введите **политики: поиск политик**.

1. Если для вывода выбрано более одной подписки, используйте фильтр, чтобы выбрать подписку для поиска.

1. Используйте фильтр, чтобы выбрать тип или назначение политики для поиска, которые являются частью ранее выбранной подписки.

1. Используйте фильтр, чтобы выбрать политику или отображение. Фильтр работает с параметром _DisplayName_ для определения политики или назначения политики.

При выборе политики или назначения, будь то через интерфейс поиска или выбрав его в TreeView, расширение политики Azure открывает JSON, представляющий политику или назначение, а также все значения свойств диспетчер ресурсов. Расширение может проверить открытую схему JSON политики Azure.

### <a name="export-objects"></a>Экспорт объектов

Объекты из ваших подписок можно экспортировать в локальный файл JSON. На панели **ресурсы** или **политики** наведите указатель мыши на объект, который можно экспортировать. В конце выделенной строки щелкните значок Сохранить и выберите папку для сохранения этих ресурсов JSON.

Следующие объекты можно экспортировать локально:

- Область ресурсов
  - Группы ресурсов
  - Отдельные ресурсы (в группе ресурсов или в поставщике ресурсов);
- Панель "политики"
  - Назначения политик
  - Встроенные определения политик
  - Определения настраиваемых политик
  - Инициативы

### <a name="on-demand-evaluation-scan"></a>Проверка оценки по запросу

Оценочное сканирование можно запустить с помощью расширения политики Azure для Visual Studio Code. Чтобы начать оценку, выберите и закрепите каждый из следующих объектов: ресурс, определение политики и назначение политики.

1. Чтобы закрепить каждый объект, найдите его в области **ресурсы** или **политики** и выберите значок закрепить на вкладке Правка. Закрепление объекта добавляет его в область **оценки** расширения.
1. На панели **оценки** выберите один из объектов и используйте значок выбрать для оценки, чтобы пометить его как включаемый в вычисление.
1. В верхней части области **оценки** выберите значок запуск оценки. Откроется новая панель в Visual Studio Code с результирующими сведениями об оценке в форме JSON.

> [!NOTE]
> Для определения политики [помощью параметров auditifnotexists](../concepts/effects.md#auditifnotexists) или [DeployIfNotExists](../concepts/effects.md#deployifnotexists) используйте значок "плюс" на панели " **Оценка** ", чтобы выбрать _связанный_ ресурс для проверки существования.

Результаты оценки содержат сведения об определении политики и назначении политики вместе со свойством **полициевалуатионс. евалуатионресулт** . Вывод имеет следующий вид.

```json
{
    "policyEvaluations": [
        {
            "policyInfo": {
                ...
            },
            "evaluationResult": "Compliant",
            "effectDetails": {
                "policyEffect": "Audit",
                "existenceScope": "None"
            }
        }
    ]
}
```

> [!NOTE]
> Расширение VS Code поддерживает только оценку свойств режима диспетчер ресурсов. Дополнительные сведения о режимах см. в разделе [определения режимов](../concepts/definition-structure.md#mode).
>
> Функция оценки не работает в установках macOS и Linux расширения.

### <a name="sign-out"></a>Выйти

В строке меню выберите **Просмотреть**  >  **палитру команд**, а затем введите **Azure: выйти**.

## <a name="next-steps"></a>Дальнейшие действия

- Рассмотрите [примеры для службы "Политика Azure"](../samples/index.md).
- Изучите статью о [структуре определения Политики Azure](../concepts/definition-structure.md).
- Изучите [сведения о действии политик](../concepts/effects.md).
- Узнайте о [программном создании политик](programmatically-create.md).
- Узнайте, как [исправлять несоответствующие ресурсы](remediate-resources.md).
- Дополнительные сведения о группе управления см. в статье [Упорядочивание ресурсов с помощью групп управления Azure](../../management-groups/overview.md).
