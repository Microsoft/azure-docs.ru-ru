---
title: Справочник по базовым настройкам гостевой конфигурации для Linux в политике Azure
description: Сведения о базовом плане Linux в Azure, реализованном с помощью гостевой конфигурации политики Azure.
ms.date: 03/12/2021
ms.topic: reference
ms.custom: generated
ms.openlocfilehash: 6b1d3048fdc0945e1ee64e211d2f7b1f9de5e6e6
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "103419870"
---
# <a name="azure-policy-guest-configuration-baseline-for-linux"></a>Базовая конфигурация гостевой конфигурации политики Azure для Linux

В следующей статье подробно описаны **\[ требования к предварительной версии \] компьютеров Linux в соответствии с требованиями** аудита определения политики гостевой конфигурации Azure. Дополнительные сведения см. в статье [Конфигурация гостя политики Azure](../concepts/guest-configuration.md) и [Обзор производительности системы безопасности Azure (версия 2)](../../../security/benchmarks/overview.md).

## <a name="general-security-controls"></a>Общие элементы безопасности

|Имя<br /><sub>УДОСТОВЕРЕНИЯ</sub> |Сведения |Проверка исправления |
|---|---|---|
|Убедитесь, что параметр нодев установлен в разделе/Home.<br /><sub>1.1.4</sub> |Описание: злоумышленник может подключить специальное устройство (например, блок или устройство с символами) к разделу/Home. |Измените файл/etc/fstab и нодев четвертое поле (параметры подключения) для раздела/Home. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Убедитесь, что параметр нодев установлен в разделе/tmp.<br /><sub>1.1.5</sub> |Описание: злоумышленник может подключить специальное устройство (например, блок или устройство с символами) к разделу/tmp. |Измените файл/etc/fstab и нодев четвертое поле (параметры подключения) для раздела/tmp. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Убедитесь, что параметр нодев установлен в разделе/Вар/ТМП.<br /><sub>1.1.6</sub> |Описание: злоумышленник может подключить специальное устройство (например, блок или устройство с символами) к разделу/Вар/ТМП. |Измените файл/etc/fstab и нодев четвертое поле (параметры подключения) для раздела/Вар/ТМП. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Убедитесь, что параметр носуид установлен в разделе/tmp.<br /><sub>1.1.7</sub> |Описание: поскольку файловая система/tmp предназначена только для хранения временных файлов, установите этот параметр, чтобы пользователи не могли создавать файлы setuid в/Вар/ТМП. |Измените файл/etc/fstab и носуид четвертое поле (параметры подключения) для раздела/tmp. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Убедитесь, что параметр носуид установлен в разделе/Вар/ТМП.<br /><sub>1.1.8</sub> |Описание: поскольку файловая система/Вар/ТМП предназначена только для хранения временных файлов, установите этот параметр, чтобы пользователи не могли создавать файлы setuid в/Вар/ТМП. |Измените файл/etc/fstab и носуид четвертое поле (параметры подключения) для раздела/Вар/ТМП. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Убедитесь, что параметр Exec задан для секции/Вар/ТМП.<br /><sub>1.1.9</sub> |Описание: поскольку `/var/tmp` Файловая система предназначена только для хранения временных файлов, установите этот параметр, чтобы пользователи не могли запускать исполняемые двоичные файлы из `/var/tmp` . |Измените файл/etc/fstab и добавьте в четвертое поле (параметры подключения) для секции/Вар/ТМП значение Exec. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Убедитесь, что параметр Exec задан для секции/Дев/ШМ.<br /><sub>(1.1.16)</sub> |Описание: Установка этого параметра в файловой системе запрещает пользователям запускать программы из общей памяти. Это позволяет предотвратить проникновение пользователями потенциально вредоносных программ в систему. |Измените файл/etc/fstab и добавьте в четвертое поле (параметры подключения) для секции/Дев/ШМ значение Exec. Дополнительные сведения см. на страницах fstab (5) вручную. |
|Отключить Автоподключение<br /><sub>(1.1.21)</sub> |Описание. при включении автоподключения любой пользователь с физическим доступом может подключить USB-накопитель или диск и получить доступ к его содержимому в системе даже в том случае, если у них отсутствуют разрешения на их подключение. |Отключите службу autofs или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-autofs" |
|Убедитесь, что подключение USB-устройств хранения отключено.<br /><sub>(1.1.21.1)</sub> |Описание. Удаление поддержки USB-устройств хранения сокращает область локальной атаки сервера. |Измените или создайте файл в каталоге, который `/etc/modprobe.d/` заканчивается на. conf, а `install usb-storage /bin/true` затем добавьте, а затем выгрузите модуль USB-Storage или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Убедитесь, что основной дамп памяти ограничен.<br /><sub>1.5.1</sub> |Описание: Установка жесткого ограничения на дампы ядра не позволяет пользователям переопределять переменную Soft. Если требуются дампы ядра, рассмотрите возможность установки ограничений для групп пользователей (см `limits.conf(5)` . раздел). Кроме того, присвоение `fs.suid_dumpable` переменной значения 0 предотвратит создание дампов ядра программами setuid. |Добавьте в `hard core 0` /etc/security/limits.conf. или файл в каталоге limits. d и задайте `fs.suid_dumpable = 0` в сисктл или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-Core-дампы". |
|Убедитесь, что предкомпоновка отключена.<br /><sub>(1.5.4)</sub> |Описание: функция предкомпоновки может мешать работе ТЕЛЕМЕТРИЧЕСКУЮ, так как она изменяет двоичные файлы. Также можно повысить уязвимость системы, если злонамеренный пользователь может нарушить общую библиотеку, например libc. |Удалите `prelink` с помощью диспетчера пакетов или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Remove-Link" |
|Убедитесь, что настроены разрешения для/ЕТК/МОТД.<br /><sub>(1.7.1.4)</sub> |Описание: Если `/etc/motd` файл не имеет нужного владельца, он может быть изменен неавторизованными пользователями с неправильными или неверными сведениями. |Задайте для владельца и группы/ЕТК/МОТД значение root и задайте для параметра Permissions значения 0644 или выполните '/ОПТ/Микрософт/омсажент/плугин/омсремедиате-r File-Permissions '. |
|Убедитесь, что настроены разрешения для/ЕТК/Иссуе.<br /><sub>(1.7.1.5)</sub> |Описание: Если `/etc/issue` файл не имеет нужного владельца, он может быть изменен неавторизованными пользователями с неправильными или неверными сведениями. |Задайте для владельца и группы/ЕТК/Иссуе значение root и задайте для параметра Permissions значения 0644 или выполните '/ОПТ/Микрософт/омсажент/плугин/омсремедиате-r File-Permissions '. |
|Убедитесь, что настроены разрешения для/ЕТК/Иссуе.нет.<br /><sub>(1.7.1.6)</sub> |Описание: Если `/etc/issue.net` файл не имеет нужного владельца, он может быть изменен неавторизованными пользователями с неправильными или неверными сведениями. |Задайте для владельца и группы/ЕТК/Иссуе.нет значение root и задайте для параметра Permissions значения 0644 или выполните '/ОПТ/Микрософт/омсажент/плугин/омсремедиате-r File-Permissions '. |
|Параметр нодев должен быть включен для всех съемных носителей.<br /><sub>(2,1)</sub> |Описание: злоумышленник может подключить специальное устройство (например, блок или устройство с символами) через съемный носитель. |Добавьте параметр нодев в четвертое поле (параметры подключения) в/etc/fstab |
|Параметр Exec должен быть включен для всех съемных носителей.<br /><sub>(2,2)</sub> |Описание: злоумышленник может загрузить исполняемый файл через съемный носитель. |Добавление параметра Exec в четвертое поле (параметры подключения) в/etc/fstab |
|Параметр носуид должен быть включен для всех съемных носителей.<br /><sub>(2,3)</sub> |Описание: злоумышленник может загружать файлы, работающие в контексте безопасности с повышенными правами, через съемный носитель. |Добавьте параметр носуид в четвертое поле (параметры подключения) в/etc/fstab |
|Убедитесь, что клиент разговора не установлен.<br /><sub>2.3.3</sub> |Описание: программное обеспечение представляет угрозу безопасности, так как использует незашифрованные протоколы для обмена данными. |Удалите `talk`  или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Remove-разговора" |
|Убедитесь, что настроены разрешения для/ЕТК/хостс.аллов.<br /><sub>3.4.4</sub> |Описание. важно убедиться, что `/etc/hosts.allow` файл защищен от несанкционированного доступа на запись. Хотя это и защищено по умолчанию, разрешения на доступ к файлам можно изменить либо случайно, либо с помощью вредоносных действий. |Задайте для владельца и группы/ЕТК/хостс.аллов значение root и разрешения для 0644 или выполните '/ОПТ/Микрософт/омсажент/плугин/омсремедиате-r File-Permissions '. |
|Убедитесь, что настроены разрешения для/ЕТК/хостс.Дени.<br /><sub>(3.4.5)</sub> |Описание. важно убедиться, что `/etc/hosts.deny` файл защищен от несанкционированного доступа на запись. Хотя это и защищено по умолчанию, разрешения на доступ к файлам можно изменить либо случайно, либо с помощью вредоносных действий. |Задайте для владельца и группы/ЕТК/хостс.Дени значение root и разрешения для 0644 или выполните '/ОПТ/Микрософт/омсажент/плугин/омсремедиате-r File-Permissions '. |
|Убедитесь, что политика брандмауэра по умолчанию запрещена<br /><sub>3.6.2</sub> |Описание: с политикой принятия по умолчанию брандмауэр принимает любой пакет, который не настроен для запрета. Проще поддерживать безопасный брандмауэр с политикой удаления по умолчанию, чем политика разрешения по умолчанию. |Задайте политику по умолчанию для входящего, исходящего и маршрутизируемого трафика `deny` `reject` с помощью программного обеспечения брандмауэра. |
|Параметр нодев/носуид должен быть включен для всех подключений NFS.<br /><sub>(5)</sub> |Описание: злоумышленник может загружать файлы, работающие с повышенным контекстом безопасности или специальными устройствами через удаленную файловую систему. |Добавьте параметры носуид и нодев в четвертое поле (параметры подключения) в/etc/fstab. |
|Убедитесь, что настроены требования для создания пароля.<br /><sub>(5.3.1)</sub> |Описание. надежные пароли защищают системы от атак методом подбора. |Задайте следующие пары "ключ-значение" в соответствующем PAM для дистрибутив: минлен = 14, минкласс = 4, дкредит =-1, укредит =-1, окредит =-1, лкредит =-1 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r enable-password-требований". |
|Убедитесь, что настроена блокировка для неудачных попыток ввода пароля.<br /><sub>(5.3.2)</sub> |Описание. Блокировка идентификаторов пользователей после `n` неудачных попыток входа в систему снижает риск атак методом подбора пароля для систем. |для Ubuntu и Debian добавьте необходимые модули pam_tally и pam_deny. Все остальные дистрибутивов см. в документации по дистрибутив. |
|Отключение установки и использования файловых систем, которые не требуются (крамфс)<br /><sub>(6,1)</sub> |Описание: злоумышленник может использовать уязвимость в крамфс для повышения привилегий. |Добавьте файл в каталог/ЕТК/модпроб.д, который отключает крамфс, или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Отключение установки и использования файловых систем, которые не требуются (фривксфс)<br /><sub>(6,2)</sub> |Описание: злоумышленник может использовать уязвимость в фривксфс для повышения привилегий. |Добавьте файл в каталог/ЕТК/модпроб.д, который отключает фривксфс, или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Убедитесь, что существуют домашние каталоги всех пользователей<br /><sub>(6.2.7)</sub> |Описание: Если корневой каталог пользователя не существует или не назначен, пользователь будет помещен в "/" и не сможет записать какие-либо файлы или задать локальные переменные среды. |Если ни один из домашних каталогов пользователей не существует, создайте их и убедитесь, что соответствующий пользователь владеет каталогом. Пользователи, не имеющие назначенного домашнего каталога, должны быть удалены или назначены домашнему каталогу. |
|Обеспечьте, чтобы пользователи владеют своими домашними каталогами<br /><sub>(6.2.9)</sub> |Описание: так как пользователь учитывает файлы, хранящиеся в домашнем каталоге пользователя, пользователь должен быть владельцем каталога. |Изменение владельца любых домашних каталогов, которые не принадлежат определенному пользователю, соответствующему пользователю. |
|Убедитесь, что файлы с точками пользователей не являются групповыми или доступными для записи в мир.<br /><sub>(6.2.10)</sub> |Описание: группы или файлы пользовательской конфигурации, доступные для записи в мир, могут позволить злоумышленникам украсть или изменить данные других пользователей или получить права доступа другого пользователя. |Внесение глобальных изменений в файлы пользователей без предупреждения сообщества пользователей может привести к непредвиденным простоям и недовольным пользователям. Поэтому рекомендуется установить политику мониторинга для передачи разрешений на файловую точку пользователя и определить действие, выполняемое в соответствии с политикой сайта. |
|Запретить пользователям пересылать файлы<br /><sub>(6.2.11)</sub> |Описание: использование `.forward` файла представляет угрозу безопасности в том, что конфиденциальные данные могут случайно передаваться за пределы организации. `.forward`Файл также создает риск, так как он может использоваться для выполнения команд, которые могут выполнять нежелательные действия. |Внесение глобальных изменений в файлы пользователей без предупреждения сообщества пользователей может привести к непредвиденным простоям и недовольным пользователям. Поэтому рекомендуется установить политику мониторинга для получения отчетов о `.forward` файлах пользователей и определить, какое действие следует предпринять в соответствии с политикой сайта. |
|Убедитесь, что у пользователей нет файлов. нетрк<br /><sub>(6.2.12)</sub> |Описание. `.netrc` файл представляет серьезную угрозу безопасности, так как хранит пароли в незашифрованном виде. Даже если протокол FTP отключен, учетные записи пользователей могли перехватить `.netrc` файлы из других систем, что может представлять риск для этих систем. |Внесение глобальных изменений в файлы пользователей без предупреждения сообщества пользователей может привести к непредвиденным простоям и недовольным пользователям. Поэтому рекомендуется установить политику мониторинга для получения отчетов о `.netrc` файлах пользователей и определить, какое действие следует предпринять в соответствии с политикой сайта. |
|Убедитесь, что у пользователей нет файлов. rhosts<br /><sub>(6.2.14)</sub> |Описание. это действие имеет смысл, только если `.rhosts` в файле разрешена поддержка `/etc/pam.conf` . Несмотря на то, что эти `.rhosts` файлы неэффективны, если поддержка отключена в `/etc/pam.conf` , они могли быть переведены из других систем и могли бы содержать информацию, полезную для злоумышленников для этих систем. |Внесение глобальных изменений в файлы пользователей без предупреждения сообщества пользователей может привести к непредвиденным простоям и недовольным пользователям. Поэтому рекомендуется установить политику мониторинга для получения отчетов о `.rhosts` файлах пользователей и определить, какое действие следует предпринять в соответствии с политикой сайта. |
|Убедитесь, что все группы в/etc/passwd существуют в/ЕТК/грауп<br /><sub>(6.2.15)</sub> |Описание: группы, определенные в файле/etc/passwd, но не в файле/ЕТК/грауп, являются угрозой безопасности системы, так как разрешения группы не управляются надлежащим образом. |Убедитесь, что для каждой группы, определенной в/etc/passwd, имеется соответствующая группа в/ЕТК/грауп |
|Не проверять наличие повторяющихся идентификаторов UID<br /><sub>(6.2.16)</sub> |Описание: пользователям необходимо назначить уникальные идентификаторы UID для обеспечения отчетности и обеспечить соответствующие средства защиты доступа. |Установите уникальные идентификаторы UID и проверьте все файлы, принадлежащие общим ИД пользователей, чтобы определить, к какому UID они относятся. |
|Убедитесь, что дублирующиеся GUID не существуют<br /><sub>(6.2.17)</sub> |Описание: группам должны быть назначены уникальные GUID для учета и обеспечения соответствующей защиты доступа. |Установите уникальные GUID и проверьте все файлы, принадлежащие общей GUID, чтобы определить, к какому именно GID они принадлежат. |
|Не проверять существование повторяющихся имен пользователей<br /><sub>(6.2.18)</sub> |Описание: Если пользователю присвоено повторяющееся имя пользователя, он создаст и будет иметь доступ к файлам с первым UID для этого имени пользователя в `/etc/passwd` . Например, если у "test4" есть UID 1000, а в следующей записи "test4" есть идентификатор 2000, то вход в качестве "test4" будет использовать UID 1000. Фактически идентификатор UID является общим, что является проблемой безопасности. |Установите уникальные имена пользователей. Владение файлами автоматически отражает изменение, если у пользователей есть уникальные идентификаторы UID. |
|Не проверять существование повторяющихся групп<br /><sub>(6.2.19)</sub> |Описание: Если группе назначено повторяющееся имя группы, она создаст и будет иметь доступ к файлам с первым GID для этой группы в `/etc/group` . Фактически, GID является общим, что является проблемой безопасности. |Установите уникальные имена для групп пользователей. Права владения группой файлов будут автоматически отражать изменение, если у групп есть уникальные GUID. |
|Убедитесь, что теневая группа пуста<br /><sub>(6.2.20)</sub> |Описание. всем пользователям, которым назначена теневая группа, будет предоставлен доступ на чтение файла/etc/shadow. Если злоумышленники могут получить доступ к файлу для чтения `/etc/shadow` , они смогут легко запустить программу взлома пароля в соответствии с хэшированными паролями, чтобы их можно было разорвать. Другие сведения о безопасности, хранящиеся в `/etc/shadow` файле (например, срок действия), также могут быть полезны для обходят дополнительных учетных записей пользователей. |Удаление всех пользователей, образующих группу теневых копий |
|Отключение установки и использования файловых систем, которые не требуются (HFS)<br /><sub>(6,3)</sub> |Описание: злоумышленник может использовать уязвимость в HFS для повышения привилегий. |Добавьте файл в каталог/ЕТК/модпроб.д, который отключает HFS, или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Отключение установки и использования файловых систем, которые не требуются (хфсплус)<br /><sub>(6,4)</sub> |Описание: злоумышленник может использовать уязвимость в хфсплус для повышения привилегий. |Добавьте файл в каталог/ЕТК/модпроб.д, который отключает хфсплус, или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Отключение установки и использования файловых систем, которые не требуются (JFFS2)<br /><sub>(6,5)</sub> |Описание: злоумышленник может использовать уязвимость в JFFS2 для повышения привилегий. |Добавьте файл в каталог/ЕТК/модпроб.д, который отключает JFFS2, или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Ядра должны быть скомпилированы только из утвержденных источников.<br /><sub>штук</sub> |Описание: ядро из неутвержденного источника может содержать уязвимости или подвижные стороны для предоставления доступа злоумышленнику. |Установите ядро, предоставляемое поставщиком дистрибутив. |
|для разрешений файла/etc/shadow должно быть задано значение 0400<br /><sub>(11,1)</sub> |Описание: злоумышленник, который может получить или манипулировать хэшированными паролями из/etc/shadow, если он не защищен надлежащим образом. |Задайте разрешения и владение/etc/shadow * или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-shadow-Permissions". |
|для разрешений файла/ЕТК/Шадов-должно быть задано значение 0400<br /><sub>(11,2)</sub> |Описание: злоумышленник, который может получить или манипулировать хэшированными паролями из/ЕТК/Шадов-, если он не защищен надлежащим образом. |Задайте разрешения и владение/etc/shadow * или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-shadow-Permissions". |
|для разрешений файла/ЕТК/гшадов должно быть задано значение 0400<br /><sub>(11,3)</sub> |Описание: злоумышленник может присоединиться к группам безопасности, если этот файл не защищен должным образом |Задайте разрешения и владение/ЕТК/гшадов-или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-гшадов-Permissions". |
|для разрешений файла/ЕТК/гшадов-должно быть задано значение 0400<br /><sub>(11,4)</sub> |Описание: злоумышленник может присоединиться к группам безопасности, если этот файл не защищен должным образом |Задайте разрешения и владение/ЕТК/гшадов или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-гшадов-Permissions". |
|разрешения для файла/etc/passwd должны быть 0644<br /><sub>(12,1)</sub> |Описание: злоумышленник может изменить userID и оболочки входа |Задайте разрешения и владение/etc/passwd или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-passwd-Permissions". |
|разрешения для файла/ЕТК/грауп должны быть 0644<br /><sub>(12,2)</sub> |Описание: злоумышленник может повысить привилегии, изменив членство в группе. |Задайте разрешения и владение/ЕТК/грауп или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-group-Permissions". |
|для разрешений файла/ЕТК/пассвд-должно быть задано значение 0600<br /><sub>(12,3)</sub> |Описание: злоумышленник может присоединиться к группам безопасности, если этот файл не защищен должным образом |Задайте разрешения и владение/ЕТК/пассвд-или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-passwd-Permissions". |
|разрешения для файла/ЕТК/грауп-должны быть 0644<br /><sub>(12,4)</sub> |Описание: злоумышленник может повысить привилегии, изменив членство в группе. |Задайте разрешения и владение/ЕТК/грауп-или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-etc-group-Permissions". |
|Доступ к учетной записи root через SU должен быть ограничен корневой группой<br /><sub>открыт</sub> |Описание: злоумышленник может эскалировать разрешения путем подбора пароля, если SU не ограничен пользователями корневой группы. |Выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-SU-Permissions". Это добавит строку "требуется проверка подлинности pam_wheel. Поэтому use_uid" в файл "/ЕТК/пам.д/Су" |
|Группа "root" должна существовать и содержать все члены, которые могут иметь корень от SU к root<br /><sub>максималь</sub> |Описание: злоумышленник может эскалировать разрешения путем подбора пароля, если SU не ограничен пользователями корневой группы. |Создайте корневую группу с помощью команды "groupadd-g 0 root" |
|Нет учетных записей без паролей<br /><sub>(23,2)</sub> |Описание: злоумышленник может войти в учетную запись без пароля и выполнить произвольные команды. |Использование команды passwd для установки паролей для всех учетных записей |
|Учетные записи, отличные от root, должны иметь уникальные идентификаторы UID больше нуля (0)<br /><sub>круглосуточно</sub> |Описание: Если учетная запись, отличная от root, имеет нулевой UID, злоумышленник может нарушить безопасность учетной записи и получить привилегии root. |Назначьте уникальные ненулевые идентификаторы UID всем учетным записям, не являющимся корневыми, с помощью "usermod-u" |
|Необходимо включить случайное размещение областей виртуальной памяти<br /><sub>размером</sub> |Описание: злоумышленник может записать исполняемый код в известные регионы в памяти, что приведет к несанкционированному повышению привилегий |Добавьте значение "1" или "2" в файл "/прок/СИС/Кернел/randomize_va_space" |
|Должна быть включена поддержка ядра для процессора XD/NX<br /><sub>26</sub> |Описание: злоумышленник может заставить систему выполнять исполняемый код из областей данных в памяти, что приводит к повышению привилегий. |Убедитесь, что файл "/прок/кпуинфо" содержит флаг "NX" |
|"." Не должен отображаться в корневой $PATH<br /><sub>(27,1)</sub> |Описание: злоумышленник может повысить привилегии, поместив вредоносный файл в корневую $PATH |Изменение строки "export PATH =" в/Рут/.профиле |
|Корневые каталоги пользователей должны быть в режиме 750 или более<br /><sub>8</sub> |Описание: злоумышленник может получить конфиденциальную информацию из домашних папок других пользователей. |Задайте для разрешений домашней папки значение 750 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-Home-dir-Permissions". |
|По умолчанию umask для всех пользователей должно быть установлено значение 077 в поле Login. дефс<br /><sub>29</sub> |Описание: злоумышленник может получить конфиденциальную информацию из файлов, принадлежащих другим пользователям. |Выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-Default-User-umask". Это добавит строку "UMASK 077" в файл "/ЕТК/логин.дефс" |
|Для всех загрузчиков должна быть включена защита паролем.<br /><sub>1-31</sub> |Описание: злоумышленник с физическим доступом может изменить параметры загрузчика, выдавая неограниченный доступ к системе. |Добавить пароль загрузчика в файл "/Бут/груб/груб.КФГ" |
|Убедитесь, что настроены разрешения для конфигурации загрузчика<br /><sub>(31,1)</sub> |Описание: Установка разрешений на чтение и запись для корневого каталога позволяет не только пользователям, не являющимся корневыми, видеть параметры загрузки или изменять их. Пользователи, не являющиеся корневыми пользователями, которые считывают параметры загрузки, могут определять слабые места в системе безопасности при загрузке и использовать их. |Задайте для владельца и группы загрузчика корневую папку, а также разрешения на 0400 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r загрузчик-Permissions". |
|Убедитесь, что проверка подлинности необходима для однопользовательского режима.<br /><sub>(33)</sub> |Описание. Обязательная проверка подлинности в однопользовательском режиме не позволяет неавторизованному пользователю перезагружать систему в единый пользователь для получения привилегий root без учетных данных. |выполните следующую команду, чтобы задать пароль для привилегированного пользователя: `passwd root` |
|Убедитесь, что отправка перенаправления пакетов отключена.<br /><sub>(38,3)</sub> |Описание: злоумышленник может использовать скомпрометированный узел для отправки недопустимых перенаправлений ICMP другим устройствам маршрутизатора при попытке повредить маршрутизацию и получить доступ пользователей к системе, настроенной злоумышленником, в отличие от действительной системы. |Задайте следующие параметры в/ЕТК/сисктл.конф: "net.ipv4.conf.all.send_redirects = 0" и "net.ipv4.conf.default.send_redirects = 0" или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-Send-redirects |
|Отправка перенаправлений ICMP должна быть отключена для всех интерфейсов. (net.ipv4.conf.default.accept_redirects = 0)<br /><sub>(38,4)</sub> |Описание: злоумышленник может изменить таблицу маршрутизации этой системы, перенаправляя трафик в другое место назначения. |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-Accept-redirects". |
|Отправка перенаправлений ICMP должна быть отключена для всех интерфейсов. (net.ipv4.conf.default.secure_redirects = 0)<br /><sub>(38,5)</sub> |Описание: злоумышленник может изменить таблицу маршрутизации этой системы, перенаправляя трафик в другое место назначения. |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-безопасное-redirects" |
|Прием перенаправленных пакетов должен быть отключен для всех интерфейсов. (net.ipv4.conf.all.accept_source_route = 0)<br /><sub>(40,1)</sub> |Описание: злоумышленник может перенаправить трафик для вредоносных целей. |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-Accept-Source-Route" |
|Прием перенаправленных пакетов должен быть отключен для всех интерфейсов. (net.ipv6.conf.all.accept_source_route = 0) или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-Accept-Source-Route"<br /><sub>(40,2)</sub> |Описание: злоумышленник может перенаправить трафик для вредоносных целей. |Запустите `sysctl -w key=value` и задайте соответствующее значение. |
|Игнорирование исдельных ответов ICMP для широковещательных рассылок должно быть включено. (net.ipv4.icmp_ignore_bogus_error_responses = 1)<br /><sub>(43)</sub> |Описание: злоумышленник может выполнить атаку ICMP, что в DoS |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-ICMP-Ignore-un-un-Responses/Errors" |
|Игнорирование эхо-запросов ICMP (ping) для широковещательных или многоадресных адресов должно быть включено. (net.ipv4.icmp_echo_ignore_broadcasts = 1)<br /><sub>(44)</sub> |Описание: злоумышленник может выполнить атаку ICMP, что в DoS |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-ICMP-эхо-Ignore-вещания". |
|Ведение журнала пакетов Мартиан (с невозможными адресами) должно быть включено для всех интерфейсов. (net.ipv4.conf.all.log_martians = 1)<br /><sub>(45,1)</sub> |Описание: злоумышленник может отправить трафик от подложных адресов, не выполняя обнаружение |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-log-мартианс". |
|Проверка исходного кода по пути должна быть включена для всех интерфейсов. (net.ipv4.conf.all.rp_filter = 1)<br /><sub>(46,1)</sub> |Описание. система будет принимать трафик с ненаправляемых адресов. |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-RP-Filter". |
|Проверка исходного кода по пути должна быть включена для всех интерфейсов. (net.ipv4.conf.default.rp_filter = 1)<br /><sub>(46,2)</sub> |Описание. система будет принимать трафик с ненаправляемых адресов. |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-RP-Filter". |
|Необходимо включить TCP-синкукиес. (net.ipv4.tcp_syncookies = 1)<br /><sub>(47)</sub> |Описание: злоумышленник может выполнить DoS через TCP |Выполните команду `sysctl -w key=value` и задайте соответствующее значение или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-TCP-синкукиес". |
|Система не должна работать в качестве средства прослушивания сети.<br /><sub>(48)</sub> |Описание: злоумышленник может использовать неизбирательные интерфейсы для прослушивания сетевого трафика. |Неизбирательный режим включен с помощью записи "with" в "/ЕТК/Нетворк/интерфацес" или "/ЕТК/РК.локал." Проверьте оба файла и удалите эту запись. |
|Все беспроводные интерфейсы должны быть отключены.<br /><sub>(49)</sub> |Описание: злоумышленник может создать фальшивый ТД для перехвата передач. |Подтвердите, что все беспроводные интерфейсы отключены в "/ЕТК/Нетворк/интерфацес" |
|Протокол IPv6 должен быть включен.<br /><sub>(50)</sub> |Описание. это необходимо для обмена данными в современных сетях. |Откройте/ЕТК/сисктл.конф и убедитесь, что для "net.ipv6.conf.all.disable_ipv6" и "net.ipv6.conf.default.disable_ipv6" задано значение 0. |
|Убедитесь, что ДККП отключен<br /><sub>(54)</sub> |Описание: Если протокол не является обязательным, рекомендуется не устанавливать драйверы, чтобы уменьшить потенциальную угрозу для атак. |Измените или создайте файл в каталоге, который `/etc/modprobe.d/` заканчивается на. conf, и добавьте `install dccp /bin/true` затем выгрузите модуль дккп или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Убедитесь, что SCTP отключен<br /><sub>(55)</sub> |Описание: Если протокол не является обязательным, рекомендуется не устанавливать драйверы, чтобы уменьшить потенциальную угрозу для атак. |Измените или создайте файл в каталоге, который `/etc/modprobe.d/` заканчивается на. conf, и добавьте `install sctp /bin/true` затем выгрузите модуль SCTP или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Отключите поддержку RDS.<br /><sub>(56)</sub> |Описание: злоумышленник может использовать уязвимость в RDS для компрометации системы |Измените или создайте файл в каталоге, который `/etc/modprobe.d/` заканчивается на. conf, а `install rds /bin/true` затем добавьте, а затем выгрузите модуль RDS или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Убедитесь, что ТИПК отключен<br /><sub>(57)</sub> |Описание: Если протокол не является обязательным, рекомендуется не устанавливать драйверы, чтобы уменьшить потенциальную угрозу для атак. |Измените или создайте файл в каталоге, который `/etc/modprobe.d/` заканчивается на. conf, и добавьте `install tipc /bin/true` затем выгрузите модуль ТИПК или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-необязательный-kernel-МОДС". |
|Убедитесь, что ведение журнала настроено<br /><sub>(60)</sub> |Описание. Значительная часть важных сведений, связанных с безопасностью, отправляется через `rsyslog` (например, успешных и неудачных попыток, неудачных попыток входа, попыток входа с правами root и т. д.). |Настройте syslog, rsyslog или syslog-ng соответствующим образом. |
|Должен быть установлен пакет syslog, rsyslog или syslog-ng.<br /><sub>(61)</sub> |Описание. проблемы с надежностью и безопасностью не будут регистрироваться, что предотвращает правильную диагностику. |Установите пакет rsyslog или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Install-rsyslog". |
|Проверка включения службы ведения журналов<br /><sub>(62)</sub> |Описание: необходимо иметь возможность регистрировать события на узле. |Включите пакет rsyslog или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Enable-rsyslog". |
|Разрешения файла для всех файлов журнала rsyslog должны быть установлены в 640 или 600.<br /><sub>(63)</sub> |Описание: злоумышленник может закрывать действия, управляя журналами. |Добавьте строку "$FileCreateMode 0640" в файл "/ЕТК/рсислог.конф" |
|Убедитесь, что файлы конфигурации средства ведения журнала ограничены.<br /><sub>(63,1)</sub> |Описание. важно убедиться, что файлы журнала существуют и имеют правильные разрешения, чтобы обеспечить архивирование и защиту конфиденциальных данных syslog. |Задайте для файлов конфигурации средства ведения журнала значение 0640 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Logger-config-file-Permissions". |
|Все файлы журнала rsyslog должны принадлежать группе ADM.<br /><sub>(64)</sub> |Описание: злоумышленник может закрывать действия, управляя журналами. |Добавьте строку "$FileGroup ADM" в файл "/ЕТК/рсислог.конф" |
|Все файлы журналов rsyslog должны принадлежать пользователю системного журнала.<br /><sub>(65)</sub> |Описание: злоумышленник может закрывать действия, управляя журналами. |Добавьте строку "$FileOwner syslog" в файл "/ЕТК/рсислог.конф" или запустите "/опт/Микрософт/омсажент/плугин/омсремедиате-r syslog-Owner |
|Rsyslog не должен принимать удаленные сообщения.<br /><sub>(67)</sub> |Описание: злоумышленник может внедрять сообщения в системный журнал, вызывая DoS или отвлекаться от других действий. |Удалите строки "$ModLoad имудп" и "$ModLoad имткп" из файла "/ЕТК/рсислог.конф" |
|Должна быть включена служба logrotate (повернутый системный журнал).<br /><sub>(68)</sub> |Описание: файлы журнала могут стать неограниченными и потреблять все дисковое пространство |Установите пакет logrotate и убедитесь, что запись logrotate cron активна (chmod 755/ЕТК/крон.Даили/логротате; човн root: root/ЕТК/крон.Даили/логротате) |
|Служба rlogin должна быть отключена.<br /><sub>(69)</sub> |Описание: злоумышленник может получить доступ, обходя требования к строгим проверкам подлинности |Удалите службу инетд. |
|Отключите инетд, если это не требуется. (инетд)<br /><sub>(70,1)</sub> |Описание: злоумышленник может воспользоваться уязвимостью в службе инетд, чтобы получить доступ к |Удаление службы инетд (APT-GET Remove инетд) |
|Отключите ксинетд, если это не требуется. (ксинетд)<br /><sub>(70,2)</sub> |Описание: злоумышленник может воспользоваться уязвимостью в службе ксинетд, чтобы получить доступ к |Удаление службы инетд (APT-GET Remove ксинетд) |
|Установите инетд, только если это уместно и требуется для вашего дистрибутив. Безопасность в соответствии с текущими стандартами усиления защиты. (при необходимости)<br /><sub>(71,1)</sub> |Описание: злоумышленник может воспользоваться уязвимостью в службе инетд, чтобы получить доступ к |Удаление службы инетд (APT-GET Remove инетд) |
|Установите ксинетд, только если это уместно и требуется для вашего дистрибутив. Безопасность в соответствии с текущими стандартами усиления защиты. (при необходимости)<br /><sub>(71,2)</sub> |Описание: злоумышленник может воспользоваться уязвимостью в службе ксинетд, чтобы получить доступ к |Удаление службы инетд (APT-GET Remove ксинетд) |
|Служба Telnet должна быть отключена.<br /><sub>(72)</sub> |Описание: злоумышленник может еавесдроп или захватывать незашифрованные сеансы Telnet |Удалить или закомментировать запись Telnet в файле "/ЕТК/инетд.конф" |
|Все пакеты Telnet должны быть удалены.<br /><sub>(73)</sub> |Описание: злоумышленник может еавесдроп или захватывать незашифрованные сеансы Telnet |Удаление всех пакетов Telnet |
|Служба RCP/rsh должна быть отключена.<br /><sub>(74)</sub> |Описание: злоумышленник может еавесдроп или захватывать незашифрованные сеансы. |Удалите или закомментируйте запись оболочки в файле "/ЕТК/инетд.конф" |
|Необходимо удалить пакет rsh-сервера.<br /><sub>(77)</sub> |Описание: злоумышленник может еавесдроп или захватывать незашифрованные сеансы rsh. |Удаление пакета rsh-сервера (APT-GET, Remove rsh-Server) |
|Служба ипбинд должна быть отключена.<br /><sub>(78)</sub> |Описание: злоумышленник может получить конфиденциальную информацию от службы ипбинд. |Удаление пакета NIS (APT-Remove NIS) |
|Необходимо удалить пакет NIS.<br /><sub>(79)</sub> |Описание: злоумышленник может получить конфиденциальную информацию из службы NIS. |Удаление пакета NIS (APT-Remove NIS) |
|Служба TFTP должна быть отключена.<br /><sub>(80)</sub> |Описание: злоумышленник может еавесдроп или перехватить незашифрованный сеанс. |Удаление записи TFTP из файла "/ЕТК/инетд.конф" |
|Пакет TFTP должен быть удален.<br /><sub>(81)</sub> |Описание: злоумышленник может еавесдроп или перехватить незашифрованный сеанс. |Удаление TFTP-пакета (APT — удаление tftpd) |
|Необходимо удалить пакет упреждающего чтения-Fedora.<br /><sub>(82)</sub> |Описание: не существенная экспозиция, но не существенное преимущество |Удаление пакета упреждающего чтения-Fedora (APT-GET Remove упреждающего чтения-Fedora) |
|Служба Bluetooth/хидд должна быть отключена.<br /><sub>(84)</sub> |Описание: злоумышленник может перехватить или управлять беспроводной связью. |Удаление пакета Bluetooth (APT-GET Remove Bluetooth) |
|Служба ISDN должна быть отключена.<br /><sub>(86)</sub> |Описание: злоумышленник может использовать модем для получения несанкционированного доступа |Удаление исднутилс-Base пакета (APT-GET Remove исднутилс-Base) |
|Необходимо удалить пакет исднутилс-Base.<br /><sub>(87)</sub> |Описание: злоумышленник может использовать модем для получения несанкционированного доступа |Удаление исднутилс-Base пакета (APT-GET Remove исднутилс-Base) |
|Служба кдумп должна быть отключена.<br /><sub>(88)</sub> |Описание: злоумышленник может проанализировать предыдущий сбой системы для получения конфиденциальной информации. |Удаление пакета кдумп-Tools (APT-GET Remove кдумп-Tools) |
|Зероконф сеть должна быть отключена.<br /><sub>(89)</sub> |Описание: злоумышленник может использовать эту функцию для получения сведений о сетевых системах или подмены DNS-запросов в связи с недостатками в модели доверия. |Для RedHat, CentOS и Oracle: Add `NOZEROCONF=yes or no` to/ЕТК/сисконфиг/Нетворк. Для всех остальных дистрибутивов: удалите все записи "IPv4LL" в файле "/ЕТК/Нетворк/интерфацес" или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-зероконф". |
|Служба crond должна быть включена.<br /><sub>(90)</sub> |Описание. для обычных задач обслуживания в большинстве систем требуется cron. |Установите пакет cron (apt-get install-y cron) и убедитесь, что файл "/ЕТК/ИНИТ/крон.конф" содержит строку "Start on runlevel [2345]". |
|Разрешения файла для/ЕТК/анакронтаб должны быть установлены в корневую папку: root 600.<br /><sub>(91)</sub> |Описание: злоумышленник может манипулировать этим файлом, чтобы предотвратить выполнение запланированных задач или выполнять вредоносные задачи. |Задайте права владения и разрешения на/ЕТК/анакронтаб или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-анакронтаб-Permissions". |
|Убедитесь, что настроены разрешения для/ЕТК/крон.д.<br /><sub>(93)</sub> |Описание: предоставление доступа на запись к этому каталогу для непривилегированных пользователей может предоставить им средства для получения неавторизованных привилегий с повышенными правами. Предоставление доступа для чтения к этому каталогу может предоставить непривилегированному пользователю сведения о том, как получить повышенные привилегии или обойти элементы управления аудитом. |Задайте для владельца и группы/ЕТК/чрон.д значение root и разрешения для 0700 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-cron-File-Permissions". |
|Убедитесь, что настроены разрешения для/ЕТК/крон.Даили.<br /><sub>(94)</sub> |Описание: предоставление доступа на запись к этому каталогу для непривилегированных пользователей может предоставить им средства для получения неавторизованных привилегий с повышенными правами. Предоставление доступа для чтения к этому каталогу может предоставить непривилегированному пользователю сведения о том, как получить повышенные привилегии или обойти элементы управления аудитом. |Задайте для владельца и группы/ЕТК/чрон.Даили значение root и разрешения для 0700 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-cron-File-Permissions". |
|Убедитесь, что настроены разрешения для/ЕТК/крон.хаурли.<br /><sub>(95)</sub> |Описание: предоставление доступа на запись к этому каталогу для непривилегированных пользователей может предоставить им средства для получения неавторизованных привилегий с повышенными правами. Предоставление доступа для чтения к этому каталогу может предоставить непривилегированному пользователю сведения о том, как получить повышенные привилегии или обойти элементы управления аудитом. |Задайте для владельца и группы/ЕТК/чрон.хаурли значение root и разрешения для 0700 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-cron-File-Permissions". |
|Убедитесь, что настроены разрешения для/ЕТК/крон.Монсли.<br /><sub>(96)</sub> |Описание: предоставление доступа на запись к этому каталогу для непривилегированных пользователей может предоставить им средства для получения неавторизованных привилегий с повышенными правами. Предоставление доступа для чтения к этому каталогу может предоставить непривилегированному пользователю сведения о том, как получить повышенные привилегии или обойти элементы управления аудитом. |Задайте для владельца и группы/ЕТК/чрон.Монсли значение root и разрешения для 0700 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-cron-File-Permissions". |
|Убедитесь, что настроены разрешения для/ЕТК/крон.Викли.<br /><sub>(97)</sub> |Описание: предоставление доступа на запись к этому каталогу для непривилегированных пользователей может предоставить им средства для получения неавторизованных привилегий с повышенными правами. Предоставление доступа для чтения к этому каталогу может предоставить непривилегированному пользователю сведения о том, как получить повышенные привилегии или обойти элементы управления аудитом. |Задайте для владельца и группы/ЕТК/чрон.Викли значение root и разрешения для 0700 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Fix-cron-File-Permissions". |
|Убедитесь, что разрешение On/Cron разрешено только полномочным пользователям<br /><sub>(98)</sub> |Описание: во многих системах только системный администратор имеет право планировать `cron` задания. Использование `cron.allow` файла для управления тем, кто может выполнять `cron` задания, применяет эту политику. Проще управлять списком разрешений, чем список запретов. В списке запретов можно добавить идентификатор пользователя в систему и забыть добавить его в список запрещенных файлов. |Замените/ЕТК/крон.Дени и/ЕТК/ат.Дени соответствующими файлами. `allow` |
|Убедитесь, что баннер предупреждения удаленного входа настроен правильно.<br /><sub>(111)</sub> |Описание: предупреждающие сообщения сообщают пользователям о том, кто пытается войти в систему в соответствии с состоянием системы и должны включать имя Организации, владеющей системой, и все имеющиеся политики мониторинга. Отображение сведений о ОС и уровне исправлений в баннерах входа также имеет побочный результат, позволяющий получить подробные сведения о системе для злоумышленников, пытающихся воспользоваться конкретными эксплойтами системы. Полномочные пользователи могут легко получить эти сведения, выполнив `uname -a` команду после входа в систему. |Удаление всех экземпляров \м \r \s и \v из файла/ЕТК/Иссуе.нет |
|Убедитесь, что баннер предупреждения локального входа настроен правильно.<br /><sub>(111,1)</sub> |Описание: предупреждающие сообщения сообщают пользователям о том, кто пытается войти в систему в соответствии с состоянием системы и должны включать имя Организации, владеющей системой, и все имеющиеся политики мониторинга. Отображение сведений о ОС и уровне исправлений в баннерах входа также имеет побочный результат, позволяющий получить подробные сведения о системе для злоумышленников, пытающихся воспользоваться конкретными эксплойтами системы. Полномочные пользователи могут легко получить эти сведения, выполнив `uname -a` команду после входа в систему. |Удаление всех экземпляров \м \r \s и \v из файла/ЕТК/Иссуе |
|Служба Авахи-DAEMON должна быть отключена.<br /><sub>(114)</sub> |Описание: злоумышленник может воспользоваться уязвимостью в управляющей программе Авахи, чтобы получить доступ к |Отключите службу Авахи-DAEMON или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-Авахи-Демон". |
|Служба – CUPS должна быть отключена.<br /><sub>(115)</sub> |Описание: злоумышленник может использовать изъян в службе – CUPS для повышения привилегий. |Отключите службу – CUPS или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-– CUPS". |
|Служба ISC-DHCP должна быть отключена.<br /><sub>(116)</sub> |Описание: злоумышленник может использовать DHCP для предоставления клиентам неисправной информации, что мешает нормальной работе. |Удалите пакет ISC-DHCP-Server (APT-GET ISC-DHCP-Server). |
|Необходимо удалить пакет ISC-DHCP-Server.<br /><sub>(117)</sub> |Описание: злоумышленник может использовать DHCP для предоставления клиентам неисправной информации, что мешает нормальной работе. |Удалите пакет ISC-DHCP-Server (APT-GET ISC-DHCP-Server). |
|Необходимо удалить пакет sendmail.<br /><sub>(120)</sub> |Описание: злоумышленник может использовать эту систему для отправки сообщений электронной почты с вредоносным содержимым другим пользователям. |Удаление пакета sendmail (APT-GET Remove sendmail) |
|Следует удалить постфиксный пакет.<br /><sub>(121)</sub> |Описание: злоумышленник может использовать эту систему для отправки сообщений электронной почты с вредоносным содержимым другим пользователям. |Удалите постфиксный пакет (APT — удалить постфикс) или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Remove-постфикс". |
|Постфиксный сетевой прослушивание следует отключать надлежащим образом.<br /><sub>(122)</sub> |Описание: злоумышленник может использовать эту систему для отправки сообщений электронной почты с вредоносным содержимым другим пользователям. |Добавьте строку "inet_interfaces localhost" в файл "/ЕТК/постфикс/Маин.КФ" |
|Служба LDAP должна быть отключена.<br /><sub>(124)</sub> |Описание: злоумышленник может управлять службой LDAP на этом узле, чтобы распределять ложные данные клиентам LDAP. |Удаление пакета слапд (APT-GET Remove слапд) |
|Служба рпкгссд должна быть отключена.<br /><sub>(126)</sub> |Описание: злоумышленник может использовать изъян в рпкгссд/NFS для получения доступа |Отключите службу рпкгссд или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-рпкгссд". |
|Служба рпЦидмапд должна быть отключена.<br /><sub>(127)</sub> |Описание: злоумышленник может использовать изъян в idmapd/NFS для получения доступа |Отключите службу рпЦидмапд или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-рпЦидмапд". |
|Служба сопоставления портов должна быть отключена.<br /><sub>(129)</sub> |Описание: злоумышленник может использовать изъян в portmap для получения доступа |Отключите службу rpcbind или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-rpcbind". |
|Служба рпксвкгссд должна быть отключена.<br /><sub>(130)</sub> |Описание: злоумышленник может воспользоваться изъяном в рпксвкгссд для получения доступа |Удалите строку "NEED_SVCGSSD = Yes" из файла "/ЕТК/инетд.конф" |
|Именованная служба должна быть отключена.<br /><sub>(131)</sub> |Описание: злоумышленник может использовать службу DNS для распределения ложных данных клиентам. |Удаление пакета bind9 (APT-GET Remove bind9) |
|Необходимо удалить пакет привязки.<br /><sub>(132)</sub> |Описание: злоумышленник может использовать службу DNS для распределения ложных данных клиентам. |Удаление пакета bind9 (APT-GET Remove bind9) |
|Служба Довекот должна быть отключена.<br /><sub>(137)</sub> |Описание: система может использоваться в качестве сервера IMAP/POP3 |Удаление Довекот-Core пакета (APT-GET Remove Довекот-Core) |
|Необходимо удалить пакет Довекот.<br /><sub>(138)</sub> |Описание: система может использоваться в качестве сервера IMAP/POP3 |Удаление Довекот-Core пакета (APT-GET Remove Довекот-Core) |
|Убедитесь, что `+` в/etc/passwd отсутствуют устаревшие записи<br /><sub>(156,1)</sub> |Описание: злоумышленник может получить доступ, используя имя пользователя "+" без пароля. |Удалите все записи в/etc/passwd, которые начинаются с "+:" |
|Убедитесь, что `+` в/etc/shadow отсутствуют устаревшие записи<br /><sub>(156,2)</sub> |Описание: злоумышленник может получить доступ, используя имя пользователя "+" без пароля. |Удалите все записи в/etc/shadow, которые начинаются с "+:" |
|Убедитесь, что `+` в/ЕТК/грауп отсутствуют устаревшие записи<br /><sub>(156,3)</sub> |Описание: злоумышленник может получить доступ, используя имя пользователя "+" без пароля. |Удалите все записи в/ЕТК/грауп, которые начинаются с "+:" |
|Убедитесь, что срок действия пароля составляет 365 дней или меньше.<br /><sub>(157,1)</sub> |Описание: окно возможности для злоумышленника, которое может использовать скомпрометированные учетные данные или успешно нарушать учетные данные посредством атаки методом прямого перебора, ограничено возрастом пароля. Таким образом, уменьшение максимального возраста пароля также сокращает окно возможностей злоумышленника. |Задайте `PASS_MAX_DAYS` для параметра значение не более 365 в `/etc/login.defs`  или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r configure-Password-Policy-Max-Days". |
|Убедитесь, что дни предупреждения об истечении срока действия пароля — 7 и более.<br /><sub>(157,2)</sub> |Описание. предупреждающее предупреждение о том, что срок действия пароля истекает, пользователь может считать защищенный пароль. Неосведомленные пользователи могут выбрать простой пароль или записать его там, где он может быть обнаружен. |Присвойте `PASS_WARN_AGE` параметру значение 7 в `/etc/login.defs`  или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r configure-Password-Policy-warn-Age" |
|Убедитесь, что использование пароля ограничено.<br /><sub>(157,5)</sub> |Описание. Принудительное использование пользователями предшествующих 5 паролей снижает вероятность того, что злоумышленник сможет угадать пароль. |Убедитесь, что для параметра "запомнить" задано значение не менее 5 в/ЕТК/пам.д/Коммон-пассворд или/ЕТК/пам.д/password_auth и/ЕТК/пам.д/system_auth или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r configure-пароль-Policy-History". |
|Убедитесь, что алгоритм хэширования паролей SHA-512<br /><sub>(157,11)</sub> |Описание. алгоритм SHA-512 обеспечивает намного более надежное хэширование, чем MD5, тем самым обеспечивая дополнительную защиту системы путем увеличения уровня усилий для успешного определения паролей злоумышленником. Примечание. Эти изменения применяются только к учетным записям, настроенным в локальной системе. |Задайте для алгоритма хэширования паролей значение SHA512. Многие дистрибутивы предоставляют средства для обновления конфигурации PAM. Дополнительные сведения см. в документации. Если средства не предоставлены, измените соответствующий `/etc/pam.d/` файл конфигурации и добавьте или измените строки, `pam_unix.so` чтобы включить параметр SHA512: ``` password sufficient pam_unix.so sha512 ``` |
|Убедитесь, что минимальное число дней между изменением пароля — 7 или более.<br /><sub>(157,12)</sub> |Описание: путем ограничения частоты смены пароля администратор может запретить пользователям многократно изменять пароль при попытке обхода элементов управления повторного использования паролей. |Присвойте `PASS_MIN_DAYS` параметру значение 7 в `/etc/login.defs` : `PASS_MIN_DAYS 7` . Измените параметры пользователя для всех пользователей, для которых установлен соответствующий пароль: `chage --mindays 7`  или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-Pass-min-Days". |
|Убедитесь, что Дата последнего изменения пароля для всех пользователей прошла<br /><sub>(157,14)</sub> |Описание: Если пользователи записали дату изменения пароля в будущем, они смогут обойти все установленные истечение срока действия пароля. |Убедитесь, что неактивная блокировка пароля составляет 30 дней или меньше, выполните следующую команду, чтобы задать период бездействия пароля по умолчанию 30 дней: ``` # useradd -D -f 30 ``` изменение параметров пользователя для всех пользователей с установленным паролем: ``` # chage --inactive 30  ``` |
|Убедитесь, что системные учетные записи не входят в систему<br /><sub>(157,15)</sub> |Описание. важно убедиться, что учетные записи, которые не используются обычными пользователями, запрещают использовать для предоставления интерактивной оболочки. По умолчанию Ubuntu устанавливает поле пароля для этих учетных записей в недопустимую строку, но также рекомендуется, чтобы поле оболочки в файле пароля было установлено в значение `/usr/sbin/nologin` . Это предотвращает потенциальное использование учетной записи для выполнения каких бы то ни было команд. |Настройте оболочку для всех учетных записей, возвращаемых сценарием аудита, на `/sbin/nologin` |
|Убедитесь, что группа по умолчанию для учетной записи root имеет значение GID 0<br /><sub>(157,16)</sub> |Описание: использование GID 0 для `_root_ ` учетной записи помогает предотвратить `_root_` случайную непривилегированную доступ к файлам для пользователей, не имеющих привилегий. |Выполните следующую команду, чтобы задать `root` GID для пользовательской группы по умолчанию `0` : ``` # usermod -g 0 root ``` |
|Убедитесь, что root является единственной учетной записью UID 0<br /><sub>(157,18)</sub> |Описание: этот доступ должен быть ограничен только `root ` учетной записью по умолчанию и только из системной консоли. Административный доступ должен осуществляться через непривилегированную учетную запись, используя утвержденный механизм. |Удалите всех пользователей, кроме `root` UID, `0` или назначьте им новый UID, если это необходимо. |
|Удаление ненужных пакетов<br /><sub>(158)</sub> |Описание.  |Выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Remove-альбомная — Общие" |
|Удаление ненужных учетных записей<br /><sub>(159)</sub> |Описание: для соответствия |Удаление ненужных учетных записей |
|Проверка включения включенной в аудит службы<br /><sub>(162)</sub> |Описание. захват системных событий предоставляет системным администраторам сведения, позволяющие определить, не несанкционированный доступ к их системе. |Установить пакет аудита (systemctl включить аудит) |
|Запустить службу с аудитом<br /><sub>(163)</sub> |Описание. захват системных событий предоставляет системным администраторам сведения, позволяющие определить, не несанкционированный доступ к их системе. |Запустить службу аудита (systemctl Started audited) |
|Убедитесь, что сервер SNMP не включен<br /><sub>(179)</sub> |Описание. сервер SNMP может обмениваться данными с помощью протокола SNMP v1, который передает данные в четком виде и не требует проверки подлинности для выполнения команд. Если это не обязательно, рекомендуется не использовать службу SNMP. Если требуется протокол SNMP, сервер должен быть настроен на запрет протокола SNMP v1. |Выполните одну из следующих команд, чтобы отключить `snmpd` : ``` # chkconfig snmpd off ``` ``` # systemctl disable snmpd `````` # update-rc.d snmpd disable ``` |
|Убедитесь, что служба rsync не включена<br /><sub>(181)</sub> |Описание. `rsyncd` Служба представляет угрозу безопасности, так как использует незашифрованные протоколы для обмена данными. |Выполните одну из следующих команд, чтобы отключить `rsyncd` : `chkconfig rsyncd off` , `systemctl disable rsyncd` `update-rc.d rsyncd disable` или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Disable-рсиснк". |
|Убедитесь, что NIS-сервер не включен<br /><sub>(182)</sub> |Описание. Служба NIS по сути является незащищенной системой, уязвимой для атак DOS, переполнениям буфера и низкой подлинности для запросов к NIS-картам. Обычно NIS заменен такими протоколами, как протокол LDAP. Рекомендуется отключить службу, а также использовать другие, более безопасные службы. |Выполните одну из следующих команд, чтобы отключить `ypserv` : ``` # chkconfig ypserv off ``` ``` # systemctl disable ypserv `````` # update-rc.d ypserv disable ``` |
|Убедитесь, что клиент rsh не установлен<br /><sub>(183)</sub> |Описание. эти устаревшие клиенты содержат многочисленные угрозы безопасности и были заменены более защищенным пакетом SSH. Даже если сервер удален, рекомендуется убедиться, что клиенты также будут удалены, чтобы пользователи не могли случайно пытаться использовать эти команды и, таким образом, предоставляя учетные данные. Обратите внимание, что `rsh ` при удалении пакета удаляются клиенты для `rsh` `rcp ` и `rlogin` . |Удалите `rsh` с помощью соответствующего диспетчера пакетов или установки вручную: ``` yum remove rsh ``` ``` apt-get remove rsh `````` zypper remove rsh ``` |
|Отключение SMB v1 с Samba<br /><sub>(185)</sub> |Описание: SMB V1 имеет хорошо известные, серьезные уязвимости и не шифрует данные при передаче. Если он должен использоваться для переопределения бизнес-причин, настоятельно рекомендуется определить другие способы устранения рисков, чтобы компенсировать использование этого протокола.  |Если Samba не запущен, удалите пакет, в противном случае в разделе [Global] раздела/ЕТК/Самба/СМБ.конф: min Protocol = SMB2 или выполните команду "/опт/Микрософт/омсажент/плугин/омсремедиате-r Set-SMB-min-Version". |

> [!NOTE]
> Доступность конкретных параметров гостевой конфигурации политики Azure может отличаться в Azure для государственных организаций и других национальных облаков.

## <a name="next-steps"></a>Следующие шаги

Дополнительные статьи о политике Azure и гостевой конфигурации:

- [Конфигурация гостевой политики Azure](../concepts/guest-configuration.md).
- Обзор [соответствия нормативным требованиям](../concepts/regulatory-compliance.md).
- См. другие [примеры шаблонов для Политики Azure](./index.md).
- Изучите [сведения о действии политик](../concepts/effects.md).
- Узнайте, как [исправлять несоответствующие ресурсы](../how-to/remediate-resources.md).
