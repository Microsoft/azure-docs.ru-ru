---
title: Краткое руководство. Создание профиля для обеспечения высокого уровня доступности приложений на портале Azure — Диспетчер трафика Azure
description: В этом кратком руководстве описано, как создать профиль диспетчера трафика для сборки высокодоступного веб-приложения с помощью портала Azure.
services: traffic-manager
author: duongau
manager: twooley
ms.service: traffic-manager
ms.devlang: na
ms.topic: quickstart
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/15/2020
ms.author: duau
ms.openlocfilehash: 1a26becbc7ffaddc09dc06c5dff12f83deaa9ee2
ms.sourcegitcommit: 73fb48074c4c91c3511d5bcdffd6e40854fb46e5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2021
ms.locfileid: "106067220"
---
# <a name="quickstart-create-a-traffic-manager-profile-using-the-azure-portal"></a>Краткое руководство. Создание профиля диспетчера трафика с помощью портала Azure

В этом кратком руководстве показано, как создать профиль диспетчера трафика, который обеспечивает высокий уровень доступности веб-приложения.

В этом кратком руководстве вы узнаете о двух экземплярах веб-приложения. Каждый из них выполняется в разном регионе Azure. Будет создан профиль диспетчера трафика, который основывается на [приоритете конечной точки](traffic-manager-routing-methods.md#priority-traffic-routing-method). Профиль будет направлять пользовательский трафик к первичному сайту, который запускает веб-приложение. Диспетчер трафика постоянно отслеживает веб-приложение. Если основной сайт недоступен, он предоставляет автоматический переход на резервный сайт.

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).

## <a name="prerequisites"></a>Предварительные требования

Для этого краткого руководства необходимо развернуть два экземпляра веб-приложения в разных регионах Azure (*восточная часть США* и *Западная Европа*). Каждый будет использоваться в качестве основных конечных точек и конечных точек отработки отказа для диспетчера трафика.

1. Войдите на [портал Azure](https://portal.azure.com).

1. Вверху с левой стороны экрана выберите **Создать ресурс**. Выполните поиск по запросу **Веб-приложение** и выберите элемент **Создать**.

1. В разделе **Создание веб-приложения**  введите или выберите следующие значения на вкладке **Основные сведения**:

    | Параметр                 | Значение |
    | ---                     | --- |
    | Подписка            | Выберите свою подписку. |    
    | Группа ресурсов          | Выберите элемент **Создать** и введите строку *myResourceGroupTM1* в текстовом поле.|
    | Имя                    | Введите уникальное **имя** для вашего веб-приложения. В этом примере используется *myWebAppEastUS*. |
    | Публикация                 | Выберите **Код**. |
    | Стек среды выполнения           | Выберите вариант **ASP.NET V4.7**. |
    | Операционная система        | Выберите **Windows**. |
    | Регион                  | Выберите **Восточная часть США**. |
    | План Windows            | Выберите **Создать** и введите *myAppServicePlanEastUS* в текстовом поле. |
    | Номер SKU и размер            | Выберите **Standard S1 100 total ACU, 1.75 GB memory** ("Стандартный" S1, общее число ACU — 100, 1,75 ГБ памяти). |
   
1. перейдите на вкладку **Мониторинг** или выберите **Далее: Мониторинг**.  На вкладке **Мониторинг** задайте параметру **Application Insights** > **Включить Application Insights** значение **Нет**.

1. Выберите **Просмотреть и создать**.

1. Проверьте параметры, а затем нажмите кнопку **Создать**.  Если веб-приложение развертывается успешно, создается веб-сайт по умолчанию.

1. Выполните шаги 1–6, чтобы создать второе веб-приложение с именем *myWebAppWestEurope*. В качестве имени **группы ресурсов** указывается значение *myResourceGroupTM2*, в качестве **региона** — *Западная Европа*, а в качестве имени **плана службы приложений** — **myAppServicePlanWestEurope**. Все остальные параметры аналогичны задаваемым для *myWebAppEastUS*.

## <a name="create-a-traffic-manager-profile"></a>Создание профиля диспетчера трафика

Создайте профиль диспетчера трафика, который направляет пользовательский трафик по приоритету конечной точки.

1. Вверху с левой стороны экрана выберите **Создать ресурс**. Затем найдите **профиль Диспетчера трафика** и выберите **Создать**.
1. В разделе **Создать профиль диспетчера трафика** введите или выберите следующие параметры:

    | Параметр | Значение |
    | --------| ----- |
    | Имя | Для профиля диспетчера трафика введите уникальное имя.|
    | Метод маршрутизации | Выберите **Приоритет**.|
    | Подписка | Выберите подписку, к которой будет применяться профиль диспетчера трафика. |
    | Группа ресурсов | Выберите *myResourceGroupTM1*.|
    | Расположение |Эти параметры касаются расположения группы ресурсов. Это не влияет на профиль диспетчера трафика, который будет развернут глобально.|

1. Нажмите кнопку **создания**.

## <a name="add-traffic-manager-endpoints"></a>Добавление конечных точек диспетчера трафика

Добавьте веб-сайт в регионе *Восточная часть США* как основную конечную точку для маршрутизации всего пользовательского трафика. Добавьте веб-сайт в регионе *Западная Европа* как конечную точку отработки отказа. Если основная конечная точка недоступна, трафик автоматически направляется на конечную точку отработки отказа.

1. На панели поиска портала введите имя созданного в предыдущем разделе профиля диспетчера трафика.
1. В результатах поиска выберите профиль.
1. В колонке **Профиль диспетчера трафика** в разделе **Параметры** щелкните **Конечные точки**, а затем выберите **Добавить**.

    :::image type="content" source="./media/quickstart-create-traffic-manager-profile/traffic-manager-endpoint-menu.png" alt-text="Параметры конечных точек в профиле Диспетчера трафика":::

1. Введите или выберите следующие параметры:

    | Параметр | Значение |
    | ------- | ------|
    | Тип | Выберите **Конечная точка Azure**. |
    | Имя | Введите *myPrimaryEndpoint*. |
    | Тип целевого ресурса | Выберите **Служба приложений Azure**. |
    | Целевой ресурс | Щелкните **Выбрать службу приложений** > **Восточная часть США**. |
    | Приоритет | Выберите **1**. Если трафик находится в работоспособном состоянии, он направляется к этой конечной точке. |

    :::image type="content" source="./media/quickstart-create-traffic-manager-profile/add-traffic-manager-endpoint.png" alt-text="Снимок экрана: где в профиле диспетчера трафика добавить конечную точку":::
    
1. Щелкните **ОК**.
1. Для создания конечной точки отработки отказа для своего второго региона Azure повторите шаги 3 и 4, используя следующие параметры:

    | Параметр | Значение |
    | ------- | ------|
    | Тип | Выберите **Конечная точка Azure**. |
    | Имя | Введите *myFailoverEndpoint*. |
    | Тип целевого ресурса | Выберите **Служба приложений Azure**. |
    | Целевой ресурс | Щелкните **Выбрать службу приложений** > **Западная Европа**. |
    | Приоритет | Выберите **2**. Если основная конечная точка находится в неработоспособном состоянии, весь трафик направляется к конечной точке отработки отказа. |

1. Щелкните **ОК**.

После добавления двух конечных точек, они отображаются на панели **Профиль диспетчера трафика**. Обратите внимание, что теперь их состояние мониторинга — **В сети**.

## <a name="test-traffic-manager-profile"></a>Тестирование профиля диспетчера трафика

В этом разделе произойдет проверка доменного имени профиля диспетчера трафика. Основная конечная точка должна быть недоступной. В результате вы увидите, что веб-приложение по-прежнему доступно. Причиной этого является отправление трафика к конечной точке отработки отказа диспетчером трафика.

### <a name="check-the-dns-name"></a>Проверка DNS-имени

1. На панели поиска портала выполните поиск имени **профиля диспетчера трафика**, созданного в предыдущем разделе.
1. Выберите профиль диспетчера трафика. Появится страница **Обзор**.
1. В **профиле диспетчера трафика** отображается DNS-имя только что созданного профиля диспетчера трафика.
  
    :::image type="content" source="./media/quickstart-create-traffic-manager-profile/traffic-manager-dns-name.png" alt-text="Снимок экрана о расположении DNS-имени диспетчера трафика":::

### <a name="view-traffic-manager-in-action"></a>Просмотр диспетчера трафика в действии

1. В веб-браузере введите DNS-имя вашего профиля диспетчера трафика, чтобы просмотреть веб-сайт по умолчанию для веб-приложения.

    > [!NOTE]
    > В этом кратком сценарии все запросы направляются к основной конечной точке, которой присваивается **Приоритет 1**.

    :::image type="content" source="./media/quickstart-create-traffic-manager-profile/traffic-manager-test.png" alt-text="Снимок экрана веб-страницы для подтверждения доступности профиля диспетчера трафика":::

1. Чтобы просмотреть отработку отказа диспетчера трафика в действии, отключите ваш основной сайт.
    1. На странице профиля диспетчера трафика из раздела **Обзор** выберите **myPrimaryEndpoint**.
    1. Для *MyPrimaryEndpoint* выберите **Отключить** > **Сохранить**.
    1. Закройте **myPrimaryEndpoint**. Убедитесь, что для состояния установлено значение **Отключено**.
1. Скопируйте DNS-имя вашего профиля диспетчера трафика из предыдущего шага, чтобы просмотреть веб-сайт в новом сеансе веб-браузера.
1. Убедитесь, что веб-приложение по-прежнему доступно.

Основная конечная точка недоступна, поэтому вас направили к конечной точки отработки отказа.

## <a name="clean-up-resources"></a>Очистка ресурсов

Выполнив все, удалите группы ресурсов, веб-приложения и все связанные ресурсы. Чтобы сделать это, отдельно выберите каждый элемент из панели мониторинга и щелкните **Удалить** в верхней части каждой страницы.

## <a name="next-steps"></a>Дальнейшие шаги

В этом кратком руководстве был создан профиль диспетчера трафика. Он позволяет перенаправлять трафик пользователя для веб-приложений высокого уровня доступности. Дополнительные сведения о маршрутизации трафика см. в руководствах по диспетчеру трафика.

> [!div class="nextstepaction"]
> [Руководства по диспетчеру трафика](tutorial-traffic-manager-improve-website-response.md)
