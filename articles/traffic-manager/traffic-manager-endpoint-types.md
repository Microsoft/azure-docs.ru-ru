---
title: Типы конечных точек диспетчера трафика | Документация Майкрософт
description: В этой статье описываются разные типы конечных точек, которые можно использовать с диспетчером трафика Azure
services: traffic-manager
documentationcenter: ''
author: duongau
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/29/2017
ms.author: duau
ms.openlocfilehash: e55c2115edef684f38aa53172596beffd101ef59
ms.sourcegitcommit: 0aec60c088f1dcb0f89eaad5faf5f2c815e53bf8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/14/2021
ms.locfileid: "98184396"
---
# <a name="traffic-manager-endpoints"></a>Конечные точки диспетчера трафика

С помощью диспетчера трафика Microsoft Azure можно управлять распределением сетевого трафика среди приложений, развернутых в различных центрах обработки данных. В диспетчере трафика каждое развертывание приложения необходимо настроить в качестве конечной точки. Когда диспетчер трафика получает запрос DNS, он выбирает доступную конечную точку и возвращает ее в ответе DNS. Выбор конечной точки зависит от ее текущего состояния и метода маршрутизации трафика. Дополнительные сведения см. в разделе [как работает диспетчер трафика](traffic-manager-how-it-works.md).

Диспетчер трафика поддерживает три типа конечных точек.

* **Конечные точки Azure**, используемые для служб, размещенных в Azure.
* **Внешние конечные точки**, используемые для IPv4- или IPv6-адресов, полных доменных имен или для служб, размещенных за пределами Azure: локально или с помощью другого поставщика услуг размещения.
* **Вложенные конечные точки**, используемые для объединения профилей диспетчера трафика, которое позволяет создавать более гибкие и эффективные схемы маршрутизации трафика для поддержки потребностей более крупных и сложных развертываний.

Конечные точки разных типов можно объединять в одном профиле диспетчера трафика без ограничений. В каждом профиле может содержаться любое сочетание типов конечных точек.

В следующих разделах каждый тип конечной точки описывается более подробно.

## <a name="azure-endpoints"></a>конечные точки Azure

Конечные точки Azure используются в диспетчере трафика для служб на основе Azure. Поддерживаются следующие типы ресурсов Azure:

* Облачные службы PaaS.
* Веб-приложения
* Слоты веб-приложения.
* ресурсы PublicIPAddress (которые можно подключить к виртуальным машинам: напрямую или с помощью Azure Load Balancer). Для использования в профиле диспетчера трафика ресурсам publicIpAddress необходимо присвоить DNS-имя.

PublicIPAddress — это ресурсы Azure Resource Manager. Они отсутствуют в классической модели развертывания. Таким образом, они поддерживаются только в Azure Resource Manager диспетчера трафика. Другие типы конечных точек поддерживаются для обеих моделей развертывания: Resource Manager и классической.

При использовании конечных точек Azure диспетчер трафика обнаруживает, когда веб-приложение остановлено и запущено. Это состояние отражается в состоянии конечной точки. Дополнительные сведения см. в разделе [Состояние конечной точки и профиля](traffic-manager-monitoring.md#endpoint-and-profile-status). При остановке базовой службы диспетчер трафика не проверяет работоспособность конечной точки и не направляет трафик на конечную точку. Для остановленного экземпляра не выставляются счета за использование диспетчера трафика. После перезапуска службы выставление счетов возобновляется, а конечная точка может получать трафик. На конечных точек PublicIpAddress такие события не происходят.

## <a name="external-endpoints"></a>внешние конечные точки

Внешние конечные точки используются для адресов IPv4/IPv6, полных доменных имен или для служб за пределами Azure. Использование конечных точек IPv4- или IPv6-адресов позволяет диспетчеру трафика проверить работоспособность конечных точек, не требуя для них DNS-имя. В итоге диспетчер трафика может ответить на запросы с помощью записей A/AAAA при возврате этой конечной точки в ответ. Службы, размещенные за пределами Azure, могут включать службы, размещенные локально или с помощью другого поставщика услуг. Внешние конечные точки можно использовать как отдельно, так и в сочетании с конечными точками Azure в одном и том же профиле диспетчера трафика, за исключением конечных точек IPv4- или IPv6-адресов, которые могут быть только внешними. Объединение конечных точек Azure с внешними конечными точками позволяет реализовать различные сценарии:

* Использовать Azure для увеличения избыточности в существующем локальном приложении в рамках модели отработки отказа "активный — активный" или "активный — пассивный". 
* Направить трафик к конечным точкам, которые не связаны с DNS-именами. Кроме того, можно снизить общую задержку запроса DNS, устраняя необходимость выполнять второй такой же запрос, чтобы получить IP-адрес возвращенного DNS-имени.
* Расширить существующее локальное приложение в дополнительные географические расположения в Azure, чтобы уменьшить задержки отклика приложения для пользователей по всему миру. Дополнительные сведения см. в разделе [Метод маршрутизации трафика для повышения производительности](traffic-manager-routing-methods.md#performance);
* Использовать Azure для получения дополнительной емкости для существующего локального приложения непрерывно или путем расширения в облако, чтобы обеспечить обработку всплеска запросов.

В некоторых случаях внешние конечные точки также можно использовать для ссылки на службы Azure (примеры см. в разделе [Часто задаваемые вопросы](traffic-manager-faqs.md#traffic-manager-endpoints)). В этом случае счета за проверки работоспособности выставляются по тарифу конечных точек Azure, а не внешних конечных точек. Тем не менее, в отличие от конечных точек Azure, при остановке или удалении основной службы за проверки работоспособности будут по-прежнему выставляться счета, пока вы не отключите или удалите конечную точку в диспетчере трафика.

## <a name="nested-endpoints"></a>вложенные конечные точки

Вложенные конечные точки объединяют несколько профилей диспетчера трафика, что позволяет создавать гибкие и эффективные схемы маршрутизации трафика для поддержки потребностей более крупных и сложных развертываний. При использовании вложенных конечных точек дочерний профиль добавляется в качестве конечной точки в родительский профиль. Дочерний и родительский профили могут содержать другие конечные точки любого типа, в том числе другие вложенные профили. Дополнительную информацию см. в статье [Вложенные профили диспетчера трафика](traffic-manager-nested-profiles.md).

## <a name="web-apps-as-endpoints"></a>Веб-приложения в качестве конечных точек

При настройке веб-приложений в качестве конечных точек в диспетчере трафика необходимо учитывать дополнительные рекомендации:

1. В диспетчере трафика можно использовать только веб-приложения с SKU уровня "Стандартный" или выше. Добавление веб-приложения с SKU более низкого уровня завершится ошибкой. Понижение уровня SKU для существующего веб-приложения приведет к тому, что диспетчер трафика перестанет отправлять трафик на веб-приложения. Дополнительные сведения о поддерживаемых планах см. в разделе [планов службы приложений](https://azure.microsoft.com/pricing/details/app-service/plans/).
2. Когда конечная точка получает HTTP-запрос, для определения веб-приложения, которое должно обработать запрос, используется заголовок узла. Заголовок узла содержит DNS-имя, используемое для отправки запроса, например contosoapp.azurewebsites.net. Чтобы использовать другое DNS-имя в веб-приложении, это имя необходимо зарегистрировать в качестве имени пользовательского домена приложения. При добавлении конечной точки веб-приложения в качестве конечной точки Azure DNS-имя в профиле диспетчера трафика автоматически регистрируется для приложения. При удалении конечной точки эта регистрация автоматически отменяется.
3. В каждом профиле диспетчера трафика может быть только одна конечная точка веб-приложения из каждого региона Azure. Чтобы обойти это ограничение, можно настроить веб-приложение как внешнюю конечную точку. Дополнительные сведения см. в разделе [Часто задаваемые вопросы](traffic-manager-faqs.md#traffic-manager-endpoints).

## <a name="enabling-and-disabling-endpoints"></a>Включение и отключение конечных точек

Отключить конечную точку в диспетчере трафика целесообразно, если нужно временно удалить трафик из конечной точки, которая находится в режиме обслуживания или повторно развертывается. После восстановления конечной точки ее можно включить снова.

Конечные точки можно включать и отключать с помощью портала диспетчера трафика, PowerShell, CLI или REST API.

> [!NOTE]
> Отключение конечной точки Azure никак не отражается на состоянии ее развертывания в Azure. Служба Azure (например, виртуальная машина или веб-приложение) остается запущенной и может получать трафик, даже если она отключена в диспетчере трафика. Трафик может направляться непосредственно на экземпляр службы, а не через DNS-имя в профиле диспетчера трафика. Дополнительные сведения см. в статье [Как работает диспетчер трафика](traffic-manager-how-it-works.md).

Доступность каждой конечной точки для приема трафика зависит от следующих факторов:

* состояние профиля (включен или отключен);
* состояние конечной точки (включена или отключена);
* результаты проверки работоспособности для конкретной конечной точки.

Дополнительные сведения см. в разделе [Состояние конечной точки и профиля](traffic-manager-monitoring.md#endpoint-and-profile-status).

> [!NOTE]
> Так как диспетчер трафика работает на уровне DNS, он не влияет на существующие подключения к какой-либо конечной точке. Если конечная точка недоступна, диспетчер трафика направляет новые подключения на другую доступную конечную точку. Однако узел отключенной или неработоспособной конечной точки может по-прежнему получать трафик через существующие подключения, пока эти сеансы не будут завершены. Чтобы трафик не проходил через существующие подключения, для приложений следует ограничить продолжительность сеанса.

Если все конечные точки в профиле отключены или отключен сам профиль, диспетчер трафика в ответ на новый запрос DNS отправляет ответ NXDOMAIN.

## <a name="faqs"></a>Часто задаваемые вопросы

* [Можно ли использовать в диспетчере трафика конечные точки из нескольких подписок?](./traffic-manager-faqs.md#can-i-use-traffic-manager-with-endpoints-from-multiple-subscriptions)

* [Можно ли использовать диспетчер трафика с промежуточными слотами облачной службы?](./traffic-manager-faqs.md#can-i-use-traffic-manager-with-cloud-service-staging-slots)

* [Поддерживает ли диспетчер трафика конечные точки IP версии 6?](./traffic-manager-faqs.md#does-traffic-manager-support-ipv6-endpoints)

* [Можно ли использовать в диспетчере трафика несколько веб-приложений в одном и том же регионе?](./traffic-manager-faqs.md#can-i-use-traffic-manager-with-more-than-one-web-app-in-the-same-region)

* [Как переместить конечные точки Azure профиля диспетчера трафика в другую группу ресурсов?](./traffic-manager-faqs.md#how-do-i-move-my-traffic-manager-profiles-azure-endpoints-to-a-different-resource-group-or-subscription)

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте, [как работает диспетчер трафика](traffic-manager-how-it-works.md).
* Узнайте больше о [мониторинге конечных точек и автоматической отработке отказов](traffic-manager-monitoring.md)диспетчера трафика.
* Узнайте больше о [методах маршрутизации трафика](traffic-manager-routing-methods.md)в диспетчере трафика.