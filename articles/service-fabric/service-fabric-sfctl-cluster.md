---
title: Azure Service Fabric CLI — кластер sfctl
description: Сведения о sfctl, интерфейсе командной строки Azure Service Fabric. Содержит список команд для управления кластерами.
author: jeffj6123
ms.topic: reference
ms.date: 1/16/2020
ms.author: jejarry
ms.openlocfilehash: 05132e4c7e644e681e2e4cfdedaa2b04a066ebeb
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "86259961"
---
# <a name="sfctl-cluster"></a>sfctl cluster
Выбор кластеров Service Fabric, управление ими и их эксплуатация.

## <a name="commands"></a>Команды

|Команда|Описание|
| --- | --- |
| code-versions | Возвращает список версий кода структуры, которые были подготовлены в кластере Service Fabric. |
| config-versions | Возвращает список версий конфигураций структуры, которые были подготовлены в кластере Service Fabric. |
| health | Возвращает состояние работоспособности кластера Service Fabric. |
| manifest | Возвращает манифест кластера Service Fabric. |
| operation-cancel | Отменяет операцию при ошибке, вызываемую пользователем. |
| operation-list | Возвращает список операций при ошибке, вызываемых пользователем, отфильтрованный по введенным параметрам. |
| provision | Подготавливает пакеты кода или конфигурации кластера Service Fabric. |
| recover-system | Указывает кластеру Service Fabric, что следует попытаться восстановить системные службы, которые в настоящее время находятся в состоянии потери кворума. |
| report-health | Отправляет отчет о работоспособности кластера Service Fabric. |
| select | Выполняет подключение к конечной точке кластера Service Fabric. |
| show-connection | Показывает, к какому кластеру Service Fabric подключен этот экземпляр sfctl. |
| unprovision | Отменяет подготовку пакетов кода или конфигурации кластера Service Fabric. |
| обновление | Запускает обновление пакетов кода или конфигурации кластера Service Fabric. |
| upgrade-resume | Выполняет переход процесса обновления кластера к следующему домену обновления. |
| upgrade-rollback | Откатывает обновление кластера Service Fabric. |
| upgrade-status | Возвращает ход выполнения текущего обновления кластера. |
| upgrade-update | Обновляет параметры обновления кластера Service Fabric. |

## <a name="sfctl-cluster-code-versions"></a>sfctl cluster code-versions
Возвращает список версий кода структуры, которые были подготовлены в кластере Service Fabric.

Возвращает список сведений о версиях кода структуры, подготовленных в кластере. Параметр CodeVersion может использоваться для необязательной фильтрации выходных данных только для конкретной версии.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --code-version | Версия продукта Service Fabric. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-config-versions"></a>sfctl cluster config-versions
Возвращает список версий конфигураций структуры, которые были подготовлены в кластере Service Fabric.

Возвращает список сведений о версиях конфигурации структуры, подготовленных в кластере. Параметр ConfigVersion может использоваться для необязательной фильтрации выходных данных только для конкретной версии.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --config-version | Версия конфигурации Service Fabric. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-health"></a>sfctl cluster health
Возвращает состояние работоспособности кластера Service Fabric.

EventsHealthStateFilter используется для фильтрации получаемой коллекции событий работоспособности кластера на основе состояния работоспособности. Аналогично используются NodesHealthStateFilter и ApplicationsHealthStateFilter для фильтрации получаемой коллекции узлов и приложений на основе их общего состояния работоспособности.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --applications-health-state-filter | Позволяет фильтровать объекты состояния работоспособности приложения, возвращаемые в результате запроса работоспособности кластера, по состоянию работоспособности. Возможные значения для этого параметра — целочисленное значение, полученное от элементов или битовых операций над элементами перечисления HealthStateFilter. Возвращаются только те приложения, которые соответствуют заданному фильтру. Для оценки общего состояния работоспособности используются все приложения. Если фильтр не указан, возвращаются все записи. Значения состояния представляют собой перечисление на основе флага, поэтому значение может представлять собой сочетание этих значений, полученное с помощью битового оператора "ИЛИ". Например, если указано значение 6, то возвращается состояние работоспособности приложений со значениями HealthState "OK" (2) и "Warning" (4).  <br> -Default — значение по умолчанию. Соответствует любому значению HealthState. Значение равно нулю.  <br> -None — фильтр, который не соответствует какому-либо значению HealthState. Используется для возвращения нуля результатов для определенной коллекции состояний. Значение равно 1.  <br> -ОК — фильтр, извлекающий входные данные с HealthState со значением "Ок". Значение равно 2.  <br> -Warning — фильтр, извлекающий входные данные с HealthState со значением "Warning". Значение равно 4.  <br> -Error — фильтр, извлекающий входные данные с HealthState со значением "Error". Значение равно 8.  <br> -All — фильтр, извлекающий входные данные с любым значением HealthState. Значение равно 65 535. |
| --events-health-state-filter | Позволяет отфильтровать коллекцию возвращаемых объектов HealthEvent по состоянию работоспособности. Возможные значения для этого параметра — целочисленное значение одного из приведенных ниже состояний работоспособности. Возвращаются только те события, которые соответствуют заданному фильтру. Для оценки общего состояния работоспособности используются все события. Если фильтр не указан, возвращаются все записи. Значения состояния — это перечисление на основе флага, поэтому значение может представлять собой сочетание этих значений, полученное с помощью битового оператора OR. Например, если указано значение 6, то возвращаются все события со значениями HealthState "ОК" (2) и "Warning" (4).  <br> -Default — значение по умолчанию. Соответствует любому значению HealthState. Значение равно нулю.  <br> -None — фильтр, который не соответствует какому-либо значению HealthState. Используется для возвращения нуля результатов для определенной коллекции состояний. Значение равно 1.  <br> -ОК — фильтр, извлекающий входные данные с HealthState со значением "Ок". Значение равно 2.  <br> -Warning — фильтр, извлекающий входные данные с HealthState со значением "Warning". Значение равно 4.  <br> -Error — фильтр, извлекающий входные данные с HealthState со значением "Error". Значение равно 8.  <br> -All — фильтр, извлекающий входные данные с любым значением HealthState. Значение равно 65 535. |
| --exclude-health-statistics | Указывает, должна ли возвращаться статистика работоспособности в составе результатов запроса. Значение по умолчанию: false. Статистика содержит число дочерних сущностей в состоянии работоспособности OK, Warning и Error. |
| --include-system-application-health-statistics | Указывает, следует ли включать в статистику работоспособности сведения о приложении fabric\:/System. Значение по умолчанию: false. Если для IncludeSystemApplicationHealthStatistics задано значение true, то статистика работоспособности включает в себя сущности, относящиеся к приложению fabric\:/System. В противном случае результат запроса содержит только статистику работоспособности приложений пользователя. Для применения этого параметра в результат запроса должна быть включена статистика работоспособности. |
| --nodes-health-state-filter | Позволяет фильтровать объекты состояния работоспособности узла, возвращаемые в результате запроса работоспособности кластера, по состоянию работоспособности. Возможные значения для этого параметра — целочисленное значение одного из приведенных ниже состояний работоспособности. Возвращаются только те узлы, которые соответствуют заданному фильтру. Для оценки общего состояния работоспособности используются все узлы. Если фильтр не указан, возвращаются все записи. Значения состояния представляют собой перечисление на основе флага, поэтому значение может представлять собой сочетание этих значений, полученное с помощью битового оператора "ИЛИ". Например, если указано значение 6, то возвращается состояние работоспособности узлов со значениями HealthState "OK" (2) и "Warning" (4).  <br> -Default — значение по умолчанию. Соответствует любому значению HealthState. Значение равно нулю.  <br> -None — фильтр, который не соответствует какому-либо значению HealthState. Используется для возвращения нуля результатов для определенной коллекции состояний. Значение равно 1.  <br> -ОК — фильтр, извлекающий входные данные с HealthState со значением "Ок". Значение равно 2.  <br> -Warning — фильтр, извлекающий входные данные с HealthState со значением "Warning". Значение равно 4.  <br> -Error — фильтр, извлекающий входные данные с HealthState со значением "Error". Значение равно 8.  <br> -All — фильтр, извлекающий входные данные с любым значением HealthState. Значение равно 65 535. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-manifest"></a>sfctl cluster manifest
Возвращает манифест кластера Service Fabric.

Возвращает манифест кластера Service Fabric. Манифест кластера содержит свойства кластера, включающие различные типы узлов в кластере, конфигурации безопасности, топологии сбоя и домена обновления и т. д. Эти свойства указываются как часть ClusterConfig.JSв файле при развертывании автономного кластера. Однако большая часть информации в манифесте кластера создается внутренними процессами Service Fabric во время развертывания кластера в других сценариях развертывания (например, при использовании портала Azure). Содержимое манифеста кластера является исключительно информационным, и пользователи не должны устанавливать зависимости от формата содержимого этого файла или его интерпретации.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-operation-cancel"></a>sfctl cluster operation-cancel
Отменяет операцию при ошибке, вызываемую пользователем.

Следующие API-интерфейсы запускают операции сбоя, которые могут быть отменены с помощью Канцелоператион \: стартдаталосс, старткуорумлосс, стартпартитионрестарт, стартнодетранситион. Если для force задано значение false, то указанная операция, вызываемая пользователем, будет корректно остановлена и очищена.  Если для force задано значение true, команда будет прервана и внутреннее состояние может проигнорироваться.  Следует с осторожностью использовать true в качестве значения force. Если для force задано значение true, вызов этого API будет запрещен, пока этот API не будет вызван в той же тестовой команде, в которой для force задано значение false, или же если в команде параметр OperationState уже имеет значение OperationState.RollingBack. Уточнение\: OperationState.RollingBack означает, что система очистит или очищает внутреннее состояние системы, вызванное выполнением команды.  Данные не восстановятся, если тестовая команда привела к их потере.  Например, если вызвать StartDataLoss, а затем этот API, система только очистит внутреннее состояние от запуска команды. Данные целевой секции не восстановятся, если команда выполнялась достаточное время, что вызвало потерю данных. Внимание! \:  Если этот API вызывается с параметром Force = = true, внутреннее состояние может остаться за ним.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --operation-id [обязательный параметр] | Идентификатор GUID, определяющий вызов этого API.  Он передается в соответствующий API GetProgress. |
| --force | Указывает, следует ли корректно выполнить откат и очистить внутреннее состояние системы, изменяемое при выполнении операции, вызываемой пользователем. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-operation-list"></a>sfctl cluster operation-list
Возвращает список операций при ошибке, вызываемых пользователем, отфильтрованный по введенным параметрам.

Возвращает список операций при ошибке, вызываемых пользователем, отфильтрованный по введенным параметрам.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --state-filter | Используется для фильтрации по OperationState для операций, вызываемых пользователем. -65535-SELECT ALL-1 — Выберите выполнение-2-SELECT Роллингбакк-8 — SELECT Completed-16 — SELECT Faultedd-32-SELECT отменено-64 — выберите ForceCancelled.  Значение по умолчанию\: 65535. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |
| --type-filter | Используется для фильтрации по OperationType для операций, вызываемых пользователем. -65535-SELECT ALL-1 — Выберите Партитиондаталосс. -2 — Выберите Партитионкуорумлосс. -4 — Выберите Партитионрестарт. -8 — выберите Нодетранситион.  Значение по умолчанию\: 65535. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-provision"></a>sfctl cluster provision
Подготавливает пакеты кода или конфигурации кластера Service Fabric.

Проверяет и подготавливает пакеты кода или конфигурации кластера Service Fabric.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --cluster-manifest-file-path | Путь к файлу манифеста кластера. |
| --code-file-path | Путь к файлу пакета кода кластера. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-recover-system"></a>sfctl cluster recover-system
Указывает кластеру Service Fabric, что следует попытаться восстановить системные службы, которые в настоящее время находятся в состоянии потери кворума.

Указывает кластеру Service Fabric, что следует попытаться восстановить системные службы, которые в настоящее время находятся в состоянии потери кворума. Эту операцию следует выполнять только в том случае, если известно, что неработающие реплики невозможно восстановить. Неправильное использование этого API может привести к потере данных.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-report-health"></a>sfctl cluster report-health
Отправляет отчет о работоспособности кластера Service Fabric.

Отправляет отчет о работоспособности в кластер Service Fabric. Отчет должен содержать информацию об источнике отчета о работоспособности и свойстве, в котором об этом сообщается. Отчет отправляется на узел шлюза Service Fabric, который передает его в хранилище данных о работоспособности. Отчет может быть принят шлюзом, но затем отклонен хранилищем данных о работоспособности после дополнительной проверки. Например, хранилище данных о работоспособности может отклонить отчет из-за недопустимого параметра, например устаревшего порядкового номера. Чтобы узнать, был ли отчет применен в хранилище данных о работоспособности, запустите Жетклустерхеалс и убедитесь, что отчет отображается в разделе Хеалсевентс.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --health-property [обязательный параметр] | Свойство информации о работоспособности. <br><br> Один объект может возвращать отчеты о работоспособности для разных свойств. Это свойство имеет строковый формат, а не фиксированное перечисление, чтобы создатель отчетов мог гибко классифицировать состояние, активировавшее отчет. Например, создатель отчета с идентификатором источника LocalWatchdog может отслеживать состояние доступного дискового пространства на узле и передавать для этого узла свойство AvailableDisk. Этот же создатель отчета может отслеживать подключения узла и передавать свойство Connectivity для того же узла. В хранилище данных о работоспособности эти отчеты обрабатываются как независимые события работоспособности для указанного узла. Кроме идентификатора источника, свойство однозначно идентифицирует данные о работоспособности. |
| --health-state [обязательный параметр] | Допускаются следующие значения\: Invalid, OK, Warning, Error или Unknown. |
| --source-id [обязательный параметр] | Имя источника, которое определяет клиента, службу наблюдения или компонент системы, создавший информацию о работоспособности. |
| --description | Описание информации о работоспособности. <br><br> Это свойство предоставляет информацию об отчете в произвольном текстовом формате, доступном для чтения. Максимальная длина строки для описания составляет 4096 символов. Более длинные строки автоматически усекаются. При усечении в последние символы описания помещается маркер [Truncated], длина которого входит в строку длиной 4096 символов. Наличие маркера указывает на усечение. Обратите внимание, что усеченное описание включает менее 4096 символов исходной строки. |
| --immediate | Этот флаг обозначает, что отчет нужно отправить немедленно. <br><br> Отчет о работоспособности отправляется в приложение шлюза Service Fabric, которое передает его в хранилище данных о работоспособности. Если флагу Immediate задано значение true, отчет немедленно отправляется через шлюз HTTP в хранилище данных о работоспособности, независимо от параметров клиента структуры, которые использует приложение шлюза HTTP. Это полезно для критически важных отчетов, которые необходимо передать как можно быстрее. В зависимости от времени и других условий отправка отчета может завершиться сбоем, например, если шлюз HTTP закрыт или сообщение не достигает этого шлюза. Если флагу Immediate задано значение false, отчет отправляется с учетом параметров клиента работоспособности через шлюз HTTP. Это значит, что он будет включен в пакет отчетов в соответствии со значением параметра HealthReportSendInterval. Рекомендуется применять именно такой вариант, так как он позволяет клиенту работоспособности оптимизировать отправку отчетов в хранилище данных о работоспособности, а также обработку отчетов о работоспособности. По умолчанию отчеты не отправляются немедленно. |
| --remove-when-expired | Это значение указывает, удаляется ли отчет из хранилища работоспособности после истечения срока его действия. <br><br> Если задано значение true, отчет будет удален из хранилища работоспособности после истечения срока его действия. Если задано значение false, отчет с истекшим сроком действия рассматривается как указывающий на ошибку. Для этого свойства по умолчанию используется значение false. Если клиенты создают периодические отчеты, для параметра RemoveWhenExpired следует использовать значение false (по умолчанию). Если возникнет проблема с создателем отчетов (например, взаимоблокировка), не позволяющая ему отправить следующий отчет, это позволит зарегистрировать ошибку для сущности с истекшим отчетом о работоспособности. Такая сущность будет находиться в состоянии "Ошибка работоспособности". |
| --sequence-number | Порядковый номер отчета о работоспособности в формате числовой строки. <br><br> Порядковый номер отчета используется хранилищем данных о работоспособности для отслеживания устаревших отчетов. Если значение не указано, порядковый номер автоматически создается клиентом работоспособности при добавлении отчета. |
| --timeout -t | Значение по умолчанию\: 60. |
| --ttl | Срок, в течение которого отчет о работоспособности считается действительным. В этом поле указывается длительность в формате ISO8601. <br><br> Если клиенты создают периодические отчеты, периодичность отправки отчетов должна быть выше, чем срок жизни отчетов. Если клиенты передают отчеты об изменении состояния, для них можно установить бесконечный срок действия. По истечении срока жизни событие работоспособности, которое содержит данные о работоспособности, удаляется из хранилища данных о работоспособности (если RemoveWhenExpired имеет значение true) или считается ошибкой (если RemoveWhenExpired имеет значение false). Если значение не указано, по умолчанию устанавливается бесконечный срок жизни. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-select"></a>sfctl cluster select
Выполняет подключение к конечной точке кластера Service Fabric.

При подключении к защищенному кластеру укажите сертификат (CRT-файл) и файл ключа (KEY-файл) или отдельный файл, содержащий сертификат и ключ (PEM-файл). Не указывайте и то, и другое. При подключении к защищенному кластеру укажите также абсолютный путь к файлу пакета ЦС или каталогу сертификатов доверенного ЦС (при необходимости).  Нет подключения к кластеру, не выполняя эту команду первыми, включая подключение к localhost. Однако явная конечная точка не требуется для подключения к локальному кластеру.  Если используется самозаверяющий сертификат или другой сертификат, не подписанный хорошо известным центром сертификации, передайте параметр--CA, чтобы убедиться, что проверка пройдена. Если не находится в рабочем кластере, для обхода проверки на стороне клиента (удобно для самостоятельно подписанного или неизвестного подписанного ЦС) используйте параметр--No-Verify. Хотя это и возможно, не рекомендуется для рабочих кластеров. В противном случае может возникнуть ошибка проверки сертификата.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --aad | Использование аутентификации Azure Active Directory. |
| --ca | Абсолютный путь к каталогу сертификатов ЦС, которые следует считать действительными, или путь к файлу пакета ЦС. При использовании каталога сертификатов ЦС значение `c_rehash <directory>`, предоставленное OpenSSL, следует выполнить первым, чтобы вычислить хэши сертификатов и создать соответствующие символьные ссылки. Используется для проверки допустимости сертификата, возвращенного кластером. |
| --cert | Абсолютный путь к файлу сертификата клиента. |
| --Конечная точка | URL-адрес конечной точки кластера, включая порт и префикс HTTP или HTTPS. Как правило, конечная точка будет выглядеть так, как HTTPS \: //<URL-адрес>\: 19080. Если конечная точка не указана, по умолчанию будет выбран HTTP \: //localhost \: 19080.  \:Http//localhost 19080 по умолчанию \: \: . |
| --key | Абсолютный путь к файлу ключа сертификата клиента. |
| --no-verify | Отключает проверку сертификатов при использовании HTTPS. Примечание \: Это небезопасный параметр, и он не должен использоваться для рабочей среды. |
| --pem | Абсолютный путь к PEM-файлу сертификата клиента. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-show-connection"></a>sfctl cluster show-connection
Показывает, к какому кластеру Service Fabric подключен этот экземпляр sfctl.

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-unprovision"></a>sfctl cluster unprovision
Отменяет подготовку пакетов кода или конфигурации кластера Service Fabric.

Поддерживается отмена подготовки кода и конфигурации отдельно.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --code-version | Версия пакета кода кластера. |
| --config-version | Версия манифеста кластера. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-upgrade"></a>sfctl cluster upgrade
Запускает обновление пакетов кода или конфигурации кластера Service Fabric.

Проверяет указанные параметры обновления и начинает обновление версии кода или конфигурации кластера Service Fabric, если параметры являются допустимыми.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --app-health-map | Словарь в формате JSON, содержащий пары из имени приложения и максимального процента неработоспособности, по достижении которого порождается ошибка. |
| --app-type-health-map | Словарь в формате JSON, содержащий пары из имени типа приложения и максимального процента неработоспособности, по достижении которого порождается ошибка. |
| --code-version | Версия кода кластера. |
| --config-version | Версия конфигурации кластера. |
| --delta-health-evaluation | Включает разностную оценку работоспособности вместо абсолютной оценки работоспособности после завершения выполнения каждого домена обновления. |
| --delta-unhealthy-nodes | Максимальный процент неработоспособных узлов, допускаемый во время обновления кластера.  Значение по умолчанию\: 10. <br><br> Разница измеряется между состоянием узлов в начале обновления и во время оценки работоспособности. После завершения обновления каждый домен обновления выполняет проверку того, находится ли общее состояние доменов обновления в допустимых пределах. |
| --failure-action | Возможные значения\: Invalid, Rollback, Manual. |
| --force-restart | Принудительный перезапуск процессов при обновлении, даже если версии кода не изменены. <br><br> При обновлении изменяется только конфигурация или данные. |
| --health-check-retry | Продолжительность времени между попытками выполнить проверку работоспособности, если приложение или кластер неработоспособны. |
| --health-check-stable | Период времени, в течение которого приложение или кластер должен оставаться работоспособным, прежде чем процесс обновления перейдет к следующему домену обновления. <br><br> Сначала он интерпретируется как строка, представляющая длительность ISO 8601. В случае неудачи он интерпретируется как число, представляющее общее количество миллисекунд. |
| --health-check-wait | Продолжительность ожидания после завершения обновления домена до начала процесса проверки работоспособности. |
| --replica-set-check-timeout | Максимальный период времени, на протяжении которого можно блокировать обработку домена обновления и не допустить потери доступности в случае возникновения непредвиденных проблем. <br><br> По истечении времени ожидания обработка домена обновления будет выполняться независимо от проблем с потерей доступа. Время ожидания сбрасывается при запуске каждого домена обновления. Допустимые значения — от 0 до 42949672925 включительно. |
| --rolling-upgrade-mode | Возможные значения\: Invalid, UnmonitoredAuto, UnmonitoredManual, Monitored.  Значение по умолчанию\: UnmonitoredAuto. |
| --timeout -t | Значение по умолчанию\: 60. |
| --unhealthy-applications | Максимально допустимый процент неработоспособных приложений, по достижении которого отображается сообщение об ошибке. <br><br> Например, чтобы разрешить 10 % неработоспособных приложений, это значение должно быть равно 10. Это значение указывает максимально допустимый процент неработоспособных приложений, превышение которого вызывает состояние "Error" при оценке кластера. Если процент учитывается, но имеется по крайней мере одно неработоспособное приложение, то состояние работоспособности оценивается как "Warning". Это значение вычисляется путем деления числа неработоспособных приложений на общее число экземпляров приложения в кластере, за исключением приложений, типы которых указаны в ApplicationTypeHealthPolicyMap. Расчет округляется: на небольшом количестве приложений допускается один сбой. |
| --unhealthy-nodes | Максимально допустимый процент неработоспособных узлов, по достижении которого отображается сообщение об ошибке. <br><br> Например, чтобы разрешить 10 % неработоспособных узлов, это значение должно быть равно 10. Это значение указывает максимально допустимый процент неработоспособных узлов, превышение которого вызывает состояние "Error" при оценке кластера. Если процент учитывается, но имеется по крайней мере один неработоспособный узел, то состояние работоспособности оценивается как "Warning". Это процентное значение вычисляется путем деления числа неработоспособных узлов за общее число узлов в кластере. Расчет округляется: на небольшом количестве узлов допускается один сбой. В крупных кластерах всегда есть отключенные узлы или узлы в состоянии восстановления. Следует учитывать это при настройке параметра. |
| --upgrade-domain-delta-unhealthy-nodes | Максимальный процент неработоспособных узлов домена обновления, допускаемый во время обновления кластера.  Значение по умолчанию\: 15. <br><br> Разница измеряется между состоянием узлов домена обновления в начале обновления и во время оценки работоспособности. После завершения обновления каждый домен обновления выполняет проверку для всех доменов обновления, завершивших обновление, находится ли состояние этих доменов в допустимых пределах. |
| --upgrade-domain-timeout | Время выполнения каждого домена обновления, по истечении которого выполняется действие FailureAction. <br><br> Сначала он интерпретируется как строка, представляющая длительность ISO 8601. В случае неудачи он интерпретируется как число, представляющее общее количество миллисекунд. |
| --upgrade-timeout | Общее время завершения обновления, по истечении которого выполняется действие FailureAction. <br><br> Сначала он интерпретируется как строка, представляющая длительность ISO 8601. В случае неудачи он интерпретируется как число, представляющее общее количество миллисекунд. |
| --warning-as-error | Указывает, учитываются ли предупреждения с той же степенью серьезности, что и ошибки. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-upgrade-resume"></a>sfctl cluster upgrade-resume
Выполняет переход процесса обновления кластера к следующему домену обновления.

Переместите код кластера или обновление конфигурации на следующий домен обновления при необходимости.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --upgrade-domain [обязательный параметр] | Следующий домен обновления для этого обновления кластера. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-upgrade-rollback"></a>sfctl cluster upgrade-rollback
Откатывает обновление кластера Service Fabric.

Откатите обновление кода или конфигурации кластера Service Fabric.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-upgrade-status"></a>sfctl cluster upgrade-status
Возвращает ход выполнения текущего обновления кластера.

Возвращает текущий ход выполнения текущего обновления кластера. Если обновление не выполняется, вы получите последнее состояние предыдущего обновления кластера.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-cluster-upgrade-update"></a>sfctl cluster upgrade-update
Обновляет параметры обновления кластера Service Fabric.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --app-health-map | Словарь в формате JSON, содержащий пары из имени приложения и максимального процента неработоспособности, по достижении которого порождается ошибка. |
| --app-type-health-map | Словарь в формате JSON, содержащий пары из имени типа приложения и максимального процента неработоспособности, по достижении которого порождается ошибка. |
| --delta-health-evaluation | Включает разностную оценку работоспособности вместо абсолютной оценки работоспособности после завершения выполнения каждого домена обновления. |
| --delta-unhealthy-nodes | Максимальный процент неработоспособных узлов, допускаемый во время обновления кластера.  Значение по умолчанию\: 10. <br><br> Разница измеряется между состоянием узлов в начале обновления и во время оценки работоспособности. После завершения обновления каждый домен обновления выполняет проверку того, находится ли общее состояние доменов обновления в допустимых пределах. |
| --failure-action | Возможные значения\: Invalid, Rollback, Manual. |
| --force-restart | Принудительный перезапуск процессов при обновлении, даже если версии кода не изменены. <br><br> При обновлении изменяется только конфигурация или данные. |
| --health-check-retry | Продолжительность времени между попытками выполнить проверку работоспособности, если приложение или кластер неработоспособны. |
| --health-check-stable | Период времени, в течение которого приложение или кластер должен оставаться работоспособным, прежде чем процесс обновления перейдет к следующему домену обновления. <br><br> Сначала он интерпретируется как строка, представляющая длительность ISO 8601. В случае неудачи он интерпретируется как число, представляющее общее количество миллисекунд. |
| --health-check-wait | Продолжительность ожидания после завершения обновления домена до начала процесса проверки работоспособности. |
| --replica-set-check-timeout | Максимальный период времени, на протяжении которого можно блокировать обработку домена обновления и не допустить потери доступности в случае возникновения непредвиденных проблем. <br><br> По истечении времени ожидания обработка домена обновления будет выполняться независимо от проблем с потерей доступа. Время ожидания сбрасывается при запуске каждого домена обновления. Допустимые значения — от 0 до 42949672925 включительно. |
| --rolling-upgrade-mode | Возможные значения\: Invalid, UnmonitoredAuto, UnmonitoredManual, Monitored.  Значение по умолчанию\: UnmonitoredAuto. |
| --timeout -t | Значение по умолчанию\: 60. |
| --unhealthy-applications | Максимально допустимый процент неработоспособных приложений, по достижении которого отображается сообщение об ошибке. <br><br> Например, чтобы разрешить 10 % неработоспособных приложений, это значение должно быть равно 10. Это значение указывает максимально допустимый процент неработоспособных приложений, превышение которого вызывает состояние "Error" при оценке кластера. Если процент учитывается, но имеется по крайней мере одно неработоспособное приложение, то состояние работоспособности оценивается как "Warning". Это значение вычисляется путем деления числа неработоспособных приложений на общее число экземпляров приложения в кластере, за исключением приложений, типы которых указаны в ApplicationTypeHealthPolicyMap. Расчет округляется: на небольшом количестве приложений допускается один сбой. |
| --unhealthy-nodes | Максимально допустимый процент неработоспособных узлов, по достижении которого отображается сообщение об ошибке. <br><br> Например, чтобы разрешить 10 % неработоспособных узлов, это значение должно быть равно 10. Это значение указывает максимально допустимый процент неработоспособных узлов, превышение которого вызывает состояние "Error" при оценке кластера. Если процент учитывается, но имеется по крайней мере один неработоспособный узел, то состояние работоспособности оценивается как "Warning". Это процентное значение вычисляется путем деления числа неработоспособных узлов за общее число узлов в кластере. Расчет округляется: на небольшом количестве узлов допускается один сбой. В крупных кластерах всегда есть отключенные узлы или узлы в состоянии восстановления. Следует учитывать это при настройке параметра. |
| --upgrade-domain-delta-unhealthy-nodes | Максимальный процент неработоспособных узлов домена обновления, допускаемый во время обновления кластера.  Значение по умолчанию\: 15. <br><br> Разница измеряется между состоянием узлов домена обновления в начале обновления и во время оценки работоспособности. После завершения обновления каждый домен обновления выполняет проверку для всех доменов обновления, завершивших обновление, находится ли состояние этих доменов в допустимых пределах. |
| --upgrade-domain-timeout | Время выполнения каждого домена обновления, по истечении которого выполняется действие FailureAction. <br><br> Сначала он интерпретируется как строка, представляющая длительность ISO 8601. В случае неудачи он интерпретируется как число, представляющее общее количество миллисекунд. |
| --upgrade-kind | Возможные значения\: Invalid, Rolling, Rolling_ForceRestart.  Значение по умолчанию\: Rolling. |
| --upgrade-timeout | Общее время завершения обновления, по истечении которого выполняется действие FailureAction. <br><br> Сначала он интерпретируется как строка, представляющая длительность ISO 8601. В случае неудачи он интерпретируется как число, представляющее общее количество миллисекунд. |
| --warning-as-error | Указывает, учитываются ли предупреждения с той же степенью серьезности, что и ошибки. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |


## <a name="next-steps"></a>Дальнейшие действия
- [Настройте](service-fabric-cli.md) интерфейс командной строки Service Fabric.
- Узнайте, как использовать интерфейс командной строки Service Fabric, с помощью [примеров сценариев](./scripts/sfctl-upgrade-application.md).
