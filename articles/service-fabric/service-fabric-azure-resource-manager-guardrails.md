---
title: Service Fabric Azure Resource Manager снятие развертывания
description: В этой статье представлен обзор распространенных ошибок, возникших при развертывании кластера Service Fabric с помощью Azure Resource Manager, и способы их устранения.
services: service-fabric
documentationcenter: .net
author: peterpogorski
ms.topic: conceptual
ms.date: 02/13/2020
ms.author: pepogors
ms.openlocfilehash: aa1499c57ead28bfcee90a2f224ef9c3bb1d7f58
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "86247830"
---
# <a name="service-fabric-guardrails"></a>Service Fabric снятие 
При развертывании кластера Service Fabric помещаются снятие, что приведет к сбою развертывания Azure Resource Manager в случае недопустимой конфигурации кластера. В следующих разделах приведены общие сведения о распространенных проблемах с конфигурацией кластера и действия, необходимые для устранения этих проблем. 

## <a name="durability-mismatch"></a>Несоответствие устойчивости
### <a name="overview"></a>Обзор
Значение устойчивости для типа узла Service Fabric определяется в двух разных разделах шаблона Azure Resource Manager. Раздел расширения масштабируемого набора виртуальных машин в ресурсе масштабируемого набора виртуальных машин и раздел типа узла в ресурсе кластера Service Fabric. Необходимо, чтобы значение устойчивости в этих разделах совпадало, в противном случае произойдет сбой развертывания ресурса.

Следующий раздел содержит пример несоответствия устойчивости между параметром устойчивости расширения масштабируемого набора виртуальных машин и параметром устойчивости типа узла Service Fabric.  

**Параметр устойчивости масштабируемого набора виртуальных машин**
```json 
{
  "extensions": [
    {
      "name": "[concat('ServiceFabricNodeVmExt','_vmNodeType0Name')]",
      "properties": {
        "type": "ServiceFabricNode",
        "publisher": "Microsoft.Azure.ServiceFabric",
        "settings": {
          "durabilityLevel": "Silver",
        }
      }
    }
  ]
}
```

**Параметр устойчивости типа узла Service Fabric** 
```json
{
  "nodeTypes": [
    {
      "name": "[variables('vmNodeType0Name')]",
      "durabilityLevel": "Bronze",
      "isPrimary": true,
      "vmInstanceCount": "[parameters('nt0InstanceCount')]"
    }
  ]
}
```

### <a name="error-messages"></a>Сообщения об ошибках
* Несоответствие устойчивости масштабируемого набора виртуальных машин не соответствует текущему уровню устойчивости типа узла Service Fabric
* Устойчивость масштабируемого набора виртуальных машин не соответствует целевому Service Fabric уровня устойчивости типа узла
* Устойчивость масштабируемого набора виртуальных машин соответствует текущему уровню устойчивости Service Fabric или целевому Service Fabricному типу узла уровня устойчивости 

### <a name="mitigation"></a>Меры по снижению риска
Чтобы устранить несоответствие устойчивости, оно обозначается любым из указанных выше сообщений об ошибке:
1. Обновите уровень устойчивости в разделе "расширение масштабируемого набора виртуальных машин" или "тип узла Service Fabric" шаблона Azure Resource Manager, чтобы убедиться, что значения совпадают.
2. Повторно разверните шаблон Azure Resource Manager с обновленными значениями.


## <a name="seed-node-deletion"></a>Удаление начального узла 
### <a name="overview"></a>Обзор
Кластер Service Fabric имеет свойство [уровня надежности](./service-fabric-cluster-capacity.md#reliability-characteristics-of-the-cluster) , которое используется для определения количества реплик системных служб, выполняемых в основном типе узла кластера. Количество необходимых реплик определит минимальное количество узлов, которые должны поддерживаться в типе основного узла кластера. Если число узлов в типе первичного узла ниже минимально необходимого для уровня надежности, кластер станет нестабильным.  

### <a name="error-messages"></a>Сообщения об ошибках 
Операция удаления начального узла обнаружена и будет отклонена. 
* Эта операция приведет {0} к тому, что в кластере будут оставаться только потенциальные узлы начальных значений, хотя {1} они должны быть минимальными.
* Удаление {0} начальных узлов из приведет {1} к тому, что кластер будет отключен из-за потери кворума узла заполнения. Максимальное число узлов начальных значений, которые могут быть удалены за раз, равно {2} .
 
### <a name="mitigation"></a>Меры по снижению риска 
Убедитесь, что тип первичного узла содержит достаточно виртуальных машин для надежности, указанной в кластере. Вы не сможете удалить виртуальную машину, если она сделает масштабируемый набор виртуальных машин меньше минимального количества узлов для данного уровня надежности.
* Если уровень надежности указан правильно, убедитесь, что в типе первичного узла имеется достаточное количество узлов, необходимое для уровня надежности. 
* Если уровень надежности неправилен, инициируйте изменение ресурса Service Fabric, чтобы уменьшить уровень надежности перед запуском любых операций масштабирования виртуальных машин и дождитесь ее завершения.
* Если уровень надежности — бронзовый, выполните следующие [действия](./service-fabric-cluster-scale-in-out.md#manually-remove-vms-from-a-node-typevirtual-machine-scale-set) для корректного масштабирования кластера.

## <a name="next-steps"></a>Дальнейшие действия
* Создание кластера на основе виртуальных машин или компьютеров под управлением Windows Server: [Создание кластера Azure Service Fabric в локальной или облачной средах](service-fabric-cluster-creation-for-windows-server.md)
* Создание кластера на основе виртуальных машин или компьютеров под управлением Linux: [Создание кластера Linux](service-fabric-cluster-creation-via-portal.md).
* Устранение неполадок Service Fabric: [руководства по устранению неполадок](https://github.com/Azure/Service-Fabric-Troubleshooting-Guides)
