---
title: Диагностика ошибок пакета общего кода с помощью Service Fabric
description: Узнайте, как устранять распространенные ошибки пакетов кода с помощью Azure Service Fabric
author: grzuber
ms.topic: article
ms.date: 05/09/2019
ms.author: grzuber
ms.openlocfilehash: 400651b240f0518a85b9deb7a7293a77a88b0861
ms.sourcegitcommit: e559daa1f7115d703bfa1b87da1cf267bf6ae9e8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "100591711"
---
# <a name="diagnose-common-code-package-errors-by-using-service-fabric"></a>Диагностика ошибок пакета общего кода с помощью Service Fabric

В этой статье описывается, что означает, что пакет кода неожиданно завершает работу. Он предоставляет сведения о возможных причинах распространенных кодов ошибок, а также действия по устранению неполадок.

## <a name="when-does-a-process-or-container-terminate-unexpectedly"></a>Когда неожиданно прекращается процесс или контейнер?

Когда Service Fabric Azure получает запрос на запуск пакета кода, он начинает подготовку среды в локальной системе в соответствии с параметрами, заданными в манифестах приложения и службы. Эти подготовительные действия могут включать в себя резервирование сетевых конечных точек или ресурсов, настройку правил брандмауэра или настройку ограничений управления ресурсами. 

После правильной настройки среды Service Fabric пытается открыть пакет кода. Этот шаг считается успешным, если среда выполнения ОС или контейнера сообщает о том, что процесс или контейнер был успешно активирован. Если активация завершается неудачно, вы увидите сообщение о работоспособности в SFX, похожее на следующее:

```
There was an error during CodePackage activation. Service host failed to activate. Error: 0xXXXXXXXX
```

После успешной активации пакета кода Service Fabric начинает отслеживать его время существования. На этом этапе процесс или контейнер могут завершиться в любое время по ряду причин. Например, возможно, произошел сбой инициализации библиотеки DLL или в операционной системе не хватает пространства кучи рабочего стола. Если пакет кода завершен, вы увидите следующее сообщение о работоспособности в SFX:

```
The process/container terminated with exit code: XXXXXXXX. Please look at your application logs/dump or debug your code package for more details. For information about common termination errors, please visit https://aka.ms/service-fabric-termination-errors
```

Код выхода в этом сообщении о работоспособности является единственным указанием того, что процесс или контейнер предоставляет сведения о том, почему он завершен. Он может быть создан на любом уровне стека. Например, этот код выхода может быть связан с ошибкой ОС или с проблемой .NET или был вызван кодом. Используйте эту статью в качестве отправной точки для диагностики источника кодов завершения и возможных решений. Но помните, что это общие решения для распространенных сценариев, которые могут не относиться к наблюдаемой ошибке.

## <a name="how-can-i-tell-if-service-fabric-terminated-my-code-package"></a>Как узнать, завершил ли Service Fabric пакет кода?

Service Fabric может отвечать за завершение пакета кода по различным причинам. Например, пакет кода может быть размещен на другом узле для балансировки нагрузки. Вы можете проверить, что Service Fabric завершили работу пакета кода, если вы видите любой из кодов выхода в следующей таблице.

>[!NOTE]
> Если процесс или контейнер завершается с кодом выхода, отличным от кодов в следующей таблице, Service Fabric не отвечает за его завершение.

Код выхода | Описание
--------- | -----------
7147 | Указывает, что Service Fabric корректно завершить процесс или контейнер, отправив ему сигнал CTRL + C.
7148 | Указывает, что Service Fabric завершил процесс или контейнер. Иногда этот код ошибки указывает на то, что процесс или контейнер не ответил своевременно после отправки сигнала CTRL + C, и его пришлось прерывать.


## <a name="other-common-error-codes-and-their-potential-fixes"></a>Другие распространенные коды ошибок и их возможные исправления

Код выхода | Шестнадцатеричное значение | Краткое описание | Первопричина | Возможное исправление
--------- | --------- | ----------------- | ---------- | -------------
3221225794 | 0xc0000142 | STATUS_DLL_INIT_FAILED | Эта ошибка иногда означает, что на компьютере исчерпана куча рабочего стола. Эта причина особенно высока, если у вас есть множество процессов, принадлежащих приложению, работающему на узле. | Если программа не была создана для реагирования на сигналы CTRL + C, можно включить параметр **енаблеактиватеновиндов** в манифесте кластера. Включение этого параметра означает, что пакет кода будет выполняться без окна графического пользовательского интерфейса и не будет принимать сигналы CTRL + C. Это действие также сокращает объем кучи рабочего стола, занимаемый каждым процессом. Если пакет кода должен получить сигналы CTRL + C, можно увеличить размер кучи рабочего стола вашего узла.
3762504530 | 0xe0434352 | Н/Д | Это значение представляет код ошибки для необработанного исключения из управляемого кода (то есть .NET). | Этот код выхода указывает, что приложение вызвало исключение, которое остается необработанным и завершило процесс. В качестве первого шага при определении того, что активировало эту ошибку, отлаживать журналы и файлы дампа приложения.

## <a name="next-steps"></a>Дальнейшие шаги

* Узнайте больше о [диагностике других распространенных сценариев](service-fabric-diagnostics-common-scenarios.md).
* Ознакомьтесь с подробными сведениями о Azure Monitor журналах и их возможностях, прочитав [Azure Monitor обзор](../azure-monitor/overview.md).
* Дополнительные сведения о Azure Monitor журналов [оповещений](../azure-monitor/alerts/alerts-overview.md) см. в статье об обнаружении и диагностике.
* Ознакомьтесь с функциями [поиска по журналам и запросами](../azure-monitor/logs/log-query-overview.md) , предлагаемыми в составе журналов Azure Monitor.
