---
title: Управляемые удостоверения для Azure
description: Узнайте, как использовать управляемые удостоверения для Azure с Service Fabric.
ms.topic: conceptual
ms.date: 12/09/2019
ms.openlocfilehash: 71fa9ef4da8081a167b68553e2e3eac8477e8aee
ms.sourcegitcommit: aaa65bd769eb2e234e42cfb07d7d459a2cc273ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/27/2021
ms.locfileid: "98881726"
---
# <a name="using-managed-identities-for-azure-with-service-fabric"></a>Использование управляемых удостоверений для Azure с Service Fabric

Распространенной проблемой при создании облачных приложений является безопасное управление учетными данными в коде для проверки подлинности в различных службах, не сохраняя их локально на рабочей станции разработчика или в системе управления версиями. *Управляемые удостоверения для Azure* решают эту проблему для всех ресурсов в Azure Active Directory (Azure AD), предоставляя им автоматически управляемые удостоверения в Azure AD. Удостоверение службы можно использовать для проверки подлинности любой службы, поддерживающей проверку подлинности Azure AD, включая Key Vault, без каких-либо учетных данных, хранящихся в коде.

*Управляемые удостоверения для ресурсов Azure* бесплатно предоставляются с помощью Azure AD для подписок Azure. Дополнительные затраты отсутствуют.

> [!NOTE]
> *Управляемые удостоверения для Azure* — это новое имя для службы, ранее известное как управляемое удостоверение службы (MSI).

## <a name="concepts"></a>Основные понятия

Управляемые удостоверения для Azure основаны на нескольких ключевых концепциях:

- **Идентификатор клиента** — уникальный идентификатор, СОЗДАННЫЙ Azure AD, привязанный к приложению и субъекту-службе во время начальной подготовки (также см. [идентификатор приложения](../active-directory/develop/developer-glossary.md#application-id-client-id)).

- **Идентификатор субъекта** — идентификатор объекта субъекта-службы для управляемого удостоверения, который используется для предоставления доступа на основе ролей к ресурсу Azure.

- **Субъект-служба** — объект Azure Active Directory, представляющий проекцию приложения AAD в заданном клиенте (см. также [субъект-служба](../active-directory/develop/developer-glossary.md#service-principal-object)).

Существует два типа управляемых удостоверений.

- **Управляемое системой удостоверение** включается непосредственно в экземпляре службы Azure.  Жизненный цикл удостоверения, назначенного системой, уникален для экземпляра службы Azure, на котором она включена.
- **Назначаемое пользователем управляемое удостоверение** создается как изолированный ресурс Azure. Удостоверение может быть назначено одному или нескольким экземплярам службы Azure и управляться отдельно от жизненных циклов этих экземпляров.

Дополнительные сведения о различиях между управляемыми типами удостоверений см. в статье [как работают управляемые удостоверения для ресурсов Azure](../active-directory/managed-identities-azure-resources/overview.md#managed-identity-types).

## <a name="supported-scenarios-for-service-fabric-applications"></a>Поддерживаемые сценарии для приложений Service Fabric

Управляемые удостоверения для Service Fabric поддерживаются только в кластерах Service Fabric, развернутых в Azure, и только для приложений, развернутых в качестве ресурсов Azure. приложению, которое не развернуто в качестве ресурса Azure, нельзя назначить удостоверение. Концептуально говоря, поддержка управляемых удостоверений в кластере Azure Service Fabric состоит из двух этапов:

1. Назначение одного или нескольких управляемых удостоверений ресурсу приложения; приложению может быть назначено одно назначенное системой удостоверение и (или) до 32 учетных записей, назначенных пользователем соответственно.

2. В определении приложения Сопоставьте одно из удостоверений, назначенных приложению, с любой отдельной службой, включающей приложение.

Назначенное системой удостоверение приложения уникально для этого приложения; назначаемое пользователем удостоверение — это автономный ресурс, который может быть назначен нескольким приложениям. В приложении одно удостоверение (назначенное системой или назначенное пользователем) может быть назначено нескольким службам приложения, но каждой отдельной службе можно назначить только одно удостоверение. Наконец, службе необходимо явно назначить удостоверение для доступа к этой функции. По сути, Сопоставление удостоверений приложения с его составными службами позволяет выполнять изоляцию в приложении — служба может использовать только сопоставленное ей удостоверение.  

В настоящее время для этой функции поддерживаются следующие сценарии:

- Развертывание нового приложения с одной или несколькими службами и одним или несколькими назначенными удостоверениями

- Назначение одного или нескольких управляемых удостоверений существующему приложению (развернутому Azure) для доступа к ресурсам Azure

Следующие сценарии не поддерживаются и не рекомендуются. Обратите внимание, что эти действия могут не блокироваться, но могут привести к простоям приложений:

- Удаление или изменение удостоверений, назначенных приложению; Если необходимо внести изменения, отправьте отдельные развертывания, чтобы сначала добавить новое назначение удостоверений, а затем удалить ранее назначенное. Удаление удостоверения из существующего приложения может привести к нежелательным последствиям, включая сохранение приложения в состоянии, которое не обновляется. Можно полностью удалить приложение, если требуется удалить удостоверение. Обратите внимание, что при этом будет удалено назначенное системой удостоверение (если оно определено), связанное с приложением, и будут удалены все связи с назначенными пользователем удостоверениями, назначенными приложению.

- Service Fabric поддержка управляемых удостоверений в данный момент не интегрирована в [AzureServiceTokenProvider](/dotnet/api/overview/azure/service-to-service-authentication).

## <a name="next-steps"></a>Дальнейшие действия

- [Развертывание нового кластера Azure Service Fabric с поддержкой управляемого удостоверения](./configure-new-azure-service-fabric-enable-managed-identity.md)
- [Включение поддержки управляемого удостоверения в существующем кластере Azure Service Fabric](./configure-existing-cluster-enable-managed-identity-token-service.md)
- [Развертывание приложения Service Fabric Azure с управляемым удостоверением, назначенным системой](./how-to-deploy-service-fabric-application-system-assigned-managed-identity.md)
- [Развертывание приложения Service Fabric Azure с помощью управляемого удостоверения, назначенного пользователем](./how-to-deploy-service-fabric-application-user-assigned-managed-identity.md)
- [Использование управляемого удостоверения Service Fabric приложения из кода службы](./how-to-managed-identity-service-fabric-app-code.md)
- [Предоставление приложению Azure Service Fabric доступа к другим ресурсам Azure](./how-to-grant-access-other-resources.md)
- [Объявление и использование секретов приложения в качестве Кэйваултреференцес](./service-fabric-keyvault-references.md)