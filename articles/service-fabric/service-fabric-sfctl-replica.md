---
title: Azure Service Fabric CLI — реплика sfctl
description: Сведения о sfctl, интерфейсе командной строки Azure Service Fabric. Содержит список команд для управления репликами.
author: jeffj6123
ms.topic: reference
ms.date: 1/16/2020
ms.author: jejarry
ms.openlocfilehash: 3ed1ecca686471e052f07e945738ad1a49e68464
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "86260312"
---
# <a name="sfctl-replica"></a>sfctl replica
Управление репликами, принадлежащими секциям службы.

## <a name="commands"></a>Команды

|Команда|Описание|
| --- | --- |
| deployed | Возвращает сведения о реплике, развернутой на узле Service Fabric. |
| deployed-list | Возвращает сведения о репликах, развернутых на узле Service Fabric. |
| health | Возвращает сведения о работоспособности реплики службы с отслеживанием состояния или экземпляра службы без отслеживания состояния Service Fabric. |
| сведения | Возвращает сведения реплике секции Service Fabric. |
| list | Возвращает сведения репликах секции службы Service Fabric. |
| remove | Удаляет реплику службы, работающую на узле. |
| report-health | Отправляет отчет о работоспособности реплики Service Fabric. |
| restart | Перезапускает реплику сохраненной службы, работающую на узле. |

## <a name="sfctl-replica-deployed"></a>sfctl replica deployed
Возвращает сведения о реплике, развернутой на узле Service Fabric.

Возвращает сведения о реплике, которая развернута на узле Service Fabric. Эти сведения включают в себя вид службы, имя службы, текущую операцию службы, время и дату начала текущей операции службы, идентификатор секции, идентификатор реплики или экземпляра, полученные сведения о нагрузке и другую информацию.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --node-name [обязательный параметр] | Имя узла. |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --replica-id [обязательный параметр] | Идентификатор реплики. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-deployed-list"></a>sfctl replica deployed-list
Возвращает сведения о репликах, развернутых на узле Service Fabric.

Получает список, содержащий информацию о репликах, развернутых на узле Service Fabric. Информация включает в себя идентификатор раздела, идентификатор реплики, состояние реплики, имя службы, имя типа службы и другую информацию. Используйте параметры запроса PartitionId или ServiceManifestName для возврата информации о развернутых репликах, соответствующих указанным значениям для этих параметров.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --application-id [обязательный параметр] | Идентификатор приложения. Обычно это полное имя приложения без указания схемы универсального кода ресурса (URI) "fabric\:". Начиная с версии 6.0, иерархические имена разделяются знаком "\~". Например, если имя приложения — fabric\:/myapp/app1, то в версии 6.0 и более поздних версиях будет использоваться идентификатор приложения myapp\~app1, а в предыдущих версиях — myapp/app1. |
| --node-name [обязательный параметр] | Имя узла. |
| --partition-id | Идентификатор секции. |
| --service-manifest-name | Имя манифеста службы, зарегистрированное для типа приложения в кластере Service Fabric. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-health"></a>sfctl replica health
Возвращает сведения о работоспособности реплики службы с отслеживанием состояния или экземпляра службы без отслеживания состояния Service Fabric.

Возвращает сведения о работоспособности реплики Service Fabric. EventsHealthStateFilter используется для фильтрации получаемой коллекции событий работоспособности реплики на основе состояния работоспособности.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --replica-id [обязательный параметр] | Идентификатор реплики. |
| --events-health-state-filter | Позволяет отфильтровать коллекцию возвращаемых объектов HealthEvent по состоянию работоспособности. Возможные значения для этого параметра — целочисленное значение одного из приведенных ниже состояний работоспособности. Возвращаются только те события, которые соответствуют заданному фильтру. Для оценки общего состояния работоспособности используются все события. Если фильтр не указан, возвращаются все записи. Значения состояния — это перечисление на основе флага, поэтому значение может представлять собой сочетание этих значений, полученное с помощью битового оператора OR. Например, если указано значение 6, то возвращаются все события со значениями HealthState "ОК" (2) и "Warning" (4).  <br> -Default — значение по умолчанию. Соответствует любому значению HealthState. Значение равно нулю.  <br> -None — фильтр, который не соответствует какому-либо значению HealthState. Используется для возвращения нуля результатов для определенной коллекции состояний. Значение равно 1.  <br> -ОК — фильтр, извлекающий входные данные с HealthState со значением "Ок". Значение равно 2.  <br> -Warning — фильтр, извлекающий входные данные с HealthState со значением "Warning". Значение равно 4.  <br> -Error — фильтр, извлекающий входные данные с HealthState со значением "Error". Значение равно 8.  <br> -All — фильтр, извлекающий входные данные с любым значением HealthState. Значение равно 65 535. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-info"></a>sfctl replica info
Возвращает сведения реплике секции Service Fabric.

Ответ содержит идентификатор, роль, состояние, сведения о работоспособности, имя узла, время доступности и другие сведения о реплике.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --replica-id [обязательный параметр] | Идентификатор реплики. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-list"></a>sfctl replica list
Возвращает сведения репликах секции службы Service Fabric.

Конечная точка GetReplicas возвращает сведения о репликах указанной секции. Ответ содержит идентификатор, роль, состояние, сведения о работоспособности, имя узла, время доступности и другие сведения о реплике.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --continuation-token | Параметр маркера продолжения используется для получения следующего набора результатов. Маркер продолжения с непустым значением добавляется в ответ API, когда результаты из системы не помещаются в один ответ. Когда это значение передается в следующем вызове API, API возвращает следующий набор результатов. Если результаты отсутствуют, маркер продолжения не будет содержать значение. Значение этого параметра не должно быть указано в формате URL-адреса. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-remove"></a>sfctl replica remove
Удаляет реплику службы, работающую на узле.

Этот API имитирует сбой реплики Service Fabric, удаляя реплику из кластера Service Fabric. При этом данная реплика закрывается и ей назначается роль "None", а затем из кластера удаляются все сведения о состоянии реплики. Этот API проверяет путь для удаления состояния реплики и имитирует сообщение о сбое постоянного пути через клиентские API. Предупреждение. При использовании этого API отсутствуют какие-либо проверки безопасности. Неправильное использование этого API может привести к потере данных для служб с отслеживанием состояния. Кроме того, флаг forceRemove влияет на все остальные реплики, размещенные в том же процессе.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --node-name [обязательный параметр] | Имя узла. |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --replica-id [обязательный параметр] | Идентификатор реплики. |
| --force-remove | Принудительное удаление приложения или службы Service Fabric без выполнения последовательности нормального завершения работы. Этот параметр можно использовать, чтобы принудительно удалить приложение или службу, срок удаления которой истек из-за проблем в коде службы, которые мешают нормальному закрытию реплик. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-report-health"></a>sfctl replica report-health
Отправляет отчет о работоспособности реплики Service Fabric.

Возвращает состояние работоспособности для указанной реплики Service Fabric. Отчет должен содержать информацию об источнике отчета о работоспособности и свойстве, в котором об этом сообщается. Отчет отправляется к реплике шлюза Service Fabric, которая передает его в хранилище данных о работоспособности. Отчет может быть принят шлюзом, но затем отклонен хранилищем данных о работоспособности после дополнительной проверки. Например, хранилище данных о работоспособности может отклонить отчет из-за недопустимого параметра, например устаревшего порядкового номера. Чтобы проверить, применен ли отчет в хранилище данных о работоспособности, выполните команду "get replica health" и найдите этот отчет в разделе HealthEvents.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --health-property [обязательный параметр] | Свойство информации о работоспособности. <br><br> Один объект может возвращать отчеты о работоспособности для разных свойств. Это свойство имеет строковый формат, а не фиксированное перечисление, чтобы создатель отчетов мог гибко классифицировать состояние, активировавшее отчет. Например, создатель отчета с идентификатором источника LocalWatchdog может отслеживать состояние доступного дискового пространства на узле и передавать для этого узла свойство AvailableDisk. Этот же создатель отчета может отслеживать подключения узла и передавать свойство Connectivity для того же узла. В хранилище данных о работоспособности эти отчеты обрабатываются как независимые события работоспособности для указанного узла. Кроме идентификатора источника, свойство однозначно идентифицирует данные о работоспособности. |
| --health-state [обязательный параметр] | Допускаются следующие значения\: Invalid, OK, Warning, Error или Unknown. |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --replica-id [обязательный параметр] | Идентификатор секции. |
| --source-id [обязательный параметр] | Имя источника, которое определяет клиента, службу наблюдения или компонент системы, создавший информацию о работоспособности. |
| --description | Описание информации о работоспособности. <br><br> Это свойство предоставляет информацию об отчете в произвольном текстовом формате, доступном для чтения. Максимальная длина строки для описания составляет 4096 символов. Более длинные строки автоматически усекаются. При усечении в последние символы описания помещается маркер [Truncated], длина которого входит в строку длиной 4096 символов. Наличие маркера указывает на усечение. Обратите внимание, что усеченное описание включает менее 4096 символов исходной строки. |
| --immediate | Этот флаг обозначает, что отчет нужно отправить немедленно. <br><br> Отчет о работоспособности отправляется в приложение шлюза Service Fabric, которое передает его в хранилище данных о работоспособности. Если флагу Immediate задано значение true, отчет немедленно отправляется через шлюз HTTP в хранилище данных о работоспособности, независимо от параметров клиента структуры, которые использует приложение шлюза HTTP. Это полезно для критически важных отчетов, которые необходимо передать как можно быстрее. В зависимости от времени и других условий отправка отчета может завершиться сбоем, например, если шлюз HTTP закрыт или сообщение не достигает этого шлюза. Если флагу Immediate задано значение false, отчет отправляется с учетом параметров клиента работоспособности через шлюз HTTP. Это значит, что он будет включен в пакет отчетов в соответствии со значением параметра HealthReportSendInterval. Рекомендуется применять именно такой вариант, так как он позволяет клиенту работоспособности оптимизировать отправку отчетов в хранилище данных о работоспособности, а также обработку отчетов о работоспособности. По умолчанию отчеты не отправляются немедленно. |
| --remove-when-expired | Это значение указывает, удаляется ли отчет из хранилища работоспособности после истечения срока его действия. <br><br> Если задано значение true, отчет будет удален из хранилища работоспособности после истечения срока его действия. Если задано значение false, отчет с истекшим сроком действия рассматривается как указывающий на ошибку. Для этого свойства по умолчанию используется значение false. Если клиенты создают периодические отчеты, для параметра RemoveWhenExpired следует использовать значение false (по умолчанию). Если возникнет проблема с создателем отчетов (например, взаимоблокировка), не позволяющая ему отправить следующий отчет, это позволит зарегистрировать ошибку для сущности с истекшим отчетом о работоспособности. Такая сущность будет находиться в состоянии "Ошибка работоспособности". |
| --sequence-number | Порядковый номер отчета о работоспособности в формате числовой строки. <br><br> Порядковый номер отчета используется хранилищем данных о работоспособности для отслеживания устаревших отчетов. Если значение не указано, порядковый номер автоматически создается клиентом работоспособности при добавлении отчета. |
| --service-kind | Вид реплики службы (с отслеживанием состояния или без), для которого сообщается о работоспособности. Ниже приведены возможные значения\: 'Stateless', 'Stateful'.  Значение по умолчанию\: Stateful. |
| --timeout -t | Значение по умолчанию\: 60. |
| --ttl | Срок, в течение которого отчет о работоспособности считается действительным. В этом поле указывается длительность в формате ISO8601. <br><br> Если клиенты создают периодические отчеты, периодичность отправки отчетов должна быть выше, чем срок жизни отчетов. Если клиенты передают отчеты об изменении состояния, для них можно установить бесконечный срок действия. По истечении срока жизни событие работоспособности, которое содержит данные о работоспособности, удаляется из хранилища данных о работоспособности (если RemoveWhenExpired имеет значение true) или считается ошибкой (если RemoveWhenExpired имеет значение false). Если значение не указано, по умолчанию устанавливается бесконечный срок жизни. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |

## <a name="sfctl-replica-restart"></a>sfctl replica restart
Перезапускает реплику сохраненной службы, работающую на узле.

Перезапускает реплику сохраненной службы, работающую на узле. Предупреждение. При использовании этого API отсутствуют какие-либо проверки безопасности. Неправильное использование этого API может привести к потере доступности служб с отслеживанием состояния.

### <a name="arguments"></a>Аргументы

|Аргумент|Описание|
| --- | --- |
| --node-name [обязательный параметр] | Имя узла. |
| --partition-id [обязательный параметр] | Идентификатор секции. |
| --replica-id [обязательный параметр] | Идентификатор реплики. |
| --timeout -t | Время ожидания сервера для выполнения операции в секундах. Это время ожидания указывает период времени, в течение которого клиент желает ожидать завершения запрошенной операции. Значение по умолчанию для этого параметра — 60 секунд.  Значение по умолчанию\: 60. |

### <a name="global-arguments"></a>Глобальные аргументы

|Аргумент|Описание|
| --- | --- |
| --debug | Повышение уровня детализации журнала для включения всех журналов отладки. |
| --help -h | Отображение этого справочного сообщения и выход. |
| --output -o | Формат вывода.  Допустимые значения\: json, jsonc, table, tsv.  Значение по умолчанию\: json. |
| --query | Строка запроса JMESPath. Дополнительные сведения и примеры см. на веб-сайте http\://jmespath.org/. |
| --verbose | Повышение уровня детализации журнала. Чтобы включить полные журналы отладки, используйте параметр --debug. |


## <a name="next-steps"></a>Дальнейшие действия
- [Настройте](service-fabric-cli.md) интерфейс командной строки Service Fabric.
- Узнайте, как использовать интерфейс командной строки Service Fabric, с помощью [примеров сценариев](./scripts/sfctl-upgrade-application.md).
