---
title: Настройка репликации на границе Azure SQL
description: Узнайте, как настроить репликацию в Azure SQL.
keywords: ''
services: sql-edge
ms.service: sql-edge
ms.topic: conceptual
author: SQLSourabh
ms.author: sourabha
ms.reviewer: sstein
ms.date: 05/19/2020
ms.openlocfilehash: 3b424ece9207328d87068160f78ebc78a3bd1a8d
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "93395229"
---
# <a name="configure-replication-to-azure-sql-edge"></a>Настройка репликации на границе Azure SQL 

Вы можете настроить экземпляр Azure SQL Server в качестве извещающего подписчика для односторонней репликации транзакций или репликации моментальных снимков. Этот экземпляр не может действовать в качестве издателя или распространителя для конфигурации репликации транзакций. Обратите внимание, что Azure SQL ребро не поддерживает репликацию слиянием, одноранговую репликацию или публикацию Oracle.

## <a name="supported-configurations"></a>Поддерживаемые конфигурации
  
- Экземпляр Azure SQL ребр должен быть принудительным подписчиком для издателя.
- Издатель и распространитель могут быть либо:
   - Экземпляр SQL Server, выполняющегося в локальной среде, или экземпляр SQL Server, выполняющийся на виртуальной машине Azure. Дополнительные сведения см. в статье [Обзор SQL Server на виртуальных машинах Azure](../azure-sql/virtual-machines/index.yml). Экземпляры SQL Server должны использовать версию более поздней, чем SQL Server 2016.
   - Экземпляр Управляемый экземпляр Azure SQL. SQL Управляемый экземпляр может размещать базы данных издателя, распространителя и подписчика. Дополнительные сведения см. в статье [Replication to SQL Database single and pooled databases](/azure/sql-database/replication-with-sql-database-managed-instance/) (Репликация в одну базу данных и базы данных в составе пула службы "База данных SQL").

- Базу данных распространителя и агенты репликации нельзя разместить на экземпляре Azure SQL Server.  

> [!NOTE]
> При попытке настроить репликацию с использованием неподдерживаемой версии могут возникать следующие две ошибки: MSSQL_REPL20084 ("процессу не удалось подключиться к подписчику") и MSSQL_REPL40532 ("не удается открыть сервер, \<name> запрошенный именем для входа. Ошибка входа. ").  

## <a name="remarks"></a>Remarks

Следующие требования и рекомендации важны для понимания при настройке репликации.

- Репликацию можно настроить с помощью [SQL Server Management Studio](/sql/ssms/download-sql-server-management-studio-ssms). Это также можно сделать, выполнив инструкции Transact-SQL на издателе, используя либо SQL Server Management Studio, либо [Azure Data Studio](/sql/azure-data-studio/download-azure-data-studio).
- Чтобы выполнить репликацию в экземпляр Azure SQL Server, необходимо использовать проверку подлинности SQL Server для входа.
- У реплицируемых таблиц должен быть первичный ключ.
- Одна публикация на сервере SQL Server может поддерживать подписчиков и SQL Azure для пограничных вычислений, и SQL Server (локально и SQL Server на виртуальной машине Azure).  
- Управление репликацией, мониторинг и устранение неполадок необходимо выполнять из экземпляра SQL Server.  
- В SQL Azure для пограничных вычислений поддерживаются только принудительные подписки.  
- `@subscriber_type = 0`Поддерживается только в хранимой процедуре `sp_addsubscription` для Azure SQL.  
- Azure SQL Server не поддерживает двунаправленную, немедленную, обновляемую или одноранговую репликацию.
- Azure SQL ребро поддерживает только подмножество функций, доступных в SQL Server или SQL Управляемый экземпляр. Попытка репликации базы данных (или объектов в базе данных), которая содержит одну или несколько неподдерживаемых функций, приведет к сбою. Например, при попытке репликации базы данных, содержащей объекты с пространственными типами данных, появится сообщение об ошибке. Дополнительные сведения см. в разделе [Supported Features of Azure SQL ребр](features.md).

## <a name="initialize-reference-data-on-an-instance-of-azure-sql-edge"></a>Инициализация ссылочных данных на экземпляре Azure SQL ребро

Может потребоваться инициализировать экземпляр со ссылочными данными, которые изменяются со временем. Например, может потребоваться обновить модели машинного обучения на экземпляре Azure SQL Server, после того как они обучены на экземпляре SQL Server. Вот как можно инициализировать экземпляр в таком сценарии:

1. Создание публикации репликации транзакций в базе данных SQL Server.  
2. На SQL Server экземпляре используйте **Мастер создания подписки** или инструкции TRANSACT-SQL, чтобы создать принудительную подписку на Azure SQL.  
3. Вы можете инициализировать реплицированную базу данных в SQL Azure с помощью моментального снимка, созданного агентом моментальных снимков и распределенного и доставленного агентом распространителя. Кроме того, можно инициализировать с помощью резервной копии базы данных на издателе. Помните, что если резервная копия базы данных содержит объекты или функции, не поддерживаемые Azure SQL Server, операция восстановления завершается ошибкой.

## <a name="limitations"></a>Ограничения

Для пограничных подписок Azure SQL не поддерживаются следующие параметры:

- копирование сопоставления групп файлов;  
- копирование схем секционирования таблиц;  
- копирование схем секционирования индексов;  
- копирование определяемой пользователем статистики;  
- копирование привязок по умолчанию;  
- копирование привязок правил;  
- копирование полнотекстовых индексов;  
- копирование XSD XML;  
- копирование XML-индексов;  
- копирование разрешений.  
- копирование пространственных индексов;  
- копирование фильтруемых индексов;  
- копирование атрибута сжатия данных;  
- копирование атрибута разреженного столбца;  
- Копировать `hierarchyid` типы данных FILESTREAM, или пространственные данные
- Преобразовать `hierarchyid` в типы данных max  
- копирование пространственных типов в типы данных MAX;  
- копирование расширенных свойств;  
- копирование разрешений.  

## <a name="examples"></a>Примеры

Создайте публикацию и принудительную подписку. Дополнительные сведения см. в разделе:
  
- [Создание публикации](/sql/relational-databases/replication/publish/create-a-publication)
- [Создайте принудительную подписку](/sql/relational-databases/replication/create-a-push-subscription/) , используя имя сервера SQL Azure и IP-адрес в качестве подписчика (например, **меджеинстанце, 1433**), а также имя базы данных в экземпляре SQL Azure в качестве целевой базы данных (например, **AdventureWorks**).  

## <a name="next-steps"></a>Дальнейшие действия  

- [Создание публикации](/sql/relational-databases/replication/publish/create-a-publication)
- [Создание принудительной подписки](/sql/relational-databases/replication/create-a-push-subscription/)
- [Типы репликации](/sql/relational-databases/replication/types-of-replication)
- [Мониторинг (репликация)](/sql/relational-databases/replication/monitor/monitoring-replication)
- [Инициализация подписки](/sql/relational-databases/replication/initialize-a-subscription)