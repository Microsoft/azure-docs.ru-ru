---
title: Общие сведения об управлении доступом на основе ролей на Azure Stack пограничном устройстве | Документация Майкрософт
description: Описание процесса управления доступом на основе ролей Kubernetes на устройстве Pro на Azure Stack.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: conceptual
ms.date: 02/22/2021
ms.author: alkohli
ms.openlocfilehash: 1b38a9807e05385a378fa6103710fb6b393c7b1f
ms.sourcegitcommit: 5bbc00673bd5b86b1ab2b7a31a4b4b066087e8ed
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/07/2021
ms.locfileid: "102443154"
---
# <a name="kubernetes-role-based-access-control-on-your-azure-stack-edge-pro-gpu-device"></a>Kubernetes управление доступом на основе ролей на устройстве с Azure Stack ребра Pro GPU

[!INCLUDE [applies-to-GPU-and-pro-r-and-mini-r-skus](../../includes/azure-stack-edge-applies-to-gpu-pro-r-mini-r-sku.md)]

При настройке роли вычислений на устройстве Azure Stack пограничной Pro создается кластер Kubernetes. Вы можете использовать Kubernetes управления доступом на основе ролей (Kubernetes RBAC), чтобы ограничить доступ к ресурсам кластера на устройстве.

В этой статье приведены общие сведения о системе Kubernetes RBAC, предоставляемой Kubernetes, а также о том, как Kubernetes RBAC реализован на устройстве Azure Stack пограничном Pro. 

## <a name="kubernetes-rbac"></a>Kubernetes RBAC

Kubernetes RBAC позволяет назначать пользователям или группам пользователей разрешения на выполнение таких действий, как создание или изменение ресурсов, а также просмотр журналов из рабочих нагрузок приложений. Эти разрешения могут быть ограничены одним пространством имен или предоставлены во всем кластере. 

При настройке кластера Kubernetes создается один пользователь, соответствующий этому кластеру, и он называется администратором кластера.  `kubeconfig`Файл связан с пользователем администратора кластера. `kubeconfig`Файл представляет собой текстовый файл, содержащий все сведения о конфигурации, необходимые для подключения к кластеру для проверки подлинности пользователя.

## <a name="namespaces-types"></a>Типы пространств имен

Ресурсы Kubernetes, такие как Pod и развертывания, логически группируются в пространство имен. Эти группы позволяют логически разделить кластер Kubernetes и ограничить доступ к созданию, просмотру и управлению ресурсами. Пользователи смогут взаимодействовать только с ресурсами из назначенных им пространств имен.

Пространства имен предназначены для использования в средах с множеством пользователей, распределенных по нескольким командам или проектам. Дополнительные сведения см. в [документации по пространствам имен в Kubernetes](https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/).

Устройство Azure Stack пограничной Pro имеет следующие пространства имен:

- **Пространство имен System** — это пространство имен, в котором существуют основные ресурсы, такие как DNS и прокси, или панель мониторинга Kubernetes. Обычно вам не нужно развертывать приложения в этом пространстве имен. Используйте это пространство имен для отладки любых проблем с кластером Kubernetes. 

    На устройстве имеется несколько пространств имен System, и имена, соответствующие этим системным пространствам имен, зарезервированы. Ниже приведен список зарезервированных пространств имен System. 
    - kube-system
    - металлб — система
    - DBE — пространство имен
    - default
    - kubernetes — панель мониторинга
    - KUBE — Аренда узла
    - kube-public


    Обязательно используйте зарезервированные имена для создаваемых пространств имен пользователей. 
<!--- **default namespace** - This namespace is where pods and deployments are created by default when none is provided and you have admin access to this namespace. When you interact with the Kubernetes API, such as with `kubectl get pods`, the default namespace is used when none is specified.-->

- **Пространство имен пользователя** . это пространства имен, которые можно создать через **kubectl** или через интерфейс PowerShell устройства для локального развертывания приложений.
 
- **IOT Edge Namespace** — вы подключаетесь к этому `iotedge` пространству имен для управления приложениями, развернутыми с помощью IOT Edge.

- **Пространство имен Azure Arc** — вы подключаетесь к этому `azure-arc` пространству имен для управления приложениями, развернутыми через дугу Azure. С помощью дуги Azure можно также развертывать приложения в других пространствах имен пользователей. 

## <a name="namespaces-and-users"></a>Пространства имен и пользователи

В реальном мире важно разделить кластер на несколько пространств имен. 

- **Несколько пользователей**. Если у вас несколько пользователей, то несколько пространств имен будут разрешать этим пользователям развертывать свои приложения и службы в отдельных пространствах имен, изолированных друг от друга. 
- **Один пользователь**. даже если существует один пользователь, несколько пространств имен позволяли пользователю запускать несколько версий приложений в одном кластере Kubernetes.

### <a name="roles-and-rolebindings"></a>Роли и Ролебиндингс

Kubernetes имеет концепцию привязки ролей и ролей, которая позволяет предоставлять разрешения пользователям или ресурсам на уровне пространства имен и на уровне кластера. 

- **Роли**. Вы можете определить разрешения для пользователей в качестве **роли** , а затем использовать **роли** для предоставления разрешений в пределах пространства имен. 
- **Ролебиндингс**. После определения ролей можно использовать **ролебиндингс** для назначения ролей для заданного пространства имен. 

Такой подход позволяет логически разделить один кластер Kubernetes, при этом пользователи могут получить доступ только к ресурсам приложения в назначенном им пространстве имен. 

## <a name="kubernetes-rbac-on-azure-stack-edge-pro"></a>Kubernetes RBAC на Azure Stack пограничных Pro

В текущей реализации Kubernetes RBAC Azure Stack пограничным Pro позволяет выполнять следующие действия из ограниченного пространства выполнения PowerShell:

- Создание пространств имен.  
- Создание дополнительных пользователей.
- Предоставьте администратору доступ к созданным пространствам имен. Помните, что у вас не будет доступа к роли администратора кластера или к просмотру ресурсов в масштабе кластера.
- Получите `kubeconfig` файл со сведениями для доступа к кластеру Kubernetes.


Устройство Azure Stack пограничной Pro имеет несколько пространств имен System, и вы можете создавать пространства имен пользователей с `kubeconfig` файлами для доступа к этим пространствам имен. Пользователи имеют полный контроль над этими пространствами имен и могут создавать или изменять пользователей, а также предоставлять пользователям доступ. Только администратор кластера имеет полный доступ к системным пространствам имен и ресурсам на уровне кластера. `aseuser`Имеет доступ только для чтения к системным пространствам имен.

Ниже приведена схема, на которой показана реализация Kubernetes RBAC на устройстве Azure Stack пограничной Pro.

![Kubernetes RBAC на устройстве Pro на Azure Stack](./media/azure-stack-edge-gpu-kubernetes-rbac/rbac-view-1.png)

На этой схеме Алиса, Боб и Чак имеют доступ только к назначенным пространствам имен пользователей (в данном случае это `ns1` , `ns2` и соответственно) `ns3` . В этих пространствах имен они имеют доступ администратора. Администратор кластера с другой стороны имеет доступ администратора к системным пространствам имен и ресурсам на уровне кластера.

Пользователь может создавать пространства имен и пользователей, назначать пользователям пространства имен или скачивать `kubeconfig` файлы. Подробные пошаговые инструкции см. в статье [доступ к кластеру Kubernetes через куебктл на Azure Stack пограничных Pro](azure-stack-edge-gpu-create-kubernetes-cluster.md).


При работе с пространствами имен и пользователями на устройствах Azure Stack пограничных Pro необходимо учитывать следующие предостережения.

- Вы не можете выполнять никакие операции, такие как создание пользователей, предоставление или Отмена доступа к пространству имен пользователю для любых пространств имен System. Примеры пространств имен System:, `kube-system` , `metallb-system` `kubernetes-dashboard` ,, `default` `kube-node-lease` , `kube-public` . Пространства имен System также включают пространства имен, зарезервированные для таких типов развертывания, как `iotedge` (IOT Edge пространство имен) и `azure-arc` (пространство имен Arc Azure).
- Вы можете создавать пространства имен пользователей и в этих пространствах имен создавать дополнительных пользователей, а также предоставлять или отменять доступ к пространству имен этим пользователям.
- Не разрешается создавать пространства имен с именами, идентичными именам системных пространств имен. Имена пространств имен System зарезервированы.  
- Вам запрещено создавать пространства имен пользователей с именами, которые уже используются другими пользовательскими пространствами имен. Например, если `test-ns` создан созданный объект, нельзя создать другое `test-ns` пространство имен.
- Вам запрещено создавать пользователей с уже зарезервированными именами. Например, `aseuser` является зарезервированным пользователем и не может использоваться.


## <a name="next-steps"></a>Дальнейшие действия

Чтобы понять, как можно создать пользователя, создать пространство имен и предоставить пользователю доступ к пространству имен, см. раздел [доступ к кластеру Kubernetes через kubectl](azure-stack-edge-gpu-create-kubernetes-cluster.md).

