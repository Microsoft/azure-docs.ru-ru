---
title: Запуск модуля GPU на устройстве Microsoft Azure Stack ребра Pro GPU | Документация Майкрософт
description: Описывает настройку и запуск модуля на GPU на устройстве Azure Stack пограничной Pro с помощью портал Azure.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: how-to
ms.date: 03/12/2021
ms.author: alkohli
ms.openlocfilehash: 348ddff56ed61cd608d6b9f28417e7cd4c4e6b13
ms.sourcegitcommit: 18a91f7fe1432ee09efafd5bd29a181e038cee05
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2021
ms.locfileid: "103563969"
---
# <a name="configure-and-run-a-module-on-gpu-on-azure-stack-edge-pro-device"></a>Настройка и запуск модуля на GPU на устройстве Azure Stack ребра Pro

[!INCLUDE [applies-to-GPU-and-pro-r-skus](../../includes/azure-stack-edge-applies-to-gpu-pro-r-sku.md)]

Устройство Azure Stack пограничной Pro содержит один или несколько графических процессоров (GPU). Графические процессоры являются популярным выбором для вычислений ИИ, так как они обеспечивают возможности параллельной обработки и быстрее выполняют отрисовку изображений, в отличие от центральных процессоров (ЦП). Дополнительные сведения о GPU, содержащемся на устройстве Azure Stack ребра Pro, см. в [подAzure Stackе технические спецификации устройства](azure-stack-edge-gpu-technical-specifications-compliance.md).

В этой статье описывается, как настроить и запустить модуль на GPU на устройстве Azure Stack ребра Pro. В этой статье вы будете использовать общедоступные **цифры** модуля контейнера, написанные для видеопроцессоров NVIDIA T4. Эту процедуру можно использовать для настройки любых других модулей, опубликованных NVIDIA для этих графических процессоров.


## <a name="prerequisites"></a>Предварительные требования

Перед тем как начать, убедитесь в следующем.

1. У вас есть доступ к GPU, поддерживающему 1-node Azure Stack пограничным устройством Pro. Это устройство активируется с помощью ресурса в Azure.  

## <a name="configure-module-to-use-gpu"></a>Настройка модуля для использования GPU

Чтобы настроить модуль на использование GPU на устройстве Azure Stack ребра Pro для запуска модуля,<!--Can it be simplified? "To configure a module to be run by the GPU on your Azure Stack Edge Pro device,"?--> выполните следующие действия.

1. В портал Azure перейдите к ресурсу, связанному с устройством.

2. В разделе **Общие сведения** выберите **IOT Edge**.

    ![Настройка модуля для использования GPU 1](media/azure-stack-edge-gpu-configure-gpu-modules/configure-compute-1.png)

3. В разделе **Enable IoT Edge service** (Включение службы IoT Edge) выберите **Add** (Добавить).

   ![Настройка модуля для использования GPU 2](media/azure-stack-edge-gpu-configure-gpu-modules/configure-compute-2.png)

4. В разделе **Create IoT Edge service** (Создание службы IoT Edge) введите параметры для ресурса Центра Интернета вещей:

   |Поле   |Значение    |
   |--------|---------|
   |Подписка      | Подписка, используемая ресурсом Azure Stack Edge |
   |Группа ресурсов    | Группа ресурсов, используемая ресурсом Azure Stack Edge |
   |Центр Интернета вещей           | Выберите **Создать** или **Использовать существующий**. <br> По умолчанию для создания ресурса Интернета вещей используется уровень служб "Стандартный" (S1). Чтобы использовать ресурс Интернета вещей уровня служб "Бесплатный", создайте его и выберите существующий ресурс. <br> В любом случае для ресурса Интернета вещей используется та же подписка и группа ресурсов, что и для ресурса Azure Stack Edge.     |
   |Имя              | Если вы не хотите использовать имя по умолчанию, указанное для нового ресурса Центра Интернета вещей, введите другое имя. |

   Завершив настройку параметров, выберите **Просмотр и создание**. Проверьте параметры для своего ресурса Центра Интернета вещей и выберите **Создать**.

   ![Начало работы с вычислениями 2](./media/azure-stack-edge-gpu-configure-gpu-modules/configure-compute-3.png)

   Для создания ресурса Центра Интернета вещей нужно несколько минут. После создания ресурса в разделе **Обзор** будет указано, что служба IoT Edge теперь запущена.

   ![Начало работы с вычислениями 3](./media/azure-stack-edge-gpu-configure-gpu-modules/configure-compute-4.png)

5. Чтобы убедиться, что роль пограничных вычислений настроена, выберите **Свойства**.

   ![Начало работы с вычислениями 4](./media/azure-stack-edge-gpu-configure-gpu-modules/configure-compute-5.png)

6. В окне **Свойства** выберите ссылку для **устройства IOT Edge**.

   ![Настройка модуля для использования GPU 6](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-2.png)

   В правой области отображается устройство IoT Edge, связанное с устройством Azure Stack. Pro. Это устройство соответствует IoT Edge устройству, созданному при создании ресурса центра Интернета вещей.
 
7. Выберите это устройство IoT Edge.

   ![Настройка модуля для использования GPU 7](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-3.png)

8. Щелкните **Set modules** (Настроить модули).

   ![Настройка модуля для использования GPU 8](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-4.png)

9. Выберите **+ Добавить** , а затем **+ IOT Edge модуль**. 

    ![Настройка модуля для использования GPU 9](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-5.png)

10. На вкладке **Добавление модуля IOT Edge** :

    1. Укажите **универсальный код ресурса (URI) образа**. Здесь вы будете использовать общедоступные **цифры** модуля NVIDIA. 
    
    2. Задайте для **параметра Политика перезапуска** значение **всегда**.
    
    3. Задайте для **требуемого состояния** значение **работает**.
    
    ![Настройка модуля для использования GPU 10](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-6.png)

11. На вкладке **переменные среды** укажите имя переменной и соответствующее значение. 

    1. Чтобы текущий модуль использовал один GPU на этом устройстве, используйте NVIDIA_VISIBLE_DEVICES. 

    2. Задайте значение 0 или 1. Значение 0 или 1 гарантирует, что устройство использует по крайней мере один GPU для этого модуля. Если задать значение 0, 1, это означает, что модуль использует оба GPU на устройстве.

       ![Настройка модуля для использования GPU 11](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-7.png)

       Дополнительные сведения о переменных среды, которые можно использовать с графическим процессором NVIDIA, см. в подразделе " [Среда выполнения контейнера NVIDIA](https://github.com/NVIDIA/nvidia-container-runtime#environment-variables-oci-spec)".

    > [!NOTE]
    > Модуль может использовать один, как, так и без GPU.

12. Введите имя модуля. На этом этапе можно указать параметр создать контейнер и изменить параметры двойникаа модуля или, если это сделано, нажать кнопку **Добавить**. 

    ![Настройка модуля для использования GPU 12](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-8.png)

13. Убедитесь, что модуль работает, и выберите **проверить и создать**.

    ![Настройка модуля для использования GPU 13](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-9.png)

14. На вкладке " **Проверка и создание** " отображаются выбранные параметры развертывания. Проверьте параметры и нажмите кнопку **создать**.
    
    ![Настройка модуля для использования GPU 14](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-10.png)

15. Запишите **состояние среды выполнения** модуля.
    
    ![Настройка модуля для использования GPU 15](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-11.png)

    Развертывание модуля займет несколько минут. Выберите **Обновить** , и **состояние среды выполнения** должно отобразиться на **выполняется**.

    ![Настройка модуля для использования GPU 16](media/azure-stack-edge-gpu-configure-gpu-modules/configure-gpu-12.png)


## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения о [переменных среды, которые можно использовать с графическим процессором NVIDIA](https://github.com/NVIDIA/nvidia-container-runtime#environment-variables-oci-spec).
