---
title: Заметки о выпуске Azure Stack ребра Pro 2103
description: Описание критических открытых проблем и способов их устранения для Azure Stack пограничной версии 2103.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: article
ms.date: 03/23/2021
ms.author: alkohli
ms.openlocfilehash: 846d4a259f0fcd204bcad6c898efc999c3765fd3
ms.sourcegitcommit: ac035293291c3d2962cee270b33fca3628432fac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2021
ms.locfileid: "104962680"
---
# <a name="azure-stack-edge-2103-release-notes"></a>Заметки о выпуске Azure Stack пограничных 2103

[!INCLUDE [applies-to-GPU-and-pro-r-and-mini-r-skus](../../includes/azure-stack-edge-applies-to-gpu-pro-r-mini-r-sku.md)]

В следующих заметках о выпуске указываются критические открытые проблемы и разрешенные проблемы для выпуска 2103 для устройств Azure Stack. Эти заметки о выпуске применимы для Azure Stack GPU Pro, Azure Stack пограничных Pro R и Azure Stack пограничных устройств R. Функции и проблемы, соответствующие определенной модели, называются там, где это применимо.

Заметки о выпуске постоянно обновляются: обнаруживаются и добавляются критические проблемы, требующие временного решения. Перед развертыванием устройства внимательно ознакомьтесь со сведениями, содержащимися в заметках о выпуске.

Эта статья относится к выпуску **Azure Stack ребра 2103** , сопоставленному с номером версии программного обеспечения **2.2.1540.2890**. Это программное обеспечение можно применить к устройству, если вы используете по крайней мере Azure Stack пограничной 2010 (2.1.1377.2170).

## <a name="whats-new"></a>Новые возможности

В выпуске Azure Stack ребра 2103 доступны следующие новые функции. 
 
- **Новые функции виртуальных машин** . Начиная с этого выпуска можно выполнять следующие операции управления на виртуальных машинах с помощью портал Azure:
    - Добавление или удаление нескольких сетевых интерфейсов для существующей виртуальной машины.
    - Добавление или удаление нескольких дисков для существующей виртуальной машины.
    - Измените размер виртуальной машины.
    - Добавление пользовательских данных при развертывании виртуальной машины Windows или Linux.

  Вы также можете [подключиться к консоли виртуальной машины на устройстве](azure-stack-edge-gpu-connect-virtual-machine-console.md) и устранить неполадки с виртуальной машиной.

- **Подключение к интерфейсу PowerShell через HTTPS** — начиная с этого выпуска вы больше не сможете открыть удаленный сеанс PowerShell на устройстве по *протоколу HTTP*. По умолчанию *протокол HTTPS* будет использоваться для всех сеансов. Дополнительные сведения см. в статье [Подключение к интерфейсу PowerShell](azure-stack-edge-gpu-connect-powershell-interface.md#connect-to-the-powershell-interface) устройства.

- **Улучшения для вычислений** . были внесены несколько улучшений и усовершенствований, включая следующие.

    - **Общее качество платформы вычислений**. В этом выпуске исправлены ошибки для улучшения общего качества платформы вычислений. Ознакомьтесь с [проблемами, исправленными в выпуске 2103](#issues-fixed-in-2103-release). 
    - **Компоненты платформы вычислений**. Обновления для системы безопасности были применены к образу вычислений виртуальной машины. IoT Edge и ARC Azure для версий Kubernetes были также обновлены.
    - **Диагностика**. Для проверки состояния ресурса и сети выпущен новый API. Вы можете подключиться к интерфейсу PowerShell устройства и использовать `Test-HcsKubernetesStatus` команду для проверки готовности устройства к работе в сети.
    - **Сбор журналов** , который может привести к улучшенной отладке. 
    - **Инфраструктура предупреждений** , позволяющая определять конфликты IP-адресов для вычислений с IP-адресами. 
    - **Смешивание рабочей нагрузки** Kubernetes и локального Azure Resource Manager. 

- **Упреждающее ведение журнала. по умолчанию** при запуске этого выпуска упреждающий сбор журналов по умолчанию включен на устройстве. Эта функция позволяет корпорации Майкрософт вести журнал заблаговременно в соответствии с индикаторами работоспособности системы, чтобы помочь эффективно устранять неполадки, связанные с устройствами. Дополнительные сведения см. [в статье упреждающий сбор журналов на устройстве](azure-stack-edge-gpu-proactive-log-collection.md).

## <a name="issues-fixed-in-2103-release"></a>Проблемы, исправленные в выпуске 2103

В следующей таблице перечислены проблемы, которые были выпущены в предыдущих выпусках и исправлены в текущем выпуске.

| Нет. | Функция | Проблема | 
| --- | --- | --- |
|**1.**|Kubernetes |При включении веб-прокси пограничные реестр контейнеров не работает.|
|**2.**|Kubernetes |Реестр контейнера граничных контейнеров не работает с IoT Edgeными модулями.| 

## <a name="known-issues-in-2103-release"></a>Известные проблемы в выпуске 2103

В следующей таблице приведены сводные сведения об известных проблемах в выпуске 2103.

| Нет. | Функция | Проблема | Временное решение и комментарии |
| --- | --- | --- | --- |
|**1.**|Предварительная версия функций |В этом выпуске доступны следующие функции: локальные Azure Resource Manager, виртуальные машины, облачное Управление виртуальными машинами, Kubernetes Cloud Management, Kubernetesная служба "Дуга" Azure, VPN для Azure Stack ребра Pro R и Azure Stack погранично Mini R, Многопроцессные службы (MPS) для Azure Stackного GPU Pro — доступны в предварительной версии.  |Эти функции будут общедоступными в последующих выпусках. |
|**2.**|Виртуальные машины с GPU |До этого выпуска жизненный цикл виртуальной машины GPU не управлялся в потоке обновления. Поэтому при обновлении до версии 2103 виртуальные машины GPU не останавливаются автоматически во время обновления. Перед обновлением устройства необходимо вручную закрыть виртуальные машины GPU с помощью `stop-stayProvisioned` флага. Дополнительные сведения см. [в статье Приостановка или завершение работы виртуальной машины](azure-stack-edge-gpu-deploy-virtual-machine-powershell.md#suspend-or-shut-down-the-vm).<br> Все виртуальные машины GPU, которые выполняются до обновления, запускаются после обновления. В этих случаях рабочие нагрузки, работающие на виртуальных машинах, не завершаются надлежащим образом. После обновления виртуальные машины могут оказаться в нежелательном состоянии. <br>Все виртуальные машины GPU, остановленные через `stop-stayProvisioned` до обновления, автоматически запускаются после обновления. <br>Если вы останавливаете виртуальные машины GPU с помощью портал Azure, вам потребуется вручную запустить виртуальную машину после обновления устройства.| Если вы используете виртуальные машины GPU с Kubernetes, завершите работу виртуальных машин GPU сразу перед обновлением. <br>После остановки виртуальных машин GPU Kubernetes перехватит GPU, которые использовались изначально виртуальными машинами. <br>Чем дольше виртуальные машины GPU находятся в остановленном состоянии, тем выше вероятность того, что Kubernetes будет занимать графические процессоры. |
|**3.**|Расширение виртуальной машины пользовательского скрипта |Существует известная ошибка виртуальных машин Windows, созданных в более раннем выпуске, и устройство было обновлено до 2103. <br> Если добавить расширение пользовательского скрипта на этих виртуальных машинах, то гостевой агент виртуальной машины Windows (только версия 2.7.41491.901) будет задержан в обновлении, что привело к истечению времени ожидания развертывания расширения. | Чтобы обойти эту ошибку, сделайте следующее: <ul><li> Подключитесь к виртуальной машине Windows по протоколу удаленного рабочего стола (RDP). </li><li> Убедитесь, что `waappagent.exe` служба запущена на компьютере: `Get-Process WaAppAgent` . </li><li> Если `waappagent.exe` служба не запущена, перезапустите `rdagent` службу `Get-Service RdAgent` \| `Restart-Service` . Подождите 5 минут.</li><li> Пока выполняется `waappagent.exe` , прервать `WindowsAzureGuest.exe` процесс. </li><li>После завершения процесса процесс начнет работать снова с новой версией.</li><li>Убедитесь, что версия гостевого агента виртуальной машины Windows 2.7.41491.971 с помощью следующей команды: `Get-Process WindowsAzureGuestAgent` \| `fl ProductVersion` .</li><li>[Настройте расширение пользовательских скриптов на виртуальной машине Windows](azure-stack-edge-gpu-deploy-virtual-machine-custom-script-extension.md). </li><ul> | 
|**4.**|Многопроцессная служба (MPS) |При обновлении программного обеспечения устройства и кластера Kubernetes параметр MPS не сохраняется для рабочих нагрузок.   |[Повторно включите MPS](azure-stack-edge-gpu-connect-powershell-interface.md#connect-to-the-powershell-interface) и разверните Рабочие нагрузки, использующие MPS. |


## <a name="known-issues-from-previous-releases"></a>Известные проблемы предыдущих выпусков

В следующей таблице приведена сводка известных проблем, выполненных в предыдущих выпусках.

| Нет. | Функция | Проблема | Временное решение и комментарии |
| --- | --- | --- | --- |
| **1.** |Azure Stack пограничных Pro + SQL Azure | Для создания базы данных SQL требуется доступ администратора.   |Выполните следующие действия вместо шагов 1-2 в [https://docs.microsoft.com/azure/iot-edge/tutorial-store-data-sql-server#create-the-sql-database](../iot-edge/tutorial-store-data-sql-server.md#create-the-sql-database) . <ul><li>В локальном пользовательском интерфейсе устройства Включите интерфейс вычислений. Выберите **вычисление > порт # > включить для вычислений > применить.**</li><li>Скачайте `sqlcmd` на клиентский компьютер с https://docs.microsoft.com/sql/tools/sqlcmd-utility </li><li>Подключитесь к IP-адресу интерфейса вычислений (включенному порту), добавив ", 1401" в конец адреса.</li><li>Окончательная команда будет выглядеть следующим образом: sqlcmd-S {Interface IP}, 1401-U SA-P «strong! Passw0rd".</li>После этого шаги 3-4 из текущей документации должны быть идентичны. </li></ul> |
| **2.** |Обновить| Добавочные изменения в больших двоичных объектах, восстановленных с помощью **обновления** , не поддерживаются |Для конечных точек большого двоичного объекта частичные обновления больших двоичных объектов после обновления могут привести к тому, что обновления не будут отправлены в облако. Например, последовательность действий, например:<ul><li>Создание большого двоичного объекта в облаке. Или удалите ранее отправленный BLOB-объект с устройства.</li><li>Обновите BLOB-объект из облака в устройство с помощью функции обновления.</li><li>Обновление только части большого двоичного объекта с помощью API-интерфейсов Azure SDK.</li></ul>Эти действия могут привести к тому, что обновленные разделы BLOB-объекта не будут обновлены в облаке. <br>**Обходное решение**. Используйте такие средства, как Robocopy, или регулярное копирование файлов с помощью Explorer или командной строки, чтобы заменить все большие двоичные объекты.|
|**3.**|Регулирование|При регулировании, если новые операции записи на устройство не разрешены, запись клиентом NFS завершается ошибкой с сообщением "отказано в разрешении".| Эта ошибка будет показана ниже:<br>`hcsuser@ubuntu-vm:~/nfstest$ mkdir test`<br>mkdir: не удается создать каталог "тест": отказано в разрешении|
|**4.**|Прием хранилища BLOB-объектов|При использовании AzCopy версии 10 для приема хранилища BLOB-объектов запустите AzCopy со следующим аргументом: `Azcopy <other arguments> --cap-mbps 2000`| Если эти ограничения не предоставляются для AzCopy, это может привести к отправке на устройство большого количества запросов, что приведет к проблемам со службой.|
|**5.**|Многоуровневые учетные записи хранения|При использовании многоуровневых учетных записей хранения применяются следующие условия.<ul><li> Поддерживаются только блочные BLOB-объекты. Страничные BLOB-объекты не поддерживаются.</li><li>Поддержка API моментальных снимков или копирования отсутствует.</li><li> Прием рабочей нагрузки Hadoop с помощью `distcp` не поддерживается, так как он интенсивно использует операцию копирования.</li></ul>||
|**6.**|Подключение к общему ресурсу NFS|Если несколько процессов копируются в одну общую папку и `nolock` атрибут не используется, во время копирования могут возникнуть ошибки.|`nolock`Для копирования файлов в общую папку NFS необходимо передать атрибут в команду mount. Например, `C:\Users\aseuser mount -o anon \\10.1.1.211\mnt\vms Z:`.|
|**7.**|Кластер Kubernetes|При применении обновления на устройстве, на котором работает кластер Kubernetes, виртуальные машины Kubernetes перезапускаются и перезагружаются. В этом случае только те модули, которые развернуты с указанными репликами, автоматически восстанавливаются после обновления.  |Если вы создали отдельные модули Pod за пределами контроллера репликации без указания набора реплик, эти модули не будут автоматически восстановлены после обновления устройства. Вам потребуется восстановить эти модули.<br>Набор реплик заменяет удаляемые или завершенные модули Pod по какой-либо причине, например сбой узла или аварийное обновление узла. По этой причине рекомендуется использовать набор реплик, даже если приложению требуется только один модуль.|
|**8.**|Кластер Kubernetes|Kubernetes на Azure Stack пограничной Pro поддерживается только в версии Helm V3 или более поздней. Дополнительные сведения см. в подразделах " [часто задаваемые вопросы": удаление ящика](https://v3.helm.sh/docs/faq/).|
|**9.**|Azure Arc с поддержкой Kubernetes |Для общедоступного выпуска служба Arc Azure Kubernetes обновляется с версии 0.1.18 на 0.2.9. Так как обновление Kubernetes для Azure с поддержкой Arc не поддерживается на Azure Stack пограничном устройстве, вам потребуется повторно развернуть Kubernetes с поддержкой ARC.|Выполните указанные ниже действия.<ol><li>[Применение программного обеспечения устройства и обновлений Kubernetes](azure-stack-edge-gpu-install-update.md).</li><li>Подключитесь к [интерфейсу PowerShell устройства](azure-stack-edge-gpu-connect-powershell-interface.md).</li><li>Удалите существующий агент Azure ARC. Введите `Remove-HcsKubernetesAzureArcAgent`.</li><li>Развертывание [дуги Azure в новом ресурсе](azure-stack-edge-gpu-deploy-arc-kubernetes-cluster.md). Не используйте существующий ресурс Azure ARC.</li></ol>|
|**штук.**|Azure Arc с поддержкой Kubernetes|Развертывания ARC в Azure не поддерживаются, если на устройстве Azure Stack пограничной Pro настроен веб-прокси.||
|**стр.**|Kubernetes |Порт 31000 зарезервирован для панели мониторинга Kubernetes. Порт 31001 зарезервирован для реестра граничных контейнеров. Аналогично, в конфигурации по умолчанию IP-адреса 172.28.0.1 и 172.28.0.10 зарезервированы для службы Kubernetes и основной службы DNS соответственно.|Не используйте зарезервированные IP-адреса.|
|**Двенадцать.**|Kubernetes |В настоящее время Kubernetes не поддерживает службы балансировки нагрузки с несколькими протоколами. Например, служба DNS должна прослушивать TCP и UDP. |Чтобы обойти это ограничение Kubernetes с Металлб, две службы (одна для TCP, одна для UDP) можно создать на одном селекторе Pod. Эти службы используют один и тот же ключ общего доступа и Spec. Лоадбаланцерип для совместного использования одного и того же IP-адреса. IP-адреса также могут быть общими, если у вас больше служб, чем доступные. <br> Дополнительные сведения см. в разделе [совместное использование IP-адресов](https://metallb.universe.tf/usage/#ip-address-sharing).|
|**решением.**|Кластер Kubernetes|Существующие модули Azure IoT Edge Marketplace могут потребовать изменения для запуска на IoT Edge на Azure Stack пограничном устройстве.|Дополнительные сведения см. в статье изменение модулей Azure IoT Edge из Marketplace для запуска на Azure Stack пограничном устройстве.<!-- insert link-->|
|**открыт.**|Kubernetes |Подключения на основе файлов не поддерживаются для Azure IoT Edge в Kubernetes на Azure Stack пограничном устройстве.|IoT Edge использует слой перевода для преобразования `ContainerCreate` параметров в конструкции Kubernetes. Создание `Binds` карт для `hostpath` каталога и, таким же, привязка файловых привязок не может быть привязана к путям в контейнерах IOT Edge. Если возможно, сопоставьте родительский каталог.|
|**15.**|Kubernetes |Если вы используете собственные сертификаты для IoT Edge и добавляете их на Azure Stack пограничной устройстве после того, как на устройстве будет настроено вычисление, новые сертификаты не будут выбраны.|Чтобы обойти эту проблему, перед настройкой вычислений на устройстве следует передать сертификаты. Если среда выполнения вычислений уже настроена, [подключитесь к интерфейсу PowerShell устройства и выполните команды IOT Edge](azure-stack-edge-gpu-connect-powershell-interface.md#use-iotedge-commands). Перезагрузите и модули Pod `iotedged` `edgehub` .|
|**глубин.**|Сертификаты |В некоторых случаях обновление состояния сертификата в локальном пользовательском интерфейсе может занять несколько секунд. |Могут повлиять на следующие сценарии в локальном пользовательском интерфейсе.<ul><li>Столбец **Status (состояние** ) на странице **Сертификаты** .</li><li>Плитка " **Безопасность** " на странице " **Начало работы** ".</li><li>Плитка **настройки** на странице **обзора** .</li></ul>  |
|**широкоэкранны.**|IoT Edge |Модули, развернутые с помощью IoT Edge, не могут использовать сеть узла. | |
|**стр.**|Compute + Kubernetes |Compute/Kubernetes не поддерживает веб-прокси NTLM. ||
|**стр.**|Kubernetes и обновление |Более ранние версии программного обеспечения, такие как 2008 выпусков, имеют проблему обновления состояния гонки, которая приводит к сбою обновления с Клустерконнектионексцептион. |Использование более новых сборок должно помочь избежать этой проблемы. Если вы по-прежнему видите эту проблему, обходной путь заключается в повторном выполнении обновления, и оно должно работать.|
|**20**|Internet Explorer|Если включены улучшенные функции безопасности, доступ к локальным веб-страницам пользовательского интерфейса может оказаться невозможным. | Отключите усиленную безопасность и перезапустите браузер.|
|**открыт.**|Панель мониторинга Kubernetes | Конечная точка *HTTPS* для панели мониторинга KUBERNETES с SSL-сертификатом не поддерживается. | |
|**максималь.**|Kubernetes |Kubernetes не поддерживает ":" в именах переменных среды, используемых приложениями .NET. Это также необходимо для работы модуля IoT Edge "Сетка событий" на Azure Stack пограничных устройствах и других приложениях. Дополнительные сведения см. в [документации по ASP.NET Core](/aspnet/core/fundamentals/configuration/?tabs=basicconfiguration&view=aspnetcore-3.1&preserve-view=true#environment-variables).|Замените ":" двойным символом подчеркивания. Дополнительные сведения см. в разделе [Kubernetes Issue](https://github.com/kubernetes/kubernetes/issues/53201) .|
|**выражения.** |Кластер Azure Arc + Kubernetes |По умолчанию, когда ресурс `yamls` удаляется из репозитория Git, соответствующие ресурсы не удаляются из кластера Kubernetes.  |Чтобы разрешить удаление ресурсов при их удалении из репозитория Git, задайте `--sync-garbage-collection` в Arc операторпарамс. Дополнительные сведения см. [в разделе Удаление конфигурации](../azure-arc/kubernetes/use-gitops-connected-cluster.md#additional-parameters). |
|**круглосуточно.**|NFS |В приложениях, использующих общий доступ NFS на устройстве для записи данных, должна использоваться Монопольная запись. Это гарантирует запись записей на диск.| |
|**размером.**|Конфигурация вычислений |Конфигурация вычислений не работает в конфигурациях сети, где шлюзы или коммутаторы или маршрутизаторы отвечают на запросы ARP для систем, которые не существуют в сети.| |
|**26.**|COMPUTE и Kubernetes |Если на устройстве сначала настраивается Kubernetes, он заявляет все доступные GPU. Таким образом, невозможно создать Azure Resource Manager виртуальные машины с помощью GPU после настройки Kubernetes. |Если устройство содержит 2 GPU, можно создать 1 виртуальную машину, использующую GPU, а затем настроить Kubernetes. В этом случае Kubernetes будет использовать оставшийся доступный графический процессор 1. |


<!--|**18.**|Azure Private Edge Zone (Preview) |There is a known issue with Virtual Network Function VM if the VM was created on Azure Stack Edge device running earlier preview builds such as 2006/2007b and then the device was updated to 2009 GA release. The issue is that the VNF information can't be retrieved or any new VNFs can't be created unless the VNF VMs are deleted before the device is updated.  |Before you update Azure Stack Edge device to 2009 release, use the PowerShell command `get-mecvnf` followed by `remove-mecvnf <VNF guid>` to remove all Virtual Network Function VMs one at a time. After the upgrade, you will need to redeploy the same VNFs.|-->


## <a name="next-steps"></a>Дальнейшие действия

- [Обновление устройства](azure-stack-edge-gpu-install-update.md)
