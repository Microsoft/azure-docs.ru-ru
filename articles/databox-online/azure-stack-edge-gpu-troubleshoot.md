---
title: Использование портал Azure для устранения неполадок Azure Stack ребра Pro с помощью GPU | Документация Майкрософт
description: В этой статье описывается, как устранять неполадки Azure Stack пограничных графических процессоров Pro.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: troubleshooting
ms.date: 01/21/2021
ms.author: alkohli
ms.openlocfilehash: 0976dd9f3c4d0228ec0f170a755ec13800da435b
ms.sourcegitcommit: 3c3ec8cd21f2b0671bcd2230fc22e4b4adb11ce7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2021
ms.locfileid: "98761553"
---
# <a name="troubleshoot-issues-on-your-azure-stack-edge-pro-gpu-device"></a>Устранение неполадок на устройстве GPU Azure Stack с пограничными устройствами 

<!--[!INCLUDE [applies-to-skus](../../includes/azure-stack-edge-applies-to-all-sku.md)]-->

В этой статье описывается, как устранять неполадки на устройстве с Azure Stack ребра Pro GPU. 


## <a name="run-diagnostics"></a>Запуск диагностики

Чтобы диагностировать и устранить любые ошибки устройства, можно запустить диагностические тесты. Чтобы запустить диагностические тесты, сделайте следующее в локальном веб-интерфейсе устройства.

1. В локальном веб-интерфейсе выберите **Устранение неполадок > Diagnostic tests** (Диагностические тесты). Выберите тест, который нужно запустить, и щелкните **запустить тест**. Этот тест позволяет диагностировать возможные проблемы с сетью, устройством, веб-прокси, временем или параметрами облака. Вы получаете уведомление о том, что устройство тестируется.

    ![Выбор тестов ](media/azure-stack-edge-gpu-troubleshoot/run-diag-1.png)
 
2. По завершении тестов отобразятся результаты. 

    ![Просматривать результаты тестов](media/azure-stack-edge-gpu-troubleshoot/run-diag-2.png)

    Если тест завершается сбоем, отобразится URL-адрес для рекомендуемого действия. Выберите URL-адрес, чтобы просмотреть рекомендуемое действие.
 
    ![Просмотр предупреждений о неудачных тестах](media/azure-stack-edge-j-series-troubleshoot/run-diag-3.png)


## <a name="collect-support-package"></a>Сбор пакета поддержки

Пакет журналов содержит все журналы, которые могут помочь сотрудникам службы поддержки Майкрософт в устранении неполадок на любом устройстве. Создать пакет журналов можно с помощью локального веб-интерфейса.

Чтобы собрать пакет поддержки, сделайте следующее. 

1. В локальном пользовательском веб-интерфейсе выберите **Устранение неполадок > Поддержка**. Выберите **создать пакет поддержки**. Система начнет собирать пакет поддержки. Сбор пакета может занять несколько минут.

    ![Добавление пользователя](media/azure-stack-edge-gpu-troubleshoot/collect-logs-1.png)
 
2. После создания пакета поддержки выберите **скачать пакет поддержки**. ZIP-пакет загружается по выбранному пути. Пакет можно распаковать и просмотреть файлы системных журналов.

    ![Выберите Добавить пользователя 2](media/azure-stack-edge-gpu-troubleshoot/collect-logs-2.png)

## <a name="gather-advanced-security-logs"></a>Сбор дополнительных журналов безопасности

К дополнительным журналам безопасности могут относиться программное обеспечение или журналы вскрытия оборудования для устройства Azure Stack погранично Pro.

### <a name="software-intrusion-logs"></a>Журналы вскрытия программ

Для входящего и исходящего трафика собираются программное обеспечение или журналы брандмауэра по умолчанию. 

- Если устройство обработано на фабрике, ведение журнала брандмауэра по умолчанию включено. Эти журналы упаковываются в пакет поддержки по умолчанию при создании пакета поддержки через локальный пользовательский интерфейс или через интерфейс Windows PowerShell устройства.

- Если в пакете поддержки необходимы только журналы брандмауэра для проверки вторжения программного обеспечения (NW) на устройстве, используйте `-Include FirewallLog` параметр при создании пакета поддержки. 

- Если не указано ни одного параметра включения, журнал брандмауэра включается в пакет поддержки по умолчанию.

- В пакете поддержки журнал брандмауэра находится в `pfirewall.log` каталоге и находится в корневой папке. Ниже приведен пример журнала вскрытия программного обеспечения для устройства Azure Stack пограничной Pro. 

    ```
    #Version: 1.5
    #Software: Microsoft Windows Firewall
    #Time Format: Local
    #Fields: date time action protocol src-ip dst-ip src-port dst-port size tcpflags tcpsyn tcpack tcpwin icmptype icmpcode info path
    
    2019-11-06 12:35:19 DROP UDP 5.5.3.197 224.0.0.251 5353 5353 59 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e88 ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e88 ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e88 ff02::fb 5353 5353 89 - - - - - - 
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9d87 ff02::fb 5353 5353 79 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP 5.5.3.193 224.0.0.251 5353 5353 59 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe08:20d5 ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe08:20d5 ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e8b ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e8b ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP 5.5.3.33 224.0.0.251 5353 5353 59 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e8b ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e8a ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    2019-11-06 12:35:19 DROP UDP fe80::3680:dff:fe01:9e8b ff02::fb 5353 5353 89 - - - - - - - RECEIVE
    ```

### <a name="hardware-intrusion-logs"></a>Журналы вскрытия оборудования

Для обнаружения аппаратного обнаружения устройства в настоящее время регистрируются все события корпуса, такие как открытие или закрытие корпуса. 

- Журнал системных событий считывается с устройства с помощью `racadm` командлета. Затем эти события фильтруются для событий, связанных с корпусом, в `HWIntrusion.txt` файл.

- Чтобы получить только журнал вскрытия оборудования в пакете поддержки, используйте `-Include HWSelLog` параметр при создании пакета поддержки. 

- Если какой-либо конкретный параметр include не указан, то в пакет поддержки входит по умолчанию журнал вторжений оборудования.

- В пакете поддержки журнал обнаружения оборудования находится в `HWIntrusion.txt` корневой папке. Ниже приведен пример журнала вскрытия оборудования для устройства Azure Stack пограничной Pro. 

    ```
    09/04/2019 15:51:23 system Critical The chassis is open while the power is off.
    09/04/2019 15:51:30 system Ok The chassis is closed while the power is off.
    ```

## <a name="use-logs-to-troubleshoot"></a>Использование журналов для устранения неполадок.

Все ошибки, возникшие во время передачи и обновления, добавляются в соответствующие файлы с ошибками.

1. Чтобы просмотреть файлы ошибок, перейдите к общей папке и выберите общую папку для просмотра содержимого. 


2. Выберите _папку Microsoft Data Box Edge_. Эта папка содержит две вложенные папки:

    - Отправьте папку, содержащую файлы журнала для ошибок отправки.
    - Обновите папку для ошибок во время обновления.

    Ниже приведен пример файла журнала для обновления.

    ```
    <root container="test1" machine="VM15BS020663" timestamp="03/18/2019 00:11:10" />
    <file item="test.txt" local="False" remote="True" error="16001" />
    <summary runtime="00:00:00.0945320" errors="1" creates="2" deletes="0" insync="3" replaces="0" pending="9" />
    ``` 

3. Когда появится сообщение об ошибке в этом файле (выделено в примере), запишите код ошибки, в данном случае это 16001. Найдите описание этого кода ошибки, используя следующий справочник по ошибкам.

    [!INCLUDE [data-box-edge-edge-upload-error-reference](../../includes/data-box-edge-gateway-upload-error-reference.md)]

## <a name="use-error-lists-to-troubleshoot"></a>Устранение неполадок с помощью списков ошибок

Списки ошибок компилируются из идентифицированных сценариев и могут использоваться для самостоятельной диагностики и устранения неполадок. 

## <a name="azure-resource-manager"></a>Azure Resource Manager

Ниже приведены ошибки, которые могут отображаться во время настройки Azure Resource Manager для доступа к устройству. 

| **Проблемы и ошибки** |  **Решение** | 
|------------|-----------------|
|Общие проблемы|<li>[Убедитесь, что Пограничное устройство настроено правильно](#verify-the-device-is-configured-properly).<li> [Проверка правильности настройки клиента](#verify-the-client-is-configured-properly)|
|Add-AzureRmEnvironment: при отправке запроса произошла ошибка.<br>В строке: 1 символ: 1<br>+ Add-AzureRmEnvironment-Name Az3-ARMEndpoint " https://management.dbe ...|Эта ошибка означает, что устройство Azure Stack пограничной Pro недоступно или неправильно настроено. Убедитесь, что пограничные устройства и клиент настроены правильно. Инструкции см. в строке **Общие проблемы** в этой таблице.|
|Служба вернула ошибку. Дополнительные сведения см. в описании внутреннего подключения: не удалось установить доверительные отношения для защищенного канала SSL/TLS. |   Вероятно, эта ошибка возникла из-за того, что один или несколько неверно переводят собственные шаги сертификата. Руководство можно найти [здесь](./azure-stack-edge-j-series-connect-resource-manager.md#step-2-create-and-install-certificates). |
|Операция вернула недопустимый код состояния "ServiceUnavailable" <br> Код состояния ответа не указывает на успешное выполнение: 503 (служба недоступна). | Эта ошибка может быть результатом любого из этих условий.<li>Армстспул находится в остановленном состоянии.</li><li>Один из веб-сайтов службы маркеров Azure Resource Manager и безопасности не работает.</li><li>Ресурс кластера Azure Resource Manager не работает.</li><br><strong>Примечание.</strong> Перезапуск устройства может решить проблему, но вы должны получить пакет поддержки, чтобы его можно было отладить.|
|AADSTS50126: недопустимое имя пользователя или пароль.<br>Идентификатор трассировки: 29317da9-52fc-4ba0-9778-446ae5625e5a<br>Идентификатор корреляции: 1b9752c4-8cbf-4304-a714-8a16527410f4<br>Метка времени: 2019-11-15 09:21:57Z: удаленный сервер вернул ошибку: (400) неверный запрос.<br>В строке: 1 символ: 1 |Эта ошибка может быть результатом любого из этих условий.<li>Для неправильного имени пользователя и пароля проверьте, что клиент изменил пароль с портал Azure, выполнив действия, описанные [здесь](./azure-stack-edge-j-series-set-azure-resource-manager-password.md) , и используя правильный пароль.<li>Для недопустимого идентификатора клиента идентификатор клиента является фиксированным GUID и должен иметь значение `c0257de7-538f-415c-993a-1b87a031879d`</li>|
|Connect-AzureRmAccount: AADSTS90056: ресурс отключен или не существует. Проверьте код приложения и убедитесь, что вы указали правильный URL-адрес ресурса, к которому пытаетесь получить доступ.<br>Идентификатор трассировки: e19bdbc9-5dc8-4a74-85c3-ac6abdfda115<br>Идентификатор корреляции: 75c8ef5a-830e-48b5-b039-595a96488ff9 timestamp: 2019-11-18 07:00:51Z: удаленный сервер вернул ошибку: (400) Bad |Конечные точки ресурса, используемые в `Add-AzureRmEnvironment` команде, неверны.|
|Не удалось получить конечные точки из облака.<br>Убедитесь, что у вас есть сетевое подключение. Сведения об ошибке: Хттпсконнектионпул (узел = "Management. dbg-of4k6suvm.microsoftdatabox.com", порт = 30005): максимальное количество повторных попыток с URL-адресом:/Метадата/ендпоинтс? API-Version = 2015-01-01 (вызывается Сслеррор (Сслеррор ("неудачное подтверждение: ошибка ([(" подпрограммы SSL "," tls_process_server_certificate "," сбой проверки сертификата ")],)",) ") |Эта ошибка появляется в основном в среде Mac/Linux и вызвана следующими проблемами.<li>Сертификат формата PEM не добавлен в хранилище сертификатов Python.</li> |

### <a name="verify-the-device-is-configured-properly"></a>Убедитесь, что устройство настроено правильно.

1. В локальном пользовательском интерфейсе убедитесь, что сеть устройства настроена правильно.

2. Убедитесь, что сертификаты обновлены для всех конечных точек, как упоминалось [здесь](azure-stack-edge-j-series-connect-resource-manager.md#step-2-create-and-install-certificates).

3. Получите конечную точку управления Azure Resource Manager и входа на странице **устройства** в локальном пользовательском интерфейсе.

4. Убедитесь, что устройство активировано и зарегистрировано в Azure.


### <a name="verify-the-client-is-configured-properly"></a>Проверка правильности настройки клиента

1. Убедитесь, что установлена правильная версия PowerShell, как описано [здесь](azure-stack-edge-j-series-connect-resource-manager.md#step-3-install-powershell-on-the-client).

2. Убедитесь, что установлены правильные модули PowerShell, как описано [здесь](azure-stack-edge-j-series-connect-resource-manager.md#step-4-set-up-azure-powershell-on-the-client).

3. Проверьте доступность конечных точек Azure Resource Manager и входа. Можно попробовать проверить связь с конечными точками. Пример:

   `ping management.28bmdw2-bb9.microsoftdatabox.com`
   `ping login.28bmdw2-bb9.microsoftdatabox.com`
   
   Если они недостижимы, добавьте записи DNS/Host, как описано [здесь](azure-stack-edge-j-series-connect-resource-manager.md#step-5-modify-host-file-for-endpoint-name-resolution).
   
4. Проверьте, установлены сертификаты клиентов, как указано [здесь](azure-stack-edge-j-series-connect-resource-manager.md#import-certificates-on-the-client-running-azure-powershell).

5. Если клиент использует PowerShell, необходимо включить параметр отладки, чтобы просмотреть подробные сообщения, выполнив команду PowerShell. 

    `$debugpreference = "continue"`

## <a name="blob-storage-on-device"></a>Хранилище BLOB-объектов на устройстве 

Ниже приведены ошибки, связанные с хранилищем BLOB-объектов на Azure Stack пограничном устройстве Pro/Шлюз Data Box.

| **Проблемы и ошибки** |  **Решение** | 
|--------------------|-----------------|
|Не удалось получить дочерние ресурсы. Значение одного из заголовков HTTP имеет неправильный формат.| В меню **Правка** выберите пункт **целевые Azure Stack API**. Затем перезапустите Обозреватель службы хранилища Azure.|
|`getaddrinfo ENOTFOUND <accountname>.blob.<serialnumber>.microsoftdatabox.com`|Убедитесь, что имя конечной точки `<accountname>.blob.<serialnumber>.microsoftdatabox.com` Добавлено в файл hosts по указанному пути: `C:\Windows\System32\drivers\etc\hosts` в Windows или `/etc/hosts` Linux.|
|Не удалось получить дочерние ресурсы.<br> Сведения: самозаверяющий сертификат |Импортируйте SSL-сертификат для устройства в Обозреватель службы хранилища Azure: <ol><li>Скачайте сертификат из портал Azure. Дополнительные сведения см. [в разделе скачивание сертификата](../databox/data-box-deploy-copy-data-via-rest.md#download-certificate).</li><li>В меню **Правка** выберите SSL-сертификаты и щелкните **Импорт сертификатов**.</li></ol>|
|Команда AzCopy перестает отвечать на минуты, прежде чем отобразится эта ошибка:<br>`Failed to enumerate directory https://… The remote name could not be resolved <accountname>.blob.<serialnumber>.microsoftdatabox.com`|Убедитесь, что имя конечной точки `<accountname>.blob.<serialnumber>.microsoftdatabox.com` Добавлено в файл hosts по адресу: `C:\Windows\System32\drivers\etc\hosts` .|
|Команда AzCopy перестает отвечать на минуты, прежде чем отобразится эта ошибка:<br>`Error parsing source location. The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel`. |Импортируйте SSL-сертификат для устройства в хранилище сертификатов системы. Дополнительные сведения см. [в разделе скачивание сертификата](../databox/data-box-deploy-copy-data-via-rest.md#download-certificate).|
|Команда AzCopy перестает отвечать на запросы в течение 20 минут, после чего отображается следующее сообщение об ошибке:<br>`Error parsing source location https://<accountname>.blob.<serialnumber>.microsoftdatabox.com/<cntnr>. No such device or address`. |Убедитесь, что имя конечной точки `<accountname>.blob.<serialnumber>.microsoftdatabox.com` Добавлено в файл hosts по адресу: `/etc/hosts` .|
|Команда AzCopy перестает отвечать на запросы в течение 20 минут, после чего отображается следующее сообщение об ошибке:<br>`Error parsing source location… The SSL connection could not be established`. |Импортируйте SSL-сертификат для устройства в хранилище сертификатов системы. Дополнительные сведения см. [в разделе скачивание сертификата](../databox/data-box-deploy-copy-data-via-rest.md#download-certificate).|
|Команда AzCopy перестает отвечать на запросы в течение 20 минут, после чего отображается следующее сообщение об ошибке:<br>`Error parsing source location https://<accountname>.blob.<serialnumber>.microsoftdatabox.com/<cntnr>. No such device or address`|Убедитесь, что имя конечной точки `<accountname>.blob.<serialnumber>.microsoftdatabox.com` Добавлено в файл hosts по адресу: `/etc/hosts` .|
|Команда AzCopy перестает отвечать на запросы в течение 20 минут, после чего отображается следующее сообщение об ошибке: `Error parsing source location… The SSL connection could not be established` .|Импортируйте SSL-сертификат для устройства в хранилище сертификатов системы. Дополнительные сведения см. [в разделе скачивание сертификата](../databox/data-box-deploy-copy-data-via-rest.md#download-certificate).|
|Значение одного из заголовков HTTP имеет неправильный формат.|Установленная версия библиотеки служба хранилища Microsoft Azure для Python не поддерживается Data Box. Поддерживаемые версии см. в разделе Azure Data Box требования к хранилищу BLOB-объектов.|
|… [SSL: CERTIFICATE_VERIFY_FAILED]...| Перед запуском Python присвойте переменной среды REQUESTS_CA_BUNDLE путь к файлу SSL-сертификата в кодировке Base64 (см. раздел [Загрузка сертификата](../databox/data-box-deploy-copy-data-via-rest.md#download-certificate)). Пример:<br>`export REQUESTS_CA_BUNDLE=/tmp/mycert.cer`<br>`python`<br>Кроме того, добавьте сертификат в хранилище сертификатов системы, а затем задайте для этой переменной среды путь к этому хранилищу. Например, в Ubuntu: <br>`export REQUESTS_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt`<br>`python`.|
|Время ожидания соединения истекло.|Войдите в Azure Stack пограничная Pro и убедитесь, что она разблокирована. Когда устройство перезапускается, оно остается заблокированным до тех пор, пока пользователь не войдет в систему.|

## <a name="troubleshoot-iot-edge-errors"></a>Устранение ошибок IoT Edge

[!INCLUDE [Troubleshoot IoT Edge runtime](../../includes/azure-stack-edge-iot-troubleshoot-compute.md)]


## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения об [устранении неполадок при активации устройств](azure-stack-edge-gpu-troubleshoot-activation.md).