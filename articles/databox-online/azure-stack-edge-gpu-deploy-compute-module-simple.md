---
title: Использование модуля IoT Edge для развертывания рабочей нагрузки вычислений на Azure Stack Edge Pro с GPU | Документация Майкрософт
description: Узнайте, как выполнить рабочую нагрузку вычислений с помощью предварительно созданного модуля IoT Edge на устройстве Azure Stack Edge Pro с GPU.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: tutorial
ms.date: 02/22/2021
ms.author: alkohli
Customer intent: As an IT admin, I need to understand how to configure compute on Azure Stack Edge Pro so I can use it to transform the data before sending it to Azure.
ms.openlocfilehash: 6c067fb5f39e82bb1601ce7b4d9dc5e2ce4ac624
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102440145"
---
# <a name="tutorial-run-a-compute-workload-with-iot-edge-module-on-azure-stack-edge-pro-gpu"></a>Руководство. Выполнение рабочей нагрузки вычислений с помощью модуля IoT Edge на Azure Stack Edge Pro с GPU

[!INCLUDE [applies-to-GPU-and-pro-r-skus](../../includes/azure-stack-edge-applies-to-gpu-pro-r-sku.md)]

В этом руководстве показано, как выполнить рабочую нагрузку вычислений с помощью модуля IoT Edge на устройстве Azure Stack Edge Pro с GPU. Когда вы завершите настройку вычислений, устройство будет преобразовывать данные перед отправкой в ​​Azure.

Эта процедура может занять от 10 до 15 минут.


В этом руководстве описано следующее:

> [!div class="checklist"]
> * настройка вычислений;
> * добавление общих папок;
> * Добавление модуля вычислений.
> * Проверка преобразования и передачи данных

 
## <a name="prerequisites"></a>Предварительные требования

Прежде чем вы настроите роль вычислений на устройстве Azure Stack Edge Pro с GPU, убедитесь в следующем:

- Устройство Azure Stack Edge Pro активировано, как описано в статье [Активация Azure Stack Edge Pro](azure-stack-edge-gpu-deploy-activate.md).
- У вас есть модуль IoT Edge, который можно использовать для работы с данными. В этом руководстве показано, как использовать модуль `filemove2`, который перемещает данные из локальной общей папки Edge на устройство в общей папке Edge, откуда эти данные затем попадают в учетную запись хранения Azure.


## <a name="configure-compute"></a>настройка вычислений;

[!INCLUDE [configure-compute](../../includes/azure-stack-edge-gateway-configure-compute.md)]


## <a name="add-shares"></a>добавление общих папок;

Для простого развертывания, описанного в этом руководстве, вам понадобятся две общие папки: общая папка Edge и еще одна локальная общая папка Edge.

1. Чтобы добавить общую папку Edge на устройство:

    1. В ресурсе Azure Stack Edge перейдите к разделу **Cloud storage gateway > Shares** (Шлюз облачного хранилища > Общие папки).
    2. На панели команд выберите **+ Добавить общую папку**.
    3. В колонке **Добавление общего файлового ресурса** укажите имя общей папки и выберите ее тип.
    4. Чтобы подключить общую папку Edge, установите флажок **Использовать общую папку с пограничными вычислениями**.
    5. Выберите **учетную запись хранения**, **службу хранилища**, существующего пользователя, а затем щелкните **Создать**.

        ![Добавление общей папки Edge](./media/azure-stack-edge-gpu-deploy-compute-module-simple/add-edge-share-1.png) 


    > [!NOTE]
    > Чтобы подключить общую папку NFS для вычислений, нужно настроить сеть вычислений в той же подсети, что и виртуальный IP-адрес NFS. Сведения о настройке сети вычислений см. в статье [Включение сети вычислений в Azure Stack Edge Pro](azure-stack-edge-gpu-deploy-configure-network-compute-web-proxy.md).

    Будет создана общая папка Edge, и вы получите уведомление об успешном создании. Список общих ресурсов может быть обновлен, однако вам нужно дождаться завершения создания общего ресурса.

2. Чтобы добавить локальную общую папку Edge на устройство, повторите все шаги из предыдущего этапа и установите флажок **Configure as Edge local share** (Настройка в качестве локальной общей папки Edge). Данные из локальной обшей папки остаются на устройстве.

    ![Добавление локальной общей папки Edge](./media/azure-stack-edge-gpu-deploy-compute-module-simple/add-edge-share-2.png)

    Если вы создали локальный общий ресурс NFS, используйте следующую команду удаленной синхронизации (rsync) для копирования в него файлов:

    `rsync <source file path> < destination file path>`

    Дополнительные сведения о команде `rsync` см. в [документации по `Rsync`](https://www.computerhope.com/unix/rsync.htm).
 
3. Чтобы увидеть обновленный список общих папок, перейдите в раздел **Cloud storage gateway > Shares** (Шлюз облачного хранилища > Общие папки).

    ![Обновленный список общих папок](./media/azure-stack-edge-gpu-deploy-compute-module-simple/add-edge-share-3.png) 
 

## <a name="add-a-module"></a>Добавление модуля

Можно добавить пользовательский или готовый модуль. Устройство в стандартной конфигурации не имеет предварительно созданных или пользовательских модулей. Чтобы узнать, как создать пользовательский модуль, ознакомьтесь со статьей [Разработка на C# модуля для устройства Azure Stack Edge Pro](azure-stack-edge-j-series-create-iot-edge-module.md).

В этом разделе объясняется, как добавить пользовательский модуль к устройству IoT Edge, которое было создано с помощью руководства [Разработка на C# модуля для Azure Stack Edge Pro](azure-stack-edge-j-series-create-iot-edge-module.md). Этот пользовательский модуль позволяет получить файлы из локальной общей папки Edge на устройстве Edge и перенести их в облачную общую папку Edge на устройстве. Затем облачный ресурс переносит файлы в учетную запись Azure, связанную с облачным ресурсом.

Чтобы добавить модуль:

1. Последовательно выберите **IoT Edge > Модули**. На панели команд щелкните **+ Добавить модуль**. 

2. В колонке **Добавление модуля** введите следующие значения.

    
    |Поле  |Значение  |
    |---------|---------|
    |Имя     | Уникальное имя модуля. Этот модуль является контейнером Docker, который можно развернуть на устройстве IoT Edge, связанном с вашим устройством Azure Stack Edge Pro.        |
    |URI образа     | URI образа для соответствующего образа контейнера для модуля.        |
    |Требуются учетные данные     | Если установлен этот флажок, для получения модулей с соответствующим URL-адресом используются имя пользователя и пароль.        |
    |Входная общая папка     | Выберите входную общую папку. В этом случае входной общей папкой будет локальная общая папка Edge. Используемый здесь модуль позволяет переместить файлы из локальной общей папки Edge в общую папку Edge, из которой они передаются в облако.        |
    |Выходная общая папка     | Выберите выходную общую папку. В этом случае выходной общей папкой будет общая папка Edge.        |
    |Тип триггера     | Выберите значение **Файл** или **Расписание**. Триггер файла срабатывает, когда возникает событие файла, например файл записывается во входную общую папку. Запланированный триггер срабатывает в соответствии с определенным вами расписанием.         |
    |Имя триггера     | Уникальное имя триггера.         |
    |Переменные среды| Дополнительные сведения, которые помогут определить среду, где будет запущен модуль.   |

    ![Добавление и настройка модуля](./media/azure-stack-edge-gpu-deploy-compute-module-simple/add-module-1.png)

3. Выберите **Добавить**. Модуль будет добавлен. На странице **IoT Edge > Модули** появятся сведения о том, что модуль развернут. Для состояния среды выполнения модуля, который вы добавили, должно отображаться значение *запущена*.

    ![Модуль развернут](./media/azure-stack-edge-gpu-deploy-compute-module-simple/add-module-2.png)

### <a name="verify-data-transform-and-transfer"></a>Проверка преобразования и передачи данных

Последний шаг — убедитесь, что модуль подключен и обрабатывает данные, как ожидалось. Состояние выполнения модуля должно быть "Работает" для вашего устройства IoT Edge в ресурсе Центра Интернета вещей.

Чтобы убедиться, что модуль работает и правильно обрабатывает данные:


1. С помощью проводника подключитесь к локальным и облачным общим папкам Edge, созданным ранее. См. инструкции. 

    ![Подключение к локальным и облачным общим папкам Edge](./media/azure-stack-edge-gpu-deploy-compute-module-simple/verify-data-1.png) 
 
1. Добавьте данные в локальную общую папку.

    ![Файл скопирован в локальный общий ресурс Edge](./media/azure-stack-edge-gpu-deploy-compute-module-simple/verify-data-2.png) 
 
   Данные переносятся в облачную общую папку.

    ![Файл перемещен в локальную общую папку Edge](./media/azure-stack-edge-gpu-deploy-compute-module-simple/verify-data-3.png)  

   Затем данные переносятся из облачного ресурса в учетную запись хранения. Для просмотра данных можно открыть Обозревателя Службы хранилища или страницу службы хранилища Azure на портале.

    ![Проверка данных в учетной записи хранения](./media/azure-stack-edge-gpu-deploy-compute-module-simple/verify-data-4.png)
 
Вы завершили процесс проверки.


## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:

> [!div class="checklist"]
> * настройка вычислений;
> * добавление общих папок;
> * Добавление модуля вычислений.
> * Проверка преобразования и передачи данных

Сведения об администрировании устройства Azure Stack Edge Pro см. в следующей статье:

> [!div class="nextstepaction"]
> [Использование локального пользовательского веб-интерфейса для администрирования Azure Stack Edge Pro](azure-stack-edge-gpu-manage-access-power-connectivity-mode.md)
