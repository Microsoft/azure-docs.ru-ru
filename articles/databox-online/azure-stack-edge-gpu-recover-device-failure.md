---
title: Восстановление после сбоя устройства Pro Azure Stack
description: Описывает, как выполнить восстановление с устройства, не имеющего Azure Stack пограничной Pro.
services: databox
author: alkohli
ms.service: databox
ms.subservice: edge
ms.topic: how-to
ms.date: 02/22/2021
ms.author: alkohli
ms.openlocfilehash: b32757dddf745e7aaa0ea8276a3527fa464cc0d4
ms.sourcegitcommit: 5bbc00673bd5b86b1ab2b7a31a4b4b066087e8ed
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/07/2021
ms.locfileid: "102442168"
---
# <a name="recover-from-a-failed-azure-stack-edge-pro-gpu-device"></a>Восстановление после неудачного Azure Stack устройства GPU с пограничным Pro 

[!INCLUDE [applies-to-GPU-and-pro-r-skus](../../includes/azure-stack-edge-applies-to-gpu-pro-r-sku.md)]

В этой статье описывается, как выполнить восстановление после неприемлемой сбоя на устройстве с Azure Stack ребра Pro GPU. Для приемлемой сбоя на устройстве с графическим процессором с пограничным управлением Azure Stack требуется замена устройства.

## <a name="before-you-begin"></a>Подготовка к работе

Убедитесь в наличии следующих элементов.

- Обращение в служба поддержки Майкрософт об отказе устройства и рекомендуем замену устройства. 
- Создайте резервную копию конфигурации устройства, как описано в разделе [Подготовка к сбою устройства](azure-stack-edge-gpu-prepare-device-failure.md).


## <a name="configure-replacement-device"></a>Настройка устройства замены

Когда устройство обнаруживает сбой, не приемлемой, необходимо заказать замену устройства. Действия по настройке устройства замены остаются прежними. 

Получите сведения о конфигурации устройства, для которых была выполнена архивация с устройства, на котором произошел сбой. Эти сведения будут использоваться для настройки устройства замены.  

Выполните следующие действия, чтобы настроить заменяющее устройство.

1. Соберите сведения, необходимые при выполнении требований, приведенных в [контрольном списке действий при развертывании](azure-stack-edge-gpu-deploy-checklist.md). Вы можете использовать информацию, сохраненную из предыдущей конфигурации устройства. 
1. Закажите новое устройство той же конфигурации, в которой произошел сбой.  Чтобы разместить заказ, выполните действия, приведенные в разделе [Создание ресурса Azure Stack Edge](azure-stack-edge-gpu-deploy-prep.md#) на портале Azure.
1. Выполните [распаковку](azure-stack-edge-gpu-deploy-install.md#unpack-the-device), [монтаж в стойку устройства](azure-stack-edge-gpu-deploy-install.md#rack-the-device) и [подключение кабелей к устройству](azure-stack-edge-gpu-deploy-install.md#cable-the-device). 
1. [Подключитесь к локальному пользовательскому интерфейсу устройства](azure-stack-edge-gpu-deploy-connect.md).
1. Настройте сеть, используя те же IP-адреса, которые использовались для старого устройства. Использование одних и тех же IP-адресов позволит снизить влияние на все клиентские компьютеры, используемые в вашей среде. Узнайте, как [настроить параметры сети](azure-stack-edge-gpu-deploy-configure-network-compute-web-proxy.md).
1. Назначьте то же имя устройства и домен DNS, что и для старого устройства. Таким образом, клиенты могут использовать одно и то же имя устройства для взаимодействия с новым устройством. Узнайте, как [настроить параметры устройства](azure-stack-edge-gpu-deploy-set-up-device-update-time.md).
1. Настройте сертификаты на новом устройстве так же, как и для старого устройства. Помните, что новое устройство имеет новый серийный номер узла. Если вы использовали собственные сертификаты на старом устройстве, вам нужно будет получить новый сертификат узла. Узнайте, как [настроить сертификаты](azure-stack-edge-gpu-deploy-configure-certificates.md).
1. Получите ключ активации на портале Azure и активируйте новое устройство. Узнайте, как [активировать устройство](azure-stack-edge-gpu-deploy-activate.md).

Теперь все готово для развертывания рабочих нагрузок, запущенных на старом устройстве.

## <a name="restore-edge-cloud-shares"></a>Восстановление облачных общих папок

Выполните следующие действия, чтобы восстановить данные в общих облачных ресурсах на устройстве.

1. [Добавьте общие папки](azure-stack-edge-j-series-manage-shares.md#add-a-share) с теми же именами, которые были созданы ранее на неисправном устройстве. При создании общих папок убедитесь, что для параметра **Выберите контейнер BLOB-объектов** задано значение **Использовать существующий**, а затем выберите контейнер, используемый для предыдущего устройства.
1. [Добавьте пользователей](azure-stack-edge-j-series-manage-users.md#add-a-user), которые имели доступ к предыдущему устройству.
1. [Добавьте учетные записи хранения](azure-stack-edge-j-series-manage-storage-accounts.md#add-an-edge-storage-account) , связанные с общими папками, которые ранее находились на устройстве. При создании учетных записей хранения пограничных данных выберите из существующего контейнера и укажите контейнер, сопоставленный с учетной записью хранения Azure, сопоставленной с предыдущим устройством. Все данные с устройства, записанные в учетную запись хранения пограничных данных на предыдущем устройстве, были отправлены в выбранный контейнер хранилища в сопоставленной учетной записи хранения Azure.
1. [Обновите данные общей папки](azure-stack-edge-j-series-manage-shares.md#refresh-shares) с помощью Azure. Это приведет к переносу всех данных существующего контейнера, которые содержатся в облаке, в общую папку.

## <a name="restore-edge-local-shares"></a>Восстановление граничных локальных общих папок

Чтобы подготовиться к потенциальному сбою устройства, вы можете развернуть одно из следующих решений резервного копирования, чтобы защитить локальные общие данные общих ресурсов от рабочих нагрузок Kubernetes или IoT.

| Стороннее программное обеспечение           | Ссылка на решение                               |
|--------------------------------|---------------------------------------------------------|
| Cohesity                       | [https://www.cohesity.com/solution/cloud/azure/](https://www.cohesity.com/solution/cloud/azure/) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Cohesity.          |
| Commvault                      | [https://www.commvault.com/azure](https://www.commvault.com/azure) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Commvault. |
| Veritas                        | [http://veritas.com/azure](http://veritas.com/azure) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Veritas.   |
| Veeam                          | [https://www.veeam.com/kb4041](https://www.veeam.com/kb4041) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Veeam. |

Завершив настройку устройства, которое заменяет предыдущее устройство, настройте его таким образом, чтобы оно использовалось как локальное хранилище. 

Чтобы восстановить данные из локальных общих папок, выполните следующие действия.

1. [Настройте устройство, чтобы оно выполняло вычисления](azure-stack-edge-gpu-deploy-configure-compute.md).
1. [Добавьте локальный общий ресурс](azure-stack-edge-j-series-manage-shares.md#add-a-local-share) обратно.
1. Выполните процедуру восстановления, предоставленную решением "Защита данных" по выбору. См. ссылки из предыдущей таблицы.

## <a name="restore-vm-files-and-folders"></a>Восстановление файлов и папок виртуальной машины

Чтобы подготовиться к потенциальному сбою устройства, вы можете развернуть одно из следующих решений резервного копирования для защиты данных на виртуальных машинах.



| Решения для архивации        | Поддерживаемая ОС   | Справочник                                                                |
|-------------------------|----------------|--------------------------------------------------------------------------|
| Агент Службы восстановления Microsoft Azure (MARS) для Azure Backup | Windows        | [Сведения об агенте MARS](../backup/backup-azure-about-mars.md)    |
| Cohesity                | Windows, Linux | [Microsoft Azure интеграция, решение для восстановления резервной копии &](https://www.cohesity.com/solution/cloud/azure) <br>Чтобы получить дополнительные сведения, обратитесь в службу поддержки Cohesity.                          |
| Commvault               | Windows, Linux | [https://www.commvault.com/azure](https://www.commvault.com/azure) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Commvault.
| Veritas                 | Windows, Linux | [https://vox.veritas.com/t5/Protection/Protecting-Azure-Stack-edge-with-NetBackup/ba-p/883370](https://vox.veritas.com/t5/Protection/Protecting-Azure-Stack-edge-with-NetBackup/ba-p/883370) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Veritas.                    |
| Veeam                   | Windows, Linux | [https://www.veeam.com/kb4041](https://www.veeam.com/kb4041) <br> Чтобы получить дополнительные сведения, обратитесь в службу поддержки Veeam. |

После полной настройки устройства замены можно повторно развернуть виртуальные машины с использованием ранее использованного образа виртуальной машины. 

Чтобы восстановить данные в виртуальных машинах, выполните следующие действия.
 
1. [Развертывание виртуальной машины из образа виртуальной машины](azure-stack-edge-gpu-deploy-virtual-machine-templates.md) на устройстве. 
1. Установите решение для защиты данных на виртуальной машине.
1. Выполните процедуру восстановления, предоставленную решением "Защита данных" по выбору. См. ссылки из предыдущей таблицы.

## <a name="restore-a-kubernetes-deployment"></a>Восстановление развертывания Kubernetes

Если вы выполнили развертывание Kubernetes с помощью Azure Arc, вы можете восстановить развертывание после сбоя устройства, отличного от приемлемой. Необходимо повторно развернуть приложение или контейнеры клиента из репозитория, в `git` котором хранится определение приложения. [Сведения о развертывании Kubernetes с помощью дуги Azure](./azure-stack-edge-gpu-deploy-stateless-application-git-ops-guestbook.md)<!--Original text: Kubernetes deployments can be restored from a non-tolerated failure with the device when deployed with Azure Arc. Customer application/containers deployed onto a Kubernetes on Azure Stack Edge via Azure Arc can be redeployed from the git repository where the application definition is. Here is a link to the article to deploy Kubernetes with Arc -->
 
## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [вернуть устройство Pro Azure Stack](azure-stack-edge-return-device.md).
