---
title: Общие сведения о службе Azure "Подготовка устройств к добавлению в Центр Интернета вещей" | Документация Майкрософт
description: Эта статья содержит сведения о подготовке устройств в Azure с использованием Службы подготовки устройств (DPS) и Центра Интернета вещей.
author: wesmc7777
ms.author: wesmc
ms.date: 04/04/2019
ms.topic: overview
ms.service: iot-dps
services: iot-dps
manager: eliotgra
ms.custom:
- amqp
- mqtt
ms.openlocfilehash: e58028495da409df00db8e25adf68945a008bc9e
ms.sourcegitcommit: b28e9f4d34abcb6f5ccbf112206926d5434bd0da
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2021
ms.locfileid: "107228305"
---
# <a name="what-is-azure-iot-hub-device-provisioning-service"></a>Что собой представляет Служба подготовки устройств к добавлению в Центр Интернета вещей?
Microsoft Azure предоставляет широкий набор интегрированных общедоступных облачных служб для всех потребностей решений Интернета вещей. Служба подготовки устройств (DPS) Центра Интернета вещей является вспомогательной службой для Центра Интернета вещей, что позволяет быстро и полностью в автоматическом режиме подготовить необходимый Центр Интернета вещей без вмешательства пользователя. DPS позволяет безопасно и в масштабируемый способ предоставлять доступ к миллионам устройств.

## <a name="when-to-use-device-provisioning-service"></a>Сценарии использования службы подготовки устройств
Существует множество сценариев подготовки, в которых DPS помогает подключить и настроить устройства в Центре Интернета вещей, например:

* полностью автоматическая подготовка для одного решения Интернета вещей, не требующая указывания в коде сведений о подключении Центра Интернета вещей производителем (начальная настройка);
* Балансировка нагрузки устройств в нескольких центрах
* подключение устройств к решениям Интернета вещей их владельцев на основе данных операций по продажам (мультитенантность);
* подключение устройств к определенному решению Интернета вещей в зависимости от сценария использования (изоляция решений);
* подключение устройства к Центру Интернета вещей с минимальной задержкой (геосегментирование);
* повторная подготовка на основе изменений в устройстве;
* развертывание ключей, используемых устройством для подключения к Центру Интернета вещей (когда для подключения не используется сертификат X.509).

## <a name="behind-the-scenes"></a>Сопутствующие ресурсы
Все сценарии, перечисленные в предыдущем разделе, можно автоматически реализовать в одном и том же потоке с помощью DPS. DPS автоматизирует большинство выполняемых вручную действий подготовки, чтобы сократить время развертывания устройств Интернета вещей и снизить риск ошибки пользователей. В следующем разделе приводится описание действий, необходимых для подготовки устройства. Первое действие нужно выполнить вручную, а все остальные автоматизированы.

![Базовая процедура подготовки](./media/about-iot-dps/dps-provisioning-flow.png)

1. Производитель устройства добавляет сведения о регистрации устройства в список регистрации на портале Azure.
2. Устройство связывается с конечной точкой DPS, установленной производителем. Затем устройство предоставляет DPS идентификационные сведения для подтверждения подлинности.
3. DPS проверяет идентификатор устройства путем проверки идентификатора регистрации и ключа в соответствии с записью списка регистрации, выполняя специальный запрос nonce ([доверенный платформенный модуль](https://trustedcomputinggroup.org/work-groups/trusted-platform-module/)) или стандартную проверку X.509 (сертификат X.509).
4. DPS регистрирует устройство с помощью Центра Интернета вещей и заполняет [требуемое состояние двойника](../iot-hub/iot-hub-devguide-device-twins.md) устройства.
5. Центр Интернета вещей возвращает сведения об идентификаторе устройства в DPS.
6. DPS возвращает сведения о подключении к Центру Интернета вещей устройству. Теперь устройство может приступить к отправке данных непосредственно в Центр Интернета вещей.
7. Устройство подключается к Центру Интернета вещей.
8. Устройство получает требуемое состояние из двойника устройства в Центре Интернет вещей.

## <a name="provisioning-process"></a>Процесс подготовки
Процесс развертывания устройства состоит из двух отдельных этапов, в которых участвует DPS:

* **Этап производства**, на котором устройство создается и подготавливается производителем.
* **Этап настройки облака**, на котором служба подготовки устройств настраивается для автоматической подготовки.

Оба эти этапа легко интегрируются с имеющимися процессами производства и развертывания. DPS даже упрощает некоторые процессы развертывания, которые выполняются вручную, чтобы получить сведения о подключении на устройстве.

### <a name="manufacturing-step"></a>Этап производства
Этот этап полностью посвящен действиям на производственной линии. На этом этапе задействуются такие роли, как кремниевый конструктор, кремниевый производитель, интегратор и (или) конечный производитель устройства. Этот этап посвящен созданию оборудования.

DPS не вводит новые действия на этапе производства, однако она участвует в имеющихся действиях, выполняющих установку первоначального программного обеспечения и (в идеале) HSM на устройстве. Вместо создания идентификатора устройства на этом этапе устройство программируется с использованием сведений службы подготовки. При включении устройство вызывает службу подготовки для получения сведений о подключении и назначения решения Интернета вещей.

На этом этапе производитель также предоставляет специалисту по развертыванию или оператору устройств сведения об идентифицирующем ключе. Эта процедура может заключаться в простом подтверждении того, что все устройства имеют сертификат X.509, созданный из сертификата для подписи, который предоставил специалист по развертыванию или оператор устройств. Также сведения могут предоставляться для более сложной задачи: извлечения открытой части ключа подтверждения доверенного платформенного модуля (TPM) из каждого устройства TPM. Сегодня эти службы предлагают многие кремниевые производители.

### <a name="cloud-setup-step"></a>Этап настройки облака
На этом этапе выполняется настройка облака для правильной автоматической подготовки. Обычно на этом этапе задействованы два типа пользователей: пользователь, который знает, как выполнить изначальную настройку устройств (оператор устройств), и пользователь, который знает, как разделить устройства среди Центров Интернета вещей (оператор решений).

Это однократная начальная настройка подготовки, которую необходимо выполнить. Как правило, это делает оператор решений. После настройки службу подготовки не нужно изменять, пока не изменится вариант использования.

Настроив службу для автоматической подготовки, ее необходимо подготовить к регистрации устройств. Этот этап выполняет оператор устройств, которому известна требуемая конфигурация устройств и который должен проследить, чтобы служба подготовки могла надлежащим образом подтвердить удостоверение устройства при поиске Центра Интернета вещей. Оператор устройств принимает сведения об идентифицирующем ключе от производителя и добавляет их в список регистрации. Список регистрации может обновляться по мере добавления новых записей или обновления имеющихся записей последними сведениями об устройствах.

## <a name="registration-and-provisioning"></a>Регистрация и подготовка
Под *подготовкой* подразумеваются различные действия, в зависимости от отрасли, в которой используется термин. В контексте подготовки устройств Интернета вещей для облачных решений подготовка состоит из двух этапов:

1. На первом этапе устанавливается начальное подключение между устройством и решением Интернета вещей путем регистрации устройства.
2. Второй этап включает применение правильной конфигурации на устройстве на основе определенных требований решения, в котором оно зарегистрировано.

Устройство будет полностью подготовлено только после завершения обоих этапов. В некоторых облачных службах выполняется только первый этап процесса подготовки (регистрация устройств в конечной точке решения Интернета вещей). В них нельзя выполнить начальную настройку. DPS автоматизирует оба этапа для обеспечения эффективной подготовки устройства.

## <a name="features-of-the-device-provisioning-service"></a>Возможности службы подготовки устройств
DPS имеет множество возможностей, благодаря которым она идеально подходит для подготовки устройств.

* **Поддержка безопасной аттестации** удостоверения X.509 и удостоверения на основе доверенного платформенного модуля.
* **Список регистрации**, содержащий полную запись устройств или групп устройств, которые можно зарегистрировать в определенный момент. Он также содержит сведения о требуемой конфигурации устройства после его регистрации и может быть обновлен в любое время.
* **Несколько политик распределения**, позволяющих управлять назначением устройств DPS для центров Интернета вещей с целью поддержки ваших сценариев. Наименьшая задержка, равномерно взвешенное распределение (по умолчанию) и статическая конфигурация с помощью списка регистрации. Задержка определяется с помощью того же метода, что использует [Диспетчер трафика](../traffic-manager/traffic-manager-routing-methods.md#performance).
* **Ведение журналов мониторинга и диагностики** позволяет убедиться, что все работает правильно.
* **Поддержка нескольких центров** позволяет DPS назначить устройства нескольким Центрам Интернета вещей. DPS может взаимодействовать с центрами в нескольких подписках Azure.
* **Поддержка нескольких регионов** позволяет DPS назначить устройства Центрам Интернета вещей в других регионах.
* **Шифрование неактивных данных** позволяет прозрачно шифровать и расшифровывать данные в DPS с помощью 256-битного шифрования AES. Это один из самых надежных из доступных сейчас блочных шифров. При этом обеспечивается соответствие FIPS 140-2.


Дополнительные сведения о принципах и функциях, задействованных в процессе подготовки устройств к работе, см. в разделе [Терминология DPS](concepts-service.md) и в других разделах, посвященных этой теме.

## <a name="cross-platform-support"></a>Кроссплатформенная поддержка
DPS, как и все службы Интернета вещей Azure, работает на нескольких платформах с различными операционными системами. Azure предоставляет пакеты SDK с открытым кодом на различных [языках](https://github.com/Azure/azure-iot-sdks), чтобы упростить подключение устройств и управление службой. DPS поддерживает следующие протоколы для подключения устройств:

* HTTPS
* AMQP
* AMQP через веб-сокеты;
* MQTT
* MQTT через веб-сокеты.

DPS поддерживает только HTTPS-подключения для операций службы.

## <a name="regions"></a>Регионы
DPS доступна во многих регионах. Обновленный список доступных и новых регионов для всех служб можно найти на странице [Регионы Azure](https://azure.microsoft.com/regions/). Проверить доступность службы подготовки устройств можно на странице [Состояние Azure](https://azure.microsoft.com/status/).

> [!NOTE]
> DPS является глобальной и не привязана к расположению. Но вам потребуется указать регион, в котором будут храниться метаданные, связанные с вашим профилем DPS.

## <a name="availability"></a>Доступность
Для DPS поддерживается [соглашение об уровне обслуживания](https://azure.microsoft.com/support/legal/sla/iot-hub/), предусматривающее доступность службы на уровне 99,9 %. В полном [соглашении об уровне обслуживания Azure](https://azure.microsoft.com/support/legal/sla/) поясняется гарантированная доступность Azure в целом.

## <a name="quotas"></a>Квоты
Для каждой подписки Azure предусмотрена квота по умолчанию, которая может повлиять на зону охвата решения Интернета вещей. Текущее ограничение для каждой подписки составляет 10 служб подготовки устройств на подписку.

[!INCLUDE [azure-iotdps-limits](../../includes/iot-dps-limits.md)]

Дополнительные сведения об ограничениях квоты:
* [Подписка Azure, границы, квоты и ограничения службы](../azure-resource-manager/management/azure-subscription-service-limits.md)

## <a name="related-azure-components"></a>Связанные компоненты Azure
DPS автоматизирует подготовку устройств с помощью Центра Интернета вещей. См. дополнительные сведения о [Центре Интернета вещей](../iot-hub/index.yml).

## <a name="next-steps"></a>Дальнейшие действия
Вы ознакомились с общими сведениями о подготовке устройств Интернета вещей в Azure. Далее следует ознакомиться с комплексным сценарием Интернета вещей.

[Настройка службы "Подготовка устройств к добавлению в Центр Интернета вещей" на портале Azure](quick-setup-auto-provision.md)

[Создание и подготовка имитированного устройства доверенного платформенного модуля (ТРМ) с помощью пакета SDK для устройства C для службы подготовки устройств Центра Интернета вещей](quick-create-simulated-device.md)

[Set up a device to provision using the Azure IoT Hub Device Provisioning Service](tutorial-set-up-device.md) (Настройка устройства для подготовки с помощью службы подготовки устройств для Центра Интернета вещей)