---
title: Терминология, используемая в службе подготовки устройств к добавлению в центр Интернета вещей Azure | Документация Майкрософт
description: Описывает стандартную терминологию, используемую в службе подготовки устройств (DPS) и центре Интернета вещей.
author: wesmc7777
ms.author: wesmc
ms.date: 09/18/2019
ms.topic: conceptual
ms.service: iot-dps
services: iot-dps
manager: eliotga
ms.openlocfilehash: b9fc37c6589cdd0bc6a5cdce7b7ebebe2c6e9a85
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96019452"
---
# <a name="iot-hub-device-provisioning-service-dps-terminology"></a>Терминология службы подготовки устройств к добавлению в центр Интернета вещей (DPS)

Служба подготовки устройств для Центра Интернета вещей — это вспомогательная служба, позволяющая настроить полностью автоматическую подготовку устройства в указанном Центре Интернета вещей. Служба подготовки устройств позволяет [подготавливать](about-iot-dps.md#provisioning-process) миллионы устройств в безопасном и масштабируемом режиме.

Подготовка устройства состоит из двух этапов. Первая часть — это установка начального подключения между устройством и решением IoT путем *регистрации* устройства. Второй этап включает применение правильной *конфигурации* на устройстве на основе определенных требований решения. После завершения обоих этапов устройство будет полностью *подготовлено*. Служба подготовки устройств автоматизирует оба этапа для обеспечения эффективной подготовки устройства.

В этой статье приводятся основные понятия подготовки, которые лучше всего подходят для управления *службой*. Сведения в этой статье касаются пользователей, участвующих в [этапе настройки облака](about-iot-dps.md#cloud-setup-step) по подготовке устройства для развертывания.

## <a name="service-operations-endpoint"></a>Конечная точка операций службы

Конечная точка операций службы — это конечная точка, предназначенная для управления параметрами службы и обслуживания списка регистрации. Эта конечную точку использует только администратор служб. Она не используется на устройствах.

## <a name="device-provisioning-endpoint"></a>Конечная точка подготовки устройства

Конечная точка подготовки устройства — это одна конечная точка, которую все устройства используют для автоматической подготовки. Все экземпляры службы подготовки используют один и тот же URL-адрес, что исключает необходимость перезаписывать в память устройств новые данные о подключении в сценариях цепочки поставок. Область идентификатора обеспечивает изоляцию клиентов.

## <a name="linked-iot-hubs"></a>Связанные Центры Интернета вещей

Служба подготовки устройств может подготавливать для Центров Интернета вещей только связанные с ней устройства. Связывание Центра Интернета вещей с экземпляром службы подготовки устройств предоставляет разрешения на чтение и запись к службе в реестре устройств Центра Интернета вещей. С помощью связывания служба подготовки устройств может зарегистрировать идентификатор устройства и задать начальную конфигурацию в двойнике устройства. Связанные Центры Интернета вещей могут находиться в любом регионе Azure. К службе подготовки можно привязать Центры в других подписках.


## <a name="allocation-policy"></a>Политика распределения

Параметр на уровне службы, определяющий назначение устройств службой подготовки устройств Центру Интернета вещей. Поддерживаются три политики распределения:

* **Evenly weighted distribution** (Равномерное распределение). В связанных Центрах Интернета вещей можно обеспечить равномерную подготовку устройств. Значение по умолчанию. При подготовке устройств только в одном Центре Интернета вещей можно оставить это значение.

* **Lowest latency** (Минимальная задержка). Устройства подготавливаются в Центре Интернета вещей с минимальной задержкой. Если несколько связанных Центров Интернета вещей обеспечивают одинаковую наименьшую задержку, служба подготовки хэширует устройства по этим Центрам.

* **Static configuration via the enrollment list** (Статическая конфигурация через список регистрации). Спецификация нужного Центра Интернета вещей в списке регистрации имеет приоритет над политикой распределения на уровне службы.

* **Custom (использование функции Azure)**. пользовательская политика распределения обеспечивает более полный контроль над назначенными устройствами для центра Интернета вещей. Это достигается с помощью пользовательского кода в функции Azure, используемого для назначения устройств Центру Интернета вещей. Служба подготовки устройств вызывает код функции Azure, который предоставляет все необходимые сведения об устройстве и регистрации в коде. Код функции выполняется и возвращает данные Центра Интернета вещей, используемые при подготовке устройства.

## <a name="enrollment"></a>Регистрация

Регистрация — это запись устройств или групп устройств, которые могут регистрироваться посредством автоматической подготовки. Запись регистрации содержит сведения об устройстве или группе устройств, включая:
- используемый на устройстве [механизм аттестации](#attestation-mechanism);
- предпочитаемая начальная конфигурация (необязательная информация);
- предпочитаемый Центр Интернета вещей;
- предпочитаемый идентификатор устройства.

Служба подготовки устройств поддерживает два типа регистрации.

### <a name="enrollment-group"></a>Группа регистраций

Это группа устройств, совместно использующих определенный механизм аттестации. Группы регистрации поддерживают как X. 509, так и симметричное. Все устройства в группе регистрации X. 509 представляют сертификаты X. 509, подписанные одним и тем же корневым или промежуточным центром сертификации (ЦС). Каждое устройство в группе регистрации симметричных ключей предоставляет маркеры SAS, производные от симметричного ключа группы. Имя группы регистрации и сертификата должно состоять из букв и цифр нижнего регистра и может содержать дефисы.

> [!TIP]
> Мы советуем использовать группу регистраций для большого количества устройств, имеющих необходимую начальную конфигурацию, или для устройств, предназначенных для одного и того же клиента.

### <a name="individual-enrollment"></a>Отдельная регистрация

Отдельная регистрация — это запись одного устройства, которое можно зарегистрировать. При аттестации таких устройств используются сертификаты X.509 конечных объектов или токены SAS (от физических или виртуальных доверенных платформенных модулей). Идентификатор регистрации в отдельной регистрации состоит из цифр и букв нижнего регистра и может содержать дефисы. Для отдельных регистраций можно указать нужный идентификатор устройства Центра Интернета вещей.

> [!TIP]
> Мы рекомендуем использовать отдельные регистрации для устройств, которым требуются уникальные начальные конфигурации, или для устройств, которые для аутентификации могут использовать только аттестацию с помощью доверенного платформенного модуля и токена SAS.


## <a name="attestation-mechanism"></a>Механизм аттестации

Механизм аттестации — это метод, используемый для подтверждения удостоверения устройства. Механизм аттестации Настраивается в записи регистрации и сообщает службе подготовки, какой метод следует использовать при проверке удостоверения устройства во время регистрации.

> [!NOTE]
> Для применения аналогичной концепции Центр Интернета вещей использует схему проверки подлинности.

Служба подготовки устройств поддерживает следующие формы аттестации:
* **Сертификаты X.509** на основе стандартного потока проверки подлинности сертификата X.509. Дополнительные сведения см. в разделе [аттестация X. 509](concepts-x509-attestation.md).
* **Доверенный платформенный модуль (TPM)** на основе задачи nonce с использованием стандарта TPM для представления в ключах подписанного URL-адреса (SAS). Для этого на устройстве не требуется физический доверенный платформенный модуль, но служба должна подтвердить использование ключа подтверждения для [спецификации TPM](https://trustedcomputinggroup.org/work-groups/trusted-platform-module/). Дополнительные сведения см. в статье [аттестация доверенного платформенного модуля](concepts-tpm-attestation.md).
* **Симметричный ключ** на основе [маркеров безопасности](../iot-hub/iot-hub-devguide-security.md#security-tokens) подписанного URL-адреса (SAS), который включает в себя хэшированную подпись и встроенный срок действия. Дополнительные сведения см. в разделе [Аттестация симметричного ключа](concepts-symmetric-key-attestation.md).


## <a name="hardware-security-module"></a>Аппаратный модуль безопасности

Аппаратный модуль безопасности (HSM) используется для безопасного аппаратного хранения секретов устройств. Это самая безопасная форма хранилища секретов. В HSM могут храниться как сертификаты X.509, так и токены SAS. HSM можно использовать с обоими механизмами аттестации, которые поддерживает служба подготовки.

> [!TIP]
> Мы настоятельно рекомендуем использовать HSM для безопасного хранения секретов на устройствах.

Секреты устройств также можно хранить в программном обеспечении (памяти). Но, по сравнению с HSM, это менее безопасный способ хранения.



## <a name="id-scope"></a>Область идентификаторов

Область идентификаторов назначается для службы подготовки устройства, когда ее создает пользователь. Она однозначно идентифицирует конкретную службу подготовки, с помощью которой будет зарегистрировано устройство. Область идентификаторов создается службой. Она неизменяемая, что гарантирует ее уникальность.

> [!NOTE]
> Это важно для длительных операций развертывания и сценариев слияния и приобретения.


## <a name="registration"></a>Регистрация

Регистрация — это запись успешной регистрации или подготовки устройства в Центре Интернета вещей через службу подготовки устройств. Записи регистрации создаются автоматически. Вы можете их удалить, но не обновить.


## <a name="registration-id"></a>Идентификатор регистрации

ИДЕНТИФИКАТОР регистрации используется для уникальной идентификации регистрации устройства в службе подготовки устройств. Идентификатор устройства должен быть уникальным в [области идентификаторов](#id-scope) службы подготовки. Каждое устройство должно иметь идентификатор регистрации. ИДЕНТИФИКАТОР регистрации является буквенно-цифровым, без учета регистра и может содержать специальные символы, включая двоеточие, точку, символ подчеркивания и дефис.

* В случае использования TPM идентификатор регистрации предоставляется самим доверенным платформенным модулем.
* В случае использования аттестации на основе сертификата X.509 идентификатор регистрации предоставляется в качестве имени субъекта сертификата.

## <a name="device-id"></a>Идентификатор устройства

Идентификатор устройства совпадает с идентификатором, отображаемым в Центре Интернета вещей. Необходимый идентификатор устройства можно задать в записи регистрации, но это необязательно. Настройка требуемого идентификатора устройства поддерживается только в индивидуальных регистрациях. Если в списке регистрации нет необходимого идентификатора устройства, при регистрации устройства в качестве идентификатора устройства используется идентификатор регистрации. Узнайте больше об [идентификаторах устройств в Центре Интернета вещей](../iot-hub/iot-hub-devguide-identity-registry.md).



## <a name="operations"></a>Операции

Операции представляют собой единицы выставления счетов Службы подготовки устройств. Операцией является успешное выполнение одной инструкции в службе. К операциям относятся регистрация и повторная регистрация устройств, а также изменения на стороне службы, например добавление записей в список регистрации и их обновление.
