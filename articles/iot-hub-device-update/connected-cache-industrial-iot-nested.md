---
title: Использование Подключенного кэша Майкрософт в Azure IoT Edge для настройки промышленного Интернета вещей | Документация Майкрософт
description: Учебник по использованию Подключенного кэша Майкрософт в Azure IoT Edge для настройки промышленного Интернета вещей.
author: andyriv
ms.author: andyriv
ms.date: 2/16/2021
ms.topic: tutorial
ms.service: iot-hub-device-update
ms.openlocfilehash: 0d70ed8b906c171c001c5bda81a79ca9b65febac
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "101658880"
---
# <a name="microsoft-connected-cache-preview-deployment-scenario-sample-microsoft-connected-cache-within-an-azure-iot-edge-for-industrial-iot-configuration"></a>Пример сценария развертывания Подключенного кэша Майкрософт (предварительная версия): Подключенный кэш Майкрософт в Azure IoT Edge для настройки промышленного Интернета вещей

Производственные сети часто организованы в виде иерархических уровней в соответствии с [моделью сети Пердью](https://en.wikipedia.org/wiki/Purdue_Enterprise_Reference_Architecture) (входящей в стандарты [ISA 95](https://en.wikipedia.org/wiki/ANSI/ISA-95) и [ISA 99](https://www.isa.org/standards-and-publications/isa-standards/isa-standards-committees/isa99)). В этих сетях только верхний уровень имеет возможность подключения к облаку, а нижние уровни могут взаимодействовать только с непосредственно соседними с ними уровнями.

В этом примере GitHub, [Azure IOT Edge для промышленного Центра Интернета вещей](https://github.com/Azure-Samples/iot-edge-for-iiot), развертывается следующее:

* имитированная сеть Пердью в Azure;
* промышленные ресурсы; 
* иерархия шлюзов Azure IoT Edge.
  
Эти компоненты будут использоваться для получения промышленных данных и их безопасной передачи в облако без ущерба для безопасности сети. Можно развернуть Подключенный кэш Майкрософт для поддержки скачивания содержимого на всех уровнях в сети, совместимой с ISA 95.

Ключом к настройке развертываний Подключенного кэша Майкрософт в сети, совместимой с ISA 95, является настройка как прокси-сервера, так *и* вышестоящего узла на шлюзе IOT Edge уровня 3.

1. Настройте развертывания Подключенного кэша Майкрософт на уровнях 5 и 4, как описано в примере двухуровневого вложенного шлюза IoT Edge. 
2. В развертывании на шлюзе IoT Edge уровня 3 нужно указать следующее:
   
   * UPSTREAM_HOST — IP-адрес или полное доменное имя шлюза IoT Edge уровня 4, у которого Подключенный кэш Майкрософт уровня 3 будет запрашивать содержимое.
   * UPSTREAM_PROXY: IP-адрес или полное доменное имя и порт прокси-сервера OT.

3. Прокси-сервер OT должен добавить в список разрешений полное доменное имя или IP-адрес MCC уровня 4.

Чтобы проверить, правильно ли работает Подключенный кэш Майкрософт, выполните приведенную ниже команду в терминале на устройстве IoT Edge, в котором размещен модуль, или на любом устройстве в сети.

```bash
    wget "http://<L3 IoT Edge Gateway IP>/mscomtest/wuidt.gif?cacheHostOrigin=au.download.windowsupdate.com
```