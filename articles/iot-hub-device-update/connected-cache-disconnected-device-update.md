---
title: Общие сведения о поддержке отключенного обновления устройства с помощью подключенного кэша Майкрософт | Документация Майкрософт
titleSuffix: Device Update for Azure IoT Hub
description: Общие сведения о поддержке отключенного обновления устройства с помощью подключенного кэша Майкрософт
author: andyriv
ms.author: andyriv
ms.date: 2/16/2021
ms.topic: conceptual
ms.service: iot-hub-device-update
ms.openlocfilehash: e2b27934f58402ecfb7dabf5560dc43e45f3f7dd
ms.sourcegitcommit: b4647f06c0953435af3cb24baaf6d15a5a761a9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2021
ms.locfileid: "101680059"
---
# <a name="understand-support-for-disconnected-device-updates"></a>Общие сведения о поддержке отключенных обновлений устройств

В сценарии с прозрачным шлюзом одно или несколько устройств могут передавать свои сообщения через одно устройство шлюза, которое поддерживает подключение к центру Интернета вещей Azure. В таких случаях дочерние устройства могут не иметь подключения к Интернету или может быть запрещено скачивать содержимое из Интернета. Модуль предварительной версии подключенного кэша Майкрософт IoT Edge предоставит обновление устройства для клиентов центра Интернета вещей Azure с помощью интеллектуального сетевого кэша, который позволяет обновлять устройства на основе образов ОС Linux на основе образа и IoT Edge шлюза (подчиненные устройства Интернета вещей), а также помогает экономить пропускную способность для обновления устройств для клиентов центра Интернета вещей Azure.

## <a name="how-does-microsoft-connected-cache-preview-for-device-update-for-azure-iot-hub-work"></a>Как работает Предварительная версия подключенного кэша Майкрософт для обновления устройства для центра Интернета вещей Azure?

Подключенный кэш Майкрософт — это интеллектуальный, прозрачный кэш для содержимого, опубликованного для обновления устройства в центре Интернета вещей Azure. его можно настроить для кэширования содержимого из других источников, таких как репозитории пакетов. Подключенный кэш Майкрософт — это холодный кэш, который замещается клиентскими запросами к точным диапазонам файлов, запрошенным клиентом оптимизации доставки, и не использует предварительное начальное содержимое. На схеме и пошаговом описании ниже объясняется, как работает кэш, подключенный к Майкрософт, в центре обновления для инфраструктуры центра Интернета вещей Azure.

>[!Note]
>При определении этого потока предполагается, что шлюз IoT Edge имеет подключение к Интернету. Для нисходящего сценария IoT Edge шлюза (вложенная сторона) "сеть доставки содержимого" (CDN) можно рассматривать как MCC, размещенный на родительском шлюзе IoT Edge.

  :::image type="content" source="media/connected-cache-overview/disconnected-device-update.png" alt-text="Обновление отключенного устройства" lightbox="media/connected-cache-overview/disconnected-device-update.png":::

1. Подключенный кэш Майкрософт развертывается как модуль IoT Edge на локальный сервер.
2. Обновление устройства для клиентов центра Интернета вещей Azure настраивается на загрузку содержимого из подключенного кэша Майкрософт с помощью атрибута Гатевайхостнаме строки подключения устройства для конечных устройств IoT **или** parent_hostname задается в файле config. томл для дочерних устройств IOT Edge.
3. Обновление устройства для клиентов центра Интернета вещей Azure в обоих случаях позволяет получить обновление содержимого с помощью команд скачать содержимое из обновления устройства для службы центра Интернета вещей Azure и запросить обновление содержимого в подключенном кэше Майкрософт, а не в сети CDN. По умолчанию подключенный кэш Майкрософт настроен для прослушивания HTTP-порта 80, а клиент оптимизации доставки выполняет запрос содержимого через порт 80, поэтому для родительского элемента необходимо настроить прослушивание этого порта.  В настоящее время поддерживается только протокол HTTP.
4. Сервер подключенного кэша Майкрософт загружает содержимое из CDN, заполняет свой локальный кэш, хранящийся на диске, и доставляет содержимое в обновление устройства для клиента центра Интернета вещей Azure.
   
>[!Note]
>При использовании обновлений на основе пакетов сервер подключенного кэша Майкрософт настраивается администратором с требуемым именем узла пакета.

5. Последующие запросы от обновления других устройств для клиентов центра Интернета вещей Azure для того же содержимого обновления будут получены из кэша, а подключенный кэш Майкрософт не будет выполнять запросы к сети CDN для того же содержимого.

### <a name="supporting-industrial-iot-iiot-with-parentchild-hosting-scenarios"></a>Поддержка промышленных центров Интернета вещей (промышленному) с использованием родительских и дочерних сценариев размещения

Если подчиненный или дочерний шлюз IoT Edge размещает сервер подключенного кэша Майкрософт, он будет настроен для запроса обновления содержимого от родительского шлюза IoT Edge, на котором размещен сервер кэша, подключенный к Microsoft. Это необходимо для необходимого количества уровней, прежде чем достичь родительского шлюза IoT Edge, на котором размещен сервер кэша, подключенный к Интернету и имеющий доступ в Интернет. С сервера, подключенного к Интернету, содержимое запрашивается из сети CDN. в этом случае содержимое отправляется обратно дочернему шлюзу IoT Edge, который первоначально запросил это содержимое. Содержимое будет храниться на диске на каждом уровне.

## <a name="access-to-the-microsoft-connected-cache-preview-for-device-update-for-azure-iot-hub"></a>Доступ к предварительной версии подключенного кэша Майкрософт для обновления устройства для центра Интернета вещей Azure

Модуль IoT Edge подключенного кэша Майкрософт выпущен в качестве предварительной версии для клиентов, которые развертывают решения с помощью обновления устройства для центра Интернета вещей Azure. Доступ к предварительной версии осуществляется по приглашению. [Запросите доступ](https://aka.ms/MCCForDeviceUpdateForIoT) к предварительной версии кэша Microsoft Connected для обновления устройства для IOT Хут и укажите запрашиваемые сведения, если требуется доступ к модулю.
