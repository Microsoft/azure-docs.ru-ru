---
title: Обновление устройств для операционной системы реального времени Azure | Документация Майкрософт
description: Начало работы с Обновлением устройств для операционной системы реального времени Azure
author: valls
ms.author: valls
ms.date: 3/18/2021
ms.topic: tutorial
ms.service: iot-hub-device-update
ms.openlocfilehash: 66da860a5cdae1f5c7c18e4136b1f2d960492ca8
ms.sourcegitcommit: 32e0fedb80b5a5ed0d2336cea18c3ec3b5015ca1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "105629059"
---
# <a name="device-update-for-azure-iot-hub-tutorial-using-azure-real-time-operating-system-rtos"></a>Руководство по Обновлению устройств для Центра Интернета вещей Azure с использованием операционной системы реального времени (ОСРВ) Azure

В этом руководстве объясняется, как создать экземпляр службы "Обновление устройств" для агента Центра Интернета вещей в ОСРВ Azure NetX Duo. Кроме того, здесь представлены простые API для разработчиков, позволяющие интегрировать возможности Обновления устройств в приложения. Изучите [примеры](https://github.com/azure-rtos/samples/tree/PublicPreview/ADU) основных макетов полупроводниковых плат, которые включают руководства по началу работы с инструкциями по настройке, созданию и развертыванию обновлений для устройств по беспроводной сети (OTA).

Из этого учебного курса вы узнаете следующее:
> [!div class="checklist"]
> * Начало работы
> * Добавление тегов к устройству
> * Создание группы устройств
> * Развертывание обновления на основе образа.
> * Слежение за развертыванием обновления

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="prerequisites"></a>Предварительные требования
* Доступ к Центру Интернета вещей. Рекомендуется использовать уровень S1 (Стандартный) или выше.
* Экземпляр и учетная запись Обновления устройств, связанные с центром Интернета вещей. Следуйте указаниям по [созданию и связыванию](http://create-device-update-account.md/) учетной записи Обновления устройств, если вы это еще не сделали.

## <a name="get-started"></a>Начало работы

В каждом примере проекта ОСРВ Azure для конкретной платы содержится код и документация по использованию Обновления устройств для Центра Интернета вещей. 
1. Скачайте примеры файлов для конкретных плат из статьи с [примерами ОСРВ Azure и Обновления устройств](https://github.com/azure-rtos/samples/tree/PublicPreview/ADU).
2. Найдите в скачанном примере папку документации.
3. Выполните приведенные в документации инструкции по подготовке ресурсов и учетной записи Azure, а также по регистрации в ней устройств Интернета вещей.
5. Затем следуйте инструкциям по созданию образа встроенного ПО и импорту манифеста для своей платы.
6. Далее опубликуйте образ встроенного ПО и манифест для Обновления устройств для Центра Интернета вещей.
7. Наконец, скачайте проект и запустите его на устройстве.

Ознакомьтесь с дополнительными сведениями об [ОСРВ Azure](https://docs.microsoft.com/azure/rtos/).  

## <a name="tag-your-device"></a>Добавление тегов к устройству

1. Устройство должно продолжать работу после выполнения предыдущего этапа.
2. Войдите на [портал Azure](https://portal.azure.com) и откройте Центр Интернета вещей.
3. В разделе "Устройства Интернета вещей" на панели навигации слева найдите свое устройство Интернета вещей и перейдите к разделу "Двойник устройства".
4. В разделе "Двойник устройства" удалите все существующие значения тега обновления устройства, присвоив им значение NULL.
5. Добавьте новое значение тега обновления устройства, как показано ниже.

```JSON
    "tags": {
            "ADUGroup": "<CustomTagValue>"
            }
```

## <a name="create-update-group"></a>Создание группы обновлений

1. Откройте Центр Интернета вещей, ранее подключенный к экземпляру Обновления устройств.
2. Выберите вариант "Обновления устройств" в разделе "Автоматическое управление устройствами" на панели навигации слева.
3. Щелкните вкладку "Группы" в верхней части страницы. 
4. Нажмите кнопку "Добавить", чтобы создать новую группу.
5. Выберите из списка тег Центра Интернета вещей, созданный в предыдущем шаге. Щелкните "Создать группу обновлений".

   :::image type="content" source="media/create-update-group/select-tag.PNG" alt-text="Снимок экрана, на котором показан выбор тега." lightbox="media/create-update-group/select-tag.PNG":::

[Подробнее](create-update-group.md) о добавлении тегов и создании групп обновлений

## <a name="deploy-new-firmware"></a>Развертывание нового встроенного ПО

1. Когда группа создана, должно появиться новое обновление, доступное вашей группе устройств. Ссылка на него будет отображаться в разделе "Ожидающие обновления". Чтобы ее увидеть, возможно, потребуется обновить страницу. 
2. Щелкните доступное обновление.
3. Подтвердите, что целевая группа выбрана правильно. Запланируйте развертывание, а затем нажмите "Развернуть обновление".

   :::image type="content" source="media/deploy-update/select-update.png" alt-text="Выбор обновления" lightbox="media/deploy-update/select-update.png":::

4. Посмотрите на диаграмму соответствия требованиям. По ней должно быть видно, что процесс обновления выполняется. 

   :::image type="content" source="media/deploy-update/update-in-progress.png" alt-text="Выполняется обновление" lightbox="media/deploy-update/update-in-progress.png":::

5. После успешного обновления устройства диаграмма соответствия требованиям и сведения о развертывании должны измениться, отражая одну и ту же информацию. 

   :::image type="content" source="media/deploy-update/update-succeeded.png" alt-text="Обновление выполнено" lightbox="media/deploy-update/update-succeeded.png":::

## <a name="monitor-an-update-deployment"></a>Слежение за развертыванием обновления

1. Щелкните вкладку "Развертывания" в верхней части страницы.

   :::image type="content" source="media/deploy-update/deployments-tab.png" alt-text="Вкладка &quot;Развертывания&quot;" lightbox="media/deploy-update/deployments-tab.png":::

2. Выберите созданное развертывание, чтобы просмотреть сведения о нем.

   :::image type="content" source="media/deploy-update/deployment-details.png" alt-text="Сведения о развертывании" lightbox="media/deploy-update/deployment-details.png":::

3. Щелкните "Обновить", чтобы просмотреть последние данные о состоянии. Делайте так, пока состояние не изменится на "Выполнено".

Теперь вы успешно выполнили комплексное обновление на основе образа на устройстве Raspberry Pi 3 B + с помощью Обновления устройств для Центра Интернета вещей. 

## <a name="cleanup-resources"></a>Очистка ресурсов

Очистите учетную запись Обновления устройства, экземпляр, Центр Интернета вещей и устройство Интернета вещей, если они больше не нужны. 

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об ОСРВ Azure и о том, как служба работает с Интернетом вещей Azure, см. здесь: https://azure.com/rtos.
