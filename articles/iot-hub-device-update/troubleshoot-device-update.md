---
title: Устранение неполадок, связанных с общим обновлением устройств для центра Интернета вещей Azure | Документация Майкрософт
description: В этом документе представлен список советов и рекомендаций по устранению многих возможных проблем с обновлением устройства для центра Интернета вещей.
author: lichris
ms.author: lichris
ms.date: 2/17/2021
ms.topic: troubleshooting
ms.service: iot-hub-device-update
ms.openlocfilehash: 3c1f60b214397b1f97e0157b5beca32d504102d6
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102030636"
---
# <a name="device-update-for-iot-hub-troubleshooting-guide"></a>Руководство по устранению неполадок центра Интернета вещей

В этом документе перечислены некоторые распространенные вопросы и проблемы, о которых сообщили пользователи обновления устройств. По мере обновления устройства через общедоступную предварительную версию это руководство по устранению неполадок будет периодически обновляться с новыми вопросами и решениями. Если возникла проблема, которая не отображается в этом руководстве по устранению неполадок, ознакомьтесь с разделом " [обращение служба поддержки Майкрософт](#contact) ", чтобы задокументировать вашу ситуацию.

## <a name="importing-updates"></a><a name="import"></a>Импорт обновлений

### <a name="q-im-having-trouble-connecting-my-device-update-instance-to-my-iot-hub-instance"></a>Вопрос. возникли проблемы при подключении экземпляра обновления устройства к экземпляру центра Интернета вещей.
_Убедитесь, что маршруты сообщений центра Интернета вещей настроены правильно, в соответствии с документацией по [ресурсам обновления устройства](./device-update-resources.md) ._

### <a name="q-im-encountering-a-role-related-error-error-message-in-azure-portal-or-a-403-api-error"></a>Вопрос. возникает ошибка, связанная с ролью (сообщение об ошибке в портал Azure или ошибка API 403).
_Возможно, неправильно настроены разрешения на доступ. Убедитесь, что разрешения на доступ правильно настроены в соответствии с документацией по [управлению доступом для обновления устройства](./device-update-control-access.md) ._

### <a name="q-im-encountering-a-500-type-error-when-importing-content-to-the-device-update-service"></a>Вопрос. при импорте содержимого в службу обновления устройства возникает ошибка 500 типа.
_Код ошибки в диапазоне 500 может указывать на ошибку в службе обновления устройства. Подождите 5 минут и повторите попытку. Если такая же ошибка повторится, следуйте инструкциям в разделе " [обращение служба поддержки Майкрософт](#contact) ", чтобы отправить запрос в службу поддержки корпорации Майкрософт._

### <a name="q-im-encountering-an-error-code-when-importing-content-and-would-like-to-parse-it"></a>Вопрос. при импорте содержимого я столкнулся с кодом ошибки и хотел бы его проанализировать.
_Сведения о синтаксическом анализе кодов ошибок см. в документации по [кодам ошибок обновления устройств](./device-update-error-codes.md) ._

## <a name="device-failures"></a><a name="device-failure"></a>Сбои устройств

### <a name="q-how-can-i-ensure-my-device-is-connected-to-device-update-for-iot-hub"></a>Вопрос. Как убедиться, что устройство подключено к обновлению устройства для центра Интернета вещей?
_Вы можете убедиться, что устройство подключено к обновлению устройства, проверив, отображается ли оно в разделе "несгруппированные" устройства в представлении "соответствие" портал Azure._

### <a name="q-one-or-more-of-my-devices-is-failing-to-update"></a>Вопрос. не удается обновить одно или несколько устройств.
_Существует множество возможных основных причин сбоя обновления устройства. Убедитесь, что устройство: 1) подключено к экземпляру центра Интернета вещей, 2) подключено к экземпляру обновления устройства и 3) запущена служба оптимизации доставки. Если все три имеют значение true для вашего устройства, следуйте инструкциям в разделе " [обращение служба поддержки Майкрософт](#contact) ", чтобы отправить запрос в службу поддержки корпорации Майкрософт._

## <a name="deploying-an-update"></a><a name="deploy"></a> Развертывание обновления

### <a name="q-ive-deployed-an-update-to-my-devices-but-the-compliance-status-says-it-isnt-on-the-latest-update-what-should-i-do"></a>Вопрос. я развернул обновление на моих устройствах, но состояние соответствия говорит о том, что он не находится на последнем обновлении.   Что следует делать?
_Обновление состояния соответствия устройства может занять до 5 минут. Подождите, а затем снова проверьте._
### <a name="q-my-devices-deployment-status-shows-incompatible-what-should-i-do"></a>Вопрос. состояние развертывания устройства показывает несовместимые, что мне делать?
_После подключения устройства к центру Интернета вещей изготовитель и свойства модели могут быть изменены, что привело к тому, что устройство будет считаться несовместимым с обновлением текущего развертывания._

_Проверьте [интерфейс аду Core](./device-update-plug-and-play.md) , чтобы узнать, какой производитель и модель устройства сообщает службе обновления устройства, и убедитесь, что она соответствует изготовителю и модели, указанной в [манифесте импорта](./import-concepts.md) развертываемого содержимого обновления. Вы можете изменить эти свойства для конкретного устройства с помощью [файла конфигурации обновления устройства](./device-update-configuration-file.md)._

### <a name="q-i-see-my-deployment-is-in-active-stage-but-none-of-my-devices-are-in-progress-with-the-update-what-should-i-do"></a>Вопрос. мое развертывание находится на этапе "активно", но ни одно из устройств не "выполняется" при обновлении.   Что следует делать?
_Убедитесь, что дата начала развертывания не задана в будущем. При создании нового развертывания Дата начала развертывания по умолчанию устанавливается на следующий день в качестве меры предосторожности, если она не была явно изменена. Можно либо дождаться наступления даты начала развертывания, либо отменить текущее развертывание и создать новое развертывание с требуемой датой начала._

### <a name="q-im-trying-to-group-my-devices-but-i-dont-see-the-tag-in-the-drop-down-when-creating-a-group"></a>Вопрос. я пытаюсь сгруппировать мои устройства, но не вижу тег в раскрывающемся списке при создании группы.
_Убедитесь, что маршруты сообщений в центре Интернета вещей настроены правильно, как и в документации по [ресурсам обновления устройства](./device-update-resources.md) . После настройки маршрута вам потребуется пометить устройство еще раз._

_Другой основной причиной может быть применение тега перед подключением устройства к обновлению устройства для центра Интернета вещей. Убедитесь, что устройство уже подключено к обновлению устройства. Вы можете убедиться, что устройство подключено к обновлению устройства для центра Интернета вещей, проверив, отображается ли оно в разделе "несгруппированные" устройства в представлении "соответствие". Временно добавьте тег с другим значением, а затем снова добавьте нужный тег после подключения устройства._

_Если вы используете службу подготовки устройств (DPS), убедитесь, что вы размечеем Теги устройств после их подготовки, а не в процессе создания устройства. Если вы уже добавили маркировку устройства на этапе создания устройства, вам потребуется временно пометить устройство, указав другое значение после его подготовки, а затем снова добавить предполагаемый тег._

### <a name="q-my-deployment-completed-successfully-but-some-devices-failed-to-update"></a>Вопрос. Развертывание завершено успешно, но некоторые устройства не удалось обновить.
_Это может быть вызвано ошибкой на стороне клиента на неисправных устройствах. См. раздел "сбои устройств" в этом руководство по устранению неполадок._

### <a name="q-i-encountered-an-error-in-the-ux-when-trying-to-initiate-a-deployment"></a>Вопрос. при попытке запустить развертывание возникла ошибка в UX.
_Это может быть вызвано ошибкой службы или UX либо проблемой с разрешениями API. Следуйте инструкциям в разделе " [обращение служба поддержки Майкрософт](#contact) ", чтобы отправить запрос в службу поддержки корпорации Майкрософт._

### <a name="q-i-started-a-deployment-but-it-isnt-reaching-an-end-state"></a>Вопрос. я запустил развертывание, но не приближается к конечному состоянию.
_Это могло быть вызвано проблемой с производительностью службы, ошибкой службы или ошибкой клиента. Повторите попытку развертывания через 10 минут. Если возникла та же проблема, извлеките журналы устройств и ознакомьтесь с разделом "сбои устройств" в этом руководстве по устранению неполадок. Если проблема повторяется, следуйте инструкциям в разделе " [обращение служба поддержки Майкрософт](#contact) ", чтобы отправить запрос в службу поддержки корпорации Майкрософт._

## <a name="downloading-updates-onto-devices"></a><a name="download"></a> Загрузка обновлений на устройства

### <a name="q-how-do-i-resume-a-download-when-a-device-has-reconnected-after-a-period-of-disconnection"></a>Вопрос. Разделы справки возобновить загрузку после повторного подключения устройства по истечении определенного периода отсоединения?
_Загрузка будет возобновлена при восстановлении подключения в течение 24-часового периода. Через 24 часа загрузка должна быть инициирована пользователем._
## <a name="using-microsoft-connected-cache-mcc"></a><a name="mcc"></a> Использование подключенного кэша Майкрософт (MCC)

### <a name="q-i-am-encountering-an-issue-when-attempting-to-deploy-the-mcc-module-on-my-iot-edge-device"></a>Вопрос. при попытке развернуть модуль MCC на устройстве IoT Edge возникла ошибка.
_Дополнительные сведения о развертывании модулей ребра для IoT Edge устройств см. в [документации по IOT Edge]() . Чтобы проверить, успешно ли работает модуль MCC на устройстве IoT Edge, перейдите по адресу http://localhost:5100/Summary ._
### <a name="q-one-of-my-iot-devices-is-attempting-to-download-an-update-through-mcc-but-is-failing"></a>Вопрос. одно из моих устройств Интернета вещей пытается скачать обновление через MCC, но оно завершается сбоем.
_Существует несколько проблем, которые могут привести к сбою устройства Интернета вещей при подключении к MCC. Чтобы диагностировать проблему, собирайте журналы DO Client и nginx с неисправного устройства (инструкции по сбору журналов клиентов см. в разделе о [контактных данных служба поддержки Майкрософт](#contact) .)_

_Возможно, устройству не удастся извлечь содержимое из Интернета для передачи в свой модуль MCC, так как URL-адрес, который он использует, не разрешен. Чтобы определить это, необходимо проверить переменные среды IoT Edge в портал Azure._
## <a name="contacting-microsoft-support"></a><a name="contact"></a> Обращение служба поддержки Майкрософт

Если возникли проблемы, которые не удается устранить с помощью указанных выше вопросов, можно отправить запрос в службу поддержки с помощью служба поддержки Майкрософт через интерфейс портал Azure. В зависимости от категории, к которой относится ваша неполадка, вам может быть предложено собрать и поделиться дополнительными данными, чтобы помочь служба поддержки Майкрософт исследовать проблему. 

Инструкции по сбору каждого типа данных см. ниже. Для проверки дополнительных сведений в ответе полезных данных API [можно использовать функции]() GetResponse.

Кроме того, следующие сведения могут оказаться полезными для сокращения основной причины проблемы:
* Тип устройства, которое вы пытаетесь обновить (Azure Перцепт, шлюз IoT Edge, другой)
* Какой тип клиента обновления устройства вы используете (на основе образа, на основе пакета, симулятор)
* Какая ОС работает на устройстве
* Сведения об архитектуре устройства
* Было ли успешно использовано обновление устройства для обновления устройства до

Если у вас есть доступная выше информация, добавьте ее в описание проблемы.

### <a name="collecting-client-logs"></a>Сбор журналов клиента

* На устройстве Raspberry Pi можно найти два набора журналов:

    ```markdown
    /adu/logs
    ```

    ```markdown
    /var/cache/do-client-lite/log
    ```

* Для упакованного клиента журналы находятся здесь:

    ```markdown
    /var/log/adu
    ```

    ```markdown
    /var/cache/do-client-lite/log
    ```

* Для симулятора журналы находятся здесь:

    ```markdown
    /tmp/aduc-logs
    ```

### <a name="error-codes"></a>Коды ошибок
При сообщении о проблемах, связанных с импортом обновления, сбоем устройства или развертыванием обновления, может быть предложено указать коды ошибок.

Коды ошибок можно получить, просмотрев интерфейс [адукореинтерфаце](./device-update-plug-and-play.md) . Сведения о том, как анализировать коды ошибок для самостоятельной диагностики и устранения неполадок, см. в документации по [кодам ошибок обновления устройств](./device-update-error-codes.md) .

### <a name="trace-id"></a>Идентификатор трассировки
При сообщении о проблемах, связанных с импортом или развертыванием обновления, может быть предложено указать идентификатор трассировки.

Идентификатор трассировки для данного действия пользователя можно найти в ответе API или в разделе Журнал импорта пользовательского интерфейса портал Azure. 

В настоящее время идентификаторы трассировки для действий развертывания доступны только через ответ API.

### <a name="deployment-id"></a>Идентификатор развертывания
При сообщении о проблемах, связанных с развертыванием обновления, может быть предложено указать идентификатор развертывания.

ИДЕНТИФИКАТОР развертывания создается пользователем при вызове API для инициации развертывания.

В настоящее время идентификаторы развертывания для развертываний, инициированные из пользовательского интерфейса портал Azure, создаются автоматически и не отображаются для пользователя.

### <a name="iot-hub-instance-name"></a>Имя экземпляра центра Интернета вещей
Вам может быть предложено указать имя экземпляра центра Интернета вещей при сообщении о проблемах, связанных с ошибками устройств, или развертывании обновления.

Имя центра Интернета вещей выбирается пользователем при первой подготовке.

### <a name="device-update-account-name"></a>Имя учетной записи обновления устройства
Вам может быть предложено указать имя учетной записи обновления устройства при сообщении о проблемах, связанных с импортом обновления, ошибками устройств или развертыванием обновления.

Имя учетной записи обновления устройства выбирается пользователем при первой регистрации в службе. Дополнительные сведения можно найти в документации по [ресурсам по обновлению устройств](./device-update-resources.md) .

### <a name="device-update-instance-name"></a>Имя экземпляра обновления устройства
Вам может быть предложено указать имя экземпляра обновления устройства при сообщении о проблемах, связанных с импортом обновления, ошибками устройств или развертыванием обновления.

Имя экземпляра обновления устройства выбирается пользователем при первой подготовке. Дополнительные сведения можно найти в документации по [ресурсам по обновлению устройств](./device-update-resources.md) .

### <a name="device-id"></a>Идентификатор устройства
Вам может быть предложено указать идентификатор устройства при сообщении о проблемах, связанных с ошибками устройств, или развертывании обновления.

ИДЕНТИФИКАТОР устройства определяется клиентом при первой подготовке устройства. Его также можно получить из Двойникаа устройства устройства.

### <a name="update-id"></a>ИДЕНТИФИКАТОР обновления
При сообщении о проблемах, связанных с развертыванием обновления, может быть предложено указать идентификатор обновления.

ИДЕНТИФИКАТОР обновления определяется клиентом при запуске развертывания.

### <a name="nginx-logs"></a>Журналы Nginx
Возможно, вам будет предложено предоставить журналы Nginx при сообщении о проблемах, связанных с подключенным кэшем Майкрософт.

### <a name="adu-conftxt"></a>ADU-conf.txt
Возможно, вам будет предложено указать файл конфигурации обновления устройства ("adu-conf.txt") при сообщении о проблемах, связанных с развертыванием обновления.

Файл конфигурации является необязательным и создается пользователем, следуя инструкциям в документации по [конфигурации обновления устройства](./device-update-configuration-file.md) .

### <a name="import-manifest"></a>Импорт манифеста
При сообщении о проблемах, связанных с импортом или развертыванием обновления, может быть предложено предоставить файл манифеста импорта.

Манифест импорта — это файл, созданный клиентом при импорте содержимого обновления в службу обновления устройства.

**[Следующий шаг: Дополнительные сведения о кодах ошибок обновления устройств](.\device-update-error-codes.md)**