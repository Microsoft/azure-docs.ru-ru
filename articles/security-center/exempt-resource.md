---
title: Исключение рекомендации центра безопасности Azure из ресурса, подписки, группы управления и оценки безопасности
description: Узнайте, как создавать правила для исключения рекомендаций по безопасности из подписок или групп управления и предотвращать их влияние на вашу оценку безопасности.
author: memildin
ms.author: memildin
ms.date: 01/22/2021
ms.topic: how-to
ms.service: security-center
manager: rkarlin
ms.openlocfilehash: 4012c7417345678717800f4fdede95947e00b828
ms.sourcegitcommit: 5cdd0b378d6377b98af71ec8e886098a504f7c33
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2021
ms.locfileid: "98756722"
---
# <a name="exempting-resources-and-recommendations-from-your-secure-score"></a>Исключение ресурсов и рекомендаций из оценки безопасности 

Основной приоритет каждой группы безопасности заключается в том, чтобы аналитики могли сосредоточиться на задачах и инцидентах, которые важны для Организации. Центр безопасности имеет множество функций для настройки интерфейса и обеспечения гарантии того, что ваш рейтинг отражает приоритеты безопасности вашей организации. Вариант **исключения** — одна из этих функций.

При исследовании рекомендаций по безопасности в центре безопасности Azure одним из первых видов информации является список затронутых ресурсов.

Иногда ресурс будет указан в списке, который не должен включаться в список. Или рекомендации будут отображаться в области, в которой она не принадлежит. Возможно, ресурс был исправлен процессом, не отслеживающимся центром безопасности. Рекомендации могут быть недопустимыми для конкретной подписки. Или, возможно, ваша организация просто решила принять риски, связанные с конкретным ресурсом или рекомендацией.

В таких случаях можно создать исключение для рекомендации, чтобы:

- **Исключите ресурс** , чтобы он не был перечислен с неработоспособными ресурсами в будущем и не повлияет на вашу оценку безопасности. Ресурс будет указан как неприменимо и причина будет отображаться как "исключено" с выбранным обоснованием.

- **Исключите подписку или группу управления** , чтобы убедиться, что рекомендации не влияют на вашу оценку безопасности и не будут отображаться для подписки или группы управления в будущем. Это связано с существующими ресурсами и всеми, которые вы создадите в будущем. Рекомендации будут отмечены конкретным обоснованием, выбранным для выбранной области.

## <a name="availability"></a>Доступность

|Аспект|Сведения|
|----|:----|
|Состояние выпуска:|Предварительный просмотр<br>[!INCLUDE [Legalese](../../includes/security-center-preview-legal-text.md)] |
|Цены|Это функция политики Azure уровня "Премиум", предлагаемая для клиентов защитника Azure без дополнительных затрат. В будущем может взиматься плата за использование других пользователей.|
|Требуемые роли и разрешения|**Владелец подписки** или **участник политики** для создания исключения<br>Чтобы создать правило, необходимо иметь разрешения на изменение политик в политике Azure.<br>Дополнительные сведения см. в статье [разрешения RBAC в политике Azure](../governance/policy/overview.md#azure-rbac-permissions-in-azure-policy).|
|Облако.|![Да](./media/icons/yes-icon.png) Коммерческие облака<br>![Нет](./media/icons/no-icon.png) Национальные и независимые (US Gov, China Gov, другие правительственные облака)|
|||

## <a name="define-an-exemption"></a>Определение исключения

Чтобы настроить рекомендации по обеспечению безопасности для подписок, групп управления или ресурсов, можно создать правило исключения, чтобы:

- Пометьте определенную **рекомендацию** или как "устранение рисков" или "риск принято". Можно создать исключения рекомендаций для подписки, нескольких подписок или всей группы управления.
- Пометьте **один или несколько ресурсов** как "устранение рисков" или "риск принято" для конкретной рекомендации.

> [!TIP]
> Исключения можно также создавать с помощью API. Пример JSON и описание соответствующих структур см. в разделе [Структура исключения политики Azure](../governance/policy/concepts/exemption-structure.md).

Чтобы создать правило исключения, сделайте следующее:

1. Откройте страницу сведений о рекомендациях для конкретной рекомендации.

1. На панели инструментов в верхней части страницы выберите **исключение**.

    :::image type="content" source="media/exempt-resource/exempting-recommendation.png" alt-text="Создайте правило исключения для рекомендации, которая будет исключена из подписки или группы управления.":::

1. В области **исключение** :
    1. Выберите область для этого правила исключения:
        - Если выбрать группу управления, рекомендация будет исключена из всех подписок в этой группе.
        - Если вы создаете это правило, чтобы исключить один или несколько ресурсов из рекомендации, выберите "выбранные ресурсы" и выберите соответствующие объекты из списка.

    1. Введите имя для этого правила исключения.
    1. При необходимости задайте дату окончания срока действия.
    1. Выберите категорию исключения:
        - **Разрешено по третьим сторонам (с устранением рисков)** — если вы используете сторонние службы, не идентифицированные центром безопасности. 

            > [!NOTE]
            > Если вы исключите рекомендацию как устраненную, вы не задаете баллы на вашу оценку безопасности. Однако, поскольку точки не *удаляются* для неработоспособных ресурсов, результат заключается в том, что оценка будет увеличена.

        - **Риск принят (отказ)** — если вы решили принять риск, не снижающий эту рекомендацию
    1. При необходимости введите описание.
    1. Нажмите кнопку **создания**.

    :::image type="content" source="media/exempt-resource/defining-recommendation-exemption.png" alt-text="Действия по созданию правила исключения для исключения рекомендации из подписки или группы управления":::

    Если исключение вступает в силу (может потребоваться до 30 минут):
    - Рекомендации или ресурсы не влияют на вашу оценку безопасности.
    - Если Вы исключены определенные ресурсы, они будут перечислены на вкладке **неприменимо** на странице сведений об рекомендации.
    - Если вы исключите рекомендацию, она будет скрыта по умолчанию на странице рекомендаций центра безопасности. Это связано с тем, что параметры по умолчанию фильтра **состояния рекомендации** на этой странице позволяют исключить **неприменимые** рекомендации. То же самое справедливо и при исключении всех рекомендаций в элементе управления безопасностью.

        :::image type="content" source="media/exempt-resource/recommendations-filters-hiding-not-applicable.png" alt-text="Фильтры по умолчанию на странице рекомендаций центра безопасности Azure скрывают неприменимые рекомендации и элементы безопасности":::

    - На информационной панели в верхней части страницы сведений об рекомендации обновляется число исключенных ресурсов:
        
        :::image type="content" source="./media/exempt-resource/info-banner.png" alt-text="Число исключенных ресурсов":::

1. Чтобы проверить исключенные ресурсы, откройте вкладку **неприменимо** :

    :::image type="content" source="./media/exempt-resource/modifying-exemption.png" alt-text="Изменение исключения":::

    Причина каждого исключения включается в таблицу (1).

    Чтобы изменить или удалить исключение, выберите меню с многоточием (...), как показано (2).

1. Чтобы просмотреть все правила исключения в подписке, выберите **Просмотреть исключения** из информационной панели:

    > [!IMPORTANT]
    > Чтобы просмотреть конкретные исключения, относящиеся к одной рекомендации, отфильтруйте список в соответствии с соответствующей областью действия и именем рекомендации.

    :::image type="content" source="./media/exempt-resource/policy-page-exemption.png" alt-text="Страница исключения политики Azure":::

    > [!TIP]
    > Кроме того, [с помощью графа ресурсов Azure можно найти рекомендации с исключениями](#find-recommendations-with-exemptions-using-azure-resource-graph).

## <a name="monitor-exemptions-created-in-your-subscriptions"></a>Отслеживание исключений, созданных в подписках

Как упоминалось ранее на этой странице, правила исключения являются мощным средством, обеспечивающим детальный контроль над рекомендациями, влияющими на ресурсы в подписках и группах управления. 

Чтобы отследить, как пользователи работают с этой возможностью, мы создали шаблон Azure Resource Manager (ARM), который развертывает приложение логики сборник тренировочных заданий и все необходимые подключения API, чтобы уведомлять вас об исключении при создании исключения.

- Дополнительные сведения о сборник тренировочных заданий см. в этой записи в [блогах технического сообщества](https://techcommunity.microsoft.com/t5/azure-security-center/how-to-keep-track-of-resource-exemptions-in-azure-security/ba-p/1770580) .
- Шаблон ARM можно найти в [репозитории GitHub центра безопасности Azure](https://github.com/Azure/Azure-Security-Center/tree/master/Workflow%20automation/Notify-ResourceExemption) .
- Вы можете щелкнуть [здесь](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Security-Center%2Fmaster%2FWorkflow%2520automation%2FNotify-ResourceExemption%2Fazuredeploy.json) , чтобы развернуть все необходимые компоненты. 


## <a name="find-recommendations-with-exemptions-using-azure-resource-graph"></a>Поиск рекомендаций с исключениями с помощью графа ресурсов Azure

Граф ресурсов Azure (ARG) обеспечивает мгновенный доступ к сведениям о ресурсах в облачных средах с помощью надежных возможностей фильтрации, группировки и сортировки. Это быстрый и эффективный способ запросить сведения по подпискам Azure программно или с помощью портала Azure.

Чтобы просмотреть все рекомендации с правилами исключения:

1. Откройте **Обозреватель графов ресурсов Azure**.

    :::image type="content" source="./media/security-center-identity-access/opening-resource-graph-explorer.png" alt-text="Страница рекомендаций по запуску обозревателя графа ресурсов Azure * *" :::

1. Введите следующий запрос и выберите **выполнить запрос**.

    ```kusto
    securityresources
    | where type == "microsoft.security/assessments"
    // Get recommendations in useful format
    | project
    ['TenantID'] = tenantId,
    ['SubscriptionID'] = subscriptionId,
    ['AssessmentID'] = name,
    ['DisplayName'] = properties.displayName,
    ['ResourceType'] = tolower(split(properties.resourceDetails.Id,"/").[7]),
    ['ResourceName'] = tolower(split(properties.resourceDetails.Id,"/").[8]),
    ['ResourceGroup'] = resourceGroup,
    ['ContainsNestedRecom'] = tostring(properties.additionalData.subAssessmentsLink),
    ['StatusCode'] = properties.status.code,
    ['StatusDescription'] = properties.status.description,
    ['PolicyDefID'] = properties.metadata.policyDefinitionId,
    ['Description'] = properties.metadata.description,
    ['RecomType'] = properties.metadata.assessmentType,
    ['Remediation'] = properties.metadata.remediationDescription,
    ['Severity'] = properties.metadata.severity,
    ['Link'] = properties.links.azurePortal
    | where StatusDescription contains "Exempt"    
    ```


Дополнительные сведения см. на следующих страницах:
- [Узнайте больше об Azure Resource Graph.](../governance/resource-graph/index.yml)
- [Как создавать запросы с помощью обозревателя Azure Resource Graph](../governance/resource-graph/first-query-portal.md)
- [Язык запросов Kusto (KQL)](/azure/data-explorer/kusto/query/)





## <a name="exemption-rule-faq"></a>Правило исключения: вопросы и ответы

### <a name="what-happens-when-one-recommendation-is-in-multiple-policy-initiatives"></a>Что произойдет, если одна из рекомендаций находится в нескольких инициативах политики?

Иногда рекомендации по безопасности появляются в нескольких инициативах политики. Если у вас есть несколько экземпляров одной и той же рекомендации, назначенных одной и той же подписке, и вы создаете исключение для рекомендации, это повлияет на все инициативы, для которых у вас есть разрешение на изменение. 

Например, рекомендация * * * * является частью инициативы политики по умолчанию, назначенной всем подпискам Azure центром безопасности Azure. Кроме того, в XXXXX.

При попытке создать исключение для этой рекомендации вы увидите одно из двух следующих сообщений:

- Если у вас есть необходимые разрешения для изменения обеих инициатив, вы увидите следующее:

    *Эта рекомендация включена в несколько инициатив по политике: [имена инициатив, разделенные запятыми]. Исключения будут созданы для всех из них.*  

- Если у вас нет достаточных разрешений для обеих инициатив, вы увидите это сообщение:

    *У вас есть ограниченные разрешения на применение исключения ко всем инициативам политики, исключения будут создаваться только в инициативах с достаточными разрешениями.*


## <a name="next-steps"></a>Следующие шаги

В этой статье вы узнали, как исключить ресурс из рекомендации, чтобы он не влиял на оценку безопасности. Дополнительные сведения о безопасной оценке см. в следующих статьях:

- [Оценка безопасности в Центре безопасности Azure](secure-score-security-controls.md)