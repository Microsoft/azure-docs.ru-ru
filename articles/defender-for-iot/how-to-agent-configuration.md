---
title: Настройка агентов безопасности
description: Узнайте, как настроить защитник для агентов безопасности IoT для использования с защитником для службы безопасности IoT.
services: defender-for-iot
ms.service: defender-for-iot
documentationcenter: na
author: mlottner
manager: rkarlin
editor: ''
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/09/2020
ms.author: mlottner
ms.openlocfilehash: b59d9079b6d0fe0ab3fe61eacf43f3a99eb46686
ms.sourcegitcommit: 4bda786435578ec7d6d94c72ca8642ce47ac628a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2021
ms.locfileid: "103495782"
---
# <a name="tutorial-configure-security-agents"></a>Учебник. Настройка агентов безопасности

В этой статье рассказывается о защитнике для агентов безопасности IoT и о том, как их изменить и настроить.

> [!div class="checklist"]
> * Настройка агентов безопасности
> * Изменение поведения агента путем изменения свойств двойника
> * Обнаружение конфигурации по умолчанию

## <a name="agents"></a>Агенты

Защитник для агентов безопасности IoT соберет данные с устройств IoT и выполняет действия по обеспечению безопасности для устранения обнаруженных уязвимостей. Конфигурация агента безопасности может быть управляемой с помощью набора свойств двойникаа модуля, которые можно настроить. Как правило, вторичные обновления этих свойств происходят редко.

Защитник для объекта конфигурации двойника агента безопасности IoT — это объект формата JSON. Объект конфигурации — это набор управляемых свойств, которые можно определить для управления поведением агента.

Эти конфигурации помогают настроить агент для каждого необходимого сценария. Например, при настройке этих свойств можно автоматически исключать некоторые события или сохранять энергопотребление на минимальном уровне.

Для внесения изменений воспользуйтесь [схемой](https://aka.ms/iot-security-github-module-schema) настройки агента безопасности в защитнике IOT.

## <a name="configuration-objects"></a>Объекты конфигурации

Свойства, связанные с каждым защитником для агента безопасности IoT, находятся в объекте конфигурации агента в разделе требуемых свойств модуля **азуреиотсекурити** .

Чтобы изменить конфигурацию, создайте и измените этот объект в удостоверении двойника модуля **азуреиотсекурити** .

Если объект конфигурации агента не существует в двойника модуля **азуреиотсекурити** , все значения свойств агента безопасности устанавливаются в значение по умолчанию.

```json
"desired": {
  "ms_iotn:urn_azureiot_Security_SecurityAgentConfiguration": {
  }
}
```

## <a name="configuration-schema-and-validation"></a>Схема и проверка конфигурации

Обязательно проверьте конфигурацию агента в соответствии с этой [схемой](https://aka.ms/iot-security-github-module-schema). Агент не будет запущен, если объект конфигурации не соответствует схеме.

Если во время выполнения агента объект конфигурации изменяется на недействительную конфигурацию (конфигурация не соответствует схеме), агент игнорирует недопустимую конфигурацию и будет продолжать использовать текущую конфигурацию.

### <a name="configuration-validation"></a>Проверка конфигурации

Агент безопасности "защитник для Интернета вещей" сообщает о своей текущей конфигурации в разделе "сообщаемые свойства" удостоверения двойника модуля **азуреиотсекурити** .
Агент сообщает обо всех доступных свойствах, если свойство не было задано пользователем, агент сообщает о конфигурации по умолчанию.

Чтобы проверить конфигурацию, Сравните значения, заданные в нужном разделе, со значениями, переданными в разделе с отчетом.

В случае несоответствия между требуемыми и сообщаемыми свойствами агент не смог проанализировать конфигурацию.

Проверьте требуемые свойства для [схемы](https://aka.ms/iot-security-github-module-schema), исправьте ошибки и задайте нужные свойства еще раз.

> [!NOTE]
> Предупреждение об ошибке конфигурации будет вызвано агентом в случае, если агенту не удалось проанализировать нужную конфигурацию.
> Сравните сообщаемый и требуемый раздел, чтобы понять, применимо ли предупреждение.

## <a name="editing-a-property"></a>Изменение свойства

Все пользовательские свойства должны быть заданы внутри объекта конфигурации агента в модуле **азуреиотсекурити** модуля двойника.
Чтобы использовать значение свойства по умолчанию, удалите свойство из объекта конфигурации.

### <a name="setting-a-property"></a>Задание свойства

1. В центре Интернета вещей перейдите к устройству, которое вы хотите изменить, и выберите его.

1. Щелкните свое устройство, а затем в модуле **азуреиотсекурити** .

1. Щелкните **модуль удостоверение двойника**.

1. Измените свойства, которые вы хотите изменить, в защитнике IoT-Micro-Agent.

   Например, чтобы настроить события подключения с высоким приоритетом и получать события с высоким приоритетом каждые 7 минут, используйте следующую конфигурацию.

    ```json
    "desired": {
        "ms_iotn:urn_azureiot_Security_SecurityAgentConfiguration": {
            "highPriorityMessageFrequency": {
                "value": "PT7M"
            },
            "eventPriorityConnectionCreate": {
                "value": "High"
            }
        }
    }
    ```

1. Выберите команду **Сохранить**.

### <a name="using-a-default-value"></a>Использование значения по умолчанию

Чтобы использовать значение свойства по умолчанию, удалите свойство из объекта конфигурации.

## <a name="default-properties"></a>Свойства по умолчанию

Следующая таблица содержит управляемые свойства защитника для агентов безопасности IoT.

Значения по умолчанию доступны в соответствующей схеме в [GitHub](https\://aka.ms/iot-security-module-default).

| Имя| Состояние | Допустимые значения| Значения по умолчанию| Описание |
|----------|--------|--|-------|----|
|хигхприоритимессажефрекуенци|Обязательный: false |Допустимые значения: Duration в формате ISO 8601 |Значение по умолчанию: PT7M |Максимальный интервал времени до отправки сообщений с высоким приоритетом.|
|ловприоритимессажефрекуенци |Обязательный: false|Допустимые значения: Duration в формате ISO 8601 |Значение по умолчанию: PT5H |Максимальное время перед отправкой сообщений с низким приоритетом.|
|снапшотфрекуенци |Требовать: false|Допустимые значения: Duration в формате ISO 8601 |Значение по умолчанию PT13H |Интервал времени для создания моментальных снимков состояния устройства.|
|макслокалкачесизеинбитес |Обязательный: false |Допустимые значения: |Значение по умолчанию: 2560000, больше 8192 | Максимальный объем хранилища (в байтах), разрешенный для кэша сообщений агента. Максимальный объем пространства, разрешенного для хранения сообщений на устройстве перед отправкой сообщений.|
|максмессажесизеинбитес |Обязательный: false |Допустимые значения: положительное число, большее, чем 8192, меньше 262144. |Значение по умолчанию: 204800 |Максимально допустимый размер агента для облачного сообщения. Этот параметр определяет максимальный объем данных, отправляемых в каждое сообщение. |
|Евентприорити $ {EventName} |Обязательный: false |Допустимые значения: высокая, низкая, Выкл. |Значения по умолчанию: |Приоритет каждого события, создаваемого агентом |

### <a name="supported-security-events"></a>Поддерживаемые события безопасности

|Имя события.| PropertyName | Значение по умолчанию| Событие Snapshot| Состояние сведений  |
|----------|-|---------|----|----|
|Диагностическое событие|евентприоритидиагностик| Выкл.| Неверно| Диагностические события, связанные с агентом. Используйте это событие для подробного ведения журнала.|
|Ошибка конфигурации |евентприоритиконфигуратионеррор |Низкий |Неверно |Агенту не удалось проанализировать конфигурацию. Проверьте конфигурацию схемы.|
|Статистика удаленных событий |евентприоритидроппедевентсстатистикс |Низкий |Верно|Статистика событий, связанных с агентом. |
|Подключенное оборудование|евентприоритиконнектедхардваре |Низкий |Верно |Моментальный снимок всего оборудования, подключенного к устройству.|
|Ожидание передачи данных через порты|евентприоритилистенингпортс |Высокий |Верно |Моментальный снимок всех открытых портов прослушивания на устройстве.|
|Создание процесса |евентприоритипроцесскреате |Низкий |Неверно |Аудит создания процессов на устройстве.|
|Завершение процесса|евентприоритипроцесстерминате |Низкий |Неверно |Аудит завершения процесса на устройстве.|
|Сведения о системе |евентприоритисистеминформатион |Низкий |Верно |Моментальный снимок системных сведений (например, ОС или ЦП).|
|Локальные пользователи| евентприоритилокалусерс |Высокий |Верно|Моментальный снимок зарегистрированных локальных пользователей в системе. |
|Имя для входа|  евентприоритилогин |Высокий|Неверно|Аудит событий входа на устройство (локальные и удаленные имена входа).|
|Создание подключения |евентприоритиконнектионкреате|Низкий|Неверно|Выполняет аудит TCP-подключений, созданных на устройстве и с устройства. |
|Настройка брандмауэра| евентприоритифиреваллконфигуратион|Низкий|Верно|Моментальный снимок конфигурации брандмауэра устройства (правила брандмауэра). |
|Базовые показатели ОС| евентприоритйосбаселине| Низкий|Верно|Моментальный снимок базовой проверки ОС устройства.|
|

## <a name="next-steps"></a>Дальнейшие действия

- [Общие сведения о защитнике для Интернета вещей](concept-recommendations.md)
- [Изучение защитника для оповещений IoT](concept-security-alerts.md)
- [Доступ к необработанным данным безопасности](how-to-security-data-access.md)
