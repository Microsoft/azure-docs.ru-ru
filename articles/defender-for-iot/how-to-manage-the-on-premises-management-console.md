---
title: Управление локальной консолью управления
description: Сведения о локальных параметрах консоли управления, таких как резервное копирование и восстановление, определение имени узла и настройка прокси-сервера для датчиков.
author: shhazam-ms
manager: rkarlin
ms.author: shhazam
ms.date: 12/12/2020
ms.topic: article
ms.service: azure
ms.openlocfilehash: 34efef4a01b58cc26fd1567336184837a703ade2
ms.sourcegitcommit: 8be279f92d5c07a37adfe766dc40648c673d8aa8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/31/2020
ms.locfileid: "97841999"
---
# <a name="manage-the-on-premises-management-console"></a>Управление локальной консолью управления

В этой статье рассматриваются локальные параметры консоли управления, такие как резервное копирование и восстановление, Загрузка файла активации устройства комитетов, обновление сертификатов и настройка прокси-сервера для датчиков.

Локальную консоль управления можно подключить из портал Azure.

## <a name="upload-an-activation-file"></a>Отправка файла активации

При первом входе в систему загружается файл активации для локальной консоли управления. Этот файл содержит совокупные зафиксированные устройства, которые определяются во время процесса адаптации. Список включает датчики, связанные с несколькими подписками.

После начальной активации число отслеживаемых устройств может превышать количество зафиксированных устройств, определенных во время адаптации. Это событие может произойти, например, при подключении дополнительных датчиков к консоли управления. При обнаружении несоответствия между числом отслеживаемых устройств и количеством зафиксированных устройств в консоли управления появляется предупреждение. При возникновении этого события следует передать новый файл активации.

Чтобы отправить файл активации, выполните следующие действия.

1. Перейдите на страницу **цен** на Azure Defender для IOT.
1. Выберите **скачать файл активации для вкладки консоль управления** . Загружается файл активации.

   :::image type="content" source="media/how-to-manage-sensors-from-the-on-premises-management-console/cloud_download_opm_activation_file.png" alt-text="Скачайте файл активации.":::

1. В консоли управления выберите **Параметры системы** .
1. Выберите **Активация**.
1. Выберите **выбрать файл** и выберите сохраненный файл.

## <a name="manage-certificates"></a>Управление сертификатами

После установки локальной консоли управления создается локальный самозаверяющий сертификат, который используется для доступа к веб-приложению консоли управления. Когда пользователи с правами администратора впервые входят в консоль управления, им предлагается предоставить сертификат SSL/TLS. Дополнительные сведения о настройке в первый раз см. [в разделе Активация и Настройка локальной консоли управления](how-to-activate-and-set-up-your-on-premises-management-console.md).

Следующие разделы содержат сведения об обновлении сертификатов, работе с командами интерфейса командной строки, а также о поддерживаемых сертификатах и параметрах сертификатов.

### <a name="about-certificates"></a>Сведения о сертификатах

Защитник Azure для Интернета вещей использует сертификаты SSL и TLS в следующих целях:

- Выполните требования к сертификату и шифрованию, запрошенные вашей организацией, загружая сертификат, подписанный ЦС.

- Разрешить проверку между консолью управления и подключенными датчиками, а также между консолью управления и консолью управления высокого уровня доступности. Проверка проверяется по списку отзыва сертификатов и дате окончания срока действия сертификата. *В случае сбоя проверки связь между консолью управления и датчиком прерывается, и в консоли появляется ошибка проверки.* Этот параметр включен по умолчанию после установки.

Правила переадресации сторонних производителей не проверяются. Примерами являются сведения о предупреждениях, отправляемые в SYSLOG, Splunk или ServiceNow; и связи с Active Directory.

### <a name="update-certificates"></a>Обновление сертификатов

Пользователи с правами администратора локальной консоли управления могут обновлять сертификаты.

Чтобы обновить сертификат, выполните следующие действия.  

1. Выберите **Параметры системы**.
1. Выберите **сертификаты SSL/TLS**.
1. Удалите или измените сертификат и добавьте новый.
   
   - Добавьте имя сертификата.
   - Отправьте файл CRT и файл ключа и введите парольную фразу.
   - При необходимости отправьте файл PEM.

Чтобы изменить параметр проверки, выполните следующие действия.

1. Включите или выключите переключатель **включить проверку сертификата** .
1. Щелкните **Сохранить**.

Если параметр включен и проверка завершается неудачно, связь между консолью управления и датчиком прерывается и в консоли появляется ошибка проверки.

### <a name="certificate-support"></a>Поддержка сертификатов

Поддерживаются следующие сертификаты:

- Инфраструктура закрытых и корпоративных ключей (частная PKI) 
- Инфраструктура открытых ключей (общедоступная PKI) 
- Локально создано на устройстве (локально самозаверяющий) 

  > [!IMPORTANT]
  > Мы не рекомендуем использовать самозаверяющие сертификаты. Это подключение не является безопасным и должно использоваться только для тестовых сред. Владелец сертификата не может быть проверен, и безопасность системы не поддерживается. Самозаверяющие сертификаты никогда не следует использовать для рабочих сетей.  

Поддерживаются следующие параметры: 

**CRT сертификата**

- Основной файл сертификата для доменного имени
- Алгоритм подписи = SHA256RSA
- Хэш-алгоритм подписи = SHA256
- Действителен с = допустимая прошедшая Дата
- Действителен до = допустимая дата в будущем
- Открытый ключ = RSA 2048 бит (минимум) или 4096 бит
- Точка распространения списка отзыва сертификатов = URL-адрес в файл. CRL
- Subject CN = URL, может быть универсальным сертификатом; Например, www.contoso.com или \* . contoso.com
- Subject (C) аунтри = определено, например, US
- Подразделение субъекта (OU) = определено; Например, Contoso Labs
- Subject (O) рганизатион = определен; Например, Contoso Inc

**Файл ключа**

- Файл ключа, созданный при создании CSR
- RSA 2048 бит (минимум) или 4096 бит

**Цепочка сертификатов**

- Промежуточный файл сертификата (если таковой имеется), предоставленный центром сертификации.
- Сертификат ЦС, выдавший сертификат сервера, должен быть первым в файле, за которым следуют все остальные, вплоть до корня. 
- Цепочка может включать атрибуты контейнера.

**Кодов**

- Поддерживается один ключ.
- Настройка при импорте сертификата.

Сертификаты с другими параметрами могут работать, но корпорация Майкрософт не поддерживает их.

#### <a name="encryption-key-artifacts"></a>Артефакты ключа шифрования

**. pem: файл контейнера сертификата**

Это имя получено из Privacy Enhanced Mail (PEM), исторического метода для защиты электронной почты. Формат контейнера — это преобразование в Base64 ключей x509 ASN. 1.  

Этот файл определен в документах RFC 1421 по 1424: формат контейнера, который может включать только открытый сертификат (например, при установке Apache, файлы сертификатов ЦС и т. д. сертификаты SSL). Или может включать всю цепочку сертификатов, включая открытый ключ, закрытый ключ и корневые сертификаты.  

Он также может кодировать CSR, так как формат PKCS10 можно преобразовать в PEM.

**. CERT. cer. CRT: файл контейнера сертификата**

Это файл. PEM (или редко,. der) с другим расширением. Проводник Windows распознает его как сертификат. Проводник не распознает PEM – файл.

**. Key: файл закрытого ключа**

Файл ключа имеет тот же формат, что и PEM-файл, но имеет другое расширение. 

#### <a name="cli-commands"></a>Команды CLI

Используйте `cyberx-xsense-certificate-import` команду CLI для импорта сертификатов. Чтобы использовать это средство, необходимо отправить файлы сертификатов на устройство (с помощью таких средств, как WinSCP или wget).

Команда поддерживает следующие входные флаги:

- `-h`: Показывает синтаксис справки командной строки.

- `--crt`: Путь к файлу сертификата (расширение CRT).

- `--key`:  \* . key. Длина ключа должна быть не менее 2 048 бит.

- `--chain`: Путь к файлу цепочки сертификатов (необязательно).

- `--pass`: Парольная фраза, используемая для шифрования сертификата (необязательно).

- `--passphrase-set`: Default = `False` , не используется. Задайте для значение, `True` чтобы использовать предыдущую парольную фразу, указанную в предыдущем сертификате (необязательно).

При использовании команды CLI:

- Убедитесь, что файлы сертификатов доступны для чтения на устройстве.

- Убедитесь, что доменное имя и IP-адрес в сертификате соответствуют конфигурации, запланированной ИТ-отделом.

## <a name="define-backup-and-restore-settings"></a>Определение параметров резервного копирования и восстановления

Резервное копирование локальной системы консоли управления выполняется автоматически, ежедневно. Данные сохраняются на другом диске. Расположение по умолчанию: `/var/cyberx/backups`. 

Этот файл можно автоматически переместить во внутреннюю сеть. 

> [!NOTE]
> Процедуру резервного копирования и восстановления можно выполнять только в той же версии. 

Чтобы создать резервную копию локального компьютера консоли управления, выполните следующие действия. 

- Войдите в учетную запись администратора и введите `sudo cyberx-management-backup -full` .

Чтобы восстановить последнюю версию файла резервной копии, выполните следующие действия.

- Войдите в учетную запись администратора и введите `$ sudo cyberx-management-system-restore` .

Чтобы сохранить резервную копию на внешнем сервере SMB, выполните следующие действия.

1. Создайте общую папку на внешнем SMB-сервере.  

   Получите путь к папке, имя пользователя и пароль, необходимые для доступа к серверу SMB. 

2. В защитнике для IoT создайте каталог для резервных копий:

   - `sudo mkdir /<backup_folder_name_on_ server>` 

   - `sudo chmod 777 /<backup_folder_name_on_c_server>/` 

3. Изменить fstab:  

   - `sudo nano /etc/fstab` 

   - `add - //<server_IP>/<folder_path> /<backup_folder_name_on_server> cifs rw,credentials=/etc/samba/user,vers=3.0,uid=cyberx,gid=cyberx,file_mode=0777,dir_mode=0777 0 0` 

4. Измените или создайте учетные данные для общего сервера SMB: 

   - `sudo nano /etc/samba/user` 

5. Добавьте следующие пакеты: 

   - `username=<user name>`

   - `password=<password>` 

6. Подключите каталог: 

   - `sudo mount -a` 

7. Настройте каталог резервного копирования для общей папки в локальной консоли управления в защитнике IoT:  

   - `sudo nano /var/cyberx/properties/backup.properties` 

   - `set Backup.shared_location to <backup_folder_name_on_server>`

## <a name="edit-the-host-name"></a>Изменение имени узла

Чтобы изменить имя узла консоли управления, настроенное на DNS-сервере организации, выполните следующие действия.

1. В левой области консоли управления выберите **Параметры системы**.  

2. В разделе Сетевые подключения консоли выберите **сеть**. 

3. Введите имя узла, настроенное в DNS-сервере организации. 

4. Щелкните **Сохранить**.

## <a name="define-vlan-names"></a>Определение имен виртуальных ЛС

Имена виртуальных ЛС не синхронизируются между датчиком и консолью управления. Необходимо определить идентичные имена для компонентов.

В области Сетевые подключения выберите **VLAN** и добавьте имена в обнаруженные ИДЕНТИФИКАТОРЫ виртуальной ЛС. Затем нажмите кнопку **Save** (Сохранить).

## <a name="define-a-proxy-to-sensors"></a>Определение прокси-сервера для датчиков

Повышение безопасности системы за счет предотвращения входа пользователя непосредственно в датчик. Вместо этого используйте туннелирование прокси-сервера, чтобы разрешить пользователям доступ к датчику из локальной консоли управления с одним правилом брандмауэра. Это расширение ограничивает возможность несанкционированного доступа к сетевой среде за пределами датчика.

Используйте прокси-сервер в средах, где нет прямого подключения к датчикам.

:::image type="content" source="media/how-to-access-sensors-using-a-proxy/proxy-diagram.png" alt-text="Нажат.":::

Следующая процедура подключает датчик к локальной консоли управления и включает туннелирование на этой консоли:

1. Войдите в локальную консоль управления CLI с помощью учетных данных администратора.

2. Введите `sudo cyberx-management-tunnel-enable` и нажмите клавишу **Ввод**.

4. Введите `--port 10000` и нажмите клавишу **Ввод**.

## <a name="adjust-system-properties"></a>Настройка системных свойств

Системные свойства управляют различными операциями и параметрами в консоли управления. Изменение или изменение этих файлов может повредить работу консоли управления. Перед изменением параметров обратитесь к [Служба поддержки Майкрософт](https://support.microsoft.com) .

Для доступа к свойствам системы: 

1. Войдите в локальную консоль управления или датчик.

2. Выберите **Параметры системы**.

3. В разделе **Общие** выберите **Свойства системы** .

## <a name="change-the-name-of-the-on-premises-management-console"></a>Изменение имени локальной консоли управления

Вы можете изменить имя локальной консоли управления. Новые имена отображаются в веб-браузере консоли, в различных окнах консоли и в журналах устранения неполадок. Имя по умолчанию — **консоль управления**.

Чтобы изменить имя:

1. В нижней части левой области выберите текущее имя.

   :::image type="content" source="media/how-to-change-the-name-of-your-azure-consoles/console-name.png" alt-text="Снимок экрана локальной версии консоли управления.":::

2. В диалоговом окне " **изменение конфигурации консоли управления** " введите новое имя. Имя не может содержать более 25 символов.

   :::image type="content" source="media/how-to-change-the-name-of-your-azure-consoles/edit-management-console-configuration.png" alt-text="Снимок экрана: изменение конфигурации защитника для платформы IoT.":::

3. Щелкните **Сохранить**. Будет применено новое имя.

   :::image type="content" source="media/how-to-change-the-name-of-your-azure-consoles/name-changed.png" alt-text="Снимок экрана, на котором показано измененное имя консоли.":::

## <a name="password-recovery"></a>Восстановление пароля

Восстановление пароля для локальной консоли управления связано с подпиской, к которой подключено устройство. Невозможно восстановить пароль, если неизвестно, к какой подписке подключено устройство.

Чтобы сбросить пароль, выполните следующие действия.

1. Перейдите на страницу входа в локальную консоль управления.
1. Выберите **Восстановление пароля**.
1. Скопируйте уникальный идентификатор.
1. Перейдите на страницу "защитник для **сайтов и датчиков** Интернета вещей" и выберите вкладку **Восстановление пароля** .
1. Введите уникальный идентификатор и нажмите кнопку **восстановить**. Загружается файл активации.
1. Перейдите на страницу **восстановления пароля** и отправьте файл активации.
1. Выберите **Далее**.
 
   Теперь у вас есть имя пользователя и новый пароль, созданный системой.

> [!NOTE]
> Датчик связан с подпиской, к которой она была изначально подключена. Пароль можно восстановить только с помощью той же подписки, к которой он подключен.

## <a name="see-also"></a>См. также раздел

[Управление датчиками из консоли управления](how-to-manage-sensors-from-the-on-premises-management-console.md)

[Управление отдельными датчиками](how-to-manage-individual-sensors.md)
