---
title: Передача данных с помощью службы "Шлюз Azure Data Box" | Документация Майкрософт
description: Узнайте, как добавить общие папки в Шлюз Azure Data Box и подключиться к ним, чтобы обеспечить передачу данных с устройства Шлюза Data Box в Azure.
services: databox
author: alkohli
ms.service: databox
ms.subservice: gateway
ms.topic: tutorial
ms.date: 10/14/2020
ms.author: alkohli
ms.openlocfilehash: 0c0ef6157ebf70c896fbac5ff692246e4fad2c14
ms.sourcegitcommit: 2f9f306fa5224595fa5f8ec6af498a0df4de08a8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "98937201"
---
# <a name="tutorial-transfer-data-with-azure-data-box-gateway"></a>Руководство по передаче данных с помощью Шлюза Azure Data Box


## <a name="introduction"></a>Введение

В этой статье описывается, как добавить общие папки в Шлюз Data Box и подключиться к ним. После добавления общих папок устройство может выполнять передачу данных в Azure.

Эта процедура может занять около 10 минут.

В этом руководстве описано следующее:

> [!div class="checklist"]
>
> * Добавление общей папки
> * Подключение к общей папке.

## <a name="prerequisites"></a>Предварительные требования

Прежде чем добавлять общие папки в службу "Шлюз Data Box", убедитесь, что:

- Вы подготовили виртуальное устройство и подключились к нему, как подробно описано в статье [Руководство. Подготовка к работе Шлюза Azure Data Box в Hyper-V (предварительная версия)](data-box-gateway-deploy-provision-hyperv.md) или [Руководство по подготовке Шлюза Azure Data Box в VMware (предварительная версия)](data-box-gateway-deploy-provision-vmware.md).

- Вы активировали устройство, как описано в статье [Руководство. Подключение, настройка, активация шлюза Azure Data Box (предварительная версия)](data-box-gateway-deploy-connect-setup-activate.md).

- Устройство готово для создания общих ресурсов и передачи данных.

## <a name="add-a-share"></a>Добавление общей папки

Чтобы создать общие папки, выполните следующие действия.

1. На [портале Azure](https://portal.azure.com/) выберите ресурс Шлюза Data Box и перейдите в раздел **Обзор**. Устройство должно быть подключено к сети. На панели команд для устройства выберите **+ Добавление общего файлового ресурса**.
   
   ![Добавление общей папки](./media/data-box-gateway-deploy-add-shares/click-add-share.png)

4. В разделе **Добавление общего файлового ресурса** выполните следующие действия.

    1. Укажите уникальное имя для общей папки. Имена общих папок могут содержать только строчные буквы, цифры и дефисы. Имя общей папки может содержать от 3 до 63 знаков и начинаться с буквы или цифры. Перед каждым дефисом должен быть знак без дефиса.
    
    2. Выберите **тип** для общей папки. Вы можете выбрать тип SMB или NFS (тип SMB задан по умолчанию). SMB является стандартным для клиентов Windows, а NFS используется для клиентов Linux. В зависимости от того, выбраны ли общие папки типа SMB или NFS, предложенные варианты могут немного отличаться.

    3. Предоставьте учетную запись хранения, где будет размещена общая папка. В случает отсутствия контейнера он создается в учетной записи хранения с уже только что созданным именем общей папки. Если контейнер уже существует, то будет использоваться он.
       > [!IMPORTANT]
       > Убедитесь, что требуемая учетная запись хранения Azure не имеет определенных политик неизменяемости, если она используется с устройством Шлюза Data Box. См. сведения об [определении и администрировании политик неизменяемости для хранилища BLOB-объектов](../storage/blobs/storage-blob-immutability-policies-manage.md).
    
    4. В блочном BLOB-объекте, страничном BLOB-объекте или файлах выберите **Служба хранилища**. Тип выбранной службы зависит от того, в каком формате необходимо хранить данные в Azure. Например, в данном экземпляре необходимо, чтобы данные хранились как блочные BLOB-объекты в Azure, поэтому мы выбираем блочный BLOB-объект. При выборе страничного BLOB-объекта необходимо убедиться, что данные выровнены по размеру 512 байт. Например, VHDX всегда выравнивается по размеру 512 байт.
   
    5. Этот шаг зависит от того, создается ли общая папка типа SMB или NFS.
     
    - **Общая папка SMB**. В разделе **Все привилегированные локальные пользователи** выберите **Создать** или **Использовать существующий**. При создании локального пользователя введите **имя пользователя** и **пароль**, а затем **подтвердите пароль**. Таким образом вы предоставите разрешения локальному пользователю. Изменение разрешений на уровне общего ресурса сейчас не поддерживается.
    
        ![Добавление общей папки SMB](./media/data-box-gateway-deploy-add-shares/add-share-smb-1.png)
        
        Если установить флажок **Разрешить только операции чтения** для данных этой общей папки, вы можете указывать пользователей с правами только для чтения.
        
    - **Общая папка NFS**. Введите IP-адреса клиентов, которым разрешен доступ к общей папке.

        ![Добавление общей папки типа NFS](./media/data-box-gateway-deploy-add-shares/add-share-nfs-1.png)
   
9. Щелкните **Создать**, чтобы создать общую папку.
    
    Вы получите уведомление о том, что общая папка создается. После создания общей папки с указанными параметрами плитка **Общие папки** обновится и в ней появится новая общая папка.
    
    ![Обновленная плитка общих папок](./media/data-box-gateway-deploy-add-shares/updated-list-of-shares.png) 

## <a name="connect-to-the-share"></a>Подключение к общей папке

Теперь можно подключиться к общим папкам, созданным на предыдущем шаге. В зависимости от выбранного типа общей папки (SMB или NFS) шаги могут отличаться.

### <a name="connect-to-an-smb-share"></a>Подключение к общей папке типа SMB

В клиенте Windows Server, подключенном к Шлюзу Data Box, подключитесь к общей папке SMB, введя следующие команды:


1. В командной строке введите следующую команду:

    `net use \\<IP address of the device>\<share name>  /u:<user name for the share>`

    При отображении соответствующего запроса введите пароль для общей папки. Здесь приведен пример выходных данных этой команды.

    ```powershell
    Microsoft Windows [Version 18.8.16299.192) 
    (c) 2017 microsoft Corporation. All rights reserved . 
    
    C: \Users\GatewayUser>net use \\10.10.10.60\newtestuser /u:Tota11yNewUser 
    Enter the password for 'TotallyNewUser' to connect to '10.10.10.60'  
    The command completed successfully. 
    
    C: \Users\GatewayUser>
    ```   


2. На клавиатуре одновременно нажмите клавиши Windows+R. 
3. В окне **выполнения** введите `\\<device IP address>`, а затем выберите **ОК**. Откроется проводник, и вы увидите общие папки. В проводнике для просмотра содержимого дважды щелкните общую папку.
 
    ![Подключение к общей папке типа SMB](./media/data-box-gateway-deploy-add-shares/connect-to-share2.png)-->

    Данные записываются в эти общие папки по мере их создания, а устройство отправляет эти данные в облако.

### <a name="connect-to-an-nfs-share"></a>Подключение к общей папке типа NFS

Выполните следующие действия на клиентском компьютере Linux, подключенном к устройству:

1. Убедитесь, что на этом клиенте установлен клиент NFSv4. Используйте следующую команду для установки NFS-клиента:

   `sudo apt-get install nfs-common`

    Дополнительные сведения см. в разделе об [установке клиента NFSv4](https://help.ubuntu.com/community/SettingUpNFSHowTo#NFSv4_client).

2. После установки NFS-клиента используйте следующую команду, чтобы подключить общую папку типа NFS, созданную на устройстве Шлюза Data Box:

   `sudo mount -t nfs -o sec=sys,resvport <device IP>:/<NFS shares on device> /home/username/<Folder on local Linux computer>`

    Прежде чем настроить подключение, убедитесь, что каталоги, которые будут выступать в качестве точки подключения на локальном компьютере, уже созданы и не содержат файлов и вложенных папок.

    В следующем примере показано, как выполнить подключение к папке на устройстве шлюза через NFS. IP-адрес виртуального устройства — `10.10.10.60`, общая папка `mylinuxshare2` подключена на виртуальной машине под управлением Ubuntu, точка подключения — `/home/databoxubuntuhost/gateway`.

    `sudo mount -t nfs -o sec=sys,resvport 10.10.10.60:/mylinuxshare2 /home/databoxubuntuhost/gateway`

> [!NOTE] 
> В этом выпуске следует учитывать такие нюансы:
> - После создания файла в общих папках его невозможно переименовать.
> - Удаление файла из общей папки не приводит к удалению записи в учетной записи хранения.
> - При использовании `rsync` для копирования данных параметр `rsync -a` не поддерживается.

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве раскрыты следующие сведения о Шлюзе Data Box:

> [!div class="checklist"]
> * Добавление общей папки
> * Подключение к общей папке.


Перейдите к следующему руководству, чтобы узнать, как администрировать службу "Шлюз Data Box".

> [!div class="nextstepaction"]
> [Microsoft Azure Data Box Gateway Management Guide](https://aka.ms/dbg-docs) (Руководство по управлению Шлюзом Microsoft Azure Data Box)