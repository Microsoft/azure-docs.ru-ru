---
title: Конвейер CI/CD с Azure DevOps Starter-Azure IoT Edge | Документация Майкрософт
description: Служба Azure DevOps Starter позволяет быстро приступить к работе с Azure. В этой статье вы узнаете, как запустить необходимое приложение Azure IoT Edge за несколько быстрых шагов.
author: kgremban
ms.author: kgremban
ms.date: 08/25/2020
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: 8a23041a714089c447ab35ee05aae0de0c9c33d2
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "103201159"
---
# <a name="create-a-cicd-pipeline-for-iot-edge-with-azure-devops-starter"></a>Создание конвейера CI/CD для IoT Edge с помощью Azure DevOps Starter

[!INCLUDE [iot-edge-version-all-supported](../../includes/iot-edge-version-all-supported.md)]

Настройте непрерывную интеграцию (CI) и непрерывную доставку (CD) для приложения IoT Edge с помощью DevOps Projects. DevOps Starter упрощает начальную настройку конвейера сборки и выпуска в Azure Pipelines.

Если у вас нет активной подписки Azure, перед началом работы создайте [бесплатную учетную запись](https://azure.microsoft.com/free).

## <a name="sign-in-to-the-azure-portal"></a>Вход на портал Azure

DevOps Starter позволяет создать конвейер CI/CD в Azure DevOps. Вы можете создать новую организацию Azure DevOps или использовать существующую. DevOps Starter также создает ресурсы Azure в требуемой подписке Azure.

1. Войдите на [портал Microsoft Azure](https://portal.azure.com).

1. В левой области выберите **создать ресурс**, а затем выполните поиск по запросу **DevOps Starter**.  

1. Нажмите кнопку **создания**.

1. По умолчанию DevOps Starter настроен с GitHub. Чтобы использовать функции из этого руководства, переключитесь на DevOps Starter для настройки с помощью Azure DevOps. Перейдите по ссылке **изменить параметры** .

   ![Выберите Изменить параметры здесь, чтобы переключиться с GitHub на Azure DevOps.](./media/how-to-devops-starter/create-with-github-change-settings.png)

1. На правой панели выберите плитку **Azure DevOps** и нажмите кнопку **Готово**.

   ![Выберите Azure DevOps для настройки DevOps Starter](./media/how-to-devops-starter/select-azure-devops.png)

   Теперь вы увидите, что DevOps Starter настраивается с помощью Azure DevOps.

## <a name="create-a-new-application-pipeline"></a>Конвейер создания приложения

1. Модули Azure IoT Edge могут быть написаны на языках [C#](tutorial-csharp-module.md), [Node.js](tutorial-node-module.md), [Python](tutorial-python-module.md), [C](tutorial-c-module.md) и [Java](tutorial-java-module.md). Выберите необходимый язык для запуска нового приложения: **.NET**, **Node.js**, **Python**, **C** или **Java**. Нажмите кнопку **Далее**, чтобы продолжить.

   ![Выбор языка для создания приложения](./media/how-to-devops-starter/select-language.png)

2. Выберите **Простой Интернет вещей** как исполняющую среду, а затем щелкните **Далее**.

   ![Выбор платформы "Простой Интернет вещей"](media/how-to-devops-starter/select-iot.png)

3. Выберите **IoT Edge** как службу Azure, которая развертывает приложение, а затем щелкните **Далее**.

   ![Выбор службы IoT Edge](media/how-to-devops-starter/select-iot-edge.png)

4. Создайте новую бесплатную организацию Azure DevOps или выберите существующую.

   1. Задайте имя проекта.

   2. Выберите свою организацию Azure DevOps. Если у вас нет существующей организации, выберите **Дополнительные параметры**, чтобы создать организацию.

   3. Выберите подписку Azure.

   4. Используйте имя Центра Интернета вещей, созданное на основе имени проекта, или укажите собственное.

   5. Примите расположение по умолчанию или выберите близкое к вам расположение.

   6. Выберите **Дополнительные параметры** , чтобы настроить ресурсы Azure, которые DevOps Starter создает от вашего имени.

   7. Нажмите кнопку **Готово** для завершения создания проекта.

   ![Имя и создание проекта](media/how-to-devops-starter/create-project.png)

Через несколько минут панель мониторинга DevOps Starter отобразится на портале Azure. Выберите имя проекта, чтобы просмотреть ход выполнения. Вам может потребоваться обновить страницу. Пример приложения IoT Edge настраивается в репозитории в организации Azure DevOps, после чего выполняется его сборка и оно развертывается на устройство IoT Edge. Эта панель мониторинга позволяет просматривать репозиторий кода, конвейер CI/CD и приложение в Azure.

   ![Просмотр проекта в портал Azure](./media/how-to-devops-starter/portal.png)

## <a name="commit-code-changes-and-execute-cicd"></a>Фиксация изменений, внесенных в код, и выполнение CI/CD

DevOps Starter создала репозиторий Git для проекта в Azure Repos. В этом разделе вы просмотрите репозиторий и внесете изменения в код приложения.

1. Чтобы перейти в репозиторий, созданный для проекта, выберите **Репозитории** в меню панели мониторинга проекта. Эта ссылка открывает вкладку браузера и репозиторий Azure DevOps для нового проекта.

   ![Просмотр репозитория, созданного в Azure Repos](./media/how-to-devops-starter/view-repositories.png)

   > [!NOTE]
   > Ниже приведены инструкции по внесению изменений в код с использованием веб-браузера. Если вы хотите клонировать репозиторий локально, выберите **Клонировать** в верхней правой части окна. Клонируйте репозиторий Git в Visual Studio Code или в другом предпочитаемом инструменте разработки, используя предоставленный URL-адрес.

2. Репозиторий уже содержит код для модуля **FilterModule**, основанного на языке приложения, выбранного в процессе создания. Откройте файл **modules/FilterModule/module.json**.

   ![Открытие файла module.json в Azure Repos](./media/how-to-devops-starter/open-module-json.png)

3. Обратите внимание, что этот файл использует [переменные сборки Azure DevOps](/azure/devops/pipelines/build/variables#build-variables) в параметре **версия**. Эта конфигурация гарантирует, что новая версия модуля будет создаваться каждый раз при выполнении новой сборки.

## <a name="examine-the-cicd-pipeline"></a>Изучение конвейера CI/CD

В предыдущих разделах Azure DevOps Starter автоматически настроила полный конвейер CI/CD для приложения IoT Edge. Теперь изучите и настройте конвейер нужным образом. Выполните следующие действия, чтобы ознакомиться с конвейерами сборки и выпуска Azure DevOps.

1. Чтобы просмотреть конвейеры сборки в проекте DevOps, выберите **Конвейеры сборки** в меню на панели мониторинга проекта. По ссылке откроется вкладка браузера, содержащая сведения о конвейере сборки Azure DevOps для нового проекта.

   ![Просмотр конвейеров сборки в Azure Pipelines](./media/how-to-devops-starter/view-build-pipelines.png)

2. Откройте автоматически созданный конвейер сборки и выберите **изменить** в правом верхнем углу.

    ![Изменение конвейера сборки](media/how-to-devops-starter/click-edit-button.png)

3. На открывшейся панели можно просмотреть задачи, возникающие во время выполнения конвейера сборки. Конвейеры сборки выполняют различные задачи, такие как получение источников из репозитория Git, сборка образов модуля IoT Edge, отправка модулей IoT Edge в реестр контейнеров и публикация полученных файлов, используемых для развертывания. Дополнительные сведения о задачах Azure IoT Edge в Azure DevOps см. в статье [Непрерывная интеграция и непрерывное развертывание в Azure IoT Edge](how-to-continuous-integration-continuous-deployment-classic.md#create-a-build-pipeline-for-continuous-integration).

4. Выберите заголовок **Конвейер** в верхней части конвейера сборки, чтобы открыть сведения о конвейере. Замените имя конвейера сборки более описательным.

   ![Изменение сведений о конвейере](./media/how-to-devops-starter/edit-build-pipeline.png)

5. Выберите **Сохранить и поместить в очередь**, а затем щелкните **Сохранить**. Комментарий необязателен для комментария.

6. Выберите **Триггеры** в меню конвейера сборки. DevOps Starter автоматически создает триггер CI, а при каждой фиксации в репозитории запускается новая сборка.  При желании выберите включение или исключение ветвей из процесса непрерывной интеграции.

7. Щелкните **Период удержания**. Перейдите по ссылке, чтобы перенаправить вас на параметры проекта, в которых находятся политики хранения. В зависимости от сценария можно указать политики для хранения или удаления определенного количества сборок.

8. Выберите **Журнал**. Панель журнала содержит журнал аудита последних изменений сборки. Azure Pipelines отслеживает все изменения, внесенные в конвейер сборки, и позволяет сравнивать версии.

9. Завершив изучение конвейера сборки, перейдите к соответствующему конвейеру выпуска. Выберите **Выпуски** в разделе **Конвейеры**, а затем выберите **Изменить**, чтобы просмотреть сведения о конвейере.

    ![Просмотр конвейера выпуска](media/how-to-devops-starter/release-pipeline.png)

10. В разделе **Артефакты** выберите **Удалить**. Источник, просматриваемый этим артефактом, представляет собой выходные данные конвейера сборки, который вы изучали на предыдущих этапах.

11. Рядом со значком **Удалить** выберите элемент **Триггер непрерывного развертывания**, который выглядит как молния. В этом конвейере выпуска активирован триггер, выполняющий развертывание каждый раз, когда становится доступным новый артефакт сборки. При желании можно отключить триггер, чтобы выполнить развертывание вручную.  

12. В меню для конвейера выпуска выберите **Задачи**, а затем выберите этап **dev** в раскрывающемся списке. В DevOps Projects создается этап выпуска, который создает центр Интернета вещей, создает устройство IoT Edge в этом центре, развертывает пример модуля из конвейера сборки и подготавливает виртуальную машину для запуска в качестве устройства IoT Edge. Чтобы узнать больше о задачах Azure IoT Edge для непрерывного развертывания, ознакомьтесь с [этим разделом](how-to-continuous-integration-continuous-deployment-classic.md#create-a-release-pipeline-for-continuous-deployment).

    ![Просмотр задач непрерывного развертывания](media/how-to-devops-starter/choose-release.png)

13. В области справа выберите **Просмотреть выпуски**. В этом представлении можно просмотреть журнал выпусков.

14. Выберите имя выпуска, чтобы просмотреть дополнительные сведения о нем.

## <a name="clean-up-resources"></a>Очистка ресурсов

Ненужную Службу приложений Azure и связанные ресурсы можно удалить. Воспользуйтесь функцией **Удалить** на панели мониторинга DevOps Starter.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о задачах Azure IoT Edge в Azure DevOps см. в статье [Непрерывная интеграция и непрерывное развертывание в Azure IoT Edge](how-to-continuous-integration-continuous-deployment.md).
* Основные сведения о развертывании IoT Edge см. в статье [Understand IoT Edge deployments for single devices or at scale](module-deployment-monitoring.md) (Основные сведения о развертываниях IoT Edge для отдельных устройств или в требуемом масштабе).
* Ознакомьтесь со статьей [Развертывание и мониторинг модулей IoT Edge в нужном масштабе (предварительная версия)](how-to-deploy-at-scale.md), чтобы узнать, как создавать, обновлять или удалять развертывание.
