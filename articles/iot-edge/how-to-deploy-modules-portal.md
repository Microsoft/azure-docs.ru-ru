---
title: Развертывание модулей из портал Azure Azure IoT Edge
description: Используйте центр Интернета вещей в портал Azure, чтобы отправить модуль IoT Edge из центра Интернета вещей на устройство IoT Edge, настроенное манифестом развертывания.
author: kgremban
manager: philmea
ms.author: kgremban
ms.date: 10/13/2020
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: 9248c9578d94b000c04c82b33eeeb089e55a26ef
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "103200315"
---
# <a name="deploy-azure-iot-edge-modules-from-the-azure-portal"></a>Развертывание модулей IoT Edge Azure с помощью портала Azure

[!INCLUDE [iot-edge-version-all-supported](../../includes/iot-edge-version-all-supported.md)]

Создав модули IoT Edge с в соответствии с определенной бизнес-логикой, вы наверняка захотите развернуть их на устройствах, которые будут работать в граничной среде. Если у вас есть несколько модулей, которые работают вместе для сбора и обработки данных, вы можете развернуть их одновременно и объявить правила маршрутизации, которые их соединяют.

В этой статье описано, как с помощью портала Azure создать манифест развертывания и отправить это развертывание на устройство IoT Edge. Сведения о создании развертывания, предназначенного для нескольких устройств на основе их общих тегов, см. [в статье Развертывание и мониторинг модулей IOT EDGE в масштабе](how-to-deploy-at-scale.md).

## <a name="prerequisites"></a>Предварительные требования

* [Центр Интернета вещей](../iot-hub/iot-hub-create-through-portal.md) в подписке Azure.
* Устройство IoT Edge.

  Если устройство IoT Edge не настроено, вы можете создать его на виртуальной машине Azure. Выполните действия, описанные в одной из кратких руководств, чтобы [создать виртуальное устройство Linux](quickstart-linux.md) или [создать виртуальное устройство Windows](quickstart.md).

## <a name="configure-a-deployment-manifest"></a>Настройка манифеста развертывания

Манифест развертывания — это документ JSON, в котором определены развертываемые модули, способ передачи данных между этими модулями и требуемые свойства для двойников модулей. Дополнительные сведения о работе манифестов развертывания и об их создании см. в руководстве по [использованию, настройке и повторном использовании модулей Azure IoT Edge](module-composition.md).

Портал Azure предоставляет мастер, который в пошаговом режиме помогает создать манифест развертывания без необходимости редактировать документ JSON вручную. В этом мастере есть три шага: **Добавление модулей**, **Указание маршрутов** и **Просмотр развертываний**.

>[!NOTE]
>Действия, описанные в этой статье, соответствуют последней версии схемы агента и концентратора IoT Edge. Версия схемы 1,1 была выпущена вместе с IoT Edge версии 1.0.10 и включает порядок запуска модуля и возможности определения приоритетов маршрутов.
>
>При развертывании на устройстве под управлением версии 1.0.9 или более ранней измените **Параметры среды выполнения** **на шаге мастера, чтобы** использовать схему версии 1,0.

### <a name="select-device-and-add-modules"></a>Выбор устройства и добавление модулей

1. Войдите на [портал Azure](https://portal.azure.com) и перейдите к своему Центру Интернета вещей.
1. В левой области выберите **IOT Edge** в меню.
1. Щелкните идентификатор целевого устройства в списке устройств.
1. На верхней панели выберите **Задание модулей**.
1. В разделе **параметры реестра контейнеров** на странице Укажите учетные данные для доступа к любым частным реестрам контейнеров, содержащим образы модулей.
1. В разделе **IOT Edge модули** страницы щелкните **Добавить**.
1. В раскрывающемся меню выберите один из трех типов модулей:

   * **Модуль IOT Edge** . Вы предоставляете имя модуля и URI образа контейнера. Например, универсальный код ресурса (URI) образа для примера модуля Симулатедтемпературесенсор — `mcr.microsoft.com/azureiotedge-simulated-temperature-sensor:1.0` . Если образ модуля хранится в частном реестре контейнеров, добавьте учетные данные на этой странице для доступа к образу.
   * **Модуль Marketplace** — модули, размещенные в Azure Marketplace. Для некоторых модулей Marketplace требуется дополнительная настройка, поэтому ознакомьтесь со сведениями о модуле в списке [модулей IOT Edge Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/category/internet-of-things?page=1&subcategories=iot-edge-modules) .
   * **Azure Stream Analytics модуля** — модули, созданные из рабочей нагрузки Azure Stream Analytics.

1. После добавления модуля выберите имя модуля из списка, чтобы открыть параметры модуля. При желании заполните необязательные поля.

   Дополнительные сведения о доступных параметрах модуля см. в разделе [Настройка модуля и управление](module-composition.md#module-configuration-and-management).

   Подробные сведения о двойниках модулей см. в разделе [Определение или обновление требуемых свойств](module-composition.md#define-or-update-desired-properties).

1. Повторите шаги с 6 по 8, чтобы добавить дополнительные модули в развертывание.
1. Нажмите кнопку **Далее: Маршруты** , чтобы перейти к разделу маршруты.

### <a name="specify-routes"></a>Настройка маршрутов

На вкладке **Маршруты** определите способ передачи сообщений между модулями и Центром Интернета вещей. Сообщения создаются с использованием пар "имя — значение". По умолчанию первое развертывание нового устройства включает маршрут с именем **Route** и определенный как **из/мессажес/ \* в $upstream**. Это означает, что все сообщения, выводимые любыми модулями, отправляются в центр Интернета вещей.  

Параметры **Priority** и **time to Live** — необязательные параметры, которые можно включить в определение маршрута. Параметр Priority позволяет выбрать маршруты, которые должны обрабатываться в первую очередь, или маршруты, которые должны быть обработаны последними. Приоритет определяется установкой числа 0-9, где 0 — высший приоритет. Параметр срока жизни позволяет объявлять, как долго сообщения в этом маршруте должны удерживаться, пока они не будут обработаны или удалены из очереди.

Дополнительные сведения о создании маршрутов см. в разделе [объявление маршрутов](module-composition.md#declare-routes).

После настройки маршрутов нажмите кнопку **Далее: Проверка + создать** , чтобы перейти к следующему шагу мастера.

### <a name="review-deployment"></a>Проверка развертывания

В разделе обзорной информации вы увидите манифест развертывания в формате JSON, который был создан на основе параметров, выбранных вами в двух предыдущих разделах. Обратите внимание, что здесь объявлены два дополнительных модуля, которые вы не добавляли: **$edgeAgent** и **$edgeHub**. Эти два модуля составляют [среду выполнения IoT Edge](iot-edge-runtime.md) и являются обязательными для каждого развертывания.

Просмотрите сведения о развертывании и нажмите кнопку **создать**.

## <a name="view-modules-on-your-device"></a>Просмотр модулей, установленных на устройстве

После развертывания модулей на устройстве их можно просмотреть на странице сведений об устройстве в центре Интернета вещей. Эта страница отображает имя каждого развернутого модуля и полезную информацию о нем, включая состояние развертывания и код завершения.

## <a name="deploy-modules-from-azure-marketplace"></a>Развертывание модулей из Azure Marketplace

[Azure Marketplace](https://azuremarketplace.microsoft.com/) — это веб-магазин интерактивных приложений и служб, на котором можно просматривать широкий спектр корпоративных приложений и решений, которые сертифицированы и оптимизированы для работы в Azure, включая [модули IOT Edge](https://azuremarketplace.microsoft.com/marketplace/apps/category/internet-of-things?page=1&subcategories=iot-edge-modules).

Вы можете развернуть модуль IoT Edge из Azure Marketplace и из центра Интернета вещей.

### <a name="deploy-from-azure-marketplace"></a>Развертывание из Azure Marketplace

Проперу IoT Edge модули в Marketplace, и если вы нашли нужный модуль, его можно развернуть, выбрав **создать** или **получить сейчас**. Продолжайте работу с шагами мастера развертывания, которые могут различаться в зависимости от выбранного модуля IoT Edge:

1. Подтвердите условия использования и политику конфиденциальности поставщика, выбрав **Продолжить**. Вам может потребоваться указать контактные данные.
1. Выберите свою подписку и Центр Интернета вещей, к которому подключено целевое устройство.
1. Выберите **Развертывание на устройстве**.
1. Введите имя устройства или выберите **Найти устройство**, чтобы просмотреть устройства, зарегистрированные в центре.
1. Выберите **Создать** для продолжения стандартного процесса настройки манифеста развертывания, при желании включая добавление других модулей. Сведения новых модулей, например URI образа, параметры создания или требуемые свойства, предопределены, но их можно изменить.

Убедитесь, что модуль развернут в центре Интернета вещей в портал Azure. Выберите устройство, щелкните **задать модули** , и модуль должен быть указан в разделе **модули IOT Edge** .

### <a name="deploy-from-azure-iot-hub"></a>Развертывание из центра Интернета вещей Azure

Вы можете быстро развернуть модуль из Azure Marketplace на устройстве в центре Интернета вещей на портал Azure.

1. Найдите нужный Центр Интернета вещей на портале Azure.
1. В левой области в разделе **Автоматическое управление устройствами** выберите **IOT Edge**.
1. Выберите устройство IoT Edge, которое будет принимать развертывание.
1. На верхней панели выберите **Задание модулей**.
1. В разделе **модули IOT Edge** щелкните **Добавить** и в раскрывающемся меню выберите **модуль Marketplace** .

![Добавление модуля в центр Интернета вещей](./media/how-to-deploy-modules-portal/iothub-add-module.png)

Выберите модуль на странице **IOT Edge модуль Marketplace** . Выбранный модуль автоматически настраивается для вашей подписки, группы ресурсов и устройства. Затем он появится в списке модулей IoT Edge. Для некоторых модулей может потребоваться дополнительная настройка.

> [!TIP]
> Сведения о модулях IoT Edge из центра Интернета вещей Azure ограничены. Вы можете сначала узнать больше о [модулях IOT Edge](https://azuremarketplace.microsoft.com/marketplace/apps/category/internet-of-things?page=1&subcategories=iot-edge-modules) в Azure Marketplace.

Последовательно выберите **Далее: Маршруты** и продолжить развертывание, как описано в разделе [Указание маршрутов](#specify-routes) и [Проверка развертывания](#review-deployment) ранее в этой статье.

## <a name="next-steps"></a>Дальнейшие действия

Изучите раздел [Развертывание и мониторинг модулей IoT Edge в нужном масштабе (предварительная версия)](how-to-deploy-at-scale.md)
