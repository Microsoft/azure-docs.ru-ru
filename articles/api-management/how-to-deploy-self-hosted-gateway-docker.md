---
title: Развертывание самостоятельно размещенного шлюза в DOCKER | Документация Майкрософт
description: Узнайте, как развернуть самостоятельно размещенный Шлюз компонента управления API Azure в DOCKER
services: api-management
documentationcenter: ''
author: vladvino
manager: gwallace
editor: ''
ms.service: api-management
ms.topic: article
ms.date: 04/26/2020
ms.author: apimpm
ms.openlocfilehash: b9e990988770e8aca015ae8b1159bb4f5e50df57
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "82205096"
---
# <a name="deploy-an-azure-api-management-self-hosted-gateway-to-docker"></a>Развертывание самостоятельно размещенного шлюза службы управления API Azure в DOCKER

В этой статье описаны действия по развертыванию компонента самостоятельно размещенного шлюза в службе управления API Azure в среде DOCKER.

> [!NOTE]
> Размещение самостоятельно размещенного шлюза в DOCKER лучше всего подходит для целей использования при оценке и разработке. Kubernetes рекомендуется использовать для использования в рабочей среде. В [этом](how-to-deploy-self-hosted-gateway-kubernetes.md) документе содержатся сведения о развертывании автономного шлюза в Kubernetes.

## <a name="prerequisites"></a>Предварительные требования

- Выполните инструкции из краткого руководства [Создание экземпляра службы управления API Azure](get-started-create-service-instance.md)
- Создайте среду DOCKER. [DOCKER для настольных систем](https://www.docker.com/products/docker-desktop) является хорошим вариантом для целей разработки и оценки. Сведения о всех выпусках DOCKER, их функциях и исчерпывающей документации по собственно DOCKER см. в [документации по DOCKER](https://docs.docker.com) .
- [Подготавливает ресурс шлюза в экземпляре управления API](api-management-howto-provision-self-hosted-gateway.md)

> [!NOTE]
> Самостоятельно размещенный шлюз упаковывается как контейнер DOCKER на основе x86-64 Linux.

## <a name="deploy-the-self-hosted-gateway-to-docker"></a>Развертывание самостоятельно размещенного шлюза в DOCKER

1. Выберите **шлюзы** в разделе **развертывание и инфраструктура**.
2. Выберите ресурс шлюза, который планируется развернуть.
3. Выберите **развертывание**.
4. Обратите внимание, что маркер доступа в текстовом поле **маркера** был создан автоматически при использовании значений **срока действия** по умолчанию и **секретного ключа** . При необходимости выберите нужные значения в одном или обоих элементах управления для создания нового маркера.
4. Убедитесь, что в разделе **сценарии развертывания** выбрано **DOCKER** .
5. Выберите ссылку на файл **env. conf** рядом с **окружением** , чтобы скачать файл.
6. Щелкните значок **копирования** в правой части текстового поля **выполнить** , чтобы скопировать команду DOCKER в буфер обмена.
7. Вставьте команду в окно терминала (или команду). При необходимости настройте сопоставление портов и имя контейнера. Обратите внимание, что команда предполагает, что загруженный файл окружения находится в текущем каталоге.
```
    docker run -d -p 80:8080 -p 443:8081 --name <gateway-name> --env-file env.conf mcr.microsoft.com/azure-api-management/gateway:<tag>
```
8. Выполните команду. Команда предписывает среде DOCKER запускать контейнер с помощью [образа контейнера](https://aka.ms/apim/sputnik/dhub) , скачанного из реестра контейнеров Майкрософт, и СОПОСТАВЛЯТЬ порты HTTP (8080) и HTTPS (8081) контейнера с портами 80 и 443 на узле.
9. Выполните следующую команду, чтобы проверить, запущен ли контейнер шлюза:
```console
docker ps
CONTAINER ID        IMAGE                                                 COMMAND                  CREATED             STATUS              PORTS                                         NAMES
895ef0ecf13b        mcr.microsoft.com/azure-api-management/gateway:latest   "/bin/sh -c 'dotnet …"   5 seconds ago       Up 3 seconds        0.0.0.0:80->8080/tcp, 0.0.0.0:443->8081/tcp   my-gateway
```
10. Вернитесь к портал Azure, щелкните **Обзор** и убедитесь, что только что развернутый контейнер самостоятельно размещенного шлюза сообщает о работоспособном состоянии.

![состояние шлюза](media/how-to-deploy-self-hosted-gateway-docker/status.png)

> [!TIP]
> Используйте <code>console docker container logs <gateway-name></code> команду для просмотра моментального снимка журнала автономного шлюза.
>
> Используйте <code>docker container logs --help</code> команду, чтобы просмотреть все параметры просмотра журнала.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о шлюзе, размещенном в собственном расположении, см. в статье [Общие сведения о шлюзе службы управления API Azure](self-hosted-gateway-overview.md).
* [Настройте имя личного домена для самостоятельно размещенного шлюза](api-management-howto-configure-custom-domain-gateway.md).
