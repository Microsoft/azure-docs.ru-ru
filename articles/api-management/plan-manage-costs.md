---
title: Планирование и управление затратами на управление API Azure
description: Узнайте, как планировать и управлять затратами на управление API Azure с помощью анализа затрат в портал Azure.
author: dlepow
ms.author: apimpm
ms.custom: subject-cost-optimization
ms.service: api-management
ms.topic: how-to
ms.date: 12/15/2020
ms.openlocfilehash: 1ebb89ae318e57f1d4e0708a08019515ca43158d
ms.sourcegitcommit: 2817d7e0ab8d9354338d860de878dd6024e93c66
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2021
ms.locfileid: "99581335"
---
# <a name="plan-and-manage-costs-for-api-management"></a>Планирование и управление затратами на управление API

В этой статье описывается планирование и управление затратами на управление API Azure. Во-первых, вы используете калькулятор цен Azure, чтобы помочь спланировать затраты на управление API, прежде чем добавлять ресурсы для службы для оценки затрат. После того как вы начали использовать ресурсы управления API, используйте функции управления затратами для установки бюджетов и отслеживания затрат. Вы также можете просматривать прогнозные затраты и выявление тенденций расходов для выявления областей, в которых может потребоваться выполнить действия. 

Затраты на управление API — это лишь часть ежемесячных затрат в счете Azure. Хотя в этой статье объясняется, как спланировать и управлять затратами на управление API, вы оплачиваете все службы и ресурсы Azure, используемые в вашей подписке Azure, включая сторонние службы.

## <a name="prerequisites"></a>Предварительные требования

Анализ затрат в службе "Управление затратами" поддерживает большинство типов учетных записей Azure, но не все из них. Полный список поддерживаемых типов учетных записей см. в статье [Understand Cost Management data](../cost-management-billing/costs/understand-cost-mgt-data.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) (Интерпретация данных службы "Управление затратами"). Для просмотра данных о затратах требуется по крайней мере доступ на чтение для учетной записи Azure. Дополнительные сведения о назначении доступа к данным службы "Управление затратами" Azure см. в [этой статье](../cost-management-billing/costs/assign-access-acm-data.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).

## <a name="estimate-costs-before-using-api-management"></a>Оценка затрат перед использованием управления API

Используйте [Калькулятор цен Azure](https://azure.microsoft.com/pricing/calculator/) , чтобы оценить затраты перед добавлением службы управления API. 

1. Выполните поиск по запросу *Управление API* или выберите **Интеграция**  >  **Управление API**.
1. Выберите **представление** , чтобы добавить оценку затрат по умолчанию для экземпляра службы управления API.

> [!NOTE]
> Стоимость, показанная в этом примере, используется только в демонстрационных целях. Последние сведения о ценах см. на странице [цены на управление API](https://azure.microsoft.com/pricing/details/api-management/) .

:::image type="content" source="media/plan-manage-costs/pricing-calculator-developer-tier.png" alt-text="Оценка затрат на уровень разработчика":::

* Оценка затрат по умолчанию основана на экземпляре службы управления API на [уровне служб](api-management-features.md) **Developer** с 1 [единицей мощности](api-management-capacity.md). Уровень разработчика предназначен для нерабочих случаев использования и оценки. Оно не является соглашением об уровне обслуживания.

* Чтобы оценить затраты на дополнительные единицы мощности или другой уровень служб, выберите другие параметры из раскрывающихся списков **единицы** и **уровня** .

* В зависимости от доступности функций и уровня служб, для использования [шлюзов с самостоятельным размещением](self-hosted-gateway-overview.md)могут взиматься дополнительные платы.

Дополнительные сведения о ценах и характеристиках см. в следующих статьях:

* [Цены на управление API](https://azure.microsoft.com/pricing/details/api-management/)
* [Сравнение возможностей категорий управления API Azure](api-management-features.md)

### <a name="using-monetary-credit-with-api-management"></a>Использование денежного кредита с управлением API

Вы можете платить за оплату управления API с помощью предоплаты Azure (ранее называлось денежным обязательством). Однако вы не можете использовать предварительную оплату Azure для оплаты за продукты и услуги сторонних производителей, в том числе и из Azure Marketplace.

## <a name="monitor-costs"></a>Мониторинг затрат

При использовании ресурсов Azure с управлением API вы несете расходы. Затраты на единицу использования ресурсов Azure зависят от временных интервалов (секунды, минуты, часы и дни) или использования единиц измерения (байт, мегабайт и т. д.). Как только начнется использование управления API, издержки будут затратны, и вы сможете просмотреть затраты в [анализе затрат](../cost-management-billing/costs/quick-acm-cost-analysis.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).

При использовании анализа затрат вы просматриваете затраты на управление API в диаграммах и таблицах для различных временных интервалов. Некоторые примеры относятся к дню, текущему и предыдущему месяцу и году. Вы также можете просматривать затраты по бюджету и прогнозируемым затратам. Переключение на более длительные представления с течением времени может помочь определить тенденции расходов. И вы видите, где может произойти чрезмерная трата. Если вы создали бюджеты, можно легко увидеть, где они превышаются.

> [!NOTE]
> Стоимость, показанная в этом примере, используется только в демонстрационных целях. Ваши затраты будут зависеть от использования ресурсов и цены.

Чтобы просмотреть затраты на управление API в анализе затрат:

1. Войдите на [портал Azure](https://azure.microsoft.com).
1. Откройте окно **Управление затратами + выставление счетов** , выберите в меню пункт **Управление затратами** , а затем выберите **область выставления счетов**. Например, выберите подписку из списка.
1. В меню выберите пункт **Управление затратами** , а затем выберите **анализ затрат**.
1. По умолчанию ежемесячные затраты на все службы показаны на первой кольцевой диаграмме. 

    :::image type="content" source="media/plan-manage-costs/api-management-cost-analysis.png" alt-text="Ежемесячные затраты на подписку":::

1. Чтобы уменьшить затраты на одну службу, например управление API, выберите **Добавить фильтр** , а затем выберите **имя службы**. Затем выберите **Управление API**.

    :::image type="content" source="media/plan-manage-costs/api-management-apim-cost-analysis.png" alt-text="Пример, в котором показаны накопленные затраты на управление API":::

В предыдущем примере вы видите текущие затраты на службу. Также показаны затраты на регионы Azure (местоположения) и затраты на управление API по группам ресурсов. Здесь вы можете исследовать затраты самостоятельно.

## <a name="create-budgets"></a>Создание бюджетов

Вы можете создавать [бюджеты](../cost-management-billing/costs/tutorial-acm-create-budgets.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) для управления затратами и создавать [оповещения](../cost-management-billing/costs/cost-mgt-alerts-monitor-usage-spending.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) , которые автоматически уведомляют заинтересованных лиц о трате аномалий и чрезмерной трате рисков. Оповещения основываются на расходах по сравнению с пороговыми значениями бюджета и затрат. Бюджеты и оповещения создаются для подписок Azure и групп ресурсов, поэтому они полезны в рамках общей стратегии мониторинга затрат. 

Бюджеты можно создавать с помощью фильтров для конкретных ресурсов или служб в Azure, если требуется дополнительная детализация в мониторинге. Фильтры помогают предотвратить случайное создание новых ресурсов, которые избавляет вас от дополнительных денег. Дополнительные сведения о параметрах фильтра при создании бюджета см. в разделе [Параметры группы и фильтра](../cost-management-billing/costs/group-filter.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).

## <a name="export-cost-data"></a>Экспорт данных о затратах

Вы также можете [экспортировать данные о затратах](../cost-management-billing/costs/tutorial-export-acm-data.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) в учетную запись хранения. Это полезно, если вам потребуются дополнительные средства анализа данных. Например, Группа финансов может анализировать данные с помощью Excel или Power BI. Вы можете экспортировать затраты на ежедневное, еженедельное или ежемесячное расписание и задать настраиваемый диапазон дат. Для извлечения наборов данных о затратах рекомендуется экспортировать данные о затратах.

## <a name="other-ways-to-manage-and-reduce-costs-for-api-management"></a>Другие способы управления и снижения затрат на управление API

### <a name="choose-tier"></a>Выберите уровень

Ознакомьтесь с [сравнением на основе функций для уровней управления API Azure](api-management-features.md) , которые помогут решить, какой уровень служб подходит для ваших сценариев. Различные уровни служб поддерживают сочетание функций и возможностей, предназначенных для различных вариантов использования с разными затратами. 

* Уровень службы " **потребление** " предоставляет упрощенный бессерверный вариант, который не требует фиксированных затрат. Счет выставляется в зависимости от количества вызовов API к службе выше определенного порогового значения. Емкость также масштабируется автоматически в зависимости от нагрузки на службу.
* Уровни управления API " **разработчик**", " **базовый**", " **стандартный**" и " **премиум** " включают ежемесячные затраты и обеспечивают большую пропускную способность и более широкие возможности для ознакомительных и рабочих рабочих нагрузок. [Обновление](upgrade-and-scale.md) до другого уровня служб в любое время.

### <a name="scale-using-capacity-units"></a>Масштабирование с использованием единиц емкости

За исключением уровня службы потребления, служба управления API поддерживает масштабирование, добавляя или удаляя [*единицы мощности*](api-management-capacity.md). При увеличении нагрузки на экземпляре службы управления API Добавление единиц емкости может оказаться более экономичным, чем обновление до уровня служб более высоких уровней. Максимальное количество единиц зависит от уровня служб.

Каждая единица мощности имеет определенные возможности обработки запросов, которые зависят от уровня службы. Например, единица уровня "базовый" имеет приблизительную максимальную пропускную способность приблизительно 1 000 запросов в секунду. 

При добавлении или удалении единиц измерения, емкости и стоимости пропорционально. Например, две единицы уровня Standard обеспечивают приблизительную пропускную способность приблизительно 2 000 запросов в секунду. Фактическая пропускная способность может отличаться из-за размера запросов или ответов, шаблонов подключений, числа клиентов, выполняющих запросы, и других факторов.

[Отслеживайте](api-management-howto-use-azure-monitor.md) метрики емкости для экземпляра управления API, чтобы принимать решения о том, следует ли масштабировать или обновлять экземпляр управления API в соответствии с большей нагрузкой.

## <a name="next-steps"></a>Следующие шаги

- Узнайте [, как оптимизировать инвестиции в облако с помощью службы "Управление затратами Azure](../cost-management-billing/costs/cost-mgt-best-practices.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn)".
- Дополнительные сведения об управлении затратами с помощью [анализа затрат](../cost-management-billing/costs/quick-acm-cost-analysis.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).
- Узнайте, как [предотвратить непредвиденные затраты](../cost-management-billing/cost-management-billing-overview.md?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn).
- Пройдите курс обучения по [управлению затратами](/learn/paths/control-spending-manage-bills?WT.mc_id=costmanagementcontent_docsacmhorizontal_-inproduct-learn) .
- Сведения о [производительности](api-management-capacity.md)управления API.
- См. инструкции по масштабированию и обновлению управления API с помощью [портал Azure](upgrade-and-scale.md)и сведения об [автомасштабировании](api-management-howto-autoscale.md).
