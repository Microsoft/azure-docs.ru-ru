---
title: Отключение и повторное включение надстройки входящего контроллера шлюза приложений для кластера службы Kubernetes Azure
description: В этой статье содержатся сведения об отключении и повторном включении надстройки АГИК для кластера AKS.
services: application-gateway
author: caya
ms.service: application-gateway
ms.topic: how-to
ms.date: 06/10/2020
ms.author: caya
ms.openlocfilehash: fe4da0435731c536a723cb2cb43428166456360b
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "84807953"
---
# <a name="disable-and-re-enable-agic-add-on-for-your-aks-cluster"></a>Отключение и повторное включение надстройки АГИК для кластера AKS
Контроллер входящего трафика шлюза приложений (АГИК), развернутый в качестве надстройки AKS, позволяет включать и отключать надстройку с помощью одной строки в Azure CLI. Жизненный цикл шлюза приложений будет отличаться при отключении надстройки АГИК, в зависимости от того, был ли шлюз приложений создан надстройкой АГИК или был развернут отдельно от надстройки АГИК. Можно выполнить ту же команду, чтобы повторно включить надстройку АГИК, если она отключена, или включить надстройку АГИК с помощью существующего кластера AKS и шлюза приложений.

## <a name="disabling-agic-add-on-with-associated-application-gateway"></a>Отключение надстройки АГИК со связанным шлюзом приложений 
Если надстройка АГИК автоматически развернула шлюз приложений при первой настройке, то отключение надстройки АГИК по умолчанию приведет к удалению шлюза приложений на основе нескольких критериев. У надстройки АГИК есть два критерия, чтобы определить, следует ли удалить связанный шлюз приложений при его отключении:
- Будет ли шлюз приложений, с которым связана надстройка АГИК, развертываться в группе ресурсов MC_ * node? 
- Имеет ли шлюз приложений, с которым связана надстройка АГИК, тег "Created-By: входящегоed-appgw"? Тег используется АГИК для определения того, был ли шлюз приложений развернут с помощью надстройки или нет. 

Если выполняются оба условия, надстройка АГИК удалит шлюз приложений, созданный при отключении надстройки. Однако он не удаляет общедоступный IP-адрес или подсеть, в которой был развернут шлюз приложений (или в). Если первые критерии не выполняются, то не имеет значения, если шлюз приложений имеет тег "Created: входящегоed-appgw". Отключение надстройки не приведет к удалению шлюза приложений. Аналогично, если второе условие не выполняется, т. е. шлюз приложений не имеет этого тега, то отключение надстройки не приведет к удалению шлюза приложений в группе ресурсов MC_ *. 

> [!TIP] 
> Если вы не хотите, чтобы шлюз приложений был удален при отключении надстройки, но соответствует обоим критериям, удалите тег "Created: входящегоed-appgw", чтобы надстройка не удалила шлюз приложений. 

Чтобы отключить надстройку АГИК, выполните следующую команду: 
```azurecli-interactive
az aks disable-addons -n <AKS-cluster-name> -g <AKS-resource-group-name> -a ingress-appgw 
```

## <a name="enable-agic-add-on-on-existing-application-gateway-and-aks-cluster"></a>Включить надстройку АГИК в существующем шлюзе приложений и кластере AKS
Если вы отключите надстройку АГИК и хотите повторно включить надстройку или включить надстройку с помощью существующего шлюза приложений и кластера AKS, выполните следующую команду:

```azurecli-interactive
appgwId=$(az network application-gateway show -n <application-gateway-name> -g <resource-group-name> -o tsv --query "id") 
az aks enable-addons -n <AKS-cluster-name> -g <AKS-cluster-resource-group> -a ingress-appgw --appgw-id $appgwId
```

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о том, как включить надстройку АГИК с помощью существующего шлюза приложений и кластера AKS, см. в разделе [агик Add-in серия статей Brownfield Deployment](tutorial-ingress-controller-add-on-existing.md).