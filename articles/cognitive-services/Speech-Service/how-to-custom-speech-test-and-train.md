---
title: Подготовка данных для Пользовательское распознавание речи службы речи
titleSuffix: Azure Cognitive Services
description: При тестировании точности распознавания речи Майкрософт или обучения пользовательских моделей вам потребуются данные аудио и Text. На этой странице рассматриваются типы данных, способы их использования и управления ими.
services: cognitive-services
author: trevorbye
manager: nitinme
ms.service: cognitive-services
ms.subservice: speech-service
ms.topic: conceptual
ms.date: 03/27/2020
ms.author: trbye
ms.openlocfilehash: af5ed0296ce99a4450fffec6b047285307ed0ff2
ms.sourcegitcommit: d488a97dc11038d9cef77a0235d034677212c8b3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2020
ms.locfileid: "97709305"
---
# <a name="prepare-data-for-custom-speech"></a>Подготовка данных для службы пользовательского распознавания речи

При тестировании точности распознавания речи Майкрософт или обучения пользовательских моделей вам потребуются данные аудио и Text. На этой странице мы рассмотрим типы данных, необходимые для пользовательской модели распознавания речи.

## <a name="data-diversity"></a>Разнообразие данных

Текст и звук, используемые для тестирования и обучения пользовательской модели, должны включать примеры из широкого набора докладчиков и сценариев, которые необходимо распознать вашей модели.
При сборе данных для тестирования и обучения пользовательских моделей учитывайте следующие факторы:

* Текстовые и речевые данные должны охватывать виды инструкций текстовом, которые пользователи будут делать при взаимодействии с моделью. Например, модель, которая вызывает и понижает температуру, требует обучения с инструкциями, которые могут запрашивать эти изменения.
* Ваши данные должны включать все дисперсии речи, которые необходимо распознать вашей модели. Многие факторы могут зависеть от речи, включая диакритические знаки, диалекты, смешение языков, возраст, пол, тон голоса, уровень нагрузки и время суток.
* Необходимо включить выборки из различных сред (размещение, наружный шум), где будет использоваться модель.
* Звук должен быть собран с помощью аппаратных устройств, которые будет использовать рабочая система. Если вашей модели необходимо определить речь, записанную для записи устройств с различным качеством, звуковые данные, которые вы предоставляете для обучения модели, также должны представлять эти разнообразные сценарии.
* Позднее вы можете добавить дополнительные данные в модель, но следите за тем, чтобы набор данных был разнообразным и репрезентативным для нужд проекта.
* Включение данных, *не* входящих в ваши пользовательские модели, может привести к повышению качества распознавания, поэтому не включайте данные, которые не нужно транскрипция модели.

Модель, обученная в подмножестве сценариев, может прекрасно работать в этих сценариях. Тщательно выбирайте данные, представляющие всю область сценариев, которые необходимо распознать в вашей пользовательской модели.

> [!TIP]
> Начните с небольших наборов демонстрационных данных, которые соответствуют языку и акустическим данным, которые будут встречаться в вашей модели.
> Например, запишите небольшую, но репрезентативную выборку звука на одном и том же оборудовании и в той же акустической среде, которую модель найдет в рабочих сценариях.
> Небольшие наборы данных, представляющие собой репрезентативные данные, могут предоставлять проблемы до тех пор, пока вы не приложили к сбору гораздо более обширных DataSet для обучения.

## <a name="data-types"></a>Типы данных

В этой таблице перечислены допустимые типы данных, когда следует использовать каждый тип данных и рекомендуемое количество. Для создания модели требуется не каждый тип данных. Требования к данным зависят от того, создаете ли вы тестирование или обучение модели.

| Тип данных | Используется для тестирования | Рекомендуемое количество | Используется для обучения | Рекомендуемое количество |
|-----------|-----------------|----------|-------------------|----------|
| [звук;](#audio-data-for-testing) | Да<br>Используется для визуальной проверки | более 5 звуковых файлов | Нет | Недоступно |
| [Звуковые и пользовательские записи с метками](#audio--human-labeled-transcript-data-for-testingtraining) | Да<br>Используется для вычисления точности | 0,5 – 5 часов звука | Да | 1-20 часов звука |
| [Связанный текст](#related-text-data-for-training) | Нет | Недоступно | Да | 1-200 МБ связанного текста |

При обучении новой модели Начните с [связанного текста](#related-text-data-for-training). Эти данные уже будут улучшать распознавание специальных терминов и фраз.

Файлы должны быть сгруппированы по типу в набор данных и переданы в виде ZIP-файла. Каждый набор данных может содержать только один тип данных.

> [!TIP]
> Чтобы быстро приступить к работе, рассмотрите возможность использования демонстрационных данных. <a href="https://github.com/Azure-Samples/cognitive-services-speech-sdk/tree/master/sampledata/customspeech" target="_target">Пример данных <span class="docon docon-navigate-external x-hidden-focus"></span> пользовательское распознавание речи</a> см. в этом репозитории GitHub.

## <a name="upload-data"></a>Отправка данных

Чтобы передать данные, перейдите на <a href="https://speech.microsoft.com/customspeech" target="_blank">портал <span class="docon docon-navigate-external x-hidden-focus"></span> пользовательское распознавание речи </a>. На портале щелкните **отправить данные** , чтобы запустить мастер и создать первый набор данных. Прежде чем разрешить передачу данных, вам будет предложено выбрать тип данных речи для набора данных.

![Снимок экрана, посвященный параметру передачи звука с портала речевого ввода.](./media/custom-speech/custom-speech-select-audio.png)

Каждый передаваемый набор данных должен соответствовать требованиям к выбранному типу данных. Данные должны быть правильно отформатированы перед передачей. Правильно отформатированные данные гарантируют, что они будут правильно обрабатываться службой Пользовательское распознавание речи. Требования перечислены в следующих разделах.

После отправки набора данных существует несколько вариантов:

* Вы можете переходить на вкладку " **тестирование** " и визуально проверять только звуковые данные или аудиозаписи с метками "звук" и "человек".
* Вы можете переходить на вкладку " **обучение** " и использовать звуковые и видеозаписи или связанные текстовые данные для обучения настраиваемой модели.

## <a name="audio-data-for-testing"></a>Звуковые данные для тестирования

Звуковые данные оптимальны для тестирования точности базовой модели преобразования речи в текст или настраиваемой модели корпорации Майкрософт. Помните, что звуковые данные используются для проверки точности речи с точки зрения производительности конкретной модели. Если вы хотите количественно определить точность модели, используйте [звуковые и человеческие данные для транскрипции](#audio--human-labeled-transcript-data-for-testingtraining).

Используйте эту таблицу, чтобы убедиться, что звуковые файлы правильно отформатированы для использования с Пользовательское распознавание речи.

| Свойство                 | Значение                 |
|--------------------------|-----------------------|
| Формат файла              | RIFF (WAV)            |
| Частота выборки              | 8 000 Гц или 16 000 Гц |
| Каналы                 | 1 (моно)              |
| Максимальная длина на одном аудио | 2 часа               |
| Формат выборки            | PCM, 16-разрядные           |
| Формат архива           | .zip                  |
| Максимальный размер архива     | 2 ГБ                  |

[!INCLUDE [supported-audio-formats](includes/supported-audio-formats.md)]

> [!TIP]
> При отправке обучающих и проверочных данных Размер ZIP-файла не может превышать 2 ГБ. Если вам нужны дополнительные данные для обучения, разделите их на несколько ZIP-файлов и отправьте их по отдельности. Позже можно будет выполнить обучение из *нескольких* наборов данных. Однако тест можно выполнять только из *одного* набора данных.

Используйте <a href="http://sox.sourceforge.net" target="_blank" rel="noopener">Sox <span class="docon docon-navigate-external x-hidden-focus"></span> </a> для проверки свойств аудио или преобразования существующих аудио в соответствующие форматы. Ниже приведены некоторые примеры того, как можно выполнить каждое из этих действий с помощью командной строки SoX:

| Действие | Описание | Команда SoX |
|----------|-------------|-------------|
| Проверить формат звука | Используйте эту команду для проверки<br>формат звукового файла. | `sox --i <filename>` |
| Преобразовать формат аудио | Используйте эту команду для преобразования<br>звуковой файл в один канал, 16-разрядный, 16 кГц. | `sox <input> -b 16 -e signed-integer -c 1 -r 16k -t wav <output>.wav` |

## <a name="audio--human-labeled-transcript-data-for-testingtraining"></a>Звуковые и человеческие данные для тестирования и обучения

Чтобы измерить точность точности речи в тексте от корпорации Майкрософт при обработке звуковых файлов, для сравнения необходимо предоставить транскрипции с метками (по словам). Хотя транскрипции с метками часто потребляют много времени, необходимо оценить точность и обучить модель для вариантов использования. Помните, что улучшения распознавания будут так же хороши, как и предоставленные данные. По этой причине важно, чтобы отправлялись только высококачественные записи.

Звуковые файлы могут содержать тишину в начале и в конце записи. Если это возможно, включите в каждый пример файла по крайней мере половину выхода до и после речи. Хотя звук с низким объемом записи или помехами в фоновом режиме не полезен, он не должен повредить пользовательскую модель. Прежде чем собирать образцы аудио, всегда рассмотрите возможность обновления микротелефонов и оборудования обработки сигналов.

| Свойство                 | Значение                               |
|--------------------------|-------------------------------------|
| Формат файла              | RIFF (WAV)                          |
| Частота выборки              | 8 000 Гц или 16 000 Гц               |
| Каналы                 | 1 (моно)                            |
| Максимальная длина на одном аудио | 2 часа (тестирование)/60 с (обучение) |
| Формат выборки            | PCM, 16-разрядные                         |
| Формат архива           | .zip                                |
| Максимальный размер ZIP-файла         | 2 ГБ                                |

[!INCLUDE [supported-audio-formats](includes/supported-audio-formats.md)]

> [!NOTE]
> При отправке обучающих и проверочных данных Размер ZIP-файла не может превышать 2 ГБ. Тест можно выполнять только из *одного* набора данных, но не обязательно хранить его в соответствующем размере файла. Кроме того, каждый файл обучения не может превышать 60 секунд, в противном случае произойдет ошибка.

Для устранения таких проблем, как удаление или замена Word, требуется значительный объем данных для улучшения распознавания. Как правило, рекомендуется предоставлять записи в Word на примерно 10 – 20 часов. Транскрипции всех WAV-файлов должны содержаться в одном текстовом файле. Каждая строка файла транскрипции должна содержать имя звукового файла и соответствующую ему транскрипцию. Для разделения имени файла и транскрипции необходимо использовать символ табуляции (\t).

  Пример:
```
  speech01.wav  speech recognition is awesome
  speech02.wav  the quick brown fox jumped all over the place
  speech03.wav  the lazy dog was not amused
```

> [!IMPORTANT]
> Для кодировки транскрипции необходимо использовать метку порядка байтов UTF-8.

Текст транскрипции нормализуется для эффективной обработки системой. Однако существуют некоторые важные нормализации, которые необходимо выполнить перед отправкой данных в Speech Studio. Сведения о том, как использовать соответствующий язык при подготовке транскрипции, см. в разделе [Создание транскрипции с отметкой](how-to-custom-speech-human-labeled-transcriptions.md)

После сбора звуковых файлов и соответствующих транскрипций перед отправкой на <a href="https://speech.microsoft.com/customspeech" target="_blank">портал <span class="docon docon-navigate-external x-hidden-focus"></span> пользовательское распознавание речи </a>упакуйте их в виде одного ZIP-файла. Ниже приведен пример набора данных с тремя звуковыми файлами и файлом транскрипции с меткой.

> [!div class="mx-imgBorder"]
> ![Выбор звука на портале речевого ввода](./media/custom-speech/custom-speech-audio-transcript-pairs.png)

Список рекомендуемых регионов для подписок на службу распознавания речи см. в разделе [Настройка учетной записи Azure](custom-speech-overview.md#set-up-your-azure-account) . Настройка подписок на речь в одном из этих регионов позволит сократить время, затрачиваемое на обучение модели.

## <a name="related-text-data-for-training"></a>Связанные текстовые данные для обучения

Уникальные имена продуктов или функции должны включать связанные текстовые данные для обучения. Связанный текст помогает обеспечить правильное распознавание. Для улучшения распознавания можно предоставить два типа связанных текстовых данных:

| Тип данных | Как эти данные улучшают распознавание |
|-----------|------------------------------------|
| Предложения (фразы продолжительностью) | Повышение точности при распознавании названий продуктов или отраслевых словарей в контексте предложения. |
| Произношение | Улучшение произношения редко встречающихся терминов, акронимов или других слов с неопределенными произношениями. |

Предложения могут быть представлены в виде одного текстового файла или нескольких текстовых файлов. Для повышения точности используйте текстовые данные, расположенные ближе к ожидаемому фразы продолжительностью. Произношение следует указывать в виде одного текстового файла. Все может быть упаковано в один ZIP-файл и отправлено на <a href="https://speech.microsoft.com/customspeech" target="_blank">портал <span class="docon docon-navigate-external x-hidden-focus"></span> пользовательское распознавание речи </a>.

### <a name="guidelines-to-create-a-sentences-file"></a>Рекомендации по созданию файла предложений

Чтобы создать пользовательскую модель с помощью предложений, необходимо предоставить список примеров фразы продолжительностью. Фразы продолжительностью _не_ обязательно должны быть полными или грамматически правильными, но они должны точно отражать речевой ввод, который вы ждете в рабочей среде. Если вы хотите, чтобы определенные термины имели более высокую плотность, добавьте несколько предложений, включающих эти конкретные условия.

Как правило, адаптация модели наиболее эффективна, если текст для обучения максимально близко к реальному тексту, ожидаемому в рабочей среде. Жаргоне и фразы для конкретного домена, которые вы намерены усовершенствовать, должны включаться в обучающий текст. По возможности старайтесь, чтобы одно предложение или ключевое слово управлялось в отдельной строке. Для ключевых слов и фраз, которые важны для вас (например, названия продуктов), их можно скопировать несколько раз. Но помните, что не копируйте слишком много — это может повлиять на общую скорость распознавания.

Используйте эту таблицу, чтобы убедиться, что связанный файл данных для фразы продолжительностью имеет правильный формат:

| Свойство | Значение |
|----------|-------|
| Кодировка текста | Метка порядка байтов UTF-8 |
| Количество фраз в строке | 1 |
| Максимальный размер файла | 200 МБ |

Кроме того, необходимо учитывать следующие ограничения.

* Старайтесь не повторять повторяющиеся символы более четырех раз. Например: "AAAA" или "УУУУ".
* Не используйте специальные символы или символы UTF-8 выше `U+00A1` .
* URI будут отклонены.

### <a name="guidelines-to-create-a-pronunciation-file"></a>Рекомендации по созданию файла произношения

При наличии редко встречающихся условий без использования стандартных произношений, которые будут встречаться или использовать пользователи, можно предоставить пользовательский файл произношения для улучшения распознавания.

> [!IMPORTANT]
> Не рекомендуется использовать пользовательские файлы произношения для изменения произношения часто встречающихся слов.

Сюда входят примеры произнесенного utteranceа и пользовательское произношение для каждого из них:

| Распознанная или отображаемая форма | Речевая форма |
|--------------|--------------------------|
| 3CPO | три c p o |
| CNTK | c n t k |
| СТАНДАРТ | я тройной e |

Произнесенная форма — это фонетическая последовательность с буквами. Оно может состоять из букв, слов, слогов или сочетания всех трех.

Настройка произношения доступна на английском ( `en-US` ) и немецком () языках ( `de-DE` ). В этой таблице показаны поддерживаемые символы по языку:

| Язык | Языковой стандарт | Знаки |
|----------|--------|------------|
| Английский | `en-US` | `a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z` |
| Немецкий | `de-DE` | `ä, ö, ü, a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z` |

Используйте следующую таблицу, чтобы убедиться в правильном форматировании связанных файлов данных для произношения. Файлы произношения являются небольшими, и их размер должен составлять всего несколько килобайт.

| Свойство | Значение |
|----------|-------|
| Кодировка текста | Спецификация UTF-8 (для английского языка также поддерживается ANSI) |
| число произношений в строке | 1 |
| Максимальный размер файла | 1 МБ (1 КБ для уровня Free) |

## <a name="next-steps"></a>Дальнейшие действия

* [Проверка данных](how-to-custom-speech-inspect-data.md)
* [Оценка данных](how-to-custom-speech-evaluate-data.md)
* [Обучение модели](how-to-custom-speech-train-model.md)
* [Развертывание модели](./how-to-custom-speech-train-model.md)