---
title: Диагностика инцидентов с помощью помощника по метрикам
titleSuffix: Azure Cognitive Services
description: Узнайте, как диагностировать инциденты с помощью помощника по метрикам и получить подробные представления аномалий в данных.
services: cognitive-services
author: mrbullwinkle
manager: nitinme
ms.service: cognitive-services
ms.subservice: metrics-advisor
ms.topic: conceptual
ms.date: 08/19/2020
ms.author: mbullwin
ms.openlocfilehash: ecbfb2d9acf6c62f95c264a14e306442db25e483
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "101703428"
---
# <a name="how-to-diagnose-an-incident-using-metrics-advisor"></a>Инструкции: диагностика инцидента с помощью помощника по метрикам

Помощник по метрикам предоставляет несколько функций для диагностики и предоставляет подробное представление об обнаруженных инцидентах и предоставляет анализ основных причин. При обнаружении группы аномалий на метрике помощник по метрикам будет группировать аномалии в иерархию и анализировать ее поверх.

> [!NOTE]
> В настоящее время советник по метрикам поддерживает диагностику инцидентов для метрик по крайней мере с одним измерением и меру с  *числовым* типом. Ваша метрика должна иметь агрегированное значение измерения, например SUM, для каждого измерения, которое используется для построения иерархии диагностики. Помощник по метрикам предлагает [**Параметры автоматического развертывания**](onboard-your-data.md#automatic-roll-up-settings) , помогающие формировать агрегированные значения. 

Щелкните **концентратор инцидентов** в левом окне навигации, чтобы просмотреть все инциденты с заданной метрикой. В верхней части страницы можно выбрать различные метрики, чтобы просмотреть их конфигурации обнаружения, результаты обнаружения и изменить диапазон времени.

> [!TIP]
> Вы также можете перейти в **центр инцидентов** , выполнив следующие действия.
> * Щелкните точку данных в визуализации для своей метрики и воспользуйтесь ссылками в нижней части окна **Добавление обратной связи** .
> * Щелкните одну из аномалий на вкладке **инциденты** для своей метрики. 

В разделе **Обзор** содержатся результаты обнаружения, включая количество аномалий и оповещений в течение выбранного диапазона времени.

:::image type="content" source="../media/diagnostics/incident-hub-overview.png" alt-text="Концентратор инцидентов" lightbox="../media/diagnostics/incident-hub-overview.png":::

Обнаруженные инциденты в выбранной метрике и диапазоне времени перечислены в **списке инцидентов**. Существуют параметры для фильтрации и упорядочивания инцидентов. Например, по серьезности. Щелкните один из инцидентов, чтобы открыть страницу " **инцидент** " для дальнейшей диагностики.

:::image type="content" source="../media/diagnostics/incident-list.png" alt-text="Список инцидентов" lightbox="../media/diagnostics/incident-list.png":::

Раздел **диагностики** позволяет выполнять углубленный анализ инцидента и средства для обнаружения основных причин.

:::image type="content" source="../media/diagnostics/diagnose-incident.png" alt-text="Диагностика инцидента" lightbox="../media/diagnostics/diagnose-incident.png" :::

## <a name="root-cause-advice"></a>Совет по основной причине

Когда в метрике обнаруживается группа аномалий и вызывается инцидент, помощник по метрикам попытается проанализировать основную причину инцидента. **Советы по основной причине** предоставляют автоматические предложения для возможных причин инцидента. Эта функция доступна, только если в измерении имеется агрегированное значение. Если метрика не имеет измерения, основная причина будет самой. Основные причины перечислены на правой боковой панели. в списке может быть несколько причин. Если в таблице нет данных, это означает, что измерение не удовлетворяет требованиям для выполнения анализа.

:::image type="content" source="../media/diagnostics/root-cause-advice.png" lightbox="../media/diagnostics/root-cause-advice.png" alt-text="Совет по основной причине":::


Если метрика основной причины предоставляется с конкретными измерениями, можно щелкнуть **Перейти к метрике** , чтобы просмотреть дополнительные сведения о метрике.

## <a name="incident-tree"></a>Дерево инцидента

Кроме того, при автоматическом анализе возможных основных причин помощник по метрикам поддерживает анализ основных причин вручную с помощью **дерева инцидентов**. На странице инцидента есть два типа дерева инцидентов: **Быстрая диагностика** дерева и **Интерактивное дерево**.

Дерево быстрой диагностики предназначено для диагностики текущего инцидента, а корневой узел ограничен текущим корневым узлом инцидента. Узлы дерева можно развернуть и свернуть, щелкнув его, и его ряды будут показаны вместе с текущим рядом инцидентов в диаграмме над деревом.

Интерактивное дерево позволяет диагностировать текущие инциденты, а также старые инциденты и связанные с ними объекты. При использовании интерактивного дерева щелкните узел правой кнопкой мыши, чтобы открыть меню действий, где можно выбрать измерение для детализации корневых узлов и измерение для детализации каждого узла. Нажав кнопку Отмена в списке Измерение вверху, можно удалить детализацию вверх или вниз из этого измерения. Щелкните узел левой кнопкой мыши, чтобы выбрать его и отобразить ряды с текущим рядом инцидентов на диаграмме.

:::image type="content" source="../media/diagnostics/incident-tree.png" alt-text="Дерево инцидента" lightbox="../media/diagnostics/incident-tree.png" :::

## <a name="anomaly-drill-down"></a>Детализация на аномалию

При просмотре сведений об инциденте может потребоваться получить более подробную информацию, например для различных измерений и отметок времени. Если данные имеют одно или несколько измерений, можно использовать функцию детализации, чтобы получить более подробное представление. 

Чтобы использовать функцию детализации, щелкните вкладку **сверление метрик** в **концентраторе инцидентов**. 

:::image type="content" source="../media/diagnostics/metric-drilling.png" lightbox="../media/diagnostics/metric-drilling.png" alt-text="Детализация метрики ":::

Параметр **dimensions** представляет собой список измерений для инцидента, можно выбрать другие доступные значения измерений для каждого из них. После изменения значений измерений. Параметр **timestamp** позволяет просматривать текущий инцидент в разное время.

### <a name="select-drilling-options-and-choose-a-dimension"></a>Выберите параметры детализации и выберите измерение.

Существует два типа параметров детализации: **Детализация** и **горизонтальное сравнение**.

> [!Note]
> 1. Для детализации можно просмотреть данные из различных значений измерений, кроме курренли выбранных измерений. 
> 2. Для горизонтального сравнения можно исследовать данные из различных значений измерений, за исключением всех измерений.

:::image type="content" source="../media/diagnostics/drill-down-dimension.png" lightbox="../media/diagnostics/drill-down-dimension.png" alt-text="Детализация измерения":::

### <a name="value-comparison-for-different-dimension-values"></a>Сравнение значений для различных значений измерений

Второй раздел вкладки детализация — это таблица с сравнениями для различных значений измерений. Он включает значение, базовое значение, значение разницы, разностное значение и является ли оно аномалией.
 
:::image type="content" source="../media/diagnostics/drill-down-comparison.png" alt-text="Сравнение детализации" lightbox="../media/diagnostics/drill-down-comparison.png":::


### <a name="value-and-expected-value-comparisons-for-different-dimension-value"></a>Сравнение значений и ожидаемых значений для другого значения измерения

Третий раздел вкладки детализация — это гистограмма со значениями и ожидаемыми значениями для различных значений измерений. Гистограмма сортируется по разности между значениями и ожидаемым значением. Непредвиденное значение можно найти с наибольшим эффектом. Например, на приведенном выше рисунке мы можем найти, что, за исключением значения «все», **US7** больше всего для аномалии.

:::image type="content" source="../media/diagnostics/drill-down-table.png" alt-text="Детализация таблицы" lightbox="../media/diagnostics/drill-down-table.png":::

### <a name="raw-value-visualization"></a>Визуализация необработанного значения
Последняя часть вкладки детализация — это график необработанных значений. Если эта диаграмма предоставлена, вам не нужно переходить к странице метрика для просмотра подробных сведений.

:::image type="content" source="../media/diagnostics/drill-down-line-chart.png" alt-text="Детализировать график" lightbox="../media/diagnostics/drill-down-line-chart.png":::

## <a name="view-similar-anomalies-using-time-series-clustering"></a>Просмотр похожих аномалий с помощью кластеризации временных рядов

При просмотре инцидента для просмотра связанных с ним рядов можно использовать вкладку с **аналогичными возможностями кластеризации временных рядов** . Ряды в одной группе суммируются вместе. На приведенном выше рисунке мы можем понять, что существует по крайней мере две группы рядов. Эта функция доступна только при соблюдении следующих требований.

1. Метрики должны иметь одно или несколько измерений или значений измерений.
2. Ряды внутри одной метрики должны иметь подобную тенденцию.

Доступные измерения перечислены в верхней части вкладки, и можно выбрать, чтобы указать ряд.

:::image type="content" source="../media/diagnostics/series-group.png" lightbox="../media/diagnostics/series-group.png" alt-text="Группа рядов":::

## <a name="compare-time-series"></a>Сравнить временные ряды

Иногда при обнаружении аномалии в определенном временном ряде полезно сравнить его с несколькими другими рядами в одной визуализации. Откройте вкладку **средства сравнения** и нажмите синюю кнопку **Добавить** . 

:::image type="content" source="../media/diagnostics/add-series.png" alt-text="Добавить ряд для сравнения" lightbox="../media/diagnostics/add-series.png":::

Выберите ряд из своего веб-канала данных. Можно выбрать одну и ту же гранулярность или другую. Выберите целевые измерения и загрузите тренд ряда, а затем нажмите кнопку **ОК** , чтобы сравнить его с предыдущим рядом. Ряды будут объединены в одну визуализацию. Вы можете продолжить добавление серии для сравнения и получения дополнительных сведений. Щелкните раскрывающееся меню в верхней части вкладки **средства сравнения** , чтобы сравнить данные временных рядов за период с сдвигом по времени.  

> [!Warning]
> Чтобы выполнить сравнение, анализ данных временных рядов может потребовать сдвига в точках данных, чтобы их можно было поддерживать детализацию данных. Например, если данные еженедельны и вы используете сравнение " **день за день** ", вы не получите результатов. В этом примере вместо этого используется сравнение " **месячный за месяц** ".

После выбора режима сравнения с сдвигом по времени можно выбрать, следует ли сравнивать значения данных, разностные значения или процентную разницу.

> [!Note]
> * **Значение данных** — это необработанное значение данных.
> * **Дельта-значение** — это разница между необработанным значением и сравниваемым значением.
> * **Процентное значение Дельта** — это разница между необработанным значением и сравниваемым значением, деленным на сравниваемое значение.

## <a name="related-incidents-across-metrics"></a>Связанные инциденты в метриках

Иногда может потребоваться проверить инциденты различных метрик одновременно или связанные инциденты в других метриках. Список связанных инцидентов можно найти в разделе **анализ перекрестных метрик** . 

:::image type="content" source="../media/graph/metrics-graph-cross-metrics-analysis.png" alt-text="связанные инциденты в метриках":::

Прежде чем можно будет увидеть связанные инциденты для текущей метрики, необходимо добавить связь между метриками. Щелкните **Параметры диаграммы метрики** , чтобы добавить связь. Только метрики с одинаковыми именами измерений могут быть связаны. Используйте следующие параметры:

- Текущая метрика канала данных &: поток данных и метрика текущего инцидента
- Направление: направление связи между двумя метриками. (не влияет на список связанных инцидентов сейчас)
- Другая метрика & канала данных: поток данных и метрика для подключения к текущей метрике


## <a name="next-steps"></a>Дальнейшие действия 

- [Настройка обнаружения аномалий с помощью обратной связи](anomaly-feedback.md)
- [Настройка метрик и детальная настройка конфигурации обнаружения](configure-metrics.md)
