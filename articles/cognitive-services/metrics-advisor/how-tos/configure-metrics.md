---
title: Настройка экземпляра помощника по метрикам с помощью веб-портала
titleSuffix: Azure Cognitive Services
description: Настройка экземпляра помощника по метрикам и точная настройка результатов обнаружения аномалий.
services: cognitive-services
author: mrbullwinkle
manager: nitinme
ms.service: cognitive-services
ms.subservice: metrics-advisor
ms.topic: conceptual
ms.date: 09/10/2020
ms.author: mbullwin
ms.openlocfilehash: 7923dad3d47122c0ceb04d1240736e2b66a0dd64
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92048259"
---
# <a name="how-to-configure-metrics-and-fine-tune-detecting-configuration"></a>Как настроить метрики и выполнить тонкую настройку обнаружения конфигурации

Используйте эту статью, чтобы приступить к настройке экземпляра советника по метрикам с помощью веб-портала. Чтобы просмотреть метрики для определенного веб-канала данных, перейдите на страницу **веб-каналов данных** и выберите один из каналов. Отобразится список связанных с ним метрик.

:::image type="content" source="../media/metrics/select-metric.png" alt-text="Выбор метрики" lightbox="../media/metrics/select-metric.png":::

Щелкните одно из имен метрик, чтобы просмотреть сведения о нем. В этом подробном представлении можно переключиться на другую метрику в том же веб-канале данных, используя раскрывающийся список в правом верхнем углу экрана.

При первом просмотре сведений о метриках можно загрузить временные ряды, позволив помощнику по метрикам выбрать один из них или указать значения для включения в каждое измерение. 

Можно также выбрать диапазоны времени и изменить макет страницы.

> [!NOTE]
> - Время начала — включительно.
> - Время окончания — монопольное. 

Можно щелкнуть вкладку **инциденты** , чтобы просмотреть аномалии, и найти ссылку на [концентратор инцидентов](diagnose-incident.md).

## <a name="tune-the-detecting-configuration"></a>Настройка обнаружения конфигурации

Метрика может применять одну или несколько обнаруженных конфигураций. Существует конфигурация по умолчанию для каждой метрики, которую можно изменить или добавить в соответствии с потребностями мониторинга.

### <a name="tune-the-configuration-for-all-series-in-current-metric"></a>Настройка конфигурации для всех рядов в текущей метрике

Эта конфигурация будет применена ко всем рядам в этой метрике, за исключением отдельных конфигураций. Конфигурация уровня метрики применяется по умолчанию при подключении данных и отображается на левой панели. Пользователи могут напрямую изменять конфигурацию уровня метрики на странице метрика. 

Существуют дополнительные параметры, такие как **направление**, и **допустимая аномалия** , которую можно использовать для дальнейшей настройки конфигурации. Кроме того, можно сочетать различные методы обнаружения. 

:::image type="content" source="../media/configuration-combination.png" alt-text="Сочетание конфигурации" lightbox="../media/configuration-combination.png":::

### <a name="tune-the-configuration-for-a-specific-series-or-group"></a>Настройка конфигурации для определенного ряда или группы

Щелкните **Расширенная конфигурация** ниже параметров конфигурации уровня метрики, чтобы просмотреть конфигурацию уровня группы. Можно добавить конфигурацию для отдельного ряда или группы рядов, щелкнув **+** значок в этом окне. Параметры похожи на параметры конфигурации уровня метрики, но может потребоваться указать по меньшей мере одно значение измерения для конфигурации уровня группы, чтобы определить группу рядов. И укажите все значения измерений для конфигурации на уровне ряда, чтобы определить конкретные ряды. 

Эта конфигурация будет применена к группе рядов или отдельных рядов вместо конфигурации уровня метрики. После установки условий для этой группы сохраните ее.

:::image type="content" source="../media/advanced-configuration.png" alt-text="Расширенная конфигурация" lightbox="../media/advanced-configuration.png":::

### <a name="anomaly-detection-methods"></a>Методы обнаружения аномалий

Советник по метрикам предлагает несколько методов обнаружения аномалий. Для этого можно использовать логические операторы или объединить их с помощью логических операторов, нажав **+** кнопку. 

**Интеллектуальное обнаружение** 

Интеллектуальное обнаружение включено в машинном обучении, которое научит закономерности из исторических данных и использует их для обнаружения в будущем. При использовании этого **метода важность является самым** важным параметром для настройки результатов обнаружения. Его можно перетащить к меньшему или большему значению, чтобы повлиять на визуализацию в правой части страницы. Выберите подходящий для ваших данных и сохраните его. 


В режиме интеллектуального обнаружения параметры чувствительности и версии границы используются для точной настройки результатов обнаружения аномалий.

Чувствительность может повлиять на ширину ожидаемого диапазона значений каждой точки. При увеличении ожидаемого диапазона значений будет более строгим, и будет сообщено о нескольких аномалиях:

:::image type="content" source="../media/metrics/smart-detection-high-sensitivity.png" alt-text="Интеллектуальное обнаружение с высоким уровнем чувствительности":::

При выключении чувствительности ожидаемый диапазон значений будет шире и будет сообщено меньше аномалий:

:::image type="content" source="../media/metrics/smart-detection-low-sensitivity.png" alt-text="Интеллектуальное обнаружение с низкой чувствительностью":::

**Изменить порог** 

Пороговое значение изменения обычно используется, когда данные метрик обычно остаются в определенном диапазоне. Пороговое значение устанавливается в соответствии с **процентами изменений**. Режим **изменения порогового значения** способен обнаруживать аномалии в сценариях:

* Обычно данные стабильны и гладкы. Вы хотите получать уведомления при наличии колебаний.
* Как правило, данные довольно нестабильны и имеют большое значение. Вы хотите получать уведомления о том, что она слишком стабильна или плоская.

Чтобы использовать этот режим, выполните следующие действия.

1. Установите флажок **изменить пороговое значение** в качестве метода обнаружения аномалий при настройке конфигураций обнаружения аномалий для метрик или временных рядов.
    
    :::image type="content" source="../media/metrics/change-threshold.png" alt-text="изменить порог":::

2. Выберите **выход из диапазона** или в параметре **Range** в соответствии с вашим сценарием.

    Если вы хотите обнаружить колебания, выберите **выход из диапазона**. Например, в приведенных ниже параметрах точка данных, которая изменяется более 10% по сравнению с предыдущим, будет обнаружена как выброс.
    :::image type="content" source="../media/metrics/out-of-the-range.png" alt-text="параметр вне допустимого диапазона":::

    Если вы хотите обнаружить плоские линии в данных, выберите **диапазон**. Например, в приведенных ниже параметрах точка данных, которая изменяется в пределах 0,01% по сравнению с предыдущим, будет обнаружена как выброс. Так как пороговое значение настолько мало (0,01%), оно обнаруживает плоские линии в данных как выбросы.

    :::image type="content" source="../media/metrics/in-the-range.png" alt-text="В параметре Range":::

3. Задайте процент изменения, которое будет считаться аномалией, и какие ранее полученные точки данных будут использоваться для сравнения. Это сравнение всегда находится между текущей точкой данных и одной точкой данных N точек до нее.
    
    **Направление** допустимо только в том случае, если вы используете режим " **вне диапазона** ":
    
    * **Up** настраивает обнаружение для обнаружения аномалий только в том случае, если (текущая точка данных) — (точка данных сравнения) > **+** порогового значения в процентах.
    * **Настраивает обнаружение** для обнаружения аномалий, только если (текущая точка данных)-(сравнение точки данных) < **-** порогового значения в процентах.
 
**Жесткое пороговое значение**

 Жесткое пороговое значение — это базовый метод обнаружения аномалий. Для определения ожидаемого диапазона значений можно задать верхнюю и/или нижнюю границу. Все точки, находящиеся за пределами границы, будут идентифицированы как аномалия. 


## <a name="preset-events"></a>Предустановленные события

Иногда Ожидаемые события и экземпляры (например, праздники) могут формировать аномальные данные. С помощью предустановленных событий можно добавить флаги к выходным данным обнаружения аномалий в указанное время. Эта функция должна быть настроена после подключения канала данных. Каждая метрика может иметь только одну предустановленную конфигурацию событий.

> [!Note]
> Предустановленная конфигурация событий будет принимать праздники во время обнаружения аномалий и может изменить результаты. Он будет применен к точкам данных, принимаемым после сохранения конфигурации. 

Нажмите кнопку **Configure предустановленное событие** рядом с раскрывающимся списком метрик на каждой странице сведений о метриках.
 
:::image type="content" source="../media/metrics/preset-event-button.png" alt-text="Кнопка события предустановки":::

В появившемся окне настройте параметры в соответствии с использованием. Установите флажок **включить праздничное событие** , чтобы использовать конфигурацию. 

В разделе о **событии праздников** содержатся ненужные аномалии, обнаруженные во время праздников. Существует два варианта использования параметра **стратегия** , который можно применить.

* **Подавлять праздники**: подавляет все аномалии и оповещения в результатах обнаружения аномалий в течение праздничного периода.
* **Праздники как выходные**: вычисляет среднее ожидаемые значения нескольких соответствующих выходных дней до праздничного дня и возвращает состояние аномалии для этих значений.

Существует несколько других значений, которые можно настроить.

|Параметр  |Описание  |
|---------|---------|
|**Выберите одно измерение в качестве страны**     | Выберите измерение, содержащее сведения о стране. Например, код страны.         |
|**Сопоставление кода страны**     | Сопоставление между стандартным [кодом страны](https://wikipedia.org/wiki/ISO_3166-1_alpha-2)и данными о стране выбранного измерения.        |
|**Параметры праздников**    | Следует ли учитывать все праздники, просто переключать (платные) праздники или только нетривиальные праздники.         |
|**Дни для расширения**    |  Затронутые дни до и после праздничного дня.        |


В некоторых сценариях раздел **цикл событий** можно использовать для уменьшения количества ненужных предупреждений с помощью циклических шаблонов в данных. Пример: 

- Метрики, имеющие несколько шаблонов или циклов, например, шаблон еженедельного и ежемесячного. 
- Метрики, которые не имеют четкого шаблона, но данные сравнимы по годам (YoY), месяцу за месяц (MoM), неделе за неделю (WoW) или день в день (DoD).
 
Не все параметры можно выбрать для каждой детализации. Ниже приведены доступные параметры для каждой детализации.

| Степень детализации данных | YoY | Диспетчера | Ой | DoD |
|:-|:-|:-|:-|:-|
| Ежегодно | X | X | X | X |
| Ежемесячно | X | X | X | X |
| Еженедельно | ✔ | X | X | X |
| Ежедневно | ✔ | ✔ | ✔ | X |
| Каждый час | ✔ | ✔ | ✔ | ✔ |
| Точного | X | X | X | X |
| Во-вторых | X | X | X | X |
| Настройки | ✔ | ✔ | ✔ | ✔ |

X-недоступно.  
✔ — Доступно.
  
\* При использовании пользовательской гранулярности в секундах доступна только в том случае, если метрика больше одного часа и меньше одного дня.

Событие цикла используется для сокращения аномалий, если они следуют за циклическим шаблоном, но она сообщит о аномалии, если несколько точек данных не соответствуют шаблону. **Режим "в режиме ограниченного** использования" позволяет включить отчеты об аномалиях, если даже одна точка данных не соответствует шаблону. 

:::image type="content" source="../media/metrics/preset-events.png" alt-text="предустановленная конфигурация событий":::

## <a name="view-recent-incidents"></a>Просмотр недавних инцидентов

Помощник по метрикам обнаруживает аномалии во всех данных временных рядов по мере их приема. Однако не все аномалии должны быть укрупнены, так как они могут не иметь больших последствий. Статистическая обработка будет выполнена для аномалий, чтобы сгруппировать связанные объекты в инциденты. Эти инциденты можно просмотреть на вкладке **инцидент** на странице сведения о метриках. 

Щелкните инцидент, чтобы открыть страницу " **анализ инцидентов** ", где можно просмотреть дополнительные сведения о нем. Щелкните **Управление инцидентами в новом концентраторе инцидентов**, чтобы найти страницу " [концентратор инцидентов](diagnose-incident.md) ", где можно найти все инциденты по определенной метрике. 

## <a name="subscribe-anomalies-for-notification"></a>Подписка на аномалии для уведомления

Если вы хотите получать уведомления при обнаружении аномалии, можно подписываться на предупреждения для метрики с помощью обработчика. Дополнительные сведения см. [в статьях Настройка оповещений и получение уведомлений с помощью обработчика](alerts.md) .


## <a name="next-steps"></a>Дальнейшие действия 
- [Настройка уведомлений и получение уведомлений с использованием перехватчика](alerts.md)
- [Настройка обнаружения аномалий с помощью обратной связи](anomaly-feedback.md)
- [Диагностика инцидента](diagnose-incident.md).

