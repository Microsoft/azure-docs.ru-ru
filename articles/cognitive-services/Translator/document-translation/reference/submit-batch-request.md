---
title: Пакетный запрос на отправку перевода документа
titleSuffix: Azure Cognitive Services
description: Отправка запроса на перевод документа в службу перевода документов.
services: cognitive-services
author: jann-skotdal
manager: nitinme
ms.service: cognitive-services
ms.subservice: translator-text
ms.topic: reference
ms.date: 03/25/2021
ms.author: v-jansk
ms.openlocfilehash: 803a0b9f4496a3d785aa6f22833fee4ae6eca6e0
ms.sourcegitcommit: c94e282a08fcaa36c4e498771b6004f0bfe8fb70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2021
ms.locfileid: "105613096"
---
# <a name="document-translation-submit-batch-request"></a>Перевод документа: отправка пакетного запроса

Этот API используется для отправки пакетного запроса на перевод в службу преобразования документов. Каждый запрос может содержать несколько документов и должен содержать исходный и целевой контейнеры для каждого документа.

Префикс и фильтр суффикса (если он задан) используются для фильтрации папок. Префикс применяется к вложенному пути после имени контейнера.

Память глоссариев и преобразований может быть включена в запрос и применена службой при переводе документа.

Если Глоссарий является недопустимым или недоступным во время перевода, в статусе документа указывается ошибка. Если файл с таким именем уже существует в месте назначения, он будет перезаписан. TargetUrl для каждого целевого языка должны быть уникальными.

## <a name="request-url"></a>URL-адрес запроса

Отправьте запрос `POST` на следующий адрес.
```HTTP
POST https://<NAME-OF-YOUR-RESOURCE>.cognitiveservices.azure.com/translator/text/batch/v1.0-preview.1/batches
```

Узнайте, как найти собственное [доменное имя](../get-started-with-document-translation.md#find-your-custom-domain-name).

> [!IMPORTANT]
>
> * **Для всех запросов API к службе перевода документов требуется Пользовательская конечная точка домена**.
> * Вы не можете использовать конечную точку, найденную в портал Azure _ключах ресурсов и конечной_ точке глобального преобразователя, — `api.cognitive.microsofttranslator.com` для выполнения HTTP-запросов к преобразованию документов.

## <a name="request-headers"></a>Заголовки запросов

Заголовки запроса.

|Заголовки|Описание|
|--- |--- |
|Ocp-Apim-Subscription-Key|Обязательный заголовок запроса|

## <a name="request-body-batch-submission-request"></a>Текст запроса: запрос на отправку пакета

|Имя|Тип|Описание|
|--- |--- |--- |
|Ввод данных|BatchRequest []|BatchRequest, перечисленные ниже. Входной список документов или папок, содержащих документы. Типы носителей: "Application/JSON", "Text/JSON", "Application/* + JSON".|

### <a name="inputs"></a>Входные данные

Определение для запроса на преобразование входного пакета.

|Имя|Тип|Обязательно|Описание|
|--- |--- |--- |--- |
|source|Саурцеинпут []|True|inputs. Source, указанный ниже. Источник входных документов.|
|storageType|Сторажеинпуттипе []|True|входные данные. storageType перечислены ниже. Тип хранилища исходной строки входных документов.|
|целевые объекты|Таржетинпут []|True|входные данные. Целевой объект указан ниже. Расположение назначения для выходных данных.|

**входные данные. источник**

Источник входных документов.

|Имя|Тип|Обязательно|Описание|
|--- |--- |--- |--- |
|фильтр|Документфилтер []|Неверно|Документфилтер [], перечисленные ниже.|
|Filter. prefix|строка|Неверно|Строка префикса с учетом регистра для фильтрации документов в исходном пути для перевода. Например, при использовании URI BLOB-объекта службы хранилища Azure используйте префикс, чтобы ограничить вложенные папки для перевода.|
|Filter. суффикс|строка|Неверно|Строка суффикса с учетом регистра для фильтрации документов в исходном пути для перевода. Чаще всего это используется для расширений файлов.|
|Язык|строка|Неверно|Код языка если параметр не указан, будет выполнено автоматическое обнаружение документа.|
|саурцеурл|строка|True|Расположение папки или контейнера или одного файла с документами.|
|сторажесаурце|сторажесаурце|Неверно|Сторажесаурце, перечисленные ниже.|
|Сторажесаурце. AzureBlob|строка|Неверно||

**inputs. storageType**

Тип хранилища исходной строки входных документов.

|Имя|Тип|
|--- |--- |
|файл|строка|
|folder|строка|

**input. Target**

Назначение для завершенных переведенных документов.

|Имя|Тип|Обязательно|Описание|
|--- |--- |--- |--- |
|категория|строка|Неверно|Категория/настраиваемая система для запроса на перевод.|
|глоссарии|Глоссарий []|Неверно|Глоссарий, приведенный ниже. Список глоссариев.|
|глоссарии. формат|строка|Неверно|Выполните форматирование.|
|глоссарии. Глоссарюрл|строка|True (при использовании глоссариев)|Расположение глоссария. Мы будем использовать расширение файла для извлечения форматирования, если параметр format не указан. Если пара языков перевода отсутствует в глоссарии, она не будет применена.|
|глоссарии. Сторажесаурце|сторажесаурце|Неверно|Сторажесаурце, перечисленные выше.|
|targetUrl|строка|True|Расположение папки или контейнера с документами.|
|Язык|строка|True|Код языка с двумя буквами. См. [список кодов языков](../../language-support.md).|
|сторажесаурце|Сторажесаурце []|Неверно|Сторажесаурце [], перечисленные выше.|
|version|строка|Неверно|Версия.|

## <a name="example-request"></a>Пример запроса

Ниже приведены примеры запросов пакетной службы.

**Перевод всех документов в контейнере**

```json
{
    "inputs": [
        {
            "source": {
                "sourceUrl": https://my.blob.core.windows.net/source-en?sv=2019-12-12&st=2021-03-05T17%3A45%3A25Z&se=2021-03-13T17%3A45%3A00Z&sr=c&sp=rl&sig=SDRPMjE4nfrH3csmKLILkT%2Fv3e0Q6SWpssuuQl1NmfM%3D
            },
            "targets": [
                {
                    "targetUrl": https://my.blob.core.windows.net/target-fr?sv=2019-12-12&st=2021-03-05T17%3A49%3A02Z&se=2021-03-13T17%3A49%3A00Z&sr=c&sp=wdl&sig=Sq%2BYdNbhgbq4hLT0o1UUOsTnQJFU590sWYo4BOhhQhs%3D,
                    "language": "fr"
                }
            ]
        }
    ]
}
```

**Перевод всех документов в контейнере, который применяет глоссарии**

Убедитесь, что вы создали URL-адрес глоссария & маркер SAS для конкретного большого двоичного объекта или документа (не для контейнера).

```json
{
    "inputs": [
        {
            "source": {
                "sourceUrl": https://my.blob.core.windows.net/source-en?sv=2019-12-12&st=2021-03-05T17%3A45%3A25Z&se=2021-03-13T17%3A45%3A00Z&sr=c&sp=rl&sig=SDRPMjE4nfrH3csmKLILkT%2Fv3e0Q6SWpssuuQl1NmfM%3D
            },
            "targets": [
                {
                    "targetUrl": https://my.blob.core.windows.net/target-fr?sv=2019-12-12&st=2021-03-05T17%3A49%3A02Z&se=2021-03-13T17%3A49%3A00Z&sr=c&sp=wdl&sig=Sq%2BYdNbhgbq4hLT0o1UUOsTnQJFU590sWYo4BOhhQhs%3D,
                    "language": "fr"
     "glossaries": [
                        {
                            "glossaryUrl": https://my.blob.core.windows.net/glossaries/en-fr.xlf?sv=2019-12-12&st=2021-03-05T17%3A45%3A25Z&se=2021-03-13T17%3A45%3A00Z&sr=c&sp=rl&sig=BsciG3NWoOoRjOYesTaUmxlXzyjsX4AgVkt2AsxJ9to%3D,
                            "format": "xliff",
                            "version": "1.2"
                        }
                    ]

                }
            ]
        }
    ]
}
```

**Преобразование определенной папки в контейнере**

Убедитесь, что вы указали имя папки (с учетом регистра) в качестве префикса в фильтре, хотя маркер SAS по-прежнему находится в контейнере.

```json
{
    "inputs": [
        {
            "source": {
                "sourceUrl": https://my.blob.core.windows.net/source-en?sv=2019-12-12&st=2021-03-05T17%3A45%3A25Z&se=2021-03-13T17%3A45%3A00Z&sr=c&sp=rl&sig=SDRPMjE4nfrH3csmKLILkT%2Fv3e0Q6SWpssuuQl1NmfM%3D,
                "filter": {
                    "prefix": "MyFolder/"
                }
            },
            "targets": [
                {
                    "targetUrl": https://my.blob.core.windows.net/target-fr?sv=2019-12-12&st=2021-03-05T17%3A49%3A02Z&se=2021-03-13T17%3A49%3A00Z&sr=c&sp=wdl&sig=Sq%2BYdNbhgbq4hLT0o1UUOsTnQJFU590sWYo4BOhhQhs%3D,
                    "language": "fr"
                }
            ]
        }
    ]
}
```

**Преобразование определенного документа в контейнер**

* Убедитесь, что вы указали "storageType": "File"
* Убедитесь, что вы создали URL-адрес источника & маркер SAS для конкретного большого двоичного объекта или документа (не для контейнера).
* Убедитесь, что имя целевого файла указано как часть целевого URL-адреса, хотя маркер SAS по-прежнему находится в контейнере.
* Пример запроса ниже показывает один документ, переведенный на два целевых языка

```json
{
    "inputs": [
        {
            "storageType": "File",
            "source": {
                "sourceUrl": https://my.blob.core.windows.net/source-en/source-english.docx?sv=2019-12-12&st=2021-01-26T18%3A30%3A20Z&se=2021-02-05T18%3A30%3A00Z&sr=c&sp=rl&sig=d7PZKyQsIeE6xb%2B1M4Yb56I%2FEEKoNIF65D%2Fs0IFsYcE%3D
            },
            "targets": [
                {
                    "targetUrl": https://my.blob.core.windows.net/target/try/Target-Spanish.docx?sv=2019-12-12&st=2021-01-26T18%3A31%3A11Z&se=2021-02-05T18%3A31%3A00Z&sr=c&sp=wl&sig=AgddSzXLXwHKpGHr7wALt2DGQJHCzNFF%2F3L94JHAWZM%3D,
                    "language": "es"
                },
                {
                    "targetUrl": https://my.blob.core.windows.net/target/try/Target-German.docx?sv=2019-12-12&st=2021-01-26T18%3A31%3A11Z&se=2021-02-05T18%3A31%3A00Z&sr=c&sp=wl&sig=AgddSzXLXwHKpGHr7wALt2DGQJHCzNFF%2F3L94JHAWZM%3D,
                    "language": "de"
                }
            ]
        }
    ]
}
```

## <a name="response-status-codes"></a>Коды состояния ответа

Ниже приведены возможные коды состояния HTTP, которые возвращает запрос.

|Код состояния|Описание|
|--- |--- |
|202|Принято. Запрос был успешным, и пакетный запрос будет создан службой. Заголовок Operation-Location будет указывать URL-адрес состояния с ИДЕНТИФИКАТОРом операции. Хеадерсоператион-Location: строка|
|400|Недопустимый запрос. Недопустимый запрос. Проверьте входные параметры.|
|401|Не авторизовано. Проверьте свои учетные данные.|
|429|Слишком высокая частота запросов.|
|500|Внутренняя ошибка сервера.|
|503|Служба сейчас недоступна.  Повторите попытку позже.|
|Другие коды состояния|<ul><li>Слишком много запросов</li><li>Сервер временно недоступен</li></ul>|

## <a name="error-response"></a>Сообщение об ошибке

|Имя|Тип|Описание|
|--- |--- |--- |
|code|строка|Перечисления, содержащие коды ошибок высокого уровня. Возможные значения:<br/><ul><li>InternalServerError</li><li>InvalidArgument</li><li>InvalidRequest</li><li>рекуестратетухигх</li><li>ResourceNotFound</li><li>ServiceUnavailable</li><li>Не авторизовано</li></ul>|
|message|строка|Возвращает сообщение об ошибке высокого уровня.|
|innerError|InnerErrorV2|Новый формат внутренней ошибки, который соответствует рекомендациям Cognitive Services API. Он содержит обязательные свойства ErrorCode, Message и необязательные свойства Target, Details (пара значений ключа), внутреннюю ошибку (может быть вложенной).|
|внутреннее. Код ошибки|строка|Возвращает строку ошибки кода.|
|Иннереррор. Message|строка|Возвращает сообщение об ошибке высокого уровня.|

## <a name="examples"></a>Примеры

### <a name="example-successful-response"></a>Пример успешного ответа

При успешном отклике возвращается следующая информация.

Идентификатор задания можно найти в заголовке ответа метода POST Operation-Location значение URL-адреса. Последний параметр URL-адреса — это идентификатор задания операции (строка, следующая как «/Оператион/»).

```HTTP
Operation-Location: https://<NAME-OF-YOUR-RESOURCE>.cognitiveservices.azure.com/translator/text/batch/v1.0.preview.1/operation/0FA2822F-4C2A-4317-9C20-658C801E0E55
```

### <a name="example-error-response"></a>Пример ответа на ошибку

```JSON
{
  "error": {
    "code": "ServiceUnavailable",
    "message": "Service is temporary unavailable",
    "innerError": {
      "code": "ServiceTemporaryUnavailable",
      "message": "Service is currently unavailable.  Please try again later"
    }
  }
}
```

## <a name="next-steps"></a>Дальнейшие действия

Чтобы узнать больше об использовании перевода документов и клиентской библиотеки, следуйте нашим инструкциям в этом кратком руководстве.

> [!div class="nextstepaction"]
> [Приступая к преобразованию документов](../get-started-with-document-translation.md)
