---
title: Планирование приложения — QnA Maker
description: Узнайте, как спланировать приложение QnA Maker. Узнайте, как работает QnA Maker и взаимодействует с другими службами Azure и некоторыми основными понятиями в базе знаний.
ms.service: cognitive-services
ms.subservice: qna-maker
ms.topic: conceptual
ms.date: 11/09/2020
ms.openlocfilehash: e523b35afca33213a40060819a1293e94d413b00
ms.sourcegitcommit: 8c8c71a38b6ab2e8622698d4df60cb8a77aa9685
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2021
ms.locfileid: "99222871"
---
# <a name="plan-your-qna-maker-app"></a>Планирование приложения QnA Maker

Чтобы спланировать QnA Maker приложение, необходимо понять, как QnA Maker работает и взаимодействует с другими службами Azure. Кроме того, у вас должно быть четкое понимание концепций базы знаний.

## <a name="azure-resources"></a>Ресурсы Azure

Каждый [ресурс Azure](azure-resources.md#resource-purposes) , созданный с помощью QnA Maker, имеет определенную цель. Каждый ресурс имеет собственную цель, ограничения и [ценовую категорию](azure-resources.md#pricing-tier-considerations). Важно понимать функции этих ресурсов, чтобы вы могли использовать эти знания в процессе планирования.

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

| Ресурс | Назначение |
|--|--|
| Ресурс [QnA Maker](azure-resources.md#qna-maker-resource) | Создание и прогнозирование запросов |
| Ресурс [когнитивный Поиск](azure-resources.md#cognitive-search-resource) | Хранение и поиск данных |
| Ресурсы службы [приложений и службы плана приложений](azure-resources.md#app-service-and-app-service-plan) | Запрос конечной точки прогнозирования |
| Ресурс [Application Insights](azure-resources.md#application-insights) | Данные телеметрии прогноза запросов |

# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

| Ресурс | Назначение |
|--|--|
| Ресурс [QnA Maker](azure-resources.md#qna-maker-resource) | Создание, конечная точка прогнозирования запросов и данные телеметрии|
| Ресурс [когнитивный Поиск](azure-resources.md#cognitive-search-resource) | Хранение и поиск данных |

---
### <a name="resource-planning"></a>Планирование ресурсов

Уровень "бесплатный" `F0` каждого ресурса работает и может предоставлять как создание, так и прогнозирование запросов. Этот уровень можно использовать для изучения создания и прогнозирования запросов. При переходе к рабочему или динамическому сценарию необходимо повторно оценить выбор ресурсов.

#### <a name="qna-maker-resource"></a>Ресурс QnA Maker

Один ресурс QnA Maker может содержать более одной базы знаний. Количество баз знаний определяется по Когнитивный поиск ценовой категории поддерживаемых индексов. Дополнительные сведения о [связи индексов с базами знаний](azure-resources.md#index-usage).

#### <a name="knowledge-base-size-and-throughput"></a>Размер базы знаний и пропускная способность

Создав реальное приложение, спланируйте достаточные ресурсы для размера базы знаний и ожидаемых запросов прогноза запросов.

Размер базы знаний определяется:
* Ограничения ценовой категории [когнитивный Поиск ресурсов](../../../search/search-limits-quotas-capacity.md)
* [Ограничения QnA Maker](../limits.md)

Запрос прогнозирующего запроса базы знаний управляется планом веб-приложения и веб-приложением. См. [Рекомендуемые параметры](azure-resources.md#recommended-settings) для планирования ценовой категории.

### <a name="resource-sharing"></a>Предоставление общего доступа к ресурсам

Если некоторые из этих ресурсов уже используются, можно рассмотреть возможность совместного использования ресурсов. Узнайте, какие ресурсы [можно использовать совместно](azure-resources.md#share-services-with-qna-maker) с пониманием того, что общий доступ к ресурсам является расширенным сценарием.

Все базы знаний, созданные в том же ресурсе QnA Maker, используют одну и ту же конечную точку прогнозирования **тестовых** запросов.

### <a name="understand-the-impact-of-resource-selection"></a>Общие сведения о влиянии выбора ресурсов

Выбор правильного выбора ресурсов означает, что ваша база знаний успешно отвечает прогнозам запросов.

Если ваша база знаний не работает должным образом, обычно это является проблемой неправильного управления ресурсами.

Неправильное выделение ресурсов требует расследования, чтобы определить, какой [ресурс необходимо изменить](azure-resources.md#when-to-change-a-pricing-tier).

## <a name="knowledge-bases"></a>Базы знаний

База знаний напрямую привязана к ресурсу QnA Maker. Он содержит пары вопросов и ответов (QnA), которые используются для ответа на запросы прогнозирующих запросов.

### <a name="language-considerations"></a>Дополнительные сведения

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

Первая база знаний, созданная в ресурсе QnA Maker, задает язык для ресурса. Для QnA Maker ресурса можно использовать только один язык.

Можно структурировать ресурсы QnA Maker по языку или с помощью [переводчика](../../translator/translator-info-overview.md) , чтобы изменить запрос с другого языка на язык базы знаний перед отправкой запроса в конечную точку прогнозирования запросов.

# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

Теперь вы можете иметь базы знаний на разных языках в одном ресурсе QnA Maker. При создании первой базы знаний можно выбрать, следует ли использовать ресурс для баз знаний на одном языке или на нескольких языках.

![Выбор базы знаний для нескольких языковых версий QnA Maker (Предварительная версия)](../media/concept-plan-your-knowledge-base/qnamaker-v2-select-multilanguage-knowledge-base.png)

> [!NOTE]
> Если вы включили параметры языка для каждой базы знаний, вы не сможете создать столько баз знаний в ресурсе QnA Maker. Дополнительные [сведения об ограничениях языковых параметров](./azure-resources.md).

---

### <a name="ingest-data-sources"></a>Принимающие источники данных

Для создания базы знаний можно использовать один из следующих полученных [источников данных](../Concepts/data-sources-and-content.md) :

* Общедоступный URL-адрес
* Частный URL-адрес SharePoint
* Файл

Процесс приема преобразует [Поддерживаемые типы содержимого](../reference-document-format-guidelines.md) в Markdown. Все дальнейшее редактирование *ответа* выполняется с помощью Markdown. После создания базы знаний можно изменить [пары QnA](question-answer-set.md) на портале QnA Maker с помощью [создания форматированного текста](../how-to/edit-knowledge-base.md#rich-text-editing-for-answer).

### <a name="data-format-considerations"></a>Рекомендации по формату данных

Так как окончательный формат пары QnA — Markdown, важно понимать, какая [Поддержка Markdown](../reference-markdown-format.md).

Связанные изображения должны быть доступны из общедоступного URL-адреса для отображения в области "тест" на портале QnA Maker или в клиентском приложении. QnA Maker не обеспечивает проверку подлинности для содержимого, включая изображения.

### <a name="bot-personality"></a>Индивидуальные роботы

Добавьте в свою базу знаний индивидуальное почтовое робота с помощью [ХИ2ТЕСТ-Chat](../how-to/chit-chat-knowledge-base.md). Эти личные данные поступают с ответами, предоставленными в определенных диалоговых сигналах, таких как *профессиональная* и *удобная*. Этот «ХИ2ТЕСТ-чат» предоставляется в виде набора, который можно добавлять, изменять и удалять.

Если ваш Bot подключается к базе знаний, рекомендуется использовать робота Bot. Вы можете использовать команду ХИ2ТЕСТ-Chat в своей базе знаний, даже если вы также подключаетесь к другим службам, но вам следует ознакомиться с тем, как служба Bot взаимодействует, чтобы узнать, правильно ли используется архитектурный проект.

### <a name="conversation-flow-with-a-knowledge-base"></a>Поток диалоговых данных с базой знаний

Поток диалога обычно начинается с приветствия пользователя, например `Hi` или `Hello` . Ваша база знаний может ответить на общий ответ, например `Hi, how can I help you` на, а также можно выбрать дополнительные запросы для продолжения диалога.

Вы должны разработать свой поток с учетом цикла, чтобы пользователь знал, как использовать робот и не отказался от робота в диалоге. В [дальнейших запросах](../how-to/multiturn-conversation.md) приводятся ссылки между парами QnA, которые позволяют потоку диалога.

### <a name="authoring-with-collaborators"></a>Разработка с помощью участников совместной работы

Участники совместной работы могут быть другими разработчиками, которые совместно используют весь стек разработки приложения базы знаний или могут быть ограничены только созданием базы знаний.

Создание базы знаний поддерживает несколько [разрешений на доступ на основе ролей](../reference-role-based-access-control.md) , которые применяются в портал Azure для ограничения области возможностей участника совместной работы.

## <a name="integration-with-client-applications"></a>Интеграция с клиентскими приложениями

Интеграция с [клиентскими приложениями](../index.yml) выполняется путем отправки запроса в конечную точку среды выполнения прогнозирования. Запрос отправляется в определенную базу знаний с помощью пакета SDK или запроса на основе записи для конечной точки веб-приложения QnA Maker.

Чтобы правильно проверить подлинность запроса клиента, клиентское приложение должно отправить правильные учетные данные и идентификатор базы знаний. Если вы используете службу Azure Bot, настройте эти параметры в составе конфигурации Bot в портал Azure.

### <a name="conversation-flow-in-a-client-application"></a>Поток диалога в клиентском приложении

Для потока диалога в [клиентском приложении](../index.yml), например в Azure Bot, может потребоваться функциональность до и после взаимодействия с базой знаний.

Поддерживает ли клиентское приложение поток разговора, предоставляя альтернативные средства для обработки дальнейших запросов или включая ХИ2ТЕСТ-ХИ2ТЕСТ? Если это так, создайте их на раннем этапе и убедитесь, что запрос клиентского приложения правильно обрабатывается другой службой или отправляется в базу знаний.

### <a name="dispatch-between-qna-maker-and-language-understanding-luis"></a>Отправка между QnA Maker и Распознавание речи (LUIS)

Клиентское приложение может предоставлять несколько функций, только один из которых отвечает базе знаний. Другим функциям по-прежнему необходимо понимать текст в диалоге и извлекать из него значение.

Общая архитектура клиентских приложений заключается в одновременном использовании как QnA Maker, так и [Распознавание речи (Luis)](../../LUIS/what-is-luis.md) . LUIS предоставляет классификацию и извлечение текста для любого запроса, в том числе для других служб. QnA Maker предоставляет ответы из базы знаний.

В таком сценарии с [общей архитектурой механизм](../choose-natural-language-processing-service.md) диспетчеризации между двумя службами достигается с помощью инструмента « [Доставка](https://github.com/Microsoft/botbuilder-tools/tree/master/packages/Dispatch) » из Bot Framework.

### <a name="active-learning-from-a-client-application"></a>Активное обучение из клиентского приложения

QnA Maker использует _активное обучение_ для улучшения базы знаний, предлагая ответы на альтернативные вопросы. Клиентское приложение несет ответственность за участие в этом [активном обучении](active-learning-suggestions.md). С помощью диалоговых запросов клиентское приложение может определить, что база знаний вернула ответ, который не является полезным для пользователя, и он может определить лучший ответ. Клиентское приложение должно [Отправить эту информацию обратно в базу знаний](active-learning-suggestions.md#how-you-give-explicit-feedback-with-the-train-api) , чтобы повысить качество прогноза.

### <a name="providing-a-default-answer"></a>Предоставление ответа по умолчанию

Если база знаний не находит ответ, возвращается _ответ по умолчанию_. Этот ответ можно настроить на странице **Параметры** на портале QnA Maker или в [API-интерфейсах](/rest/api/cognitiveservices/qnamaker/knowledgebase/update#request-body).

Этот ответ по умолчанию отличается от ответа по умолчанию для программы-робота Azure. Вы настраиваете ответ по умолчанию для Azure Bot в портал Azure как часть параметров конфигурации. Он возвращается, когда пороговое значение оценки не достигается.

## <a name="prediction"></a>Прогнозирование

Прогноз — это ответ от базы знаний, который содержит больше информации, чем просто ответ. Для получения ответа прогноза запроса используйте [API женератеансвер](query-knowledge-base.md).

### <a name="prediction-score-fluctuations"></a>Колебания оценки прогноза

Оценка может изменяться в зависимости от нескольких факторов:

* Количество ответов, запрошенных в ответ на [женератеансвер](query-knowledge-base.md) с помощью `top` Свойства
* Различные доступные альтернативные вопросы
* Фильтрация метаданных
* Отправленный запрос `test` или `production` База знаний

Существует [два этапа ранжирования ответов](query-knowledge-base.md#how-qna-maker-processes-a-user-query-to-select-the-best-answer):
- Ранг Когнитивный поиск. Задайте _максимально допустимое количество ответов_ , чтобы получить лучшие ответы, когнитивный Поиск а затем передается в QnA Maker ранжирования.
- Ранг QnA Maker-Second. Примените Добавление признаков и машинное обучение, чтобы определить наилучший ответ.

### <a name="service-updates"></a>Обновления службы

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

Примените [последние обновления среды выполнения](../how-to/set-up-qnamaker-service-azure.md#get-the-latest-runtime-updates) для автоматического управления обновлениями служб.

# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

В QnA Maker Managed (Предварительная версия) среда выполнения управляется самой QnA Makerной службой. Так что обновления службы неприменимы.

---

### <a name="scaling-throughput-and-resiliency"></a>Масштабирование, пропускная способность и устойчивость

Масштабирование, пропускная способность и устойчивость определяются [ресурсами Azure](../how-to/set-up-qnamaker-service-azure.md), их ценовыми категориями и любой окружающей архитектурой, такой как [диспетчер трафика](../how-to/set-up-qnamaker-service-azure.md#business-continuity-with-traffic-manager).

### <a name="analytics-with-application-insights"></a>Аналитика с Application Insights

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

Все запросы к базе знаний хранятся в Application Insights. Используйте наши [лучшие запросы](../how-to/get-analytics-knowledge-base.md) , чтобы понять метрики.

# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

В управляемом развертывании телеметрии предлагается через [службу Azure Monitor](../../../azure-monitor/index.yml). Используйте наши [лучшие запросы](../how-to/get-analytics-knowledge-base.md) , чтобы понять метрики.


---

## <a name="development-lifecycle"></a>Жизненный цикл разработки

[Жизненный цикл разработки](development-lifecycle-knowledge-base.md) базы знаний выполняется непрерывно: Редактирование, тестирование и публикация базы знаний.

### <a name="knowledge-base-development-of-qna-maker-pairs"></a>Разработка базы знаний с парами QnA Maker

[Пары QnA](question-answer-set.md) должны разрабатываться и разрабатываться в зависимости от использования клиентского приложения.

Каждая пара может содержать:
* Возможность фильтрации метаданных при выполнении запросов позволяет помечать пары QnA дополнительными сведениями об источнике, содержимом, форматировании и назначении данных.
* Дальнейшие подсказки. помогает определить путь к базе знаний, чтобы пользователь приступил к нужному ответу.
* Альтернативные вопросы — важно, чтобы поиск соответствовал ответу от различных форм вопроса. [Активные предложения по обучению](active-learning-suggestions.md) включают в себя альтернативные вопросы.

### <a name="devops-development"></a>Разработка DevOps

Для разработки базы знаний для вставки в конвейер DevOps требуется, чтобы база знаний была изолирована во время [пакетного тестирования](../index.yml).

База знаний использует Когнитивный поиск индекс совместно со всеми другими базами знаний в ресурсе QnA Maker. Хотя база знаний изолирована по секциям, совместное использование индекса может привести к разнице в показателях по сравнению с опубликованной базой знаний.

Чтобы получить _одинаковую оценку_ для `test` `production` баз знаний и, изолируйте QnA Maker ресурс к одной базе знаний. В этой архитектуре ресурс должен находиться в режиме реального времени только в том случае, если он является изолированным пакетным тестом.

## <a name="next-steps"></a>Дальнейшие действия

* [Ресурсы Azure](../how-to/set-up-qnamaker-service-azure.md)
* [Пары вопросов и ответов](question-answer-set.md)
