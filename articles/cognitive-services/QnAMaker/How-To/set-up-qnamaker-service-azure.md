---
title: Настройка службы QnA Maker QnA Maker
description: Перед созданием базы знаний службы QnA Maker необходимо настроить эту службу в Azure. Настроить службу QnA Maker может любой пользователь с правами на создание ресурсов в подписке.
ms.service: cognitive-services
ms.subservice: qna-maker
ms.topic: conceptual
ms.date: 11/09/2020
ms.openlocfilehash: b6ab131c0fa81609b956de53f2b15d445e8979dd
ms.sourcegitcommit: f7eda3db606407f94c6dc6c3316e0651ee5ca37c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102219273"
---
# <a name="manage-qna-maker-resources"></a>Управление ресурсами QnA Maker

Перед созданием базы знаний службы QnA Maker необходимо настроить эту службу в Azure. Настроить службу QnA Maker может любой пользователь с правами на создание ресурсов в подписке.

Перед созданием ресурса полезно ознакомиться со следующими концепциями.

* [Ресурсы QnA Maker](../Concepts/azure-resources.md)
* [Создание и публикация ключей](../Concepts/azure-resources.md#keys-in-qna-maker)

## <a name="create-a-new-qna-maker-service"></a>Создание службы QnA Maker

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

Эта процедура создает ресурсы Azure, необходимые для управления содержимым базы знаний. После выполнения этих действий вы найдете ключи _подписки_ на странице **ключи** для ресурса в портал Azure.

1. Войдите в портал Azure и создайте ресурс [QnA Maker](https://ms.portal.azure.com/#create/Microsoft.CognitiveServicesQnAMaker) .

1. Выберите **создать** после прочтения условий:

    ![Создание службы QnA Maker](../media/qnamaker-how-to-setup-service/create-new-resource-button.png)

1. В **QnA Maker** выберите соответствующие уровни и регионы.

    ![Создание службы QnA Maker — ценовая категория и регионы](../media/qnamaker-how-to-setup-service/enter-qnamaker-info.png)

    * В поле **имя** введите уникальное имя для указания этой службы QnA Maker. Это имя также определяет конечную точку QnA Maker, с которой будут связаны базы знаний.
    * Выберите **подписку** , в которой будет развернут ресурс QnA Maker.
    * Выберите **ценовую категорию** для служб управления QnA Maker (API портала и управления). См. [Дополнительные сведения о ценах на SKU](https://aka.ms/qnamaker-pricing).
    * Создайте новую **группу ресурсов** (рекомендуется) или используйте существующую, чтобы развернуть этот QnA Maker ресурс. QnA Maker создает несколько ресурсов Azure. При создании группы ресурсов для хранения этих ресурсов можно легко находить эти ресурсы, управлять ими и удалять их по имени группы ресурсов.
    * Выберите **расположение группы ресурсов**.
    * Выберите **ценовую категорию поиска** для службы когнитивный Поиск Azure. Если параметр уровень Free недоступен (отображается серым цветом), это означает, что у вас уже есть бесплатная служба, развернутая через подписку. В этом случае необходимо начать с уровня "базовый". См. [сведения о ценах на когнитивный Поиск Azure](https://azure.microsoft.com/pricing/details/search/).
    * Выберите **место поиска** , в котором должны развертываться индексы когнитивный Поиск Azure. Ограничения на место хранения данных клиента помогут определить расположение, выбранное для Когнитивный поиск Azure.
    * В поле **имя приложения** введите имя экземпляра службы приложений Azure.
    * По умолчанию служба приложений по умолчанию имеет уровень Standard (S1). Вы можете изменить выбранный план после создания службы. Дополнительные сведения о [ценах на службу приложений](https://azure.microsoft.com/pricing/details/app-service/).
    * Выберите **расположение веб-сайта** , в котором будет развернута служба приложений.

        > [!NOTE]
        > **Расположение поиска** может отличаться от **расположения веб-сайта**.

    * Выберите, следует ли включить **Application Insights**. Если **Application Insights** включена, QnA Maker собирает данные телеметрии по трафику, журналам чата и ошибкам.
    * Выберите **расположение app Insights** , в котором будет развернут ресурс Application Insights.
    * Для экономии затрат вы можете [предоставить общий доступ](configure-QnA-Maker-resources.md#configure-qna-maker-to-use-different-cognitive-search-resource) к некоторым (не всем) ресурсам Azure, созданным для QnA Maker.

1. После проверки всех полей выберите **создать**. Процесс создания может занять несколько минут.

1. После завершения развертывания вы увидите следующие ресурсы, созданные в вашей подписке:

   ![Ресурс, созданный в службе QnA Maker](../media/qnamaker-how-to-setup-service/resources-created.png)

    У ресурса с типом _Cognitive Services_ есть ключи _подписки_ .

# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

Эта процедура создает ресурсы Azure, необходимые для управления содержимым базы знаний. После выполнения этих действий вы найдете ключи *подписки* на странице **ключи** для ресурса в портал Azure.

1. Войдите в портал Azure и создайте ресурс [QnA Maker](https://ms.portal.azure.com/#create/Microsoft.CognitiveServicesQnAMaker) .

1. Выберите **создать** после прочтения условий:

    ![Создание службы QnA Maker](../media/qnamaker-how-to-setup-service/create-new-resource-button.png)

1. В **QnA Maker** установите флажок управляемый (Предварительная версия) и выберите соответствующие уровни и регионы.

    ![Создание новой QnA Maker управляемой службы-ценовая категория и регионы](../media/qnamaker-how-to-setup-service/enter-qnamaker-v2-info.png)

    * Выберите **подписку** , в которой будет развернут ресурс QnA Maker.
    * Создайте новую **группу ресурсов** (рекомендуется) или используйте существующую, в которой будет развернут этот QnA Maker управляемый (предварительный) ресурс. QnA Maker управляемый (Предварительная версия) создает несколько ресурсов Azure. При создании группы ресурсов для хранения этих ресурсов можно легко находить эти ресурсы, управлять ими и удалять их по имени группы ресурсов.
    * В поле **имя** введите уникальное имя, чтобы обозначить эту QnA Maker управляемой службе (Предварительная версия). 
    * Выберите **Расположение** , в котором должна быть развернута служба QnA Maker Managed (Предварительная версия). API управления и конечная точка службы будут размещены в этом расположении. 
    * Выберите **ценовую категорию** для службы QnA Maker Managed (Предварительная версия) (бесплатная для предварительной версии). См. [Дополнительные сведения о ценах на SKU](https://aka.ms/qnamaker-pricing).
    * Выберите **место поиска** , в котором должны развертываться индексы когнитивный Поиск Azure. Ограничения на место хранения данных клиента помогут определить расположение, выбранное для Когнитивный поиск Azure.
    * Выберите **ценовую категорию поиска** для службы когнитивный Поиск Azure. Если параметр уровень Free недоступен (отображается серым цветом), это означает, что у вас уже есть бесплатная служба, развернутая через подписку. В этом случае необходимо начать с уровня "базовый". См. [сведения о ценах на когнитивный Поиск Azure](https://azure.microsoft.com/pricing/details/search/).

1. После проверки всех полей выберите **проверить и создать**. Процесс создания может занять несколько минут.

1. После завершения развертывания вы увидите следующие ресурсы, созданные в вашей подписке:

    ![Ресурс создал новую управляемую службу QnA Maker (Предварительная версия)](../media/qnamaker-how-to-setup-service/resources-created-v2.png)

    У ресурса с типом _Cognitive Services_ есть ключи _подписки_ .

---

## <a name="upgrade-azure-resources"></a>Обновление ресурсов Azure

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

### <a name="upgrade-qna-maker-sku"></a>Обновление SKU QnA Maker

Если вы хотите получить больше вопросов и ответов в базе знаний, помимо текущего уровня, обновите ценовую категорию службы QnA Maker.

Чтобы обновить номер SKU для управления службой QnA Maker, сделайте следующее:

1. Перейдите к ресурсу QnA Maker на портале Azure и выберите **Ценовая категория**.

    ![Ресурс QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-resource.png)

1. Определите соответствующий номер SKU и нажмите **Выбрать**.

    ![Цены на QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-pricing-page.png)
    
### <a name="upgrade-app-service"></a>Обновление службы приложений

Если ваша база знаний должна обслуживать больше запросов из клиентского приложения, обновите ценовую категорию службы приложений.

Вы можете [увеличить](../../../app-service/manage-scale-up.md) или уменьшить масштаб службы приложений.

Перейдите к ресурсу службы приложений в портал Azure и выберите вариант **увеличения** **или уменьшения масштаба,** как требуется.

![Масштабирование службы приложений QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-scale.png)

### <a name="upgrade-the-azure-cognitive-search-service"></a>Обновление службы Когнитивный поиск Azure

Если вы планируете использовать несколько баз знаний, перейдите на ценовую категорию службы "Когнитивный поиск Azure".

Сейчас невозможно выполнить обновление на месте для номера SKU поиска Azure. Но можно создать новый ресурс Поиска Azure с требуемым номером SKU, восстановить туда данные, а затем привязать его к стеку QnA Maker. Для этого выполните следующие действия.

1. Создайте новый ресурс службы "Поиск Azure" в портал Azure и выберите нужный номер SKU.

    ![Ресурс Поиска Azure в QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-azuresearch-new.png)

1. Восстановите индексы из исходного ресурса Поиска Azure на новый. См. [пример кода резервного копирования и восстановления](https://github.com/pchoudhari/QnAMakerBackupRestore).

1. После восстановления данных перейдите к новому ресурсу поиска Azure, выберите **ключи** и запишите **имя** и **ключ администратора**:

    ![Ключи поиска Azure в QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-azuresearch-keys.png)

1. Чтобы связать новый ресурс службы "Поиск Azure" с QnA Makerным стеком, перейдите к QnA Makerному экземпляру служб приложений.

    ![Экземпляр службы приложений QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-resource-list-appservice.png)

1. Выберите **Параметры приложения** и измените настройки поля **AzureSearchName** и **AzureSearchAdminKey** из шага 3.

    ![QnA Maker параметр службы приложений](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-settings.png)

1. Перезапустите экземпляр службы приложений.

    ![Перезапуск экземпляра службы приложений QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-restart.png)
    
### <a name="inactivity-policy-for-free-search-resources"></a>Политика бездействия для бесплатных поисковых ресурсов

Если вы не используете ресурс QnA Maker, удалите все ресурсы. Если вы не удалите неиспользуемые ресурсы, ваша база знаний перестанет работать, если вы создали свободный поисковый ресурс.

Бесплатные ресурсы поиска удаляются через 90 дней без получения вызова API.
    
# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

### <a name="upgrade-the-azure-cognitive-search-service"></a>Обновление службы Когнитивный поиск Azure

Если вы планируете использовать несколько баз знаний, перейдите на ценовую категорию службы "Когнитивный поиск Azure".

Сейчас невозможно выполнить обновление на месте для номера SKU поиска Azure. Но можно создать новый ресурс Поиска Azure с требуемым номером SKU, восстановить туда данные, а затем привязать его к стеку QnA Maker. Для этого выполните следующие действия.

1. Создайте новый ресурс службы "Поиск Azure" в портал Azure и выберите нужный номер SKU.

    ![Ресурс Поиска Azure в QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-azuresearch-new.png)

1. Восстановите индексы из исходного ресурса Поиска Azure на новый. См. [пример кода резервного копирования и восстановления](https://github.com/pchoudhari/QnAMakerBackupRestore).

1. Чтобы связать новый ресурс службы поиска Azure с QnA Maker управляемой (предварительной) службой, см. раздел ниже.

### <a name="inactivity-policy-for-free-search-resources"></a>Политика бездействия для бесплатных поисковых ресурсов

Если вы не используете ресурс QnA Maker, удалите все ресурсы. Если вы не удалите неиспользуемые ресурсы, ваша база знаний перестанет работать, если вы создали свободный поисковый ресурс.

Бесплатные ресурсы поиска удаляются через 90 дней без получения вызова API.

---

## <a name="delete-azure-resources"></a>Удаление ресурсов Azure

Если удалить любой из ресурсов Azure, используемых для ваших баз знаний QnA Maker, базы знаний перестанут работать. Перед удалением любых ресурсов на странице **Настройки** убедитесь, что вы экспортируете свои базы знаний.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о [службе приложений](../../../app-service/index.yml) и службе [поиска](../../../search/index.yml).

> [!div class="nextstepaction"]
> [Узнайте, как создавать другие](../index.yml)
