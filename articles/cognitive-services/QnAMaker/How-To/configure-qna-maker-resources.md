---
title: Настройка службы QnA Maker QnA Maker
description: В этом документе описываются расширенные конфигурации для ресурсов QnA Maker.
ms.service: cognitive-services
ms.subservice: qna-maker
ms.topic: conceptual
ms.date: 02/18/2021
ms.openlocfilehash: 3c6f75eafad51c99f60b78ce49862d2488d5926f
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102220155"
---
# <a name="configure-qna-maker-resources"></a>Настройка ресурсов QnA Maker

Пользователь может настроить QnA Maker для использования другого поискового ресурса. Они также могут настраивать параметры службы приложений, если они используют QnA Maker.

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

### <a name="configure-qna-maker-to-use-different-cognitive-search-resource"></a>Настройка QnA Maker для использования другого Когнитивный поиск ресурса

Если вы создаете службу QnA и ее зависимости (например, поиск) на портале, служба поиска создается и связывается со службой QnA Maker. После создания этих ресурсов можно обновить параметр службы приложений, чтобы использовать ранее существующую службу поиска, и удалить только что созданную.

Ресурс **службы приложений** QnA Maker использует ресурс когнитивный Поиск. Чтобы изменить Когнитивный поиск ресурс, используемый QnA Maker, необходимо изменить параметр в портал Azure.

1. Получите **ключ администратора** и **имя** ресурса когнитивный Поиск, который QnA Maker будет использовать.

1. Войдите в [портал Azure](https://portal.azure.com) и найдите **службу приложений** , связанную с ресурсом QnA Maker. Оба с имеют одинаковое имя.

1. Выберите **Параметры**, а затем **Конфигурация**. Отобразятся все существующие параметры для службы приложений QnA Maker.

    > [!div class="mx-imgBorder"]
    > ![Снимок экрана портал Azure отображение параметров конфигурации службы приложений](../media/qnamaker-how-to-upgrade-qnamaker/change-search-service-app-service-configuration.png)

1. Измените значения для следующих ключей:

    * **азуресеарчадминкэй**
    * **азуресеарчнаме**

1. Чтобы использовать новые параметры, необходимо перезапустить службу приложений. Выберите **Обзор**, а затем щелкните **перезапустить**.

    > [!div class="mx-imgBorder"]
    > ![Снимок экрана портал Azure перезапуска службы приложений после изменения параметров конфигурации](../media/qnamaker-how-to-upgrade-qnamaker/screenshot-azure-portal-restart-app-service.png)

При создании службы QnA с помощью шаблонов Azure Resource Manager можно создать все ресурсы и управлять созданием службы приложений для использования существующей службы поиска.

Дополнительные сведения о настройке [параметров приложения](../../../app-service/configure-common.md#configure-app-settings)службы приложений.

### <a name="get-the-latest-runtime-updates"></a>Получение последних обновлений среды выполнения

Среда выполнения QnAMaker является частью экземпляра службы приложений Azure, который разворачивается при [создании службы QnAMaker](./set-up-qnamaker-service-azure.md) в портал Azure. Периодически устанавливаются обновления для этой среды выполнения. QnA Maker экземпляр службы приложений находится в режиме автоматического обновления после выпуска расширения сайта от апреля 2019 (версия 5 +). Это обновление предназначено для того, чтобы принимать во внимание время простоя при обновлении.

Текущую версию можно проверить по адресу https://www.qnamaker.ai/UserSettings . Если версия старше версии 5. x, необходимо перезапустить службу приложений, чтобы установить последние обновления:

1. Перейдите к службе QnAMaker (Группа ресурсов) в [портал Azure](https://portal.azure.com).

    > [!div class="mx-imgBorder"]
    > ![Группа ресурсов Azure для QnA Maker](../media/qnamaker-how-to-troubleshoot/qnamaker-azure-resourcegroup.png)

1. Выберите экземпляр службы приложений и откройте раздел **Обзор** .

    > [!div class="mx-imgBorder"]
    > ![Экземпляр службы приложений QnAMaker](../media/qnamaker-how-to-troubleshoot/qnamaker-azure-appservice.png)


1. Перезапустите службу приложений. Процесс обновления должен завершиться через пару секунд. Все зависимые приложения или программы-роботы, использующие эту службу QnAMaker, будут недоступны конечным пользователям в течение этого периода перезапуска.

    ![Перезапуск экземпляра службы приложений QnAMaker](../media/qnamaker-how-to-upgrade-qnamaker/qnamaker-appservice-restart.png)

### <a name="configure-app-service-idle-setting-to-avoid-timeout"></a>Настройте параметр простоя службы приложений, чтобы избежать истечения времени ожидания

Служба приложений, которая обслуживает QnA Makerную среду выполнения прогнозирования для опубликованной базы знаний, имеет настройку времени ожидания простоя, которая по умолчанию автоматически истечет, если служба бездействует. Для QnA Maker это означает, что время ожидания API-интерфейса Женератеансвер среды выполнения прогнозирующих событий истекло после периодов отсутствия трафика.

Чтобы приложение прогнозной конечной точки загружалось даже при отсутствии трафика, установите для параметра Idle значение Always on.

1. Войдите на [портал Azure](https://portal.azure.com).
1. Найдите и выберите службу приложений для QnA Maker ресурса. Он будет иметь то же имя, что и ресурс QnA Maker, но будет иметь другой **тип** службы приложений.
1. Найдите **Параметры** и выберите **Конфигурация**.
1. На панели конфигурация выберите **Общие параметры**, найдите **Always on** и выберите **в** качестве значения.

    > [!div class="mx-imgBorder"]
    > ![На панели конфигурация выберите * * Общие параметры * *, затем найдите * * Always on * * и выберите в качестве значения * * on * *.](../media/qnamaker-how-to-upgrade-qnamaker/configure-app-service-idle-timeout.png)

1. Нажмите кнопку **сохранить** , чтобы сохранить конфигурацию.
1. Вам будет предложено перезапустить приложение, чтобы использовать новый параметр. Выберите **Continue** (Продолжить).

Дополнительные сведения о настройке [общих параметров](../../../app-service/configure-common.md#configure-general-settings)службы приложений.

### <a name="business-continuity-with-traffic-manager"></a>Непрерывность бизнес-процессов с помощью диспетчера трафика

Основная цель плана обеспечения непрерывности бизнес-процессов — создание отказоустойчивой конечной точки базы знаний, которая обеспечит отсутствие простоев бота или приложения, которые его используют.

> [!div class="mx-imgBorder"]
> ![План по обеспечению непрерывности бизнес-процессов для QnA Maker](../media/qnamaker-how-to-bcp-plan/qnamaker-bcp-plan.png)

В общих чертах для воплощения представленной выше концепции нужно сделать следующее:

1. Настройте две параллельные [службы QnA Maker](set-up-qnamaker-service-azure.md) в [сопряженных регионах Azure](../../../best-practices-availability-paired-regions.md).

1. [Создайте резервную копию](../../../app-service/manage-backup.md) основной службы приложений QnA Maker и [восстановите](../../../app-service/web-sites-restore.md) ее во вторичной установке. Это обеспечит работу обеих настроек с одним и тем же именем узла и ключами.

1. Обеспечьте синхронизацию основного и дополнительного индексов поиска Azure. Используйте образец GitHub [здесь](https://github.com/pchoudhari/QnAMakerBackupRestore) , чтобы узнать, как выполнить резервное копирование для восстановления индексов Azure.

1. Создайте резервную копию Application Insights с помощью [непрерывного экспорта](../../../azure-monitor/app/export-telemetry.md).

1. После настройки первичного и вторичного стеков воспользуйтесь [диспетчером трафика](../../../traffic-manager/traffic-manager-overview.md) для настройки двух конечных точек и метода маршрутизации.

1. Вам потребуется создать протокол TLS, ранее известный как SSL (SSL), сертификат для конечной точки диспетчера трафика. [Привяжите сертификат TLS/SSL](../../../app-service/configure-ssl-bindings.md) в службах приложений.

1. Наконец, используйте конечную точку диспетчера трафика в боте или приложении.

# <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

### <a name="configure-qna-maker-managed-preview-service-to-use-different-cognitive-search-resource"></a>Настройка службы QnA Maker Managed (Предварительная версия) для использования другого Когнитивный поиск ресурса

Если вы создаете службу QnA, управляемую (Предварительная версия), и ее зависимости (например, поиск) на портале, служба поиска создается и связывается с QnA Maker управляемой (предварительной) службой. После создания этих ресурсов можно обновить службу поиска на вкладке **Конфигурация** .

1. Перейдите в службу QnA Maker Managed (Предварительная версия) в портал Azure.

1. Выберите **Конфигурация** и выберите службу когнитивный Поиск Azure, которую необходимо связать с вашей QnA Maker управляемой службой (Предварительная версия).

    ![Снимок экрана: страница настройки управляемого (Предварительная версия) QnA Maker](../media/qnamaker-how-to-upgrade-qnamaker/change-search-service-configuration.png)

1. Выберите команду **Сохранить**.

> [!NOTE]
> Если вы измените службу поиска Azure, связанную с QnA Maker, вы потеряли доступ ко всем уже имеющимся в ней базам знаний. Перед изменением службы поиска Azure обязательно экспортируйте существующие базы знаний.

---
