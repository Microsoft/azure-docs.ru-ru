---
title: Сетевая изоляция
description: Пользователи могут ограничить общий доступ к ресурсам QnA Maker.
ms.service: cognitive-services
ms.subservice: qna-maker
ms.topic: conceptual
ms.date: 11/09/2020
ms.openlocfilehash: afb396bc364a2fa2db923fbcbe6bfe1b7aedbc26
ms.sourcegitcommit: 3ea12ce4f6c142c5a1a2f04d6e329e3456d2bda5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103467550"
---
# <a name="recommended-settings-for-network-isolation"></a>Рекомендуемые параметры для сетевой изоляции

Чтобы ограничить общий доступ к ресурсам QnA Maker, выполните следующие действия. Защитите ресурс Cognitive Services от общего доступа, [настроив виртуальную сеть](../../cognitive-services-virtual-networks.md?tabs=portal).

## <a name="restrict-access-to-app-service-qna-runtime"></a>Ограничение доступа к службе приложений (среда выполнения QnA)

Вы можете добавить IP-адреса в список разрешений службы приложений, чтобы ограничить доступ или настроить Среда службы приложений для размещения службы приложений QnA Maker.

#### <a name="add-ips-to-app-service-allow-list"></a>Добавление IP-адресов в список разрешений службы приложений

1. Разрешать трафик только с Cognitive Services IP-адресов. Они уже включены в тег службы `CognitiveServicesManagement` . Это необходимо для создания API-интерфейсов (создания или обновления базы знаний), чтобы вызвать службу приложений и соответствующим образом обновить службу поиска Azure. Ознакомьтесь с [дополнительными сведениями о тегах служб.](../../../virtual-network/service-tags-overview.md)
2. Убедитесь, что вы также Разрешите другим точкам входа, таким как служба Azure Bot, QnA Maker портал и т. д., для доступа к API прогнозирования "Женератеансвер".
3. Чтобы добавить диапазоны IP-адресов в список разрешений, выполните следующие действия:

   1. Скачайте [диапазоны IP-адресов для всех тегов служб](https://www.microsoft.com/download/details.aspx?id=56519).
   2. Выберите IP-адреса для "Когнитивесервицесманажемент".
   3. Перейдите к разделу сети ресурса службы приложений и выберите параметр "настроить ограничение доступа", чтобы добавить IP-адреса в список разрешений.

Кроме того, у нас есть автоматизированный сценарий для того, чтобы сделать то же самое для службы приложений. Вы можете найти [сценарий PowerShell для настройки списка разрешений](https://github.com/pchoudhari/QnAMakerBackupRestore/blob/master/AddRestrictedIPAzureAppService.ps1) на GitHub. Необходимо ввести идентификатор подписки, группу ресурсов и фактическое имя службы приложений в качестве параметров скрипта. При выполнении скрипта автоматически добавляются IP-адреса в список разрешений службы приложений.

#### <a name="configure-app-service-environment-to-host-qna-maker-app-service"></a>Настройка Среда службы приложений для размещения службы приложений QnA Maker
    
Среда службы приложений (ASE) можно использовать для размещения службы приложений QnA Maker. Выполните следующие действия.

1. Создайте Среда службы приложений и пометьте ее как "внешний". Инструкции см. в [руководстве](../../../app-service/environment/create-external-ase.md) .
2.  Создайте службу приложений в Среда службы приложений.
    1. Проверьте конфигурацию службы приложений и добавьте "Примарендпоинткэй" в качестве параметра приложения. Для параметра "Примарендпоинткэй" должно быть задано значение " \<app-name\> -примарендпоинткэй". Имя приложения определяется в URL-адресе службы приложений. Например, если URL-адрес службы приложений имеет значение "mywebsite.myase.p.azurewebsite.net", то имя приложения — "mywebsite". В этом случае для параметра "Примарендпоинткэй" должно быть задано значение "mywebsite-Примарендпоинткэй".
    2. Создайте службу поиска Azure.
    3. Убедитесь, что параметры поиска Azure и приложения настроены соответствующим образом. 
          Следуйте указаниям в этом [руководстве](../reference-app-service.md?tabs=v1#app-service).
3.  Обновите группу безопасности сети, связанную с Среда службы приложений
    1. Обновите предварительно созданные правила безопасности для входящего трафика в соответствии с вашими требованиями.
    2. Добавьте новое правило безопасности входящего трафика с исходным кодом как тег службы и тегом исходной службы как "Когнитивесервицесманажемент".
       
    ![исключения входящих портов](../media/inbound-ports.png)

4.  Создайте QnA Makerный экземпляр службы (Microsoft. CognitiveServices/Accounts) с помощью Azure Resource Manager, где QnA Maker конечной точке должна быть установлена конечная точка службы приложений, созданная выше (https://mywebsite.myase.p.azurewebsite.net).
    
---

## <a name="restrict-access-to-cognitive-search-resource"></a>Ограничение доступа к Когнитивный поиск ресурсу

# <a name="qna-maker-ga-stable-release"></a>[Общедоступная версия QnA Maker (стабильный выпуск)](#tab/v1)

Когнитивный поиск экземпляр можно изолировать через закрытую конечную точку после создания ресурсов QnA Maker. Для подключений к частным конечным точкам требуется виртуальная сеть, через которую можно получить доступ к экземпляру Служба поиска. 

Если служба QnA Maker приложений ограничена с помощью Среда службы приложений, используйте ту же виртуальную сеть для создания подключения к закрытой конечной точке для экземпляра Когнитивный поиск. Создайте новую запись DNS в виртуальной сети, чтобы связать конечную точку Когнитивный поиск с IP-адресом Когнитивный поиск частной конечной точки. 

Если Среда службы приложений не используется для службы приложений QnAMaker, сначала создайте новый ресурс виртуальной сети, а затем создайте подключение к закрытой конечной точке для экземпляра Когнитивный поиск. В этом случае необходимо интегрировать службу приложений QnA Maker [с виртуальной](https://docs.microsoft.com/azure/app-service/web-sites-integrate-with-vnet) сетью для подключения к экземпляру когнитивный Поиск. 

#  <a name="qna-maker-managed-preview-release"></a>[Управляемая служба QnA Maker (предварительный выпуск)](#tab/v2)

[Создайте частные конечные точки](../reference-private-endpoint.md) для ресурса поиска Azure.

---
