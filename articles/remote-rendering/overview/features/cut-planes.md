---
title: Вырезание плоскостей
description: Описывается, что представляют из себя сечения и как их использовать.
author: jakrams
ms.author: jakras
ms.date: 02/06/2020
ms.topic: article
ms.custom: devx-track-csharp
ms.openlocfilehash: b3348e5a999b507aa0d286528970beb0e03f26cd
ms.sourcegitcommit: f377ba5ebd431e8c3579445ff588da664b00b36b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2021
ms.locfileid: "99594378"
---
# <a name="cut-planes"></a>Вырезание плоскостей

*Сечение* — это визуальная функция, которая обрезает пиксели с одной стороны виртуальной плоскости, показывая срез [сетки](../../concepts/meshes.md).
Эффект показан на рисунке ниже. Слева показана исходная сетка, а справа можно увидеть, что находится внутри.

![Сечение](./media/cutplane-1.png)

## <a name="cutplanecomponent"></a>CutPlaneComponent

Чтобы добавить сечение в сцену, создайте объект *CutPlaneComponent*. Расположение и ориентация плоскости определяются [сущностью](../../concepts/entities.md) владельца компонента.

```cs
void CreateCutPlane(RenderingSession session, Entity ownerEntity)
{
    CutPlaneComponent cutPlane = (CutPlaneComponent)session.Connection.CreateComponent(ObjectType.CutPlaneComponent, ownerEntity);
    cutPlane.Normal = Axis.X; // normal points along the positive x-axis of the owner object's orientation
    cutPlane.FadeColor = new Color4Ub(255, 0, 0, 128); // fade to 50% red
    cutPlane.FadeLength = 0.05f; // gradient width: 5cm
}
```

```cpp
void CreateCutPlane(ApiHandle<RenderingSession> session, ApiHandle<Entity> ownerEntity)
{
    ApiHandle<CutPlaneComponent> cutPlane = session->Connection()->CreateComponent(ObjectType::CutPlaneComponent, ownerEntity)->as<CutPlaneComponent>();;
    cutPlane->SetNormal(Axis::X); // normal points along the positive x-axis of the owner object's orientation
    Color4Ub fadeColor;
    fadeColor.channels = { 255, 0, 0, 128 }; // fade to 50% red
    cutPlane->SetFadeColor(fadeColor);
    cutPlane->SetFadeLength(0.05f); // gradient width: 5cm
}
```

### <a name="cutplanecomponent-properties"></a>Свойства CutPlaneComponent

Компонент сечения имеет перечисленные ниже свойства.

* `Enabled`: Сечения можно временно отключать, отключая компонент. Отключенные сечения не требуют затрат на отрисовку, а также не включаются в общее количество сечений.

* `Normal`: Указывает, какое направление (+X,-X,+Y,-Y,+Z,-Z) используется в качестве нормали к плоскости. Это направление определяется относительно ориентации сущности владельца. Для точного размещения переместите и поверните сущность владельца.

* `FadeColor` и `FadeLength`:

  Если альфа-значение *FadeColor* не равно нулю, пиксели, находящиеся близко к сечению, будут выцветать в направлении компонента RGB FadeColor. Интенсивность альфа-канала определяет то, будут ли пиксели выцветать до выбранного цвета полностью или частично. *FadeLength* определяет расстояние, на котором будет происходить выцветание.

* `ObjectFilterMask`: Битовая маска фильтра, определяющая геометрию, на которую влияет вырезанная плоскость. Подробные сведения см. в следующем абзаце.

### <a name="selective-cut-planes"></a>Выборочная вырезание плоскостей

Можно настроить отдельные вырезанные плоскости таким образом, чтобы они влияли только на определенную геометрию. На следующем рисунке показано, как эта программа установки может выглядеть на практике.

![Выборочная вырезание плоскостей](./media/selective-cut-planes.png)

Фильтрация выполняется с помощью **логического сравнения битовой** маски между битовой рамкой на стороне вырезанной плоскости и второй битовой маской, заданной для геометрии. Если результат логической `AND` операции между масками не равен нулю, то плоскость вырезания будет влиять на геометрию.

* Битовая маска на компоненте "вырезать плоскость" задается через его `ObjectFilterMask` свойство
* Битовая маска в подиерархии геометрических объектов задается с помощью [хиерарчикалстатеоверридекомпонент](override-hierarchical-state.md#features)

Примеры

| Вырезать маску фильтра плоскости | Маска фильтра геометрии  | Результат логического `AND` | Вырезать плоскость влияет на геометрию?  |
|--------------------|-------------------|-------------------|:----------------------------:|
| (0000 0001) = = 1   | (0000 0001) = = 1  | (0000 0001) = = 1  | Да |
| (1111 0000) = = 240 | (0001 0001) = = 17 | (0001 0000) = = 16 | Да |
| (0000 0001) = = 1   | (0000 0010) = = 2  | (0000 0000) = = 0  | Нет |
| (0000 0011) = = 3   | (0000 1000) = = 8  | (0000 0000) = = 0  | Нет |

>[!TIP]
> Если задать значение 0 для вырезанной плоскости, `ObjectFilterMask` это не повлияет на геометрию, так как результат логического `AND` не может иметь значение, отличное от NULL. Система отрисовки не рассчитаем эти плоскости в первую очередь, поэтому это упрощенный метод отключения отдельных плоскостей. Эти вырезанные плоскости также не учитываются с ограничением в 8 активных плоскостей.

## <a name="limitations"></a>Ограничения

* Удаленная визуализация Azure поддерживает не более **восьми активных повырезанных плоскостей**. Создать можно и больше, но если вы попытаетесь включить одновременно больше восьми, этого не произойдет. Сначала отключите другие плоскости, если хотите переключить, какие компоненты должны повлиять на сцену.
* Вырезание плоскостей — это некоторая визуальная функция, которая не влияет на результат [пространственных запросов](spatial-queries.md). Если вы хотите выполнить пересечение лучом применительно к сетке с сечением, можно настроить начальную точку луча так, чтобы она находилась на сечении. В результате луч сможет падать только на видимые части.

## <a name="performance-considerations"></a>Вопросы производительности

На отрисовку каждого активного сечения требуются некоторые затраты ресурсов. Отключайте или удаляйте сечения, если они больше не нужны.

## <a name="api-documentation"></a>Документирование API

* [Класс C# Кутпланекомпонент](/dotnet/api/microsoft.azure.remoterendering.cutplanecomponent)
* [Класс C++ Кутпланекомпонент](/cpp/api/remote-rendering/cutplanecomponent)

## <a name="next-steps"></a>Дальнейшие действия

* [Односторонняя отрисовка](single-sided-rendering.md)
* [Пространственные запросы](spatial-queries.md)