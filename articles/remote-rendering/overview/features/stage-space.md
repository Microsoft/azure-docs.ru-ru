---
title: Промежуточное пространство
description: Описывает параметры промежуточного пространства и варианты использования
author: christophermanthei
ms.author: chmant
ms.date: 03/07/2020
ms.topic: article
ms.custom: devx-track-csharp
ms.openlocfilehash: 4a739907ce0a3b0b6dfcb8791b51d0ea5e7e76e7
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99594016"
---
# <a name="stage-space"></a>Промежуточное пространство

При запуске программы ARR на устройстве, предоставляющем данные для отслеживания головного устройства, такие как HoloLens 2, Главная ячейка отправляется как пользовательскому приложению, так и серверу. Пространство, в котором определено головное преобразование, называется *пространством этапа*.

Чтобы согласовать локальное и удаленное содержимое, предполагается, что пространство этапа и мировое пространство идентичны как на клиенте, так и на сервере. Если пользователь решает добавить дополнительное преобразование поверх камеры, он должен быть отправлен на сервер, а также для правильного согласования локального и удаленного содержимого.

Типичными причинами для перемещения пространства этапа являются [средства блокировки мира](https://microsoft.github.io/MixedReality-WorldLockingTools-Unity/README.html) или другие методики прикрепления, а также перемещение виртуального символа в режиме VR.

## <a name="stage-space-settings"></a>Параметры пространства этапа

> [!CAUTION]
> ЭКСПЕРИМЕНТАЛЬная. Эта функция экспериментальна и со временем будет меняться. Поэтому обновление до более новых версий клиентских пакетов SDK может потребовать дополнительной работы для обновления кода. Текущая реализация приведет к нарушению выравнивания локального или удаленного содержимого в течение короткого промежутка времени при изменении начала этапа.
Таким образом, в настоящее время он предназначен только для использования в целях блокировки в мире, таких как привязки, которые демонстрируют очень небольшие изменения с течением времени.

Чтобы сообщить серверу о том, что к пространству этапа применяется дополнительное преобразование, его источник, определенный положением, и поворот в мировом пространстве, необходимо пересылать. Доступ к этому параметру можно получить через *параметр промежуточного пространства*.

> [!IMPORTANT]
> В [модели настольных компьютеров](../../concepts/graphics-bindings.md) пользовательское приложение предоставляет доступ к мировому расположению камеры. В этом случае необходимо пропустить настройку начала пространства этапа, так как она уже умножается на преобразование камеры.

```cs
void ChangeStageSpace(RenderingSession session)
{
    StageSpaceSettings settings = session.Connection.StageSpaceSettings;

    // Set position and rotation to the world-space transform of the stage space.
    settings.Position = new Double3(0, 0, 0);
    settings.Rotation = new Quaternion(0, 0, 0, 1);
}
```

```cpp
void ChangeStageSpace(ApiHandle<RenderingSession> session)
{
    ApiHandle<StageSpaceSettings> settings = session->Connection()->GetStageSpaceSettings();

    // Set position and rotation to the world-space transform of the stage space.
    settings->SetPosition({0, 0, 0});
    settings->SetRotation({0, 0, 0, 1});
}
```

## <a name="unity-stage-space-script"></a>Сценарий временного пространства Unity

Интеграция Unity предоставляет скрипт с именем **стажеспаце** , который можно добавить к родительскому GameObjectу камеры. После этого скрипт позаботится о настройке источника пространства этапа.

## <a name="next-steps"></a>Дальнейшие действия

* [Графическая привязка](../../concepts/graphics-bindings.md)
* [Перепроецирование на позднем этапе](late-stage-reprojection.md)
