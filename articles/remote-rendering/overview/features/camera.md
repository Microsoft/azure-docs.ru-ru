---
title: Камера
description: Описание параметров и вариантов использования камеры
author: christophermanthei
ms.author: chmant
ms.date: 03/07/2020
ms.topic: article
ms.openlocfilehash: dbe86313054706af974ccb324a39e942e9b5ca44
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99594135"
---
# <a name="camera"></a>Камера

Чтобы убедиться, что локальное и удаленно визуализированное содержимое можно легко составить, необходимо синхронизировать различные свойства камеры между сервером и клиентом. В особенности это преобразование и проекция камеры. Например, локально визуализированное содержимое должно использовать то же преобразование и проекцию камеры, что и последняя Удаленная рамка.

![Локальная и удаленная Камера](./media/camera.png)

На приведенном выше рисунке локальная Камера была перемещена по сравнению с удаленной рамкой, отправленной сервером. В результате локальное содержимое должно быть визуализировано с той же перспективы, что и удаленный кадр, и, наконец, полученный образ переносится в локальное пространство камеры, что подробно объясняется в разделе Переработка [позднего этапа](late-stage-reprojection.md).

Задержка между удаленной и локальной визуализациями означает, что любые изменения этих параметров применяются с задержкой. Таким образом, любое новое значение не может использоваться сразу же и в одном кадре.

В параметрах камеры можно задать расстояния близко и далеко. В HoloLens 2 оставшиеся данные преобразования и проекции определяются оборудованием. При использовании [модели рабочего стола](../../concepts/graphics-bindings.md)они задаются с помощью входных данных своей `Update` функции.

Измененные значения можно использовать локально сразу после поступления первого удаленного кадра, который был визуализирован вместе с ними. В HoloLens 2 данные, используемые для отрисовки, предоставляются *холографикфраме* , как и в любом другом holographic приложении. При [моделировании настольных систем](../../concepts/graphics-bindings.md)они извлекаются с помощью выходных данных `Update` функции.

## <a name="camera-settings"></a>Параметры камеры

В параметрах камеры можно изменить следующие свойства:

**Ближайшее и далекое плоскость:**

Чтобы гарантировать, что недопустимые диапазоны не могут быть заданы, свойства **неарплане** и **фарплане** доступны только для чтения, а отдельная функция **сетнеарандфарплане** существует для изменения диапазона. Эти данные будут отправлены на сервер в конце кадра. При задании этих значений **неарплане** должно быть меньше **фарплане**. В противном случае возникнет ошибка.

> [!IMPORTANT]
> В Unity это происходит автоматически при изменении основной камеры вблизи и дальней плоскости.

**Енабледепс**:

Иногда бывает полезно отключить запись буфера глубины удаленного образа для целей отладки. Отключение глубины также останавливает сервер на отправку данных глубины, уменьшая таким образом пропускную способность.

> [!TIP]
> В Unity предоставляется компонент отладки с именем **енабледепскомпонент** , который может использоваться для переключения этой функции в пользовательском интерфейсе редактора.

**Инверседепс**:

> [!NOTE]
> Этот параметр важен только в том случае, если для параметра задано `EnableDepth` значение `true` . В противном случае этот параметр не оказывает влияния.

Буферы глубины обычно записывают значения z в диапазоне с плавающей запятой [0; 1], 0 отмечает глубину ближней плоскости и 1 отмечает глубину дальней плоскости. Кроме того, можно инвертировать этот диапазон и значения глубины записи в диапазоне [1; 0], то есть глубина ближней плоскости становится 1, а глубина дальней плоскости становится равной 0. Как правило, последний улучшает распределение точности с плавающей запятой по нелинейному z-диапазону.

> [!WARNING]
> Распространенный подход заключается в инвертировании значений ближней плоскости и дальней плоскости для объектов Camera. При попытке выполнить удаленную визуализацию Azure с ошибкой произойдет ошибка `CameraSettings` .

API удаленной подготовки к просмотру Azure должен узнать о соответствии соглашениям о буфере глубины локального модуля подготовки отчетов о том, чтобы правильно составить глубину удаленной передачи в локальный буфер глубины. Если диапазон буфера глубины равен [0; 1], оставьте этот флаг как `false` . Если используется инвертированный буфер глубины с диапазоном [1; 0], установите `InverseDepth` для флага значение `true` .

> [!NOTE]
> Для Unity правильный параметр уже применен, `RenderingConnection` поэтому нет необходимости в ручном вмешательстве.

Изменение параметров камеры можно выполнить следующим образом.

```cs
void ChangeCameraSetting(RenderingSession session)
{
    CameraSettings settings = session.Connection.CameraSettings;

    settings.SetNearAndFarPlane(0.1f, 20.0f);
    settings.EnableDepth = false;
    settings.InverseDepth = false;
}
```

```cpp
void ChangeCameraSetting(ApiHandle<RenderingSession> session)
{
    ApiHandle<CameraSettings> settings = session->Connection()->GetCameraSettings();

    settings->SetNearAndFarPlane(0.1f, 20.0f);
    settings->SetEnableDepth(false);
    settings->SetInverseDepth(false);
}
```

## <a name="api-documentation"></a>Документирование API

* [Камерасеттингс C#](/dotnet/api/microsoft.azure.remoterendering.camerasettings)
* [Камерасеттингс C++](/cpp/api/remote-rendering/camerasettings)
* [C# GraphicsBindingSimD3d11. Update, функция](/dotnet/api/microsoft.azure.remoterendering.graphicsbindingsimd3d11.update)
* [Функция C++ GraphicsBindingSimD3d11:: Update](/cpp/api/remote-rendering/graphicsbindingsimd3d11#update)

## <a name="next-steps"></a>Дальнейшие действия

* [Графическая привязка](../../concepts/graphics-bindings.md)
* [Перепроецирование на позднем этапе](late-stage-reprojection.md)