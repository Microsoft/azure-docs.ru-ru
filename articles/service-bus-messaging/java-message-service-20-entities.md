---
title: Обмен сообщениями служебной шины Azure — сущности службы сообщений Java
description: В этой статье представлен обзор сущностей обмена сообщениями служебной шины Azure, доступных через API службы сообщений Java.
ms.topic: article
ms.date: 07/20/2020
ms.openlocfilehash: ee4e0124dced16b86d5292c647e129aa87645f22
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100652587"
---
# <a name="java-message-service-jms-20-entities"></a>Сущности в службе сообщений Java (JMS) версии 2.0

Клиентские приложения, подключающиеся к версии Premium служебной шины Azure и использующие [БИБЛИОТЕКУ JMS служебной шины Azure](https://search.maven.org/artifact/com.microsoft.azure/azure-servicebus-jms) , могут использовать указанные ниже сущности.

## <a name="queues"></a>Очереди

Очереди в JMS семантически сравнимы с традиционными [очередями служебной шины](service-bus-queues-topics-subscriptions.md#queues).

Чтобы создать очередь, используйте приведенные ниже методы класса. `JMSContext`

```java
Queue createQueue(String queueName)
```

## <a name="topics"></a>Разделы

Разделы в JMS семантически сравнимы с традиционными [разделами служебной шины](service-bus-queues-topics-subscriptions.md#topics-and-subscriptions).

Чтобы создать раздел, используйте приведенные ниже методы класса. `JMSContext`

```java
Topic createTopic(String topicName)
```

## <a name="temporary-queues"></a>Временные очереди

Если клиентскому приложению требуется временная сущность, существующая в течение времени существования приложения, она может использовать временные очереди. Эти сущности используются в шаблоне " [запрос-ответ](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html) ".

Чтобы создать временную очередь, используйте приведенные ниже методы `JMSContext` класса.

```java
TemporaryQueue createTemporaryQueue()
```

## <a name="temporary-topics"></a>Временные разделы

Как и временные очереди, существуют временные разделы, позволяющие публиковать или подписываться через временную сущность, которая существует в течение всего времени существования приложения.

Чтобы создать временный раздел, используйте приведенные ниже методы `JMSContext` класса.

```java
TemporaryTopic createTemporaryTopic()
```

## <a name="java-message-service-jms-subscriptions"></a>Подписки на службу сообщений Java (JMS)

Несмотря на то, что они семантически похожи на [подписки](service-bus-queues-topics-subscriptions.md#topics-and-subscriptions) (т. е. существуют в разделе и включают семантику публикации/подписки), в спецификации службы сообщений Java представлены концепции **общих**, **несовместно** используемых, * * устойчивых и **неустойчивых** атрибутов для данной подписки.

> [!NOTE]
> Следующие подписки доступны на уровне Premium служебной шины Azure для клиентских приложений, подключающихся к служебной шине Azure с помощью [библиотеки JMS для служебной шины Azure](https://search.maven.org/artifact/com.microsoft.azure/azure-servicebus-jms).
>
> С помощью портал Azure можно создавать только устойчивые подписки.
>

### <a name="shared-durable-subscriptions"></a>Общие устойчивые подписки

Общая устойчивая подписка используется, когда все сообщения, опубликованные в разделе, должны быть получены и обработаны приложением, независимо от того, активно ли приложение от подписки.

Любое приложение, которое проходит проверку подлинности для получения из служебной шины, может получить от общей устойчивой подписки.

Чтобы создать общую устойчивую подписку, используйте приведенные ниже методы `JMSContext` класса.

```java
JMSConsumer createSharedDurableConsumer(Topic topic, String name)

JMSConsumer createSharedDurableConsumer(Topic topic, String name, String messageSelector)
```

Общая устойчивая подписка остается существующей, если не удалена с помощью `unsubscribe` метода `JMSContext` класса.

```java
void unsubscribe(String name)
```

### <a name="unshared-durable-subscriptions"></a>Несовместное использование устойчивых подписок

Как и в случае с общей устойчивой подпиской, необщая устойчивая подписка используется, когда все сообщения, опубликованные в разделе, должны быть получены и обработаны приложением независимо от того, активно ли приложение от подписки.

Однако, так как это необщая подписка, она может получить только приложение, создавшее подписку.

Чтобы создать недоступную устойчивую подписку, используйте приведенные ниже методы из `JMSContext` класса- 

```java
JMSConsumer createDurableConsumer(Topic topic, String name)

JMSConsumer createDurableConsumer(Topic topic, String name, String messageSelector, boolean noLocal)
```

> [!NOTE]
> Эта `noLocal` функция в настоящее время не поддерживается и игнорируется.
>

Необщая устойчивая подписка остается существующей, если не удалена с помощью `unsubscribe` метода `JMSContext` класса.

```java
void unsubscribe(String name)
```

### <a name="shared-non-durable-subscriptions"></a>Общие неустойчивые подписки

Общая неустойчивая подписка используется, когда нескольким клиентским приложениям требуется получать и обрабатывать сообщения из одной подписки, только пока они не будут активно потребляться или получены из нее.

Так как подписка не устойчива, она не сохраняется. При отсутствии активных потребителей в этой подписке сообщения не поступают.

Чтобы создать общую неустойчивую подписку, создайте, `JmsConsumer` как показано в приведенных ниже методах `JMSContext` класса.

```java
JMSConsumer createSharedConsumer(Topic topic, String sharedSubscriptionName)

JMSConsumer createSharedConsumer(Topic topic, String sharedSubscriptionName, String messageSelector)
```

Общая неустойчивая подписка будет существовать до тех пор, пока в ней не поступают активные потребители.

### <a name="unshared-non-durable-subscriptions"></a>Неустойчивые подписки без общих ресурсов

Неустойчивая подписка используется, когда клиентскому приложению требуется получение и обработка сообщения из подписки, только пока она активно не использует ее. В этой подписке может существовать только один потребитель, то есть клиент, создавший подписку.

Так как подписка не устойчива, она не сохраняется. Сообщения не получаются этой подпиской, если на ней нет активных потребителей.

Чтобы создать необщую неустойчивую подписку, создайте, `JMSConsumer` как показано в приведенных ниже методах из `JMSContext` класса.

```java
JMSConsumer createConsumer(Destination destination)

JMSConsumer createConsumer(Destination destination, String messageSelector)

JMSConsumer createConsumer(Destination destination, String messageSelector, boolean noLocal)
```

> [!NOTE]
> Эта `noLocal` функция в настоящее время не поддерживается и игнорируется.
>

Неустойчивая подписка будет существовать до тех пор, пока от нее не будет получен активный потребитель.

### <a name="message-selectors"></a>Селекторы сообщений

Так же как **и фильтры и действия** для обычных подписок служебной шины, для подписок JMS существуют **селекторы сообщений** .

Селекторы сообщений могут быть настроены для каждой подписки JMS и существовать как условие фильтра в свойствах заголовка сообщения. Доставляются только сообщения со свойствами заголовка, соответствующими выражению селектора сообщений. Значение null или пустая строка указывает на отсутствие селектора сообщений для подписки или потребителя JMS.

## <a name="additional-concepts-for-java-message-service-jms-20-subscriptions"></a>Дополнительные понятия для подписок службы сообщений Java (JMS) 2,0

### <a name="client-scoping"></a>Определение области клиента

Подписки, как указано в интерфейсе API 2,0 службы сообщений Java (JMS), могут быть или не принадлежать *конкретному клиентскому приложению/s* (определяется соответствующим образом `clientId` ).

После того как подписка ограничена, **доступ к ней можно получить только** из клиентских приложений с одинаковым идентификатором клиента. 

Любые попытки доступа к подписке с заданной ИДЕНТИФИКАТОРом клиента (скажем, clientId1) из приложения, имеющего другой идентификатор клиента (скажем, clientId2), приведут к созданию другой подписки, ограниченной на другом ИДЕНТИФИКАТОРе клиента (clientId2).

> [!NOTE]
> Идентификатор клиента может быть пустым или иметь значение null, но должен соответствовать ИДЕНТИФИКАТОРу клиента, заданному в клиентском приложении JMS. С точки зрения служебной шины Azure идентификатор клиента NULL и пустой идентификатор клиента имеют одинаковое поведение.
>
> Если идентификатор клиента имеет значение null или пуст, он доступен только для клиентских приложений, идентификатор клиента которых также имеет значение null или пуст.
>

### <a name="shareability"></a>Совместное использование

**Общие** подписки позволяют нескольким клиентам и потребителям (то есть объектам жмсконсумер) принимать сообщения от них.

>[!NOTE]
> Общие подписки, ограниченные конкретным ИДЕНТИФИКАТОРом клиента, по-прежнему могут быть доступны нескольким клиентам или потребителям (т. е. объектам Жмсконсумер), но каждое клиентское приложение должно иметь одинаковый идентификатор клиента.
>
 

**Несовместное использование** подписок позволяет использовать только один клиент или потребитель (т. е. объект жмсконсумер) для получения сообщений от них. Если объект `JMSConsumer` создается для необщей подписки, в то время как в нем уже есть активный `JMSConsumer` прослушивание сообщений, `JMSException` возникает исключение.


### <a name="durability"></a>Длительность

**Устойчивые** подписки сохраняются и продолжают получать сообщения из раздела, независимо от того, использует ли приложение ( `JMSConsumer` ) сообщения из него.

**Неустойчивые** подписки не сохраняются и собираются сообщения из раздела, пока приложение ( `JMSConsumer` ) использует сообщения из него. 

## <a name="representation-of-client-scoped-subscriptions"></a>Представление подписок в области клиента

Учитывая, что подписки с областью действия клиента (JMS) должны сосуществовать вместе с существующими [подписками](service-bus-queues-topics-subscriptions.md#topics-and-subscriptions), способ представления подписок в области клиента (JMS) должен соответствовать приведенному ниже формату.

   * **\<SUBSCRIPTION-NAME\>**$**\<CLIENT-ID\>**$**D** (для устойчивых подписок)
   * **\<SUBSCRIPTION-NAME\>**$**\<CLIENT-ID\>**$**ND** (для неустойчивых подписок)

Здесь **$** — это разделитель.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения и примеры использования обмена сообщениями в служебной шине Microsoft Azure см. в следующих дополнительных статьях:

* [Основные сведения об обмене сообщениями через служебную шину](service-bus-messaging-overview.md)
* [Использование API службы сообщений Java 2,0 с помощью служебной шины Azure Premium](how-to-use-java-message-service-20.md)



