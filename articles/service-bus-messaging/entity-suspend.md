---
title: Служебная шина Azure — приостановка сущностей обмена сообщениями
description: В этой статье объясняется, как временно приостановить и повторно активировать объекты сообщений служебной шины Azure (очереди, разделы и подписки).
ms.topic: article
ms.date: 09/29/2020
ms.openlocfilehash: ea1acab3d0a86b0064f8b3eef7bfd1496bd17041
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94543057"
---
# <a name="suspend-and-reactivate-messaging-entities-disable"></a>Приостановка и повторная активация сущностей обмена сообщениями (отключение)

Очереди, разделы и подписки можно временно приостанавливать. Приостановка помещает сущность в отключенное состояние, при котором все сообщения остаются в хранилище. Однако удалить или добавить сообщения нельзя, а соответствующие операции протокола выдают ошибки.

Возможно, вы захотите приостановить сущность для срочного администрирования. Например, неисправный получатель получает сообщения из очереди, не обрабатывает их, а также неправильно завершает сообщения и удаляет их. В этом случае может потребоваться отключить получение очереди до тех пор, пока не будет исправлен и развернут код. 

Приостановку или повторную активацию может выполнить либо пользователь, либо система. Система приостанавливает сущности только из-за грависом административных причин, таких как достижение предельной суммы расходов на подписку. Отключенные системой сущности не могут быть повторно активированы пользователем, но восстанавливаются, когда причина приостановки устранена.

## <a name="queue-status"></a>Состояние очереди 
Для **очереди** можно задать следующие состояния:

-   **Active** (активно): очередь активна. Вы можете отправлять сообщения в очередь и получать сообщения из нее. 
-   **Disabled** (отключено): очередь приостановлена. Это эквивалентно установке **сенддисаблед** и **рецеиведисаблед**. 
-   **Сенддисаблед**: вы не можете отправлять сообщения в очередь, но можете получать из них сообщения. При попытке отправить сообщения в очередь вы получите исключение. 
-   **Рецеиведисаблед**: вы можете отправлять сообщения в очередь, но не можете получать из них сообщения. При попытке получения сообщений в очередь вы получите исключение.


### <a name="change-the-queue-status-in-the-azure-portal"></a>Измените состояние очереди в портал Azure: 

1. Перейдите к пространству имен служебной шины на портале Azure. 
1. Выберите очередь, для которой необходимо изменить состояние. Очереди отображаются в нижней области в середине. 
1. На странице **очередь служебной шины** просмотрите текущее состояние очереди в виде гиперссылки. Если **Обзор** не выбран в меню слева, выберите его, чтобы просмотреть состояние очереди. Выберите текущее состояние очереди, чтобы изменить его. 

    :::image type="content" source="./media/entity-suspend/select-state.png" alt-text="Выберите состояние очереди":::
4. Выберите новое состояние очереди и нажмите кнопку **ОК**. 

    :::image type="content" source="./media/entity-suspend/entity-state-change.png" alt-text="Задать состояние очереди":::
    
Вы также можете отключить операции отправки и получения с помощью API-интерфейсов служебной шины [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) в пакете SDK для .NET или с помощью шаблона Azure Resource Manager с помощью Azure CLI или Azure PowerShell.

### <a name="change-the-queue-status-using-azure-powershell"></a>Изменение состояния очереди с помощью Azure PowerShell
В следующем примере показана команда PowerShell для отключения очереди. Команда повторной активации эквивалентна установке значения **Active** для параметра `Status`.

```powershell
$q = Get-AzServiceBusQueue -ResourceGroup mygrp -NamespaceName myns -QueueName myqueue

$q.Status = "Disabled"

Set-AzServiceBusQueue -ResourceGroup mygrp -NamespaceName myns -QueueName myqueue -QueueObj $q
```

## <a name="topic-status"></a>Состояние раздела
Состояние раздела можно изменить в портал Azure. Выберите текущее состояние раздела, чтобы увидеть следующую страницу, которая позволяет изменить состояние. 

:::image type="content" source="./media/entity-suspend/topic-state-change.png" alt-text="Изменение состояния раздела":::

Для **раздела** можно задать следующие состояния.
- **Активный**: раздел активен. Сообщения можно отправить в раздел. 
- **Отключено**. раздел приостановлен. Вы не можете отправить сообщения в раздел. 
- **Сенддисаблед**: тот же результат, что и **отключено**. Вы не можете отправить сообщения в раздел. При попытке отправить сообщения в раздел вы получите исключение. 

## <a name="subscription-status"></a>Состояние подписки
Состояние подписки можно изменить в портал Azure. Выберите текущее состояние подписки, чтобы просмотреть следующую страницу, которая позволяет изменить состояние. 

:::image type="content" source="./media/entity-suspend/subscription-state-change.png" alt-text="Изменение состояния подписки":::

Для **подписки** можно задать следующие состояния:
- **Активный**: Подписка активна. Вы можете получить сообщения, FRM подписку.
- **Отключено**: Подписка приостановлена. Вы не можете получить сообщения из подписки. 
- **Рецеиведисаблед**: тот же результат, что и **отключено**. Вы не можете получить сообщения из подписки. Если вы попытаетесь получить сообщения в подписку, вы получите исключение.

| Состояние раздела | Состояние подписки | Поведение | 
| ------------ | ------------------- | -------- | 
| Активен | Активен | Вы можете отправлять сообщения в раздел и получать сообщения из подписки. | 
| Активен | Отключено или не получено | Вы можете отправлять сообщения в раздел, но не можете получать сообщения из подписки. | 
| Отключено или отправка отключена | Активен | Вы не можете отправлять сообщения в раздел, но можете получать сообщения, которые уже находятся в подписке. | 
| Отключено или отправка отключена | Отключено или не получено | Вы не можете отправлять сообщения в раздел, и вы не можете получить его из подписки. | 

## <a name="other-statuses"></a>Другие состояния
Перечисление [EntityStatus](/dotnet/api/microsoft.servicebus.messaging.entitystatus) также определяет набор переходных состояний, которые могут устанавливаться только системой. 


## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об обмене сообщениями через служебную шину см. в следующих статьях:

* [Очереди, разделы и подписки служебной шины](service-bus-queues-topics-subscriptions.md)
* [Начало работы с очередями служебной шины](service-bus-dotnet-get-started-with-queues.md)
* [Как использовать разделы и подписки служебной шины](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[1]: ./media/entity-suspend/entity-state-change.png

