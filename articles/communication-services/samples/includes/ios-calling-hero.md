---
title: включить файл
description: включить файл
services: azure-communication-services
author: ddematheu2
manager: chpalm
ms.service: azure-communication-services
ms.subservice: azure-communication-services
ms.date: 03/10/2021
ms.topic: include
ms.custom: include file
ms.author: dademath
ms.openlocfilehash: 287520f2964fba7c3c3804853e9356a8c77b2d06
ms.sourcegitcommit: bfa7d6ac93afe5f039d68c0ac389f06257223b42
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2021
ms.locfileid: "106498774"
---
[!INCLUDE [Public Preview Notice](../../includes/public-preview-include-android-ios.md)]

**Пример группового вызова для iOS** Служб коммуникации Azure показывает, как с помощью пакета SDK для вызовов Служб коммуникации для iOS можно создавать групповые вызовы с поддержкой голоса и видео. В этом кратком руководстве описывается, как настроить и запустить этот пример. Для понимания контекста приводятся общие сведения о примере.

## <a name="download-code"></a>Скачать код

Найдите проект для этого примера на сайте [GitHub](https://github.com/Azure-Samples/communication-services-ios-calling-hero). Версию примера с [взаимодействием между командами](../../concepts/teams-interop.md) можно найти в отдельной [ветви](https://github.com/Azure-Samples/communication-services-ios-calling-hero/tree/feature/teams_interop).

## <a name="overview"></a>Обзор

Этот пример содержит собственное приложение iOS, которое использует пакеты SDK Служб коммуникации Azure для iOS для создания вызовов с поддержкой голоса и видео. Это приложение использует компонент на стороне сервера для подготовки маркеров доступа, которые затем используются для инициализации пакета SDK Служб коммуникации Azure. Чтобы настроить этот компонент на стороне сервера, вы можете воспользоваться [учебником по созданию доверенной службы с Функциями Azure](../../tutorials/trusted-service-tutorial.md).

Вот как выглядит этот пример:

:::image type="content" source="../media/calling/landing-page-ios.png" alt-text="Снимок экрана: целевая страница примера приложения.":::

При нажатии кнопки Start new call (Начать новый вызов) приложение iOS создает новый вызов и присоединяется к нему. Приложение позволяет подключиться к существующему вызову Служб коммуникации Azure, указав идентификатор этого вызова.

После подключения к вызову вам будет предложено предоставить приложению разрешение на доступ к камере и микрофону. Также будет предложено ввести отображаемое имя.

:::image type="content" source="../media/calling/pre-call-ios.png" alt-text="Снимок экрана: экран примера приложения перед звонком.":::

Завершив настройку устройств и отображаемого имени, вы присоединитесь к сеансу вызова. Вы увидите основной холст вызова с основными возможностями.

:::image type="content" source="../media/calling/main-app-ios.png" alt-text="Снимок экрана: главный экран примера приложения.":::

Ниже перечислены компоненты главного экрана вызова.

- **Коллекция мультимедиа.** Основная область, в которой отображаются участники. Если у участника есть камера и она включена, здесь отображается видеопоток. Для каждого участника создается отдельная плитка, на которой размещаются его отображаемое имя и видеопоток (если он есть). Коллекция поддерживает несколько участников и автоматически обновляется при добавлении или удалении участников вызова.
- **Панель действий.** Именно здесь находятся основные элементы управления вызовом. Эти элементы управления позволяют включать и отключать видео и микрофон, предоставлять общий доступ к экрану и покидать сеанс вызова.

Ниже вы найдете дополнительные сведения о предварительных требованиях и шагах по настройке примера.

## <a name="prerequisites"></a>Предварительные требования

- Учетная запись Azure с активной подпиской. Дополнительные сведения см. на странице [Создайте бесплатную учетную запись Azure уже сегодня](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
- компьютер Mac с [Xcode](https://go.microsoft.com/fwLink/p/?LinkID=266532), а также действительный сертификат разработчика, установленный в цепочку ключей;
- Ресурс Служб коммуникации Azure. Дополнительные сведения см. в статье [Краткое руководство по созданию ресурсов Служб коммуникации и управлению ими](../../quickstarts/create-communication-resource.md).
- Функция Azure, запускающая [конечную точку проверки подлинности](../../tutorials/trusted-service-tutorial.md) для получения маркеров доступа.

## <a name="running-sample-locally"></a>Локальное выполнение примера

Этот пример группового вызова можно запустить локально с помощью XCode. Разработчики могут использовать для тестирования приложения реальное устройство или эмулятор.

### <a name="before-running-the-sample-for-the-first-time"></a>Действия перед первым запуском примера

1. Установите зависимости, выполнив команду `pod install`.
2. Откройте `AzureCalling.xcworkspace` в XCode.
3. Обновите `AppSettings.plist`. Задайте для ключа `communicationTokenFetchUrl` значение, соответствующее URL-адресу конечной точки аутентификации.

### <a name="run-sample"></a>Запуск примера

Скомпилируйте и запустие пример в XCode.

## <a name="optional-securing-an-authentication-endpoint"></a>(Необязательно) Защита конечной точки аутентификации

В демонстрационных целях в этом примере по умолчанию используется общедоступная конечная точка для получения маркера Служб коммуникации Azure. Для реальных рабочих сценариев мы рекомендуем создать собственную защищенную конечную точку и выдавать собственные маркеры.

Если выполнить дополнительную конфигурацию, этот пример будет поддерживать подключение к конечной точке с защитой **Azure Active Directory** (Azure AD), чтобы для получения маркера Служб коммуникации Azure требовался вход пользователя в систему. Соответствующие действия описаны ниже.

1. Включите аутентификацию Azure Active Directory в приложении.  
   - [Регистрация приложения в Azure Active Directory (через параметры платформ iOS и macOS)](../../../active-directory/develop/tutorial-v2-ios.md) 
    - [Настройка Службы приложений или приложения "Функции Azure" для использования имени для входа в Azure AD](../../../app-service/configure-authentication-provider-aad.md)
2. Перейдите на страницу обзора зарегистрированного приложения в разделе регистрации приложений в Azure Active Directory. Запишите значения `Application (client) ID`, `Directory (tenant) ID`, `Application ID URI`.

:::image type="content" source="../media/calling/aad-overview.png" alt-text="Настройка Azure Active Directory на портале Azure.":::

3. Откройте `AppSettings.plist` в Xcode и добавьте следующие значения ключей:
   - `communicationTokenFetchUrl`. URL-адрес для запроса маркера Служб коммуникации Azure 
   - `isAADAuthEnabled`. Логическое значение, указывающее, требуется ли аутентификация для маркера Служб коммуникации Azure.
   - `aadClientId`. Идентификатор приложения (клиента).
   - `aadTenantId`. Идентификатор каталога (арендатора).
   - `aadRedirectURI`. URI перенаправления должен иметь такой формат: `msauth.<app_bundle_id>://auth`
   - `aadScopes`. Массив областей разрешения, которые запрашиваются у пользователей для авторизации. Добавьте `<Application ID URI>/user_impersonation` в этот массив, чтобы предоставить доступ к конечной точке аутентификации.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы хотите очистить и удалить подписку на Службы коммуникации, вы можете удалить ресурс или группу ресурсов. При этом удаляются все ресурсы, связанные с ней. См. сведения об [очистке ресурсов](../../quickstarts/create-communication-resource.md#clean-up-resources).

## <a name="next-steps"></a>Дальнейшие действия

>[!div class="nextstepaction"]
>[Скачайте пример с GitHub.](https://github.com/Azure-Samples/communication-services-ios-calling-hero)

Дополнительные сведения см. в следующих статьях:

- Узнайте, как правильно [использовать пакет SDK для вызовов](../../quickstarts/voice-video-calling/calling-client-samples.md).
- Узнайте больше о [принципе работы функции вызовов](../../concepts/voice-video-calling/about-call-types.md).

### <a name="additional-reading"></a>Дополнительные материалы

- [Службы коммуникации Azure (GitHub)](https://github.com/Azure/communication) — дополнительные примеры и сведения на официальной странице GitHub
- [Примеры](./../overview.md): дополнительные примеры см. на нашей странице обзора примеров.
- [Функции вызов Служб коммуникации Azure](https://docs.microsoft.com/azure/communication-services/concepts/voice-video-calling/calling-sdk-features). Дополнительные сведения о пакете SDK для iOS см. в статье о [пакетах SDK для iOS для вызовов в Службах коммуникации Azure](https://github.com/Azure/Communication/releases/)
