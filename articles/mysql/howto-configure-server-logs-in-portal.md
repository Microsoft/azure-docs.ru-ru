---
title: Доступ к журналам запросов с высокой производительностью. портал Azure — база данных Azure для MySQL
description: В этой статье описывается, как настроить и получить доступ к журналам службы "база данных Azure для MySQL" из портал Azure.
author: Bashar-MSFT
ms.author: bahusse
ms.service: mysql
ms.topic: how-to
ms.date: 3/15/2021
ms.openlocfilehash: 91569780aa71861e07c7e96bec5eac879642760d
ms.sourcegitcommit: 4bda786435578ec7d6d94c72ca8642ce47ac628a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2021
ms.locfileid: "103496224"
---
# <a name="configure-and-access-slow-query-logs-from-the-azure-portal"></a>Настройка и доступ к журналам запросов с высокой занесением портал Azure

Вы можете настроить, перечислить и скачать [журналы запросов к базе данных Azure для MySQL](concepts-server-logs.md) с портал Azure.

## <a name="prerequisites"></a>Предварительные требования
Для выполнения действий, описанных в этой статье, требуется [сервер базы данных Azure для MySQL](quickstart-create-mysql-server-database-using-azure-portal.md).

## <a name="configure-logging"></a>Настройка журнала
Настройте доступ к журналу медленных запросов MySQL. 

1. Войдите на [портал Azure](https://portal.azure.com/).

2. Выберите сервер базы данных Azure для MySQL.

3. В разделе **мониторинг** на боковой панели выберите **журналы сервера**. 
   :::image type="content" source="./media/howto-configure-server-logs-in-portal/1-select-server-logs-configure.png" alt-text="Снимок экрана параметров журналов сервера":::

4. Чтобы просмотреть параметры сервера, выберите **щелкните здесь, чтобы включить журналы и настроить параметры журнала**.

5. Включите **slow_query_log** в значение **вкл**.

6. Выберите место вывода журналов для использования **log_output**. Чтобы отправить журналы в локальное хранилище и Azure Monitor журналы диагностики, выберите **файл**.

7. Рассмотрите возможность установки значения "long_query_time", представляющего пороговое значение времени запроса для запросов, которые будут собираться в файле журнала запросов с задержкой, минимальное и значение по умолчанию long_query_time — 0 и 10 соответственно.

8. Настройте другие параметры, например log_slow_admin_statements для ведения журнала административных инструкций. По умолчанию административные инструкции не регистрируются, а запросы, не использующие индексы для уточняющих запросов, не заносятся в журнал. 

9. Щелкните **Сохранить**. 

   :::image type="content" source="./media/howto-configure-server-logs-in-portal/3-save-discard.png" alt-text="Снимок экрана параметров журнала &quot;замедляют запрос&quot; и &quot;Сохранить&quot;.":::

На странице **Параметры сервера** можно вернуться к списку журналов, закрыв страницу.

## <a name="view-list-and-download-logs"></a>Просмотр списка журналов и их скачивание
После начала ведения журнала можно просмотреть список доступных журналов запросов с высокой загрузкой и загрузить отдельные файлы журналов.

1. Перейдите на портал Azure.

2. Выберите сервер базы данных Azure для MySQL.

3. В разделе **мониторинг** на боковой панели выберите **журналы сервера**. На странице отображается список файлов журнала.

   :::image type="content" source="./media/howto-configure-server-logs-in-portal/4-server-logs-list.png" alt-text="Снимок экрана: страница &quot;журналы сервера&quot; с выделенным списком журналов":::

   > [!TIP]
   > Действует следующее соглашение об именовании журналов: **mysql-slow-<имя_вашего_сервера>-ггггммддчч.log**. Дата и время, используемые в имени файла, — это время, когда был выдан журнал. Файлы журнала поворачиваются каждые 24 часа или 7,5 ГБ, в зависимости от того, что происходит раньше. 

4. При необходимости используйте поле поиска, чтобы быстро сократить до определенного журнала на основе даты и времени. Поиск осуществляется по имени журнала.

5. Чтобы загрузить отдельные файлы журналов, щелкните значок со стрелкой вниз рядом с каждым файлом журнала в строке таблицы.

   :::image type="content" source="./media/howto-configure-server-logs-in-portal/5-download.png" alt-text="Снимок экрана: страница &quot;журналы сервера&quot; с выделенным значком &quot;стрелка вниз&quot;":::

## <a name="set-up-diagnostic-logs"></a>Настройка журналов диагностики

1. В разделе **мониторинг** на боковой панели выберите **параметры диагностики**  >  **Добавить параметры диагностики**.

   :::image type="content" source="./media/howto-configure-server-logs-in-portal/add-diagnostic-setting.png" alt-text="Снимок экрана параметров параметров диагностики":::

2. Укажите имя параметра диагностики.

3. Укажите, какие приемники данных должны отправлять журналы запросов с высокой загрузкой (учетная запись хранения, концентратор событий или Рабочая область Log Analytics).

4. В качестве типа журнала выберите **мисклсловлогс** .
:::image type="content" source="./media/howto-configure-server-logs-in-portal/configure-diagnostic-setting.png" alt-text="Снимок экрана параметров конфигурации параметров диагностики":::

5. После настройки приемников данных для передачи журналов запросов с задержкой нажмите кнопку **сохранить**.
:::image type="content" source="./media/howto-configure-server-logs-in-portal/save-diagnostic-setting.png" alt-text="Снимок экрана параметров конфигурации параметров диагностики с выделенным сохранением":::

6. Получите доступ к журналам запросов с задержкой, изучив их в настроенных приемниках данных. Для отображения журналов может потребоваться до 10 минут.

## <a name="next-steps"></a>Дальнейшие действия
- Сведения о том, как программно скачивать журналы запросов, см. [в статье доступ к журналам запросов с помощью интерфейса командной строки](howto-configure-server-logs-in-cli.md) .
- Дополнительные сведения о [медленных журналах запросов](concepts-server-logs.md) в базе данных Azure для MySQL.
- Дополнительные сведения об определениях параметров и ведении журнала MySQL см. в документации MySQL по [журналам](https://dev.mysql.com/doc/refman/5.7/en/slow-query-log.html).