---
title: 'Обзор сети: гибкий сервер базы данных Azure для MySQL'
description: Сведения о вариантах подключения и работы в сети в варианте гибкого развертывания сервера для базы данных Azure для MySQL
author: ambhatna
ms.author: ambhatna
ms.service: mysql
ms.topic: conceptual
ms.date: 9/23/2020
ms.openlocfilehash: a8e2d77ff3c7cb2e4352b21cd87d630331e28660
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96906154"
---
# <a name="connectivity-and-networking-concepts-for-azure-database-for-mysql---flexible-server-preview"></a>Основные понятия подключения и сети для базы данных Azure для MySQL — гибкий сервер (Предварительная версия)

В этой статье описаны общедоступные и частные варианты подключения для вашего сервера. Вы узнаете подробнее о концепциях сети для гибкого сервера базы данных Azure для MySQL, чтобы безопасно создать сервер в Azure.

> [!IMPORTANT]
> База данных Azure для MySQL — гибкий сервер находится на этапе предварительной версии.

## <a name="choosing-a-networking-option"></a>Выбор параметра сети
У вас есть две сетевые возможности для гибкого сервера базы данных Azure для MySQL. Вы можете выбрать **частный доступ (интеграция с виртуальной сетью)** или **общий доступ (разрешенные IP-адреса)** . При создании сервера необходимо выбрать один из вариантов. 

> [!NOTE]
> Невозможно изменить параметр сети после создания сервера. 

* **Частный доступ (интеграция с виртуальной сетью)** . Вы можете развернуть гибкий сервер в [виртуальной сети Azure](../../virtual-network/virtual-networks-overview.md). Виртуальные сети Azure используют частное и безопасное сетевое подключение. Это позволит ресурсам в виртуальной сети взаимодействовать через частные IP-адреса.

   Выберите вариант интеграции с виртуальной сетью, если вам нужны следующие возможности.
   * Подключение из ресурсов Azure в той же виртуальной сети к гибкому серверу с помощью частных IP-адресов.
   * Использование VPN или ExpressRoute для подключения к гибкому серверу со стороны ресурсов, не относящихся к Azure.
   * У гибкого сервера нет общедоступной конечной точки

* **Общий доступ (разрешенные IP-адреса)** — доступ к гибкому серверу осуществляется через общедоступную конечную точку. Общедоступная конечная точка — это общедоступный DNS-адрес. Фраза "разрешенные IP-адреса" относится к диапазону IP-адресов, который вы выбрали для предоставления разрешения на доступ к серверу. Эти разрешения называются **правилами брандмауэра**. 

   Выберите общедоступный метод доступа, если вам нужны следующие возможности:
   * Подключение из ресурсов Azure, которые не поддерживают виртуальные сети
   * Подключение из ресурсов за пределами Azure, которые не подключены с помощью VPN или ExpressRoute 
   * У гибкого сервера есть общедоступная конечная точка

Если вы решили использовать частный доступ или параметр общего доступа, применяются следующие характеристики.
* Подключения от разрешенных IP-адресов должны пройти проверку подлинности на сервере MySQL с действительными учетными данными
* [Шифрование подключения](#tls-and-ssl) доступно для сетевого трафика.
* Сервер имеет полное доменное имя (FQDN). Для свойства HostName в строках подключения рекомендуется использовать полное доменное имя вместо IP-адреса.
* Оба параметра управляют доступом на уровне сервера, а не на уровне базы данных или таблицы. Свойства ролей MySQL используются для управления доступом к базам данных, таблицам и другим объектам.


## <a name="private-access-vnet-integration"></a>Закрытый доступ (интеграция виртуальной сети)
Частный доступ с интеграцией виртуальных сетей (vnet) обеспечивает частное и безопасное взаимодействие для гибкого сервера MySQL.

### <a name="virtual-network-concepts"></a>Основные понятия виртуальной сети
Ниже приведены некоторые основные понятия, с которыми следует ознакомиться при использовании виртуальных сетей с гибкими серверами MySQL.

* **Виртуальная сеть** . Виртуальная сеть Azure содержит пространство частных IP-адресов, настроенное для использования. Дополнительные сведения о виртуальных сетях Azure см. в [обзоре виртуальной сети Azure](../../virtual-network/virtual-networks-overview.md) .

    Виртуальная сеть должна находиться в том же регионе Azure, что и гибкий сервер.


* **Делегированная подсеть** — виртуальная сеть содержит подсети (допуски). Подсети позволяют сегментировать виртуальную сеть в небольшие адресные пространства. Ресурсы Azure развертываются в определенные подсети в виртуальной сети. 

   Гибкий сервер MySQL должен находиться в подсети, **делегированной** только для гибкого сервера MySQL. Это делегирование означает, что только гибкие серверы Базы данных Azure для MySQL могут использовать эту подсеть. Другие типы ресурсов Azure не могут быть делегированы подсети. Вы делегируйте подсеть, назначив ее свойство делегирования как Microsoft. Дбформискл/Флексиблесерверс.

* **Группы безопасности сети (NSG)** Правила безопасности в группах безопасности сети позволяют фильтровать тип сетевого трафика, который может подаваться в подсетях виртуальной сети и сетевых интерфейсах, а также из них. Дополнительные сведения [см. в обзоре группы безопасности сети](../../virtual-network/network-security-groups-overview.md) .


### <a name="unsupported-virtual-network-scenarios"></a>Неподдерживаемые сценарии виртуальной сети
* Общедоступная конечная точка (или общедоступный IP-адрес или DNS) — гибкий сервер, развернутый в виртуальной сети, не может иметь общедоступную
* После развертывания гибкого сервера в виртуальной сети и подсети его нельзя переместить в другую виртуальную сеть или подсеть. Невозможно переместить виртуальную сеть в другую группу ресурсов или подписку.
* Размер подсети (адресные пространства) невозможно увеличить после существования ресурсов в подсети
* Пиринг виртуальных сетей между регионами не поддерживается

Узнайте, как включить частный доступ (интеграция с виртуальной сетью) с помощью [портал Azure](how-to-manage-virtual-network-portal.md) или [Azure CLI](how-to-manage-virtual-network-cli.md).

> [!NOTE]
> При использовании настраиваемого DNS-сервера необходимо использовать DNS-сервер пересылки для разрешения полного доменного имени базы данных Azure для MySQL — гибкого сервера. Дополнительные сведения см. в разделе [разрешение имен, которое использует собственный DNS-сервер](../../virtual-network/virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-that-uses-your-own-dns-server) .

## <a name="public-access-allowed-ip-addresses"></a>Открытый доступ (разрешенные IP-адреса)
Характеристики общедоступного метода доступа включают:
* Только IP-адреса, которые вы разрешаете, имеют разрешение на доступ к гибкому серверу MySQL. По умолчанию IP-адреса запрещены. Вы можете добавить IP-адреса во время создания сервера или позже.
* Сервер MySQL имеет публично разрешаемое DNS-имя
* Ваш гибкий сервер не входит в одну из виртуальных сетей Azure
* Сетевой трафик к серверу и с него не проходит через частную сеть. Трафик использует общие пути Интернета.

### <a name="firewall-rules"></a>Правила брандмауэра
Предоставление разрешения на IP-адрес называется правилом брандмауэра. Если попытки подключения поступают с IP-адреса, который вы не разрешили, то в исходном клиенте будет отображаться сообщение об ошибке.


### <a name="allowing-all-azure-ip-addresses"></a>Разрешение всех IP-адресов Azure
Если фиксированный исходящий IP-адрес недоступен для службы Azure, можно рассмотреть возможность включения подключений из всех IP-адресов центра обработки данных Azure.

> [!IMPORTANT]
> Параметр **Разрешить общий доступ из служб и ресурсов Azure в Azure** позволяет настроить брандмауэр для разрешения всех подключений из Azure, включая подключения из подписок других клиентов. При выборе этого параметра убедитесь, что используемое имя для входа и разрешения пользователя предоставляют доступ только авторизованным пользователям.

Узнайте, как включить общий доступ (разрешенные IP-адреса) и управлять им с помощью [портал Azure](how-to-manage-firewall-portal.md) или [Azure CLI](how-to-manage-firewall-cli.md).


### <a name="troubleshooting-public-access-issues"></a>Устранение общих проблем доступа
Если доступ к Microsoft Azure базе данных для сервера MySQL не работает должным образом, учитывайте следующие моменты:

* **Изменения в списке разрешенных адресов еще не вступили в силу.** До вступления в силу изменений конфигурации брандмауэра сервера базы данных Azure для MySQL может присутствовать задержка до пяти минут.

* **Ошибка проверки подлинности:** Если у пользователя нет разрешений на сервере базы данных Azure для MySQL или используется неправильный пароль, подключение к серверу базы данных Azure для MySQL будет отклонено. Создание параметра брандмауэра предоставляет клиентам возможность попытаться подключиться к серверу. Каждый клиент по-прежнему должен предоставлять необходимые учетные данные безопасности.

* **Динамический IP-адрес клиента:** При наличии подключения к Интернету с динамическим IP-адресом и возникновении проблем с брандмауэром можно попробовать одно из следующих решений.

   * Обратитесь к поставщику услуг Интернета (ISP) за диапазоном IP-адресов, назначенным клиентским компьютерам, которые получают доступ к серверу базы данных Azure для MySQL, а затем добавьте диапазон IP-адресов в качестве правила брандмауэра.
   * Получите статические IP-адреса для клиентских компьютеров, а затем добавьте статические IP-адреса как правила брандмауэра.
  
* **Правило брандмауэра недоступно для формата IPv6:** Правила брандмауэра должны иметь формат IPv4. Если указать правила брандмауэра в формате IPv6, отобразится ошибка проверки.


## <a name="hostname"></a>Hostname (Имя узла)
Независимо от выбранного варианта работы в сети, при подключении к гибкому серверу рекомендуется всегда использовать полное доменное имя в качестве имени узла. IP-адрес сервера не обязательно должен быть статическим. Использование полного доменного имени поможет избежать внесения изменений в строку подключения. 

Пример
* Такую `hostname = servername.mysql.database.azure.com`
* По возможности избегайте использования `hostname = 10.0.0.4` (частного адреса) или `hostname = 40.2.45.67` (общедоступный IP-адрес).



## <a name="tls-and-ssl"></a>TLS и SSL
База данных Azure для гибкого сервера MySQL поддерживает подключение клиентских приложений к службе MySQL с помощью протокола TLS. TLS — это стандартный промышленный протокол, обеспечивающий шифрование сетевых подключений между сервером базы данных и клиентскими приложениями. TLS — это обновленный протокол SSL (SSL).

База данных Azure для гибкого сервера MySQL поддерживает только зашифрованные подключения с использованием протокола TLS 1,2. Все входящие подключения с TLS 1,0 и TLS 1,1 будут отклонены. Вы не можете отключить или изменить версию TLS для подключения к гибкому серверу базы данных Azure для MySQL.


## <a name="next-steps"></a>Дальнейшие действия
* Узнайте, как включить закрытый доступ (интеграция с виртуальной сетью) с помощью [портала Azure](how-to-manage-virtual-network-portal.md) или [Azure CLI](how-to-manage-virtual-network-cli.md).
* Узнайте, как включить открытый доступ (разрешенные IP-адреса) с помощью [портала Azure](how-to-manage-firewall-portal.md) или [Azure CLI](how-to-manage-firewall-cli.md).
* Узнайте, как [использовать TLS](how-to-connect-tls-ssl.md)
