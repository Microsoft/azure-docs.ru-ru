---
title: Варианты вычислений и хранения — гибкий сервер в базе данных Azure для MySQL
description: В этой статье описываются варианты вычислений и хранения в службе "база данных Azure для MySQL — гибкий сервер".
author: savjani
ms.author: pariks
ms.service: mysql
ms.topic: conceptual
ms.date: 01/27/2021
ms.openlocfilehash: 267b362c94b04b3be634f7e61c2b6d67604d7854
ms.sourcegitcommit: 4e70fd4028ff44a676f698229cb6a3d555439014
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "98954687"
---
# <a name="compute-and-storage-options-in-azure-database-for-mysql---flexible-server-preview"></a>Варианты вычислений и хранения в базе данных Azure для MySQL — гибкий сервер (Предварительная версия)

> [!IMPORTANT] 
> Сейчас предоставляется общедоступная предварительная версия Гибкого сервера Базы данных Azure для MySQL.

Вы можете создать базу данных Azure для гибкого сервера MySQL на одном из трех разных уровней вычислений: с разбивкой, общего назначения и оптимизированной для памяти. Уровни вычислений отличаются базовым номером SKU виртуальной машины, используемой сериями B, серии D и E. Выбор уровня вычислений и размера определяет память и виртуальных ядер, доступные на сервере. Одна и та же технология хранения используется на всех уровнях вычислений. Все ресурсы настраиваются на уровне сервера MySQL. У сервера может быть одна или несколько баз данных.

| Ресурс или уровень | **Накапливаемыми ресурсами** | **Общего назначения** | **Оптимизированная для памяти** |
|:---|:----------|:--------------------|:---------------------|
| Серия виртуальной машины| Серия B | Серия Ddsv4 | Серия Edsv4|
| Виртуальные ядра | 1, 2 | 2, 4, 8, 16, 32, 48, 64 | 2, 4, 8, 16, 32, 48, 64 |
| Объем памяти на виртуальное ядро | Переменная | 4 гиб | 8 гиб * |
| Объем памяти | от 5 гиб до 16 тиб | от 5 гиб до 16 тиб | от 5 гиб до 16 тиб |
| Срок хранения резервной копии | от 1 до 35 дней | от 1 до 35 дней | от 1 до 35 дней |

\* За исключением SKU E64ds_v4 (оптимизировано для памяти), который содержит 504 ГБ памяти

Чтобы выбрать уровень вычислений, используйте следующую таблицу в качестве отправной точки.

| Уровень вычислений | Целевые рабочие нагрузки |
|:-------------|:-----------------|
| Накапливаемыми ресурсами | Лучше всего подходит для рабочих нагрузок, которые не требуют непрерывной полной загрузки ЦП. |
| Общего назначения | Для решения большинства бизнес-задач требуются сбалансированные вычислительные ресурсы и память с масштабируемой пропускной способностью операций ввода-вывода. К примерам относятся серверы для размещения мобильных и веб-приложений, а также других корпоративных приложений.|
| С оптимизацией для операций в памяти | Рабочие нагрузки с высокой производительностью базы данных, требующие эффективной обработки данных в памяти для быстрого выполнения транзакций и повышения уровня параллелизма. К примерам относятся серверы для обработки данных в режиме реального времени, а также аналитические или транзакционные приложения с высоким уровнем производительности.|

После создания сервера изменился уровень вычислений, размер вычислений и размер хранилища. Масштабирование вычислений требует перезагрузки и занимает от 60-120 секунд, в то время как масштабирование хранилища не требует перезагрузки. Вы также можете независимо настраивать срок хранения резервных копий. Дополнительные сведения см. в разделе [масштабирование ресурсов](#scale-resources) .

## <a name="compute-tiers-size-and-server-types"></a>Уровни вычислений, размер и типы серверов

Ресурсы вычислений можно выбирать на основе уровня и размера. Это определяет виртуальных ядер и объем памяти. Виртуальных ядер представляет логический ЦП базового оборудования.

Ниже приведены подробные спецификации доступных типов серверов.

| Объем вычислительных ресурсов         | Виртуальные ядра | Объем памяти (гиб) | 
|----------------------|--------|-------------------|
| **Накапливаемыми ресурсами**        |        |                   | 
| Standard_B1s         | 1      | 1                 |  
| Standard_B1ms        | 1      | 2                 | 
| Standard_B2s         | 2      | 4                 |  
| **Общего назначения**  |        |                   | 
| Standard_D2ds_v4     | 2      | 8                 |  
| Standard_D4ds_v4     | 4      | 16                | 
| Standard_D8ds_v4     | 8      | 32                | 
| Standard_D16ds_v4    | 16     | 64                | 
| Standard_D32ds_v4    | 32     | 128               |  
| Standard_D48ds_v4    | 48     | 192               |  
| Standard_D64ds_v4    | 64     | 256               | 
| **Оптимизированная для памяти** |        |                   |
| Standard_E2ds_v4     | 2      | 16                |
| Standard_E4ds_v4     | 4      | 32                |
| Standard_E8ds_v4     | 8      | 64                |
| Standard_E16ds_v4    | 16     | 128               |
| Standard_E32ds_v4    | 32     | 256               |
| Standard_E48ds_v4    | 48     | 384               |
| Standard_E64ds_v4    | 64     | 504               |

Дополнительные сведения о доступных сериях вычислений см. в документации по виртуальной машине Azure для [пакетной службы (серии B)](../../virtual-machines/sizes-b-series-burstable.md), [общего назначения (серии Ddsv4)](../../virtual-machines/ddv4-ddsv4-series.md)и [оптимизированной для памяти (Edsv4 Series)](../../virtual-machines/edv4-edsv4-series.md).

>[!NOTE]
>Для уровня вычислений [(серии B)](../../virtual-machines/sizes-b-series-burstable.md) при перезапуске сервера по какой-либо причине, например инициированным пользователем, запланированным или незапланированным обслуживанием, накопленный кредит может быть потерян. Причина заключается в том, что каждый раз, когда база данных Azure для MySQL перезапускается на том же узле, накопленный кредит будет храниться. Контрарили. при каждом запуске сервера базы данных Azure для MySQL на новом узле он получает первоначальный кредит. Дополнительные сведения см. в статье [часто задаваемые вопросы для чтения (серии B)](https://docs.microsoft.com/azure/virtual-machines/sizes-b-series-burstable#q-why-is-my-remaining-credit-set-to-0-after-a-redeploy-or-a-stopstart).

## <a name="storage"></a>Память

Подготавливается хранилище — это объем хранилища, доступный для гибкого сервера. Хранилище используется для файлов базы данных, временных файлов, журналов транзакций и журналов сервера MySQL. На всех уровнях вычислений минимальный поддерживаемый объем хранилища составляет 5 гиб и максимум — 16 тиб. Масштаб хранилища увеличивается на 1 гиб, и его можно масштабировать после создания сервера.

>[!NOTE]
> Масштаб хранилища можно только увеличить вертикально, но не уменьшить.

Вы можете отслеживать потребление хранилища в портал Azure (с Azure Monitor), используя пределы хранилища, процент хранения и объем хранилища, используемый метриками. Дополнительные сведения о метриках см. в [статье мониторинг](./concepts-monitoring.md) . 

### <a name="reaching-the-storage-limit"></a>Достигнут размер хранилища

Когда объем хранилища, потребляемый на сервере, близок к достижению подготовленного предела, сервер переходит в режим только для чтения, чтобы защитить все потерянные записи на сервере. Если объем свободного хранилища меньше 5% от подготовленного размера хранилища, то серверы, для которых не установлено значение 100 гиб, будут помечены как доступные только для чтения. Серверы с более чем 100 подготовленным хранилищем гиб помечаются как доступные только для чтения, если объем свободного хранилища меньше 5 гиб.

Например, если подготовлено 110 гиб хранилища и фактическое использование превышает 105 гиб, сервер помечается как доступный только для чтения. Кроме того, если вы подготовили 5 гиб хранилища, сервер помечается как доступная только для чтения, если объем свободного хранилища превысит 256 МБ.

Пока служба пытается пометить сервер как доступный только для чтения, блокируются все новые запросы на запись транзакций, а выполнение существующих активных транзакций продолжается. Если сервер помечен как доступный только для чтения, все последующие операции записи и фиксации транзакций не выполняются. Запросы на чтение продолжат обрабатываться без перерыва. 

Чтобы сервер был выведен из режима только для чтения, необходимо увеличить подготовленное хранилище на сервере. Это можно сделать с помощью портал Azure или Azure CLI. После увеличения сервер будет готов к приему транзакций записи.

Мы рекомендуем настроить оповещение для получения уведомления о приближении к порогу емкости хранилища сервера, чтобы избежать перехода в состояние только для чтения. Сведения о доступных метриках см. в [статье мониторинг](./concepts-monitoring.md) . 

Рекомендуется <!--turn on storage auto-grow or to--> Настройте оповещение, чтобы уведомить вас о приближении хранилища сервера к пороговому значению, чтобы избежать перезаписи в состояние только для чтения. Дополнительные сведения см. в документации по предупреждению [Настройка оповещения](how-to-alert-on-metric.md).

### <a name="storage-auto-grow"></a>Автоматическое увеличение размера хранилища

Автоматическое увеличение хранилища еще не доступно для гибкого сервера базы данных Azure для MySQL.

## <a name="iops"></a>Количество операций ввода-вывода в секунду
Минимальное количество операций ввода-вывода в секунду составляет 100 для всех вычислений и максимальное число эффективных операций ввода-вывода в секунду определяется обоими следующими атрибутами: 
- Вычисление. Максимальное число операций ввода-вывода в секунду может быть ограничено максимальным количеством операций ввода-вывода в секунду для выбранного размера вычислений.
- Хранилище. на всех уровнях вычислений операции ввода-вывода в секунду масштабируются с использованием подготовленного размера хранилища в соотношении 3:1.

Вы можете масштабировать эффективные операции ввода-вывода, увеличивая объем подготовленного хранилища или Переходя к более крупному размеру вычислений (если число операций ввода-вывода ограничено в результате вычислений). В предварительной версии максимальное число поддерживаемых операций ввода-вывода в секунду составляет 20 000 операций ввода/вывода.

Чтобы узнать больше о максимально эффективных операциях ввода-вывода в секунду на размер вычислений, используйте сочетание вычислений и хранилища. 

| Объем вычислительных ресурсов         | Максимальное число действующих операций ввода-вывода  | 
|----------------------|---------------------|
| **Накапливаемыми ресурсами**        |                     |
| Standard_B1s         | 320                 |
| Standard_B1ms        | 640                 |
| Standard_B2s         | 1280                | 
| **Общего назначения**  |                     |
| Standard_D2ds_v4     | 3200                |
| Standard_D4ds_v4     | 6400                |
| Standard_D8ds_v4     | 12800               |
| Standard_D16ds_v4    | 20 000               |
| Standard_D32ds_v4    | 20 000               |
| Standard_D48ds_v4    | 20 000               | 
| Standard_D64ds_v4    | 20 000               | 
| **С оптимизацией для операций в памяти** |                     | 
| Standard_E2ds_v4     | 3200                | 
| Standard_E4ds_v4     | 6400                | 
| Standard_ E8ds_v4    | 12800               | 
| Standard_ E16ds_v4   | 20 000               | 
| Standard_E32ds_v4    | 20 000               | 
| Standard_E48ds_v4    | 20 000               | 
| Standard_E64ds_v4    | 20 000               |  

Максимальное количество операций ввода-вывода в секунду зависит от максимального количества операций ввода/вывода в секунду на размер вычислений. См. формулу, приведенную ниже, и ознакомьтесь со столбцом *Max некэшированный диск с пропускной способностью в секунду/Мбит* /с в документации серии [B](../../virtual-machines/sizes-b-series-burstable.md), серии [Ddsv4](../../virtual-machines/ddv4-ddsv4-series.md)и [Edsv4](../../virtual-machines/edv4-edsv4-series.md) .

**Максимальное число операций ввода-вывода в секунду** = минимум (*"максимальная пропускная способность некэшированного диска: операций ввода-вывода в секунду/Мбит* /с" для размера вычислений, подготовленное в гиб * 3)

Вы можете отслеживать потребление операций ввода-вывода в портал Azure (с Azure Monitor), используя метрику [процента](./concepts-monitoring.md) . Если требуется больше операций ввода-вывода, необходимо понимать, ограничен ли размер вычислений или подготовленное хранилище. Соответствующим образом масштабируйте вычисление или хранилище сервера.

## <a name="backup"></a>Резервное копирование

В службе автоматически создаются резервные копии сервера. Можно выбрать срок хранения в диапазоне от 1 до 35 дней. Дополнительные сведения о резервном копировании см. в [статье основные понятия резервного копирования и восстановления](concepts-backup-restore.md).

## <a name="scale-resources"></a>Масштабирование ресурсов

После создания сервера можно независимо изменить уровень вычислений, размер вычислений (виртуальных ядер и память), а также объем хранилища и срок хранения резервных копий. Размер вычислений можно масштабировать вверх или вниз. Срок хранения резервной копии может увеличиваться или уменьшаться в течение 1 – 35 дней. Размер хранилища можно только увеличить. Масштабирование ресурсов можно выполнить на портале или Azure CLI.

> [!NOTE]
> Размер хранилища можно только увеличить. Вы не сможете вернуться к меньшему размеру хранилища после увеличения.

При изменении уровня вычислений или размера вычислений сервер перезагружается, чтобы новый тип сервера вступил в силу. Во время перехода системы на новый сервер нельзя будет установить новые подключения, а для всех незафиксированных транзакций будет выполнен откат. Это окно может различаться, но в большинстве случаев — от 60-120 секунд. 

Масштабирование хранилища и изменение срока хранения резервной копии являются оперативными операциями и не требует перезапуска сервера.

## <a name="pricing"></a>Цены

Наиболее актуальные сведения о стоимости см. в статье [Цены на Базу данных Azure для PostgreSQL](https://azure.microsoft.com/pricing/details/MySQL/). Чтобы увидеть стоимость требуемой конфигурации, [портал Azure](https://portal.azure.com/#create/Microsoft.MySQLServer/flexibleServers) отображает месячную стоимость на вкладке " **Вычисление + хранилище** " в зависимости от выбранных параметров. Если у вас нет подписки Azure, для расчета цены можно воспользоваться калькулятором цен Azure. На веб-сайте [калькулятора цен Azure](https://azure.microsoft.com/pricing/calculator/) выберите **Добавить элементы**, разверните категорию **базы данных** , выберите **база данных Azure для MySQL** и **гибкий сервер** в качестве типа развертывания для настройки параметров.

Если вы хотите оптимизировать стоимость сервера, можно рассмотреть следующие советы.

- Если вычисление используется недостаточно, увеличьте масштаб уровня вычислений или размера вычислений (виртуальных ядер).
- Если вашей рабочей нагрузке не требуется непрерывной полной емкости вычислений на основе общего назначения и оптимизированных для памяти уровней, рассмотрите возможность переключения на уровень нагрузки.
- Останавливает сервер, когда он не используется.
- Уменьшите срок хранения резервной копии, если не требуется более длительное хранение резервной копии.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [создать сервер MySQL на портале](quickstart-create-server-portal.md).
- Узнайте об [ограничениях службы](concepts-limitations.md).