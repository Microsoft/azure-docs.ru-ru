---
title: Рекомендации по работе с сервером MySQL. база данных Azure для MySQL
description: В этой статье описываются рекомендации по работе с базой данных MySQL в Azure.
author: mksuni
ms.author: sumuth
ms.service: mysql
ms.topic: conceptual
ms.date: 11/23/2020
ms.openlocfilehash: e1d84483a701bf7fb4e6c50b9dc4f4f89993c64d
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96355118"
---
# <a name="best-practices-for-server-operations-on-azure-database-for-mysql--single-server"></a>Рекомендации по работе сервера с базой данных Azure для MySQL — одиночный сервер

Ознакомьтесь с рекомендациями по работе с базой данных Azure для MySQL. По мере добавления новых возможностей на платформу мы будем продолжать изучение рекомендаций, описанных в этом разделе.

## <a name="azure-database-for-mysql-operational-guidelines"></a>Рекомендации по эксплуатации базы данных Azure для MySQL 

Ниже приведены рекомендации по эксплуатации, которые следует выполнить при работе с базой данных Azure для MySQL для повышения производительности базы данных. 

* **Совместное размещение**. чтобы сократить задержку в сети, разместите клиент и сервер базы данных в одном регионе Azure.

* **Мониторинг использования памяти, ЦП и хранилища**. Вы можете [настроить оповещения](howto-alert-on-metric.md) , чтобы получать уведомления при изменении закономерностей использования или при приближении к емкости развертывания, что позволяет поддерживать производительность и доступность системы. 

* **Увеличение масштаба экземпляра базы данных**. при приближении к ограничениям емкости хранилища можно [увеличивать масштаб](howto-create-manage-server-portal.md) . У вас должен быть буфер в хранилище и память, чтобы обеспечить непредвиденное увеличение спроса в приложениях. Можно также [включить функцию автоматического увеличения размера хранилища](howto-auto-grow-storage-portal.md) "на", чтобы служба автоматически масштабирует хранилище по мере приближения к пределам хранилища. 

* **Настройка резервного копирования**. Включите [локальные или геоизбыточные резервные копии](howto-restore-server-portal.md#set-backup-configuration) в зависимости от требований бизнеса. Кроме того, вы можете изменить срок хранения резервных копий для обеспечения непрерывности бизнес-процессов. 

* **Увеличение емкости операций ввода-вывода**. Если для рабочей нагрузки базы данных требуется больше операций ввода-вывода, чем подготовлено, восстановление или другие транзакционные операции для базы данных будут выполняться медленнее. Чтобы увеличить объем операций ввода-вывода экземпляра сервера, выполните одно из следующих действий. 

    * Служба "база данных Azure для MySQL" обеспечивает масштабирование операций ввода-вывода в течение трех операций ввода-вывода в секунду на подготовленное хранилище. [Увеличьте подготовленное хранилище](howto-create-manage-server-portal.md#scale-storage-up) , чтобы масштабировать операции ввода-вывода для повышения производительности. 

    * Если вы уже используете подготовленное хранилище операций ввода-вывода, предоставьте [дополнительную пропускную способность](howto-create-manage-server-portal.md#scale-storage-up). 

* **Масштабирование вычислительных** ресурсов. Рабочая нагрузка базы данных также может быть ограничена из-за ЦП или памяти, и это может оказать значительное влияние на обработку транзакций. Обратите внимание, что вычисления (ценовая категория) можно масштабировать между [общего назначения или только оптимизированными для памяти](concepts-pricing-tiers.md) уровнями. 

* **Тестирование для отработки отказа**. вручную протестируйте отработку отказа для экземпляра сервера, чтобы понять, как долго процесс принимается в случае вашего варианта использования, и убедитесь, что приложение, которое обращается к экземпляру сервера, может автоматически подключаться к новому экземпляру сервера после

* **Использовать первичный ключ**. Убедитесь, что таблицы имеют первичный или уникальный ключ при работе с базой данных Azure для MySQL. Это помогает существенно делать резервные копии, реплики и т. д., а также повышает производительность.

* **Настройка значения TTL**: Если клиентское приложение кэширует данные службы доменных имен (DNS) экземпляров сервера, установите значение срока жизни (TTL) менее 30 секунд. Поскольку базовый IP-адрес экземпляра сервера может измениться после отработки отказа, кэширование данных DNS для расширенного времени может привести к сбоям подключения, если приложение попытается подключиться к IP-адресу, который больше не находится в службе.

* Используйте пул соединений, чтобы избежать [превышения максимального числа подключений](concepts-server-parameters.md#max_connections), и используйте логику повторных попыток, чтобы избежать периодических проблем с подключением. 

* Если вы используете реплику, используйте [проксискл для балансировки нагрузки](https://techcommunity.microsoft.com/t5/azure-database-for-mysql/scaling-an-azure-database-for-mysql-workload-running-on/ba-p/1105847) между сервером-источником и доступным для чтения сервером вторичной реплики. Инструкции по настройке см. здесь. </br> 

* При подготовке ресурса убедитесь, что вы [включили автоувеличение](howto-auto-grow-storage-portal.md) для базы данных Azure для MySQL. Это не приводит к дополнительным затратам и защищает базу данных от любых узких мест хранилища, с которыми вы можете столкнуться. </br> 


### <a name="using-innodb-with-azure-database-for-mysql"></a>Использование InnoDB с базой данных Azure для MySQL

*   При использовании `ibdata1` функции, которая представляет собой системный Табличный файл данных, не может сжиматься или очищаться путем удаления данных из таблицы или перемещения таблицы в файл на таблицу `tablespaces` .

* Для базы данных размером более 1 ТБ следует создать таблицу в **innodb_file_per_table** `tablespace` . Для одной таблицы, размер которой превышает 1 ТБ, следует создать таблицу [секционирования](https://dev.mysql.com/doc/refman/5.7/en/partitioning.html) .

*   Для сервера, имеющего большое количество `tablespace` , запуск ядра будет очень замедляться из-за последовательного просмотра табличного пространства во время запуска или отработки отказа MySQL. 

* Установите innodb_file_per_table = ON перед созданием таблицы, если общий номер таблицы меньше 500.

* Если в базе данных имеется более 500 таблиц, проверьте размер таблицы для каждой отдельной таблицы. Для большой таблицы следует рассмотреть возможность использования табличного пространства с файлами, чтобы избежать превышения максимального размера хранилища для системных табличных пространств.

> [!NOTE]
> Для таблиц, размер которых меньше 5 ГБ, рассмотрите возможность использования табличного пространства системы. 
> ```sql
>    CREATE TABLE tbl_name ... *TABLESPACE* = *innodb_system*;
> ```

* [Секционирование](https://dev.mysql.com/doc/refman/5.7/en/partitioning.html) таблицы при создании таблицы при наличии очень большой таблицы может привести к увеличению размера, превышающего 1 ТБ.

* Используйте несколько серверов MySQL и распределите таблицы между этими серверами. Старайтесь не размещать слишком много таблиц на одном сервере, если имеется около 10000 таблиц или более. 

## <a name="next-steps"></a>Дальнейшие действия
- [Рекомендации по производительности базы данных Azure для MySQL](concept-performance-best-practices.md)
- [Рекомендации по мониторингу базы данных Azure для MySQL](concept-monitoring-best-practices.md)
