---
title: Восстановление удаленной базы данных Azure для сервера MySQL
description: В этой статье описывается, как восстановить удаленный сервер в базе данных Azure для MySQL с помощью портал Azure.
author: savjani
ms.author: pariks
ms.service: mysql
ms.topic: how-to
ms.date: 10/09/2020
ms.openlocfilehash: 34dddd8e5f3fb418fc7155630bf82a922e418402
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97657096"
---
# <a name="restore-a-dropped-azure-database-for-mysql-server"></a>Восстановление удаленной базы данных Azure для сервера MySQL

При удалении сервера резервная копия сервера базы данных может храниться в службе до пяти дней. Доступ к резервной копии базы данных можно получить и восстановить только из подписки Azure, в которой изначально находился сервер. Для восстановления удаленного ресурса сервера MySQL в течение 5 дней с момента удаления сервера можно выполнить следующие рекомендуемые действия. Рекомендуемые действия сработают, только если резервная копия сервера по-прежнему доступна и не удалена из системы. 

## <a name="pre-requisites"></a>Предварительные требования
Чтобы восстановить удаленную базу данных Azure для сервера MySQL, вам потребуется следующее:
- Имя подписки Azure, в которой размещен исходный сервер
- Расположение, в котором был создан сервер

## <a name="steps-to-restore"></a>Действия по восстановлению

1. Перейдите в колонку [Журнал действий](https://ms.portal.azure.com/#blade/Microsoft_Azure_ActivityLog/ActivityLogBlade) из раздела мониторинг в портал Azure. 

2. В журнале действий щелкните **Добавить фильтр** , как показано, и установите следующие фильтры для 

    - **Subscription** = ваша подписка, в которой размещен удаленный сервер
    - **Тип ресурса** = база данных Azure для серверов MySQL (Microsoft. дбформискл/Servers) 
    - **Операция** = удаление MySQL Server (Microsoft. дбформискл/Servers/Delete) 
 
     [![Фильтр журнала действий, отфильтрованный для операции удаления сервера MySQL](./media/howto-restore-dropped-server/activity-log.png)](./media/howto-restore-dropped-server/activity-log.png#lightbox)
   
 3. Дважды щелкните событие удаление сервера MySQL и перейдите на вкладку JSON и обратите внимание на атрибуты resourceId и Субмиссионтиместамп в выходных данных JSON. ResourceId имеет следующий формат:/Субскриптионс/фффффффф-ФФФФ-ФФФФ-ФФФФ-фффффффффффф/ресаурцеграупс/таржетресаурцеграуп/провидерс/Микрософт.дбформискл/серверс/делетедсервер.
 
 4. Перейдите на [страницу создание REST API сервера](/rest/api/mysql/servers/create) и щелкните вкладку "попробовать", выделенную зеленым цветом, и войдите в нее с помощью учетной записи Azure.
 
 5. Укажите resourceGroupName, serverName (имя удаленного сервера), subscriptionId, производное от атрибута resourceId, захваченного на шаге 3, а версия API предварительно заполнена, как показано на рисунке.
 
     [![Создание сервера с помощью REST API](./media/howto-restore-dropped-server/create-server-from-rest-api.png)](./media/howto-restore-dropped-server/create-server-from-rest-api.png#lightbox)
  
 6. Прокрутите страницу ниже в разделе текст запроса и вставьте следующую замену "Удаленные расположения сервера", "Субмиссионтиместамп" и "resourceId". Для параметра "Ресторепоинтинтиме" укажите значение "Субмиссионтиместамп" минус **15 минут** , чтобы команда не выдает ошибку.
 
    ```json
    {
        "location": "Dropped Server Location",  
        "properties": 
            {
                "restorePointInTime": "submissionTimestamp - 15 minutes",
                "createMode": "PointInTimeRestore",
                "sourceServerId": "resourceId"
            }
    }
    ```

7. Если вы видите код ответа 201 или 202, запрос на восстановление успешно отправлен. 

8. Создание сервера может занять некоторое время в зависимости от размера базы данных и вычислительных ресурсов, подготовленных на исходном сервере. Состояние восстановления можно отслеживать из журнала действий путем фильтрации для 
   - **Subscription** = ваша подписка
   - **Тип ресурса** = база данных Azure для серверов MySQL (Microsoft. дбформискл/Servers) 
   - **Операция** = обновление создания сервера MySQL

## <a name="next-steps"></a>Дальнейшие действия
- Если вы пытаетесь восстановить сервер в течение пяти дней и по-прежнему выдается сообщение об ошибке, выполнив описанные выше действия, откройте обращение в службу поддержки. Если вы пытаетесь восстановить удаленный сервер через пять дней, ожидается ошибка, так как не удается найти файл резервной копии. Не открывайте запрос в службу поддержки в этом сценарии. Группа поддержки не может предоставить помощь в случае удаления резервной копии из системы. 
- Чтобы предотвратить случайное удаление серверов, мы настоятельно рекомендуем использовать [блокировки ресурсов](https://techcommunity.microsoft.com/t5/azure-database-for-mysql/preventing-the-disaster-of-accidental-deletion-for-your-mysql/ba-p/825222).