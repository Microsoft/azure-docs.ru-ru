---
title: Анализ производительности запросов в Базе данных Azure для MySQL
description: В этой статье описана функция анализа производительности запросов в Базе данных Azure для MySQL.
author: savjani
ms.author: pariks
ms.service: mysql
ms.topic: conceptual
ms.date: 5/12/2020
ms.openlocfilehash: 30457b950e6400c799f35924e7b2ee90d868a465
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94535186"
---
# <a name="query-performance-insight-in-azure-database-for-mysql"></a>Анализ производительности запросов в Базе данных Azure для MySQL

**Применимо к:** База данных Azure для MySQL 5.7, 8.0.

Этот компонент помогает быстро определить наиболее медленно выполняющиеся запросы, их изменение со временем и ожидания каких действий влияют на них.

## <a name="common-scenarios"></a>Распространенные сценарии

### <a name="long-running-queries"></a>Длительные запросы

- Определение самых медленно выполняющихся запросов за прошедшие X часов.
- Определение основных N запросов, ожидающих ресурсы.
 
### <a name="wait-statistics"></a>Статистика ожидания

- Понимание характера ожидания запроса.
- Понимание тенденций ожидания ресурсов и причин состязания за ресурсы.

## <a name="permissions"></a>Разрешения

Чтобы просматривать текст запросов в анализе производительности запросов, требуются разрешения **Владельца** или **Участника**. **Модуль чтения** может просматривать графики и таблицы, но не текст запросов.

## <a name="prerequisites"></a>Предварительные требования

Чтобы компонент "Анализ производительности запросов" работал, данные должны находиться в [хранилище запросов](concepts-query-store.md).

## <a name="viewing-performance-insights"></a>Просмотр анализа производительности

Представление [анализа производительности запросов](concepts-query-performance-insight.md) на портале Azure содержит визуализации ключевых данных из хранилища запросов.

На странице портала сервера Базы данных Azure для MySQL выберите **Анализ производительности запросов** в разделе **Интеллектуальная производительность** в строке меню.

### <a name="long-running-queries"></a>Длительные запросы

На вкладке **Длительные запросы** отображаются 5 наиболее частых запросов, упорядоченных по средней продолжительности выполнения и объединенных в 15-минутные интервалы. Дополнительные запросы можно выбрать в раскрывающемся списке **Количество запросов**. При этом цвета, соответствующие тому или иному идентификатору запроса на графике, могут изменяться.

Чтобы уменьшить временной интервал графика, перетащите его границу. Кроме того, для просмотра более коротких или более длинных периодов используйте соответственно значки увеличения и уменьшения масштаба.

:::image type="content" source="./media/concepts-query-performance-insight/query-performance-insight-landing-page.png" alt-text="Анализ производительности медленно выполняющихся запросов"::: 

### <a name="wait-statistics"></a>Статистика ожидания

> [!NOTE]
> Статистика ожидания предназначена для устранения проблем с производительностью запросов. Рекомендуется включать эту функцию только в целях устранения неполадок. <br>Если вы увидите на портале Azure сообщение об ошибке *Возникла проблема с "Microsoft.DBforMySQL". Не удалось выполнить запрос. Если проблема сохраняется или является непредвиденной ошибкой, обратитесь в службу поддержки с этими сведениями* при просмотре статистики ожидания, укажите меньший период времени.

Статистика ожидания обеспечивает представление событий ожидания, происходящих во время выполнения определенного запроса. Узнайте больше о типах событий ожидания в [документации по ядру MySQL](https://go.microsoft.com/fwlink/?linkid=2098206).

Откройте вкладку **Статистика ожидания**, чтобы посмотреть визуализации ожидания на сервере.

Сведения, отображаемые в представлении статистики ожидания, группируются по запросам с максимальным временем ожидания на заданном интервале времени.

:::image type="content" source="./media/concepts-query-performance-insight/query-performance-insight-wait-statistics.png" alt-text="Статистика ожидания в анализе производительности запросов":::

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше о [мониторинге и настройке](concepts-monitoring.md) в Базе данных Azure для MySQL.