---
title: Руководство по созданию приложения для мониторинга потребления воды в Azure IoT Central
description: Руководство по Узнайте, как создать приложение для мониторинга потребления воды с использованием шаблонов приложений Azure IoT Central.
author: miriambrus
ms.author: miriamb
ms.date: 12/11/2020
ms.topic: tutorial
ms.service: iot-central
services: iot-central
manager: abjork
ms.openlocfilehash: 476a0c2d75dcbee5c1ed4d758e0cbc9d4726ff95
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97587202"
---
# <a name="tutorial-create-a-water-consumption-monitoring-application-with-azure-iot-central"></a>Руководство по Создание приложения для мониторинга потребления воды в Azure IoT Central

В этом руководстве описано, как создать приложение для мониторинга потребления воды в Azure IoT Central, используя соответствующий шаблон Azure IoT Central.

В этом учебнике рассматривается следующее.

> [!div class="checklist"]
> * Использование шаблона Azure IoT Central "Мониторинг потребления воды" для создания приложения.
> * Изучение и настройка панели мониторинга оператора.
> * Изучение шаблонов устройств.
> * Изучение имитированных устройств.
> * Изучение и настройка правил.
> * Настройка заданий.
> * Настройка фирменной символики приложений с использованием белых меток.

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим учебником необходимы указанные ниже компоненты.

- Подписка Azure. Если у вас еще нет подписки, создайте ее на [странице регистрации в Azure](https://aka.ms/createazuresubscription);

## <a name="create-a-water-consumption-monitoring-app-with-azure-iot-central"></a>созданию приложения для мониторинга потребления воды в Azure IoT Central

В этом разделе вы будете использовать соответствующий шаблон Azure IoT Central, чтобы создать приложение для мониторинга потребления воды в Azure IoT Central.

Для этого сделайте следующее:

1. Перейдите на [домашнюю страницу Azure IoT Central](https://aka.ms/iotcentral).

    Если у вас есть подписка Azure, выполните вход с ее учетными данными. В противном случае используйте для входа учетную запись Майкрософт.

    ![Ввод учетной записи организации](media/tutorial-waterconsumptionmonitoring/sign-in.png)

1. Выберите **Сборка** в области слева, а затем — вкладку **Правительство**. На странице **Правительство** показаны несколько шаблонов приложений для соответствующих организаций.

   ![Шаблоны для сборки приложений для государственных организаций](./media/tutorial-waterconsumptionmonitoring/iotcentral-government-tab-overview1.png)

1. Выберите шаблон приложения **Мониторинг потребления воды**.
Он предусматривает шаблон устройства, потребляющего воду, имитированное устройство, панель мониторинга оператора и предварительно настроенные правила мониторинга.

1. Щелкните **Создать приложение**. Откроется форма создания приложения **Новое приложение** со следующими полями.
    * **Имя приложения**: по умолчанию для приложения используется имя *Мониторинг потребления воды*. За именем следует строка уникального идентификатора, который создает Azure IoT Central. При желании выберите понятное имя для приложения. Имя приложения также можно изменить позже.
    * **URL-адрес**. Azure IoT Central автоматически создает URL-адрес на основе имени приложения. Вы можете заменить этот URL-адрес на необходимый. Его также можно изменить позже.
    * Если у вас есть подписка Azure, укажите **каталог**, **подписку Azure** и **расположение**. Если у вас нет подписки, вы можете выбрать **семидневную бесплатную пробную версию** и указать необходимые контактные данные.

    Дополнительные сведения о каталогах и подписках приведены в кратком руководстве по [созданию приложения Azure IoT Central](../core/quick-deploy-iot-central.md).

1. В нижней части страницы выберите **Создать**.

    ![Страница создания приложения Azure IoT Central](./media/tutorial-waterconsumptionmonitoring/new-application-waterconsumptionmonitoring.png)

    ![Страница сведений о выставлении счетов Azure IoT Central](./media/tutorial-waterconsumptionmonitoring/new-application-waterconsumptionmonitoring-billinginfo.png)

Вы создали приложение для мониторинга потребления воды, используя соответствующий шаблон Azure IoT Central.

Это приложение для мониторинга потребления воды уже содержит настроенные:

* примеры панелей мониторинга для операторов;
* примеры предопределенных шаблонов измерителя скорости потока воды и вентилей;
* имитированные измерители скорости потока воды и интеллектуальные вентили;
* правила и задания;
* пример фирменной символики с использованием белых меток.

Вы можете в любое время вносить изменения в свое приложение. Теперь изучим это приложение и настроим его.

## <a name="explore-and-customize-the-operator-dashboard"></a>Изучение и настройка панели мониторинга оператора

После создания приложения откроется пример **панели мониторинга потребления воды Wide World Water**.

   ![Панель мониторинга потребления воды](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-dashboardfull.png)

Как сборщик вы можете создавать и настраивать на панели мониторинга представления, которые будут использовать операторы. Но прежде чем что-то настроить, сначала ознакомимся с панелью мониторинга.

> [!NOTE]
> Все данные, которые отображаются на панели мониторинга, основаны на данных с имитированного устройства, речь о котором пойдет в следующем разделе.
  
Панель мониторинга состоит из плиток различных видов:

* **Плитка с изображением службы водоснабжения Wide World Water**. Первая на панели мониторинга плитка — это плитка вымышленной службы Wide World Water. Вы можете настроить эту плитку и добавить свое изображение или вовсе удалить ее.
* **Плитка средних ключевых показателей эффективности, подаваемых измерителем скорости потока воды**. Это плитка КПЭ, настроенная для отображения, к примеру, *среднего значения за последние 30 мин*. Вы можете настроить плитку КПЭ, указав другой тип и диапазон времени.
* **Плитки управления устройствами**. Это плитки **Close valve** (Закрыть вентиль), **Open valve** (Открыть вентиль) и **Set valve position** (Установить положение вентиля). Щелкните команду, чтобы перейти на ее страницу управления имитированным устройством. В Azure IoT Central *команда* — это *тип возможности* устройства. Это понятие будет рассмотрено позже в разделе "шаблон устройства" данного руководства.
* **Карта области распределения воды**. Эта карта использует службу Azure Maps, которую можно настроить прямо в Azure IoT Central. На фрагменте карты отображается расположение устройств. Наведите указатель мыши на карту и используйте ее элементы управления, такие как *увеличение*, *уменьшение* и *развертывание*.

    ![Карта на панели мониторинга потребления воды](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-dashboard-map.png)

* **График среднего потока воды** и **график условий окружающей среды**. Вы можете визуализировать один или несколько наборов данных телеметрии с устройств за нужный диапазон времени.
* **Диаграмма в виде тепловой карты для среднего значения давления на вентиль**. Вы можете выбрать тип визуализации тепловой карты для данных телеметрии устройств, которые нужно показать, и распределить их по диапазону времени с помощью индекса цвета.
* **Плитка сброса содержимого порогов предупреждения**. Вы можете добавить плитки содержимого с призывом к действию, внедрив в них ссылки на страницы действий. В этом случае после сброса порога предупреждения отображается область **заданий** приложения, где можно будет обновить свойства устройства. Эта возможность будет рассмотрена далее, в разделе "Настройка заданий" этого руководства.
* **Плитки свойств**. На панели мониторинга отображаются плитки **Valve operational info** (Информация о работе вентиля), **Flow alert thresholds** (Пороги предупреждения для потока) и **Maintenance info** (Сведения об обслуживании).

### <a name="customize-the-dashboard"></a>Настройка панели мониторинга

Разработчик может настроить представления на панели мониторинга для операторов.

1. Выберите **Изменить**, чтобы настроить **панель мониторинга потребления воды Wide World Water**. Вы можете настроить панель мониторинга, выбрав меню **Изменить**. Когда панель мониторинга находится в режиме **правки**, можно добавить новые плитки или настроить существующие.

     ![Изменение панели мониторинга](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-edit-dashboard.png)

1. Нажмите кнопку **+ Создать**, чтобы создать панель мониторинга и настроить ее с нуля. Вы можете создать несколько панелей мониторинга и перемещаться между ними с помощью меню панелей.

## <a name="explore-the-device-template"></a>Изучение шаблона устройства

В шаблоне устройства в Azure IoT Central определены возможности устройства, например телеметрия, свойство или команда. Разработчик может определить один или несколько шаблонов в Azure IoT Central, которые представляют возможности подключаемых устройств.

Приложение для мониторинга потребления воды поставляется с двумя шаблонами устройств, представляющими *измеритель скорости потока* и *интеллектуальный вентиль*.

Чтобы просмотреть шаблон устройства, сделайте следующее:

1. Выберите **Шаблоны устройств** в крайней левой области приложения в Azure IoT Central. В списке **Шаблоны устройств** вы увидите два шаблона, **Flow meter** (Измеритель скорости потока) и **Smart Valve** (Интеллектуальный вентиль).

   ![Шаблон устройства](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-devicetemplate.png)

1. Щелкните шаблон **Flow meter** (Измеритель скорости потока) и ознакомьтесь с возможностями устройства.

     ![Шаблон устройства "Flow meter" (Измеритель скорости потока)](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-devicetemplate-flowmeter.png)

### <a name="customize-the-device-template"></a>Настройка шаблона устройства

Вот как можно настроить шаблон устройства.

1. Выберите **Настроить** в меню **Шаблоны устройств**.
1. Найдите тип телеметрии `Temperature`.
1. Замените имя `Temperature` в столбце **Отображаемое имя** на `Reported temperature`.
1. Измените единицу измерения или установите **минимальное** и **максимальное значения**.
1. Щелкните **Сохранить**, чтобы сохранить все изменения.

### <a name="add-a-cloud-property"></a>Добавление свойства облака

1. Выберите **Свойства облака** в меню **Шаблоны устройств**.
1. Щелкните **+ Добавить облачное свойство**, чтобы добавить новое свойство облака.
    В Azure IoT Central можно добавить свойство, которое относится к устройству. Одним из примеров такого свойства является порог предупреждения, относящийся к области монтажа, сведениям о ресурсах или другим сведениям об обслуживании.
1. Щелкните **Сохранить**, чтобы сохранить все изменения.

### <a name="views"></a>Представления

Шаблон устройства для мониторинга потребления воды поставляется с предопределенными представлениями. Ознакомьтесь с ними и внесите необходимые изменения. В представлениях определяется, как операторы будут видеть данные устройства, и вводятся свойства облака.

  ![Представления для шаблона устройства](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-devicetemplate-views.png)

### <a name="publish"></a>Публикация

Если вы внесли изменения, обязательно **опубликуйте** шаблон устройства.

### <a name="create-a-new-device-template"></a>Создание шаблона нового устройства

Нажмите кнопку **+ Создать**, чтобы создать шаблон устройства, и выполните всю процедуру.
Вы можете создать настраиваемый шаблон устройства с нуля или выбрать шаблон из каталога устройств Azure.

## <a name="explore-simulated-devices"></a>Изучение имитированных устройств

В Azure IoT Central вы можете также создавать имитированные устройства для тестирования шаблона устройства и приложения. В приложении для мониторинга потребления воды есть два имитированных устройства, которые соответствуют шаблонам **Flow meter** (Измеритель скорости потока) и **Smart Valve** (Интеллектуальный вентиль).

### <a name="view-the-devices"></a>Просмотр устройств

1. В левой области выберите **Шаблоны устройств** > **Все устройства**.

   ![Область "Все устройства"](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-devices.png)

1. Выберите **Smart Valve 1**.

    ![Smart Valve 1](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitor-device1.png)

1. На вкладке **Device Commands** (Команды устройства) можно увидеть три команды: **Open Valve** (Открыть вентиль), **Close Valve** (Закрыть вентиль) и **Set Valve position** (Установить положение вентиля), которые являются возможностями, определенными в шаблоне **Smart Valve** (Интеллектуальный вентиль).

1. Изучите вкладку **Свойства устройства** и вкладку **Панель мониторинга устройства**.

> [!NOTE]
> Обратите внимание на то, что все вкладки настроены с помощью представлений шаблона устройства.

### <a name="add-new-devices"></a>Добавление новых устройств

Добавьте новые устройства, нажав кнопку **+ Создать** на вкладке **Устройства**.

## <a name="explore-and-configure-rules"></a>Изучение и настройка правил

В Azure IoT Central можно создавать правила для автоматических мониторинга телеметрии устройств и активации действий при выполнении одного или нескольких условий. Действия могут включать в себя отправку уведомлений по электронной почте либо активацию действия Microsoft Power Automate или веб-перехватчика для отправки данных в другие службы.

В созданном приложении для мониторинга потребления воды есть три предварительно настроенных правила.

### <a name="view-rules"></a>Просмотр правил

1. В левой области щелкните **Правила**.

   ![Область "Правила"](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-rules.png)

1. Выберите **High pH alert** (Оповещение о высоком уровне pH), которое является одним из предварительно настроенных правил в приложении.

     !["High pH alert" (Предупреждение о высоком уровне pH)](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-highflowalert.png)

    Правило `High flow alert` настроено для проверки того, больше ли `Acidity (pH)` (`greater than`), чем `Max flow threshold`. Максимальный порог предупреждения потока — это свойство облака, определенное в шаблоне устройства **Smart Valve** (Интеллектуальный вентиль). Значение `Max flow threshold` задается для каждого экземпляра устройства.

Теперь создадим действие отправки сообщения.

Чтобы добавить действие к правилу, выполните следующие действия.

1. Нажмите **+ Электронная почта**.
1. Задайте **Уведомление о высоком уровне pH** в качестве понятного **отображаемого имени** для действия.
1. Введите адрес электронной почты, связанный с вашей учетной записью Azure IoT Central, в поле **Кому**.
1. При необходимости введите заметку, которая будет включена в текст сообщения электронной почты.
1. Нажмите кнопку **Готово**, чтобы завершить создание действия.
1. Выберите **Сохранить**, чтобы сохранить и активировать новое правило.

В течение нескольких минут вы получите электронное сообщение, если будет выполнено настроенное условие.

> [!NOTE]
> Приложение отправляет сообщения при каждом выполнении условия. **Отключите** правило, чтобы прекратить получение сообщений при соблюдении условия автоматического правила.
  
Чтобы создать правило, сделайте следующее:

* Выберите **+ Создать** на вкладке **Правила** в левой области.

## <a name="configure-jobs"></a>Настройка заданий

В Azure IoT Central с помощью заданий можно активировать обновления свойств устройства или облака на нескольких устройствах. В дополнение к активации свойств, можно также использовать задания для активации команд устройства на нескольких устройствах. Azure IoT Central автоматизирует для вас рабочий процесс.

1. В левой области щелкните **Задания**.
1. Выберите **+ Создать** и настройте одно или несколько заданий.

## <a name="customize-your-application"></a>Настройка приложения

Создатель приложения может изменить несколько параметров, чтобы настроить взаимодействие с пользователем в приложении.

1. Выберите **Администрирование** > **Настройка приложения**.
1. Используйте кнопку **Изменить**, чтобы выбрать изображение для отправки в качестве **логотипа приложения**.
1. Используйте кнопку **Изменить**, чтобы выбрать изображение как **значок браузера**, который будет отображаться на вкладках браузера.
1. Вы также можете заменить цвета по умолчанию в разделе **Цвета браузера**, добавив шестнадцатеричные коды цветов HTML.

   ![Параметры логотипа приложения, значка браузера и цветов браузера](./media/tutorial-waterconsumptionmonitoring/waterconsumptionmonitoring-customize-your-application.png)

1. Можно также изменить изображения приложения, выбрав **Администрирование** > **Настройка приложения**. Используйте кнопку **Выберите изображение**, чтобы выбрать изображение для отправки в качестве логотипа приложения.
1. Наконец, можно также изменить **тему**, выбрав значок **Параметры** в правом верхнем углу приложения.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы не собираетесь использовать это приложение в дальнейшем, удалите его.

1. Откройте вкладку **Администрирование** в области слева в приложении Azure IoT Central.
1. Выберите **Настройка приложения** и нажмите кнопку **Удалить** в нижней части страницы.

## <a name="next-steps"></a>Дальнейшие действия

* Кроме того, вы можете узнать больше о: 

> [!div class="nextstepaction"]
> [эталонной архитектуре решения для мониторинга потребления воды](./concepts-waterconsumptionmonitoring-architecture.md).
