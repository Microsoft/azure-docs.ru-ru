---
title: Разработка для устройств для Azure IoT Central | Документация Майкрософт
description: Azure IoT Central — это платформа приложений Интернета вещей, которая упрощает создание решений для Интернета вещей. В этой статье приведены общие сведения о разработке для устройств для подключения к приложению IoT Central. Устройства используют телеметрию для отправки потоковых данных и свойств в отчет о состоянии устройств. Центр Интернета вещей может назначать устройству состояние с помощью перезаписываемых свойств и вызывать команды на устройстве.
author: dominicbetts
ms.author: dobett
ms.date: 05/05/2020
ms.topic: conceptual
ms.service: iot-central
services: iot-central
ms.custom:
- mvc
- device-developer
ms.openlocfilehash: ebd2759d4dfb8ee79130f9b4876eba8d45226d04
ms.sourcegitcommit: 79c9c95e8a267abc677c8f3272cb9d7f9673a3d7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/19/2021
ms.locfileid: "107718797"
---
# <a name="iot-central-device-development-guide"></a>Руководство по разработке для устройств для IoT Central

*Эта статья предназначена для разработчиков устройств*

Приложение IoT Central позволяет отслеживать миллионы устройств и управлять ими на протяжении всего жизненного цикла. Это руководство предназначено для разработчиков устройств, которые реализуют код для выполнения на устройствах, подключающихся к IoT Central.

Устройства взаимодействуют с приложением IoT Central, используя следующие примитивы:

- _Телеметрия_. Данные, которые устройство отправляет в IoT Central. Например, поток значений температуры со встроенного датчика.
- _Свойства_. Значения состояния, которые устройство сообщает IoT Central. Например, текущая версия встроенного ПО на устройстве. Можно также использовать записываемые свойства, которые IoT Central может обновлять на устройстве, например требуемое значение температуры.
- _Команды_. Вызываются из IoT Central для управления поведением устройства. Например, приложение IoT Central может вызвать команду для перезагрузки устройства.

Построитель решений отвечает за настройку панелей мониторинга и представлений в веб-интерфейсе IoT Central для визуализации телеметрии, управления свойствами и вызова команд.

## <a name="types-of-device"></a>Типы устройств

В следующих разделах описываются основные типы устройств, которые можно подключить к приложению IoT Central.

### <a name="standalone-device"></a>Изолированное устройство

Изолированное устройство подключается напрямую к IoT Central. Изолированное устройство обычно отправляет приложению IoT Central данные телеметрии со встроенных или подключенных датчиков. Изолированные устройства также могут сообщать значения свойств, принимать значения записываемых свойств и реагировать на команды.

### <a name="gateway-device"></a>Устройство шлюза

Устройство шлюза управляет одним или несколькими подчиненными устройствами, которые подключены к приложению IoT Central. Для настройки связей между подчиненными устройствами и устройством шлюза используется IoT Central. Дополнительные сведения см. в статье [Определение нового типа устройства шлюза Интернета вещей в приложении Azure IoT Central](./tutorial-define-gateway-device-type.md).

### <a name="edge-device"></a>Пограничное устройство

Пограничное устройство подключается напрямую к IoT Central, но при этом действует как посредник для других устройств, которые называются _конечными_. Пограничное устройство обычно находятся рядом с конечными устройствам, для которых оно выступает в качестве посредника. Ниже приведены примеры сценариев, в которых используются пограничные устройства.

- Подключение через пограничное устройство для устройств, которые не могут подключаться напрямую к IoT Central. Например, конечное устройство может использовать Bluetooth для подключения к пограничному устройству, которое затем подключается через Интернет к IoT Central.
- Агрегирование телеметрии перед отправкой в IoT Central. Такой подход может помочь снизить затраты на отправку данных в IoT Central.
- Локальное управление конечными устройствами во избежание задержек, связанных с подключением к IoT Central через Интернет.

Пограничное устройство может также отправлять собственные данные телеметрии, сообщать свои свойства и реагировать на обновления и команды записываемых свойств.

IoT Central видит только само пограничное устройство без конечных устройств, которые к нему подключены.

Дополнительные сведения см. в статье [Руководство по добавлению устройства Azure IoT Edge в приложение Azure IoT Central](./tutorial-add-edge-as-leaf-device.md).

## <a name="connect-a-device"></a>Подключение устройства

Azure IoT Central использует [Службу подготовки устройств к добавлению в Центр Интернета вещей (DPS)](../../iot-dps/about-iot-dps.md) в Azure для всех регистраций и подключений устройств.

DPS позволяет следующее:

- Использовать IoT Central для поддержки адаптации и подключения устройств в большом масштабе.
- Создавать учетные данные устройства и настраивать устройства в автономном режиме без необходимости их регистрации в пользовательском интерфейсе IoT Central.
- Использовать собственные идентификаторы устройств для регистрации устройств в IoT Central. Использование собственных идентификаторов устройств упрощает интеграцию с существующими системами операционных отделов организации.
- Использование единой процедуры подключения устройств к IoT Central.

Дополнительные сведения см. в статьях [Подключение к Azure IoT Central](./concepts-get-connected.md) и [Рекомендации по разработке устройств](concepts-best-practices.md).

### <a name="security"></a>Безопасность

Подключение между устройством и приложением IoT Central защищено с помощью [подписанных URL-адресов](./concepts-get-connected.md#sas-group-enrollment) или стандартных для отрасли [сертификатов X.509](./concepts-get-connected.md#x509-group-enrollment).

### <a name="communication-protocols"></a>Протоколы связи

Для подключения к IoT Central устройство может использовать протоколы связи MQTT, AMQP и HTTPS. На внутреннем уровне для обеспечения возможности подключения устройств IoT Central использует центр Интернета вещей. Дополнительные сведения о поддерживаемых Центром Интернета вещей протоколах связи для подключения устройств, см. в [справочнике по выбору протокола связи](../../iot-hub/iot-hub-devguide-protocols.md).

## <a name="implement-the-device"></a>Реализация поведения устройства

Шаблон устройства IoT Central включает в себя _модели_, которая определяет поведение, которое должно быть реализовано устройством этого типа. К поведению относятся данные телеметрии, свойства и команды.

> [!TIP]
> Модель можно экспортировать из IoT Central как JSON-файл [Digital Twins Definition Language (DTDL) v2](https://github.com/Azure/opendigitaltwins-dtdl).

Каждая модель имеет уникальный идентификатор _DTMI_, такой как `dtmi:com:example:Thermostat;1`. Когда устройство подключается к IoT Central, оно отправляет DTMI реализуемой модели. IoT Central можете связать правильный шаблон устройства с устройством.

[IoT Plug and Play](../../iot-pnp/overview-iot-plug-and-play.md) определяет набор соглашений, которым должно следовать устройство при реализации модели DTDL.

[Пакеты SDK для устройств Azure IoT](#languages-and-sdks) поддерживают соглашения Plug and Play IoT.

### <a name="device-model"></a>Модель устройства

Модель устройства определяется с помощью [DTDL](https://github.com/Azure/opendigitaltwins-dtdl). Этот язык позволяет определить следующее.

- Данные телеметрии, отправляемые устройством. Определение включает в себя имя и тип данных телеметрии. Например, устройство отправляет данные телеметрии температуры как тип double.
- Сведения о свойствах, которые устройство передает в IoT Central. Определение свойства включает в себя его имя и тип данных. Например, устройство сообщает о состоянии вентиля как логическом значении.
- Свойства, которые устройство может получить из IoT Central. При необходимости можно пометить свойство как доступное для записи. Например, IoT Central отправляет целевую температуру в виде значения типа double на устройство.
- Команды, на которые отвечает устройство. Определение включает в себя имя команды, а также имена и типы данных любых параметров. Например, устройство реагирует на команду перезагрузки, которая задает количество секунд ожидания перед перезагрузкой.

Модель DTDL может быть _безкомпонентной_ или _многокомпонентной_.

- Безкомпонентная модель Это простая модель, в которой не используются внедренные или каскадные компоненты. Все данные телеметрии, свойства и команды определяются по одному _компоненту по умолчанию_. Пример см. в модели [термостата](https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/samples/Thermostat.json).
- Многокомпонентная модель. Более сложная модель, содержащая два или более компонентов. Среди этих компонентов — один компонент по умолчанию и один или несколько дополнительных вложенных компонентов. Пример см. в модели [контроллера температуры](https://github.com/Azure/opendigitaltwins-dtdl/blob/master/DTDL/v2/samples/TemperatureController.json).

Дополнительные сведения см. в статье [Руководство по созданию моделей IoT Plug and Play](../../iot-pnp/concepts-modeling-guide.md).

### <a name="conventions"></a>Соглашения

Устройство должно следовать соглашениям Plug and Play IoT при обмене данными с IoT Central. Эти соглашения включают в себя:

- отправку DTMI при подключении к IoT Central;
- отправку правильно отформатированных полезных данных JSON и метаданных в IoT Central;
- правильные ответы на перезаписываемые свойства и команды из IoT Central;
- следование соглашениям об именовании для команд компонентов.

> [!NOTE]
> В настоящее время IoT Central не полностью поддерживает типы данных **Массив** и **Геопространственный** DTDL.

Дополнительные сведения о формате сообщений JSON для устройства с IoT Central см. в разделе [Полезные данные телеметрии, свойств и команд](concepts-telemetry-properties-commands.md).

Дополнительные сведения о соглашениях Plug and Play IoT см. в разделе [Соглашения IoT Plug and Play](../../iot-pnp/concepts-convention.md).

### <a name="device-sdks"></a>Пакеты SDK для устройств

Чтобы реализовать поведение устройства, используйте один из [пакетов SDK для устройств Azure IoT](../../iot-hub/iot-hub-devguide-sdks.md#azure-iot-hub-device-sdks). Код должен выполнять перечисленные ниже действия.

- Регистрировать устройство в DPS и использовать сведения из DPS для подключения к внутреннему центру Интернета вещей в приложении IoT Central.
- Объявлять DTMI модели, которую реализует устройство.
- Отправлять данные телеметрии в формате, указанном моделью устройства. IoT Central использует модель в шаблоне устройства, чтобы определить, как применять данные телеметрии для визуализации и анализа.
- Синхронизировать значения свойств на устройстве и в IoT Central. В модели указываются имена и типы данных свойств, чтобы решение IoT Central могло отображать сведения.
- Реализовать обработчики команд для команд, указанных в модели. В модели указываются имена и параметры команд, которые должно использовать устройство.

Дополнительные сведения о роли шаблонов устройств см. в разделе [Что такое шаблоны устройств?](./concepts-device-templates.md).

Пример кода см. в статье о [создании и подключении клиентского приложения](./tutorial-connect-device.md).

### <a name="languages-and-sdks"></a>Языки и пакеты SDK

Дополнительные сведения о поддерживаемых языках и пакетах SDK см. в разделе [Пакеты SDK для устройств Центра Интернета вещей Azure](../../iot-hub/iot-hub-devguide-sdks.md#azure-iot-hub-device-sdks).

## <a name="next-steps"></a>Дальнейшие действия

Если вы являетесь разработчиком устройства и хотите ознакомиться с кодом, [создайте и подключите клиентское приложение к приложению Azure IoT Central](./tutorial-connect-device.md).

Если вы хотите узнать больше об использовании IoT Central, рекомендуем далее ознакомиться с циклом кратких руководств. Начните со статьи [Создание приложения Azure IoT Central](./quick-deploy-iot-central.md).
