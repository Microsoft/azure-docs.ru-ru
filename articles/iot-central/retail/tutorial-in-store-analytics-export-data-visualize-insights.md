---
title: Учебник по экспорту данных и визуализации аналитических сведений в Azure IoT Central
description: В этом руководстве описано, как экспортировать данные из IoT Central и визуализировать аналитические сведения на панели мониторинга Power BI.
services: iot-central
ms.service: iot-central
ms.subservice: iot-central-retail
ms.topic: tutorial
ms.custom:
- iot-storeAnalytics-checkout
- iot-p0-scenario
ms.author: dobett
author: dominicbetts
ms.date: 11/12/2019
ms.openlocfilehash: 2695b34745ff02d55f18cebbe87a468f807ca77a
ms.sourcegitcommit: d1b0cf715a34dd9d89d3b72bb71815d5202d5b3a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99831694"
---
# <a name="tutorial-export-data-from-azure-iot-central-and-visualize-insights-in-power-bi"></a>Руководство по Экспорт данных из Azure IoT Central и визуализация аналитических сведений в Power BI


В двух предыдущих руководствах вы создали и настроили приложение IoT Central с помощью шаблона приложения **Аналитика магазина — оформление заказа**. В этом руководстве вы настроите приложение IoT Central для экспорта данных телеметрии, собранных с устройств. Затем с помощью Power BI вы создадите настраиваемую панель мониторинга для диспетчера магазинов, чтобы визуализировать аналитические данные, полученные из данных телеметрии.

В этом учебнике рассматривается следующее.
> [!div class="checklist"]
> * Настройка приложения IoT Central для экспорта данных телеметрии в концентратор событий.
> * Использование Logic Apps для отправки данных из концентратора событий в набор данных потоковой передачи Power BI.
> * Создание панели мониторинга Power BI для визуализации данных в наборе данных потоковой передачи.

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим учебником необходимы указанные ниже компоненты.

* Прохождение двух предыдущих руководств [Создание приложения аналитики в магазине в Azure IoT Central](./tutorial-in-store-analytics-create-app.md) и [Настройка панели мониторинга оператора и управление устройствами в Azure IoT Central](./tutorial-in-store-analytics-customize-dashboard.md).
* Подписка Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.
* Учетная запись Power BI. Если у вас нет учетной записи Power BI, зарегистрируйтесь для получения [бесплатной пробной версии Power BI Pro](https://app.powerbi.com/signupredirect?pbi_source=web), прежде чем начинать работу.

## <a name="create-a-resource-group"></a>Создание группы ресурсов

Перед созданием концентратора событий и приложения логики нужно создать группу ресурсов для управления ими. Группа ресурсов должна находиться в том же расположении, что и ваше приложение IoT Central **Аналитика магазина — оформление заказа**. Чтобы создать группу ресурсов:

1. Войдите на [портал Azure](https://portal.azure.com).
1. В левой области навигации выберите **Группы ресурсов**. Нажмите кнопку **Добавить**.
1. В поле **Подписка** выберите имя подписки Azure, которая использовалась для создания приложения IoT Central.
1. В качестве имени **группы ресурсов** введите _retail-store-analysis_*.
1. В поле **Регион** выберите тот же регион, который использовался для приложения IoT Central.
1. Выберите **Review + Create** (Просмотреть и создать).
1. На странице **Отзыв и создание** выберите **Создать**.

Теперь в вашей подписке есть группа ресурсов с именем **retail-store-analysis**.

## <a name="create-an-event-hub"></a>Создание концентратора событий

Прежде чем можно будет настроить приложение мониторинга розничной торговли для экспорта данных телеметрии, нужно создать концентратор событий для получения экспортированных данных. Ниже показано, как создать концентратор событий.

1. На портале Azure выберите **Создать ресурс** в левой верхней части экрана.
1. В поле **Поиск по Marketplace** введите _Центры событий_ и нажмите клавишу **ВВОД**.
1. На странице **Центры событий** выберите **Создать**.
1. На странице **Создание пространства имен** выполните следующие действия.
    * Введите уникальное имя для пространства имен, например _ваше_имя-retail-store-analysis_. Система проверит, доступно ли это имя.
    * Выберите ценовую категорию **Базовый**.
    * Выберите ту же **подписку**, которая использовалась для создания приложения IoT Central.
    * Выберите группу ресурсов **retail-store-analysis**.
    * Выберите то же расположение, которое использовалось для приложения IoT Central.
    * Нажмите кнопку **создания**. Подготовка ресурсов для системы может занять несколько минут.
1. На портале перейдите к группе ресурсов **retail-store-analysis**. Дождитесь завершения развертывания. Для обновления состояния развертывания может потребоваться выбрать элемент **Обновить**. Вы также можете проверить состояние создания пространства имен концентратора событий в разделе **Уведомления**.
1. В группе ресурсов **retail-store-analysis** выберите **Пространство имен Центров событий**. Откроется домашняя страница для вашего **пространства имен Центров событий** на портале.

Теперь, когда у вас есть **Пространство имен Центров событий**, вы можете создать **Концентратор событий** для использования с приложением IoT Central:

1. На домашней странице **Пространство имен Центров событий** портала выберите **+ Концентратор событий**.
1. На странице **Создание концентратора событий** введите _store-telemetry_ в качестве имени, а затем выберите **Создать**.

Теперь у вас есть концентратор событий, который можно использовать при настройке экспорта данных из приложения IoT Central:

![концентратор событий;](./media/tutorial-in-store-analytics-visualize-insights/event-hub.png)

## <a name="configure-data-export"></a>Настройка экспорта данных

Теперь, когда у вас есть концентратор событий, вы можете настроить приложение **Аналитика магазина — оформление заказа** для экспорта данных телеметрии с подключенных устройств. Следующие действия демонстрируют, как настроить экспорт.

1. Войдите в приложение IoT Central **Аналитика магазина — оформление заказа**.
1. В левой области щелкните **Экспорт данных**.
1. Выберите **Создать > Центры событий Azure**.
1. Введите _Telemetry export_ (Экспорт телеметрии) в поле **Отображаемое имя**.
1. Выберите **Пространство имен Центров событий**.
1. Выберите концентратор событий **store-telemetry**.
1. Отключите параметры **Устройства** и **Шаблоны устройств** в разделе **Данные для экспорта**.
1. Щелкните **Сохранить**.

Экспорт данных может занять несколько минут, после чего начнется отправка телеметрии в концентратор событий. Состояние экспорта можно просмотреть на странице **Data exports** (Экспорты данных):

![Настройка непрерывного экспорта данных](./media/tutorial-in-store-analytics-visualize-insights/export-configuration.png)

## <a name="create-the-power-bi-datasets"></a>Создание наборов данных Power BI

На панели мониторинга Power BI отобразятся данные из приложения мониторинга розничной торговли. В этом решении в качестве источника данных для панели мониторинга Power BI используются наборы данных потоковой передачи Power BI. В этом разделе вы определите схему наборов данных потоковой передачи, чтобы приложение логики могло пересылать данные из концентратора событий. Ниже показано, как создать два набора данных потоковой передачи для датчиков состояния окружающей среды и один набор данных потоковой передачи для датчика присутствия.

1. Выполните вход в учетную запись **Power BI**.
1. Выберите **Рабочие области**, а затем — **Создать рабочую область**.
1. На странице **Создание рабочей области** введите _Аналитика магазина — оформление заказа_ в поле **Имя рабочей области**.
1. Прокрутите страницу **Добро пожаловать в рабочую область "Аналитика магазина — оформление заказа"** до конца и выберите **Пропустить**.
1. На странице рабочей области выберите **Создать > Потоковый набор данных**.
1. На странице **Создать набор данных для потоковой передачи** выберите **API**, а затем нажмите кнопку **Далее**.
1. Введите _Датчик зоны 1_ в поле **Имя набора данных**.
1. Введите три **значения из потока** в следующей таблице.

    | Имя значения  | Тип значения |
    | ----------- | ---------- |
    | Отметка времени   | Дата и время   |
    | влажность.    | Number     |
    | температура; | Number     |

1. Включите **Анализ исторических данных**.
1. Выберите **Создать** и затем **Готово**.
1. Создайте еще один набор данных потоковой передачи с именем **Датчик зоны 2** с теми же схемой и параметрами, что и у набора данных потоковой передачи **Датчик зоны 1**.

Теперь у вас есть два набора данных потоковой передачи. Приложение логики будет направлять телеметрию с двух датчиков состояния окружающей среды, подключенных к приложению **Аналитика магазина — оформление заказа**, в эти два набора данных.

![Наборы данных зон](./media/tutorial-in-store-analytics-visualize-insights/dataset-1.png)

В этом решении используется по одному набору данных потоковой передачи для каждого датчика, так как невозможно применить фильтры к данным потоковой передачи в Power BI.

Кроме того, нужен набор данных потоковой передачи для данных телеметрии присутствия:

1. На странице рабочей области выберите **Создать > Потоковый набор данных**.
1. На странице **Создать набор данных для потоковой передачи** выберите **API**, а затем нажмите кнопку **Далее**.
1. Введите _Датчик присутствия_ в поле **Имя набора данных**.
1. Введите пять **значений из потока** в следующей таблице.

    | Имя значения     | Тип значения |
    | -------------- | ---------- |
    | Отметка времени      | Дата и время   |
    | Длина очереди 1 | Number     |
    | Длина очереди 2 | Number     |
    | Время ожидания 1   | Number     |
    | Время ожидания 2   | Number     |

1. Включите **Анализ исторических данных**.
1. Выберите **Создать** и затем **Готово**.

Теперь у вас есть третий набор данных потоковой передачи, в котором хранятся значения с имитированного датчика присутствия. Этот датчик сообщает о длине очереди на двух кассах в магазине и о том, как долго клиенты ожидают в этих очередях:

![Набор данных присутствия](./media/tutorial-in-store-analytics-visualize-insights/dataset-2.png)

## <a name="create-a-logic-app"></a>Создайте приложение логики

В этом решении приложение логики считывает данные телеметрии из концентратора событий, анализирует их и направляет в созданные наборы данных потоковой передачи Power BI.

Прежде чем создавать приложение логики, вам понадобятся идентификаторы устройств для двух датчиков RuuviTag, которые вы подключили к приложению IoT Central в руководстве [Создание приложения аналитики в магазине в Azure IoT Central](./tutorial-in-store-analytics-create-app.md):

1. Войдите в приложение IoT Central **Аналитика магазина — оформление заказа**.
1. В левой области выберите **Устройства**. Затем выберите **RuuviTag**.
1. Запишите **идентификаторы устройств**. На следующем снимке экрана идентификаторы имеют значение **f5dcf4ac32e8** и **e29ffc8d5326**:

    ![идентификаторы устройств;](./media/tutorial-in-store-analytics-visualize-insights/device-ids.png)

Ниже показано, как создать приложение логики на портале Azure:

1. Войдите на [портал Azure](https://portal.azure.com) и выберите **Создать ресурс** в левой верхней части экрана.
1. В поле **Поиск по Marketplace** введите _Приложение логики_ и нажмите клавишу **ВВОД**.
1. На странице **Приложение логики** выберите **Создать**.
1. На странице создания **приложения логики** сделайте следующее.
    * Введите уникальное имя для приложения логики, например _ваше_имя-retail-store-analysis_.
    * Выберите ту же **подписку**, которая использовалась для создания приложения IoT Central.
    * Выберите группу ресурсов **retail-store-analysis**.
    * Выберите то же расположение, которое использовалось для приложения IoT Central.
    * Нажмите кнопку **создания**. Подготовка ресурсов для системы может занять несколько минут.
1. На портале Azure перейдите к новому приложению логики.
1. На странице **Конструктор Logic Apps** прокрутите вниз и выберите **Пустое приложение логики**.
1. В поле **Поиск соединителей и триггеров** введите _Центры событий_.
1. В поле **Триггеры** выберите **When events are available in Event Hub** (При наличии событий в концентраторе событий).
1. Введите _Store telemetry_ (Телеметрия магазина) в поле **Имя подключения** и выберите свое **Пространство имен Центров событий**.
1. Выберите политику **RootManageSharedAccess** и выберите **Создать**.
1. Для действия **When events are available in Event Hub** (При наличии событий в концентраторе событий) сделайте следующее.
    * В поле **Имя концентратора событий** выберите **store-telemetry**.
    * В поле **Тип содержимого** выберите **application/json**.
    * В поле **Интервал** укажите значение 3, а в поле **Частота**  — секунды.
1. Выберите **Сохранить**, чтобы сохранить приложение логики.

Чтобы добавить логику в структуру приложения логики, выберите **Представление кода**:

1. Замените `"actions": {},` приведенным ниже кодом JSON. Замените два заполнителя `[YOUR RUUVITAG DEVICE ID 1]` и `[YOUR RUUVITAG DEVICE ID 2]` идентификаторами, записанными для двух устройствах RuuviTag:

    ```json
    "actions": {
        "Initialize_Device_ID_variable": {
            "inputs": {
                "variables": [
                    {
                        "name": "DeviceID",
                        "type": "String"
                    }
                ]
            },
            "runAfter": {},
            "type": "InitializeVariable"
        },
        "Initialize_Interface_ID_variable": {
            "inputs": {
                "variables": [
                    {
                        "name": "InterfaceID",
                        "type": "String",
                        "value": "Other"
                    }
                ]
            },
            "runAfter": {
                "Initialize_Device_ID_variable": [
                    "Succeeded"
                ]
            },
            "type": "InitializeVariable"
        },
        "Parse_Properties": {
            "inputs": {
                "content": "@triggerBody()?['Properties']",
                "schema": {
                    "properties": {
                        "iothub-connection-auth-generation-id": {
                            "type": "string"
                        },
                        "iothub-connection-auth-method": {
                            "type": "string"
                        },
                        "iothub-connection-device-id": {
                            "type": "string"
                        },
                        "iothub-enqueuedtime": {
                            "type": "string"
                        },
                        "iothub-interface-name": {
                            "type": "string"
                        },
                        "iothub-message-source": {
                            "type": "string"
                        },
                        "x-opt-enqueued-time": {
                            "type": "string"
                        },
                        "x-opt-offset": {
                            "type": "string"
                        },
                        "x-opt-sequence-number": {
                            "type": "integer"
                        }
                    },
                    "type": "object"
                }
            },
            "runAfter": {
                "Initialize_Interface_ID_variable": [
                    "Succeeded"
                ]
            },
            "type": "ParseJson"
        },
        "Parse_Telemetry": {
            "inputs": {
                "content": "@triggerBody()?['ContentData']",
                "schema": {
                    "properties": {
                        "DwellTime1": {
                            "type": "number"
                        },
                        "DwellTime2": {
                            "type": "number"
                        },
                        "count1": {
                            "type": "number"
                        },
                        "count2": {
                            "type": "number"
                        },
                        "humidity": {
                            "type": "number"
                        },
                        "temperature": {
                            "type": "number"
                        }
                    },
                    "type": "object"
                }
            },
            "runAfter": {
                "Initialize_Interface_ID_variable": [
                    "Succeeded"
                ]
            },
            "type": "ParseJson"
        },
        "Set_Device_ID_variable": {
            "inputs": {
                "name": "DeviceID",
                "value": "@body('Parse_Properties')?['iothub-connection-device-id']"
            },
            "runAfter": {
                "Parse_Properties": [
                    "Succeeded"
                ]
            },
            "type": "SetVariable"
        },
        "Set_Interface_ID_variable": {
            "inputs": {
                "name": "InterfaceID",
                "value": "@body('Parse_Properties')?['iothub-interface-name']"
            },
            "runAfter": {
                "Set_Device_ID_variable": [
                    "Succeeded"
                ]
            },
            "type": "SetVariable"
        },
        "Switch_by_DeviceID": {
            "cases": {
                "Occupancy": {
                    "actions": {
                        "Switch_by_InterfaceID": {
                            "cases": {
                                "Dwell_Time_interface": {
                                    "actions": {},
                                    "case": "RS40_Occupancy_Sensor_v2_1l0"
                                },
                                "People_Count_interface": {
                                    "actions": {},
                                    "case": "RS40_Occupancy_Sensor_iv"
                                }
                            },
                            "default": {
                                "actions": {}
                            },
                            "expression": "@variables('InterfaceID')",
                            "runAfter": {},
                            "type": "Switch"
                        }
                    },
                    "case": "Occupancy"
                },
                "Zone 2 environment": {
                    "actions": {},
                    "case": "[YOUR RUUVITAG DEVICE ID 2]"
                },
                "Zone_1_environment": {
                    "actions": {},
                    "case": "[YOUR RUUVITAG DEVICE ID 1]"
                }
            },
            "default": {
                "actions": {}
            },
            "expression": "@variables('DeviceID')",
            "runAfter": {
                "Parse_Telemetry": [
                    "Succeeded"
                ],
                "Set_Interface_ID_variable": [
                    "Succeeded"
                ]
            },
            "type": "Switch"
        }
    },
    ```

1. Выберите **Сохранить**, а затем выберите **Конструктор**, чтобы просмотреть визуальную версию добавленной логики:

    ![Структура приложения логики](./media/tutorial-in-store-analytics-visualize-insights/logic-app.png)

1. Выберите **Switch by DeviceID** (Переключить по идентификатору устройства), чтобы развернуть действие. Затем выберите **Zone 1 environment** (Среда зоны 1) и **Добавить действие**.
1. В поле **Поиск соединителей и действий** введите **Power BI**, а затем нажмите клавишу **ВВОД**.
1. Выберите действие **Добавить строки в набор данных (предварительная версия)** .
1. Выберите **Войти** и следуйте инструкциям на экране, чтобы войти в учетную запись Power BI.
1. После завершения входа в действии **Добавить строки в набор данных** сделайте следующее.
    * Выберите **Аналитика магазина — оформление заказа** в качестве рабочей области.
    * Выберите **Датчик зоны 1** в качестве набора данных.
    * Выберите **RealTimeData** в качестве таблицы.
    * Выберите **Добавить новый параметр**, а затем выберите поля **Метка времени**, **Влажность** и **Температура**.
    * Выберите поле **Метка времени**, а затем выберите **x-opt-enqueuedtime** в списке **Динамическое содержимое**.
    * Выберите поле **Влажность**, а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Затем выберите **влажность**.
    * Выберите поле **Температура**, а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Затем выберите **температуру**.
    * Выберите **Сохранить**, чтобы сохранить изменения. Действие **Zone 1 environment** (Среда зоны 1) выглядит, как на следующем снимке экрана. ![Zone 1 environment](./media/tutorial-in-store-analytics-visualize-insights/zone-1-action.png) (Среда зоны 1)
1. Выберите действие **Zone 2 environment** (Среда зоны 2) и **Добавить действие**.
1. В поле **Поиск соединителей и действий** введите **Power BI**, а затем нажмите клавишу **ВВОД**.
1. Выберите действие **Добавить строки в набор данных (предварительная версия)** .
1. В действии **Добавить строки в набор данных 2** сделайте следующее.
    * Выберите **Аналитика магазина — оформление заказа** в качестве рабочей области.
    * Выберите **Датчик зоны 2** в качестве набора данных.
    * Выберите **RealTimeData** в качестве таблицы.
    * Выберите **Добавить новый параметр**, а затем выберите поля **Метка времени**, **Влажность** и **Температура**.
    * Выберите поле **Метка времени**, а затем выберите **x-opt-enqueuedtime** в списке **Динамическое содержимое**.
    * Выберите поле **Влажность**, а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Затем выберите **влажность**.
    * Выберите поле **Температура**, а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Затем выберите **температуру**.
    Выберите **Сохранить**, чтобы сохранить изменения.  Действие **Zone 2 environment** (Среда зоны 2) выглядит, как на следующем снимке экрана. ![Zone 2 environment](./media/tutorial-in-store-analytics-visualize-insights/zone-2-action.png) (Среда зоны 2)
1. Выберите действие **Occupancy** (Присутствие), а затем действие **Переключить по идентификатору интерфейса**.
1. Выберите действие **Dwell Time interface** (Интерфейс времени ожидания) и **Добавить действие**.
1. В поле **Поиск соединителей и действий** введите **Power BI**, а затем нажмите клавишу **ВВОД**.
1. Выберите действие **Добавить строки в набор данных (предварительная версия)** .
1. В действии **Добавить строки в набор данных** сделайте следующее.
    * Выберите **Аналитика магазина — оформление заказа** в качестве рабочей области.
    * Выберите **Occupancy Sensor** (Датчик присутствия) в качестве набора данных.
    * Выберите **RealTimeData** в качестве таблицы.
    * Выберите **Добавить новый параметр**, а затем выберите поля **Метка времени**, **Dwell Time 1** (Время ожидания 1) и **Dwell Time 2** (Время ожидания 2).
    * Выберите поле **Метка времени**, а затем выберите **x-opt-enqueuedtime** в списке **Динамическое содержимое**.
    * Выберите поле **Dwell Time 1** (Время ожидания 1), а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Затем выберите **DwellTime1**.
    * Выберите поле **Dwell Time 2** (Время ожидания 2), а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Затем выберите **DwellTime2**.
    * Выберите **Сохранить**, чтобы сохранить изменения. Действие **Dwell Time interface** (Интерфейс времени ожидания) выглядит, как на следующем снимке экрана. ![Снимок экрана: действие "Интерфейс времени ожидания".](./media/tutorial-in-store-analytics-visualize-insights/occupancy-action-1.png)
1. Выберите действие **People Count interface** (Интерфейс количества людей) и **Добавить действие**.
1. В поле **Поиск соединителей и действий** введите **Power BI**, а затем нажмите клавишу **ВВОД**.
1. Выберите действие **Добавить строки в набор данных (предварительная версия)** .
1. В действии **Добавить строки в набор данных** сделайте следующее.
    * Выберите **Аналитика магазина — оформление заказа** в качестве рабочей области.
    * Выберите **Occupancy Sensor** (Датчик присутствия) в качестве набора данных.
    * Выберите **RealTimeData** в качестве таблицы.
    * Выберите **Добавить новый параметр**, а затем выберите поля **Метка времени**, **Queue Length 1** (Длина очереди 1) и **Queue Length 2** (Длина очереди 2).
    * Выберите поле **Метка времени**, а затем выберите **x-opt-enqueuedtime** в списке **Динамическое содержимое**.
    * Выберите поле **Queue Length 1** (Длина очереди 1), а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Выберите **count1**.
    * Выберите поле **Queue Length 2** (Длина очереди 2), а затем выберите **Подробнее** рядом с элементом **Parse Telemetry** (Анализ телеметрии). Выберите **count2**.
    * Выберите **Сохранить**, чтобы сохранить изменения. Действие **People Count interface** (Интерфейс количества людей) выглядит, как на следующем снимке экрана. ![Действие присутствия](./media/tutorial-in-store-analytics-visualize-insights/occupancy-action-2.png)

Приложение логики запускается автоматически. Чтобы просмотреть состояние каждого запуска, перейдите на страницу **Обзор** этого приложения логики на портале Azure.

## <a name="create-a-power-bi-dashboard"></a>Создание панели мониторинга Power BI

Теперь данные телеметрии передаются из приложения IoT Central через концентратор событий. Затем приложение логики анализирует сообщения концентратора событий и добавляет их в набор данных для потоковой передачи Power BI. Теперь можно создать панель мониторинга Power BI для визуализации этих данных телеметрии.

1. Выполните вход в учетную запись **Power BI**.
1. Выберите **Рабочие области > Аналитика магазина — оформление заказа**.
1. Выберите **Создать > Панель мониторинга**.
1. Введите **Аналитика магазинов** в качестве имени панели мониторинга и выберите **Создать**.

### <a name="add-line-charts"></a>Добавление графиков

Добавьте четыре плитки графика, чтобы отобразить показания температуры и влажности с двух датчиков состояния окружающей среды. При создании этих плиток используйте информацию из следующей таблицы. Чтобы добавить каждую плитку, начните с выбора **...(Дополнительные параметры) > Добавить плитку**. Выберите **Пользовательские данные потоковой передачи** и нажмите кнопку **Далее**.

| Параметр | Диаграмма 1 | Диаграмма 2 | Диаграмма 3 | Диаграмма 4 |
| ------- | -------- | -------- | -------- | -------- |
| Dataset | Датчик зоны 1 | Датчик зоны 1 | Датчик зоны 2 | Датчик зоны 2 |
| Тип визуализации | График | График | График | График |
| Ось | Отметка времени | Отметка времени | Отметка времени | Отметка времени |
| Значения | температура; | влажность. | температура; | влажность. |
| Time window (Временное окно) | 60 минут | 60 минут | 60 минут | 60 минут |
| Title | Температура (1 час) | Влажность (1 час) | Температура (1 час) | Влажность (1 час) |
| Подзаголовок | Зона 1 | Зона 1 | Зона 2 | Зона 2 |

На следующем снимке экрана показаны параметры для первой диаграммы.

![Параметры линейной диаграммы](./media/tutorial-in-store-analytics-visualize-insights/line-chart.png)

### <a name="add-cards-to-show-environmental-data"></a>Добавление карточек для отображения данных об окружающей среде

Добавьте четыре плитки карточки, чтобы отобразить актуальные показания температуры и влажности с двух датчиков состояния окружающей среды. При создании этих плиток используйте информацию из следующей таблицы. Чтобы добавить каждую плитку, начните с выбора **...(Дополнительные параметры) > Добавить плитку**. Выберите **Пользовательские данные потоковой передачи** и нажмите кнопку **Далее**.

| Параметр | Карточка 1 | Карточка 2 | Карточка 3 | Карточка 4 |
| ------- | ------- | ------- | ------- | ------- |
| Dataset | Датчик зоны 1 | Датчик зоны 1 | Датчик зоны 2 | Датчик зоны 2 |
| Тип визуализации | Карточка | Карточка | Карточка | Карточка |
| Поля | температура; | влажность. | температура; | влажность. |
| Title | Температура (F) | Влажность (%) | Температура (F) | Влажность (%) |
| Подзаголовок | Зона 1 | Зона 1 | Зона 2 | Зона 2 |

На следующем снимке экрана показаны параметры для первой карточки.

![Параметры карточки](./media/tutorial-in-store-analytics-visualize-insights/card-settings.png)

### <a name="add-tiles-to-show-checkout-occupancy-data"></a>Добавление плиток для отображения данных о присутствии на кассе

Добавьте четыре плитки карточки, чтобы отобразить длину очереди и время ожидания для двух касс в магазине. При создании этих плиток используйте информацию из следующей таблицы. Чтобы добавить каждую плитку, начните с выбора **...(Дополнительные параметры) > Добавить плитку**. Выберите **Пользовательские данные потоковой передачи** и нажмите кнопку **Далее**.

| Параметр | Карточка 1 | Карточка 2 | Карточка 3 | Карточка 4 |
| ------- | ------- | ------- | ------- | ------- |
| Dataset | Датчик присутствия | Датчик присутствия | Датчик присутствия | Датчик присутствия |
| Тип визуализации | Гистограмма с группировкой | Гистограмма с группировкой | Датчик | Датчик |
| Ось    | Отметка времени | Отметка времени | Недоступно | Недоступно |
| Значение | Время ожидания 1 | Время ожидания 2 | Длина очереди 1 | Длина очереди 2 |
| Time window (Временное окно) | 60 минут | 60 минут |  Недоступно | Недоступно |
| Title | Время ожидания | Время ожидания | Длина очереди | Длина очереди |
| Подзаголовок | Касса 1 | Касса 2 | Касса 1 | Касса 2 |

Измените размеры и расположение плиток на панели мониторинга, как на следующем снимке экрана.

![Снимок экрана: панель мониторинга Power BI с плитками, размеры и расположения которых изменены.](./media/tutorial-in-store-analytics-visualize-insights/pbi-dashboard.png)

Вы можете добавить некоторые дополнительные графические ресурсы для дальнейшей настройки панели мониторинга:

![Информационная панель Power BI](./media/tutorial-in-store-analytics-visualize-insights/pbi-dashboard-graphics.png)

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы завершили работу с приложением IoT Central, его можно удалить, войдя в приложение и перейдя на страницу **Параметры приложения** в разделе **Администрирование**.

Если вы хотите сохранить приложение, но при этом сократить соответствующие затраты, отключите экспорт данных, используемый для отправки данных телеметрии в концентратор событий.

Вы можете удалить концентратор событий и приложение логики на портале Azure, удалив группу ресурсов **retail-store-analysis**.

Вы можете удалить панель мониторинга и наборы данных Power BI, удалив рабочую область на странице параметров Power BI для этой рабочей области.

## <a name="next-steps"></a>Next Steps

В этих трех учебниках показано комплексное решение, использующее шаблон приложения IoT Central **Аналитика магазина — оформление заказа**. Вы подключили устройства к приложению, использовали IoT Central для наблюдения за ними, а также создали панель мониторинга с помощью Power BI для просмотра аналитических сведений из телеметрии устройств. Далее рекомендуем изучить один из других шаблонов приложений IoT Central.

> [!div class="nextstepaction"]
> [Создание решений для энергетики с помощью IoT Central](../energy/overview-iot-central-energy.md)
