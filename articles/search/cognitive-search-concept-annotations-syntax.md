---
title: Ссылки на входные и выходные данные в навыков
titleSuffix: Azure Cognitive Search
description: Описание синтаксиса аннотации и ссылки на заметку во входных и выходных данных набора навыков в конвейере обогащения искусственного интеллекта в Azure Когнитивный поиск.
manager: nitinme
author: LuisCabrer
ms.author: luisca
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 11/04/2019
ms.openlocfilehash: 03431d861ca6d469b894e45c36fe2a3d7904c3a2
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "88935540"
---
# <a name="how-to-reference-annotations-in-an-azure-cognitive-search-skillset"></a>Как ссылаться на аннотации в наборе навыков Когнитивный поиск Azure

Из этой статьи вы узнаете, как создавать ссылки на аннотации в определениях навыков, используя примеры для иллюстрации различных сценариев. По мере использования набора навыков для содержимого документа оно обогащается аннотациями. Аннотации можно использовать в качестве входных данных для дальнейшего нижестоящего обогащения или сопоставить с выходным полем в индексе. 
 
Примеры в этой статье основаны на поле *content*, создаваемом автоматически [индексаторами больших двоичных объектов Azure](search-howto-indexing-azure-blob-storage.md) в рамках этапа открытия документа. При создании ссылок на документы из контейнера больших двоичных объектов следует использовать формат `"/document/content"`, где поле *content* является частью элемента *document*. 

## <a name="background-concepts"></a>Базовые понятия

Перед рассмотрением синтаксиса давайте обсудим несколько важных концепций, чтобы лучше понимать примеры, приведенные далее в этой статье.

| Термин | Описание |
|------|-------------|
| Обогащенный документ | Обогащенный документ — это внутренняя структура, которая создается и используется конвейером для хранения всех аннотаций, связанных с документом. Обогащенный документ можно представить в виде дерева аннотаций. Как правило, аннотация, созданная из предыдущей аннотации, становится дочерней для нее.<p/>Обогащенные документы существуют только при выполнении набора навыков. Когда произойдет сопоставление содержимого с индексом поиска, обогащенный документ больше не будет нужен. Несмотря на то, что вы не взаимодействуете с обогащенными документами напрямую, полезно иметь когнитивную модель документов при создании набора навыков. |
| Контекст обогащения | Контекст, в котором происходит обогащение, в рамках которого обогащается элемент. По умолчанию контекст обогащения находится на уровне `"/document"` с отдельными документами. При запуске навыка его выходные данные становятся [свойствами определенного контекста](#example-2).|

<a name="example-1"></a>
## <a name="example-1-simple-annotation-reference"></a>Пример 1. Ссылка на простую аннотацию

Предположим, что в хранилище BLOB-объектов Azure есть множество файлов, содержащих ссылки на имена пользователей, которые необходимо извлечь с помощью функции распознавания сущностей. В приведенном ниже определении навыка `"/document/content"` — это текстовое представление всего документа, а people — извлеченные данные с полными именами сущностей, которые определяются как пользователи.

Так как по умолчанию для context задано значение `"/document"`, в качестве ссылки на список пользователей можно указать `"/document/people"`. В этом случае `"/document/people"` представляет собой аннотацию, которую теперь можно сопоставить с полем в индексе или использовать в другом навыке из того же набора навыков.

```json
  {
    "@odata.type": "#Microsoft.Skills.Text.EntityRecognitionSkill",
    "categories": [ "Person"],
    "defaultLanguageCode": "en",
    "inputs": [
      {
        "name": "text",
        "source": "/document/content"
      }
    ],
    "outputs": [
      {
        "name": "persons",
        "targetName": "people"
      }
    ]
  }
```

<a name="example-2"></a>

## <a name="example-2-reference-an-array-within-a-document"></a>Пример 2. Ссылка на массив в документе

Этот пример основан на предыдущем и в нем показано, как вызвать действие обогащения несколько раз для одного и того же документа. Предположим, что в предыдущем примере был сформирован массив строк с именами 10 пользователей из одного документа. Логичным следующим шагом будет повторное обогащение, в ходе которого из полного имени будет извлечена фамилия. Так как существует 10 имен, это действие требуется вызвать в документе 10 раз (по одному для каждого пользователя). 

Чтобы вызвать нужное количество итераций, задайте для параметра context значение `"/document/people/*"`, где символ звездочки (`"*"`) представляет все узлы в обогащенном документе в качестве потомков `"/document/people"`. Несмотря на то, что этот навык определяется только раз в массиве навыков, он вызывается для каждого элемента в документе, пока все элементы не будут обработаны.

```json
  {
    "@odata.type": "#Microsoft.Skills.Custom.WebApiSkill",
    "description": "Fictitious skill that gets the last name from a full name",
    "uri": "http://names.azurewebsites.net/api/GetLastName",
    "context" : "/document/people/*",
    "defaultLanguageCode": "en",
    "inputs": [
      {
        "name": "fullname",
        "source": "/document/people/*"
      }
    ],
    "outputs": [
      {
        "name": "lastname",
        "targetName": "last"
      }
    ]
  }
```

Если аннотации представляют собой массивы или коллекции строк, может потребоваться выполнить операции над определенными элементами, а не над массивом в целом. В приведенном выше примере создается аннотация с именем `"last"` в каждом узле, представленном параметром context. Если потребуется добавить ссылку на это семейство аннотаций, используйте синтаксис `"/document/people/*/last"`. Если потребуется добавить ссылку на определенную аннотацию, используйте явный индекс: `"/document/people/1/last`" для ссылки на фамилию первого пользователя, определенного в документе. Обратите внимание, что в этом синтаксисе массивы "проиндексированы от 0".

<a name="example-3"></a>

## <a name="example-3-reference-members-within-an-array"></a>Пример 3. Ссылка на элементы в массиве

Иногда необходимо сгруппировать все аннотации определенного типа для их передачи определенному навыку. Рассмотрим предполагаемый настраиваемый навык, который определяет наиболее распространенную фамилию среди всех фамилий, извлеченных в примере 2. Чтобы предоставить настраиваемому навыку только фамилии, укажите для параметра context значение `"/document"`, а для входных данных — `"/document/people/*/lastname"`.

Обратите внимание, что количество элементов больше `"/document/people/*/lastname"` , чем размер документа. Узлов фамилий может быть 10, в то время как для этого документа существует только один узел. В этом случае система автоматически создаст массив `"/document/people/*/lastname"`, содержащий все элементы в документе.

```json
  {
    "@odata.type": "#Microsoft.Skills.Custom.WebApiSkill",
    "description": "Fictitious skill that gets the most common string from an array of strings",
    "uri": "http://names.azurewebsites.net/api/MostCommonString",
    "context" : "/document",
    "inputs": [
      {
        "name": "strings",
        "source": "/document/people/*/lastname"
      }
    ],
    "outputs": [
      {
        "name": "mostcommon",
        "targetName": "common-lastname"
      }
    ]
  }
```



## <a name="see-also"></a>См. также раздел
+ [How to add a custom skill to a cognitive search pipeline](cognitive-search-custom-skill-interface.md) (Как добавить пользовательский навык в конвейер когнитивного поиска)
+ [Определение набора навыков](cognitive-search-defining-skillset.md)
+ [Создание набора навыков (REST)](/rest/api/searchservice/create-skillset)
+ [How to map enriched fields to an index](cognitive-search-output-field-mapping.md) (Как сопоставить обогащенные поля с индексом)