---
title: Настройка брандмауэра IP для службы Когнитивный поиск Azure
titleSuffix: Azure Cognitive Search
description: Настройте политики управления IP-адресами, чтобы ограничить доступ к службе Когнитивный поиск Azure.
manager: nitinme
author: markheff
ms.author: maheff
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 02/16/2021
ms.openlocfilehash: de34c2921c7829cb6d7e7354a1ebcff44271efd3
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100545553"
---
# <a name="configure-ip-firewall-for-azure-cognitive-search"></a>Настройка брандмауэра IP для Azure Когнитивный поиск

Azure Когнитивный поиск поддерживает правила IP-адресов для поддержки входящих брандмауэров. Эта модель обеспечивает дополнительный уровень безопасности для службы поиска, аналогичный правилам IP, которые можно найти в группе безопасности виртуальной сети Azure. С помощью этих правил IP можно настроить доступ к службе поиска только из утвержденного набора компьютеров и (или) облачных служб. Доступ к данным, хранящимся в службе поиска, из этих утвержденных наборов компьютеров и служб будет по-прежнему требовать наличия действительного маркера авторизации.

Правила IP-адресов можно задать в портал Azure, как описано в этой статье. Кроме того, можно использовать [REST API управления версии 2020-03-13](/rest/api/searchmanagement/), [Azure PowerShell](/powershell/module/az.search)или [Azure CLI](/cli/azure/search).

## <a name="configure-an-ip-firewall-using-the-azure-portal"></a><a id="configure-ip-policy"></a> Настройка брандмауэра IP-адресов с помощью портал Azure

Чтобы задать политику контроля доступа для IP-адресов в портал Azure, перейдите на страницу службы Когнитивный поиск Azure и выберите **сеть** в меню навигации. Подключение к сети конечных точек должно быть **общедоступным**. Если подключение установлено в значение **частный**, доступ к службе поиска можно получить только через частную конечную точку.

![Снимок экрана, показывающий, как настроить брандмауэр IP-адресов в портал Azure](./media/service-configure-firewall/azure-portal-firewall.png)

Портал Azure предоставляет возможность указывать IP-адреса и диапазоны IP-адресов в формате CIDR. Пример нотации CIDR — 8.8.8.0/24, который представляет IP-адреса в диапазоне от 8.8.8.0 до 8.8.8.255.

> [!NOTE]
> После включения политики контроля доступа на основе IP-адресов для службы Когнитивный поиск Azure все запросы к плоскости данных с компьютеров за пределами разрешенного списка диапазонов IP-адресов будут отклонены. При настройке правил IP-адресов некоторые функции портал Azure отключены. Вы сможете просматривать сведения об уровне обслуживания и управлять ими, но доступ на портал к данным индекса и различные компоненты службы, такие как индексы, индексаторы и определения навыков, ограничены по соображениям безопасности. В качестве альтернативы порталу можно использовать [расширение VS Code](https://aka.ms/vscode-search) для взаимодействия с различными компонентами службы.

### <a name="requests-from-your-current-ip"></a>Запросы с текущего IP-адреса

Для упрощения разработки портал Azure помогает определить и добавить IP-адрес клиентского компьютера в список разрешенных адресов. После этого приложения, работающие на вашем компьютере, смогут получить доступ к службе Когнитивный поиск Azure.

Портал автоматически определит IP-адрес клиента. Это может быть IP-адрес клиента компьютера или сетевого шлюза. Обязательно удалите этот IP-адрес, прежде чем выполнять рабочую нагрузку в рабочей среде.

Для добавления текущего IP-адреса в список IP-адресов установите флажок **Добавить свой клиент IP**. Затем нажмите кнопку **Save** (Сохранить).

![Снимок экрана, показывающий, как настроить параметры брандмауэра IP для разрешения текущего IP-адреса](./media/service-configure-firewall/enable-current-ip.png)

## <a name="troubleshoot-issues-with-an-ip-access-control-policy"></a><a id="troubleshoot-ip-firewall"></a>Устранение неполадок с политикой контроля доступа на основе IP-адресов

Для устранения неполадок с политикой контроля доступа на основе IP-адресов у вас есть следующие возможности и средства:

### <a name="azure-portal"></a>Портал Azure

Включение политики контроля доступа на основе IP-адресов для службы Когнитивный поиск Azure блокирует все запросы с компьютеров за пределами разрешенного списка диапазонов IP-адресов, включая портал Azure.  Вы сможете просматривать сведения об уровне обслуживания и управлять ими, но доступ на портал к данным индекса и различные компоненты службы, такие как индексы, индексаторы и определения навыков, ограничены по соображениям безопасности. 

### <a name="sdks"></a>Пакеты SDK

При доступе к службе Когнитивный поиск Azure с помощью пакета SDK на компьютерах, не начисленных в списке разрешенных, возвращается общий ответ с **запретом 403** без дополнительных сведений. Проверьте список разрешенных IP-адресов для своей учетной записи и убедитесь, что для службы поиска обновлена правильная конфигурация.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о доступе к службе поиска с помощью частной ссылки см. в следующей статье:

* [Создание частной конечной точки для безопасного подключения к Azure Когнитивный поиск](service-create-private-endpoint.md)