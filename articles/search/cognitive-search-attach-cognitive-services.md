---
title: Присоединение Cognitive Services к набору навыков
titleSuffix: Azure Cognitive Search
description: Узнайте, как подключить Cognitive Servicesную подписку к конвейеру обогащения искусственного интеллекта в Azure Когнитивный поиск.
author: LuisCabrer
ms.author: luisca
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 02/16/2021
ms.openlocfilehash: 77735166fafe9d39dff483baa89a4b31db31275d
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100577936"
---
# <a name="attach-a-cognitive-services-resource-to-a-skillset-in-azure-cognitive-search"></a>Подключение Cognitive Services ресурса к набору навыков в Azure Когнитивный поиск

При настройке [конвейера обогащения искусственного интеллекта](cognitive-search-concept-intro.md) в Azure когнитивный Поиск можно освободить ограниченное количество документов. Для более крупных и часто выполняемых рабочих нагрузок следует присоединить оплачиваемый ресурс "все в одном" Cognitive Services. Подписка "все в одном" ссылается на "Cognitive Services" в качестве предложения, а не на отдельные службы с доступом, предоставляемым через один ключ API.

Cognitive Services ресурс "все в одном" позволяет использовать [стандартные навыки](cognitive-search-predefined-skills.md) , которые можно включить в набор навыков.

+ [Компьютерное зрение](https://azure.microsoft.com/services/cognitive-services/computer-vision/) для анализа изображений и оптического распознавания символов (OCR)
+ [Анализ текста](https://azure.microsoft.com/services/cognitive-services/text-analytics/) для определения языка, распознавания сущностей, анализа тональности и извлечения ключевых фраз
+ [Преобразование текста](https://azure.microsoft.com/services/cognitive-services/translator-text-api/)

Ключ Cognitive Services "все в одном" является необязательным в определении набора навыков. Если количество ежедневных транзакций меньше 20 в день, затраты изменяются. Однако если транзакции превышают это число, для продолжения обработки требуется допустимый ключ ресурса.

Допустимы все ключи ресурсов "все в одном". На внутреннем уровне служба поиска будет использовать ресурс, размещенный в том же физическом регионе, даже если ключ «все в одном» предназначен для ресурса в другом регионе. На странице [доступность продукта](https://azure.microsoft.com/global-infrastructure/services/?products=search) отображается региональная доступность рядом.

> [!NOTE]
> Если вы не пропускаете стандартные навыки в наборе навыков, то Cognitive Services не обращается, и вы не будете получать оплату, даже если в наборе навыков указан ключ.

## <a name="how-billing-works"></a>Как работает выставление счетов

+ Когнитивный поиск Azure использует ключ ресурса Cognitive Services, предоставленный в наборе навыков, для выставления счетов за использование образа и текста. Выполнение оплачиваемых навыков относится к цене за [Cognitive Services с оплатой по мере](https://azure.microsoft.com/pricing/details/cognitive-services/)использования.

+ Извлечение изображений — это операция Azure Когнитивный поиск, которая происходит при взломе документов перед обогащением. Продается оплата за извлечение изображений. Сведения о ценах на извлечение изображений см. на [странице цен на когнитивный Поиск Azure](https://azure.microsoft.com/pricing/details/search/).

+ Извлечение текста также происходит во время взлома документа. Оплата не взимается.

+ Навыки, не вызывающие Cognitive Services, в том числе условные, формы, слияния и разбиения текста, не оплачиваются.

## <a name="same-region-requirement"></a>Требования к одному региону

Как Когнитивный поиск, так и Cognitive Services должны находиться в одном физическом регионе, как указано на странице [доступность продукта](https://azure.microsoft.com/global-infrastructure/services/?products=search) . Большинство регионов, предлагающих Когнитивный поиск, также предлагают Cognitive Services.

Если вы попытаетесь расширить искусственный интеллект в регионе, у которого нет обеих служб, вы увидите следующее сообщение: "предоставленный ключ не является допустимым ключом типа CognitiveServices для региона службы поиска".

> [!NOTE]
> Некоторые встроенные навыки основаны на нестандартном Cognitive Services (например, [навыке перевода текста](cognitive-search-skill-text-translation.md)). Использование нерегионального навыка означает, что ваш запрос может быть обслуживаться в регионе, отличном от региона Azure Когнитивный поиск. Дополнительные сведения о службах, не являющихся региональными, см. на странице [Cognitive Services продукт по регионам](https://aka.ms/allinoneregioninfo) .

## <a name="use-free-resources"></a>Использование бесплатных ресурсов

Для завершения учебника по созданию искусственного интеллекта и краткого руководства можно использовать ограниченный бесплатный режим обработки.

Для бесплатных (ограниченных) ресурсов ограничено 20 документов в день на индексатор. Можно [сбросить индексатор](search-howto-run-reset-indexers.md) , чтобы сбросить счетчик.

Если вы используете мастер **импорта данных** для расширения искусственного интеллекта, то можете найти параметры "присоединить Cognitive Services" на странице **Add ии обогащения (необязательная)** .

![Развернутый раздел Cognitive Services присоединения](./media/cognitive-search-attach-cognitive-services/attach1.png "Развернутый раздел Cognitive Services присоединения")

## <a name="use-billable-resources"></a>Использование ресурсов, которые подлежат оплате

Для рабочих нагрузок, которые создают более 20 дополнений в день, необходимо присоединить оплачиваемый Cognitive Services ресурс. Рекомендуется всегда присоединять оплачиваемый Cognitive Services ресурс, даже если вы никогда не планируете вызывать API-интерфейсы Cognitive Services. Присоединение ресурса переопределяет дневное ограничение.

Плата наследуется только за навыки, которые вызывают API-интерфейсы Cognitive Services. Вам не взимается плата за [пользовательские навыки](cognitive-search-create-custom-skill-example.md)или навыки, такие как [слияние текста](cognitive-search-skill-textmerger.md), [разделитель текста](cognitive-search-skill-textsplit.md)и [форма](cognitive-search-skill-shaper.md), не основанная на API.

Если вы используете мастер **импорта данных** , можно настроить оплачиваемый ресурс на странице **Добавление обогащения искусственного интеллекта (необязательно)** .

1. Разверните узел **присоединить Cognitive Services** , а затем выберите **создать новый Cognitive Services ресурс**. Откроется новая вкладка, в которой можно будет создать ресурс:

   ![Создание ресурса Cognitive Services](./media/cognitive-search-attach-cognitive-services/cog-services-create.png "Создание ресурса Cognitive Services")

1. В списке **Расположение** выберите тот же регион, в котором находится служба поиска.

1. В списке **ценовая** Категория выберите значение **S0** , чтобы получить коллекцию Cognitive Services функций, включая концепцию и языковые функции, которые поддерживают встроенные навыки, предоставляемые когнитивный Поиск Azure.

   Для уровня S0 можно найти тарифы для конкретных рабочих нагрузок на [странице цен на Cognitive Services](https://azure.microsoft.com/pricing/details/cognitive-services/).
  
   + Убедитесь, что в списке **выбрать предложение** выбрано **Cognitive Services** .
   + В разделе функции **языка** ставки для **анализ текста Standard** применяются к индексированию искусственного интеллекта.
   + В разделе функции **концепции** применяются тарифы на **компьютерное зрение S1** .

1. Выберите **создать** , чтобы подготавливает новый ресурс Cognitive Services.

1. Вернитесь на предыдущую вкладку. Выберите **Обновить** , чтобы отобразить ресурс Cognitive Services, а затем выберите ресурс:

   ![Выберите ресурс Cognitive Services](./media/cognitive-search-attach-cognitive-services/attach2.png "Выберите ресурс Cognitive Services")

1. Разверните раздел **Добавление данных о навыках** , чтобы выбрать конкретные навыки, которые необходимо выполнить с данными. Выполните остальные инструкции мастера.

## <a name="attach-an-existing-skillset-to-a-cognitive-services-resource"></a>Присоединение ресурса Cognitive Services с существующим набором навыков

Если вы уже имеете существующий набор навыков, вы можете присоединить его к новому или другому ресурсу Cognitive Services.

1. На странице Обзор службы поиска выберите **навыков**:

   ![Вкладка навыков](./media/cognitive-search-attach-cognitive-services/attach-existing1.png "Вкладка навыков")

1. Выберите имя набора навыков, а затем выберите существующий ресурс или создайте новый. Для подтверждения изменений нажмите кнопку **OK**.

   ![Список ресурсов набора навыков](./media/cognitive-search-attach-cognitive-services/attach-existing2.png "Список ресурсов набора навыков")

   Помните, что параметр **Free (ограниченные дополнения)** ограничивает доступ к 20 документам ежедневно, и вы можете использовать **Создание нового Cognitive Services ресурса** для предоставления нового оплачиваемого ресурса. Создав новый ресурс, щелкните **Обновить**, чтобы обновить список ресурсов Cognitive Services, и выберите ресурс.

## <a name="attach-cognitive-services-programmatically"></a>Присоединение Cognitive Services программным способом

При определении набора навыков программным способом добавьте раздел `cognitiveServices` к набору навыков. В этом разделе включите ключ ресурса Cognitive Services, который необходимо связать с набором навыков. Помните, что ресурс должен находиться в том же регионе, что и ресурс Azure Когнитивный поиск. Также включите `@odata.type` и присвойте ему значение `#Microsoft.Azure.Search.CognitiveServicesByKey`.

Этот шаблон приведен в примере ниже. Обратите внимание на `cognitiveServices` раздел в конце определения.

```http
PUT https://[servicename].search.windows.net/skillsets/[skillset name]?api-version=2020-06-30
api-key: [admin key]
Content-Type: application/json
{
    "name": "skillset name",
    "skills": 
    [
      {
        "@odata.type": "#Microsoft.Skills.Text.EntityRecognitionSkill",
        "categories": [ "Organization" ],
        "defaultLanguageCode": "en",
        "inputs": [
          {
            "name": "text", "source": "/document/content"
          }
        ],
        "outputs": [
          {
            "name": "organizations", "targetName": "organizations"
          }
        ]
      }
    ],
    "cognitiveServices": {
        "@odata.type": "#Microsoft.Azure.Search.CognitiveServicesByKey",
        "description": "mycogsvcs",
        "key": "<your key goes here>"
    }
}
```

## <a name="example-estimate-costs"></a>Пример. Оценка затрат

Чтобы оценить затраты, связанные с использованием индексированного поиска, начните с понимания того, как выглядит средний документ, чтобы можно было выполнить несколько цифр. Например, вы можете приблизительно:

+ 1 000. PDF.
+ По шесть страниц.
+ Одно изображение на страницу (6 000 изображений).
+ 3 000 символов на страницу.

Предположим, что конвейер состоит из взлома документов для каждого документа PDF, извлечения изображений и текста, оптического распознавания символов (OCR) и распознавания сущностей в организациях.

Представленные в этой статье цены являются гипотетическими. Они используются для иллюстрации процесса оценки. Ваши затраты могут быть ниже. Фактические цены на транзакции см. в разделе [цены на Cognitive Services](https://azure.microsoft.com/pricing/details/cognitive-services).

1. Для открытия документа с содержимым в виде текста и изображения извлечение текста в настоящее время предоставляется бесплатно. Для образов 6 000 предполагается $1 для каждого извлеченного образа 1 000. Это стоимость $6,00 для этого шага.

2. Для OCR 6000 образов на английском языке когнитивные навыки OCR используют наилучший алгоритм (DescribeText). При условии что 1000 изображений для анализа будет стоить 2,50 долл., вы выплатите 15,00 долл. за этот шаг.

3. Для извлечения сущностей у вас будет всего три текстовых записи на страницу. (каждая запись — 1000 символов). Три текстовых записи на страницу, умноженные на 6 000 страниц, совпадают с текстовыми записями 18 000. При тарифе 2,00 долл. за 1000 текстовых записей этот шаг будет стоить 36,00 долл.

Поместив все вместе, вы платите примерно $57,00, чтобы принять 1 000 PDF-документов этого типа с описанным набором навыков.

## <a name="next-steps"></a>Дальнейшие действия

+ [Страница цен на Когнитивный поиск Azure](https://azure.microsoft.com/pricing/details/search/)
+ [Определение набора навыков](cognitive-search-defining-skillset.md)
+ [Создание набора навыков (REST)](/rest/api/searchservice/create-skillset)
+ [Сопоставление обогащенных полей](cognitive-search-output-field-mapping.md)