---
title: Создание простого запроса
titleSuffix: Azure Cognitive Search
description: Узнайте, как создать запрос запроса в Когнитивный поиск, какие средства и интерфейсы API следует использовать для тестирования и кода, а также как решения запросов начинаются с проектирования индекса.
manager: nitinme
author: HeidiSteen
ms.author: heidist
ms.service: cognitive-search
ms.topic: conceptual
ms.date: 12/14/2020
ms.openlocfilehash: 9bee391ddb0fa6c270c6d833fb7e81d5f4880497
ms.sourcegitcommit: aacbf77e4e40266e497b6073679642d97d110cda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2021
ms.locfileid: "98118648"
---
# <a name="create-a-query-in-azure-cognitive-search"></a>Создание запроса в Azure Когнитивный поиск

При создании запроса в первый раз в этой статье описываются необходимые инструменты и API-интерфейсы, методы, используемые для создания запроса и структура и содержимое индекса, могут повлиять на результаты запроса. Общие сведения о том, как выглядит запрос запроса, начинаются с [типов запросов и композиций](search-query-overview.md).

## <a name="choose-tools-and-apis"></a>Выбор средств и API

Для создания запроса требуется инструмент или API. Любое из следующих рекомендаций полезно для тестирования и рабочей нагрузки.

| Методика | Описание |
|-------------|-------------|
| Портал| [Обозреватель поиска (портал)](search-explorer.md) — это интерфейс запросов в портал Azure, который выполняет запросы к индексам в базовой службе поиска. Портал выполняет REST API вызовы в фоновом режиме в операцию [поиска документов](/rest/api/searchservice/search-documents) , но не может вызывать Автозаполнение, предложения или поиск документов.<br/><br/> Можно выбрать любой индекс и REST API версию, включая предварительный просмотр. В строке запроса может использоваться простой или полный синтаксис с поддержкой всех параметров запроса (Filter, SELECT, searchFields и т. д.). На портале при открытии индекса можно работать с обозревателем поиска наряду с определением JSON индекса на параллельных вкладках для упрощения доступа к атрибутам полей. Проверьте, какие поля доступны для поиска, сортировки, фильтрации и для которых можно определить особенности при тестировании запросов. <br/>Рекомендуется для раннего исследования, тестирования и проверки. [Подробнее.](search-explorer.md) |
| Средства веб-тестирования| [POST](search-get-started-rest.md) или [Visual Studio Code](search-get-started-vs-code.md) являются надежными вариантами для составления запросов [поиска документов](/rest/api/searchservice/search-documents) и любых других запросов в оставшейся работе. Интерфейсы API-интерфейсов поддерживают все возможные программные операции в Azure Когнитивный поиск. при использовании такого средства, как POST или Visual Studio Code, можно выдавать запросы в интерактивном режиме, чтобы понять, как работает функция перед помещением в код. Средство веб-тестирования является хорошим выбором, если у вас нет прав участника или администратора в портал Azure. Если у вас есть URL-адрес поиска и ключ API запроса, можно использовать средства для выполнения запросов к существующему индексу. |
| Пакет Azure SDK | Когда вы будете готовы к написанию кода, вы можете использовать клиентские библиотеки Azure.Search.Docумент в пакетах SDK для Azure для .NET, Python, JavaScript или Java. Каждый пакет SDK имеет собственное расписание выпуска, но вы можете создавать и запрашивать индексы во всех них. <br/><br/>[Сеарчклиент (.NET)](/dotnet/api/azure.search.documents.searchclient) можно использовать для запроса индекса поиска в C#.  [Подробнее.](search-howto-dotnet-sdk.md)<br/><br/>[Сеарчклиент (Python)](/dotnet/api/azure.search.documents.searchclient) можно использовать для запроса индекса поиска в Python. [Подробнее.](search-get-started-python.md)<br/><br/>[Сеарчклиент (JavaScript)](/dotnet/api/azure.search.documents.searchclient) можно использовать для запроса индекса поиска в JavaScript. [Подробнее.](search-get-started-javascript.md) |

## <a name="set-up-a-search-client"></a>Настройка клиента поиска

Клиент поиска проверяет подлинность службы поиска, отправляет запросы и обрабатывает ответы. Независимо от того, какое средство или API используется, клиент поиска должен иметь следующее:

| Свойства | Описание |
|------------|-------------|
| Конечная точка | URL-адрес службы поиска доступен в следующем формате: `https://[service-name].search.windows.net` . |
| Ключ доступа API (администратор или запрос) | Проверяет подлинность запроса в службе поиска. |
| Имя индекса | Запросы всегда направляются в коллекцию Documents одного индекса. Невозможно объединить индексы или создать пользовательские или временные структуры данных и указать их в качестве цели запроса. |
| Версия API | Вызовы RESTFUL явным образом запрашивают `api-version` запрос. В отличие от этого, клиентские библиотеки в пакете SDK для Azure имеют версию, относящуюся к определенной версии REST API. Для пакетов SDK `api-version` является неявным. |

### <a name="in-the-portal"></a>Просмотр на портале

Обозреватель поиска и другие средства портала имеют встроенное клиентское подключение к службе с индексами прямого доступа и другими объектами на страницах портала. Для доступа к средствам, мастерам и объектам требуется членство в роли участника или выше в службе. 

### <a name="using-rest"></a>Использование REST

Для вызовов RESTFUL можно использовать [POST или аналогичные средства](search-get-started-rest.md) в качестве клиента для указания запроса [поиска документов](/rest/api/searchservice/search-documents) . Каждый запрос является автономным, поэтому необходимо указать конечную точку, имя индекса и версию API при каждом запросе. Другие свойства, тип содержимого и ключ API передаются в заголовке запроса. 

Для запроса индекса можно использовать POST или GET. POST с параметрами, указанными в тексте запроса, проще работать с. Если вы используете POST, обязательно включите `docs/search` в URL-адрес:

```http
POST https://myservice.search.windows.net/indexes/hotels-sample-index/docs/search?api-version=2020-06-30
{
    "count": true,
    "queryType": "simple",
    "search": "*"
}
```

### <a name="using-azure-sdks"></a>Использование пакетов SDK для Azure

Если вы используете пакет SDK для Azure, вы создадите клиент в коде. Все пакеты SDK предоставляют клиентам поиска, которые могут сохранять состояние, что позволяет повторно использовать подключение. Для операций запроса необходимо создать экземпляр класса **`SearchClient`** и предоставить значения для следующих свойств: конечная точка, ключ, индекс. Затем можно вызвать метод, **`Search method`** чтобы передать строку запроса. 

| Язык | Клиент | Пример |
|----------|--------|---------|
| C# и .NET | [сеарчклиент](/dotnet/api/azure.search.documents.searchclient) | [Отправка первого поискового запроса на языке C #](/dotnet/api/overview/azure/search.documents-readme#send-your-first-search-query) |
| Python      | [сеарчклиент](/python/api/azure-search-documents/azure.search.documents.searchclient) | [Отправка первого поискового запроса в Python](/python/api/overview/azure/search-documents-readme#send-your-first-search-request) |
| Java        | [сеарчклиент](/java/api/com.azure.search.documents.searchclient) | [Отправка первого поискового запроса в Java](/java/api/overview/azure/search-documents-readme#send-your-first-search-query)  |
| JavaScript  | [сеарчклиент](/javascript/api/@azure/search-documents/searchclient) | [Отправка первого поискового запроса в JavaScript](/javascript/api/overview/azure/search-documents-readme#send-your-first-search-query)  |

## <a name="choose-a-parser-simple--full"></a>Выберите средство синтаксического анализа: simple (простое) или full (полное)

Если запрос является полнотекстовым поиском, для обработки содержимого параметра поиска будет использоваться анализатор. Когнитивный поиск Azure предлагает два средства синтаксического анализа запросов. Простой синтаксический анализатор понимает [простой синтаксис запросов](query-simple-syntax.md). Это средство синтаксического анализа было выбрано по умолчанию для скорости и эффективности в текстовых запросах в свободной форме. Синтаксис поддерживает стандартные операторы поиска (и, или, не) для поиска терминов и фраз и префикс ( `*` ) (например, "Sea *" для Сиэтл и Владикавказ). Общая рекомендация заключается в том, чтобы сначала попробовать выполнить простой синтаксический анализатор, а затем перейти на полный синтаксический анализатор, если требования приложения вызывают более эффективные запросы.

[Полный синтаксис запроса Lucene](query-Lucene-syntax.md#bkmk_syntax), включенный при добавлении `queryType=full` в запрос, основан на [средстве синтаксического анализа Apache Lucene](https://lucene.apache.org/core/6_6_1/queryparser/org/apache/lucene/queryparser/classic/package-summary.html).

Полный синтаксис и простой синтаксис перекрываются в той степени, которая поддерживает одинаковые операции prefix и Boolean, но полный синтаксис предоставляет больше операторов. В полной мере, существуют дополнительные операторы для логических выражений и другие операторы для расширенных запросов, таких как нечеткий поиск, поиск с использованием подстановочных знаков, поиск с учетом расположения и регулярные выражения.

## <a name="choose-query-methods"></a>Выбор методов запроса

Поиск — это принципиально управляемое пользователем упражнение, в котором термины или фразы собираются из поля поиска или из событий щелчка на странице. В следующей таблице перечислены механизмы, с помощью которых можно собираются данные, введенные пользователем, а также ожидаемый интерфейс поиска.

| Входные данные | Взаимодействие |
|-------|---------|
| [Метод Search](/rest/api/searchservice/search-documents) | Пользователь вводит термины или фразы в поле поиска с операторами или без них и щелкает Поиск для отправки запроса. Поиск можно использовать с фильтрами для одного и того же запроса, но не с помощью автозаполнения или предложений. |
| [Метод автозаполнения](/rest/api/searchservice/autocomplete) | Пользователь вводит несколько символов, и запросы инициируются после ввода каждого нового символа. Ответ — это завершенная строка из индекса. Если указана допустимая строка, пользователь нажимает кнопку Поиск, чтобы отправить запрос в службу. |
| [Метод предложений](/rest/api/searchservice/suggestions) | Как и при использовании автозаполнения, пользователь вводит несколько символов и создаются добавочные запросы. Ответ — это раскрывающийся список соответствующих документов, которые обычно представляются в нескольких уникальных или описательных полях. Если какой-либо из вариантов допустим, пользователь щелкнет один и будет возвращен соответствующий документ. |
| [Фасетная навигация](/rest/api/searchservice/search-documents#query-parameters) | На странице отображаются навигационные ссылки или пути перехода, ограничивающие область поиска. Структура многоаспектной навигации создается динамически на основе исходного запроса. Например, `search=*` для заполнения дерева навигации с аспектом, состоящего из каждой возможной категории. Структура навигации с аспектами создается на основе ответа на запрос, но также является механизмом для выражения следующего запроса. n REST API ссылка `facets` задокументирована как параметр запроса операции поиска документов, но может использоваться без `search` параметра.|
| [Метод фильтра](/rest/api/searchservice/search-documents#query-parameters) | Фильтры используются с аспектами для уменьшения результатов. Можно также реализовать фильтр за страницей, например для инициализации страницы с полями, зависящими от языка. В REST API Reference `$filter` описан как параметр запроса операции поиска документов, но его можно использовать без `search` параметра.|

## <a name="know-your-field-attributes"></a>Сведения об атрибутах полей

Если вы ранее изучили [основные принципы запроса](search-query-overview.md)запроса, то, возможно, помните, что параметры запроса запроса зависят от того, как поля имеют атрибуты в индексе. Например, для использования в запросе, фильтре или порядке сортировки поле должно иметь возможность *поиска*, *фильтрации* и *сортировки*. Аналогичным образом в результатах могут отображаться только те поля, которые помечены как доступные для *извлечения* . По мере того как вы начинаете `search` указывать `filter` Параметры, и `orderby` в запросе, не забудьте проверить атрибуты во время перехода, чтобы избежать непредвиденных результатов.

На снимке экрана на портале ниже [индекса примера гостиниц](search-get-started-portal.md)только два последних поля "части lastrenovationdate" и "Оценка" могут использоваться только в `"$orderby"` предложении.

![Определение индекса для примера отеля](./media/search-query-overview/hotel-sample-index-definition.png "Определение индекса для примера отеля")

Описание атрибутов полей см. в разделе [CREATE INDEX (REST API)](/rest/api/searchservice/create-index).

## <a name="know-your-tokens"></a>Знакомство с маркерами

Во время индексирования обработчик запросов использует анализатор для анализа текста строк, увеличивая вероятность сопоставления во время выполнения запроса. Как минимум, строки имеют нижний регистр, но могут также лемматизация и прекращать удаление Word. Большие строки или составные слова обычно разбиваются на пробелы, дефисы, тире и индексируются как отдельные маркеры. 

Точка, которую нужно убрать здесь, заключается в том, что вы думаете, что ваш индекс содержит, и что на самом деле оно может отличаться. Если запросы не возвращают ожидаемых результатов, можно проверить маркеры, созданные анализатором, с помощью [анализа текста (REST API)](/rest/api/searchservice/test-analyzer). Дополнительные сведения о разметки и влиянии на запросы см. в разделе [частичный Поиск терминов и шаблоны со специальными символами](search-query-partial-matching.md).

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы понимаете, как создается запрос запроса, воспользуйтесь приведенными ниже краткими руководствами для получения практических навыков.

+ [Обозреватель поиска](search-explorer.md)
+ [Выполнение запроса в REST](search-get-started-rest.md)
+ [Выполнение запроса в .NET](search-get-started-dotnet.md)
+ [Как выполнить запрос в Python](search-get-started-python.md)
+ [Как выполнить запрос в JavaScript](search-get-started-javascript.md)