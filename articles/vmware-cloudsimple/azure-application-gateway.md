---
title: Использование шлюза приложений Azure с виртуальными машинами VMware
description: В этой статье описывается, как использовать шлюз приложений Azure для управления входящими веб-трафиком для веб-серверов, работающих на виртуальных машинах VMware, с помощью среды частного облака Клаудсимпле.
author: Ajayan1008
ms.author: v-hborys
ms.date: 08/16/2019
ms.topic: article
ms.service: azure-vmware-cloudsimple
ms.reviewer: cynthn
manager: dikamath
ms.openlocfilehash: d14fdc4e2b2b1dfca8194077acc0453808611946
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97897949"
---
# <a name="use-azure-application-gateway-with-vmware-virtual-machines-in-the-cloudsimple-private-cloud-environment"></a>Использование шлюза приложений Azure с виртуальными машинами VMware в среде частного облака Клаудсимпле

Шлюз приложений Azure можно использовать для управления входящими веб-трафиком для веб-серверов, работающих на виртуальных машинах VMware в среде частного облака Клаудсимпле.

Используя шлюз приложений Azure в гибридном развертывании с открытым и частным уровнем, вы можете управлять веб-трафиком в приложениях, обеспечивать безопасный внешний интерфейс и разгружать обработку TLS для своих служб, работающих в среде VMware. Шлюз приложений Azure направляет входящий веб-трафик в экземпляры серверного пула, находящиеся в средах VMware, в соответствии с настроенными правилами и зондами работоспособности.

Это решение шлюза приложений Azure требует:

* Создать подписку Azure.
* Создайте и настройте виртуальную сеть Azure и подсеть в виртуальной сети.
* Создание и настройка правил NSG и одноранговой виртуальной сети с помощью ExpressRoute в частном облаке Клаудсимпле.
* Создайте & настройте частное облако.
* Создайте & настроить шлюз приложений Azure.

## <a name="azure-application-gateway-deployment-scenario"></a>Сценарий развертывания шлюза приложений Azure

В этом сценарии шлюз приложений Azure выполняется в виртуальной сети Azure. Виртуальная сеть подключена к частному облаку через канал ExpressRoute. Все подсети в частном облаке являются IP-адресами, доступными из подсетей виртуальной сети.

![Балансировщик нагрузки Azure в виртуальной сети Azure](media/load-balancer-use-case.png)

## <a name="how-to-deploy-the-solution"></a>Развертывание решения

Процесс развертывания состоит из следующих задач.

1. [Проверка соблюдения предварительных требований](#1-verify-prerequisites)
2. [Подключение виртуального подключения Azure к частному облаку](#2-connect-your-azure-virtual-network-to-your-private-cloud)
3. [Развертывание шлюза приложений Azure](#3-deploy-an-azure-application-gateway)
4. [Создание и Настройка пула виртуальных машин веб-сервера в частном облаке](#4-create-and-configure-a-web-server-vm-pool-in-your-private-cloud)

## <a name="1-verify-prerequisites"></a>1. Проверка предварительных требований

Убедитесь, что выполнены следующие условия.

* Azure Resource Manager и виртуальная сеть уже созданы.
* Выделенная подсеть (для шлюза приложений) в виртуальной сети Azure уже создана.
* Клаудсимпле частное облако уже создано.
* Между IP-подсетями в виртуальной сети и подсетями в частном облаке отсутствует IP-конфликт.

## <a name="2-connect-your-azure-virtual-network-to-your-private-cloud"></a>2. подключение виртуальной сети Azure к частному облаку

Чтобы подключить виртуальную сеть Azure к частному облаку, выполните следующие действия.

1. [На портале клаудсимпле скопируйте сведения об пиринга ExpressRoute](virtual-network-connection.md).

2. [Настройте шлюз виртуальной сети для виртуальной сети Azure](../expressroute/expressroute-howto-add-gateway-portal-resource-manager.md).

3. [Свяжите виртуальную сеть с каналом Клаудсимпле ExpressRoute](../expressroute/expressroute-howto-linkvnet-portal-resource-manager.md#connect-a-vnet-to-a-circuit---different-subscription).

4. [Используйте скопированные сведения о пиринга, чтобы связать виртуальную сеть с каналом ExpressRoute](virtual-network-connection.md).

## <a name="3-deploy-an-azure-application-gateway"></a>3. Развертывание шлюза приложений Azure

Подробные инструкции для этого доступны в разделе [Создание шлюза приложений с правилами маршрутизации на основе пути с помощью портал Azure](../application-gateway/create-url-route-portal.md). Ниже приведено краткое описание необходимых действий.

1. Создайте виртуальную сеть в подписке и группе ресурсов.
2. Создайте подсеть (для использования в качестве выделенной подсети) в виртуальной сети.
3. Создайте стандартный шлюз приложений (при необходимости включите WAF): на домашней странице портал Azure щелкните **ресурс**  >  **Сетевые подключения**  >  **шлюз приложений** в верхней левой части страницы. Выберите стандартный SKU и размер и укажите подписку Azure, группу ресурсов и сведения о расположении. При необходимости создайте новый общедоступный IP-адрес для этого шлюза приложений и предоставьте сведения о виртуальной сети и выделенной подсети для шлюза приложений.
4. Добавьте серверный пул с виртуальными машинами и добавьте его в шлюз приложений.

## <a name="4-create-and-configure-a-web-server-vm-pool-in-your-private-cloud"></a>4. Создание и Настройка пула виртуальных машин веб-сервера в частном облаке

В vCenter Создайте виртуальные машины с операционной системой и веб-сервером по своему усмотрению (например, Windows, IIS или Linux/Apache). Выберите подсеть или виртуальную ЛС, назначенную для веб-уровня в частном облаке. Убедитесь, что хотя бы одна vNIC виртуальных машин веб-сервера находится в подсети веб-уровня.
