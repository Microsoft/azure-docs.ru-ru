---
title: Решение VMware для Azure от Клаудсимпле — перенос виртуальных машин рабочей нагрузки в частное облако
description: В этой статье описывается, как перенести виртуальные машины из локального vCenter в Клаудсимпле частное облако vCenter.
author: Ajayan1008
ms.author: v-hborys
ms.date: 08/20/2019
ms.topic: article
ms.service: azure-vmware-cloudsimple
ms.reviewer: cynthn
manager: dikamath
ms.openlocfilehash: 851305775d14ed371440434b2fbe9334ec0a21b9
ms.sourcegitcommit: d7d5f0da1dda786bda0260cf43bd4716e5bda08b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/05/2021
ms.locfileid: "97899326"
---
# <a name="migrate-workload-vms-from-on-premises-vcenter-to-private-cloud-vcenter-environment"></a>Перенос виртуальных машин рабочей нагрузки из локальной среды vCenter в среду с виртуальной частной облаком

Чтобы перенести виртуальные машины из локального центра обработки данных в частное облако Клаудсимпле, доступны несколько вариантов.  Частное облако предоставляет собственный доступ к VMware vCenter, а средства, поддерживаемые VMware, можно использовать для миграции рабочей нагрузки. В этой статье описываются некоторые варианты миграции vCenter.

## <a name="prerequisites"></a>Предварительные требования

Для миграции виртуальных машин и данных из локального центра данных требуется сетевое подключение из центра данных к среде частного облака.  Чтобы установить сетевое подключение, используйте один из следующих методов.

* [VPN-подключение типа "сеть — сеть](vpn-gateway.md#set-up-a-site-to-site-vpn-gateway) " между локальной средой и частным облаком.
* ExpressRoute Global Reach подключение между локальным каналом ExpressRoute и каналом Клаудсимпле ExpressRoute.

Сетевой путь из локальной среды vCenter к частному облаку должен быть доступен для миграции виртуальных машин с помощью vMotion.  Сеть vMotion в локальном vCenter должна иметь возможности маршрутизации.  Убедитесь, что брандмауэр разрешает весь трафик vMotion между локальным vCenter и частным облаком vCenter. (В частном облаке маршрутизация по сети vMotion настраивается по умолчанию.)

## <a name="migrate-isos-and-templates"></a>Миграция ISO и шаблонов

Чтобы создать новые виртуальные машины в частном облаке, используйте шаблоны ISO и виртуальных машин.  Чтобы отправить ISO и шаблоны в частное облако vCenter и сделать их доступными, используйте следующий метод.

1. Отправьте ISO-образ в частное облако vCenter из пользовательского интерфейса vCenter.
2. [Опубликуйте библиотеку содержимого](https://docs.vmware.com/en/VMware-vSphere/6.5/com.vmware.vsphere.vm_admin.doc/GUID-2A0F1C13-7336-45CE-B211-610D39A6E1F4.html) в частном облаке vCenter:

    1. Опубликуйте локальную библиотеку содержимого.
    2. Создайте новую библиотеку содержимого в частном облаке vCenter.
    3. Подпишитесь на опубликованную локальную библиотеку содержимого.
    4. Синхронизация библиотеки содержимого для доступа к содержимому, на которое оформлена подписка.

## <a name="migrate-vms-using-powercli"></a>Миграция виртуальных машин с помощью PowerCLI

Чтобы перенести виртуальные машины из локального vCenter в частное облако vCenter, используйте VMware PowerCLI или программу миграции рабочей нагрузки с перекрестной vCenter, доступную в лабораториях VMware.  В следующем примере скрипта показаны команды миграции PowerCLI.

```
$sourceVC = Connect-VIServer -Server <source-vCenter name> -User <source-vCenter user name> -Password <source-vCenter user password>
$targetVC = Connect-VIServer -Server <target-vCenter name> -User <target-vCenter user name> -Password <target-vCenter user password>
$vmhost = <name of ESXi host on destination>
$vm = Get-VM -Server $sourceVC <name of VM>
Move-VM -VM $vm -VMotionPriority High -Destination (Get-VMhost -Server $targetVC -Name $vmhost) -Datastore (Get-Datastore -Server $targetVC -Name <name of tgt vc datastore>)
```

> [!NOTE]
> Чтобы использовать имена целевого сервера vCenter и узлов ESXi, настройте перенаправление DNS из локальной среды в частное облако.

## <a name="migrate-vms-using-nsx-layer-2-vpn"></a>Перенос виртуальных машин с помощью VPN уровня 2 НСКС

Этот параметр обеспечивает динамическую миграцию рабочих нагрузок из локальной среды VMware в частное облако в Azure.  В этой сети с растянутым уровнем 2 подсеть из локальной сети будет доступна в частном облаке.  После миграции новое назначение IP-адресов не требуется для виртуальных машин.

[Перенос рабочих нагрузок с помощью растянутых сетей уровня 2](migration-layer-2-vpn.md) . Описание использования VPN уровня 2 для переноса сети уровня 2 из локальной среды в частное облако.

## <a name="migrate-vms-using-backup-and-disaster-recovery-tools"></a>Перенос виртуальных машин с помощью средств резервного копирования и аварийного восстановления

Миграцию виртуальных машин в частное облако можно выполнить с помощью средств резервного копирования и восстановления и средств аварийного восстановления.  Используйте частное облако в качестве целевого объекта для восстановления из резервных копий, созданных с помощью стороннего средства.  Частное облако также можно использовать в качестве целевого для аварийного восстановления с помощью VMware СРМ или стороннего средства.

Дополнительные сведения об использовании этих средств см. в следующих разделах:

* [Резервное копирование виртуальных машин рабочей нагрузки в частном облаке Клаудсимпле с помощью Veeam B&R](backup-workloads-veeam.md)
* [Настройка частного облака Клаудсимпле в качестве сайта аварийного восстановления для локальных рабочих нагрузок VMware](disaster-recovery-zerto.md)
