---
title: Системные функции в журналах Azure Monitor
description: Создание пользовательских запросов к журналам Azure Monitor с помощью системных функций
ms.topic: conceptual
ms.date: 03/01/2021
ms.openlocfilehash: 1d26adfd2bd1a3fc1506a334b4b661b66172192d
ms.sourcegitcommit: 15d27661c1c03bf84d3974a675c7bd11a0e086e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "102510596"
---
# <a name="system-functions-on-azure-monitor-logs"></a>Системные функции в журналах Azure Monitor

Azure Backup предоставляет набор функций, называемых системными функциями или функциями решения, которые по умолчанию доступны в Log Analytics (LA) рабочих областях.
 
Эти функции работают с данными в [необработанных Azure Backup таблицах](https://docs.microsoft.com/azure/backup/backup-azure-reports-data-model) в La и возвращают форматированные данные, которые позволяют легко получать сведения обо всех сущностях, связанных с резервным копированием, с помощью простых запросов. Пользователи могут передавать параметры в эти функции для фильтрации данных, возвращаемых этими функциями. 

Рекомендуется использовать системные функции для запроса данных резервного копирования в LA рабочие области для создания пользовательских отчетов, так как они предоставляют ряд преимуществ, как описано в разделе ниже.

## <a name="benefits-of-using-system-functions"></a>Преимущества использования системных функций

* **Более простые запросы**. Использование функций помогает сократить количество соединений, необходимых в запросах. По умолчанию функции возвращают плоские схемы, включающие все сведения, относящиеся к сущности (экземпляр резервной копии, задание, хранилище и т. д.), запрашиваемых. Например, если необходимо получить список успешных заданий резервного копирования по имени элемента резервного копирования и связанному с ним контейнеру, простой вызов функции **_AzureBackup_getJobs ()** предоставит все эти сведения для каждого задания. С другой стороны, запрос необработанных таблиц напрямую потребует выполнения нескольких соединений между таблицами [аддоназуребаккупжобс](https://docs.microsoft.com/azure/backup/backup-azure-reports-data-model#addonazurebackupjobs) и [кореазуребаккуп](https://docs.microsoft.com/azure/backup/backup-azure-reports-data-model#coreazurebackup) .

* Более **плавный переход от устаревшего события диагностики**: использование системных функций позволяет плавно переходить от [устаревшего события диагностики](https://docs.microsoft.com/azure/backup/backup-azure-diagnostic-events#legacy-event) (установите azurebackupreport в режиме AzureDiagnostics) к [событиям конкретного ресурса](https://docs.microsoft.com/azure/backup/backup-azure-diagnostic-events#diagnostics-events-available-for-azure-backup-users). Все системные функции, предоставляемые Azure Backup, позволяют указать параметр, который позволяет выбрать, должна ли функция запрашивать данные только из таблиц, связанных с ресурсами, или запрашивать данные из таблицы прежних версий и таблиц для конкретных ресурсов (с дедупликацией записей).
    * Если вы успешно выполнили миграцию к таблицам, относящимся к ресурсам, можно исключить таблицу, из которой запрашиваются функции.
    * Если в настоящее время выполняется миграция и имеются некоторые данные в устаревших таблицах, которые необходимы для анализа, можно включить устаревшую таблицу. Когда переход завершится, и данные из устаревшей таблицы больше не нужны, можно просто обновить значение параметра, передаваемое в функцию в запросах, чтобы исключить устаревшую таблицу.
    * Если вы по-прежнему используете только устаревшую таблицу, функции будут по-прежнему работать, если вы решили включить устаревшую таблицу с помощью того же параметра. Тем не менее рекомендуется [переключиться на таблицы, относящиеся к ресурсам](https://docs.microsoft.com/azure/backup/backup-azure-diagnostic-events#steps-to-move-to-new-diagnostics-settings-for-a-log-analytics-workspace) , с самого начала.

* **Уменьшается вероятность прерывания пользовательских запросов**: Если Azure Backup вводит улучшения в схему базовых пристоящих таблиц для поддержки будущих сценариев создания отчетов, определение функций также будет Обновлено, чтобы учесть изменения схемы. Таким же, при использовании системных функций для создания пользовательских запросов запросы не будут прерываться, даже если в базовой схеме таблиц имеются изменения.

> [!NOTE]
> Системные функции обслуживаются корпорацией Майкрософт, и их определения не могут быть изменены пользователями. Если требуются редактируемые функции, можно создать [сохраненные функции](https://docs.microsoft.com/azure/azure-monitor/logs/functions) в La.

## <a name="types-of-system-functions-offered-by-azure-backup"></a>Типы системных функций, предлагаемых Azure Backup

* **Основные функции**. это функции, которые помогают запрашивать любой из ключевых Azure Backup сущностей, таких как резервные экземпляры, хранилища, политики, задания и сущности выставления счетов. Например, функция **_AzureBackup_getBackupInstances** возвращает список всех экземпляров резервных копий, существующих в среде, начиная с последнего завершенного дня (в формате UTC). Параметры и возвращаемая схема для каждой из этих основных функций приведена ниже в этой статье.

* **Функции тренда**. это функции, возвращающие исторические записи для сущностей, относящихся к резервному копированию (например, экземпляры резервного копирования, группы выставления счетов) и позволяющие получать ежедневные, еженедельные и месячные сведения о тенденциях ключевых метрик (например, число потребляемых хранилищ), относящихся к этим сущностям. Параметры и возвращаемые схемы для каждой из этих функций тренда приведены ниже в этой статье.

> [!NOTE]
> В настоящее время системные функции возвращают данные до последнего завершенного дня (в формате UTC). Данные за текущий неполный день не возвращаются. Поэтому, если вы хотите получить записи за текущий день, необходимо использовать необработанные таблицы LA.


## <a name="list-of-system-functions"></a>Список системных функций

### <a name="core-functions"></a>Функции в модуле Core

#### <a name="_azurebackup_getvaults"></a>_AzureBackup_GetVaults ()

Эта функция возвращает список всех хранилищ служб восстановления в среде Azure, связанных с рабочей областью LA.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeEnd, только если вам нужно получить все записи, относящиеся к хранилищу, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждого хранилища. | N | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart, только если вам нужно получить все записи, относящиеся к хранилищу, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждого хранилища. | N |"2021-03-10 00:00:00"|
| ваултсубскриптионлист   | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получить только те хранилища, которые находятся в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те хранилища, которые находятся в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    |Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получать записи, относящиеся только к указанным хранилищам. По умолчанию значение этого параметра равно "*", что позволяет функции искать записи во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/Vault", который является значением этого параметра по умолчанию | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |

**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор хранилища |
| Идентификатор | Идентификатор Azure Resource Manager (ARM) хранилища |
| Имя | Имя хранилища |
| SubscriptionId | Идентификатор подписки, в которой существует хранилище |
| Расположение | Расположение, в котором существует хранилище |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанный с хранилищем |
| Теги | Теги хранилища |
| TimeGenerated | Метка времени записи |
| Тип |  Тип хранилища, "Microsoft. RecoveryServices/Vault"|

#### <a name="_azurebackup_getpolicies"></a>_AzureBackup_GetPolicies ()

Эта функция возвращает список политик резервного копирования, используемых в среде Azure, а также подробные сведения о каждой из таких политик, как тип источника данных, тип репликации хранилища и т. д.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeStart, только если вам нужно получить все записи, связанные с политикой, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждой политики. | N | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart, только если вам нужно получить все записи, связанные с политикой, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждой политики. | N |"2021-03-10 00:00:00"|
| ваултсубскриптионлист   | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получить только те политики, которые находятся в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те политики, которые находятся в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    |Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получить записи политик, относящиеся только к указанным хранилищам. По умолчанию этот параметр имеет значение "*", что позволяет функции искать записи политик во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/хранилища", который является значением этого параметра по умолчанию. | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |
| баккупсолутионлист | Используйте этот параметр для фильтрации выходных данных функции для определенного набора решений резервного копирования, используемых в среде Azure. Например, если в качестве значения этого параметра указать "резервное копирование виртуальных машин Azure, SQL в резервной копии ВИРТУАЛЬНОЙ машины Azure, DPM", функция возвращает только те записи, которые связаны с элементами, созданными с помощью резервного копирования виртуальной машины Azure, SQL в службе архивации виртуальных машин Azure или DPM в службе архивации Azure. По умолчанию значение этого параметра равно "*", что делает функцию возвращать записи, относящиеся ко всем решениям резервного копирования, которые поддерживаются отчетами резервного копирования (поддерживаемые значения: "резервное копирование виртуальных машин Azure"). SQL в службе архивации виртуальных машин Azure "," SAP HANA в службе архивации виртуальных машин Azure "," Служба хранилища Azure (службы файлов Azure) "," агент Azure Backup "," DPM "," Azure Backup Server "или сочетание любого из этих значений с разделителями-запятыми). | N | "Резервное копирование виртуальных машин Azure, SQL в службе архивации ВИРТУАЛЬНЫХ машин Azure, DPM, Azure Backup Agent" |

**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор политики |
| Идентификатор | Идентификатор Azure Resource Manager (ARM) политики |
| Имя | Имя политики |
| Решение для резервного копирования | Решение резервного копирования, с которым связана политика. Например, резервное копирование виртуальных машин Azure, SQL в службе архивации виртуальных машин Azure и т. д. |
| TimeGenerated | Метка времени записи |
| ваултуникуеид | Внешний ключ, ссылающийся на хранилище, связанное с политикой |
| ваултресаурцеид | Идентификатор Azure Resource Manager (ARM) хранилища, связанного с политикой |
| Vaultname | Имя хранилища, связанного с политикой |
| VaultTags | Теги хранилища, связанные с политикой |
| ваултлокатион | Расположение хранилища, связанного с политикой |
| VaultSubscriptionId | Идентификатор подписки хранилища, связанного с политикой |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанного с политикой |
| ваулттипе | Тип хранилища, "Microsoft. RecoveryServices/Vault" |
| ExtendedProperties | Дополнительные свойства политики |

#### <a name="_azurebackup_getjobs"></a>_AzureBackup_GetJobs ()

Эта функция возвращает список всех заданий, связанных с резервным копированием и восстановлением, которые были запущены в указанный диапазон времени, а также подробные сведения о каждом задании, такие как состояние задания, длительность задания, передача данных и т. д.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeEnd, чтобы получить список всех заданий, запущенных за период времени из класса RangeStart в RangeEnd. | Y | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart, чтобы получить список всех заданий, запущенных за период времени из RangeStart в RangeEnd. | Y |"2021-03-10 00:00:00"|
| ваултсубскриптионлист   | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получать только те задания, которые связаны с хранилищами в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те задания, которые связаны с хранилищами в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получать задания, относящиеся только к указанным хранилищам. По умолчанию значение этого параметра равно "*", что позволяет функции выполнять поиск заданий во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/хранилища", который является значением этого параметра по умолчанию. | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |
| баккупсолутионлист | Используйте этот параметр для фильтрации выходных данных функции для определенного набора решений резервного копирования, используемых в среде Azure. Например, если в качестве значения этого параметра указать "резервное копирование виртуальных машин Azure, SQL в резервной копии ВИРТУАЛЬНОЙ машины Azure, DPM", функция возвращает только те записи, которые связаны с элементами, созданными с помощью резервного копирования виртуальной машины Azure, SQL в службе архивации виртуальных машин Azure или DPM в службе архивации Azure. По умолчанию значение этого параметра равно "*", что делает функцию возвращать записи, относящиеся ко всем решениям резервного копирования, которые поддерживаются отчетами резервного копирования (поддерживаемые значения: "резервное копирование виртуальных машин Azure"). SQL в службе архивации виртуальных машин Azure "," SAP HANA в службе архивации виртуальных машин Azure "," Служба хранилища Azure (службы файлов Azure) "," агент Azure Backup "," DPM "," Azure Backup Server "или сочетание любого из этих значений с разделителями-запятыми). | N | "Резервное копирование виртуальных машин Azure, SQL в службе архивации ВИРТУАЛЬНЫХ машин Azure, DPM, Azure Backup Agent" |
| жобоператионлист | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного типа задания. Например, резервное копирование или восстановление. По умолчанию значение этого параметра равно "*", что позволяет выполнять поиск как для заданий резервного копирования, так и для восстановления. | N | Копия | 
| жобстатуслист | Используйте этот параметр для фильтрации выходных данных функции для определенного состояния задания. Например, Completed, Failed и т. д. По умолчанию значение этого параметра равно «*», что позволяет функции выполнять поиск всех заданий независимо от состояния. | N | "Failed, Комплетедвисварнингс" |
| жобфаилурекоделист | Используйте этот параметр для фильтрации выходных данных функции для конкретного кода ошибки. По умолчанию значение этого параметра равно «*», что делает функцию Поиск всех заданий независимо от кода сбоя. | N | Success
| датасаурцесетнаме | Используйте этот параметр, чтобы отфильтровать выходные данные функции в конкретный родительский ресурс. Например, чтобы вернуть SQL в экземплярах резервных копий виртуальных машин Azure, принадлежащих виртуальной машине "testvm", укажите _testvm_ в качестве значения этого параметра. По умолчанию используется значение "*", что позволяет функции искать записи во всех экземплярах резервных копий. | N | testvm |
| баккупинстанценаме | Этот параметр используется для поиска заданий в определенном экземпляре резервной копии по имени. По умолчанию используется значение "*", что позволяет функции искать записи во всех экземплярах резервных копий. | N | testvm |
| ексклуделог | Используйте этот параметр, чтобы исключить задания журнала, возвращаемые функцией (помогает в производительности запросов). По умолчанию значение этого параметра равно true, что позволяет функции исключать задания журнала. | N | true


**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор задания |
| оператионкатегори | Категория выполняемой операции. Например, Backup, Restore |
| Операция | Сведения о выполняемой операции. Например, log (для резервной копии журнала)|
| Состояние | Состояние задания. Например, Completed, Failed, Комплетедвисварнингс |
| еррортитле | Код ошибки задания |
| StartTime | Дата и время начала задания |
| дуратионинсекс | Длительность задания в секундах |
| дататрансферрединмбс | Данные, передаваемые заданием в MBs |
| ресторежобрпдатетиме | Дата и время создания восстанавливаемой точки восстановления |
| ресторежобрплокатион | Место хранения восстанавливаемой точки восстановления |
| баккупинстанцеуникуеид | Внешний ключ, ссылающийся на экземпляр резервной копии, связанный с заданием |
| баккупинстанцеид | Идентификатор Azure Resource Manager (ARM) экземпляра резервной копии, связанного с заданием |
| баккупинстанцефриендлинаме | Имя экземпляра резервной копии, связанного с заданием |
| датасаурцересаурцеид | Идентификатор Azure Resource Manager (ARM) базового источника данных, связанного с заданием. Например, идентификатор Azure Resource Manager (ARM) виртуальной машины |
| датасаурцефриендлинаме | Понятное имя базового источника данных, связанного с заданием |
| DatasourceType | Тип источника данных, связанного с заданием. Например, "Microsoft. COMPUTE/virtualMachines" |
| баккупсолутион | Решение резервного копирования, с которым связано задание. Например, резервное копирование виртуальных машин Azure, SQL в службе архивации виртуальных машин Azure и т. д. |
| датасаурцесетресаурцеид | Идентификатор Azure Resource Manager (ARM) родительского ресурса источника данных (когда применимо). Например, для SQL в источнике данных виртуальной машины Azure это поле будет содержать идентификатор Azure Resource Manager (ARM) виртуальной машины, в которой существует база данных SQL. |
| датасаурцесеттипе | Тип родительского ресурса источника данных (когда применимо). Например, для SAP HANA в источнике данных виртуальной машины Azure это поле будет иметь значение Microsoft. COMPUTE/virtualMachines, так как родительский ресурс является виртуальной машиной Azure. |
| ваултресаурцеид | Идентификатор Azure Resource Manager (ARM) хранилища, связанного с заданием |
| ваултуникуеид | Внешний ключ, ссылающийся на хранилище, связанное с заданием |
| Vaultname | Имя хранилища, связанного с заданием |
| VaultTags | Теги хранилища, связанные с заданием |
| VaultSubscriptionId | Идентификатор подписки хранилища, связанного с заданием |
| ваултлокатион | Расположение хранилища, связанного с заданием |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанного с заданием |
| ваулттипе | Тип хранилища, "Microsoft. RecoveryServices/Vault" |
| TimeGenerated | Метка времени записи |

#### <a name="_azurebackup_getbackupinstances"></a>_AzureBackup_GetBackupInstances ()

Эта функция возвращает список экземпляров резервных копий, связанных с хранилищами служб восстановления, а также подробные сведения о каждом экземпляре резервной копии, такие как потребление облачного хранилища, связанная политика и т. д.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeEnd, только если необходимо получить все записи, связанные с экземпляром резервной копии, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждого экземпляра резервной копии. | N | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart только в том случае, если необходимо получить все записи, связанные с экземпляром резервной копии, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждого экземпляра резервной копии. | N |"2021-03-10 00:00:00"|
| ваултсубскриптионлист   | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получить только те экземпляры резервного копирования, которые находятся в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те экземпляры резервного копирования, которые находятся в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    |Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получить записи экземпляров резервных копий, которые относятся только к указанным хранилищам. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей экземпляров резервных копий во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/хранилища", который является значением этого параметра по умолчанию. | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |
| баккупсолутионлист | Используйте этот параметр для фильтрации выходных данных функции для определенного набора решений резервного копирования, используемых в среде Azure. Например, если в качестве значения этого параметра указать "резервное копирование виртуальных машин Azure, SQL в резервной копии ВИРТУАЛЬНОЙ машины Azure, DPM", функция возвращает только те записи, которые связаны с элементами, созданными с помощью резервного копирования виртуальной машины Azure, SQL в службе архивации виртуальных машин Azure или DPM в службе архивации Azure. По умолчанию значение этого параметра равно "*", что делает функцию возвращать записи, относящиеся ко всем решениям резервного копирования, которые поддерживаются отчетами резервного копирования (поддерживаемые значения: "резервное копирование виртуальных машин Azure"). SQL в службе архивации виртуальных машин Azure "," SAP HANA в службе архивации виртуальных машин Azure "," Служба хранилища Azure (службы файлов Azure) "," агент Azure Backup "," DPM "," Azure Backup Server "или сочетание любого из этих значений с разделителями-запятыми). | N | "Резервное копирование виртуальных машин Azure, SQL в службе архивации ВИРТУАЛЬНЫХ машин Azure, DPM, Azure Backup Agent" |
| протектионинфолист | Используйте этот параметр, чтобы указать, следует ли включать только защищенные экземпляры резервных копий, а также включить экземпляры, для которых была остановлена защита, и экземпляры, для которых ожидается начальное резервное копирование. Поддерживаются следующие значения: "Protected", "архивируемого", "Инитиалбаккуппендинг" или сочетание этих значений, разделенных запятыми. По умолчанию используется значение "*", что делает функцию Поиск всех экземпляров резервных копий независимо от сведений о защите. | N | От |
| датасаурцесетнаме | Используйте этот параметр, чтобы отфильтровать выходные данные функции в конкретный родительский ресурс. Например, чтобы вернуть SQL в экземплярах резервных копий виртуальных машин Azure, принадлежащих виртуальной машине "testvm", укажите _testvm_ в качестве значения этого параметра. По умолчанию используется значение "*", что позволяет функции искать записи во всех экземплярах резервных копий. | N | testvm |
| баккупинстанценаме | Используйте этот параметр для поиска конкретного экземпляра резервной копии по имени. По умолчанию используется значение "*", что делает функцию Поиск всех экземпляров резервных копий. | N | testvm |
| дисплайаллфиелдс | Используйте этот параметр, чтобы выбрать, следует ли извлекать только подмножество полей, возвращаемых функцией. Если значение этого параметра равно false, функция исключает сведения о хранилище и точке хранения, связанные с выходом функции. Это полезно, если вы используете эту функцию в качестве промежуточного шага в более крупном запросе и необходимо оптимизировать производительность запроса, исключив столбцы, которые не требуются для анализа. По умолчанию значение этого параметра равно true, что делает функцию возвращать все поля, относящиеся к экземпляру резервной копии. | N | true |

**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор экземпляра резервной копии |
| Идентификатор | Идентификатор Azure Resource Manager (ARM) экземпляра резервной копии |
| FriendlyName | Понятное имя экземпляра резервной копии |
| ProtectionInfo | Сведения о параметрах защиты экземпляра резервной копии. Например, защита настроена, защита остановлена, ожидается начальное резервное копирование |
| латестрековерипоинт | Дата и время последней точки восстановления, связанной с экземпляром резервной копии |
| олдестрековерипоинт | Дата и время самой старой точки восстановления, связанной с экземпляром резервной копии |
| саурцесизеинмбс | Размер внешнего интерфейса экземпляра резервной копии в МБ |
| VaultStore_StorageConsumptionInMBs | Общий объем облачного хранилища, использованного экземпляром резервной копии на уровне хранилища "Стандартный" |
| датасаурцефриендлинаме | Понятное имя источника данных, соответствующего экземпляру резервной копии |
| баккупсолутион | Решение резервного копирования, с которым связан экземпляр резервной копии. Например, резервное копирование виртуальных машин Azure, SQL в службе архивации виртуальных машин Azure и т. д. |
| DatasourceType | Тип источника данных, соответствующий экземпляру резервной копии. Например, "Microsoft. COMPUTE/virtualMachines" |
| датасаурцересаурцеид | Azure Resource Manager (ARM) идентификатор базового источника данных, соответствующего экземпляру резервной копии. Например, идентификатор Azure Resource Manager (ARM) виртуальной машины |
| датасаурцесетфриендлинаме | Понятное имя родительского ресурса источника данных (везде, где это применимо). Например, для SQL в источнике данных виртуальной машины Azure в этом поле будет содержаться имя виртуальной машины, в которой существует база данных SQL. |
| датасаурцесетресаурцеид | Идентификатор Azure Resource Manager (ARM) родительского ресурса источника данных (когда применимо). Например, для SQL в источнике данных виртуальной машины Azure это поле будет содержать идентификатор Azure Resource Manager (ARM) виртуальной машины, в которой существует база данных SQL. |
| датасаурцесеттипе | Тип родительского ресурса источника данных (когда применимо). Например, для SAP HANA в источнике данных виртуальной машины Azure это поле будет иметь значение Microsoft. COMPUTE/virtualMachines, так как родительский ресурс является виртуальной машиной Azure. |
| PolicyName | Имя политики, связанной с экземпляром резервной копии |
| PolicyUniqueId | Внешний ключ, ссылающийся на политику, связанную с экземпляром резервной копии.  |
| PolicyId | Azure Resource Manager (ARM) идентификатор политики, связанной с экземпляром резервной копии |
| ваултресаурцеид | Azure Resource Manager (ARM) идентификатор хранилища, связанного с экземпляром резервной копии |
| ваултуникуеид | Внешний ключ, который ссылается на хранилище, связанное с экземпляром резервной копии |
| Vaultname | Имя хранилища, связанного с экземпляром резервной копии |
| VaultTags | Теги хранилища, связанные с экземпляром резервной копии |
| VaultSubscriptionId | Идентификатор подписки хранилища, связанного с экземпляром резервной копии |
| ваултлокатион | Расположение хранилища, связанного с экземпляром резервной копии |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанного с экземпляром резервной копии |
| ваулттипе | Тип хранилища, "Microsoft. RecoveryServices/Vault" |
| TimeGenerated | Метка времени записи |

#### <a name="_azurebackup_getbillinggroups"></a>_AzureBackup_GetBillingGroups ()

Эта функция возвращает список всех сущностей выставления счетов, связанных с резервным копированием (группы выставления счетов), а также сведения о ключевых компонентах выставления счетов, таких как размер внешнего интерфейса и Общее облачное хранилище.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeEnd, только если вам нужно извлечь все связанные с группой выставления счетов записи за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждой группы выставления счетов. | N | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart, только если вам нужно получить все записи, связанные с группой выставления счетов, за период времени из RangeStart в RangeEnd. По умолчанию значение RangeStart и RangeEnd имеют значение null, что приведет к извлечению функцией только последней записи для каждой группы выставления счетов. | N |"2021-03-10 00:00:00"|
| ваултсубскриптионлист   | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получить только те группы выставления счетов, которые находятся в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те группы выставления счетов, которые находятся в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    |Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получить записи экземпляров резервных копий, которые относятся только к указанным хранилищам. По умолчанию этот параметр имеет значение "*", что позволяет функции искать записи групп выставления счетов во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/хранилища", который является значением этого параметра по умолчанию. | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |
| баккупсолутионлист | Используйте этот параметр для фильтрации выходных данных функции для определенного набора решений резервного копирования, используемых в среде Azure. Например, если в качестве значения этого параметра указать "резервное копирование виртуальных машин Azure, SQL в резервной копии ВИРТУАЛЬНОЙ машины Azure, DPM", функция возвращает только те записи, которые связаны с элементами, созданными с помощью резервного копирования виртуальной машины Azure, SQL в службе архивации виртуальных машин Azure или DPM в службе архивации Azure. По умолчанию значение этого параметра равно "*", что делает функцию возвращать записи, относящиеся ко всем решениям резервного копирования, которые поддерживаются отчетами резервного копирования (поддерживаемые значения: "резервное копирование виртуальных машин Azure"). SQL в службе архивации виртуальных машин Azure "," SAP HANA в службе архивации виртуальных машин Azure "," Служба хранилища Azure (службы файлов Azure) "," агент Azure Backup "," DPM "," Azure Backup Server "или сочетание любого из этих значений с разделителями-запятыми). | N | "Резервное копирование виртуальных машин Azure, SQL в службе архивации ВИРТУАЛЬНЫХ машин Azure, DPM, Azure Backup Agent" |
| биллингграупнаме | Этот параметр используется для поиска определенной группы выставления счетов по имени. По умолчанию используется значение "*", которое делает функцию Поиск всех групп выставления счетов. | N | testvm |

**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор группы выставления счетов |
| FriendlyName | Понятное имя группы выставления счетов |
| Имя | Имя группы выставления счетов |
| Тип | Тип группы выставления счетов. Например, Протектедконтаинер или Баккупитем |
| саурцесизеинмбс | Размер внешнего интерфейса группы выставления счетов в МБ |
| VaultStore_StorageConsumptionInMBs | Общее облачное хранилище, использованное группой выставления счетов на уровне хранилища "Стандартный" |
| баккупсолутион | Решение резервного копирования, с которым связана группа выставления счетов. Например, резервное копирование виртуальных машин Azure, SQL в службе архивации виртуальных машин Azure и т. д. |
| ваултресаурцеид | Azure Resource Manager (ARM) идентификатор хранилища, связанного с группой выставления счетов |
| ваултуникуеид | Внешний ключ, который ссылается на хранилище, связанное с группой выставления счетов |
| Vaultname | Имя хранилища, связанного с группой выставления счетов |
| VaultTags | Теги хранилища, связанные с группой выставления счетов |
| VaultSubscriptionId | Идентификатор подписки хранилища, связанного с группой выставления счетов |
| ваултлокатион | Расположение хранилища, связанного с группой выставления счетов |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанного с группой выставления счетов |
| ваулттипе | Тип хранилища, "Microsoft. RecoveryServices/Vault" |
| TimeGenerated | Метка времени записи |
| ExtendedProperties | Дополнительные свойства группы выставления счетов |

### <a name="trend-functions"></a>Функции тренда

#### <a name="_azurebackup_getbackupinstancestrends"></a>_AzureBackup_GetBackupInstancesTrends ()

Эта функция возвращает записи журнала для каждого экземпляра резервной копии, позволяя просматривать основные ежедневные, еженедельные и ежемесячные тенденции, связанные с количеством экземпляров резервных копий и потреблением хранилища, на нескольких уровнях детализации.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeEnd, чтобы получить все записи, связанные с экземпляром резервной копии, за период времени из RangeStart в RangeEnd. | Y | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart, чтобы получить все записи, связанные с экземпляром резервной копии, за период времени из RangeStart в RangeEnd. | Y |"2021-03-10 00:00:00"|
| ваултсубскриптионлист   | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получить только те экземпляры резервного копирования, которые находятся в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те экземпляры резервного копирования, которые находятся в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    |Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получить записи экземпляров резервных копий, которые относятся только к указанным хранилищам. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей экземпляров резервных копий во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/хранилища", который является значением этого параметра по умолчанию. | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |
| баккупсолутионлист | Используйте этот параметр для фильтрации выходных данных функции для определенного набора решений резервного копирования, используемых в среде Azure. Например, если в качестве значения этого параметра указать "резервное копирование виртуальных машин Azure, SQL в резервной копии ВИРТУАЛЬНОЙ машины Azure, DPM", функция возвращает только те записи, которые связаны с элементами, созданными с помощью резервного копирования виртуальной машины Azure, SQL в службе архивации виртуальных машин Azure или DPM в службе архивации Azure. По умолчанию значение этого параметра равно "*", что делает функцию возвращать записи, относящиеся ко всем решениям резервного копирования, которые поддерживаются отчетами резервного копирования (поддерживаемые значения: "резервное копирование виртуальных машин Azure"). SQL в службе архивации виртуальных машин Azure "," SAP HANA в службе архивации виртуальных машин Azure "," Служба хранилища Azure (службы файлов Azure) "," агент Azure Backup "," DPM "," Azure Backup Server "или сочетание любого из этих значений с разделителями-запятыми). | N | "Резервное копирование виртуальных машин Azure, SQL в службе архивации ВИРТУАЛЬНЫХ машин Azure, DPM, Azure Backup Agent" |
| протектионинфолист | Используйте этот параметр, чтобы указать, следует ли включать только защищенные экземпляры резервных копий, а также включить экземпляры, для которых была остановлена защита, и экземпляры, для которых ожидается начальное резервное копирование. Поддерживаются следующие значения: "Protected", "архивируемого", "Инитиалбаккуппендинг" или сочетание этих значений, разделенных запятыми. По умолчанию используется значение "*", что делает функцию Поиск всех экземпляров резервных копий независимо от сведений о защите. | N | От |
| датасаурцесетнаме | Используйте этот параметр, чтобы отфильтровать выходные данные функции в конкретный родительский ресурс. Например, чтобы вернуть SQL в экземплярах резервных копий виртуальных машин Azure, принадлежащих виртуальной машине "testvm", укажите _testvm_ в качестве значения этого параметра. По умолчанию используется значение "*", что позволяет функции искать записи во всех экземплярах резервных копий. | N | testvm |
| баккупинстанценаме | Используйте этот параметр для поиска конкретного экземпляра резервной копии по имени. По умолчанию используется значение "*", что делает функцию Поиск всех экземпляров резервных копий. | N | testvm |
| дисплайаллфиелдс | Используйте этот параметр, чтобы выбрать, следует ли извлекать только подмножество полей, возвращаемых функцией. Если значение этого параметра равно false, функция исключает сведения о хранилище и точке хранения, связанные с выходом функции. Это полезно, если вы используете эту функцию в качестве промежуточного шага в более крупном запросе и необходимо оптимизировать производительность запроса, исключив столбцы, которые не требуются для анализа. По умолчанию значение этого параметра равно true, что делает функцию возвращать все поля, относящиеся к экземпляру резервной копии. | N | true |
| AggregationType | Используйте этот параметр, чтобы указать гранулярность времени для извлечения данных. Если значение этого параметра — «ежедневно», функция возвращает запись для каждого экземпляра резервной копии в день, что позволяет анализировать ежедневные тенденции потребления хранилища и количества экземпляров резервных копий. Если значение этого параметра равно «еженедельно», функция возвращает запись для каждого экземпляра резервной копии в неделю, что позволяет анализировать еженедельные тенденции. Аналогичным образом можно указать «ежемесячно» для анализа месячных тенденций. Значение по умолчанию — "ежедневно". При просмотре данных в более больших диапазонах времени рекомендуется использовать "еженедельно" или "ежемесячно" для повышения производительности запросов и простоты анализа тенденций. | N | Запуск |

**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор экземпляра резервной копии |
| Идентификатор | Идентификатор Azure Resource Manager (ARM) экземпляра резервной копии |
| FriendlyName | Понятное имя экземпляра резервной копии |
| ProtectionInfo | Сведения о параметрах защиты экземпляра резервной копии. Например, защита настроена, защита остановлена, ожидается начальное резервное копирование |
| латестрековерипоинт | Дата и время последней точки восстановления, связанной с экземпляром резервной копии |
| олдестрековерипоинт | Дата и время самой старой точки восстановления, связанной с экземпляром резервной копии |
| саурцесизеинмбс | Размер внешнего интерфейса экземпляра резервной копии в МБ |
| VaultStore_StorageConsumptionInMBs | Общий объем облачного хранилища, использованного экземпляром резервной копии на уровне хранилища "Стандартный" |
| датасаурцефриендлинаме | Понятное имя источника данных, соответствующего экземпляру резервной копии |
| баккупсолутион | Решение резервного копирования, с которым связан экземпляр резервной копии. Например, резервное копирование виртуальных машин Azure, SQL в службе архивации виртуальных машин Azure и т. д. |
| DatasourceType | Тип источника данных, соответствующий экземпляру резервной копии. Например, "Microsoft. COMPUTE/virtualMachines" |
| датасаурцересаурцеид | Azure Resource Manager (ARM) идентификатор базового источника данных, соответствующего экземпляру резервной копии. Например, идентификатор Azure Resource Manager (ARM) виртуальной машины |
| датасаурцесетфриендлинаме | Понятное имя родительского ресурса источника данных (везде, где это применимо). Например, для SQL в источнике данных виртуальной машины Azure в этом поле будет содержаться имя виртуальной машины, в которой существует база данных SQL. |
| датасаурцесетресаурцеид | Идентификатор Azure Resource Manager (ARM) родительского ресурса источника данных (когда применимо). Например, для SQL в источнике данных виртуальной машины Azure это поле будет содержать идентификатор Azure Resource Manager (ARM) виртуальной машины, в которой существует база данных SQL. |
| датасаурцесеттипе | Тип родительского ресурса источника данных (когда применимо). Например, для SAP HANA в источнике данных виртуальной машины Azure это поле будет иметь значение Microsoft. COMPUTE/virtualMachines, так как родительский ресурс является виртуальной машиной Azure. |
| PolicyName | Имя политики, связанной с экземпляром резервной копии |
| PolicyUniqueId | Внешний ключ, ссылающийся на политику, связанную с экземпляром резервной копии.  |
| PolicyId | Azure Resource Manager (ARM) идентификатор политики, связанной с экземпляром резервной копии |
| ваултресаурцеид | Azure Resource Manager (ARM) идентификатор хранилища, связанного с экземпляром резервной копии |
| ваултуникуеид | Внешний ключ, который ссылается на хранилище, связанное с экземпляром резервной копии |
| Vaultname | Имя хранилища, связанного с экземпляром резервной копии |
| VaultTags | Теги хранилища, связанные с экземпляром резервной копии |
| VaultSubscriptionId | Идентификатор подписки хранилища, связанного с экземпляром резервной копии |
| ваултлокатион | Расположение хранилища, связанного с экземпляром резервной копии |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанного с экземпляром резервной копии |
| ваулттипе | Тип хранилища, "Microsoft. RecoveryServices/Vault" |
| TimeGenerated | Метка времени записи |

#### <a name="_azurebackup_getbillinggroupstrends"></a>_AzureBackup_GetBillingGroupsTrends ()

Эта функция возвращает записи журнала для каждой сущности выставления счетов, позволяя просматривать основные ежедневные, еженедельные и ежемесячные тенденции, связанные с размером внешнего интерфейса и потреблением хранилища, на нескольких уровнях детализации.

**Параметры**

| **Имя параметра** | **Описание** | **Обязательный?** | **Пример значения** |
| -------------------- | ------------- | --------------- | ----------------- |
| RangeStart     | Используйте этот параметр вместе с параметром RangeEnd, чтобы получить все записи, связанные с группой выставления счетов за период времени из RangeStart в RangeEnd. | Y | "2021-03-03 00:00:00" |
| RangeEnd     | Используйте этот параметр вместе с параметром RangeStart, чтобы получить все записи, связанные с группой выставления счетов за период времени из RangeStart в RangeEnd. | Y |"2021-03-10 00:00:00"|
| ваултсубскриптионлист  | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора подписок, где существуют резервные копии данных. Указание списка идентификаторов подписки с разделителями-запятыми в качестве параметра для этой функции помогает получить только те группы выставления счетов, которые находятся в указанных подписках. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех подписках. | N | "00000000-0000-0000-0000-000000000000, 11111111-1111-1111-1111-111111111111"|
| ваултлокатионлист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора регионов, где существуют резервные копии данных. Указание разделенного запятыми списка регионов в качестве параметра для этой функции помогает получить только те группы выставления счетов, которые находятся в указанных регионах. По умолчанию значение этого параметра равно "*", что делает функцию Поиск записей во всех регионах. | N | "eastus, westus"|
| VaultList    |Используйте этот параметр, чтобы отфильтровать выходные данные функции для определенного набора хранилищ. Указание разделенного запятыми списка имен хранилищ в качестве параметра для этой функции помогает получить записи экземпляров резервных копий, которые относятся только к указанным хранилищам. По умолчанию этот параметр имеет значение "*", что позволяет функции искать записи групп выставления счетов во всех хранилищах. | N |"vault1, vault2, vault3"|
| ваулттипелист     | Используйте этот параметр, чтобы отфильтровать выходные данные функции по записям, относящимся к конкретному типу хранилища. В настоящее время поддерживается только тип хранилища "Microsoft. RecoveryServices/хранилища", который является значением этого параметра по умолчанию. | N | Microsoft. RecoveryServices/хранилища|
| ексклуделегациевент  | Используйте этот параметр, чтобы выбрать, следует ли запрашивать данные в устаревшей таблице AzureDiagnostics. Если значение этого параметра равно false, функция запрашивает данные из таблицы AzureDiagnostics и таблиц, связанных с ресурсом. Если значение этого параметра равно true, функция запрашивает данные только для таблиц, связанных с ресурсами. Значение по умолчанию — true. | N | true |
| баккупсолутионлист | Используйте этот параметр для фильтрации выходных данных функции для определенного набора решений резервного копирования, используемых в среде Azure. Например, если в качестве значения этого параметра указать "резервное копирование виртуальных машин Azure, SQL в резервной копии ВИРТУАЛЬНОЙ машины Azure, DPM", функция возвращает только те записи, которые связаны с элементами, созданными с помощью резервного копирования виртуальной машины Azure, SQL в службе архивации виртуальных машин Azure или DPM в службе архивации Azure. По умолчанию значение этого параметра равно "*", что делает функцию возвращать записи, относящиеся ко всем решениям резервного копирования, которые поддерживаются отчетами резервного копирования (поддерживаемые значения: "резервное копирование виртуальных машин Azure"). SQL в службе архивации виртуальных машин Azure "," SAP HANA в службе архивации виртуальных машин Azure "," Служба хранилища Azure (службы файлов Azure) "," агент Azure Backup "," DPM "," Azure Backup Server "или сочетание любого из этих значений с разделителями-запятыми). | N | "Резервное копирование виртуальных машин Azure, SQL в службе архивации ВИРТУАЛЬНЫХ машин Azure, DPM, Azure Backup Agent" |
| биллингграупнаме | Этот параметр используется для поиска определенной группы выставления счетов по имени. По умолчанию используется значение "*", которое делает функцию Поиск всех групп выставления счетов. | N | testvm |
| AggregationType | Используйте этот параметр, чтобы указать гранулярность времени для извлечения данных. Если значение этого параметра — "ежедневно", функция возвращает запись для каждой группы выставления счетов в день, что позволяет анализировать ежедневные тенденции использования хранилища и внешнего размера. Если значение этого параметра равно «еженедельно», функция возвращает запись для каждого экземпляра резервной копии в неделю, что позволяет анализировать еженедельные тенденции. Аналогичным образом можно указать «ежемесячно» для анализа месячных тенденций. Значение по умолчанию — "ежедневно". При просмотре данных в более больших диапазонах времени рекомендуется использовать "еженедельно" или "ежемесячно" для повышения производительности запросов и простоты анализа тенденций. | N | Запуск |

**Возвращенные поля**

| **Имя поля** | **Описание** |
| -------------- | --------------- |
| UniqueId | Первичный ключ, обозначающий уникальный идентификатор группы выставления счетов |
| FriendlyName | Понятное имя группы выставления счетов |
| Имя | Имя группы выставления счетов |
| Тип | Тип группы выставления счетов. Например, Протектедконтаинер или Баккупитем |
| саурцесизеинмбс | Размер внешнего интерфейса группы выставления счетов в МБ |
| VaultStore_StorageConsumptionInMBs | Общее облачное хранилище, использованное группой выставления счетов на уровне хранилища "Стандартный" |
| баккупсолутион | Решение резервного копирования, с которым связана группа выставления счетов. Например, резервное копирование виртуальных машин Azure, SQL в службе архивации виртуальных машин Azure и т. д. |
| ваултресаурцеид | Azure Resource Manager (ARM) идентификатор хранилища, связанного с группой выставления счетов |
| ваултуникуеид | Внешний ключ, который ссылается на хранилище, связанное с группой выставления счетов |
| Vaultname | Имя хранилища, связанного с группой выставления счетов |
| VaultTags | Теги хранилища, связанные с группой выставления счетов |
| VaultSubscriptionId | Идентификатор подписки хранилища, связанного с группой выставления счетов |
| ваултлокатион | Расположение хранилища, связанного с группой выставления счетов |
| VaultStore_StorageReplicationType | Тип репликации хранилища, связанного с группой выставления счетов |
| ваулттипе | Тип хранилища, "Microsoft. RecoveryServices/Vault" |
| TimeGenerated | Метка времени записи |
| ExtendedProperties | Дополнительные свойства группы выставления счетов |

## <a name="sample-queries"></a>Примеры запросов

Ниже приведены примеры запросов, которые помогут приступить к работе с системными функциями.

- Все неудачные задания резервного копирования виртуальных машин Azure в заданный диапазон времени

    ````Kusto
    _AzureBackup_GetJobs("2021-03-05", "2021-03-06") //call function with RangeStart and RangeEnd parameters set, and other parameters with default value
    | where BackupSolution=="Azure Virtual Machine Backup" and Status=="Failed"
    | project BackupInstanceFriendlyName, BackupInstanceId, OperationCategory, Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs
    ````

- Все задания резервного копирования журналов SQL в заданный диапазон времени

    ````Kusto
    _AzureBackup_GetJobs("2021-03-05", "2021-03-06","*","*","*","*",true,"*","*","*","*","*","*",false) //call function with RangeStart and RangeEnd parameters set, ExcludeLog parameter as false, and other parameters with default value
    | where BackupSolution=="SQL in Azure VM Backup" and Operation=="Log"
    | project BackupInstanceFriendlyName, BackupInstanceId, OperationCategory, Status,  JobStartDateTime=StartTime, JobDuration=DurationInSecs/3600, ErrorTitle, DataTransferred=DataTransferredInMBs
    ````

- Еженедельная тенденция использования хранилища резервных копий для виртуальной машины "testvm"

    ````Kusto
    _AzureBackup_GetBackupInstancesTrends("2021-01-01", "2021-03-06","*","*","*","*",false,"*","*","*","*",true, "Weekly") //call function with RangeStart and RangeEnd parameters set, AggregationType parameter as Weekly, and other parameters with default value
    | where BackupSolution == "Azure Virtual Machine Backup"
    | where FriendlyName == "testvm"
    | project TimeGenerated, VaultStore_StorageConsumptionInMBs
    | render timechart 
    ````

## <a name="next-steps"></a>Дальнейшие действия
[Дополнительные сведения об отчетах по резервному копированию](https://docs.microsoft.com/azure/backup/configure-reports)
