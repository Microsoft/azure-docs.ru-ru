---
title: Отчеты Azure Backup электронной почты
description: Создание автоматизированных задач для получения периодических отчетов по электронной почте
ms.topic: conceptual
ms.date: 03/01/2021
ms.openlocfilehash: 8c18d4c7a3c7a9ba343296961fa9a44614366405
ms.sourcegitcommit: 15d27661c1c03bf84d3974a675c7bd11a0e086e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "102510571"
---
# <a name="email-azure-backup-reports"></a>Отчеты Azure Backup электронной почты

С помощью функции **отчета по электронной почте** , доступной в отчетах по резервному копированию, можно создавать автоматизированные задачи для получения периодических отчетов по электронной почте. Эта функция работает путем развертывания приложения логики в среде Azure, которое запрашивает данные из выбранных рабочих областей Log Analytics (LA) на основе предоставленных входных данных. Дополнительные [сведения о Logic Apps и их ценах](https://azure.microsoft.com/pricing/details/logic-apps/).

## <a name="getting-started"></a>Приступая к работе

Чтобы настроить задачи электронной почты с помощью отчетов по резервному копированию, выполните следующие действия.

1.  Перейдите в   >  раздел **отчеты резервное копирование** центра архивации и щелкните вкладку **отчет по электронной почте** .
2.  Создайте задачу, указав следующие сведения:
    * **Сведения о задаче** . имя создаваемого приложения логики, подписка, Группа ресурсов и расположение, в котором она должна быть создана. Обратите внимание, что приложение логики может запрашивать данные в нескольких подписках, группах ресурсов и расположениях (как указано в разделе фильтры отчетов), но создается в контексте одной подписки, группы ресурсов и расположения.
    * **Данные для экспорта** — вкладку, которую вы хотите экспортировать. Можно создать одно приложение задачи на вкладке или отправить все вкладки по электронной почте, используя одну задачу, выбрав параметр **все вкладки** .
    * **Параметры электронной почты**: частота по электронной почте, идентификаторы электронной почты получателей и тема сообщения электронной почты.

    ![Вкладка "Электронная почта"](./media/backup-azure-configure-backup-reports/email-tab.png)

3.  После нажатия кнопки **Отправить** и **подтвердить** будет создано приложение логики. Приложение логики и связанные с ним подключения API создаются с помощью тега **уседбибаккупрепортс: true** для простоты обнаруживаемости. Для успешного выполнения приложения логики необходимо выполнить одноразовую проверку подлинности, как описано в разделе ниже.

## <a name="authorize-connections-to-azure-monitor-logs-and-office-365"></a>Авторизация подключений к журналам Azure Monitor и Office 365

Приложение логики использует соединитель [азуремониторлогс](https://docs.microsoft.com/connectors/azuremonitorlogs/) для запроса в La рабочие области и использует соединитель [Office 365 Outlook](https://docs.microsoft.com/connectors/office365connector/) для отправки сообщений электронной почты. Для этих двух соединителей необходимо выполнить одноразовую проверку подлинности. 
 
Чтобы выполнить авторизацию, выполните следующие действия:

1.  Перейдите к **Logic Apps** в портал Azure.
2.  Найдите имя созданного приложения логики и перейдите к ресурсу.

    ![Logic Apps](./media/backup-azure-configure-backup-reports/logic-apps.png)

3.  Щелкните пункт меню **подключения API** .

    ![Подключения API](./media/backup-azure-configure-backup-reports/api-connections.png)

4.  Вы увидите два соединения с форматом `<location>-azuremonitorlogs` , а — `<location>-office365` _eastus-азуремониторлогс_ и _eastus-Office 365_.
5.  Перейдите к каждому из этих подключений и выберите пункт меню **изменить подключение API** . На появившемся экране выберите **авторизовать** и сохраните подключение после завершения авторизации.

    ![Авторизовать подключение](./media/backup-azure-configure-backup-reports/authorize-connections.png)

6.  Чтобы проверить, работает ли приложение логики после авторизации, можно вернуться к приложению логики, открыть **Обзор** и выбрать **запустить триггер** в верхней области, чтобы проверить успешность создания сообщения электронной почты.

## <a name="contents-of-the-email"></a>Содержимое сообщения электронной почты

* Все диаграммы и графы, показанные на портале, доступны в виде встроенного содержимого в сообщении электронной почты.
* Сетки, показанные на портале, доступны как вложения *. csv в сообщении электронной почты.
* Данные, показанные в сообщении электронной почты, используют все фильтры уровня отчета, выбранные пользователем в отчете, на момент создания задачи по электронной почте.
* Фильтры уровня вкладок, такие как **имя экземпляра резервной копии**, **имя политики** и т. д., не применяются. Единственным исключением является сетка **Оптимизация хранения** на вкладке **Оптимизация** , где применяются фильтры для **ежедневного**, **еженедельного**, **ежемесячного** и **ежегодного** хранения RP.
* Диапазон времени и тип агрегирования (для диаграмм) основываются на выборе диапазона времени пользователя в отчетах. Например, если выбран диапазон времени за последние 60 дней (преобразование в тип статистической обработки по неделям) и периодичность электронной почты ежедневно, получатель получит электронное письмо каждый день с диаграммами, охватывающими данные за последние 60 дней, с агрегированными данными на еженедельном уровне.

## <a name="troubleshooting-issues"></a>Устранение неполадок

Если вы не получаете сообщения электронной почты, как ожидается, даже после успешного развертывания приложения логики, выполните следующие действия, чтобы устранить неполадки конфигурации.

### <a name="scenario-1-receiving-neither-a-successful-email-nor-an-error-email"></a>Сценарий 1. получение неуспешного сообщения электронной почты или сообщения об ошибке

* Эта проблема может возникнуть из-за того, что соединитель API Outlook не является полномочным. Чтобы авторизовать подключение, выполните приведенные выше действия по авторизации.

* Эта проблема также может возникать, если при создании приложения логики был указан неверный получатель электронной почты. Чтобы проверить правильность указания получателя электронной почты, можно перейти к приложению логики в портал Azure, открыть конструктор приложений логики и выбрать шаг по электронной почте, чтобы узнать, используются ли правильные идентификаторы электронной почты.

### <a name="scenario-2-receiving-an-error-email-that-says-that-the-logic-app-failed-to-execute-to-completion"></a>Сценарий 2. получение электронного сообщения об ошибке с сообщением о том, что приложению логики не удалось выполнить до завершения

Чтобы устранить неполадку, выполните следующие действия.
1.  Перейдите к приложению логики в портал Azure.
2.  В нижней части экрана **обзора** вы увидите раздел **журнал запусков** . Вы можете открыть последний запуск и просмотреть, какие шаги в рабочем процессе завершились ошибкой. Возможные причины:
    * **Соединитель журналов Azure Monitor не авторизован**: чтобы устранить эту проблему, выполните действия по авторизации, описанные выше.
    * **Ошибка в запросе La**. Если вы настроили приложение логики собственными запросами, ошибка в любом из запросов La может привести к сбою приложения логики. Можно выбрать соответствующий шаг и просмотреть ошибку, которая вызывает неправильное выполнение запроса.

Если проблемы не удается устранить, обратитесь в службу поддержки Майкрософт.

## <a name="next-steps"></a>Дальнейшие действия
[Дополнительные сведения об отчетах по резервному копированию](https://docs.microsoft.com/azure/backup/configure-reports)
