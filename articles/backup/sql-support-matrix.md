---
title: Azure Backupная Матрица поддержки для резервного копирования SQL Server на виртуальных машинах Azure
description: Содержит сводку параметров поддержки и ограничений при резервном копировании SQL Server на виртуальных машинах Azure со службой Azure Backup.
ms.topic: conceptual
ms.date: 03/05/2020
ms.custom: references_regions
ms.openlocfilehash: 78436981c515b95ccda763d8ac916738b4364953
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97734799"
---
# <a name="support-matrix-for-sql-server-backup-in-azure-vms"></a>Матрица поддержки для SQL Server резервного копирования на виртуальных машинах Azure

Azure Backup можно использовать для резервного копирования SQL Server баз данных на виртуальных машинах Azure, размещенных на Microsoft Azure облачной платформе. В этой статье перечислены общие параметры поддержки и ограничения для сценариев и развертывания SQL Server резервного копирования на виртуальных машинах Azure.

## <a name="scenario-support"></a>Поддержка сценария

**Поддержка** | **Сведения**
--- | ---
**Поддерживаемые развертывания** | Поддерживаются виртуальные машины Azure Marketplace SQL и не связанные с Marketplace виртуальные машины (установленный вручную SQL Server).
**Поддерживаемые регионы** | Юго-Восточная Австралия (ASE), Восточная Австралия (AE), Центральная Австралия (AC), Центральная Австралия 2 (AC 2) <br> Южная Бразилия (BRS).<br> Центральная Канада (CNC), Восточная Канада (CE),<br> Юго-Восточная Азия (SEA), Восточная Азия (EA), <br> восточная часть США (EUS), восточная часть США 2 (EUS2), центрально-западная часть США (WCUS), западная часть США (WUS), западная часть США 2 (WUS 2), центрально-северная часть США (NCUS), центральная часть США (CUS), центрально-южная часть США (SCUS), <br> Центральная Индия (INC), Южная Индия (INS), Западная Индия <br> Восточная Япония (JPE), Западная Япония (JPW), <br> Республика Корея, центральный регион (KRC), Республика Корея, южный регион (KRS), <br> Северная Европа (NE), Западная Европа, <br> южная часть Соединенного Королевства (UKS), западная часть Соединенного Королевства (UKW). <br> US Gov (Аризона), US Gov (Вирджиния), US Gov (Техас), центральный регион US DoD, восточный регион US DoD <br> Северная Германия, Центрально-Западная Германия <br> Северная Швейцария, Западная Швейцария <br> Центральная Франция <br> Восточный Китай, Восточный Китай 2, Северный Китай, Северный Китай 2
**Поддерживаемые операционные системы** | Windows Server 2019, Windows Server 2016, Windows Server 2012, Windows Server 2008 R2 с пакетом обновления 1 (SP1) <br/><br/> Linux в настоящее время не поддерживается.
**Поддерживаемые версии SQL Server** | SQL Server 2019, SQL Server 2017, как описано на странице [поиска жизненного цикла приложения](https://support.microsoft.com/lifecycle/search?alpha=SQL%20server%202017), SQL Server 2016 и SharePoint Server, как описано на странице [поиска жизненного цикла приложения](https://support.microsoft.com/lifecycle/search?alpha=SQL%20server%202016%20service%20pack), SQL Server 2014, SQL Server 2012, SQL Server 2008 R2, SQL Server 2008 <br/><br/> Enterprise, Standard, Web, Developer, Express.<br><br>Версии Express Local DB не поддерживаются.
**Поддерживаемые версии .NET** | Виртуальная машина с .NET Framework версии 4.5.2 и выше.

## <a name="feature-considerations-and-limitations"></a>Характеристики и ограничения

|Параметр  |Максимальное ограничение |
|---------|---------|
|Число баз данных, которые могут быть защищены на сервере (и в хранилище)    |   2000      |
|Поддерживаемый размер базы данных (Кроме того, могут возникать проблемы с производительностью)   |   2 ТБ      |
|Число файлов, поддерживаемых в базе данных    |   1000      |

>[!NOTE]
> [Загрузите подробный планировщик ресурсов](https://download.microsoft.com/download/A/B/5/AB5D86F0-DCB7-4DC3-9872-6155C96DE500/SQL%20Server%20in%20Azure%20VM%20Backup%20Scale%20Calculator.xlsx) , чтобы вычислить приблизительное количество защищенных баз данных, рекомендуемых для каждого сервера, на основе ресурсов виртуальной машины, пропускной способности и политики резервного копирования.

* Резервное копирование SQL Server можно настроить на портале Azure или в **PowerShell**. Интерфейс командной строки не поддерживается.
* Решение поддерживается на обоих типах [развертываний](../azure-resource-manager/management/deployment-models.md) — виртуальные машины Azure Resource Manager и классические виртуальные машины.
* Поддерживаются все типы резервных копий (полные, разностные и журналы) и модели восстановления (простой/полный/с неполным протоколированием).
* Для баз данных, доступных **только для чтения** . полные резервные копии и только для копирования являются единственными поддерживаемыми типами резервных копий.
* Встроенное сжатие SQL поддерживается, если явно включено пользователем в политике резервного копирования. Azure Backup переопределяет значения по умолчанию на уровне экземпляра с помощью предложения COMPRESSION/NO_COMPRESSION в зависимости от значений этого элемента управления, заданных пользователем.
* Поддерживается резервное копирование базы данных с поддержкой TDE. Чтобы восстановить базу данных, зашифрованную с помощью TDE, на другой SQL Server, необходимо сначала [восстановить сертификат на целевом сервере](/sql/relational-databases/security/encryption/move-a-tde-protected-database-to-another-sql-server). Сжатие резервных копий для баз данных с поддержкой TDE для SQL Server 2016 и более новых версий доступно, но с меньшим размером перемещения, как описано [здесь](https://techcommunity.microsoft.com/t5/sql-server/backup-compression-for-tde-enabled-databases-important-fixes-in/ba-p/385593).
* Операции резервного копирования и восстановления для зеркальных баз данных и моментальных снимков базы данных не поддерживаются.
* **Экземпляр отказоустойчивого кластера SQL Server (FCI)** не поддерживается.
* Использование нескольких решений резервного копирования для резервного копирования автономного экземпляра SQL Server или группы доступности SQL AlwaysOn может привести к сбою резервного копирования. Не отменяйте это. Резервное копирование двух узлов группы доступности по отдельности с использованием одинаковых или разных решений также может привести к сбою резервного копирования.
* При настройке групп доступности резервные копии берутся из разных узлов в зависимости от нескольких факторов. Поведение резервного копирования для группы доступности представлено ниже.

### <a name="back-up-behavior-with-always-on-availability-groups"></a>Поведение создания резервной копии с группами доступности AlwaysOn

Рекомендуется настроить резервное копирование только на одном узле группы доступности (AG). Всегда настраивайте резервное копирование в том же регионе, что и основной узел. Иными словами, основной узел всегда должен присутствовать в регионе, где выполняется настройка резервного копирования. Если все узлы группы доступности находятся в том же регионе, где настроена резервная копия, никаких проблем не возникает.

#### <a name="for-cross-region-ag"></a>Группа доступности перехода в другой регион

* Независимо от настроек резервного копирования, резервные копии будут выполняться только с узлов, наявляющихся в том же регионе, в котором настроена резервная копия. Это связано с тем, что резервные копии между регионами не поддерживаются. Если имеется только два узла, а вторичный узел находится в другом регионе, резервные копии будут по-прежнему запускаться с первичного узла (если только параметр резервного копирования не является вторичным).
* Если узел переходит в регион, отличный от того, где настроена резервная копия, резервное копирование на узлах в регионе отработки отказа завершится сбоем.

В зависимости от установленного параметра резервного копирования и типов резервных копий (полная, разностная, резервная копия журналов, полная резервная копия только для копирования) резервные копии создаются с определенного узла (первичного или вторичного).

#### <a name="backup-preference-primary"></a>Параметры резервного копирования: основной

**Тип резервного копирования** | **Node**
--- | ---
Полное | Основной
Разностная | Основной
Журнал |  Основной
Полная резервная копия (только копирование) |  Основной

#### <a name="backup-preference-secondary-only"></a>Параметр резервного копирования: только вторичный

**Тип резервного копирования** | **Node**
--- | ---
Полное | Основной
Разностная | Основной
Журнал |  Вторичная
Полная резервная копия (только копирование) |  Вторичная

#### <a name="backup-preference-secondary"></a>Параметр резервного копирования: дополнительный

**Тип резервного копирования** | **Node**
--- | ---
Полное | Основной
Разностная | Основной
Журнал |  Вторичная
Полная резервная копия (только копирование) |  Вторичная

#### <a name="no-backup-preference"></a>Без параметров резервного копирования

**Тип резервного копирования** | **Node**
--- | ---
Полное | Основной
Разностная | Основной
Журнал |  Вторичная
Полная резервная копия (только копирование) |  Вторичная

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как [создать резервную копию базы данных SQL Server](backup-azure-sql-database.md) , которая работает на виртуальной машине Azure.