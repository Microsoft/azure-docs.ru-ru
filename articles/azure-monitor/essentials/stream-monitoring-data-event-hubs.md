---
title: Потоковая передача данных мониторинга Azure в концентратор событий и внешние партнеры
description: Узнайте, как выполнять потоковую передачу данных мониторинга Azure в концентратор событий для получения данных в партнерское средство SIEM или Analytics.
services: azure-monitor
author: bwren
ms.author: bwren
ms.topic: conceptual
ms.date: 07/15/2020
ms.openlocfilehash: a929563df3e7e98575056d07519abfda0d6ac13b
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102032965"
---
# <a name="stream-azure-monitoring-data-to-an-event-hub-or-external-partner"></a>Потоковая передача данных мониторинга Azure в концентратор событий или внешний партнер

Azure Monitor предоставляет полное решение для мониторинга стека для приложений и служб в Azure, в других облаках и в локальной среде. В дополнение к использованию Azure Monitor для анализа этих данных и использования их в различных сценариях мониторинга, может потребоваться отправить его другим средствам мониторинга в вашей среде. В большинстве случаев наиболее эффективным способом потоковой передачи данных мониторинга на внешние средства является использование [концентраторов событий Azure](../../event-hubs/index.yml). В этой статье содержится краткое описание того, как это сделать, а затем перечисляются некоторые участники, которые могут отправить данные. Некоторые имеют специальную интеграцию с Azure Monitor и могут размещаться в Azure.  

## <a name="create-an-event-hubs-namespace"></a>Создание пространства имен Центров событий

Перед настройкой потоковой передачи для любого источника данных необходимо [создать пространство имен концентраторов событий и концентратор событий](../../event-hubs/event-hubs-create.md). Они являются местом назначения всех ваших данных мониторинга. Пространство имен Центров событий — это логическое объединение концентраторов событий, которые совместно используют одну политику доступа. Применяется тот же принцип, что и для отдельных больших двоичных объектов в рамках одной учетной записи хранения. Примите во внимание следующие сведения о пространстве имен концентраторов событий и концентраторах событий, используемых для потоковой передачи данных мониторинга.

* Добавив единицы пропускной способности, можно увеличить ее масштаб для концентраторов событий. Обычно требуется только одна единица пропускной способности. Если вам нужно увеличивать масштаб по мере увеличения использования журнала, можно вручную увеличить количество единиц пропускной способности для пространства имен или Включить автозаполнение.
* Добавив разделы, вы можете распараллелить потребление по нескольким клиентам. Один раздел может поддерживать до 20MBps или приблизительно 20 000 сообщений в секунду. Средство, использующее данные, может поддерживать или не поддерживать потребление из нескольких разделов. Рекомендуется начинать с четырех секций, если вы не уверены, сколько секций нужно задать.
* Хранение сообщений настраивается в концентраторе событий не менее 7 дней. Если используемое средство выходит за пределы дня, это гарантирует, что средство сможет продолжить работу с момента остановки событий до 7 дней.
* Для концентратора событий следует использовать группу потребителей по умолчанию. Не нужно создавать другие группы объектов-получателей или использовать отдельную группу объектов-получателей, если вы не планируете задействовать два разных средства, которые будут использовать одни и те же данные в одном концентраторе событий.
* В журнале действий Azure вы выбираете пространство имен концентраторов событий, а Azure Monitor создает концентратор событий в этом пространстве имен, именуемый _Insights-Logs-_ Operations-Logs. Для других типов журналов можно выбрать существующий концентратор событий или иметь Azure Monitor создать концентратор событий для каждой категории журналов.
* Исходящий порт 5671 и 5672 обычно должны быть открыты на компьютере или виртуальной сети, использующей данные из концентратора событий.

## <a name="monitoring-data-available"></a>Доступны данные мониторинга
[Источники данных мониторинга для Azure Monitor](../agents/data-sources.md) описывают различные уровни данных для приложений Azure и типы данных мониторинга, доступные для каждого из них. В следующей таблице приведен список всех этих уровней и описание того, как эти данные можно передавать в концентратор событий. Для получения дополнительных сведений следуйте приведенным ниже ссылкам.

| Уровень | Данные | Метод |
|:---|:---|:---|
| [Клиент Azure](../agents/data-sources.md#azure-tenant) | Журналы аудита Azure Active Directory | Настройте параметр диагностики клиента в клиенте AAD. Дополнительные сведения см.  [в статье учебник. потоковая Azure Active Directory журналов в концентратор событий Azure](../../active-directory/reports-monitoring/tutorial-azure-monitor-stream-logs-to-event-hub.md) . |
| [Подписка Azure.](../agents/data-sources.md#azure-subscription) | Журнал действий Azure | Создайте профиль журнала для экспорта событий журнала действий в концентраторы событий.  Дополнительные сведения см. [в статье потоковая передача журналов платформы Azure в концентраторы событий Azure](../essentials/resource-logs.md#send-to-azure-event-hubs) . |
| [Ресурсы Azure](../agents/data-sources.md#azure-resources) | Метрики платформы<br> Журналы ресурсов |Оба типа данных отправляются в концентратор событий с использованием параметра диагностики ресурсов. Дополнительные сведения см. [в статье потоковая передача журналов ресурсов Azure в концентратор событий](../essentials/resource-logs.md#send-to-azure-event-hubs) . |
| [Операционная система (гость)](../agents/data-sources.md#operating-system-guest) | Виртуальные машины Azure | Установите [расширение система диагностики Azure](../agents/diagnostics-extension-overview.md) на виртуальных машинах Windows и Linux в Azure. Дополнительные сведения о виртуальных машинах Windows и об [использовании диагностического расширения Linux для мониторинга метрик и журналов](../../virtual-machines/extensions/diagnostics-linux.md#protected-settings) см. в статье [потоковая передача система диагностики Azure данных в критическом пути с помощью концентраторов событий](../agents/diagnostics-extension-stream-event-hubs.md) . |
| [Код приложения](../agents/data-sources.md#application-code) | Application Insights | Application Insights не предоставляет прямой метод для потоковой передачи данных в концентраторы событий. Вы можете [настроить непрерывный экспорт](../app/export-telemetry.md) данных Application Insights в учетную запись хранения, а затем использовать приложение логики для отправки данных в концентратор событий, как описано в разделе [потоковая передача вручную с помощью приложения логики](#manual-streaming-with-logic-app). |

## <a name="manual-streaming-with-logic-app"></a>Потоковая передача вручную с помощью приложения логики
Для данных, которые нельзя напрямую передать в концентратор событий, можно выполнить запись в службу хранилища Azure, а затем использовать приложение логики, запускаемое по времени, которое [извлекает данные из хранилища BLOB-объектов](../../connectors/connectors-create-api-azureblobstorage.md#add-action) и [отправляет их в качестве сообщения в концентратор событий](../../connectors/connectors-create-api-azure-event-hubs.md#add-action). 


## <a name="partner-tools-with-azure-monitor-integration"></a>Средства партнеров с интеграцией Azure Monitor

Маршрутизация данных мониторинга в концентратор событий с помощью Azure Monitor позволяет легко интегрироваться с внешними средствами SIEM и мониторинга. Примерами средств интеграции Azure Monitor являются следующие:

| Инструмент | Размещено в Azure | Описание |
|:---|:---| :---|
|  IBM QRadar | Нет | Модуль устройства (DSM) Microsoft Azure и протокол концентратора событий Microsoft Azure доступны для загрузки на [веб-сайте поддержки IBM](https://www.ibm.com/support). Дополнительные сведения об интеграции с Azure можно узнать в [конфигурации DSM QRadar](https://www.ibm.com/support/knowledgecenter/SS42VS_DSM/c_dsm_guide_microsoft_azure_overview.html?cp=SS42VS_7.3.0). |
| Splunk | Нет | [Microsoft Azure Add-On для Splunk](https://splunkbase.splunk.com/app/3757/) — это проект с открытым кодом, доступный в Splunkbase. <br><br> Если вы не можете установить надстройку в экземпляре Splunk, например, вы используете прокси-сервер или работаете в облаке Splunk, вы можете перенаправить эти события в сборщик событий Splunk HTTP с помощью [функции Azure для Splunk](https://github.com/Microsoft/AzureFunctionforSplunkVS), которая активируется новыми сообщениями в концентраторе событий. |
| sumologic | Нет | Инструкции по настройке SumoLogic для использования данных из концентратора событий доступны в статье [Получение журналов для приложения аудита Azure из концентратора событий](https://help.sumologic.com/Send-Data/Applications-and-Other-Data-Sources/Azure-Audit/02Collect-Logs-for-Azure-Audit-from-Event-Hub). |
| ArcSight | Нет | Смарт-соединитель концентратора событий Azure ArcSight доступен в составе [коллекции смарт-соединителей ArcSight](https://community.softwaregrp.com/t5/Discussions/Announcing-General-Availability-of-ArcSight-Smart-Connectors-7/m-p/1671852). |
| Сервер системного журнала | Нет | Если вы хотите передавать данные Azure Monitor непосредственно на сервер syslog, можно использовать [решение, основанное на функции Azure](https://github.com/miguelangelopereira/azuremonitor2syslog/).
| логрхисм | Нет| Инструкции по настройке Логрхисм для получения журналов из концентратора событий доступны [здесь](https://logrhythm.com/six-tips-for-securing-your-azure-cloud-environment/). 
|Logz.io | Да | Дополнительные сведения см. в статье [Приступая к работе с мониторингом и ведением журнала с помощью Logz.IO для приложений Java, работающих в Azure](/azure/developer/java/fundamentals/java-get-started-with-logzio) .

Также могут быть доступны другие партнеры. Более полный список всех Azure Monitor партнеров и их возможностей см. в статье [Интеграция с Azure Monitor партнерами](../partners.md).

## <a name="next-steps"></a>Дальнейшие действия
* [Архивация журнала действий в учетную запись хранения](./activity-log.md#legacy-collection-methods)
* [Ознакомьтесь с обзором журнала действий Azure.](../essentials/platform-logs-overview.md)
* [Настройка оповещения на основе события журнала действий](../alerts/alerts-log-webhook.md)