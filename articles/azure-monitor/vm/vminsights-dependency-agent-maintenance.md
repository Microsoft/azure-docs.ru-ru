---
title: Обновление агента зависимостей VM Insights
description: В этой статье описывается, как обновить агент зависимостей VM Insights с помощью командной строки, мастера установки и других методов.
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 04/16/2020
ms.openlocfilehash: acd1b6c8e5c1be76b29c93fddc57c799aef0a526
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102046709"
---
# <a name="how-to-upgrade-the-vm-insights-dependency-agent"></a>Обновление агента зависимостей VM Insights

После первоначального развертывания агента зависимостей VM Insights выпускаются обновления, включающие исправления ошибок или поддержку новых функций или функций.  Эта статья поможет вам понять доступные методы и выполнить обновление вручную или с помощью службы автоматизации.

## <a name="upgrade-options"></a>Параметры обновления 

Агент зависимостей для Windows и Linux можно обновить до последнего выпуска вручную или автоматически в зависимости от сценария развертывания и среды, в которой выполняется компьютер. Для обновления агента можно использовать следующие методы.

|Среда |Метод установки |Метод перехода |
|------------|--------------------|---------------|
|Azure | Расширение виртуальной машины агента зависимостей для [Windows](../../virtual-machines/extensions/agent-dependency-windows.md) и [Linux](../../virtual-machines/extensions/agent-dependency-linux.md) | Агент автоматически обновляется по умолчанию, если не настроен шаблон Azure Resource Manager для отказаться от установки свойства *autoUpgradeMinorVersion* в **значение false**. Обновление дополнительной версии, в которой отключено автоматическое обновление, и обновление основной версии, выполните тот же метод-Uninstall и переустановите расширение. |
| Пользовательские образы виртуальных машин Azure | Установка агента зависимостей для Windows и Linux вручную | Обновление виртуальных машин до последней версии агента необходимо выполнить из командной строки, в которой выполняется пакет установщика Windows или самораспаковывающийся и устанавливаемый комплект сценариев оболочки для Linux.|
| Виртуальные машины, не относящиеся к Azure | Установка агента зависимостей для Windows и Linux вручную | Обновление виртуальных машин до последней версии агента необходимо выполнить из командной строки, в которой выполняется пакет установщика Windows или самораспаковывающийся и устанавливаемый комплект сценариев оболочки для Linux. |

## <a name="upgrade-windows-agent"></a>Обновление агента Windows 

Чтобы обновить агент на виртуальной машине Windows до последней версии, не установленной с помощью расширения виртуальной машины агента зависимостей, запустите из командной строки, скрипта или другого решения по автоматизации или с помощью мастера установки InstallDependencyAgent-Windows.exe.  

Последнюю версию агента Windows можно скачать [отсюда](https://aka.ms/dependencyagentwindows).

### <a name="using-the-setup-wizard"></a>Использование мастера установки

1. Войдите в систему компьютера, используя учетную запись с правами администратора.

2. Выполните **InstallDependencyAgent-Windows.exe** , чтобы запустить мастер установки.
   
3. Следуйте указаниям мастера **установки dependency Agent** , чтобы удалить предыдущую версию агента зависимостей, а затем установите последнюю версию.


### <a name="from-the-command-line"></a>В командной строке

1. Войдите в систему компьютера, используя учетную запись с правами администратора.

2. Выполните следующую команду.

    ```dos
    InstallDependencyAgent-Windows.exe /S /RebootMode=manual
    ```

    `/RebootMode=manual`Параметр не позволяет обновить автоматическую перезагрузку компьютера, если некоторые процессы используют файлы из предыдущей версии и заблокировали их. 

3. Чтобы убедиться, что обновление прошло успешно, ознакомьтесь с `install.log` подробными сведениями о настройке. Каталогом журналов является *%Programfiles%\Microsoft Dependency Agent\logs*.

## <a name="upgrade-linux-agent"></a>Обновление агента Linux 

Обновление с предыдущих версий агента зависимостей в Linux поддерживается и выполняется после той же команды, что и Новая установка.

Последнюю версию агента Linux можно скачать [отсюда](https://aka.ms/dependencyagentlinux).

1. Войдите в систему компьютера, используя учетную запись с правами администратора.

2. Выполните следующую команду в качестве привилегированной `sh InstallDependencyAgent-Linux64.bin -s` . 

Если Dependency Agent не запускается, просмотрите подробные сведения об ошибке в записях журналов. В агентах Linux каталог журнала — *расположении/var/opt/Microsoft/dependency-Agent/log*. 

## <a name="next-steps"></a>Следующие шаги

Если вы хотите отключить мониторинг виртуальных машин в течение определенного периода времени или полностью удалить эту аналитику, см. статью [Отключение мониторинга виртуальных машин в VM Insights](../vm/vminsights-optout.md).
