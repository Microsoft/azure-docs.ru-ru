---
title: Часто задаваемые вопросы Azure Monitor для виртуальных машин (общедоступные) | Документация Майкрософт
description: Azure Monitor для виртуальных машин — это решение в Azure, которое отслеживает работоспособность и производительность ОС виртуальных машин Azure, автоматически обнаруживает компоненты приложений и их зависимости от других ресурсов, а также строит схему каналов связи между ними. В этой статье содержатся ответы на часто задаваемые вопросы о общедоступном выпуске.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 01/31/2020
ms.openlocfilehash: 1958c5fcdac4ae2a080dd8a43178c204ba5fadd6
ms.sourcegitcommit: e559daa1f7115d703bfa1b87da1cf267bf6ae9e8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "100625644"
---
# <a name="azure-monitor-for-vms-generally-available-ga-frequently-asked-questions"></a>Часто задаваемые вопросы о Azure Monitor для виртуальных машин общедоступной версии
В этой общей статье часто задаваемые вопросы рассматриваются изменения, внесенные в Q4 2019 и Q1 2020 по мере подготовки к общедоступной версии.

## <a name="updates-for-azure-monitor-for-vms"></a>Обновления для Azure Monitor для виртуальных машин
Мы выпустили новую версию Azure Monitor для виртуальных машин в январе 2020 Опережайте наше объявление. Клиенты, которые разрешающие Azure Monitor для виртуальных машин, теперь получат общедоступную версию, но существующие клиенты, использующие версию Azure Monitor для виртуальных машин из Q4 2019 и более ранних версий, получат запрос на обновление. Это руководство содержит рекомендации по обновлению в масштабе при наличии крупных развертываний в нескольких рабочих областях.


При этом обновлении Azure Monitor для виртуальных машин данные о производительности хранятся в той же таблице *инсигхтсметрикс* , что и [Azure Monitor для контейнеров](../insights/container-insights-overview.md), что упрощает запрос двух наборов данных. Кроме того, вы можете хранить более разнообразные наборы данных, которые не могли бы храниться в ранее использованной таблице. 

Наши представления производительности теперь используют данные, хранящиеся в таблице *инсигхтсметрикс* .  Если вы еще не перешли на использование новейшего решения Вминсигхтс в рабочей области, на диаграммах больше не будут отображаться сведения.  Вы можете обновить страницу **Приступая к работе** , как описано ниже.


## <a name="what-is-changing"></a>Что изменяется?
Мы выпустили новое решение с именем Вминсигхтс, которое включает дополнительные возможности для сбора данных, а также новое расположение для хранения этих данных в рабочей области Log Analytics. 

В прошлом мы включили решение ServiceMap в рабочую область и настроили счетчики производительности в рабочей области Log Analytics для отправки данных в таблицу *производительности* . Это новое решение отправляет данные в таблицу с именем *инсигхтсметрикс* , которая также используется Azure Monitor для контейнеров. Эта схема таблицы позволяет нам хранить дополнительные метрики и наборы данных служб, несовместимые с форматом таблицы *производительности* .

Мы обновили наши диаграммы производительности, чтобы использовать данные, хранящиеся в таблице *инсигхтсметрикс* . Вы можете выполнить обновление до использования таблицы *инсигхтсметрикс* на странице **Приступая к работе** , как описано ниже.


## <a name="how-do-i-upgrade"></a>Разделы справки обновить?
При обновлении Log Analytics рабочей области до последней версии Azure Monitor на виртуальных машинах, агент зависимостей будет обновлен на каждой виртуальной машине, подключенной к этой рабочей области. Каждая виртуальная машина, нуждающаяся в обновлении, будет идентифицирована на вкладке Начало **работы** в Azure Monitor для виртуальных машин в портал Azure. При выборе обновления виртуальной машины будет обновлена Рабочая область для этой виртуальной машины вместе с другими виртуальными машинами, подключенными к этой рабочей области. Можно выбрать одну или несколько виртуальных машин, групп ресурсов или подписок. 

Используйте следующую команду для обновления рабочей области с помощью PowerShell:

```PowerShell
Set-AzOperationalInsightsIntelligencePack -ResourceGroupName <resource-group-name> -WorkspaceName <workspace-name> -IntelligencePackName "VMInsights" -Enabled $True
```

## <a name="what-should-i-do-about-the-performance-counters-in-my-workspace-if-i-install-the-vminsights-solution"></a>Что делать со счетчиками производительности в моей рабочей области, если я устанавливаю решение Вминсигхтс?

Предыдущий способ включения Azure Monitor для виртуальных машин использование счетчиков производительности в рабочей области. Текущая версия сохраняет эти данные в таблице с именем `InsightsMetrics` . Вы можете отключить эти счетчики производительности в рабочей области, если вам больше не нужно их использовать. 

>[!NOTE]
>При наличии правил генерации оповещений, ссылающихся на эти счетчики в `Perf` таблице, необходимо обновить их, чтобы они ссылались на новые данные, хранящиеся в `InsightsMetrics` таблице. См. документацию по запросам к журналу, которые можно использовать для обращения к этой таблице.
>

Если вы решили сохранить счетчики производительности, вам будет выставлен счет за полученные и хранящиеся в таблице данные, `Perf` основанные на [ценах на log Analytics [( https://azure.microsoft.com/pricing/details/monitor/) .

## <a name="how-will-this-change-affect-my-alert-rules"></a>Как это изменение повлияет на мои правила генерации оповещений?

Если вы создали [оповещения журнала](../alerts/alerts-unified-log.md) , которые запрашивают в `Perf` таблице целевые счетчики производительности, которые были включены в рабочей области, следует обновить эти правила, чтобы они ссылались на `InsightsMetrics` таблицу. Это руководство также применяется к любым правилам поиска журналов с помощью `ServiceMapComputer_CL` и `ServiceMapProcess_CL` , поскольку эти наборы данных перемещаются `VMComputer` в `VMProcess` таблицы и.

Мы будем обновлять эту часто задаваемые вопросы и документацию, включив в нее примеры правил генерации оповещений поиска по журналам для наборов данных, которые мы соберем.

## <a name="how-will-this-affect-my-bill"></a>Как это повлияет на счет?

Выставление счетов по-прежнему основано на данных, принятых и хранящихся в рабочей области Log Analytics.

Собранные данные о производительности на уровне компьютера одинаковы, имеют одинаковый размер для данных, хранящихся в `Perf` таблице, и будут стоить примерно столько же.

## <a name="what-if-i-only-want-to-use-service-map"></a>Что делать, если я хотел бы использовать только Сопоставление служб?

Это нормально. Вы увидите запросы в портал Azure при просмотре Azure Monitor для виртуальных машин о предстоящем обновлении. После выпуска вы получите запрос на обновление до новой версии. Если вы предпочитаете использовать только функции [карт](vminsights-maps.md) , вы можете не обновлять и продолжать использовать функцию карт в Azure Monitor для виртуальных машин и сопоставление служб решение, доступ к которому осуществляется из рабочей области или плитки панели мониторинга.

Если вы решили включить счетчики производительности вручную в рабочей области, вы можете увидеть данные на некоторых из наших диаграмм производительности, просмотрев их Azure Monitor. После выпуска нового решения мы будем обновлять наши диаграммы производительности для запроса данных, хранящихся в `InsightsMetrics` таблице. Если вы хотите просмотреть данные из этой таблицы на этих диаграммах, необходимо выполнить обновление до новой версии Azure Monitor для виртуальных машин.

Изменения в перемещении данных из `ServiceMapComputer_CL` и `ServiceMapProcess_CL` повлияют на Сопоставление служб и Azure Monitor для виртуальных машин, поэтому вам все равно нужно спланировать это обновление.

Если вы решили не выполнять обновление до решения **вминсигхтс** , мы будем продолжать предоставлять устаревшие версии книг по производительности, которые ссылаются на данные в `Perf` таблице.  

## <a name="will-the-service-map-data-sets-also-be-stored-in-insightsmetrics"></a>Будут ли Сопоставление служб наборы данных также сохранены в Инсигхтсметрикс?

Если используются оба решения, наборы данных не будут дублироваться. Оба предложения совместно используют наборы данных, которые будут храниться в `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection` и `VMBoundPort` в таблицах для хранения собранных наборов данных сопоставлений.  

В `InsightsMetrics` таблице будут храниться собранные наборы данных виртуальных машин, процессов и служб, которые будут заполнены только при использовании Azure Monitor для виртуальных машин и решения VM Insights. Сопоставление служб решение не будет выполнять накопление или хранение данных в `InsightsMetrics` таблице.

## <a name="will-i-be-double-charged-if-i-have-the-service-map-and-vminsights-solutions-in-my-workspace"></a>Будет ли я вдвое заряжена, если у меня есть решения Сопоставление служб и Вминсигхтс в моей рабочей области?

Нет, два решения совместно используют наборы данных карт, которые хранятся в `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection` и `VMBoundPort` . Если в вашей рабочей области есть оба решения, вы не будете использовать двойную оплату за эти данные.

## <a name="if-i-remove-either-the-service-map-or-vminsights-solution-will-it-remove-my-data"></a>Если удалить решение Сопоставление служб или Вминсигхтс, будут ли удалены мои данные?

Нет, два решения совместно используют наборы данных карт, которые хранятся в `VMComputer` (ранее ServiceMapComputer_CL), `VMProcess` (ранее ServiceMapProcess_CL), `VMConnection` и `VMBoundPort` . Если вы удалите одно из решений, эти наборы данных заметят, что по-прежнему существует решение, которое использует данные и остается в рабочей области Log Analytics. Для удаления данных из рабочей области необходимо удалить оба решения.

## <a name="health-feature-is-in-limited-public-preview"></a>Функция работоспособности ограничена общедоступной предварительной версией

Мы получили огромное мнение от клиентов о наборе функций работоспособности виртуальной машины. Эта функция очень интересна и повышена благодаря возможности поддерживать рабочие процессы мониторинга. Мы планируем внести ряд изменений, чтобы добавить функции и устранить полученные отзывы. 

Чтобы снизить влияние этих изменений на новых клиентов, мы перенесли эту функцию в **ограниченную общедоступную предварительную версию**. Это обновление произошло в 2019 октября.

Мы планируем повторно запустить эту функцию работоспособности в 2020, после того, как Azure Monitor для виртуальных машин находится в общедоступной версии.

## <a name="how-do-existing-customers-access-the-health-feature"></a>Как существующие клиенты получают доступ к функции работоспособности?

Существующие клиенты, использующие функцию работоспособности, будут по прежнему иметь доступ к ней, но не будут предлагаться новым клиентам.  

Чтобы получить доступ к функции, можно добавить в `feature.vmhealth=true` URL-адрес портал Azure следующий флаг компонента [https://portal.azure.com](https://portal.azure.com) . Пример `https://portal.azure.com/?feature.vmhealth=true` .

Можно также использовать этот короткий URL-адрес, который автоматически устанавливает флаг компонента: [https://aka.ms/vmhealthpreview](https://aka.ms/vmhealthpreview) .

В качестве существующего клиента можно продолжать использовать функцию работоспособности на виртуальных машинах, подключенных к существующей настройке рабочей области, с функцией работоспособности.  

## <a name="i-use-vm-health-now-with-one-environment-and-would-like-to-deploy-it-to-a-new-one"></a>Я использую работоспособность виртуальной машины сейчас с одной средой и хочу развернуть ее в новом

Если вы являетесь клиентом, использующим функцию работоспособности и хотите использовать его для нового развертывания, обратитесь к нам по vminsights@microsoft.com запросу.

## <a name="next-steps"></a>Дальнейшие шаги

Сведения о требованиях и методах, помогающих отслеживать виртуальные машины, см. в статье [Подключение Azure Monitor для виртуальных машин (предварительная версия)](../insights/vminsights-enable-overview.md).
