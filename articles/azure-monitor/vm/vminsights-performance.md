---
title: Как построить диаграмму производительности с помощью VM Insights
description: Производительность — это функция аналитики виртуальной машины, которая автоматически обнаруживает компоненты приложений в системах Windows и Linux и сопоставляет взаимодействие между службами. В этой статье рассказывается о том, как использовать эту функцию в различных сценариях.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 05/31/2020
ms.openlocfilehash: 9c69ea3da71063d7e20ebf31ae2eb3df9a51e2c2
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101725447"
---
# <a name="how-to-chart-performance-with-vm-insights"></a>Как построить диаграмму производительности с помощью VM Insights

VM Insights включает набор диаграмм производительности, предназначенных для нескольких ключевых показателей эффективности (KPI), которые помогают определить, насколько хорошо работает виртуальная машина. На диаграммах отображается использование ресурсов за определенный период времени, что позволяет выявлять узкие места, аномалии, а также переключаться на перспективное представление каждой виртуальной машины для просмотра использования ресурсов на основе выбранной метрики. Хотя существует множество элементов, которые следует учитывать при работе с производительностью, VM Insights отслеживает ключевые показатели производительности операционной системы, связанные с процессором, памятью, сетевым адаптером и использованием дискового пространства. Функция "Производительность" дополняет функцию мониторинга работоспособности и помогает выявлять проблемы, которые указывают на возможный отказ компонентов системы, поддерживает настройку и оптимизацию для повышения эффективности, а также планирование ресурсов.  

## <a name="limitations"></a>Ограничения
Ниже приведены ограничения в сборе производительности с помощью VM Insights.

- Метрика **Доступная память** недоступна для виртуальных машин под управлением ОС Red Hat Linux (RHEL) 6. Эта метрика вычисляется на основе функции **MemAvailable**, которая появилась в [версии ядра 3.14](http://www.man7.org/linux/man-pages/man1/free.1.html).
- Метрики доступны только для дисков данных на виртуальных машинах Linux с использованием файловой системы XFS или семейства EXT FileSystem (EXT2, EXT3, EXT4).

## <a name="multi-vm-perspective-from-azure-monitor"></a>Перспективное представление нескольких виртуальных машин в Azure Monitor

В Azure Monitor функция "Производительность" обеспечивает представление всех отслеживаемых виртуальных машин, развернутых в рабочих группах в ваших подписках или во всей среде. Чтобы получить доступ к Azure Monitor, выполните указанные ниже действия. 

1. На портале Azure выберите **Монитор**. 
2. В разделе **Решения** выберите пункт **Виртуальные машины**.
3. Выберите вкладку **Производительность**.

![Представление списка первых N диаграмм производительности в аналитике виртуальных машин](media/vminsights-performance/vminsights-performance-aggview-01.png)

На вкладке **Top N Charts** (Первые N диаграмм), если у вас несколько рабочих областей Log Analytics, выберите рабочую область, которая включена в решении, в селекторе **Рабочая область** вверху страницы. Селектор **Группа** возвращает подписки, группы ресурсов, [группы компьютеров](../logs/computer-groups.md) и масштабируемые наборы виртуальных машин с компьютеров, связанных с выбранной рабочей областью, которые вы можете использовать для дальнейшей фильтрации результатов, представленных на диаграммах этой и других страниц. Выбор применяется только к функции производительности и не применяется к работоспособности и сопоставлению.  

По умолчанию на диаграммах отображаются последние 24 часа. С помощью селектора **Временной интервал** можно запросить временной интервал длительностью до 30 дней, чтобы отобразить производительность за прошедший период.

На странице отображаются пять диаграмм использования ресурсов:

* "Загрузка ЦП (%)" — показывает первые пять компьютеров с наибольшей средней загрузкой процессоров. 
* "Доступная память" — показывает первые пять компьютеров с наименьшим средним объемом доступной памяти. 
* Logical Disk Space Used % (% используемого места на логических дисках) — показывает первые пять компьютеров с наибольшим средним процентом использования места на всех томах дисков. 
* Bytes Sent Rate (Скорость отправки байт) — показывает первые пять компьютеров с наибольшим средним количеством отправленных байт. 
* Bytes Receive Rate (Скорость получения байт) — показывает первые пять компьютеров с наибольшим средним количеством полученных байт. 

Щелкнув значок закрепления в правом верхнем углу любой из пяти диаграмм, вы закрепите выбранную диаграмму на последней просмотренной панели мониторинга Azure.  На панели мониторинга вы можете изменить размер и положение диаграммы. Выбор диаграммы на панели мониторинга приведет к перенаправлению на VM Insights и загрузке правильной области и представления.  

Щелчок по значку, который расположен слева от значка закрепления на любой из пяти диаграмм, открывает представление **Первые N в списке**.  Здесь можно просмотреть использование ресурсов для соответствующей метрики производительности по отдельным виртуальным машинам в виде списка и увидеть, для какой виртуальной машины характерны наиболее высокие показатели.  

![Вид списка первых N для выбранной метрики производительности](media/vminsights-performance/vminsights-performance-topnlist-01.png)

Если щелкнуть виртуальную машину, справа будет развернута область **Свойства**, в которой отображаются свойства выбранного элемента, например сведения о системе, предоставленные операционной системой, свойства виртуальной машины Azure и т. п. Если щелкнуть один из параметров в разделе **Быстрые ссылки**, соответствующий компонент откроется непосредственно на выбранной виртуальной машине.  

![Область "Свойства" виртуальной машины](./media/vminsights-performance/vminsights-properties-pane-01.png)

Переключитесь на вкладку **Aggregated Charts** (Сводные диаграммы), чтобы просмотреть метрики производительности, отфильтрованные по средним показателям или процентилям.  

![Сводное представление производительности в аналитике виртуальных машин](./media/vminsights-performance/vminsights-performance-aggview-02.png)

Отображаются следующие диаграммы использования ресурсов:

* "Загрузка ЦП (%)" — по умолчанию отображаются среднее значение и верхний 95-й процентиль. 
* "Доступная память" — по умолчанию отображаются среднее значение, верхние 5-й и 10-й процентили. 
* Logical Disk Space Used % (% используемого места на логических дисках) — по умолчанию отображаются среднее значение и 95-й процентиль. 
* Bytes Sent Rate (Скорость отправки байт) — по умолчанию отображается среднее количество отправленных байт. 
* Bytes Receive Rate (Скорость получения байт) — по умолчанию отображается среднее количество полученных байт.

Также в диапазоне времени можно изменить детализацию диаграмм, выбрав **Ср.** , **Мин.** , **Макс.** , **50-й**, **90-й** и **95-й** в селекторе процентилей.

Чтобы просмотреть использование ресурсов по отдельным виртуальным машинам в представлении списка и увидеть, для какой машины характерны самые высокие показатели использования, выберите вкладку **Top N List** (Список первых N).  На странице **Top N List** (Список первых N) отображаются первые 20 виртуальных машин, отсортированные по наибольшему использованию ресурсов по 95-му процентилю для метрики *Загрузка ЦП (%)* .  Чтобы просмотреть дополнительные машины, выберите **Загрузить больше**. Отобразятся результаты для первых 500 виртуальных машин. 

>[!NOTE]
>В списке нельзя отобразить более чем 500 машин одновременно.  
>

![Пример страницы Top N List (Список первых N)](./media/vminsights-performance/vminsights-performance-topnlist-01.png)

Чтобы отфильтровать результаты по конкретной виртуальной машине в списке, введите ее имя компьютера в текстовое поле **Поиск по имени**.  

Если требуется просмотреть сведения об использовании по другой метрике производительности, в раскрывающемся списке **Метрика** выберите **Доступная память**, **Logical Disk Space Used %** (% используемого места на логических дисках), **Network Received Byte/s** (Получено байт по сети/с) или **Network Sent Byte/s** (Отправлено байт по сети/с), и список обновится, отображая показатели использования по соответствующей метрике.  

Если выбрать виртуальную машину из списка, откроется панель **Свойства** в правой части страницы, где можно выбрать **Сведения о производительности**.  Откроется страница **сведений о виртуальной машине**, ограниченных соответствующей виртуальной машиной, подобно доступу к функции "Производительность" аналитики виртуальных машин непосредственно с виртуальной машины Azure.  

## <a name="view-performance-directly-from-an-azure-vm"></a>Просмотр производительности непосредственно с виртуальной машины Azure

Чтобы получить доступ непосредственно с виртуальной машины, выполните следующие шаги:

1. На портале Azure выберите **Виртуальные машины**. 
2. В списке выберите виртуальную машину и в разделе **Мониторинг** выберите пункт **Аналитика**.  
3. Выберите вкладку **Производительность**. 

Эта страница содержит не только диаграммы использования производительности, но и таблицу с отображением каждого обнаруженного логического диска, его емкости, использования и общего среднего значения по каждому показателю.  

Отображаются следующие диаграммы использования ресурсов:

* "Загрузка ЦП (%)" — по умолчанию отображаются среднее значение и верхний 95-й процентиль. 
* "Доступная память" — по умолчанию отображаются среднее значение, верхние 5-й и 10-й процентили. 
* Logical Disk Space Used % (% используемого места на логических дисках) — по умолчанию отображаются среднее значение и 95-й процентиль. 
* Logical Disk IOPS (Операций ввода-вывода в секунду для логических дисков) — по умолчанию отображаются среднее значение и 95-й процентиль.
* Logical Disk MB/s (Мбит/с для логических дисков) — по умолчанию отображаются среднее значение и 95-й процентиль.
* Max Logical Disk Used % (Макс. % использования логических дисков) — по умолчанию отображаются среднее значение и 95-й процентиль.
* Bytes Sent Rate (Скорость отправки байт) — по умолчанию отображается среднее количество отправленных байт. 
* Bytes Receive Rate (Скорость получения байт) — по умолчанию отображается среднее количество полученных байт.

Щелкнув значок закрепления в правом верхнем углу любой из диаграмм, вы закрепите выбранную диаграмму на последней просмотренной панели мониторинга Azure. На панели мониторинга вы можете изменить размер и положение диаграммы. Выбор диаграммы на панели мониторинга перенаправляет вас на VM Insights и загружает Подробное представление производительности для виртуальной машины.  

![Представление производительности непосредственно с виртуальной машины в аналитике виртуальных машин](./media/vminsights-performance/vminsights-performance-directvm-01.png)

## <a name="view-performance-directly-from-an-azure-virtual-machine-scale-set"></a>Просмотр данных о производительности непосредственно из масштабируемого набора виртуальных машин Azure

Чтобы получить доступ непосредственно из масштабируемого набора виртуальных машин Azure, выполните следующие шаги:

1. На портале Azure выберите **Масштабируемые наборы виртуальных машин**.
2. Выберите в этом списке виртуальную машину и в разделе **Мониторинг** выберите пункт **Аналитика**, чтобы открыть вкладку **Производительность**.

На этой странице загрузится представление производительности Azure Monitor, где автоматически выбирается область выбранного масштабируемого набора. Это позволяет увидеть верхние N экземпляров в масштабируемом наборе по критериям отслеживаемых метрик, просмотреть сводные данные о производительности по масштабируемому набору и просматривать тенденции по выбранным метрикам для отдельных экземпляров из масштабируемого набора. Выбрав экземпляр из представления списка, вы загрузите его карту или перейдете в подробное представление производительности для этого экземпляра.

Щелкнув значок закрепления в правом верхнем углу любой из диаграмм, вы закрепите выбранную диаграмму на последней просмотренной панели мониторинга Azure. На панели мониторинга вы можете изменить размер и положение диаграммы. Выбор диаграммы на панели мониторинга перенаправляет вас на VM Insights и загружает Подробное представление производительности для виртуальной машины.  

![Просмотр аналитических сведений о производительности виртуальных машин непосредственно из представления масштабируемого набора виртуальных машин](./media/vminsights-performance/vminsights-performance-directvmss-01.png)

>[!NOTE]
>Вы также можете получить доступ к подробному представлению производительности для конкретного экземпляра из представления экземпляров в масштабируемом наборе. Перейдите к элементу **Экземпляры** в разделе **Параметры**, а затем выберите **Аналитика**.



## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как использовать [книги](vminsights-workbooks.md) , входящие в состав VM Insights, для дальнейшего анализа производительности и метрик сети.  

- Дополнительные сведения об обнаруженных зависимостях приложений см. в разделе [Просмотр схемы VM Insights](vminsights-maps.md).
