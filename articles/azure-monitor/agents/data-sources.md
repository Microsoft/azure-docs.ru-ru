---
title: Источники данных в Azure Monitor | Документация Майкрософт
description: Описывает данные, доступные для мониторинга работоспособности и производительности ресурсов Azure, а также выполняющихся на их базе приложений.
ms.subservice: ''
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 10/06/2020
ms.openlocfilehash: a28748854e039d639755ce6bb93fb68695bd9891
ms.sourcegitcommit: e559daa1f7115d703bfa1b87da1cf267bf6ae9e8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/17/2021
ms.locfileid: "100624177"
---
# <a name="sources-of-monitoring-data-for-azure-monitor"></a>Источники данных мониторинга для Azure Monitor
Azure Monitor основан на [общей платформе данных мониторинга](../platform/data-platform.md) , которая включает [журналы](../platform/data-platform-logs.md) и [метрики](../platform/data-platform-metrics.md). Сбор данных в эту платформу позволяет анализировать данные из нескольких ресурсов вместе с помощью общего набора средств в Azure Monitor. Данные мониторинга могут также отправляться в другие расположения для поддержки определенных сценариев, а некоторые ресурсы могут выполнять запись в другие расположения, прежде чем их можно будет собрать в журналы или метрики.

В этой статье описываются различные источники данных мониторинга, собранные Azure Monitor в дополнение к данным мониторинга, созданным ресурсами Azure. Ссылки на подробные сведения о конфигурации, необходимой для накопления этих данных в разных расположениях.

## <a name="application-tiers"></a>Уровни приложений

Источники данных мониторинга из приложений Azure могут быть организованы по уровням, самым высоким уровням самого приложения и более низким уровням, которые являются компонентами платформы Azure. Метод доступа к данным из каждого уровня различается. Уровни приложений приведены в таблице ниже, а источники данных мониторинга на каждом уровне представлены в следующих разделах. Описание каждого расположения данных и способ доступа к его данным см. [в разделе Мониторинг расположений данных в Azure](../monitor-reference.md) .


![Уровни мониторинга](../media/overview/overview.png)


### <a name="azure"></a>Azure
В следующей таблице кратко описаны уровни приложений, которые относятся к Azure. Чтобы получить дополнительные сведения о каждом из следующих разделов, см. следующую ссылку.

| Уровень | Описание | Метод сбора |
|:---|:---|:---|
| [Клиент Azure](#azure-tenant) | Данные об операциях служб Azure на уровне клиента (например, Azure Active Directory). | Просмотрите данные AAD на портале или настройте коллекцию для Azure Monitor с помощью параметра диагностики клиента. |
| [Подписка Azure.](#azure-subscription) | Данные, относящиеся к работоспособности и управлению перекрестными службами служб в подписке Azure, например диспетчер ресурсов и работоспособность службы. | Просмотрите на портале или настройте коллекцию для Azure Monitor с помощью профиля журнала. |
| [Ресурсы Azure](#azure-resources) |  Данные о работе и производительности каждого ресурса Azure. | Метрики, собранные автоматически, отображаются в обозреватель метрик.<br>Настройте параметры диагностики для сбор журналов в Azure Monitor.<br>Мониторинг решений и аналитических сведений, доступных для более детального мониторинга конкретных типов ресурсов. |

### <a name="azure-other-cloud-or-on-premises"></a>Azure, другое облако или локальная среда 
В следующей таблице кратко описаны уровни приложений, которые могут находиться в Azure, другом облаке или локальной среде. Чтобы получить дополнительные сведения о каждом из следующих разделов, см. следующую ссылку.

| Уровень | Описание | Метод сбора |
|:---|:---|:---|
| [Операционная система (гость)](#operating-system-guest) | Данные об операционной системе для ресурсов вычислений. | Установите агент Log Analytics, чтобы получать источники данных клиента в Azure Monitor и агенте зависимостей для получения зависимостей, поддерживающих Azure Monitor для виртуальных машин.<br>Для виртуальных машин Azure установите расширение диагностики Azure для сбора журналов и метрик в Azure Monitor. |
| [Код приложения](#application-code) | Данные о производительности и функциональности фактического приложения и кода, включая трассировку производительности, журналы приложений и данные телеметрии пользователей. | Инструментируют код, чтобы собираются данные в Application Insights. |
| [Пользовательские источники](#custom-sources) | Данные из внешних служб или других компонентов или устройств. | Собирайте данные журналов или метрик в Azure Monitor из любого клиента RESTFUL. |

## <a name="azure-tenant"></a>Клиент Azure
Данные телеметрии, связанные с клиентом Azure, собираются из служб на уровне клиента, таких как Azure Active Directory.

![Сбор клиентов Azure](media/data-sources/tenant.png)

### <a name="azure-active-directory-audit-logs"></a>Журналы аудита Azure Active Directory
[Отчеты Azure Active Directory](../../active-directory/reports-monitoring/overview-reports.md) включают в себя журнал действий входа и журнал аудита изменений, внесенных в пределах конкретного клиента. 

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журналы Azure Monitor | Настройте сбор журналов Azure AD в Azure Monitor для их анализа с помощью других данных мониторинга. | [Интеграция журналов Azure AD с журналами Azure Monitor (предварительная версия)](../../active-directory/reports-monitoring/howto-integrate-activity-logs-with-log-analytics.md) |
| Служба хранилища Azure | Экспортируйте журналы Azure AD в службу хранилища Azure для архивирования. | [Руководство: архивация журналов Azure AD в учетную запись хранения Azure (предварительная версия)](../../active-directory/reports-monitoring/quickstart-azure-monitor-route-logs-to-storage-account.md) |
| Концентратор событий | Потоковая передача журналов Azure AD в другие расположения с помощью концентраторов событий. | [Учебник. потоковая передача журналов Azure Active Directory в концентратор событий Azure (Предварительная версия)](../../active-directory/reports-monitoring/tutorial-azure-monitor-stream-logs-to-event-hub.md). |



## <a name="azure-subscription"></a>Подписка Azure.
Данные телеметрии, связанные с работоспособностью и эксплуатацией подписки Azure.

![Подписка Azure.](media/data-sources/azure-subscription.png)

### <a name="azure-activity-log"></a>Журнал действий Azure 
[Журнал действий Azure](../platform/platform-logs-overview.md) включает записи о работоспособности службы, а также записи о любых изменениях конфигурации, внесенных в ресурсы в подписке Azure. Журнал действий доступен всем ресурсам Azure и является их _внешним_ представлением.

| Назначение | Описание | Справочник |
|:---|:---|
| Журнал действий | Журнал действий собираются в собственное хранилище данных, которое можно просмотреть в меню Azure Monitor или с помощью команды для создания оповещений журнала действий. | [Запросите журнал действий в портал Azure](./../platform/activity-log.md#view-the-activity-log) |
| Журналы Azure Monitor | Настройте журналы Azure Monitor, чтобы получить журнал действий для анализа с другими данными мониторинга. | [Собирайте и анализируйте журналы действий Azure в Log Analytics рабочей области в Azure Monitor](./../platform/activity-log.md) |
| Служба хранилища Azure | Экспортируйте журнал действий в службу хранилища Azure для архивирования. | [Архивировать журнал действий](./../platform/resource-logs.md#send-to-azure-storage)  |
| Центры событий | Потоковая передача журнала действий в другие расположения с помощью концентраторов событий | [Потоковая передача журнала действий в концентратор событий](./../platform/resource-logs.md#send-to-azure-event-hubs). |

### <a name="azure-service-health"></a>Работоспособность служб Azure
[Работоспособность служб Azure](../../service-health/service-health-overview.md) предоставляет сведения о работоспособности служб Azure в вашей подписке, используемых приложением и ресурсами.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журнал действий<br>Журналы Azure Monitor | Записи о работоспособности службы хранятся в журнале действий Azure, поэтому их можно просмотреть в портал Azure или выполнить другие действия, которые можно выполнить с помощью журнала действий. | [Просмотр уведомлений о работоспособности служб на портале Azure](../../service-health/service-notifications.md) |


## <a name="azure-resources"></a>Ресурсы Azure
Метрики и журналы ресурсов предоставляют сведения о _внутренней_ работе ресурсов Azure. Они доступны для большинства служб Azure, а решения для мониторинга и анализа собираются дополнительные данные для конкретных служб.

![Коллекция ресурсов Azure](media/data-sources/data-source-azure-resources.svg)


### <a name="platform-metrics"></a>Метрики платформы 
Большинство служб Azure будут отсылать [метрики платформы](../platform/data-platform-metrics.md) , отражающие их производительность и работу непосредственно в базе данных метрик. Конкретные [метрики зависят от типа ресурса](../platform/metrics-supported.md). 

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Метрики Azure Monitor | Метрики платформы будут записывать в базу данных метрик Azure Monitor без конфигурации. Доступ к метрикам платформы из обозреватель метрик.  | [Начало работы с обозревателем метрик Azure](../platform/metrics-getting-started.md)<br>[Поддерживаемые метрики с Azure Monitor](../platform/metrics-supported.md) |
| Журналы Azure Monitor | Копирование метрик платформы в журналы для анализа тенденций и других анализов с помощью Log Analytics. | [Направление диагностики Azure в Log Analytics](./../platform/resource-logs.md#send-to-log-analytics-workspace) |
| Центры событий | Потоковая передача метрик в другие расположения с помощью концентраторов событий. |[Потоковая передача данных мониторинга Azure в концентратор событий для потребления внешним инструментом](../platform/stream-monitoring-data-event-hubs.md) |

### <a name="resource-logs"></a>Журналы ресурсов
[Журналы ресурсов](../platform/platform-logs-overview.md) предоставляют подробные сведения о _внутренней_ работе ресурса Azure.  Журналы ресурсов создаются автоматически, но необходимо создать параметр диагностики, чтобы указать назначение для сбора для каждого ресурса.

Требования к конфигурации и содержимое журналов ресурсов зависят от типа ресурса, а не от всех служб, которые их создали. Дополнительные сведения о каждой службе и ссылки на подробные процедуры настройки см. в статье [Поддерживаемые службы, схемы и категории для журналов ресурсов Azure](./../platform/resource-logs-schema.md) . Если служба не указана в этой статье, эта служба сейчас не создает журналы ресурсов.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журналы Azure Monitor | Отправка журналов ресурсов в журналы Azure Monitor для анализа с другими собранными данными журнала. | [Получение журналов ресурсов Azure в Log Analytics рабочей области в Azure Monitor](./../platform/resource-logs.md#send-to-azure-storage) |
| Память | Отправка журналов ресурсов в службу хранилища Azure для архивирования. | [Архивация журналов ресурсов Azure](./../platform/resource-logs.md#send-to-log-analytics-workspace) |
| Центры событий | Потоковая передача журналов ресурсов в другие расположения с помощью концентраторов событий. |[Потоковая передача журналов ресурсов Azure в концентратор событий](./../platform/resource-logs.md#send-to-azure-event-hubs) |

## <a name="operating-system-guest"></a>Операционная система (гость)
Вычислительные ресурсы в Azure, других облаках и локальной среде имеют гостевую операционную систему для мониторинга. При установке одного или нескольких агентов можно собирать данные телеметрии с гостя в Azure Monitor, чтобы анализировать их с помощью тех же средств мониторинга, что и сами службы Azure.

![Коллекция вычислительных ресурсов Azure](media/data-sources/compute-resources.png)

### <a name="azure-diagnostic-extension"></a>Расширение системы диагностики Azure
Включение расширения система диагностики Azure для виртуальных машин Azure позволяет получать журналы и метрики из операционной системы виртуальной машины Azure, включая рабочие роли облачной службы (классическая модель) Azure, виртуальные машины, масштабируемые наборы виртуальных машин и Service Fabric.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Память | Расширение системы диагностики Azure всегда записывает данные в учетную запись хранения Azure. | [Установка и настройка расширения "Диагностика Microsoft Azure" (WAD)](../platform/diagnostics-extension-windows-install.md)<br>[Отслеживание метрик и журналов с помощью расширения диагностики для Linux](../../virtual-machines/extensions/diagnostics-linux.md) |
| Метрики Azure Monitor | При настройке расширения диагностики для сбора счетчиков производительности они записываются в базу данных метрик Azure Monitor. | [Отправка метрик гостевой ОС в хранилище метрик Azure Monitor с помощью шаблона диспетчер ресурсов для виртуальной машины Windows](../platform/collect-custom-metrics-guestos-resource-manager-vm.md) |
| Центры событий | Настройте расширение системы диагностики для потоковой передачи данных в другие расположения с помощью концентраторов событий.  | [Потоковая передача данных система диагностики Azure с помощью концентраторов событий](../platform/diagnostics-extension-stream-event-hubs.md)<br>[Отслеживание метрик и журналов с помощью диагностического расширения Linux](../../virtual-machines/extensions/diagnostics-linux.md) |
| Журналы Application Insights | Собирайте журналы и счетчики производительности из ресурсов вычислений, которые поддерживают приложение для анализа с другими данными приложений. | [Отправка в Application Insights диагностических данных облачной службы, виртуальной машины или Service Fabric](../platform/diagnostics-extension-to-application-insights.md) |


### <a name="log-analytics-agent"></a>Агент Log Analytics 
Установите агент Log Analytics для всестороннего мониторинга и управления виртуальными машинами Windows или Linux. Виртуальная машина может работать в Azure, другом облаке или в локальной среде.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журналы Azure Monitor | Агент Log Analytics подключается к Azure Monitor либо напрямую, либо через System Center Operations Manager и позволяет получать данные из источников данных, настроенных или из решений для мониторинга, которые предоставляют дополнительные сведения о приложениях, работающих на виртуальной машине. | [Источники данных агента в Azure Monitor](../agents/agent-data-sources.md)<br>[Подключение Operations Manager к Azure Monitor](../platform/om-agents.md) |
| Хранилище виртуальных машин | Azure Monitor для виртуальных машин использует агент Log Analytics для хранения сведений о состоянии работоспособности в пользовательском расположении. Этот процесс описан в следующем разделе.  |


### <a name="azure-monitor-for-vms"></a>Azure Monitor для виртуальных машин 
[Azure Monitor для виртуальных машин](../insights/vminsights-overview.md) предоставляет настраиваемый интерфейс мониторинга для виртуальных машин, предоставляющий функции, выходящие за рамки основных Azure Monitor функций. Для этого требуется Dependency Agent на виртуальных машинах Windows и Linux, которые интегрируются с агентом Log Analytics для получения обнаруженных данных о процессах, выполняемых на виртуальной машине и зависимостях внешних процессов.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журналы Azure Monitor | Хранит данные о процессах и зависимостях агента. | [Использование схемы Azure Monitor для виртуальных машин (Предварительная версия) для понимания компонентов приложения](../insights/vminsights-maps.md) |



## <a name="application-code"></a>Код приложения
Подробный мониторинг приложений в Azure Monitor выполняется с [Application Insights](/azure/application-insights/) , который собирает данные из приложений, выполняющихся на различных платформах. Приложение может выполняться в Azure, другом облаке или локальной среде.

![Сбор данных приложения](media/data-sources/applications.png)


### <a name="application-data"></a>Данные приложения
Когда вы включаете службу Application Insights для приложения, установив пакет инструментирования, она собирает метрики и журналы, относящиеся к производительности и операциям приложения. Application Insights хранит собираемые данные в той же Azure Monitor платформе данных, которая используется другими источниками данных. Он содержит обширные средства для анализа этих данных, но их также можно анализировать с помощью данных из других источников, используя такие средства, как обозреватель метрик и Log Analytics.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журналы Azure Monitor | Операционные данные о приложении, включая Просмотры страниц, запросы приложений, исключения и трассировки. | [Анализ данных журнала в Azure Monitor](../log-query/log-query-overview.md) |
|                    | Сведения о зависимостях между компонентами приложения для поддержки корреляции приложения и телеметрии. | [Корреляция данных телеметрии в Application Insights](../app/correlation.md) <br> [Схема сопоставления приложений](../app/app-map.md) |
|            | Результаты проверок доступности, которые проверяют доступность и скорость реагирования приложения из различных расположений в общедоступном Интернете. | [Мониторинг доступности и скорости реагирования любого веб-сайта](../app/monitor-web-app-availability.md) |
| Метрики Azure Monitor | Application Insights собирает метрики, описывающие производительность и работу приложения, а также пользовательские метрики, определенные в приложении в базе данных метрик Azure Monitor. | [Метрики на основе журналов и предварительно агрегированные метрики в Application Insights](../app/pre-aggregated-metrics-log-metrics.md)<br>[API Application Insights для настраиваемых событий и метрик](../app/api-custom-events-metrics.md) |
| Служба хранилища Azure | Отправка данных приложения в службу хранилища Azure для архивирования. | [Экспорт данных телеметрии из Application Insights](../app/export-telemetry.md) |
|            | Сведения о тестах доступности хранятся в службе хранилища Azure. Используйте Application Insights в портал Azure, чтобы скачать для локального анализа. Результаты тестов доступности хранятся в журналах Azure Monitor. | [Мониторинг доступности и скорости реагирования любого веб-сайта](../app/monitor-web-app-availability.md) |
|            | Данные трассировки профилировщика хранятся в службе хранилища Azure. Используйте Application Insights в портал Azure, чтобы скачать для локального анализа.  | [Профилирование приложений в рабочей среде Azure с помощью Application Insights Profiler](../app/profiler-overview.md) 
|            | Отладочные данные моментальных снимков, захваченные для подмножества исключений, хранятся в службе хранилища Azure. Используйте Application Insights в портал Azure, чтобы скачать для локального анализа.  | [Как работают моментальные снимки](../app/snapshot-debugger.md#how-snapshots-work) |

## <a name="monitoring-solutions-and-insights"></a>Мониторинг решений и аналитических сведений
[Решения мониторинга](../insights/solutions.md) и [аналитические](../monitor-reference.md) данные собираются для получения дополнительных сведений о работе определенной службы или приложения. Они могут обращаться к ресурсам на разных уровнях приложений и даже на нескольких уровнях.

### <a name="monitoring-solutions"></a>Решения для мониторинга

| Назначение | Описание | Справочник
|:---|:---|:---|
| Журналы Azure Monitor | Решения мониторинга собираются данные в журналы Azure Monitor, где их можно анализировать с помощью языка запросов или [представлений](../platform/view-designer.md) , которые обычно включаются в решение. | [Сведения о сборе данных для решений мониторинга в Azure](../monitor-reference.md) |


### <a name="azure-monitor-for-containers"></a>Azure Monitor для контейнеров
[Azure Monitor для контейнеров](../insights/container-insights-overview.md) предоставляет настраиваемый интерфейс мониторинга для [службы Azure Kubernetes (AKS)](../../aks/index.yml). Он собирает дополнительные данные об этих ресурсах, описанные в следующей таблице.

| Назначение | Описание | Справочник |
|:---|:---|:---|
| Журналы Azure Monitor | Хранит данные мониторинга для AKS, включая инвентаризацию, журналы и события. Данные метрик также хранятся в журналах, чтобы использовать функции анализа на портале. | [Общие сведения о производительности кластера AKS с Azure Monitor для контейнеров](../insights/container-insights-analyze.md) |
| Метрики Azure Monitor | Данные метрик хранятся в базе данных метрики для управления визуализацией и оповещениями. | [Просмотр метрик контейнера в обозревателе метрик](../insights/container-insights-analyze.md#view-container-metrics-in-metrics-explorer) |
| Служба Azure Kubernetes | Предоставляет прямой доступ к журналам контейнеров Azure Kubernetes Service (stdout/stderr), событиям и метрикам Pod на портале. | [Просмотр журналов Kubernetes, событий и метрик Pod в режиме реального времени ](../insights/container-insights-livedata-overview.md) |

### <a name="azure-monitor-for-vms"></a>Azure Monitor для виртуальных машин
[Azure Monitor для виртуальных машин](../insights/vminsights-overview.md) предоставляет настраиваемый интерфейс для мониторинга виртуальных машин. Описание данных, собранных Azure Monitor для виртуальных машин, содержится в разделе об [операционной системе (Guest)](#operating-system-guest) выше.

## <a name="custom-sources"></a>Пользовательские источники
В дополнение к стандартным уровням приложения вам может потребоваться отслеживать другие ресурсы, имеющие данные телеметрии, которые невозможно собрать через другие источники данных. Для этих ресурсов запишите эти данные в метрики или журналы с помощью Azure Monitor API.

![Пользовательская коллекция](media/data-sources/custom.png)

| Назначение | Метод | Описание | Справочник |
|:---|:---|:---|:---|
| Журналы Azure Monitor | API сборщика данных | Собирайте данные журналов из любого клиента и хранилища в Log Analytics рабочей области. | [Отправка данных журналов в Azure Monitor c помощью API сборщика данных HTTP (общедоступная предварительная версия)](../platform/data-collector-api.md) |
| Метрики Azure Monitor | Пользовательский API метрик | Собирайте данные метрик из любого клиента RESTFUL и храните их в базе данных метрик Azure Monitor. | [Отправка пользовательских метрик для ресурса Azure в хранилище метрик Azure Monitor с использованием REST API](../platform/metrics-store-custom-rest-api.md) |


## <a name="other-services"></a>Другие службы
Другие службы в Azure записывают данные на платформу данных Azure Monitor. Это позволяет анализировать данные, собранные этими службами, с данными, собранными Azure Monitor, и использовать те же средства анализа и визуализации.

| Служба | Назначение | Описание | Справочник |
|:---|:---|:---|:---|
| [Центр безопасности Azure](../../security-center/index.yml) | Журналы Azure Monitor | Центр безопасности Azure хранит данные безопасности, собираемые в Log Analytics рабочей области, которая позволяет анализировать данные журналов, собираемых Azure Monitor.  | [Сбор данных в центре безопасности Azure](../../security-center/security-center-enable-data-collection.md) |
| [Azure Sentinel](../../sentinel/index.yml) | Журналы Azure Monitor | Azure Sentinel сохраняет собранные данные из разных источников данных в Log Analytics рабочей области, что позволяет анализировать данные журналов, собираемых Azure Monitor.  | [Подключение источников данных](../../sentinel/quickstart-onboard.md) |


## <a name="next-steps"></a>Дальнейшие шаги

- Дополнительные сведения о типах данных мониторинга, собранных Azure Monitor, и о том, как просматривать и анализировать эти данные, см. в статье [Сбор данных мониторинга в Azure](../platform/data-platform.md).
- Список [различных расположений, в которых ресурсы Azure хранят данные](../monitor-reference.md) и способ доступа к ним.