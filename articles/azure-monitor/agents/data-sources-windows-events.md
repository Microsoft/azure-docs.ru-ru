---
title: Получение источников данных журнала событий Windows с помощью агента Log Analytics в Azure Monitor
description: Описывается, как с помощью Azure Monitor настроить сбор журналов событий Windows и сведений о создаваемых ими записях.
ms.subservice: logs
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 10/21/2020
ms.openlocfilehash: b747a4b58c9c460178d415d0b45ade814723d8fe
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101719871"
---
# <a name="collect-windows-event-log-data-sources-with-log-analytics-agent"></a>Получение источников данных журнала событий Windows с помощью агента Log Analytics
Журналы событий Windows — это один из наиболее распространенных [источников данных](../agents/agent-data-sources.md) для агентов log Analytics на виртуальных машинах Windows, так как многие приложения записывают в журнал событий Windows.  События можно собирать из стандартных журналов, таких как журналы системы и приложений, а также указывать пользовательские журналы приложений, которые необходимо отслеживать.

> [!IMPORTANT]
> В этой статье рассматривается сбор событий Windows с помощью [агента log Analytics](./log-analytics-agent.md) , который является одним из агентов, используемых Azure Monitor. Другие агенты собираются разные данные и настраиваются по-разному. Список доступных агентов и данных, которые они могут собираются, см. в разделе [Обзор агентов Azure Monitor](../agents/agents-overview.md) .

![События Windows](media/data-sources-windows-events/overview.png)     

## <a name="configuring-windows-event-logs"></a>Настройка журналов событий Windows
Настройте журналы событий Windows [в меню данные в дополнительных параметрах](../agents/agent-data-sources.md#configuring-data-sources) для рабочей области log Analytics.

Azure Monitor собирает события только из журналов событий Windows, указанных в параметрах.  Чтобы добавить журнал событий, введите имя журнала и нажмите кнопку **+** .  Из каждого журнала собираются только события с заданной степенью серьезности.  Укажите степени серьезности событий, которые хотите получать из соответствующего журнала.  Дополнительные критерии для фильтрации событий задавать нельзя.

При вводе имени служба Azure Monitor предоставляет варианты распространенных имен журналов событий. Если журнал, который нужно добавить, не отображается в списке, вы по-прежнему можете его добавить, введя его полное имя. Полное имя журнала можно просмотреть с помощью средства просмотра событий. Для этого в средстве просмотра событий откройте страницу *Свойства* журнала и скопируйте строку в поле *Полное имя*.

![Настройка событий Windows](media/data-sources-windows-events/configure.png)

> [!NOTE]
> Критические события из журнала событий Windows будут иметь серьезность "ошибка" в журналах Azure Monitor.

## <a name="data-collection"></a>Сбор данных
По мере создания событий служба Azure Monitor собирает из отслеживаемого журнала событий все события, соответствующие заданной степени серьезности.  Агент фиксирует место сбора в каждом журнале событий, который используется для сбора данных.  Если агент на некоторое время переходит в автономный режим, Azure Monitor собирает события, начиная с места остановки, даже если эти события были созданы, пока агент был отключен.  Существует вероятность, что эти события не будут собраны, если оболочки журнала событий с несобранными событиями будут перезаписаны, пока агент находится вне сети.

>[!NOTE]
>Azure Monitor не собирает события аудита, созданные SQL Server, из источника *MSSQLSERVER* с идентификатором события 18453, которые содержат ключевые слова *Classic* или *Audit Success* и ключевое слово *0xa0000000000000*.
>

## <a name="windows-event-records-properties"></a>Свойства записей о событиях Windows
Записи о событиях Windows имеют тип **Событие** и свойства, описанные в приведенной ниже таблице.

| Свойство | Описание |
|:--- |:--- |
| Компьютер |Имя компьютера, с которого было получено событие. |
| EventCategory |Категория события. |
| EventData |Все данные событий в формате RAW. |
| EventID |Номер события. |
| EventLevel |Степень серьезности события в числовом формате. |
| EventLevelName |Степень серьезности события в текстовом формате. |
| EventLog |Имя журнала событий, из которого было получено событие. |
| ParameterXml |Значения параметров события в формате XML. |
| ManagementGroupName |Имя группы управления для агентов System Center Operations Manager.  Для других агентов это значение равно `AOI-<workspace ID>` |
| RenderedDescription |Описание события со значениями параметров. |
| Источник |Источник события. |
| SourceSystem |Тип агента, из которого было получено событие. <br> OpsManager — агент Windows, подключенный напрямую или управляемый с помощью Operations Manager. <br> Linux — все агенты Linux  <br>  AzureStorage – диагностика Azure |
| TimeGenerated |Дата и время создания события в Windows. |
| UserName |Имя пользователя учетной записи, который зафиксировал событие. |

## <a name="log-queries-with-windows-events"></a>Запросы журнала для получения событий Windows
Ниже приведены различные примеры запросов журнала, которые извлекают записи о событиях Windows.

| Запрос | Описание |
|:---|:---|
| Событие |Все события Windows. |
| Event &#124; where EventLevelName == "error" |Все события Windows с указанием серьезности ошибки. |
| Event &#124; summarize count() by Source |Число событий Windows по источникам. |
| Event &#124; where EventLevelName == "error" &#124; summarize count() by Source |Число событий ошибок Windows по источникам. |


## <a name="next-steps"></a>Дальнейшие действия
* Настройте службу Log Analytics для сбора других [источников данных](../agents/agent-data-sources.md) для анализа.
* Узнайте больше о [запросах журнала](../logs/log-query-overview.md), которые можно применять для анализа данных, собираемых из источников данных и решений.  
* Настройте [коллекцию счетчиков производительности](data-sources-performance-counters.md) из агентов Windows.