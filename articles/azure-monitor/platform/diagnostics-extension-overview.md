---
title: Обзор расширения "Диагностика Azure"
description: Диагностику Azure можно использовать для отладки, оценки производительности, мониторинга, а также анализа трафика в облачных службах, на виртуальных машинах и в Service Fabric.
ms.subservice: diagnostic-extension
ms.topic: conceptual
author: bwren
ms.author: bwren
ms.date: 02/14/2020
ms.openlocfilehash: 4d424a22a26119dcb3ef6a0e5c4f3dc0c13b1aa4
ms.sourcegitcommit: 2f9f306fa5224595fa5f8ec6af498a0df4de08a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "98927587"
---
# <a name="azure-diagnostics-extension-overview"></a>Обзор расширения "Диагностика Azure"
Расширение "Диагностика Azure" — это [агент в Azure Monitor](agents-overview.md), собирающий данные мониторинга из гостевой операционной системы на вычислительных ресурсах Azure, включая виртуальные машины. В этой статье представлен обзор расширения "Диагностика Azure", в том числе его специальных функциональных возможностей и параметров установки и настройки. 

> [!NOTE]
> Расширение "Диагностика Azure" — это один из агентов, доступных для сбора данных мониторинга из гостевой операционной системы, обслуживающей вычислительные ресурсы. В статье [Общие сведения об агентах Azure Monitor](agents-overview.md) вы найдете описание разных агентов и рекомендации по выбору правильного варианта для конкретных требований.

## <a name="primary-scenarios"></a>Основные сценарии
Основные сценарии для применения расширения диагностики:

- Сбор метрик гостевой ОС в метрики Azure Monitor.
- Отправка журналов и метрик гостевой ОС в службу хранилища Azure для длительного хранения.
- Отправка журналов и метрик гостевой ОС в концентраторы событий Azure для отправки за пределы Azure.


## <a name="comparison-to-log-analytics-agent"></a>Сравнение с агентом Log Analytics
Для получения данных мониторинга из гостевой операционной системы виртуальных машин может также использоваться агент Log Analytics в Azure Monitor. Вы можете использовать любое из этих средств или оба сразу в зависимости от конкретных требований. В статье [Общие сведения об агентах Azure Monitor](agents-overview.md) приведено подробное сравнение разных агентов. 

Основные различия:

- Расширение "Диагностика Azure" может работать только с виртуальными машинами Azure. Агент Log Analytics совместим с виртуальными машинами в Azure, других облачных и локальной среде.
- Расширение "Диагностика Azure" отправляет данные в службу хранилища Azure, в [метрики мониторинга Azure](data-platform-metrics.md) (только для ОС Windows) и в Центры событий. Агент Log Analytics собирает данные в [журналы Azure Monitor](data-platform-logs.md).
- Агент Log Analytics является обязательным компонентом [решений](../monitor-reference.md#insights-and-core-solutions), [Azure Monitor для виртуальных машин](../insights/vminsights-overview.md) и других служб, например [Центра безопасности Azure](../../security-center/index.yml).

## <a name="costs"></a>Затраты
Плата за расширение "Диагностика Azure" не взимается, но, возможно, вам придется оплатить получение данных. На странице [Цены на Azure Monitor](https://azure.microsoft.com/pricing/details/monitor/) указаны назначения для сбора данных.

## <a name="data-collected"></a>Собираемые данные
В следующих таблицах перечислены данные, которые можно собирать с помощью расширения системы диагностики для Windows и Linux.

### <a name="windows-diagnostics-extension-wad"></a>Расширение диагностики для Windows (WAD)

| Источник данных | Описание |
| --- | --- |
| Журналы событий Windows   | События из журналов событий Windows. |
| Счетчики производительности | Числовые значения, представляющие собой оценки производительности разных элементов операционной системы и рабочих нагрузок. |
| Журналы IIS             | Информация о потреблении для веб-сайтов на IIS, которые выполняются в гостевой ОС. |
| Журналы приложений     | Сообщения трассировки, записанные вашим приложением. |
| Журналы .NET EventSource |События записи кода с использованием класса .NET [EventSource](/dotnet/api/system.diagnostics.tracing.eventsource) |
| [Журналы трассировки событий Windows на основе манифеста](/windows/desktop/etw/about-event-tracing) |События трассировки событий Windows, созданные любым процессом. |
| Аварийные дампы (журналы)   | Информация о состоянии процесса, собираемая при сбое приложения. |
| Файловые журналы    | Журналы, созданные вашим приложением или службой. |
| Журналы диагностики агента | Информация о самой службе "Диагностика Azure". |


### <a name="linux-diagnostics-extension-lad"></a>Расширение диагностики для Linux (LAD)

| Источник данных | Описание |
| --- | --- |
| Системный журнал | События, отправляемые в систему ведения журналов событий Linux.   |
| Счетчики производительности  | Числовые значения, представляющие собой оценки производительности разных элементов операционной системы и рабочих нагрузок. |
| Файлы журналов | Записи, отправляемые в файловый журнал.  |

## <a name="data-destinations"></a>Целевое расположение данных
Расширение "Диагностика Azure" для Windows и Linux всегда собирает данные в учетную запись хранения Azure. Список конкретных таблиц и больших двоичных объектов для сбора этих данных приводится в статьях [Установка и настройка расширения "Диагностика Microsoft Azure" (WAD)](diagnostics-extension-windows-install.md) и [Отслеживание метрик и журналов с помощью расширения диагностики для Linux](../../virtual-machines/extensions/diagnostics-linux.md).

Настройте один или несколько *приемников данных* для отправки данных в другие дополнительные назначения. В следующих разделах приведены все приемники, доступные для расширения системы диагностики для Windows и Linux.

### <a name="windows-diagnostics-extension-wad"></a>Расширение диагностики для Windows (WAD)

| Назначение | Описание |
|:---|:---|
| Метрики Azure Monitor | Сбор данных о производительности в метрики Azure Monitor. Подробнее см. в статье [Отправка метрик гостевой ОС в хранилище метрик Azure Monitor с помощью шаблона Azure Resource Manager для виртуальной машины Windows](collect-custom-metrics-guestos-resource-manager-vm.md).  |
| Центры событий | Центры событий Azure применяются для отправки данных за пределы Azure. Подробные сведения см. в статье [Потоковая передача данных Диагностики Azure в Центры событий](diagnostics-extension-stream-event-hubs.md). |
| Большие двоичные объекты службы хранилища Azure | Запись данных в большие двоичные объекты в службе хранилища Azure в дополнение к таблицам. |
| Application Insights | Сбор данных из приложений, выполняющихся на виртуальной машине, в Application Insights для интеграции с другими средствами мониторинга приложений. Дополнительные сведения см. в статье [Отправка в Application Insights диагностических данных](diagnostics-extension-to-application-insights.md). |

Вы также можете переносить данные WAD из хранилища в рабочую область Log Analytics, чтобы анализировать их с помощью журналов Azure Monitor, хотя для этой возможности обычно используется агент Log Analytics. Он умеет передавать данные сразу в рабочую область Log Analytics и поддерживает решения и аналитические инструменты, которые предоставляют дополнительные функциональные возможности.  Дополнительные сведения см. в статье [Сбор журналов диагностики Azure из службы хранилища Azure](diagnostics-extension-logs.md). 


### <a name="linux-diagnostics-extension-lad"></a>Расширение диагностики для Linux (LAD)
Расширение LAD записывает данные в таблицы в службе хранилища Azure. Оно поддерживает приемники, перечисленные в следующей таблице.

| Назначение | Описание |
|:---|:---|
| Центры событий | Центры событий Azure применяются для отправки данных за пределы Azure. |
| Большие двоичные объекты службы хранилища Azure | Запись данных в большие двоичные объекты в службе хранилища Azure в дополнение к таблицам. |
| Метрики Azure Monitor | Установите агент Telegraf в дополнение к LAD. Дополнительные сведения см. в статье [Сбор пользовательских метрик для виртуальной машины Linux с помощью агента Telegraf InfluxData](collect-custom-metrics-linux-telegraf.md).


## <a name="installation-and-configuration"></a>Установка и настройка
Расширение диагностики реализовано как [расширение виртуальной машины](../../virtual-machines/extensions/overview.md) в Azure, поэтому оно поддерживает все стандартные варианты установки с помощью шаблонов Resource Manager, PowerShell и CLI. Общие сведения об установке и обслуживании расширений виртуальной машины см. в статьях [Расширения и функции виртуальных машин для Windows](../../virtual-machines/extensions/features-windows.md) и [Расширения и функции виртуальных машин для Linux](../../virtual-machines/extensions/features-linux.md).

Вы также можете установить и настроить расширения системы диагностики для Windows и Linux на портале Azure, открыв область **Параметры диагностики** в разделе **Мониторинг** для соответствующей виртуальной машины.

Дополнительные сведения об установке и настройке расширения системы диагностики для Windows и Linux см. в следующих статьях.

- [Установка и настройка расширения "Диагностика Microsoft Azure" (WAD)](diagnostics-extension-windows-install.md)
- [Отслеживание метрик и журналов с помощью расширения диагностики для Linux](../../virtual-machines/extensions/diagnostics-linux.md)

## <a name="other-documentation"></a>Другая документация

###  <a name="azure-cloud-service-classic-web-and-worker-roles"></a>Рабочие и веб-роли для облачной службы Azure (классической)
- [Введение в мониторинг облачных служб](../../cloud-services/cloud-services-how-to-monitor.md)
- [Включение Диагностики Azure в облачных службах Azure](../../cloud-services/cloud-services-dotnet-diagnostics.md)
- [Использование Application Insights для облачных служб Azure](../app/cloudservices.md)<br>[Трассировка потока в приложении облачных служб с помощью системы диагностики Azure](../../cloud-services/cloud-services-dotnet-diagnostics-trace-flow.md) 

### <a name="azure-service-fabric"></a>Azure Service Fabric
- [Мониторинг и диагностика состояния служб в локальной среде разработки](../../service-fabric/service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

## <a name="next-steps"></a>Дальнейшие действия


* Узнайте, как [использовать счетчики производительности в Диагностике Azure](../../cloud-services/diagnostics-performance-counters.md).
* Если возникнут проблемы с запуском диагностики или поиском данных в таблицах хранилища Azure, см. статью [Устранение неполадок с помощью системы диагностики Azure](diagnostics-extension-troubleshooting.md).
