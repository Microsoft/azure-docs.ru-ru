---
title: Azure Monitor визуализаций на диаграмме книги
description: Сведения о всех Azure Monitorных визуализациях диаграммы.
services: azure-monitor
author: lgayhardt
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.topic: conceptual
ms.date: 09/04/2020
ms.author: lagayhar
ms.openlocfilehash: 139c8cdb1a227595d728d2acc0b09cf1eb210715
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100624597"
---
# <a name="chart-visualizations"></a>Визуализации диаграмм

Книги позволяют представлять данные мониторинга как диаграммы. Поддерживаются следующие типы диаграмм: линейная, линейчатая, линейчатая, диаграмма с областями, круговые диаграммы и время. Авторы могут настраивать высоту, ширину, цветовую палитру, условные обозначения, заголовки, сообщения без данных и т. д. диаграммы, а также настраивать типы осей и цвета рядов с помощью параметров диаграммы.

Книги поддерживают диаграммы как для журналов, так и для источников данных метрик.

## <a name="log-charts"></a>Диаграммы журналов

Azure Monitor журналы предоставляют владельцам ресурсов подробные сведения о работе своих приложений и инфраструктуры. В отличие от метрик, данные журнала не собираются по умолчанию и требуют некоторых видов сбора. Однако, если существующие журналы содержат много сведений о состоянии ресурса и данных, полезных для диагностики. Книги позволяют представлять данные журнала в виде визуальных диаграмм для анализа пользователей.

### <a name="adding-a-log-chart"></a>Добавление диаграммы журнала

В приведенном ниже примере показана тенденция запросов к приложению за предыдущие дни.

1. Переключите книгу в режим редактирования, выбрав пункт **изменить** панель инструментов.
2. Используйте ссылку **Добавить запрос** , чтобы добавить в книгу элемент управления "запрос журнала".
3. Выберите тип запроса в поле **Журнал**, тип ресурса (например, Application Insights) и ресурсы для целевого объекта.
4. Используйте редактор запросов, чтобы ввести [ККЛ](/azure/kusto/query/) для анализа (например, тренд запросов).
5. Задайте для визуализации одну из следующих категорий **: площадь**, **линейчатая**, **линейчатая (категория)**, **линия**, **круг**, **точечная диаграмма** или **время**.
6. Задайте другие параметры, если это необходимо, например диапазон времени, визуализация, размер, палитра цветов и условные обозначения.

[![Снимок экрана: диаграмма журнала в режиме редактирования](./media/workbooks-chart-visualizations/log-chart.png)](./media/workbooks-chart-visualizations/log-chart.png#lightbox)

### <a name="log-chart-parameters"></a>Параметры диаграммы журнала

| Параметр | Объяснение | Пример |
| ------------- |:-------------|:-------------|
| `Query Type` | Тип используемого запроса. | Журнал, граф ресурсов Azure и т. д. |
| `Resource Type` | Целевой тип ресурса. | Application Insights, Log Analytics или Azure — First |
| `Resources` | Набор ресурсов, из которого нужно получить значение метрик. | MyApp1 |
| `Time Range` | Окно времени для просмотра диаграммы журнала. | Последний час, последние 24 часа и т. д. |
| `Visualization` | Используемая визуализация. | Площадь, линейчатая, линейная, круговая, точечная, временная, линейчатая, Категория |
| `Size` | Вертикальный размер элемента управления. | Малый, средний, крупный или полный |
| `Color palette` | Цветовая палитра, используемая в диаграмме. Игнорируется в многометриком или сегментированном режиме. | Синий, зеленый, красный и т. д. |
| `Legend` | Статистическая функция, используемая для условных обозначений. | Sum или Average значений или Max, min, First, Последнее значение |
| `Query` | Любой запрос ККЛ, возвращающий данные в формате, ожидаемом визуализацией диаграммы. | _запрос \| на создание серии запросов = Count () по умолчанию = 0 по метке времени от назад (1d) до Now () шаг 1 ч_ |

### <a name="time-series-charts"></a>Диаграммы временных рядов

Диаграммы временных рядов, такие как область, линейчатая диаграмма, график и время, можно легко создать с помощью элемента управления запросом в книгах. У ключа есть сведения о времени и метриках в результирующем наборе.

#### <a name="simple-time-series"></a>Простой временной ряд

Приведенный ниже запрос возвращает таблицу с двумя столбцами: *timestamp* и *Requests*. Элемент управления запросом использует *отметку времени* для оси X и *запросы* по оси Y.

```kusto
requests
| summarize Requests = count() by bin(timestamp, 1h)
```

[![Снимок экрана с простой графикой журнала временных рядов.](./media/workbooks-chart-visualizations/log-chart-line-simple.png)](./media/workbooks-chart-visualizations/log-chart-line-simple.png#lightbox)

#### <a name="time-series-with-multiple-metrics"></a>Временные ряды с несколькими метриками

Приведенный ниже запрос возвращает таблицу с тремя столбцами: *timestamp*, *Requests* и *Users*. Элемент управления запросом использует *отметку времени* для оси X и *запрашивает*  &  *пользователей* в качестве отдельных рядов на оси Y.

```kusto
requests
| summarize Requests = count(), Users = dcount(user_Id) by bin(timestamp, 1h)
```

[![Снимок экрана с графиком временных рядов с несколькими метриками.](./media/workbooks-chart-visualizations/log-chart-line-multi-metric.png)](./media/workbooks-chart-visualizations/log-chart-line-multi-metric.png#lightbox)

#### <a name="segmented-time-series"></a>Сегментированная временная серия

Приведенный ниже запрос возвращает таблицу с тремя столбцами: *timestamp*, *Requests* и *рекуестнаме* , где *рекуестнаме* — это столбец категорий с именами запросов. Элемент управления "запрос" использует *отметку времени* для оси X и добавляет ряд на значение *рекуестнаме*.

```
requests
| summarize Request = count() by bin(timestamp, 1h), RequestName = name
```

[![Снимок экрана с сегментированной строкой журнала временных рядов.](./media/workbooks-chart-visualizations/log-chart-line-segmented.png)](./media/workbooks-chart-visualizations/log-chart-line-segmented.png#lightbox)

### <a name="summarize-vs-make-series"></a>Суммирование и создание серии

В примерах, приведенных в предыдущем разделе, используется `summarize` оператор, так как его легче понять. Однако итоговые данные имеют серьезные ограничения, так как при отсутствии элементов в контейнере не будет строки результатов. Это может привести к смещению временного окна диаграммы в зависимости от того, находятся ли пустые контейнеры в передней или задней части диапазона времени.

Обычно лучше использовать `make-series` оператор для создания данных временных рядов, который имеет параметр для предоставления значений по умолчанию для пустых контейнеров.

В следующем запросе используется `make-series` оператор.

```kusto
requests
| make-series Requests = count() default = 0 on timestamp from ago(1d) to now() step 1h by RequestName = name
```

В следующем запросе показана похожая диаграмма с `summarize` оператором

```kusto
requests
| summarize Request = count() by bin(timestamp, 1h), RequestName = name
```

Несмотря на то, что базовый результирующий набор отличается. Все, что пользователь должен сделать, — это задать для визуализации область, график, гистограмму или время и книги, которые позаботится о остальном.

[![Снимок экрана с графиком, созданным из запроса на создание серии](./media/workbooks-chart-visualizations/log-chart-line-make-series.png)](./media/workbooks-chart-visualizations/log-chart-line-make-series.png#lightbox)

### <a name="categorical-bar-chart-or-histogram"></a>Линейчатая диаграмма по категориям или Гистограмма

Диаграммы категорий позволяют пользователям представлять измерение или столбец на оси X диаграммы. Это особенно удобно в гистограммах. В приведенном ниже примере показано распределение запросов по коду результата.

```kusto
requests
| summarize Requests = count() by Result = strcat('Http ', resultCode)
| order by Requests desc
```

Запрос возвращает два столбца: метрика *запросов* и категория *результата* . Каждое значение *результирующего* столбца получит собственную полосу в диаграмме с высотой, пропорциональной *метрике запросов*.

[![Снимок экрана: линейчатая диаграмма по категориям для запросов по коду результата](./media/workbooks-chart-visualizations/log-chart-categorical-bar.png)](./media/workbooks-chart-visualizations/log-chart-categorical-bar.png#lightbox)

### <a name="pie-charts"></a>Круговые диаграммы

Круговые диаграммы позволяют визуализировать числовую пропорцию. В приведенном ниже примере показана пропорция запросов по коду результата.

```kusto
requests
| summarize Requests = count() by Result = strcat('Http ', resultCode)
| order by Requests desc
```

Запрос возвращает два столбца: метрика *запросов* и категория *результата* . Каждое значение *результирующего* столбца получит свой собственный срез в круге с размером, пропорциональным метрике *запросов* .

[![Снимок экрана круговой диаграммы с срезами, представляющими код результата](./media/workbooks-chart-visualizations/log-chart-pie-chart.png)](./media/workbooks-chart-visualizations/log-chart-pie-chart.png#lightbox)

## <a name="metric-charts"></a>Диаграммы метрик

Большинство ресурсов Azure выдает метрики по состоянию и работоспособности (например, использование ЦП, доступность хранилища, количество транзакций базы данных, сбои запросов приложений и т. д.). Книги позволяют визуализировать эти данные как диаграммы временных рядов.)

### <a name="adding-a-metric-chart"></a>Добавление диаграммы метрик

В следующем примере показано количество транзакций в учетной записи хранения за прошлый час. Это позволяет владельцу хранилища видеть тренд транзакции и находить аномалии в поведении.

1. Переключите книгу в режим редактирования, выбрав пункт **изменить** панель инструментов.
2. Используйте ссылку **Добавить метрику** , чтобы добавить в книгу элемент управления метрикой.
3. Выберите тип ресурса (например, учетная запись хранения), целевые ресурсы, пространство имен и имя метрики, а также используемое статистическое выражение.
4. Задайте другие параметры, если это необходимо, например диапазон времени, разделение на, визуализация, размер и цветовая палитра.

[![Снимок экрана: диаграмма метрик в режиме редактирования](./media/workbooks-chart-visualizations/metric-chart.png)](./media/workbooks-chart-visualizations/metric-chart.png#lightbox)

### <a name="metric-chart-parameters"></a>Параметры диаграммы метрик

| Параметр | Объяснение | Пример |
| ------------- |:-------------|:-------------|
| `Resource Type` | Целевой тип ресурса. | Хранилище или виртуальная машина. |
| `Resources` | Набор ресурсов, из которого нужно получить значение метрик. | MyStorage1 |
| `Namespace` | Пространство имен с метрикой. | Хранилище BLOB-объектов > |
| `Metric` | Метрика для визуализации. | > хранилища BLOB-объектов > транзакций |
| `Aggregation` | Статистическая функция, применяемая к метрике. | Сумма, количество, среднее и т. д. |
| `Time Range` | Временное окно для просмотра метрики. | Последний час, последние 24 часа и т. д. |
| `Visualization` | Используемая визуализация. | Площадь, линейчатая, линейная, точечная, сетка |
| `Split By` | При необходимости разделите метрику на измерении. | Транзакции по типу Geo |
| `Size` | Вертикальный размер элемента управления. | Малый, средний или крупный |
| `Color palette` | Цветовая палитра, используемая в диаграмме. Игнорируется, если `Split by` используется параметр. | Синий, зеленый, красный и т. д. |

### <a name="examples"></a>Примеры

Транзакции, разделенные по имени API, как график:

[![Снимок экрана метрики графика для транзакций хранилища, разделенных по имени API](./media/workbooks-chart-visualizations/metric-chart-storage-split-line.png)](./media/workbooks-chart-visualizations/metric-chart-storage-split-line.png#lightbox)

Транзакции, разделенные по типу ответа, в виде большой линейчатой диаграммы:

[![Снимок экрана: линейчатая диаграмма с большой метрикой для транзакций хранилища, разделенных по типу ответа](./media/workbooks-chart-visualizations/metric-chart-storage-bar-large.png)](./media/workbooks-chart-visualizations/metric-chart-storage-bar-large.png#lightbox)

Средняя задержка в виде точечной диаграммы:

[![Снимок экрана метрики точечной диаграммы для задержки хранилища](./media/workbooks-chart-visualizations/metric-chart-storage-scatter.png)](./media/workbooks-chart-visualizations/metric-chart-storage-scatter.png#lightbox)

## <a name="chart-settings"></a>Параметры диаграммы

Авторы могут использовать параметры диаграммы для настройки полей, используемых в осях диаграммы, единиц оси, пользовательского форматирования, диапазонов, поведений группирования, условных обозначений и цветов ряда.

### <a name="the-settings-tab"></a>Вкладка "SETTINGS" (Параметры)

Вкладка Параметры управляет:

- Параметры оси, включая поля, настраиваемое форматирование, которое позволяет пользователям задать форматирование чисел для значений осей и настраиваемых диапазонов.
- Параметры группировки, включая поле, пределы до создания группы "другие".
- Параметры условных обозначений, включая отображение метрик (имя ряда, цвета и числа) в нижней части и (или) условные обозначения (имена и цвета рядов).

![Снимок экрана параметров диаграммы.](./media/workbooks-chart-visualizations/chart-settings.png)

#### <a name="custom-formatting"></a>Пользовательское форматирование

Параметры форматирования чисел включают:

| Параметр форматирования             | Пояснение                                                                                           |
|:---------------------------- |:-------------------------------------------------------------------------------------------------------|
| `Units`                      | Единицы измерения для столбца — различные параметры для процентного соотношения, количества, времени, байта, количества/времени, байтов, времени и т. д. Например, единица измерения для значения 1234 может быть равна миллисекундам и отображена как 1,234 s.                                  |
| `Style`                      | Формат для отображения в виде десятичного, денежного, процентного формата.                                               |
| `Show group separator`       | Флажок для отображения разделителей групп. Отображает 1234 как 1 234 в США.                                    |
| `Minimum integer digits`     | Минимальное число используемых целочисленных цифр (по умолчанию 1).                                                   |
| `Minimum fractional digits`  | Минимальное число знаков дробной части для использования (по умолчанию 0).                                                |
| `Maximum fractional digits`  | Максимальное используемое число цифр дробной части.                                                            |
| `Minimum significant digits` | Минимальное используемое количество значащих цифр (по умолчанию 1).                                               |
| `Maximum significant digits` | Максимальное количество значащих цифр, которое следует использовать.                                                           |

![Снимок экрана параметров оси X.](./media/workbooks-chart-visualizations/number-format-settings.png)

### <a name="the-series-tab"></a>Вкладка «ряды»

Вкладка Настройка ряда позволяет настроить метки и цвета, показанные для ряда на диаграмме.

- `Series name`Поле используется для сопоставления ряда данных и, если они совпадают, отображается отображаемая метка и цвет.
- Это `Comment` поле полезно для авторов шаблонов, так как этот комментарий может использоваться переводчиками для локализации отображаемых меток.

![Снимок экрана параметров ряда.](./media/workbooks-chart-visualizations/series-settings.png)

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как создать [плитку в книгах](workbooks-tile-visualizations.md).
- Узнайте, как создавать [интерактивные книги](workbooks-interactive.md).