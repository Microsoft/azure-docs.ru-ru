---
title: Поиск в Azure Application Insights | Документация Майкрософт
description: Поиск и фильтрация необработанных данных телеметрии, отправляемых веб-приложением.
ms.topic: conceptual
ms.date: 07/30/2019
ms.openlocfilehash: f7c2229a2e497fb052db79d61fcfeff140897798
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100579544"
---
# <a name="using-search-in-application-insights"></a>Поиск в Application Insights

Поиск — это функция [Application Insights](./app-insights-overview.md), которая позволяет искать и изучать отдельные элементы телеметрии, например просмотры страниц, исключения и веб-запросы. Также можно просматривать журнал трассировки и события, которые были закодированы.

(Для более сложных запросов к данным используйте [Analytics](../logs/log-analytics-tutorial.md).)

## <a name="where-do-you-see-search"></a>Как найти функцию поиска?

### <a name="in-the-azure-portal"></a>На портале Azure

Поиск по журналу диагностики можно открыть на вкладке Application Insights обзор приложения (расположенной на верхней панели) или в разделе исследовать слева.

![Вкладка "Поиск"](./media/diagnostic-search/view-custom-events.png)

Перейдите в раскрывающееся меню типы событий, чтобы просмотреть список элементов телеметрии — запросов сервера, просмотров страниц, пользовательских событий, которые были запрограммированы, и т. д. В верхней части списка результатов находится сводная диаграмма, показывающая количество событий с течением времени.

Щелкните из раскрывающегося меню или обновить, чтобы получить новые события.

### <a name="in-visual-studio"></a>В Visual Studio

В Visual Studio также есть окно поиска по Application Insights. Его удобно использовать для отображения событий телеметрии, созданных отлаживаемым приложением. Оно также может показывать события, собранные из опубликованного приложения на портале Azure.

Откройте окно "Поиск" в Visual Studio.

![Как открыть окно "Поиск по Application Insights" в Visual Studio](./media/diagnostic-search/32.png)

Функции в окне поиска схожи с функциями на веб-портале:

![Окно "Поиск по Application Insights" в Visual Studio](./media/diagnostic-search/34.png)

Вкладка Track Operation (Отслеживание операции) отображается при открытии запроса или представления страницы. Операция — это последовательность событий, связанных с отдельным запросом или представлением страницы. В одну операцию могут входить, например, вызовы зависимостей, исключения, журналы трассировки и пользовательские события. На вкладке Track Operation (Отслеживание операции) графически показано время и продолжительность этих событий относительно запроса или представления страницы.

## <a name="inspect-individual-items"></a>Проверка отдельных элементов

Выберите любой элемент телеметрии для просмотра ключевых полей и связанных элементов.

![Скриншот запроса отдельных зависимостей](./media/diagnostic-search/telemetry-item.png)

При этом откроется представление со сведениями о сквозных транзакциях.

## <a name="filter-event-types"></a>Фильтрация по типам событий

Откройте раскрывающееся меню типы событий и выберите типы событий, которые необходимо просмотреть. (Если позже необходимо восстановить фильтры, нажмите кнопку Сбросить.)

Ниже приведены типы событий.

* **Трассировка событий**  -  [Журналы диагностики](./asp-net-trace-logs.md) , в том числе вызовы TrackTrace, log4net, NLog и System. Диагностика. Trace.
* **Запрос** — HTTP-запросы, полученные серверным приложением, включая страницы, скрипты, изображения, файлы стилей и данные. Эти события используются для создания обзорных диаграмм запросов и ответов.
* **Просмотр страницы**  -  [Данные телеметрии, отправленные веб-клиентом](./javascript.md)и используемые для создания отчетов по просмотру страниц.
* **Пользовательское событие** — при вставке в код вызовов TrackEvent() для [отслеживания использования](./api-custom-events-metrics.md) эти вызовы можно найти здесь.
* **Исключение** — неперехваченные [исключения на сервере](./asp-net-exceptions.md)и те, которые вы зарегистрируете с помощью TrackException ().
* **Зависимость от**  -  [Вызовы из серверного приложения](./asp-net-dependencies.md) в другие службы, такие как API-интерфейсы или базы данных, и вызовы AJAX из [клиентского кода](./javascript.md).
* **Доступность** — результаты [тестов доступности](./monitor-web-app-availability.md).

## <a name="filter-on-property-values"></a>Фильтрация на основе значений свойств

Можно фильтровать события по значениям их свойств. Доступные свойства зависят от выбранных типов событий. Щелкните значок фильтра ![Значок фильтра](./media/diagnostic-search/filter-icon.png) для запуска.

Если не выбрать ни одно из значений конкретного свойства, эффект будет таким же, как и при выборе всех значений. Фильтрация по этому свойству будет отключена.

Обратите внимание, что счетчики справа от значений фильтра показывают число вхождений в текущем отфильтрованном наборе.

## <a name="find-events-with-the-same-property"></a>Поиск событий с одним и тем же свойством

Чтобы найти все элементы с одинаковым значением свойства, введите их в строку поиска или установите флажок при просмотре свойств на вкладке "фильтр".

![Установите флажок свойства на вкладке Фильтр.](./media/diagnostic-search/filter-property.png)

## <a name="search-the-data"></a>Поиск данных

> [!NOTE]
> Чтобы написать более сложные запросы, откройте [**журналы (Analytics)**](../logs/log-analytics-tutorial.md) в верхней части колонки поиска.
>

В любом из значений свойств можно искать слова. Это полезно, если вы написали [пользовательские события](./api-custom-events-metrics.md) со значениями свойств.

Можно задать временной диапазон, так как поиск в более коротком диапазоне выполняется быстрее.

![Откройте поиск по журналу диагностики](./media/diagnostic-search/search-property.png)

Выполните поиск по полным словам, а не по подстрокам. Специальные символы заключайте в кавычки.

| Строка | *Не* найдено | Найдено |
| --- | --- | --- |
| HomeController.About |`home`<br/>`controller`<br/>`out` | `homecontroller`<br/>`about`<br/>`"homecontroller.about"`|
|США|`Uni`<br/>`ted`|`united`<br/>`states`<br/>`united AND states`<br/>`"united states"`

Вот доступные поисковые выражения:

| Пример запроса | Действие |
| --- | --- |
| `apple` |Поиск всех событий в диапазоне времени, поля которых включают слово "apple". |
| `apple AND banana` <br/>`apple banana` |Поиск событий, содержащих оба слова. Используйте "AND" заглавными буквами, а не "and". <br/>Короткая форма. |
| `apple OR banana` |Поиск событий, содержащих любое из этих слов. Используйте «OR» заглавными буквами, а не «or». |
| `apple NOT banana` |Поиск событий, содержащих только одно из этих слов, но не содержащих другое. |

## <a name="sampling"></a>Дискретизация

Если приложение создает большой объем данных телеметрии (и используется пакет SDK ASP.NET версии 2.0.0-beta3 или более поздней), то модуль адаптивной выборки автоматически сокращает объем данных, отправляемый на портал, отправляя только репрезентативную часть событий. При этом связанные с тем же запросом события отбираются как группа, что позволяет перемещаться между связанными событиями.

[Дополнительная информация о выборке](./sampling.md).

## <a name="create-work-item"></a>Создание рабочего элемента

В GitHub или Azure DevOps можно создать ошибку и указать в ней сведения из любого элемента телеметрии.

Перейдите к подробному представлению транзакции, щелкнув любой элемент телеметрии и выбрав **создать рабочий элемент**.

![Щелкните "Создать рабочий элемент", отредактируйте поля и нажмите кнопку "ОК".](./media/diagnostic-search/work-item.png)

Если вы делаете это в первый раз, вам будет предложено настроить ссылку на вашу организацию и проект в Azure DevOps.

(Можно также настроить ссылку на вкладке рабочие элементы.)

## <a name="send-more-telemetry-to-application-insights"></a>Передача дополнительных элементов телеметрии в Application Insights

В дополнение к стандартным элементам телеметрии, передаваемым пакетом SDK Application Insights, можно сделать следующее.

* Выполнять трасcировку журналов, используя избранную платформу ведения журнала в [.NET](./asp-net-trace-logs.md) или [Java](./java-trace-logs.md). Благодаря этому можно будет выполнить поиск в журнале трассировки и сопоставить результаты с просмотрами страниц, исключениями и другими событиями.
* [Создавать код](./api-custom-events-metrics.md) для отправки пользовательских событий, сведений о просмотрах страниц и исключениях.

[Подробнее об отправке журналов и пользовательских данных телеметрии в Application Insights](./asp-net-trace-logs.md).

## <a name="q--a"></a><a name="questions"></a>ВОПРОСЫ & A

### <a name="how-much-data-is-retained"></a><a name="limits"></a>Какой объем данных сохраняется?

Ознакомьтесь со [сводной таблицей ограничений](./pricing.md#limits-summary).

### <a name="how-can-i-see-post-data-in-my-server-requests"></a>Как просмотреть данные POST в запросах к серверу?

Мы не заносим в журнал данные POST автоматически, но вы можете использовать [вызовы TrackTrace или вызовы журнала](./asp-net-trace-logs.md). Поместите данные POST в параметр сообщения. Сообщения нельзя отфильтровать тем же способом, как это делается для свойств, но предельный размер больше.

## <a name="next-steps"></a><a name="add"></a>Следующие шаги

* [Создание сложных запросов в Analytics](../logs/log-analytics-tutorial.md)
* [Журналы, исключения и пользовательские средства диагностики для ASP.NET в Application Insights](./asp-net-trace-logs.md)
* [Наблюдение за доступностью и скоростью реагирования веб-сайта](./monitor-web-app-availability.md)
* [Устранение неполадок](../faq.md)