---
title: Создание настраиваемых панелей мониторинга в Azure Application Insights | Документация Майкрософт
description: Руководство по созданию настраиваемых панелей мониторинга ключевых показателей эффективности с помощью Azure Application Insights.
ms.topic: tutorial
author: lgayhardt
ms.author: lagayhar
ms.date: 09/30/2020
ms.custom: mvc, contperf-fy21q1
ms.openlocfilehash: 7bad0b17bb2fed9d9f54cdd44042ec88708f35fd
ms.sourcegitcommit: 5f482220a6d994c33c7920f4e4d67d2a450f7f08
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/08/2021
ms.locfileid: "107103731"
---
# <a name="create-custom-kpi-dashboards-using-azure-application-insights"></a>Создание настраиваемых панелей мониторинга ключевых показателей эффективности с помощью Azure Application Insights

Вы можете создать несколько панелей мониторинга на портале Azure, каждая из которых будет включать плитку, визуализирующую данные из нескольких ресурсов Azure в разных группах ресурсов и подписках.  Вы можете закрепить различные диаграммы и представления Azure Application Insights для создания пользовательских панелей мониторинга, предоставляющих полную картину работоспособности и производительности приложения. В этом руководстве описано создание пользовательской панели мониторинга, которая включает несколько типов данных и визуализации из Azure Application Insights.

 Вы узнаете, как выполнять следующие задачи:

> [!div class="checklist"]
> * Создание настраиваемой панели мониторинга в Azure.
> * Добавление плитки из коллекции плиток.
> * Добавление стандартных метрик Application Insights на панель мониторинга.
> * Добавление пользовательской диаграммы метрики Application Insights на панель мониторинга.
> * Добавление результатов запроса журналов (Analytics) на панель мониторинга

## <a name="prerequisites"></a>предварительные требования

Для работы с этим руководством:

- Разверните приложение .NET в Azure и [включите пакет SDK для Application Insights](../app/asp-net.md).

> [!NOTE]
> Необходимые разрешения для работы с панелями мониторинга приведены в статье с [общими сведениями об управлении доступом к панелям мониторинга](../../azure-portal/azure-portal-dashboard-share-access.md#understanding-access-control-for-dashboards).

## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на портал Azure по адресу [https://portal.azure.com](https://portal.azure.com).

## <a name="create-a-new-dashboard"></a>Создание панели мониторинга

> [!WARNING]
> Если вы перемещаете ресурс Application Insights в другую группу ресурсов или подписку, вам потребуется вручную обновить панель мониторинга, удалив старые плитки и закрепив новые из того же ресурса Application Insights в новом расположении.

Одна панель мониторинга может содержать ресурсы из нескольких приложений, групп ресурсов и подписок.  Начните работу с руководством с создания панели мониторинга для приложения.  

1. На портале Azure в раскрывающемся меню слева выберите элемент **Панель мониторинга**.

    ![Раскрывающееся меню портала Azure](media/tutorial-app-dashboards/dashboard-from-menu.png)

2. В области "Панель мониторинга" выберите **Новая панель мониторинга**, а затем — **Пустая панель мониторинга**.

   ![Новая панель мониторинга](media/tutorial-app-dashboards/new-dashboard.png)

3. Введите имя для панели мониторинга.
4. Ознакомьтесь с **Коллекцией плиток** для различных плиток, которые можно добавить на панель мониторинга.  Помимо добавления плиток из галереи вы можете закрепить диаграммы и другие представления непосредственно из Application Insights на панели мониторинга.
5. Найдите плитку **Markdown** и перетащите ее на панель мониторинга.  Эта плитка позволяет добавлять форматированный текст в разметку, которая отлично подходит для добавления поясняющего текста на панель мониторинга. Дополнительные сведения см. в статье [Использование плитки с поддержкой Markdown на панелях мониторинга Azure для отображения настраиваемого содержимого](../../azure-portal/azure-portal-markdown-tile.md).
6. Добавьте текст в свойства плитки и измените его размер на холсте панели мониторинга.

    [![Изменение разметки плитки](media/tutorial-app-dashboards/markdown.png)](media/tutorial-app-dashboards/markdown.png#lightbox)

7. Щелкните **Настройка выполнена** в верхней части экрана, чтобы выйти из режима настройки плитки.

## <a name="add-health-overview"></a>Добавление общих сведений о работоспособности

Панель мониторинга только со статическим текстом не представляет интереса, поэтому добавьте плитку из Application Insights для отображения информации о вашем приложении. Вы можете добавить плитку Application Insights из Коллекции плиток или закрепить ее напрямую с экранов Application Insights. Это позволяет настроить диаграммы и представления, с которыми вы уже знакомы, перед закреплением их на панели мониторинга.  Начните с добавления стандартного обзора работоспособности приложения.  Это не требует настройки и предоставляет минимальные настройки на панели мониторинга.


1. На начальном экране выберите ресурс **Application Insights**.
2. В области **Обзор** выберите значок булавки ![значок булавки](media/tutorial-app-dashboards/pushpin.png), чтобы добавить плитку на панель мониторинга.
3. На вкладке "Закрепить на панели мониторинга" выберите панель мониторинга, в которую нужно добавить плитку, или создайте новую.
 
3. В правом верхнем углу появится уведомление о закреплении плитки на панели мониторинга.  Щелкните **Закреплено на панели мониторинга** в уведомлении, чтобы вернуться к информационной панели, или панели мониторинга.
4. Эта плитка теперь добавлена ​​на вашу панель мониторинга. Чтобы изменить расположение плитки, выберите **Правка**. Щелкните и перетащите ее в нужное место, а затем выберите **Настройка выполнена**. Теперь на панели мониторинга есть плитка с полезной информацией.

    [![Панель мониторинга в режиме редактирования](media/tutorial-app-dashboards/dashboard-edit-mode.png)](media/tutorial-app-dashboards/dashboard-edit-mode.png#lightbox)

## <a name="add-custom-metric-chart"></a>Добавление пользовательской диаграммы метрики

Панель **Метрики** позволяет графически отображать метрики, собранные Application Insights, с помощью дополнительных фильтров и группировки.  Как и все остальное в Application Insights, эту диаграмму можно добавить на панель мониторинга.  Для этого необходимо сначала выполнить небольшую настройку.

1. На начальном экране выберите ресурс **Application Insights**.
1. Выберите **Метрики**.  
2. Пустая диаграмма уже создана. Вам будет предложено ввести метрику.  Добавьте метрику на диаграмму, при необходимости можно добавить фильтры и группировку.  В приведенном ниже примере показано количество запросов к серверу, сгруппированных по успешности.  Это предоставляет постоянное представление об успешных и неуспешных запросах.

    [![Добавление метрики](media/tutorial-app-dashboards/metrics.png)](media/tutorial-app-dashboards/metrics.png#lightbox)

4. Выберите **Закрепить на панели мониторинга** справа.

3.  В правом верхнем углу появится уведомление о закреплении плитки на панели мониторинга. Щелкните **Закреплено на панели мониторинга** в уведомлении, чтобы вернуться к панели мониторинга или использовать вкладку панели мониторинга.

4. Эта плитка теперь добавлена ​​на вашу панель мониторинга. Чтобы изменить расположение плитки, выберите **Правка**. Щелкните и перетащите ее в нужное место, а затем выберите **Настройка выполнена**.

## <a name="add-logs-query"></a>Добавление запроса журналов

Журналы Azure Application Insights предоставляют полнофункциональный язык запросов, позволяющий анализировать все данные, собранные Application Insights. Так же, как диаграммы и другие представления, вы можете добавить выходные данные запроса журналов на свою панель мониторинга.

1. На начальном экране выберите ресурс **Application Insights**.
2. В меню слева в разделе "Мониторинг" выберите элемент **Журналы**, чтобы открыть вкладку "Журналы".
3. Введите следующий запрос, который возвращает 10 наиболее часто запрашиваемых страниц и их число запросов:

    ``` Kusto
    requests
    | summarize count() by name
    | sort by count_ desc
    | take 10
    ```

4. Щелкните **Выполнить**, чтобы проверить результаты запроса.
5. Нажмите значок закрепления, ![Значок "Закрепить"](media/tutorial-app-dashboards/pushpin.png) и выберите имя вашей панели мониторинга.

5. Прежде чем вернуться к панели мониторинга, добавьте другой запрос, но преобразуйте его в вид диаграммы. Так вы увидите разные способы визуализации журнала запросов на панели мониторинга. Начните со следующего запроса, который обобщит 10 лучших операций с наибольшим количеством исключений.

    ``` Kusto
    exceptions
    | summarize count() by operation_Name
    | sort by count_ desc
    | take 10
    ```

6. Выберите **Диаграмма**, а затем измените ее на **Кольцевая**, чтобы визуализировать выходные данные.

    [![Кольцевая диаграмма с вышеуказанным запросом](media/tutorial-app-dashboards/logs-doughnut.png)](media/tutorial-app-dashboards/logs-doughnut.png#lightbox)

6. Нажмите значок закрепления, ![Значок закрепления](media/tutorial-app-dashboards/pushpin.png) в правом верхнем углу для закрепления диаграммы на панели мониторинга, а затем вернитесь на свою панель мониторинга.
7. Теперь результаты запросов будут добавлены на панель мониторинга в выбранном формате. Щелкните и перетащите их в нужное место, а затем выберите **Настройка выполнена**.
8. Выберите значок "Карандаш" ![Значок "Карандаш"](media/tutorial-app-dashboards/pencil.png) в каждом заголовке для создания поясняющего заголовка.

## <a name="share-dashboard"></a>Общий доступ к информационной панели

1. В верхней части панели мониторинга выберите **Поделиться**, чтобы опубликовать изменения.
2. При необходимости можно задать определенных пользователей, которые будут иметь доступ к панели мониторинга. Дополнительные сведения см. в статье [Предоставление общего доступа к панелям мониторинга Azure с помощью управления доступом на основе ролей](../../azure-portal/azure-portal-dashboard-share-access.md).
3. Нажмите **Публиковать**.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда вы узнали, как создавать настраиваемые панели мониторинга, ознакомьтесь с остальной документацией по Application Insights, включая пример внедрения.

> [!div class="nextstepaction"]
> [Углубленная диагностика для веб-приложений и служб с помощью Application Insights](../app/devops.md)
