---
title: Azure Monitor для обозреватель данных Azure (Предварительная версия) | Документация Майкрософт
description: В этой статье описывается Azure Monitor Insights для кластеров Azure обозреватель данных.
services: azure-monitor
ms.topic: conceptual
ms.date: 01/05/2021
author: lgayhardt
ms.author: lagayhar
ms.openlocfilehash: dcfe12b30e336863c8e112d9ad675a2f57fe48f4
ms.sourcegitcommit: 24a12d4692c4a4c97f6e31a5fbda971695c4cd68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102179142"
---
# <a name="azure-monitor-for-azure-data-explorer-preview"></a>Azure Monitor для обозреватель данных Azure (Предварительная версия)

Azure Monitor для Azure обозреватель данных (Предварительная версия) обеспечивает полный мониторинг кластеров, обеспечивая единое представление производительности кластера, операций, использования и сбоев.
Эта статья поможет вам понять, как подключить и использовать Azure Monitor для Azure обозреватель данных (Предварительная версия).

## <a name="introduction-to-azure-monitor-for-azure-data-explorer-preview"></a>Общие сведения о Azure Monitor для обозреватель данных Azure (Предварительная версия)

Прежде чем переходить к настройке интерфейса, необходимо понять, как он представляет и визуализирует информацию.
-    **В перспективе масштаба** отображается моментальный снимок основных метрик кластеров, что позволяет легко контролировать производительность запросов, приема и операций экспорта.
-   **Детализация анализа** конкретного кластера Azure обозреватель данных для выполнения подробного анализа.
-    **Настраиваемое** расположение позволяет изменить отображаемые метрики, изменить или задать пороговые значения, которые будут согласованы с вашими ограничениями, и сохранить собственные пользовательские книги. Диаграммы из книги можно закрепить на панелях мониторинга Azure.

## <a name="view-from-azure-monitor-at-scale-perspective"></a>Просмотр с Azure Monitor (в перспективе масштабирования)

В Azure Monitor можно просматривать основные метрики производительности для кластера, включая метрики запросов, приема и операций экспорта из нескольких кластеров в подписке, а также помогает выявление проблем с производительностью.

Чтобы просмотреть производительность кластеров во всех подписках, выполните следующие действия.

1. Войдите на [портал Azure](https://portal.azure.com/).

2. Выберите **монитор** в левой области в портал Azure и в разделе Центр Insights выберите **Azure обозреватель данных Clusters (Предварительная версия)**.

![Снимок экрана с обзором нескольких диаграмм](./media/data-explorer/insights-hub.png)

### <a name="overview-tab"></a>Вкладка "Обзор"

На вкладке **Обзор** для выбранной подписки в таблице отображаются Интерактивные метрики для кластеров Azure обозреватель данных, сгруппированных в рамках подписки. Результаты можно фильтровать по параметрам, выбранным в следующих раскрывающихся списках.

* Подписки — перечислены только подписки с кластерами Azure обозреватель данных.

* Кластеры обозреватель данных Azure — по умолчанию предварительно выбраны только до пяти кластеров. Если выбрать в селекторе области все или несколько кластеров, будут возвращены кластеры размером до 200.

* Диапазон времени — по умолчанию отображаются данные за последние 24 часа с учетом выбранных параметров.

На плитке счетчика в раскрывающемся списке раскрывается общее число кластеров обозреватель данных Azure в выбранных подписках и отражается количество выбранных. Существует условное кодирование цветов для столбцов: Проверка активности, загрузка ЦП, использование приема и использование кэша. Оранжевые запрограммированные ячейки имеют значения, которые не являются устойчивыми для кластера. 

Чтобы лучше понять, что представляет каждая из метрик, мы рекомендуем ознакомиться с документацией по [метрикам обозреватель данных Azure](/azure/data-explorer/using-metrics#cluster-metrics).

### <a name="query-performance-tab"></a>Вкладка "производительность запросов"

На этой вкладке отображается длительность запроса, общее количество одновременных запросов и общее число регулируемых запросов.

![Снимок экрана вкладки "производительность запросов"](./media/data-explorer/query-performance.png)

### <a name="ingestion-performance-tab"></a>Вкладка "производительность приема"

На этой вкладке показана задержка приема, результаты приемки, результаты неудачного приема, объем приема и события, обработанные для центров событий и Интернета вещей.

[![Снимок экрана вкладки "производительность приема"](./media/data-explorer/ingestion-performance.png)](./media/data-explorer/ingestion-performance.png#lightbox)

### <a name="streaming-ingest-performance-tab"></a>Вкладка "производительность приема потоковой передачи"

На этой вкладке представлена информация о среднем темпе данных, средней длительности и частоте запросов.

### <a name="export-performance-tab"></a>Вкладка "экспорт производительности"

На этой вкладке содержатся сведения о экспортированных записях, задержке, ожидаемом количестве и проценте использования для непрерывных операций экспорта.

## <a name="view-from-an-azure-data-explorer-cluster-resource-drill-down-analysis"></a>Просмотр из ресурса кластера Azure обозреватель данных (детализация углублением)

Чтобы получить доступ к Azure Monitor для кластеров Azure обозреватель данных напрямую из кластера обозреватель данных Azure:

1. В портал Azure выберите **кластеры обозреватель данных Azure**.

2. В списке выберите кластер Azure обозреватель данных. В разделе Мониторинг выберите **Insights (Предварительная версия)**.

Эти представления также доступны, выбрав имя ресурса кластера Azure обозреватель данных в представлении Azure Monitor Insights.

Azure Monitor для Azure обозреватель данных объединяет как журналы, так и метрики для предоставления глобального решения для мониторинга. Для включения визуализаций на основе журналов пользователи должны [включить ведение журнала диагностики для кластера Azure обозреватель данных и отправить их в рабочую область log Analytics.](/azure/data-explorer/using-diagnostic-logs?tabs=commands-and-queries#enable-diagnostic-logs) Должны быть включены следующие журналы диагностики: **Command**, **Query**, **табледетаилс** и **таблеусажестатистикс**.

![Снимок экрана с синей кнопкой, отображающей текст "включить журналы для мониторинга"](./media/data-explorer/enable-logs.png)


 На вкладке Обзор отображаются следующие **сведения** .

- Плитки метрик выделяют доступность и общее состояние кластера для быстрой оценки его работоспособности.

- Сводка по [рекомендациям активного помощника](/azure/data-explorer/azure-advisor) и состоянию [работоспособности ресурсов](/azure/data-explorer/monitor-with-resource-health) .

- Диаграммы, отображающие наибольшее число уникальных пользователей ЦП и памяти, а также их количество.


[![Снимок экрана: Просмотр из ресурса кластера Azure обозреватель данных](./media/data-explorer/overview.png)](./media/data-explorer/overview.png#lightbox)

На вкладке **ключевые метрики** показано единое представление метрик кластера, сгруппированных по следующим показателям: общие метрики, связанные с запросом метрики, связанные с приемом и передачей потокового приема.

[![Снимок экрана с представлением сбоев](./media/data-explorer/key-metrics.png)](./media/data-explorer/key-metrics.png#lightbox)

Вкладка **Использование** позволяет пользователям глубоко разобраться в производительности команд и запросов кластера. На этой странице можно выполнить следующие действия.
 
 - Узнайте, какие группы рабочей нагрузки, пользователи и приложения отправляют наибольший объем запросов или потребляют больше всего ресурсов ЦП и памяти (так что вы можете определить, какие рабочие нагрузки отправляют самые ресурсоемкие запросы для обработки в кластере).
 - Выявление основных групп рабочей нагрузки, пользователей и приложений по неудачным запросам.
 - Выявление последних изменений в количестве запросов по сравнению с историческим ежедневным средним (за последние 16 дней) по группам рабочей нагрузки, пользователю и приложению.
 - Выявление тенденций и пиковых значений в количестве запросов, памяти и ЦП по группам рабочей нагрузки, пользователю, приложению и типу команды.

[![Снимок экрана представления "операции" с кольцевыми диаграммами приложения по количеству команд и запросов, основные участники по количеству команд и запросов, а также команды Top по типам команд](./media/data-explorer/usage.png)](./media/data-explorer/usage.png#lightbox)

[![Снимок экрана: представление операций с графиком числа запросов по приложениям, Общая память по приложениям и общий ЦП по приложениям](./media/data-explorer/usage-2.png)](./media/data-explorer/usage-2.png#lightbox)

На вкладке **таблицы** отображаются последние и исторические свойства таблиц в кластере. Можно видеть, какие таблицы потребляют больше всего пространства, отслеживая историю роста по размеру таблицы, горячим данным и количеству строк за период времени.

Вкладка **кэш** позволяет пользователям анализировать свои фактические запросы и сравнивать их с настроенной политикой кэша (для каждой таблицы). Можно задать таблицы, используемые большинством запросов и таблиц, которые не запрашиваются, и соответствующим образом адаптировать политику кэширования. Вы можете получить определенные рекомендации по политикам кэша для определенных таблиц в помощнике по Azure (в настоящее время рекомендации по кэшу доступны только на [основной панели мониторинга помощника по Azure](/azure/data-explorer/azure-advisor#use-the-azure-advisor-recommendations)), на основе фактических запросов в течение последнего 30 дней и неоптимизированной политики кэша по крайней мере 95% запросов. Рекомендации по сокращению кэша в помощнике Azure доступны для кластеров, "ограниченных данными" (это означает, что кластер имеет низкую загрузку ЦП и низкий уровень приема, но из-за высокой емкости данных кластер не может масштабироваться или масштабироваться).

[![Снимок экрана: сведения о кэше](./media/data-explorer/cache-tab.png)](./media/data-explorer/cache-tab.png#lightbox)

## <a name="pin-to-azure-dashboard"></a>Закрепление на панели мониторинга Azure

Вы можете закрепить любой из разделов метрик (в перспективе "на месте") на панели мониторинга Azure, щелкнув значок канцелярской кнопки в правом верхнем углу раздела.

![Снимок экрана с выбранным значком закрепления](./media/data-explorer/pin.png)

## <a name="customize-azure-monitor-for-azure-data-explorer-cluster"></a>Настройка Azure Monitor для кластера Azure обозреватель данных

В этом разделе описываются распространенные сценарии редактирования книги для выполнения настроек, необходимых для решения ваших задач по анализу данных.
* Укажите область книги, чтобы всегда выбирать конкретную подписку или кластеры Azure обозреватель данных.
* Изменение метрик в сетке
* Изменение пороговых значений, отрисовка и кодирование цветов

Чтобы начать настройку, включите режим редактирования, нажав кнопку **Настроить** на верхней панели инструментов.

![Снимок экрана с кнопкой настройки](./media/data-explorer/customize.png)

Настройки сохраняются в пользовательской книге, чтобы конфигурация по умолчанию в опубликованной книге не перезаписывалась. Книги хранятся в группе ресурсов либо в закрытом разделе "Мои отчеты", либо в разделе "Общие отчеты", доступном всем пользователям с доступом к группе ресурсов. После сохранения пользовательской книги перейдите в коллекцию книг и запустите эту книгу.

![Снимок экрана с коллекцией книг](./media/data-explorer/gallery.png)

## <a name="troubleshooting"></a>Устранение неполадок

Общие рекомендации по устранению неполадок см. в соответствующей [статье об устранении неполадок](troubleshoot-workbooks.md)на основе книги.

Этот раздел поможет вам в диагностике и устранении неполадок некоторых распространенных проблем, которые могут возникнуть при использовании Azure Monitor для кластера Azure обозреватель данных (Предварительная версия). Чтобы найти информацию о конкретной проблеме, просмотрите список ниже.

### <a name="why-dont-i-see-all-my-subscriptions-in-the-subscription-picker"></a>Почему в средстве выбора подписки не отображаются все мои подписки?

Мы видим только те подписки, которые содержат кластеры обозреватель данных Azure, выбранные из выбранного фильтра подписки, которые выбраны в подписке "каталог и подписка" в заголовке портал Azure.

![Снимок экрана с фильтром подписок](./media/key-vaults-insights-overview/Subscriptions.png)

### <a name="why-do-i-not-see-any-data-for-my-azure-data-explorer-cluster-under-the-usage-tables-or-cache-sections"></a>Почему я не вижу никаких данных для кластера Azure обозреватель данных в разделах "использование", "таблицы" или "кэш"?

Чтобы просмотреть данные на основе журналов, необходимо [включить журналы диагностики](/azure/data-explorer/using-diagnostic-logs?tabs=commands-and-queries#enable-diagnostic-logs) для каждого из кластеров Azure обозреватель данных, которые вы хотите отслеживать. Это можно сделать в параметрах диагностики для каждого кластера. Вам потребуется отправить данные в рабочую область Log Analytics. Должны быть включены следующие журналы диагностики: Command, Query, Табледетаилс и Таблеусажестатистикс.

### <a name="i-have-already-enabled-logs-for-my-azure-data-explorer-cluster-why-am-i-still-unable-to-see-my-data-under-commands-and-queries"></a>Вы уже включили журналы для кластера Azure обозреватель данных, почему я по-прежнему не вижу данные в разделе Commands and Queries?

В настоящее время журналы диагностики не работают задним числом, поэтому данные будут отображаться только после того, как были выполнены действия в обозреватель данных Azure. Таким образом, в зависимости от того, как активен кластер Azure обозреватель данных, может потребоваться некоторое время (от нескольких часов до дня).


## <a name="next-steps"></a>Дальнейшие действия

Узнайте, в каких ситуациях применяются книги, как создавать и настраивать отчеты и многое другое, изучив статью [Создание интерактивных отчетов с использованием книг Azure Monitor](../visualize/workbooks-overview.md).
