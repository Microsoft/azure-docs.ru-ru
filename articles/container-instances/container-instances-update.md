---
title: Обновить группу контейнеров
description: Сведения об обновлении запущенных контейнеров в службе "Экземпляры контейнеров Azure"
ms.topic: article
ms.date: 04/17/2020
ms.openlocfilehash: fb31eeda83532c408a303e879439006bcd7d4e45
ms.sourcegitcommit: dda0d51d3d0e34d07faf231033d744ca4f2bbf4a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102200654"
---
# <a name="update-containers-in-azure-container-instances"></a>Обновление контейнеров в службе "Экземпляры контейнеров Azure"

Во время нормальной работы экземпляров контейнеров может оказаться необходимым обновить запущенные контейнеры в [группе контейнеров](./container-instances-container-groups.md). Например, может потребоваться обновить свойство, например версию образа, DNS-имя или переменную среды, или обновить свойство в контейнере, в котором произошел сбой приложения.

Обновление контейнеров в работающей группе контейнеров путем повторного развертывания существующей группы по крайней мере с одним измененным свойством. При обновлении группы контейнеров все работающие контейнеры в группе перезапускаются на месте, обычно на том же базовом узле контейнера.

> [!NOTE]
> Группы контейнеров, которые прекратили действие или были удалены, невозможно обновить. После завершения работы группы контейнеров (находится в состоянии "успешно" или "сбой") или была удалена, группа должна быть развернута как новая. См. другие [ограничения](#limitations).

## <a name="update-a-container-group"></a>Обновление группы контейнеров

Чтобы обновить существующую группу контейнеров, выполните следующие действия.

* Выполните команду Create (или используйте портал Azure) и укажите имя существующей группы. 
* Измените или добавьте по крайней мере одно свойство группы, которое поддерживает обновление при повторном развертывании. Некоторые свойства [не поддерживают обновления](#properties-that-require-container-delete).
* Задайте другие свойства с указанными ранее значениями. Если значение свойства не задано, оно возвращается к значению по умолчанию.

> [!TIP]
> [Файл YAML](./container-instances-container-groups.md#deployment) помогает поддерживать конфигурацию развертывания группы контейнеров и предоставляет отправную точку для развертывания обновленной группы. Если для создания группы использовался другой метод, можно экспортировать конфигурацию в YAML с помощью команды [AZ Container Export][az-container-export], 

### <a name="example"></a>Пример

В следующем примере интерфейс командной строки Azure CLI обновляет группу контейнеров с новой меткой имени DNS. Так как свойство метки DNS-имени группы является именем, которое может быть Обновлено, Группа контейнеров повторно развертывается и контейнеры перезапускаются.

Начальное развертывание с помощью метки имени DNS *myapplication-staging*.

```azurecli-interactive
# Create container group
az container create --resource-group myResourceGroup --name mycontainer \
    --image nginx:alpine --dns-name-label myapplication-staging
```

Обновите группу контейнеров с помощью новой метки DNS-имени *MyApplication* и установите остальные свойства, используя значения, которые использовались ранее:

```azurecli-interactive
# Update DNS name label (restarts container), leave other properties unchanged
az container create --resource-group myResourceGroup --name mycontainer \
    --image nginx:alpine --dns-name-label myapplication
```

## <a name="update-benefits"></a>Преимущества обновления

Основным преимуществом для обновления существующей группы контейнеров является более быстрое развертывание. При повторном развертывании существующей группы контейнеров слои ее образа извлекаются из кэша предыдущего развертывания. Вместо того чтобы извлекать все слои образов из реестра, как это происходит с новыми развертываниями, извлекаются только измененные слои (если такие существуют).

Приложения, основанные на более крупных образах контейнеров, таких как Windows Server Core, могут получить значительное улучшение скорости развертывания при обновлении вместо удаления и развертывания новых.

## <a name="limitations"></a>Ограничения

* Не все свойства группы контейнеров поддерживают обновления. Чтобы изменить некоторые свойства группы контейнеров, сначала необходимо удалить, затем повторно развернуть группу. См. раздел [свойства, требующие удаления контейнера](#properties-that-require-container-delete).
* При обновлении группы контейнеров все контейнеры в группе перезапускаются. Невозможно выполнить обновление или мгновенную перезагрузку конкретного контейнера, если в группе их несколько.
* IP-адрес группы контейнеров обычно хранится между обновлениями, но не всегда остается неизменным. Пока группа контейнеров развертывается на одном и том же базовом узле, она сохраняет свой IP-адрес. Несмотря на редкие случаи, существуют некоторые внутренние события Azure, которые могут привести к повторному развертыванию на другом узле. Чтобы устранить эту ошибку, мы рекомендуем использовать метку DNS-имени для экземпляров контейнера.
* Группы контейнеров, которые прекратили действие или были удалены, невозможно обновить. Когда группа контейнеров остановлена (находится в состоянии *завершения* ) или удалена, Группа развертывается как новая.

## <a name="properties-that-require-container-delete"></a>Свойства, требующие удаления контейнера

Не все свойства группы контейнеров могут быть обновлены. Например, чтобы изменить политику перезапуска контейнера, необходимо сначала удалить группу контейнеров, а затем создать ее снова.

Для изменения этих свойств требуется удаление группы контейнеров перед повторной развертыванием:

* Тип ОС
* Ресурсы ЦП, памяти или GPU
* Политика перезапуска
* сетевой профиль.

При удалении группы контейнеров и создании ее повторно, происходит не "повторное развертывание" объекта, а создается новый. Все слои образа заново извлекаются из реестра, а не из кэша предыдущего развертывания. IP-адрес контейнера также может измениться из-за его развертывания на другом основном узле.

## <a name="next-steps"></a>Дальнейшие действия

**Группа контейнеров** упоминается несколько раз в этой статье. Каждый контейнер в Экземплярах контейнеров Azure развертывается в группе, которая может содержать более одного контейнера.

[Группы контейнеров в службе "Экземпляры контейнеров Azure"](./container-instances-container-groups.md)

[Развертывание группы контейнеров](container-instances-multi-container-group.md)

[Остановка или запуск контейнеров в службе "Экземпляры контейнеров Azure" вручную](container-instances-stop-start.md)

<!-- LINKS - External -->

<!-- LINKS - Internal -->
[az-container-create]: /cli/azure/container#az-container-create
[azure-cli-install]: /cli/azure/install-azure-cli
[az-container-export]: /cli/azure/container#az-container-export
