---
title: Проверка подлинности доставки событий в обработчики событий (сетка событий Azure)
description: В этой статье описываются различные способы проверки подлинности доставки в обработчики событий в службе "Сетка событий Azure".
ms.topic: conceptual
ms.date: 01/07/2021
ms.openlocfilehash: 98d7a4a0dee6c355ec340668bef7d8b306f97496
ms.sourcegitcommit: 484f510bbb093e9cfca694b56622b5860ca317f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/21/2021
ms.locfileid: "98633126"
---
# <a name="authenticate-event-delivery-to-event-handlers-azure-event-grid"></a>Проверка подлинности доставки событий в обработчики событий (сетка событий Azure)
Эта статья содержит сведения о проверке подлинности доставки событий в обработчики событий. Также показано, как защитить конечные точки веб-перехватчика, используемые для получения событий из службы "Сетка событий", с помощью Azure Active Directory (Azure AD) или общего секрета.

## <a name="use-system-assigned-identities-for-event-delivery"></a>Использовать назначенные системой удостоверения для доставки событий
Вы можете включить управляемое системой удостоверение для раздела или домена и использовать удостоверение для пересылки событий в поддерживаемые места назначения, такие как очереди и разделы служебной шины, концентраторы событий и учетные записи хранения.

Для этого выполните указанные ниже действия. 

1. Создайте раздел или домен с назначенным системой удостоверением или обновите существующий раздел или домен, чтобы включить удостоверение. 
1. Добавьте удостоверение в соответствующую роль (например, отправитель данных служебной шины) в целевом расположении (например, в очередь служебной шины).
1. При создании подписок на события включите использование удостоверения для доставки событий в назначение. 

Подробные пошаговые инструкции см. в разделе [Доставка событий с помощью управляемого удостоверения](managed-service-identity.md).


## <a name="authenticate-event-delivery-to-webhook-endpoints"></a>Проверка подлинности для доставки событий в конечные точки веб-перехватчика
В следующих разделах описана проверка подлинности для доставки событий в конечные точки веб-перехватчика. Вам нужно использовать механизм подтверждения для проверки независимо от используемого метода. Дополнительные сведения см. в статье [Доставка событий веб-перехватчика](webhook-event-delivery.md). 


### <a name="using-azure-active-directory-azure-ad"></a>Использование Azure Active Directory (Azure AD)
Вы можете защитить конечную точку веб-перехватчика, которая используется для получения событий из службы "Сетка событий Azure", с помощью Azure AD. Для использования приложения Azure AD вам нужно создать приложение Azure AD, а также роль и субъект-службу в приложении, которое будет выполнять авторизацию службы "Сетка событий". Затем потребуется настроить подписку на события. Узнайте, как [Настроить Azure Active Directory для работы со службой "Сетка событий"](secure-webhook-delivery.md).

### <a name="using-client-secret-as-a-query-parameter"></a>Использование секрета клиента в качестве параметра запроса
Защитить конечную точку веб-перехватчика можно также путем добавления параметров запроса для URL-адреса назначения веб-перехватчика, указанного в рамках создания подписки на события. Задайте один из параметров запроса в качестве секрета клиента, например [маркер доступа](https://en.wikipedia.org/wiki/Access_token) или общий секрет. Служба "Сетка событий" включает все параметры запроса в каждом запросе на доставку событий в веб-перехватчик. Служба веб-перехватчика может извлекать и проверять секрет. Если секрет клиента обновлен, необходимо также обновить подписку на события. Чтобы избежать ошибок доставки во время этой смены секрета, сделайте так, чтобы веб-перехватчик принимал как старые, так и новые секреты в течение ограниченного периода, прежде чем обновлять подписку на события с новым секретом. 

Так как параметры запроса могут содержать секреты клиента, они обрабатываются с особой осторожностью. Они хранятся в зашифрованном и недоступном для операторов службы виде. Они не регистрируются в качестве части журналов или трассировок службы. При получении свойств подписки на события параметры запроса назначения не возвращаются по умолчанию. Например: параметр [--include-full-endpoint-url](/cli/azure/eventgrid/event-subscription#az-eventgrid-event-subscription-show) используется в Azure [CLI](/cli/azure).

Дополнительные сведения о доставке событий в веб-перехватчики см. в [этой статье](webhook-event-delivery.md).

> [!IMPORTANT]
Служба "Сетка событий Azure" поддерживает только конечные точки веб-перехватчиков **HTTPS**. 

## <a name="endpoint-validation-with-cloudevents-v10"></a>Проверка конечной точки с помощью CloudEvents версии 1.0
Если вы уже знакомы с службой "Сетка событий", то, возможно, знаете подтверждение подтверждения конечной точки для предотвращения нарушения. Клаудевентс v 1.0 реализует собственную [семантику защиты от нарушения](webhook-event-delivery.md) с помощью метода **http Options** . Дополнительные сведения см. в статье [HTTP 1,1 Web перехватчики для доставки событий — версия 1,0](https://github.com/cloudevents/spec/blob/v1.0/http-webhook.md#4-abuse-protection). При использовании схемы Клаудевентс для вывода в сетке событий вместо механизма событий проверки сетки событий используется защита от Клаудевентс v 1.0. Дополнительные сведения см. в статье [Использование схемы клаудевентс v 1.0 со службой "Сетка событий](cloudevents-schema.md)". 


## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о проверке подлинности клиентов при публикации событий в разделах или доменах см. в разделе [Аутентификация клиентов публикации](security-authenticate-publishing-clients.md) . 
