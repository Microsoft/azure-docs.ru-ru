---
title: Перемещение пользовательских разделов из службы "Сетка событий Azure" в другой регион
description: В этой статье показано, как переместить пользовательские разделы службы "Сетка событий Azure" из одного региона в другой.
ms.topic: how-to
ms.custom: subject-moving-resources
ms.date: 08/28/2020
ms.openlocfilehash: d0656a4f6ec1c7431cf7111f786b0f1d779166e3
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "89145351"
---
# <a name="move-azure-event-grid-custom-topics-to-another-region"></a>Перемещение пользовательских разделов из службы "Сетка событий Azure" в другой регион
Вам может потребоваться переместить ресурсы в другой регион по ряду причин. Например, чтобы воспользоваться преимуществами нового региона Azure, чтобы удовлетворить внутренние требования к политике и управлению, а также в ответ на требования к планированию емкости. 

Ниже приведены общие действия, описанные в этой статье. 

- **Экспортируйте ресурс пользовательского раздела** в шаблон Azure Resource Manager. 

    > [!IMPORTANT]
    > В шаблон экспортируется только пользовательский раздел. Все подписки для раздела не экспортируются.
- **Используйте шаблон для развертывания пользовательского раздела** в целевом регионе. 
- **Создание подписок вручную** в целевом регионе. При экспорте пользовательского раздела в шаблон в текущем регионе экспортируется только раздел. Подписки не включаются в шаблон, поэтому их необходимо создавать вручную после создания пользовательского раздела в целевом регионе. 
- **Проверка развертывания**. Убедитесь, что пользовательский раздел создан в целевом регионе. 
- Чтобы **завершить перемещение**, удалите пользовательский раздел из исходного региона. 

## <a name="prerequisites"></a>Предварительные требования
- Выполните инструкции из [краткого руководства: перенаправление пользовательских событий в веб-конечную точку](custom-event-quickstart-portal.md) в исходном регионе. Выполните этот шаг, чтобы выполнить тестирование шагов в этой статье. 
- Убедитесь, что служба "Сетка событий" доступна в целевом регионе. См. страницу [Доступность продуктов по регионам](https://azure.microsoft.com/global-infrastructure/services/?products=event-grid&regions=all).

## <a name="prepare"></a>Подготовка
Чтобы приступить к работе, экспортируйте шаблон диспетчер ресурсов для пользовательского раздела. 

1. Войдите на [портал Azure](https://portal.azure.com).
2. На панели поиска введите **разделы сетки событий** и выберите **разделы сетки событий** из списка результатов. 

    :::image type="content" source="./media/move-custom-topics-across-regions/search-topics.png" alt-text="Поиск и выбор разделов сетки событий":::
3. Выберите **раздел** , который необходимо экспортировать в шаблон диспетчер ресурсов. 

    :::image type="content" source="./media/move-custom-topics-across-regions/select-custom-topic.png" alt-text="Выберите пользовательский раздел":::   
4. На странице **раздела "Сетка событий** " выберите **Экспорт шаблона** в разделе **Параметры** в меню слева и нажмите кнопку **скачать** на панели инструментов. 

    :::image type="content" source="./media/move-custom-topics-across-regions/export-template-download.png" alt-text="Экспорт шаблона — > скачивание":::   

    > [!IMPORTANT]
    > В шаблон экспортируется только раздел. Подписки для раздела не экспортируются. Поэтому необходимо создать подписки для раздела после перемещения раздела в целевой регион. 
5. Выберите **ZIP** -файл, скачанный с портала, и распакуйте его в выбранную папку. Этот ZIP-файл содержит шаблонные и параметры JSON-файлы. 
1. Откройте **template.js** в любом редакторе по своему усмотрению. 
8. Обновите `location` ресурс **раздела** до целевого региона или расположения. Чтобы получить коды расположения, см. раздел [расположения Azure](https://azure.microsoft.com/global-infrastructure/locations/). Код для региона — это имя региона без пробелов, например, `West US` равно `westus` .

    ```json
    "type": "Microsoft.EventGrid/topics",
    "apiVersion": "2020-06-01",
    "name": "[parameters('topics_mytopic0130_name')]",
    "location": "westus"
    ```
1. **Сохраните** шаблон. 

## <a name="recreate"></a>Повторно создать 
Разверните шаблон, чтобы создать пользовательский раздел в целевом регионе. 

1. На портале Azure выберите **Создать ресурс**.
2. В **поле Поиск в Marketplace** введите **шаблон развертывание** и нажмите клавишу **Ввод**.
3. Выберите **шаблоны развертывания**.
4. Нажмите кнопку **создания**.
5. Выберите **Создать собственный шаблон в редакторе**.
6. Выберите **загрузить файл** и следуйте инструкциям по загрузке **template.jsв** файл, скачанный в предыдущем разделе.
7. Нажмите кнопку **сохранить** , чтобы сохранить шаблон. 
8. На странице **Настраиваемое развертывание** выполните следующие действия. 
    1. Выберите **подписку** Azure. 
    1. Выберите существующую **группу ресурсов** в целевом регионе или создайте ее. 
    1. В поле **регион** выберите целевой регион. Если выбрана существующая группа ресурсов, этот параметр доступен только для чтения. 
    1. В поле **имя раздела** введите новое имя раздела. 
    1. В нижней части страницы выберите **Review + create** (Проверить и создать). 
    
        :::image type="content" source="./media/move-custom-topics-across-regions/deploy-template.png" alt-text="Пользовательское развертывание":::
    1. На странице **Проверка и создание** проверьте параметры и нажмите кнопку **создать**. 

## <a name="verify"></a>Проверка

1. После успешного развертывания выберите **Перейти к ресурсу**. 

    :::image type="content" source="./media/move-custom-topics-across-regions/navigate-custom-topic.png" alt-text="Перейти к ресурсу":::
1. Убедитесь, что отображается страница **раздела сетки событий** для пользовательского раздела.   
1. Выполните действия, описанные в разделе [Маршрутизация пользовательских событий в веб-конечную точку](custom-event-quickstart-portal.md#send-an-event-to-your-topic) , чтобы отправить события в раздел. Убедитесь, что вызывается обработчик событий веб-перехватчика. 

## <a name="discard-or-clean-up"></a>Отмена или очистка
Чтобы завершить перемещение, удалите пользовательский раздел в исходном регионе.  

Если вы хотите начать заново, удалите раздел в целевом регионе и повторите действия, описанные в разделах [Подготовка](#prepare) и [Повторное создание](#recreate) этой статьи.

Чтобы удалить пользовательский раздел с помощью портал Azure, выполните следующие действия.

1. В окне поиска в верхней части портал Azure введите **разделы сетки событий** и выберите **разделы сетки событий** из результатов поиска. 
2. Выберите раздел для удаления и щелкните **Удалить** на панели инструментов. 
3. На странице Подтверждение введите имя группы ресурсов и выберите **Удалить**.  

Чтобы удалить группу ресурсов, содержащую пользовательский раздел, с помощью портал Azure:

1. В окне поиска в верхней части портал Azure введите **группы ресурсов** и выберите **группы ресурсов** из результатов поиска. 
2. Выберите группу ресурсов для удаления и щелкните **Удалить** на панели инструментов. 
3. На странице Подтверждение введите имя группы ресурсов и выберите **Удалить**.  

## <a name="next-steps"></a>Дальнейшие действия
Вы узнали, как переместить пользовательский раздел сетки событий из одного региона в другой. Сведения о перемещении системных разделов, доменов и пространств имен партнеров в регионах см. в следующих статьях.

- [Перемещение системных разделов по регионам](move-system-topics-across-regions.md). 
- [Перемещение доменов между регионами](move-domains-across-regions.md). 
- [Перемещение пространств имен партнеров между регионами](move-partner-namespaces-across-regions.md).

Дополнительные сведения о перемещении ресурсов между регионами и аварийным восстановлением в Azure см. в следующей статье: [Перемещение ресурсов в новую группу ресурсов или подписку](../azure-resource-manager/management/move-resource-group-and-subscription.md).