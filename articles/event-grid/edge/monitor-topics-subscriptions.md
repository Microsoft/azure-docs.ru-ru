---
title: Отслеживание разделов и подписок на события в службе "Сетка событий Azure" IoT Edge | Документация Майкрософт
description: Отслеживание разделов и подписок на события
ms.date: 07/08/2020
ms.topic: article
ms.openlocfilehash: d230be4f74abd61ad7b7f0fdb3facb32ee63da73
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "86171539"
---
# <a name="monitor-topics-and-event-subscriptions"></a>Отслеживание разделов и подписок на события

Сетка событий на границе предоставляет ряд метрик для разделов и подписок на события в [формате Prometheus демонстрации](https://prometheus.io/docs/instrumenting/exposition_formats/). В этой статье описаны доступные метрики и способы их включения.

## <a name="enable-metrics"></a>Включить метрики

Настройте модуль для отправки метрик, задав `metrics__reporterType` для переменной среды значение `prometheus` в параметрах создания контейнера:

 ```json
        {
          "Env": [
            "metrics__reporterType=prometheus"
          ],
          "HostConfig": {
            "PortBindings": {
              "4438/tcp": [
                {
                    "HostPort": "4438"
                }
              ]
            }
          }
        }
 ```    

Метрики будут доступны в `5888/metrics` модуле для HTTP и `4438/metrics` для HTTPS. Например, `http://<modulename>:5888/metrics?api-version=2019-01-01-preview` для HTTP. На этом этапе модуль метрик может опрашивать конечную точку для сбора метрик, как в этом [примере архитектуры](https://github.com/veyalla/ehm).

## <a name="available-metrics"></a>Доступные метрики

В разделах и подписках на события выдаются метрики, которые позволяют получить представление о доставке событий и производительности модулей.

### <a name="topic-metrics"></a>Метрики разделов

| Метрика | Описание |
| ------ | ----------- |
| евентсрецеивед | Число событий, опубликованных в разделе
| унматчедевентс | Число событий, опубликованных в разделе, которые не соответствуют подписке на события и удаляются
| сукцессрекуестс | Число входящих запросов на публикацию, полученных в разделе
| системерроррекуестс | Число входящих запросов на публикацию, не выполненных из-за внутренней системной ошибки
| усерерроррекуестс | Число входящих запросов на публикацию завершилось сбоем из-за ошибки пользователя, такой как неверно сформированный код JSON
| сукцессрекуестлатенцимс | Задержка ответа на запрос публикации в миллисекундах


### <a name="event-subscription-metrics"></a>Метрики подписки на события

| Метрика | Описание |
| ------ | ----------- |
| деливерисукцесскаунтс | Количество событий, успешно доставленных в настроенную конечную точку
| деливерифаилурекаунтс | Число событий, которые не удалось доставить в настроенную конечную точку
| деливерисукцесслатенцимс | Задержка событий, успешно доставленных в миллисекундах
| деливерифаилурелатенцимс | Задержка при сбоях доставки событий в миллисекундах
| системделайфорфирстаттемптмс | Системная задержка событий до первой попытки доставки в миллисекундах
| деливеряттемптскаунт | Число попыток доставки событий — успешных и неудачных.
| експиредкаунтс | Количество событий, срок действия которых истек и которые не были доставлены в настроенную конечную точку