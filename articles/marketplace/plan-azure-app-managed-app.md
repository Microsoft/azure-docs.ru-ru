---
title: Планирование управляемого приложения Azure для предложения приложения Azure
description: Узнайте, что необходимо для создания плана управляемого приложения для нового предложения приложения Azure с помощью портала коммерческого рынка в центре партнеров Майкрософт.
author: aarathin
ms.author: aarathin
ms.reviewer: dannyevers
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 11/06/2020
ms.openlocfilehash: 694f501efc565ed498c1c8d8e2e38326277e8605
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96621422"
---
# <a name="plan-an-azure-managed-application-for-an-azure-application-offer"></a>Планирование управляемого приложения Azure для предложения приложения Azure

План _управляемого приложения_ Azure — это один из способов публикации предложения приложения Azure в Azure Marketplace. Если вы еще не сделали этого, прочитайте статью [планирование предложения приложения Azure для коммерческого рынка](plan-azure-application-offer.md).

Управляемые приложения — это предложения Transact, которые развертываются и выставляются через Azure Marketplace. Параметр List, который видит пользователь, получает его сейчас.

Используйте приложение Azure: план управляемого приложения, если требуются следующие условия:

- Вы развернете решение на основе подписки для клиента с помощью виртуальной машины или решения на основе инфраструктуры как услуги (IaaS).
- Вам или заказчику требуется, чтобы решение управлялось партнером. Например, партнер может быть системным интегратором или управляемым поставщиком услуг (MSP).

## <a name="managed-application-offer-requirements"></a>Требования к предложению для управляемого приложения

| Требования | Сведения |
| ------------ | ------------- |
| подписка Azure; | Управляемые приложения должны быть развернуты в подписке клиента, но ими может управлять третья сторона. |
| Выставление счетов и ценообразование | Ресурсы предоставляются в подписке Azure клиента. Виртуальные машины, использующие модель оплаты по мере использования, взаимодействует с клиентом через корпорацию Майкрософт и оплачиваются через подписку Azure клиента. <br><br> Для виртуальных машин с собственной лицензией Корпорация Майкрософт выставляет счета за все ресурсы инфраструктуры, которые были включены в подписку клиента, но вы оплачиваете лицензии на программное обеспечение с клиентом напрямую. |
| Совместимый с Azure виртуальный жесткий диск (VHD) | Виртуальные машины должны быть созданы на платформе Windows или Linux. Дополнительные сведения см. в разделе:<br> • [Создайте технический ресурс виртуальной машины Azure](./azure-vm-create-certification-faq.md#address-a-vulnerability-or-an-exploit-in-a-vm-offer) (для виртуальных жестких дисков Windows).<br> •  [Дистрибутивы Linux, одобренные в Azure](../virtual-machines/linux/endorsed-distros.md) (для виртуальных жестких дисков Linux). |
| Определение потребления услуг клиентами | Все новые предложения приложений Azure также должны включать в себя GUID [определения потребления услуг Azure клиентами партнеров](azure-partner-customer-usage-attribution.md). Дополнительные сведения о соотношении использования клиентов и о том, как ее включить, см. в статье о соотношении [использования клиентов в Azure](azure-partner-customer-usage-attribution.md). |
| Пакет развертывания | Вам потребуется пакет развертывания, который позволит клиентам развернуть план. При создании нескольких планов, требующих одной и той же технической настройки, можно использовать один и тот же пакет. Дополнительные сведения см. в следующем разделе: пакет развертывания. |
|||

> [!NOTE]
> Управляемые приложения должны быть развернуты в Azure Marketplace. Если связь с клиентами является проблемой, обращайтесь к интересующим вас клиентам после включения общего доступа к интересам.

## <a name="deployment-package"></a>Пакет развертывания

Пакет развертывания содержит все файлы шаблонов, необходимые для этого плана, а также все дополнительные ресурсы, Упакованные в ZIP-файл.

Все приложения Azure должны содержать эти два файла в корневой папке ZIP-архива:

- Файл шаблона Resource Manager с именем [mainTemplate.json](../azure-resource-manager/managed-applications/publish-service-catalog-app.md?tabs=azure-powershell#create-the-arm-template). Этот шаблон определяет ресурсы для развертывания в подписке Azure клиента. Примеры шаблонов диспетчер ресурсов см. в [коллекции шаблонов](https://azure.microsoft.com/documentation/templates/) быстрого запуска Azure или в соответствующем репозитории шаблонов быстрого запуска для [GitHub: Azure Resource Manager](https://github.com/azure/azure-quickstart-templates) .
- Определение пользовательского интерфейса для процесса создания приложения Azure с именем [createUiDefinition.json](../azure-resource-manager/managed-applications/create-uidefinition-overview.md). В пользовательском интерфейсе укажите элементы, которые позволяют указать значения параметров.

Максимальный размер файлов

- До 1 ГБ при общем сжатии. Размер ZIP-архива
- До 1 ГБ для любого отдельного несжатого файла в ZIP-архиве

Все новые предложения приложений Azure также должны включать в себя GUID [определения потребления услуг Azure клиентами партнеров](azure-partner-customer-usage-attribution.md).

## <a name="azure-regions"></a>Регионы Azure

Вы можете опубликовать план в общедоступном регионе Azure, в регионе Azure для государственных организаций или в обоих регионах. Перед публикацией в регионе [Azure для государственных организаций](../azure-government/documentation-government-manage-marketplace-partners.md) протестируйте и проверьте план в среде, так как некоторые конечные точки могут отличаться. Чтобы настроить и проверить план, запросите пробную учетную запись на странице [Пробная версия Microsoft Azure для государственных организаций](https://azure.microsoft.com/global-infrastructure/government/request/).

Вы, как издатель, должны предоставить элементы управления соответствием, меры безопасности и рекомендации. Azure для государственных организаций использует физически изолированные центры обработки данных и сети (расположенные строго в США).

Список стран и регионов, поддерживаемых коммерческим магазином, см. в статье [Поддержка географической доступности и валюты](marketplace-geo-availability-currencies.md).

Службы Azure для государственных организаций обрабатывают данные, подпадающие под определенные нормы и требования государственных организаций, например FedRAMP, NIST 800,171 (DIB), ITAR, IRS 1075, DoD L4 и CJIS. Чтобы сообщить о сертификации по этим программам, можно предоставить до 100 описывающих их ссылок. Это могут быть ссылки на ваше участие в программе или ссылки на описание вашего соответствия требованиям этих программ на ваших собственных веб-сайтах. Эти ссылки видны только клиентам Azure для государственных организаций.

## <a name="choose-who-can-see-your-plan"></a>Выберите, кто может просматривать ваш план

Каждый план можно настроить как видимый для всех (открытых) или только для конкретной аудитории (частная). Можно создать до 100 планов и до 45, которые могут быть частными. Вам может потребоваться создать частный план, чтобы предложить различные варианты ценообразования или технические настройки для конкретных клиентов.

Вы предоставляете доступ к частному плану с помощью идентификаторов подписки Azure с возможностью включения описания каждого назначенного идентификатора подписки. Можно добавить не более 10 идентификаторов подписок вручную или до 10 000 идентификаторов подписок с помощью. CSV-файл. Идентификаторы подписки Azure должны быть уникальными и могут содержать только строчные буквы.

Частные планы не поддерживаются подписками Azure, установленными через торгового посредника по программе поставщика облачных решений (CSP). Дополнительные сведения см. [в разделе частные предложения в коммерческом магазине Майкрософт](private-offers.md).

> [!NOTE]
> Если вы публикуете частный план, вы можете изменить его видимость на "общий" позже. Однако после публикации общедоступного плана его видимость нельзя изменить на частный.

## <a name="define-pricing"></a>Определение цен

Для каждого плана необходимо указать цену за месяц. Эта цена предоставляется в дополнение к любой инфраструктуре Azure или тарифу с оплатой по мере использования за ресурсы, развернутые этим решением.

В дополнение к цене за месяц можно также задать цены на использование нестандартных единиц, используя [выставление счетов за потребление](partner-center-portal/azure-app-metered-billing.md). При необходимости можно установить нулевую цену за месяц и взимать плату только за потребление.

Цены задаются в долларах США (USD = США доллар), которые преобразуются в локальную валюту всех выбранных рынков, используя текущие курсы обмена при сохранении. Но вы можете задать цены клиента для каждого рынка.

## <a name="just-in-time-jit-access"></a>JIT-доступ

JIT-доступ позволяет запрашивать доступ с повышенными привилегиями к ресурсам управляемого приложения для устранения неполадок или обслуживания. Вы всегда имеете доступ к ресурсам только для чтения, но на определенный период времени у вас может быть доступ более высокого уровня. Дополнительные сведения см. в статье [Включение и запрос JIT-доступа для управляемых приложений Azure](../azure-resource-manager/managed-applications/request-just-in-time-access.md).

> [!NOTE]
> Не забудьте обновить файл `createUiDefinition.json` для поддержки этой функции.

## <a name="deployment-mode"></a>Режим развертывания

План управляемого приложения можно настроить для использования **полного** или **инкрементного** режима развертывания. В полном режиме повторное развертывание приложения клиентом приводит к удалению ресурсов в управляемой группе ресурсов, если ресурсы не определены в [mainTemplate.js](../azure-resource-manager/managed-applications/publish-service-catalog-app.md?tabs=azure-powershell#create-the-arm-template). В добавочном режиме повторное развертывание приложения оставляет существующие ресурсы без изменений. Дополнительные сведения см. в разделе [режимы развертывания Azure Resource Manager](../azure-resource-manager/templates/deployment-modes.md).

## <a name="notification-endpoint-url"></a>URL-адрес конечной точки уведомления

При необходимости можно предоставить конечную точку веб-перехватчика HTTPS для получения уведомлений обо всех операциях CRUD на экземплярах управляемого приложения плана.

## <a name="customize-allowed-customer-actions-optional"></a>Настройка разрешенных действий клиента (необязательно)

При необходимости можно указать действия, которые клиенты могут выполнять с управляемыми ресурсами в дополнение к `*/read` действиям, доступным по умолчанию.

При выборе этого параметра необходимо указать либо действия элемента управления, либо разрешенные действия с данными. Дополнительные сведения см. в статье [Описание запретов назначений для ресурсов Azure](../role-based-access-control/deny-assignments.md). Список доступных действий см. в статье [Операции поставщиков ресурсов Azure Resource Manager](../role-based-access-control/resource-provider-operations.md). Например, чтобы разрешить пользователям перезапускать виртуальные машины, добавьте `Microsoft.Compute/virtualMachines/restart/action` в перечень разрешенных действий.

## <a name="choose-who-can-manage-the-application"></a>Выберите, кто может управлять приложением

Необходимо указать, кто может управлять управляемым приложением в каждом из выбранных облаков: _общедоступное облако Azure_ и _Azure для государственных организаций_. Соберите следующие сведения:

- **Azure Active Directory идентификатор клиента** — идентификатор клиента Azure AD (также известный как идентификатор каталога), содержащий удостоверения пользователей, групп или приложений, которым вы хотите предоставить разрешения. Идентификатор клиента Azure AD можно найти на портал Azure в [свойствах для Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Properties).
- **Авторизации** — добавьте Azure Active Directory идентификатор объекта каждого пользователя, группы или приложения, которым требуется предоставить разрешение на доступ к группе управляемых ресурсов. Укажите пользователя по идентификатору субъекта, который можно найти в [колонке пользователей Azure Active Directory на портале Azure](https://portal.azure.com/#blade/Microsoft_AAD_IAM/UsersManagementMenuBlade/AllUsers).

Для каждого идентификатора участника вы свяжете одну из встроенных ролей Azure AD (владельца или участника). Выбранная роль описывает разрешения, которые участник будет иметь для ресурсов в подписке клиента. Дополнительные сведения см. в статье [Встроенные роли Azure](../role-based-access-control/built-in-roles.md). Дополнительные сведения об управлении доступом на основе ролей см. в статье [Начало работы с управлением доступом на основе ролей на портале Azure](../role-based-access-control/overview.md).

> [!NOTE]
> Хотя вы можете добавить до 100 авторизаций в каждом регионе Azure, обычно проще создать Active Directory группу пользователей и указать ее идентификатор в поле "идентификатор субъекта". Это позволяет добавить дополнительных пользователей в группу управления после развертывания плана и уменьшить потребность в обновлении плана, чтобы добавить дополнительные разрешения.

## <a name="policy-settings"></a>Параметры политики

Вы можете применить [политики Azure](../governance/policy/index.yml) к управляемому приложению, чтобы указать требования соответствия для развернутого решения. Дополнительные сведения об определении политик и формате значений параметров см. в описании [примеров политик Azure](../governance/policy/samples/index.md).

Можно настроить не более пяти политик и только один экземпляр каждого типа политики. Для некоторых типов политик требуются дополнительные параметры.

| Тип политики | Требуются параметры политики |
| ------------ | ------------- |
| Шифрование базы данных SQL Azure | Нет |
| Параметры аудита SQL Server Azure | Да |
| Шифрование Azure Data Lake Store | Нет |
| Аудит параметров диагностики | Да |
| Аудит соответствия расположения ресурсов | Нет |
|||

Для каждого добавляемого типа политики необходимо связать стандартный или бесплатный номер SKU политики. Для политик аудита допускается только номер SKU "Стандартный". Длина имен политик ограничена 50 символами.

## <a name="next-steps"></a>Дальнейшие действия

- [Создание предложения приложения Azure в коммерческом магазине](create-new-azure-apps-offer.md)
