---
title: Настройка плана управляемого приложения
description: Узнайте, как настроить план управляемого приложения для предложения приложения Azure в центре партнеров.
author: aarathin
ms.author: aarathin
ms.reviewer: dannyevers
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: how-to
ms.date: 11/06/2020
ms.openlocfilehash: a67a721b8d94112347282e1cd9be4d43f4ac85da
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96744641"
---
# <a name="configure-a-managed-application-plan"></a>Настройка плана управляемого приложения

Эта статья относится только к планам управляемых приложений для предложения приложений Azure. Если вы настраиваете план шаблона решения, перейдите к разделу [Настройка плана шаблона решения](create-new-azure-apps-offer-solution.md).

## <a name="define-markets-pricing-and-availability"></a>Определение рынков, цен и доступности

Каждый план должен быть доступен хотя бы на одном рынке. На вкладке **цены и доступность** можно настроить рынки, в которых будет доступен этот план, а также указать, следует ли сделать план видимым для всех пользователей или только для конкретных клиентов (Кроме того, он называется частным планом).

1. На странице **рынки** щелкните ссылку **изменить рынки** .
1. В появившемся диалоговом окне выберите расположения рынка, в которых необходимо сделать план доступным. Необходимо выбрать не менее одного и не более 141 рынков.

    > [!NOTE]
    > Это диалоговое окно содержит поле поиска и параметр для фильтрации только по «налоговым предъявлениям», в которых корпорация Майкрософт подставляют продажи и используют налоги от вашего имени.

1. Нажмите кнопку **сохранить**, чтобы закрыть диалоговое окно.

## <a name="define-pricing"></a>Определение цен

В поле **Цена** укажите цену за месяц для этого плана. Эта цена относится к любой инфраструктуре Azure или затратам на использование, которые были вызваны ресурсами, развернутыми этим решением.

В дополнение к цене за месяц можно также задать цены на использование нестандартных единиц, используя [выставление счетов за потребление](partner-center-portal/azure-app-metered-billing.md). При необходимости можно установить нулевую цену за месяц и взимать плату только за потребление.

Цены задаются в долларах США (USD = США доллар), которые преобразуются в локальную валюту всех выбранных рынков, используя текущие курсы обмена при сохранении. Проверяйте эти цены перед публикацией, экспортировав электронную таблицу цен и просмотрев цену на каждом рынке. Если вы хотите задать другие цены на отдельном рынке, измените и импортируйте электронную таблицу с ценами.

### <a name="add-a-custom-meter-dimension-optional"></a>Добавить пользовательское измерение измерения (необязательно)

1. В разделе **измерения службы измерений Marketplace** выберите ссылку **Добавить пользовательское измерение измерения (максимум 18)** .
1. В поле **идентификатор** введите неизменяемую ссылку на идентификатор при выдаче событий использования.
1. В поле **Отображаемое имя** введите отображаемое имя, связанное с измерением. Например, "текстовые сообщения отправлены".
1. В поле **единица измерения** введите описание единицы выставления счетов. Например, «на текст сообщения» или «за 100 сообщений».
1. В поле **Цена за единицу в долларах США** введите цену для одной единицы измерения.
1. В поле **ежемесячное количество, включаемое в базовый** введите количество (в виде целого числа) измерения, которое включается каждый месяц для клиентов, которые платят за повторяющийся месячный тариф. Чтобы установить неограниченное количество, установите флажок.
1. Чтобы добавить еще одно настраиваемое измерение измерения, повторите шаги с 1 по 7.

### <a name="set-custom-prices-optional"></a>Задание настраиваемых цен (необязательно)

Цены, заданные в долларах США (USD), переводятся в локальную валюту всех выбранных рынков по текущему курсу во время сохранения. Проверяйте эти цены перед публикацией, экспортировав электронную таблицу цен и просмотрев цену на каждом рынке. Если вы хотите задать другие цены на отдельном рынке, измените и импортируйте электронную таблицу с ценами.

Внимательно проверяйте цены перед публикацией, так как существуют некоторые ограничения на изменения после публикации плана.

> [!NOTE]
> После публикации плана цены для отдельных рынков в плане нельзя будет изменить.

Чтобы задать настраиваемые цены на отдельном рынке, экспортируйте, измените, а затем импортируйте электронную таблицу цен. Вы несете ответственность за проверку этой цены и их владельца. Подробные сведения см. в разделе [Настраиваемые цены](plans-pricing.md#custom-prices).

1. Сначала сохраните изменения в ценах, чтобы включить возможность экспорта данных о ценах. В нижней части вкладки **цены и доступность** выберите **Сохранить черновик**.
1. В разделе **цены** выберите ссылку **Экспорт данных о ценах** .
1. Откройте файл exportedPrice.xlsx в Microsoft Excel.
1. В электронной таблице внесите необходимые обновления в сведения о ценах, а затем сохраните файл.

   Может потребоваться включить редактирование в Excel перед обновлением файла.

1. На вкладке **цены и доступность** в разделе **цены** выберите ссылку **Импорт данных о ценах** .
1. В появившемся диалоговом окне нажмите кнопку **Да**.
1. Выберите обновленный файл exportedPrice.xlsx и нажмите кнопку **Открыть**.

## <a name="choose-who-can-see-your-plan"></a>Выберите, кто может просматривать ваш план

Можно настроить отображение каждого плана для всех пользователей или только для конкретной аудитории. Вы предоставляете доступ к частной аудитории с помощью идентификатора подписки Azure с возможностью включения описания каждого назначенного идентификатора подписки. Можно добавить не более 10 идентификаторов подписок вручную или до 10 000 идентификаторов подписок с помощью. CSV-файл. Идентификаторы подписки Azure должны быть уникальными и могут содержать только строчные буквы.

> [!NOTE]
> Если вы публикуете частный план, вы можете изменить его видимость на "общий" позже. Однако после публикации общедоступного плана его видимость нельзя изменить на частный.

В разделе **видимость плана** выполните одно из следующих действий.

- Чтобы сделать план общедоступным, нажмите кнопку **Общий** параметр (также называемый _переключателем_).
- Чтобы сделать план частным, выберите переключатель **частный** , а затем добавьте идентификаторы подписок Azure вручную или CSV-файл.

> [!NOTE]
> Частная или ограниченная аудитория отличается от аудитории предварительной версии, заданной на вкладке **Предварительная версия**. Аудитория предварительной версии может получить доступ к вашему предложению до его публикации в Marketplace. Несмотря на то что выбор частной аудитории относится только к определенному плану, аудитория предварительной версии может просматривать все планы (частные и общедоступные) в целях проверки.

### <a name="manually-add-azure-subscription-ids-for-a-private-plan"></a>Добавление идентификаторов подписок Azure в частный план вручную

1. В разделе **видимость плана** выберите переключатель **закрыто** .
1. В появившемся поле **идентификатор подписки Azure** введите идентификатор подписки Azure для аудитории, которой вы хотите предоставить доступ к этому частному плану. Требуется по меньшей мере один идентификатор подписки.
1. Используемых Введите описание этой аудитории в поле **Описание** .
1. Чтобы добавить другой идентификатор подписки, щелкните ссылку **добавить идентификатор (Max 10)** и повторите шаги 2 и 3.

### <a name="use-a-csv-file-to-add-azure-subscription-ids-for-a-private-plan"></a>Используйте. CSV-файл для добавления идентификаторов подписок Azure для частного плана

1. В разделе **видимость плана** выберите переключатель **закрыто** .
1. Выберите ссылку **экспортировать аудиторию (CSV)** .
1. Откройте. CSV-файл и добавьте идентификаторы подписок Azure, которым вы хотите предоставить доступ к частному предложению, в столбец **идентификаторов** .
1. При необходимости введите описание для каждой аудитории в столбце **Описание** .
1. Добавьте "SubscriptionId" в столбец **типа** для каждой строки с идентификатором подписки.
1. Сохраните. CSV-файл.
1. На вкладке **доступность** в разделе **видимость плана** выберите ссылку **Импорт аудитории (CSV)** .
1. В появившемся диалоговом окне выберите **Да**.
1. Выберите. CSV-файл и нажмите кнопку **Открыть**. Появится сообщение, указывающее, что. Импорт CSV-файла успешно выполнен.

## <a name="define-the-technical-configuration"></a>Определение технической конфигурации

На вкладке **Техническая конфигурация** вы загрузите пакет развертывания, который позволит клиентам развернуть план и предоставить номер версии для пакета. Кроме того, вы можете получить другие технические сведения.

> [!NOTE]
> Эта вкладка не будет видна, если вы решили повторно использовать пакеты из другого плана на вкладке " **Настройка плана** ". Если да, перейдите к разделу [Просмотр планов](#view-your-plans).

### <a name="assign-a-version-number-for-the-package"></a>Назначение номера версии для пакета

В поле **версия** укажите текущую версию технической конфигурации. Увеличивайте эту версию каждый раз при публикации изменений на этой странице. Номер версии должен быть в формате "целое число. целое число. целое число". Например, `1.0.2`.

### <a name="upload-a-package-file"></a>Отправка файла пакета

В разделе **файл пакета (ZIP)** перетащите файл пакета на серый ящик или выберите ссылку **Обзор файлов** .

> [!NOTE]
> Если при отправке файлов возникнет проблема, убедитесь, что ваша локальная сеть не блокирует службу `https://upload.xboxlive.com`, которую использует Центр партнеров.

#### <a name="previously-published-packages"></a>Ранее опубликованные пакеты

На вкладке **Ранее опубликованные пакеты** можно просматривать все опубликованные версии технической конфигурации.

### <a name="enable-just-in-time-jit-access-optional"></a>Включить JIT-доступ (необязательно)

Чтобы включить JIT-доступ для этого плана, установите флажок **включить доступ** JIT. Если требуется, чтобы пользователи управляемого приложения предоставили постоянный доступ для вашей учетной записи, не устанавливайте этот флажок. Дополнительные сведения об этом параметре см. в разделе JIT- [доступ](plan-azure-app-managed-app.md#just-in-time-jit-access).

### <a name="select-a-deployment-mode"></a>Выбор режима развертывания

Выберите режим **полного** или **добавочного** развертывания.

- В **полном** режиме повторное развертывание приложения клиентом приведет к удалению ресурсов в управляемой группе ресурсов, если ресурсы не определены в [mainTemplate.js](../azure-resource-manager/managed-applications/publish-service-catalog-app.md?tabs=azure-powershell#create-the-arm-template).
- В **инкрементном** режиме повторное развертывание приложения оставляет существующие ресурсы без изменений.

Дополнительные сведения о режимах развертывания см. в разделе [Режимы развертывания Azure Resource Manager](../azure-resource-manager/templates/deployment-modes.md).

### <a name="provide-a-notification-endpoint-url"></a>Указание URL-адреса конечной точки уведомления

В поле **URL конечной точки уведомления** укажите конечную точку веб-перехватчика HTTPS для получения уведомлений обо всех операциях CRUD в экземплярах управляемых приложений этой версии плана.

### <a name="customize-allowed-customer-actions-optional"></a>Настройка разрешенных действий клиента (необязательно)

1. Чтобы указать, какие действия клиенты могут выполнять с управляемыми ресурсами в дополнение к `*/read` действиям "", доступным по умолчанию, установите флажок **настроить разрешенные действия для клиентов** .
1. В появившихся полях укажите дополнительные управляющие действия и допустимые действия с данными, которые вы хотите включить для клиента, разделяя их точкой с запятой. Например, чтобы разрешить пользователям перезапускать виртуальные машины, добавьте `Microsoft.Compute/virtualMachines/restart/action` в поле **разрешенные действия управления** .

### <a name="choose-who-can-manage-the-application"></a>Выберите, кто может управлять приложением

Укажите, кто должен иметь доступ на управление для этого управляемого приложения в каждом выбранном регионе Azure: _глобальное облако Azure_ и _Azure для государственных организаций_. Удостоверения Azure AD будут использоваться для идентификации пользователей, групп или приложений, которым требуется предоставить разрешение на доступ к управляемой группе ресурсов. Дополнительные сведения см. в статье [планирование управляемого приложения Azure для предложения приложения Azure](plan-azure-application-offer.md).

Выполните следующие действия для глобальной облачной службы Azure и Azure для государственных организаций.

1. В поле **идентификатор клиента Azure Active Directory** введите идентификатор клиента Azure AD (также известный как идентификатор каталога), содержащий удостоверения пользователей, групп или приложений, которым требуется предоставить разрешения.
1. В поле **идентификатор участника** укажите идентификатор объекта Azure AD для пользователя, группы или приложения, которым будет предоставлено разрешение на доступ к управляемой группе ресурсов. Выясните пользователя по ИДЕНТИФИКАТОРу участника, который можно найти в [колонке Azure Active Directory пользователи](https://portal.azure.com/#blade/Microsoft_AAD_IAM/UsersManagementMenuBlade/AllUsers) в портал Azure.
1. В списке **Определение роли** выберите встроенную роль Azure AD. Выбранная роль описывает разрешения, которые участник будет иметь для ресурсов в подписке клиента.
1. Чтобы добавить еще одну авторизацию, щелкните ссылку **добавить авторизацию (max 100)** и повторите шаги с 1 по 3.

### <a name="policy-settings-optional"></a>Параметры политики (необязательно)

Можно настроить не более пяти политик и только один экземпляр каждой политики. Некоторые политики требуют дополнительных параметров.

1. В разделе **Параметры политики** щелкните ссылку **+ Добавить политику (Max 5)** .
1. В поле **имя** введите имя назначения политики (не более 50 символов).
1. В списке **политики** выберите политику Azure, которая будет применяться к ресурсам, созданным управляемым приложением в подписке клиента.
1. В поле **Параметры политики** укажите параметр, в соответствии с которым должны применяться политики аудита и настройки диагностики.
1. В списке **номер SKU политики** выберите тип SKU политики.

    > [!NOTE]
    > Для политик аудита требуется номер SKU _стандартной политики_ .

## <a name="view-your-plans"></a>Просмотр планов

- Выберите **Сохранить черновик**, а затем в верхнем левом углу страницы выберите **Общие сведения о плане** , чтобы вернуться на страницу **обзора плана** .

После создания одного или нескольких планов вы увидите имя плана, идентификатор плана, тип плана, доступность (открытый или частный), текущее состояние публикации и все доступные действия на вкладке **Обзор плана** .

Действия, доступные в столбце **действие** вкладки **Обзор плана** , зависят от состояния плана и могут включать следующее:

- Если план имеет состояние **черновик**, ссылка в столбце Action ( **действие** ) будет иметь значение **Delete черновик**.
- Если состояние плана — " **динамический**", ссылка в столбце " **действие** " будет либо **прервать продажа плана** , либо **синхронизировать личную аудиторию**. Ссылка на **личную аудиторию синхронизации** будет публиковать только изменения в вашей частной аудитории без публикации других обновлений, которые могли быть внесены в предложение.
- Чтобы создать другой план для этого предложения, в верхней части вкладки **Обзор плана** выберите **+ создать новый план**. Затем повторите действия, описанные в статье [Создание планов для предложения приложения Azure](create-new-azure-apps-offer-plans.md). В противном случае, если вы готовы создать планы, перейдите к следующему разделу: дальнейшие действия.

## <a name="next-steps"></a>Дальнейшие действия

- [Как протестировать и опубликовать предложение приложения Azure](create-new-azure-apps-offer-test-publish.md).
- Узнайте, [как продать предложение приложения Azure](create-new-azure-apps-offer-marketing.md) через совместную продажу с корпорацией Майкрософт и пропродавать программы CSP.