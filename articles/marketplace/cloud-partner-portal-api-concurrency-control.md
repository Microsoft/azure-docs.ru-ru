---
title: Управление параллелизмом — Azure Marketplace
description: Стратегии управления параллелизмом для API-интерфейсов публикации на портале Cloud Partner.
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: reference
author: mingshen-ms
ms.author: mingshen
ms.date: 07/14/2020
ms.openlocfilehash: e468898daffe8fc42250575d3efa42f99279c410
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "88031654"
---
# <a name="concurrency-control"></a>Управление параллелизмом

> [!NOTE]
> Портал Cloud Partner API интегрированы с и будут продолжать работать в центре партнеров. Переход содержит небольшие изменения. Ознакомьтесь с изменениями, приведенными в [справочнике по портал Cloud Partner API](./cloud-partner-portal-api-overview.md) , чтобы убедиться, что код продолжит работать после перехода в центр партнеров. API-интерфейсы CPP следует использовать только для существующих продуктов, которые уже были интегрированы до перехода в центр партнеров. новые продукты должны использовать API-интерфейсы отправки центра партнеров.

При каждом вызове API-интерфейсов публикации на портале Cloud Partner необходимо явно указать, какую стратегию управления параллелизмом использовать. Если заголовок **If-Match** не предоставлен, это приведет к появлению сообщения об ошибке HTTP 400. Мы предлагаем две стратегии для управления параллелизмом.

-   **Оптимистичный**. Клиент, выполняющий обновления, проверяет, не изменились ли данные с момента последнего чтения данных.
-   **Приоритет последнего**. Клиент непосредственно обновляет данные, независимо от изменений, внесенных другим приложением с момента последнего чтения.

<a name="optimistic-concurrency-workflow"></a>Рабочий процесс оптимистичного параллелизма
-------------------------------

Стратегию оптимистичного параллелизма рекомендуется использовать, чтобы гарантировано избежать непредвиденных изменений ресурсов.

1.  Получите сущность с помощью API-интерфейсов. Ответ содержит значение ETag, которое определяет текущую хранимую версию сущности (во время ответа).
2.  Во время обновления добавьте это значение ETag в обязательный заголовок запроса **If-Match**.
3.  API сравнивает значение ETag, полученное в запросе с текущим значением ETag сущности в атомарной транзакции.
    *   Если значения ETag не совпадают, API возвращает ответ HTTP `412 Precondition Failed`. Эта ошибка означает, что другой процесс выполнил обновление сущности с момента его последнего получения клиента или что в запросе указано неверное значение ETag.
    *  Если значения ETag совпадают, или заголовок **If-Match** содержит подстановочный символ звездочки (`*`), API выполняет запрошенную операцию. Операция API также обновляет хранимое значение ETag сущности.


> [!NOTE]
> Если указать подстановочный знак (*) в заголовке **If-Match**, API будет использовать стратегию параллелизма "Приоритет последнего". В этом случае сравнение значений ETag не происходит и ресурс обновляется без каких-либо проверок. 
