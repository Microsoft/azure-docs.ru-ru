---
title: Выставление счетов за использование управляемых приложений с помощью службы измерения Marketplace | Azure Marketplace
description: Эта документация представляет собой руководство для независимых поставщиков программного обеспечения, публикующих приложения Azure с гибкими моделями выставления счетов.
ms.service: marketplace
ms.subservice: partnercenter-marketplace-publisher
ms.topic: conceptual
ms.date: 04/22/2020
ms.author: mingshen
author: mingshen-ms
ms.openlocfilehash: d015cec30e516541b50c2acfac38fad898965e1b
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96436357"
---
# <a name="managed-application-metered-billing"></a>Выставленный счет за контролируемое приложение 

С помощью службы измерения Marketplace вы можете создавать планы управляемых приложений для предложений приложений Azure, которые начисляются в соответствии с нестандартными единицами. Перед публикацией этого предложения необходимо определить такие измерения выставления счетов, как пропускная способность, билеты или сообщения электронной почты. Клиенты затем платят в соответствии с их потреблением.  Ваша система сообщит корпорации Майкрософт через API-интерфейс службы измерения рынка для оплаты событий по мере их возникновения.

## <a name="prerequisites-for-metered-billing"></a>Предварительные требования для тарифного счета

Чтобы план управляемого приложения мог использовать тарифный счет, он должен:

* Соблюдайте все требования к предложению, описанные в подокне [Создание предложения приложения Azure](../create-new-azure-apps-offer.md).
* Настройте **цены** за оплату клиентов на ежемесячную стоимость службы. Цена может быть равна нулю, если вы не хотите платить за фиксированную плату и использовать ее полностью при оплате.
* Установите **измерения выставления счетов** за события контроля использования, которые клиент будет платить поверх фиксированной ставки.
* Интеграция с [API-интерфейсами службы измерения Marketplace](./marketplace-metering-service-apis.md) для информирования Майкрософт о оплачиваемых событиях.

## <a name="how-metered-billing-fits-in-with-pricing"></a>Как взимается плата за использование с учетом цен

Когда дело доходит до определения предложения вместе с его моделями ценообразования, важно понимать иерархию предложений.

* Каждое предложение приложения Azure может иметь шаблон решения или планы управляемых приложений.
* Расчет с оплатой реализован только с планами управляемых приложений.
* С каждым планом управляемого приложения связана модель ценообразования. 
* Модель ценообразования имеет месячную повторяющуюся плату, которая может иметь значение $0.
* Помимо повторяющейся платы, план может также включать дополнительные измерения, используемые для оплаты за использование, не включенные в фиксированную ставку. Каждое измерение представляет оплачиваемую единицу, которую служба будет обмениваться данными с корпорацией Майкрософт с помощью [API службы измерения Marketplace](marketplace-metering-service-apis.md).

## <a name="sample-offer"></a>Пример предложения

Например, contoso — это издатель с управляемой службой приложений с именем Contoso Analytics (CoA). CoA позволяет клиентам анализировать большой объем данных для создания отчетов и хранения данных. Contoso регистрируется как издатель в центре партнеров, чтобы программа коммерческого рынка опубликовала предложения для клиентов Azure. С сертификатом подлинности связаны два плана, описанные ниже:

* Базовый план
    * Анализ 100 ГБ и создание отчетов 100 в течение $0 в месяц
    * Свыше 100 ГБ, платите $10 за каждые 1 ГБ
    * За пределами отчетов 100 оплачивается $1 для каждого отчета.
* План "Премиум"
    * Анализ 1000 ГБ и создание отчетов 1000 в течение %350 в месяц
    * Свыше 1000 ГБ, платите $100 за каждые 1 ТБ
    * За пределами отчетов 1000 оплачивается $0,5 для каждого отчета.

Клиент Azure, подписавшийся на службу CoA, может анализировать и создавать отчеты в месяц на основе выбранного плана. Компания Contoso измеряет использование до входящего количества без отправки каких бы то ни было событий использования в корпорацию Майкрософт. Когда клиенты потребляют больше, чем количество входящих, не нужно изменять планы или выполнять какие-либо другие действия. Компания Contoso будет измерять превышение по сравнению с включенным количеством и приступить к передаче событий использования в корпорацию Майкрософт для дополнительного использования с помощью [API службы измерения Marketplace](./marketplace-metering-service-apis.md). Корпорация Майкрософт, в свою очередь, будет взимать плату за дополнительное использование, указанную издателем.

## <a name="billing-dimensions"></a>Измерения выставления счетов

Измерения выставления счетов используются для обмена данными с клиентом о том, как будут выставляться счета за использование программного обеспечения.  Эти измерения также используются для передачи событий использования в корпорацию Майкрософт. Они определяются следующим образом:

* **Идентификатор измерения**: неизменяемый идентификатор, на который указывает ссылка при выдаче событий использования.
* **Имя измерения**: отображаемое имя, связанное с измерением, например "Отправленные текстовые сообщения".
* **Единица измерения**: Описание единицы оплаты, например "на текстовое сообщение" или "за 100 сообщений электронной почты".
* **Цена за единицу**: Цена за одну единицу измерения.
* **Включаемое количество для ежемесячного выражения**: количество измерений, включаемых в месяц для клиентов, которые платите за период ежегодной ежемесячной оплаты, должно быть целым числом.

Измерения выставления счетов совместно используются во всех планах предложения. Некоторые атрибуты применяются к измерению во всех планах, а другие атрибуты зависят от плана.

Атрибуты, определяющие само измерение, совместно используются во всех планах предложения. Перед публикацией предложения изменения, внесенные в эти атрибуты из контекста любого плана, повлияют на определение измерения во всех планах. После публикации предложения эти атрибуты больше не будут доступны для изменения. Атрибуты:

* Идентификатор
* Имя
* Единица измерения

Другие атрибуты измерения относятся к каждому плану и могут иметь разные значения из плана планирования.  Перед публикацией плана можно изменить эти значения, и только этот план будет затронуты. После публикации плана эти атрибуты больше не будут доступны для изменения. Атрибуты:

* Цена за единицу
* Включаемое количество для ежемесячных клиентов 
* Включаемое количество для ежегодных клиентов 

Измерения также имеют два специальных понятия: «включено» и «бесконечное».

* **Включено** указывает, что этот план участвует в этом измерении.  Если вы создаете новый план, который не отправляет события использования на основе этого измерения, вы можете оставить этот параметр непроверенным. Кроме того, все новые измерения, добавленные после первоначальной публикации плана, будут отображаться как "не включено" для уже опубликованного плана.  Отключенное измерение не будет отображаться ни в одном списке измерений для плана, видимого для клиентов.
* **Бесконечное** значение, представленное символом бесконечности "∞", указывает, что этот план участвует в этом измерении без лимитного использования в этом измерении. Если вы хотите сообщить клиентам, что функции, представленные этим измерением, включены в план, но без ограничения на использование.  Измерение с бесконечным использованием будет отображаться в списках измерений для плана, видимого для клиентов.  Этот план никогда не будет взиматься.

>[!Note] 
>Следующие сценарии поддерживаются явно:  <br> — Можно добавить новое измерение в новый план.  Новое измерение не будет включено для всех уже опубликованных планов. <br> — Вы можете опубликовать план с фиксированной ежемесячной платой и без каких-либо измерений, добавить новый план и настроить новое измерение для этого плана. Новое измерение не будет включено для уже опубликованных планов.

## <a name="constraints"></a>Ограничения

### <a name="locking-behavior"></a>Режим блокировки

Измерение, используемое в службе измерения Marketplace, представляет Понимание того, как клиент будет платить за службу.  После публикации предложения все сведения об измерении больше не могут быть изменены.  Перед публикацией предложения важно, чтобы измерения были полностью определены.

После публикации предложения с измерением сведения на уровне предложения для этого измерения больше не могут быть изменены:

* Идентификатор
* Имя
* Единица измерения

После публикации плана сведения на уровне плана больше не могут быть изменены:

* Цена за единицу
* Включаемое количество для ежемесячного выражения
* Включено ли измерение для плана

>[!Note]
>Использование службы измерения Marketplace еще не поддерживается в облаке Azure для государственных организаций.

### <a name="upper-limits"></a>Верхние пределы

Максимальное число измерений, которое можно настроить для одного предложения, составляет 30 уникальных измерений.

## <a name="get-support"></a>Получение поддержки

При наличии одной из следующих проблем можно открыть запрос в службу поддержки.

* Технические проблемы с API службы измерения Marketplace.
* Проблема, которая должна быть передана из-за ошибки или ошибки на стороне пользователя (например, неверное событие использования.)
* Другие проблемы, связанные с лимитным выставленным счетом.

Следуйте инструкциям в [технической поддержке программы коммерческого рынка в центре партнеров](../support.md) , чтобы ознакомиться с вариантами поддержки издателя и открыть запрос в службу поддержки корпорации Майкрософт.

## <a name="next-steps"></a>Дальнейшие действия

- Дополнительные сведения см. в статье [API-интерфейсы службы измерения Marketplace](./marketplace-metering-service-apis.md) .
