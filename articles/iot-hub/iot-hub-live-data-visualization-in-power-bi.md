---
title: Визуализация данных в режиме реального времени из центра Интернета вещей Azure — Power BI
description: Сведения о визуализации данных о температуре и влажности, собранных с датчиков и переданных в Центр Интернета вещей Azure, с помощью Power BI.
author: robinsh
keywords: визуализация данных, полученных в реальном времени, визуализация интерактивных данных, визуализация данных датчиков
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.tgt_pltfrm: arduino
ms.date: 6/08/2020
ms.author: robinsh
ms.openlocfilehash: 82caf13618fe8483ab8d3a622c6c0d51ab05a206
ms.sourcegitcommit: 24a12d4692c4a4c97f6e31a5fbda971695c4cd68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102177340"
---
# <a name="visualize-real-time-sensor-data-from-azure-iot-hub-using-power-bi"></a>Визуализация данных, поступающих от датчиков в реальном времени, из Центра Интернета вещей с помощью Power BI

![Комплексная схема](./media/iot-hub-live-data-visualization-in-power-bi/end-to-end-diagram.png)

[!INCLUDE [iot-hub-get-started-note](../../includes/iot-hub-get-started-note.md)]

## <a name="what-you-learn"></a>Что вы узнаете

Вы узнаете, как с помощью Power BI визуализировать данные, которые в реальном времени поступают с датчиков в Центр Интернета вещей Azure. Если вы хотите визуализировать данные в центре Интернета вещей с помощью веб-приложения, см. статью [Использование веб-приложения для визуализации данных датчика в реальном времени из центра Интернета вещей Azure](iot-hub-live-data-visualization-in-web-apps.md).

## <a name="what-you-do"></a>Что нужно сделать

* добавим группу потребителей, чтобы обеспечить доступ к данным в Центре Интернета вещей;

* Создать, настроить и запустить задание Stream Analytics, чтобы передавать данные из центра Интернета вещей в учетную запись Power BI.

* Создать отчет Power BI и опубликовать его, чтобы визуализировать данные.

## <a name="what-you-need"></a>Необходимые элементы

* Пройдите одно из руководств по [использованию симулятора Raspberry Pi в подключенном режиме](iot-hub-raspberry-pi-web-simulator-get-started.md), например [Подключение онлайн-симулятора Raspberry Pi к Центру Интернета вещей Azure (Node.js)](iot-hub-raspberry-pi-kit-node-get-started.md). В этих статьях рассматриваются следующие требования:
  
  * Активная подписка Azure.
  * Центр Интернета вещей Azure в подписке;
  * клиентское приложение, которое отправляет сообщения в Центр Интернета вещей Azure.

* Учетная запись Power BI. ([Попробуйте Power BI бесплатно](https://powerbi.microsoft.com/))

[!INCLUDE [iot-hub-get-started-create-consumer-group](../../includes/iot-hub-get-started-create-consumer-group.md)]

## <a name="create-configure-and-run-a-stream-analytics-job"></a>Создание, настройка и выполнение заданий Stream Analytics

Сначала давайте создадим задание Stream Analytics. После этого мы определим входные и выходные данные, а также запрос на получение данных.

### <a name="create-a-stream-analytics-job"></a>Создание задания Stream Analytics

1. На [портале Azure](https://portal.azure.com) последовательно выберите **Создать ресурс** > **Интернет вещей** > **Задание Stream Analytics**.

2. Введите представленные ниже сведения для задания.

   **Имя задания.** Имя задания. Оно должно быть глобально уникальным.

   **Группа ресурсов.** Выберите ту же группу ресурсов, которую использует центр Интернета вещей.

   **Расположение.** Выберите то же расположение, которое использует группа ресурсов.

   ![Создание задания Stream Analytics в Azure](./media/iot-hub-live-data-visualization-in-power-bi/create-stream-analytics-job.png)

3. Нажмите кнопку **создания**.

### <a name="add-an-input-to-the-stream-analytics-job"></a>Добавление входных данных в задание Stream Analytics

1. Откройте задание Stream Analytics.

2. В разделе **Топология задания** выберите **Входные данные**.

3. В области **входные данные** выберите **добавить потоковый вход**, а затем в раскрывающемся списке выберите **центр Интернета вещей** . На новой панели ввода введите следующие сведения.

   **Входной псевдоним**: введите уникальный псевдоним для входных данных.

   **Выберите центр Интернета вещей в своей подписке**: Выберите этот переключатель.

   **Подписка**: Выберите подписку Azure, используемую в этом руководстве.

   **Центр Интернета вещей**. Выберите центр Интернета вещей, который вы используете для работы с этим руководством.

   **Конечная точка**. Выберите **Сообщения**.

   **Имя политики общего доступа**: выберите имя политики общего доступа, которую должно использовать Stream Analytics задание для центра Интернета вещей. Для работы с этим руководством можно выбрать пункт *Служба*. Политика *службы* по умолчанию создается в новых центрах Интернета вещей и предоставляет разрешение на отправку и получение конечных точек облака, предоставляемых Центром Интернета вещей. Дополнительные сведения см. в разделе [Управление доступом и разрешения](iot-hub-devguide-security.md#access-control-and-permissions).

   **Ключ политики общего доступа**: это поле заполняется автоматически в зависимости от выбора для имени политики общего доступа.

   **Группа потребителей**. Выберите созданную ранее группу потребителей.

   Оставьте значения по умолчанию для всех остальных полей.

   ![Добавление входных данных в задание Stream Analytics в Azure](./media/iot-hub-live-data-visualization-in-power-bi/add-input-to-stream-analytics-job.png)

4. Щелкните **Сохранить**.

### <a name="add-an-output-to-the-stream-analytics-job"></a>Добавление выходных данных в задание Stream Analytics

1. В разделе **Топология задания** выберите **Выходные данные**.

2. В области **выходные данные** выберите **Добавить** и **Power BI**.

3. На панели **вывода Power BI-New** выберите **авторизовать** и следуйте инструкциям на экране, чтобы войти в учетную запись Power BI.

4. После входа в Power BI введите следующие сведения:

   **Выходной псевдоним**: уникальный псевдоним для выходных данных.

   **Рабочая область группы**: выберите рабочую область целевой группы.

   **Имя набора данных**: введите имя набора данных.

   **Имя таблицы**: введите имя таблицы.

   **Режим проверки подлинности**. Оставьте значение по умолчанию.

   ![Добавление выходных данных в задание Stream Analytics в Azure](./media/iot-hub-live-data-visualization-in-power-bi/add-output-to-stream-analytics-job.png)

5. Щелкните **Сохранить**.

### <a name="configure-the-query-of-the-stream-analytics-job"></a>Настройка запроса задания Stream Analytics

1. В разделе **Топология задания** выберите **Запрос**.

2. Замените значение `[YourInputAlias]` значением псевдонима входных данных задания.

3. Замените значение `[YourOutputAlias]` значением псевдонима выходных данных задания.

   ![Добавление запроса в задание Stream Analytics в Azure](./media/iot-hub-live-data-visualization-in-power-bi/add-query-to-stream-analytics-job.png)

4. Выберите **Сохранить запрос**.

### <a name="run-the-stream-analytics-job"></a>Выполнение задания Stream Analytics

В Stream Analytics задание выберите **Обзор**, а затем выберите **начать**  >  **сейчас**  >  . После успешного запуска состояние задания **Остановлено** изменится на **Выполняется**.

![Выполнение задания Stream Analytics в Azure](./media/iot-hub-live-data-visualization-in-power-bi/run-stream-analytics-job.png)

## <a name="create-and-publish-a-power-bi-report-to-visualize-the-data"></a>Создание отчета Power BI и его публикация для визуализации данных

Ниже описано, как создать и опубликовать отчет с помощью служба Power BI. Если вы хотите использовать "новый вид" в Power BI, можно выполнить эти действия с некоторыми изменениями. Чтобы понять различия и переходить к разделу "новый вид", см. раздел ["новый вид" служба Power BI](/power-bi/consumer/service-new-look).

1. Убедитесь, что пример приложения запущен на устройстве. Если нет, вы можете обратиться к руководствам в статье [Подключение Raspberry Pi к Центру Интернета вещей Azure (Node.js)](./iot-hub-raspberry-pi-kit-node-get-started.md).

2. Выполните вход в учетную запись [Power BI](https://powerbi.microsoft.com/en-us/).

3. Выберите используемую рабочую область " **Моя рабочая область**".

4. Щелкните **Наборы данных**.

   Вы должны увидеть набор данных, указанный при создании выходных данных для задания Stream Analytics.

5. Для созданного набора данных выберите **Добавить отчет** (первый значок справа от имени набора данных).

   ![Создание отчета Microsoft Power BI](./media/iot-hub-live-data-visualization-in-power-bi/power-bi-create-report.png)

6. Создайте график для отображения данных температуры в реальном времени за определенный период времени.

   1. В области **визуализации** страницы Создание отчета щелкните значок графика, чтобы добавить график.

   2. В области **Поля** разверните таблицу, указанную при создании выходных данных для задания Stream Analytics.

   3. Перетащите элемент **EventEnqueuedUtcTime** на **ось** в области **Визуализации**.

   4. Перетащите элемент **температура** в раздел **Значения** той же области.

      График создан. Ось Х отображает дату и время в часовом поясе UTC. Ось Y отображает данные температуры, полученные от датчика.

      ![Добавление графика данных температуры в отчет Microsoft Power BI](./media/iot-hub-live-data-visualization-in-power-bi/power-bi-add-temperature.png)

7. Создайте другой график для отображения влажности в реальном времени за определенный период времени. Для этого щелкните пустую часть холста и выполните те же действия, чтобы поместить **то есть eventenqueuedutctime** на ось x и **влажности** по оси y.

   ![Добавление графика данных влажности в отчет Microsoft Power BI](./media/iot-hub-live-data-visualization-in-power-bi/power-bi-add-humidity.png)

8. Щелкните **Сохранить**, чтобы сохранить запрос.

9. Выберите **отчеты** на левой панели, а затем выберите только что созданный отчет.

10. Выберите **файл**  >  **опубликовать в Интернете**.

    ![Выберите Опубликовать в Интернете для отчета Microsoft Power BI](./media/iot-hub-live-data-visualization-in-power-bi/power-bi-select-publish-to-web.png)

    > [!NOTE]
    > Если вы получите уведомление для связи с администратором, чтобы включить создание кода внедрения, вам может потребоваться обратиться к ним. Для выполнения этого шага необходимо включить создание кода внедрения.
    >
    > ![Обратитесь к уведомлению администратора](./media/iot-hub-live-data-visualization-in-power-bi/contact-admin.png)

11. Выберите **создать код внедрения**, а затем нажмите кнопку **опубликовать**.

Вы указали ссылку на отчет, которую можно предоставить всем пользователям для доступа к отчету, и фрагмент кода, который можно использовать для интеграции отчета в блог или на веб-сайт.

![Публикация отчета Microsoft Power BI](./media/iot-hub-live-data-visualization-in-power-bi/power-bi-web-output.png)

Корпорация Майкрософт также предлагает [мобильные приложения Power BI](https://powerbi.microsoft.com/en-us/documentation/powerbi-power-bi-apps-for-mobile-devices/) для просмотра информационных панелей и отчетов Power BI, а также взаимодействия с ними.

## <a name="next-steps"></a>Дальнейшие действия

Вы успешно использовали Power BI для визуализации данных, полученных от датчика в режиме реального времени, из Центра Интернета вещей Azure.

Еще один способ визуализации данных из центра Интернета вещей Azure см. в статье [Использование веб-приложения для визуализации данных датчика в реальном времени из центра Интернета вещей Azure](iot-hub-live-data-visualization-in-web-apps.md).

[!INCLUDE [iot-hub-get-started-next-steps](../../includes/iot-hub-get-started-next-steps.md)]
