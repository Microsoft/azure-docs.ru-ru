---
title: Рекомендации по настройке устройств для Центра Интернета вещей | Документация Майкрософт
description: Узнайте о рекомендациях по использованию автоматического управления устройствами для уменьшения количества повторяющихся и сложных задач, связанных с управлением устройствами IoT в масштабе.
author: robinsh
ms.author: robinsh
ms.date: 06/28/2019
ms.topic: conceptual
ms.service: iot-hub
services: iot-hub
ms.openlocfilehash: 8a39c2b06ca8a0f852891acb60ba199fc2c6db5c
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96024135"
---
# <a name="best-practices-for-device-configuration-within-an-iot-solution"></a>Рекомендации по настройке устройств в рамках решения Интернета вещей

Автоматическое управление устройствами в Центре Интернета вещей Azure позволяет автоматизировать многие повторяющиеся и сложные задачи управления для большого количества устройств на протяжении их жизненного цикла. В этой статье описаны многие из лучших методик для различных ролей, связанных с разработкой и использованием решений Интернета вещей.

* **Изготовитель или интегратор оборудования Интернета вещей.** Это изготовители оборудования Интернета вещей, интеграторы оборудования, которые собирают оборудование различных изготовителей, или поставщики оборудования, которые предоставляют оборудование для развертывания Интернета вещей, изготовленное или интегрированное другими поставщиками. Участие в разработке и интеграции встроенных программ, встроенных операционных систем и программного обеспечения.

* **Разработчик решений IOT:** Разработка решения IoT обычно выполняется разработчиком решения. Этот разработчик может входить в команду внутри компании или быть системным интегратором, специализирующимся на данной деятельности. Разработчик решений Интернета вещей может с нуля разработать различные компоненты решения Интернета вещей, интегрировать разные стандарты или компоненты с открытым кодом и настраивать [ускоритель решений Центра Интернета вещей](../iot-accelerators/index.yml).

* **Оператор решения IOT:** После развертывания решения IoT требуется долгосрочные операции, мониторинг, обновление и обслуживание. Эти задачи может выполнять команда внутри компании, в которую входят специалисты по информационным технологиям, группы по эксплуатации и обслуживанию оборудования, а также специалисты в определенной области, которые следят за работой всей инфраструктуры Интернета вещей.

## <a name="understand-automatic-device-management-for-configuring-iot-devices-at-scale"></a>Понимание автоматического управления устройством для настройки устройств Интернета вещей в масштабе

Автоматическое управление устройством включает в себя множество преимуществ, связанных с [двойниками устройств](iot-hub-devguide-device-twins.md) и [двойниками модулей](iot-hub-devguide-module-twins.md), для синхронизации требуемых и сообщаемых состояний между облаком и устройствами. [Автоматическая конфигурация устройств](./iot-hub-automatic-device-management.md) автоматически обновляет большие наборы двойников и суммирует ход выполнения и соответствие. Ниже приведены основные действия по разработке и использованию автоматического управления устройствами.

* **Производитель или интегратор аппаратного обеспечения Интернета вещей** реализует функции управления устройствами во встроенном приложении с использованием [двойников устройств](iot-hub-devguide-device-twins.md). Эти функции могут включать в себя обновления встроенного ПО, установку и обновление программного обеспечения и управление настройками.

* **Разработчик решения Интернета вещей** реализует уровень управления операций администрирования устройства с помощью [двойников устройств](iot-hub-devguide-device-twins.md) и [автоматических конфигураций устройств](./iot-hub-automatic-device-management.md). Решение должно включать определение интерфейса оператора для выполнения задач управления устройством.

* **Оператор решения Интернета вещей** использует решение Интернета вещей для выполнения задач управления устройством, в частности для группирования устройств, инициирования изменений конфигурации, таких как обновления встроенного ПО, отслеживание хода выполнения и устранение возникающих проблем.

## <a name="iot-hardware-manufacturerintegrator"></a>Производитель или интегратор оборудования IoT

Ниже приведены лучшие методики для производителей и интеграторов оборудования, занимающихся разработкой встроенных программ.

* **Реализация [двойников устройств](iot-hub-devguide-device-twins.md).** Двойники устройств позволяют синхронизировать желаемую конфигурацию из облака и сообщать текущую конфигурацию и свойства устройства. Лучший способ реализовать двойники устройств во встроенных приложениях — использовать [пакеты SDK для Azure IoT](https://github.com/Azure/azure-iot-sdks). Двойники устройств лучше всего подходят для конфигурации, потому что они:

    * поддерживают двунаправленную связь;
    * разрешают как подключенные, так и отключенные состояния устройств;
    * следуют принципу итоговой согласованности;
    * полностью запрашиваемые в облаке.

* **Структурирование двойника устройства для управления устройством.** Двойник устройства должен быть структурирован таким образом, чтобы свойства управления устройством были логически сгруппированы в разделы. В этом случае изменения конфигурации могут быть изолированы, не влияя на другие части двойника. Например, создайте раздел в пределах требуемых свойств для встроенного ПО, второй раздел для программного обеспечения и третий раздел для сетевых параметров. 

* **Сообщение атрибутов устройства, которые полезны для управления устройством.** Атрибуты, такие как сборка и модель физического устройства, встроенное ПО, операционная система, серийный номер и другие идентификаторы, полезны для отчетов и в качестве параметров для изменений конфигурации.

* **Определение основных состояний для отправки отчетов о состоянии и процессе выполнения.** Должны быть перечислены состояния верхнего уровня, чтобы их можно было сообщить оператору. Например, при обновлении встроенного ПО может сообщаться состояние "Текущее", "Загрузка", "Применение", "Выполняется" или "Ошибка". Определите дополнительные поля для получения сведений о каждом состоянии.

## <a name="iot-solution-developer"></a>Разработчик решений IoT

Ниже перечислены рекомендации для разработчиков решений Интернета вещей, которые создают системы на основе Azure.

* **Реализация [двойников устройств](iot-hub-devguide-device-twins.md).** Двойники устройств позволяют синхронизировать желаемую конфигурацию из облака и сообщать текущую конфигурацию и свойства устройства. Лучший способ реализовать двойники устройств в облачных решениях — использовать [пакеты SDK для Azure IoT](https://github.com/Azure/azure-iot-sdks). Двойники устройств лучше всего подходят для конфигурации, потому что они:

    * поддерживают двунаправленную связь;
    * разрешают как подключенные, так и отключенные состояния устройств;
    * следуют принципу итоговой согласованности;
    * полностью запрашиваемые в облаке.

* **Организация устройств с помощью тегов двойников устройств.** Решение должно позволить оператору определять качественные круги или другие наборы устройств на основе различных стратегий развертывания, таких как ранний выпуск. Организация устройств может быть реализована в решении с использованием тегов двойников устройств и [запросов](iot-hub-devguide-query-language.md). Организация устройств необходима для обеспечения надежной и точной настройки развертывания конфигурации.

* **Реализация [автоматических конфигураций устройств](./iot-hub-automatic-device-management.md).** Автоматические конфигурации устройств развертывают и отслеживают изменения конфигурации в больших наборах устройств Интернета вещей с использованием двойников устройств.

   Автоматические конфигурации устройств определяют наборы двойников устройств с помощью **целевого состояния**, которое является запросом к тегам двойников устройств или сообщаемым свойствам. **Целевое содержимое** — это набор требуемых свойств, который будет установлен в указанных двойниках устройств. Целевое содержимое должно соответствовать структуре двойников устройств, определяемой изготовителем оборудования Центра Интернета вещей или интегратором. **Метрики** — это запросы к сообщаемым свойствам двойникаа устройства, которые также должны быть согласованы с структурой двойникаа устройства, определенной изготовителем или интегратором оборудования IOT.

   Автоматические конфигурации устройств запускаются в первый раз вскоре после создания конфигурации, а затем с интервалом в пять минут. Они также получают преимущества от центра Интернета вещей, выполняющего операции двойникаи устройств, с частотой, которая никогда не превысит [пределы регулирования](iot-hub-devguide-quotas-throttling.md) для операций чтения и обновления двойникаа устройства.

* **Использование [службы подготовки устройств](../iot-dps/how-to-manage-enrollments.md).** Разработчикам решений необходимо использовать службу подготовки устройств для назначения тегов двойников устройств новым устройствам, чтобы они автоматически настраивались с помощью **автоматических конфигураций устройств**, предназначенных для двойников с этим тегом. 

## <a name="iot-solution-operator"></a>Оператор решений IoT

Ниже приведены лучшие методики для операторов решений Интернета вещей, которые используют решение Интернета вещей на основе Azure.

* **Организация устройств для управления.** Решение Интернета вещей должно определять или разрешать создание качественных кругов или других наборов устройств на основе различных стратегий развертывания, таких как ранний выпуск. Наборы устройств будут использоваться для развертывания изменений конфигурации и выполнения других операций управления масштабируемыми устройствами.

* **Выполнение изменений конфигурации с использованием поэтапного развертывания.** Поэтапное развертывание — это общий процесс, с помощью которого оператор развертывает изменения в расширенном наборе устройств Интернета вещей. Цель этого развертывания — постепенно вносить изменения, чтобы уменьшить риск глобальных критических изменений.  Оператору необходимо использовать интерфейс решения для создания [автоматической конфигурации устройств](./iot-hub-automatic-device-management.md), а условие назначения должно быть нацелено на исходный набор устройств (например, группа раннего выпуска). Затем оператор должен проверить изменение конфигурации в исходном наборе устройств.

   После завершения проверки оператор обновит автоматическую конфигурацию устройства, чтобы включить в нее более широкий набор устройств. Оператор также должен установить более высокий приоритет для этой конфигурации, чем у других конфигураций, предназначенных для этих устройств. Развертыванием можно управлять, используя метрики, сообщаемые автоматической конфигурацией устройства.

* **Выполнение откатов в случае ошибок или неправильных конфигураций.** Автоматическую конфигурацию устройства, которая вызывает ошибки или неправильные конфигурации, можно отменить, изменив **условие назначения**, чтобы устройства больше не соответствовали ему. Убедитесь, что другая конфигурация устройства с более низким приоритетом по-прежнему предназначена для этих устройств. Убедитесь, что откат удался, просмотрев метрики. Конфигурация отката не должна отображать состояние нецелевых устройств, а метрики второй конфигурации теперь должны включать количество устройств, которые продолжают быть целевыми.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о реализации двойников устройств см. в статье [Общие сведения о двойниках устройств и их использование в Центре Интернета вещей](iot-hub-devguide-device-twins.md).

* Дополнительные сведения о создании, обновлении и удалении автоматической конфигурации устройства см. в статье [Настройка и мониторинг устройств Центра Интернета вещей в масштабе (предварительная версия)](./iot-hub-automatic-device-management.md).

* Сведения о реализации шаблона обновления встроенного ПО с использованием двойников устройств и автоматических конфигураций устройств см. в статье [Руководство по реализации процесса обновления встроенного ПО устройств](tutorial-firmware-update.md).