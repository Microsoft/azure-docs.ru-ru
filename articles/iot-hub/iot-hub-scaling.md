---
title: Масштабирование Центра Интернета вещей в Azure | Документация Майкрософт
description: Масштабирование Центра Интернета вещей для поддержки ожидаемой пропускной способности сообщений и необходимых компонентов. Эта статья содержит сводку по поддерживаемой пропускной способности для каждого уровня и параметров сегментирования.
author: wesmc7777
manager: timlt
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 06/28/2019
ms.author: wesmc
ms.custom:
- amqp
- mqtt
- 'Role: Cloud Development'
- 'Role: Operations'
ms.openlocfilehash: cdb792198e6912fb0e68b2abec052c2b05166f17
ms.sourcegitcommit: b4fbb7a6a0aa93656e8dd29979786069eca567dc
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2021
ms.locfileid: "107310127"
---
# <a name="choose-the-right-iot-hub-tier-for-your-solution"></a>Выбор правильного уровня Центра Интернета вещей для решения

Все решения Интернета вещей различны, поэтому Центр Интернета вещей предлагает несколько вариантов, основанных на ценах и масштабе. Эта статья предназначена для оценки потребностей вашего Центра Интернета вещей. Сведения о ценах на уровни Центра Интернета вещей см. на [этой странице](https://azure.microsoft.com/pricing/details/iot-hub).

Чтобы решить, какой уровень Центра Интернета вещей подходит для решения, задайте себе два вопроса:

**Какие функции планируется использовать?**

Центр Интернета вещей предлагает два уровня — "Базовый" и "Стандартный", которые отличаются количеством поддерживаемых компонентов. Если в основе решения Интернета вещей лежит сбор данных с устройств и их централизованный анализ, тогда вам подойдет уровень "Базовый". Если вам необходимо использовать более сложные конфигурации для управления устройствами Центра Интернета вещей удаленно или распределить часть рабочих нагрузок на сами устройства, тогда следует рассмотреть возможность использования уровня "Стандартный". Подробный разбор компонентов, которые включены в каждый уровень, см. в разделе [Уровни "Базовый" и "Стандартный"](#basic-and-standard-tiers).

**Какой объем данных планируется перемещать ежедневно?**

Каждый уровень Центра Интернета вещей доступен в трех размерах на основе пропускной способности данных, которую он может обрабатывать каждый день. Эти размеры численно обозначены как 1, 2 и 3. Например, каждая единица Центра Интернета вещей 1-го уровня может обработать 400 тысяч сообщений в день, тогда как единица 3-го уровня может обработать 300 миллионов. Дополнительные сведения о рекомендациях по данным см. в разделе [Пропускная способность сообщений](#message-throughput).

## <a name="basic-and-standard-tiers"></a>Уровни "Базовый" и "Стандартный"

Уровень "Стандартный" Центра Интернета вещей включает все компоненты и необходим для любых решений Интернета вещей, где предполагается использование возможностей двухсторонней связи. Уровень "Базовый" включает подмножество компонентов и предназначен для решений Интернета вещей, которым требуется только однонаправленная связь с устройствами в облаке. Оба уровня предоставляют одинаковые компоненты безопасности и аутентификации.

В пределах уровня для Центра Интернета вещей можно выбрать только один тип [выпуска](https://azure.microsoft.com/pricing/details/iot-hub/). Например, можно создать Центр Интернета вещей с несколькими единицами уровня S1, но не с комбинацией единиц из разных выпусков, например S1 и S2.

| Функция | Уровень Basic | Уровень "Бесплатный"/"Стандартный" |
| ---------- | ---------- | ------------- |
| [Телеметрия "С устройства в облако"](iot-hub-devguide-messaging.md) | Да | Да |
| [Удостоверение для каждого устройства](iot-hub-devguide-identity-registry.md) | Да | Да |
| [Маршрутизация сообщений](iot-hub-devguide-messages-read-custom.md), [обогащение сообщений](iot-hub-message-enrichments-overview.md) и [интеграция службы "Сетка событий"](iot-hub-event-grid.md) | Да | Да |
| [Протоколы HTTP, AMQP и MQTT](iot-hub-devguide-protocols.md) | Да | Да |
| [Служба подготовки устройств](../iot-dps/about-iot-dps.md) | Да | Да |
| [Мониторинг и диагностика](monitor-iot-hub.md) | Да | Да |
| [Передача сообщений из облака на устройство](iot-hub-devguide-c2d-guidance.md) |   | Да |
| [Двойники устройств](iot-hub-devguide-device-twins.md), [двойники модулей](iot-hub-devguide-module-twins.md) и [управление устройствами](iot-hub-device-management-overview.md) |   | Да |
| [Потоки устройств (предварительная версия)](iot-hub-device-streams-overview.md) |   | Да |
| [Azure IoT Edge](../iot-edge/about-iot-edge.md) |   | Да |
| статье об [IoT Plug and Play](../iot-pnp/overview-iot-plug-and-play.md). |   | Да |

Центр Интернета вещей также предлагает уровень "Бесплатный", который предназначен для тестирования и оценки. Он обладает всеми возможностями уровня "Стандартный", но ограничен квотами на сообщения. С уровня "Бесплатный" нельзя обновиться до уровня "Базовый" или "Стандартный".

## <a name="partitions"></a>Секции

Центры Интернета вещей Azure содержат несколько основных компонентов [Центров событий Azure](../event-hubs/event-hubs-features.md), включая [секции](../event-hubs/event-hubs-features.md#partitions). Потоки событий для Центров Интернета вещей обычно заполняются входящими данными телеметрии, которые сообщают различные устройства Интернета вещей. Секционирование потока событий используется для сокращения конфликтов, возникающих при одновременном считывании потоков событий и записи в эти потоки.

При создании Центра Интернета вещей выбирается ограничение секции, и его нельзя изменить. Максимальное ограничение на количество секций для Центра Интернета вещей уровней "Базовый" и "Стандартный" составляет 32. Для большинства центров Интернета вещей достаточно четырех секций. Дополнительные сведения об определении секций см. в разделе часто задаваемых вопросов о Центрах событий Azure [Сколько секций мне нужно?](../event-hubs/event-hubs-faq.yml#how-many-partitions-do-i-need-)

## <a name="tier-upgrade"></a>Обновление уровня

После создания Интернета вещей уровень "Базовый" можно обновить до уровня "Стандартный", не прерывая имеющихся операций. Дополнительные сведения см. в статье [Как обновить Центр Интернета вещей](iot-hub-upgrade.md).

Конфигурация секции сохраняется при переходе с уровня "Базовый" на уровень "Стандартный".

> [!NOTE]
> Уровень "Бесплатный" не поддерживает обновление до уровня "Базовый" или "Стандартный".

## <a name="iot-hub-rest-apis"></a>Интерфейсы REST API для Центра Интернета вещей

Разница в поддерживаемых возможностях между Центрами Интернета вещей уровня "Базовый" и "Стандартный" означает, что некоторые вызовы API не работают с концентраторами уровня "Базовый". В следующей таблице показаны доступные API:

| API | Уровень Basic | Уровень "Бесплатный"/"Стандартный" |
| --- | ---------- | ------------- |
| [Удаление устройства](/javascript/api/azure-iot-digitaltwins-service/registrymanager#deletedevice-string--models-registrymanagerdeletedeviceoptionalparams-) | Да | Да |
| [Получение устройства](/azure/iot-hub/iot-c-sdk-ref/iothub-registrymanager-h/iothubregistrymanager-getdevice) | Да | Да |
| [Удаление модуля](/azure/iot-hub/iot-c-sdk-ref/iothub-registrymanager-h/iothubregistrymanager-deletemodule) | Да | Да |
| [Получение модуля](/java/api/com.microsoft.azure.sdk.iot.service.registrymanager.getmodule) | Да | Да |
| [Получение статистики реестра](/javascript/api/azure-iot-digitaltwins-service/registrymanager#getdevicestatistics-msrest-requestoptionsbase-) | Да | Да |
| [Получение статистики службы](/javascript/api/azure-iot-digitaltwins-service/registrymanager#getservicestatistics-msrest-requestoptionsbase-) | Да | Да |
| [Создание или обновление устройства](/javascript/api/azure-iot-digitaltwins-service/registrymanager#createorupdatedevice-string--device--servicecallback-device--) | Да | Да |
| [Создание или обновление модуля](/javascript/api/azure-iot-digitaltwins-service/registrymanager#createorupdatemodule-string--string--module--models-registrymanagercreateorupdatemoduleoptionalparams-) | Да | Да |
| [Отправка запроса в Центр Интернета вещей](/dotnet/api/microsoft.azure.devices.registrymanager) | Да | Да |
| [Создание URI SAS отправки файла](/rest/api/iothub/device/createfileuploadsasuri) | Да | Да |
| [Получение связанного с устройством уведомления](/rest/api/iothub/device/receivedeviceboundnotification) | Да | Да |
| [Отправка события устройства](/rest/api/iothub/device/senddeviceevent) | Да | Да |
| Отправка события модуля | Только AMQP и MQTT | Только AMQP и MQTT |
| [Обновление состояния отправки устройства](/rest/api/iothub/device/updatefileuploadstatus) | Да | Да |
| [Массовые операции устройств](/javascript/api/azure-iot-digitaltwins-service/registrymanager#bulkdevicecrud-exportimportdevice----msrest-requestoptionsbase-) | Да, за исключением возможностей IoT Edge | Да |
| [Отмена задания импорта и экспорта](/rest/api/iothub/service/jobs/cancelimportexportjob) | Да | Да |
| [Создание задания импорта и экспорта](/rest/api/iothub/service/jobs/createimportexportjob) | Да | Да |
| [Получение задания импорта и экспорта](/rest/api/iothub/service/jobs/getimportexportjob) | Да | Да |
| [Получение заданий импорта и экспорта](/rest/api/iothub/service/jobs/getimportexportjobs) | Да | Да |
| [Очистка очереди команд](/javascript/api/azure-iot-digitaltwins-service/registrymanager#purgecommandqueue-string--msrest-requestoptionsbase-) |   | Да |
| [Получение двойника устройства](/java/api/com.microsoft.azure.sdk.iot.device.deviceclient.getdevicetwin) |   | Да |
| [Получение двойника модуля](/azure/iot-hub/iot-c-sdk-ref/iothub-devicetwin-h/iothubdevicetwin-getmoduletwin) |   | Да |
| [Вызов метода устройства](./iot-hub-devguide-direct-methods.md) |   | Да |
| [Обновление двойников устройств](./iot-hub-devguide-device-twins.md) |   | Да |
| [Обновление двойника модуля](/azure/iot-hub/iot-c-sdk-ref/iothub-devicetwin-h/iothubdevicetwin-updatemoduletwin) |   | Да |
| [Отказ от связанного с устройством уведомления](/rest/api/iothub/device/abandondeviceboundnotification) |   | Да |
| [Полное связанное с устройством уведомление](/rest/api/iothub/device/completedeviceboundnotification) |   | Да |
| [Отмена задания](/rest/api/media/jobs/canceljob) |   | Да |
| [Создание задания](/rest/api/media/jobs/create) |   | Да |
| [Получение задания](/java/api/com.microsoft.azure.sdk.iot.service.jobs.jobclient.getjob) |   | Да |
| [Запрос заданий](/javascript/api/azure-iot-digitaltwins-service/jobclient#queryjobs-jobclientqueryjobsoptionalparams--servicecallback-queryresult--) |   | Да |

## <a name="message-throughput"></a>Пропускная способность сообщений

Лучший способ определить размер решения Центра Интернета вещей — оценить трафик в пересчете на одну единицу. В частности, необходимо учитывать требования к пиковой пропускной способности для таких категорий операций:

* Отправка сообщений с устройства в облако
* Получение сообщений из облака на устройство
* операции с реестром удостоверений.

Трафик в центре Интернета вещей измеряется в пересчете на одну единицу. При создании центра Интернета вещей вы выбираете его уровень и выпуск, а также устанавливаете количество доступных единиц. Вы можете приобрести до 200 единиц для выпуска B1, B2, S1 или S2 или до 10 единиц для выпуска B3 или S3. После создания центра Интернета вещей можно изменить количество единиц, доступных в выпуске, перейти на более высокую или низкую категорию в пределах своего уровня (с B1 на B2) или перейти с уровня "Базовый" на уровень "Стандартный" (от B1 до S1), не прерывая существующие операции. Дополнительные сведения см. в статье [Как обновить Центр Интернета вещей](iot-hub-upgrade.md).  

В качестве примера возможностей трафика каждого уровня для сообщений, передаваемых с устройства в облако, следует соблюдать такие правила.

| Выпуск уровня | Непрерывная пропускная способность | Непрерывная скорость отправки |
| --- | --- | --- |
| B1, S1 |До 1111 КБ/мин на единицу<br/>(1,5 ГБ/день на единицу) |В среднем 278 сообщений/мин на единицу<br/>(400 000 сообщений/день на единицу) |
| B2, S2 |До 16 МБ/мин на единицу<br/>(22,8 ГБ/день на единицу) |В среднем 4167 сообщений/мин на единицу<br/>(6 миллионов сообщений/день на единицу) |
| B3, S3 |До 814 МБ/мин на единицу<br/>(1144,4 ГБ/день на единицу). |В среднем 208 333 сообщения/мин на единицу<br/>(300 млн сообщений/день на единицу). |

Пропускная способность передачи данных с устройства в облако является только одной из метрик, которые необходимо учитывать при проектировании решения IoT. Полные сведения см. в разделе о [квотах и регулировании Центра Интернета вещей](iot-hub-devguide-quotas-throttling.md).

### <a name="identity-registry-operation-throughput"></a>Пропускная способность для операций с реестром удостоверений

Операции с реестром удостоверений Центра Интернета вещей не должны выполняться в среде выполнения, так как они в основном связаны с подготовкой устройств.

Конкретные показатели пиковой пропускной способности см. в документе [Квоты и ограничения Центра Интернета вещей](iot-hub-devguide-quotas-throttling.md).

## <a name="auto-scale"></a>Автомасштабирование

Если вы приближаетесь к ограничению на количество разрешенных сообщений в Центре Интернета вещей, выполните [эти действия для автоматического масштабирования](https://azure.microsoft.com/resources/samples/iot-hub-dotnet-autoscale/), чтобы увеличить единицы Центра Интернета вещей на этом же уровне.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о возможностях Центра Интернета вещей и производительности см. на странице [Цены на Центр Интернета вещей](https://azure.microsoft.com/pricing/details/iot-hub) и в статье [Квоты и регулирование в Центре Интернета вещей](iot-hub-devguide-quotas-throttling.md).

* Чтобы изменить уровень Центра Интернета вещей, выполните действия, описанные в статье [Как обновить Центр Интернета вещей](iot-hub-upgrade.md).