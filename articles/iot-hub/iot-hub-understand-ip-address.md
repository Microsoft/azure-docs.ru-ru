---
title: Основные сведения об IP-адресе центра Интернета вещей | Документация Майкрософт
description: Узнайте, как выполнять запросы к IP-адресу центра Интернета вещей и его свойствам. IP-адрес центра Интернета вещей можно изменять в определенных сценариях, таких как аварийное восстановление или региональная отработка отказа.
author: philmea
ms.author: philmea
ms.service: iot-hub
services: iot-hub
ms.topic: conceptual
ms.date: 11/21/2019
ms.openlocfilehash: 1bfae8c7afbfdc6e73dd8bb17b94e6543361e9ce
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "83848234"
---
# <a name="iot-hub-ip-addresses"></a>IP-адреса центра Интернета вещей

Префиксы IP-адресов общедоступных конечных точек центра Интернета вещей периодически публикуются в [теге службы](../virtual-network/service-tags-overview.md)_AzureIoTHub_.

> [!NOTE]
> Для устройств, развернутых в локальных сетях, центр Интернета вещей Azure поддерживает интеграцию подключения к виртуальной сети с частными конечными точками. Дополнительные сведения см. в статье [Поддержка центра Интернета вещей для виртуальной сети](./virtual-network-support.md).


Эти префиксы IP-адресов можно использовать для управления подключением между центром Интернета вещей и устройствами или сетевыми ресурсами, чтобы реализовать различные цели сетевой изоляции.

| Цель | Применимые сценарии | Подход |
|------|-----------|----------|
| Обеспечить взаимодействие устройств и служб только с конечными точками центра Интернета вещей | Обмен сообщениями [с устройства в облако](./iot-hub-devguide-messaging.md) и [из облака на устройство](./iot-hub-devguide-messages-c2d.md), [прямые методы](./iot-hub-devguide-direct-methods.md), [двойники устройства и модуля](./iot-hub-devguide-device-twins.md), [потоки устройств](./iot-hub-device-streams-overview.md) | Используйте теги службы _AzureIoTHub_ и _EventHub_, а также префиксы IP-адресов концентратора событий, и соответствующим образом настройте правила разрешения для этих префиксов IP-адресов в параметрах брандмауэра для устройств и служб, чтобы обнаружить центр Интернета вещей. Запретите трафик на другие IP-адреса назначения, с которыми устройства или службы не должны взаимодействовать. |
| Обеспечить подключение конечной точки устройства центра Интернета вещей только от ваших устройств и сетевых ресурсов | Обмен сообщениями [с устройства в облако](./iot-hub-devguide-messaging.md) и [из облака на устройство](./iot-hub-devguide-messages-c2d.md), [прямые методы](./iot-hub-devguide-direct-methods.md), [двойники устройства и модуля](./iot-hub-devguide-device-twins.md), [потоки устройств](./iot-hub-device-streams-overview.md) | Используйте возможность [IP-фильтра](iot-hub-ip-filtering.md) центра Интернета вещей, чтобы разрешить подключения с устройств и IP-адресов сетевых ресурсов (см. раздел [Ограничения](#limitations-and-workarounds)). | 
| Обеспечить доступность ресурсов пользовательской конечной точки маршрутов (учетные записи хранения, служебная шина и концентраторы событий) только из ваших сетевых ресурсов | [Маршрутизация сообщений](./iot-hub-devguide-messages-d2c.md) | Следуйте указаниям по ограничению подключения (например, с помощью [правил брандмауэра](../storage/common/storage-network-security.md), [частных каналов](../private-link/private-endpoint-overview.md) или [конечных точек службы](../virtual-network/virtual-network-service-endpoints-overview.md)). Используйте теги службы _AzureIoTHub_, чтобы обнаружить префиксы IP-адреса центра Интернета вещей, и добавьте правила разрешения для этих IP-префиксов в конфигурацию брандмауэра ресурса (см. раздел [Ограничения](#limitations-and-workarounds)). |



## <a name="best-practices"></a>Рекомендации

* При добавлении правил разрешения в конфигурацию брандмауэра устройств мы рекомендуем предоставлять определенные [порты, используемые соответствующими протоколами](./iot-hub-devguide-protocols.md#port-numbers).

* Префиксы IP-адреса центра Интернета вещей могут изменяться. Прежде чем вступить в действие, эти изменения периодически публикуются посредством тегов службы. Поэтому важно разработать процессы, чтобы регулярно получать и использовать последние версии тегов службы. Такой процесс можно автоматизировать с помощью [API обнаружения тегов службы](../virtual-network/service-tags-overview.md#service-tags-on-premises). Обратите внимание на то, что API обнаружения тегов службы пока находится на этапе предварительной версии и в некоторых случаях может не создавать полный список тегов и IP-адресов. До момента выхода общедоступной версии API обнаружения рассмотрите возможность использования тегов службы [в загружаемом формате JSON](../virtual-network/service-tags-overview.md#discover-service-tags-by-using-downloadable-json-files). 

* Используйте тег *AzureIoTHub.[имя региона]* , чтобы обозначить IP-префиксы, используемые конечными точками центра Интернета вещей в определенном регионе. Чтобы обеспечить аварийное восстановление центра обработки данных или [региональную отработку отказа](iot-hub-ha-dr.md), убедитесь, что доступна возможность подключения к IP-префиксам в регионе геосвязи центра Интернета вещей.

* Настройка правил брандмауэра в центре Интернета вещей может блокировать подключение, необходимое для выполнения команд Azure CLI и PowerShell для центра Интернета вещей. Чтобы избежать этого, можно добавить правила разрешения для префиксов IP-адресов клиентов, повторно предоставив клиентам Azure CLI или PowerShell возможность взаимодействия с центром Интернета вещей.  


## <a name="limitations-and-workarounds"></a>Ограничения и обходные решения

* Функция IP-фильтрации центра Интернета вещей имеет ограничение в 10 правил. Это ограничение можно изменить, создав запрос в службу поддержки клиентов Azure. 

* Настроенные [правила IP-фильтрации](iot-hub-ip-filtering.md) можно применять только к конечным точкам IP-адресов центра Интернета вещей, а не к встроенной конечной точке концентратора событий центра Интернета вещей. Если также требуется, чтобы IP-фильтрация применялась к концентратору событий, где хранятся сообщения, вы можете предоставить собственный ресурс концентратора событий, где напрямую можно настроить нужные правила IP-фильтрации. Для этого необходимо предоставить собственный ресурс концентратора событий и настроить [маршрутизацию сообщений](./iot-hub-devguide-messages-d2c.md). Вы сможете отправлять сообщения в этот ресурс вместо встроенного концентратора событий центра Интернета вещей. И наконец, как описано в таблице выше, чтобы включить функции маршрутизации сообщений, необходимо также разрешить подключение из префиксов IP-адреса центра Интернета вещей к ресурсу подготовленного концентратора событий.

* При маршрутизации к учетной записи хранения разрешить трафик из префиксов IP-адреса центра Интернета вещей можно только в том случае, если учетная запись хранения находится в том же регионе, что и центр Интернета вещей.

## <a name="support-for-ipv6"></a>Поддержка протокола IPv6 

Сейчас протокол IPv6 не поддерживается в центре Интернета вещей.
