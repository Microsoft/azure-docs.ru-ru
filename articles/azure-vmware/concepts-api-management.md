---
title: Основные понятия — управление API
description: Узнайте, как служба управления API защищает интерфейсы API, выполняющиеся на виртуальных машинах Azure VMware (ВМ).
ms.topic: conceptual
ms.date: 10/27/2020
ms.openlocfilehash: 958cc52c48d1121a69dca2fc901289ad1ed671cb
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94541969"
---
# <a name="api-management-to-publish-and-protect-apis-running-on-azure-vmware-solution-based-vms"></a>Управление API для публикации и защиты интерфейсов API, выполняющихся на виртуальных машинах Azure VMware

Microsoft Azure [управления API](https://azure.microsoft.com/services/api-management/) позволяет обеспечить безопасную публикацию для внутренних или внешних потребителей.  Только SKU для разработчиков и Premium позволяют использовать интеграцию виртуальной сети Azure для публикации интерфейсов API, выполняющихся в рабочих нагрузках решения Azure VMware.  Оба номера SKU безопасно обеспечивают подключение между службой управления API и серверной частью. 

>[!NOTE]
>SKU для разработчиков предназначен для разработки и тестирования, а SKU Premium — для рабочих развертываний.

Конфигурация управления API одинакова для серверных служб, работающих на виртуальных машинах Azure VMware (ВМ) и локальных. Для обоих развертываний служба управления API настраивает виртуальный IP-адрес (VIP) в подсистеме балансировки нагрузки в качестве конечной точки серверной части, когда внутренний сервер помещается за НСКС Load Balancer в решении Azure VMware. 


## <a name="external-deployment"></a>Внешнее развертывание

Внешнее развертывание публикует API, используемые внешними пользователями, с помощью общедоступной конечной точки. Разработчики и инженеры DevOps могут управлять API с помощью портал Azure или PowerShell, а также портала разработчика управления API.

На схеме внешнего развертывания показан весь процесс и участвующие субъекты (показаны в верхней части). Субъекты:

- **Администраторы:** Представляет группу администраторов или DevOps, которая управляет решением VMware для Azure с помощью портал Azure и механизмов автоматизации, таких как PowerShell или Azure DevOps.

- **Пользователи:**  Представляет предоставляемых API-потребителей и представляет пользователей и службы, использующие API-интерфейсы.

Поток трафика проходит через экземпляр управления API, который абстрагирует внутренние службы, подключенные к виртуальной сети концентратора. Шлюз ExpressRoute направляет трафик в канал ExpressRoute Global Reach и достиг НСКС Load Balancer распределяет входящий трафик на различные экземпляры серверных служб.

Служба управления API имеет общедоступный API Azure и активирует службу Azure от атак DDoS Protection. 

:::image type="content" source="media/api-management/external-deployment.png" alt-text="Внешнее развертывание — управление API для решения VMware для Azure":::


## <a name="internal-deployment"></a>Внутреннее развертывание

Внутреннее развертывание публикует интерфейсы API, используемые внутренними пользователями или системами. Разработчики DevOps команды и API используют те же средства управления и портал разработчика, что и во внешнем развертывании.

Внутренние развертывания можно выполнить [с помощью шлюза приложений Azure](../api-management/api-management-howto-integrate-internal-vnet-appgateway.md) , чтобы создать общедоступную и безопасную конечную точку для API.  Возможности шлюза используются для создания гибридного развертывания, позволяющего выполнять различные сценарии.  

* Используйте один и тот же ресурс управления API для использования как внутренними, так и внешними потребителями.

* Наличие одного ресурса управления API с подмножеством интерфейсов API, определенных и доступных для внешних потребителей.

* Предоставляют простой способ переключения доступа к управлению API из общедоступного Интернета.

На схеме развертывания ниже показаны потребители, которые могут быть внутренними или внешними, с каждым типом доступа к одному или разным интерфейсам API.

Во внутреннем развертывании API-интерфейсы доступны для одного экземпляра управления API. Перед управлением API шлюз приложений развертывается с активированной функцией брандмауэра веб-приложения Azure (WAF). Также развернут, набор прослушивателей и правил HTTP для фильтрации трафика, предоставляя только подмножество серверных служб, работающих в решении VMware для Azure.


* Внутренний трафик перенаправляется через шлюз ExpressRoute в брандмауэр Azure, а затем в службу управления API, напрямую или через правила трафика.   

* Внешний трафик входит в Azure через шлюз приложений, который использует внешний уровень защиты для управления API.


:::image type="content" source="media/api-management/internal-deployment.png" alt-text="Внутреннее развертывание — управление API для решения VMware для Azure" lightbox="media/api-management/internal-deployment.png":::