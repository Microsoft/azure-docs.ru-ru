---
title: Краткое руководство. Изучение примера сценария
titleSuffix: Azure Digital Twins
description: Краткое руководство. Использование примера Azure Digital Twins Explorer для визуализации и изучения предварительно созданного сценария.
author: baanders
ms.author: baanders
ms.date: 9/24/2020
ms.topic: quickstart
ms.service: digital-twins
ms.openlocfilehash: f1b25b853977b3a1f4871e232a562d6a3cfd2fae
ms.sourcegitcommit: ba676927b1a8acd7c30708144e201f63ce89021d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/07/2021
ms.locfileid: "102434208"
---
# <a name="quickstart---explore-a-sample-azure-digital-twins-scenario-using-azure-digital-twins-explorer"></a>Краткое руководство. Изучение примера сценария Azure Digital Twins с помощью Azure Digital Twins Explorer

С помощью Azure Digital Twins можно создавать модели реальных сред и взаимодействовать с ними. Сначала вы выполните моделирование отдельных элементов в виде *цифровых двойников*. Затем вы подключите их к *графу* знаний, который умеет реагировать на события в реальном времени и отвечать на запросы информации.

С помощью этого краткого руководства вы изучите предварительно созданный граф Azure Digital Twins на примере приложения, которое называется [Azure Digital Twins Explorer](/samples/azure-samples/digital-twins-explorer/digital-twins-explorer/). С помощью Azure Digital Twins Explorer можно выполнять следующие операции:

- отправка цифрового представления среды;
- просмотр визуальных отображений цифровых двойников и графа, которые создаются как представление среды в Azure Digital Twins;
- другие действия по управлению через браузерный визуальный интерфейс.

Краткое руководство содержит следующие основные шаги.

1. Настройка экземпляра Azure Digital Twins и Azure Digital Twins Explorer.
1. Отправка предварительно построенных моделей и данных графа для создания примера сценария.
1. Изучение созданного графа сценария.
1. Внесение изменений в граф.

Пример графа, с которым вы будете работать, представляет собой здание с двумя этажами и двумя комнатами. Этот граф будет выглядеть так:

:::image type="content" source="media/quickstart-adt-explorer/graph-view-full.png" alt-text="Представление графа, состоящее из четырех узлов (в виде кругов), соединенных стрелками. Стрелка с меткой contains соединяет круг с меткой Floor1 и круг с меткой Room1. Стрелка с меткой contains соединяет круг с меткой Floor0 и круг с меткой Room0. Узлы Floor1 и Floor0 не соединены друг с другом.":::

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим кратким руководством вам требуется подписка Azure. Если у вас его еще нет, [создайте его бесплатно](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) прямо сейчас.

Вам также потребуется **Node.js** на компьютере. Последнюю версию Node.js можно получить [здесь](https://nodejs.org/).

Наконец, вам нужно скачать пример для использования с этим кратким руководством. Используйте пример приложения **Azure Digital Twins Explorer**. Этот пример содержит приложение, с помощью которого вы загрузите и изучите сценарий Azure Digital Twins. Он также содержит файлы для примера сценария. Этот пример можно получить на странице [Azure Digital Twins Explorer](/samples/azure-samples/digital-twins-explorer/digital-twins-explorer/). Нажмите кнопку **Скачать ZIP**, чтобы скачать ZIP-файл с этим примером кода на свой компьютер. Распакуйте папку **Azure_Digital_Twins__ADT__explorer. zip** и извлеките файлы.

## <a name="set-up-azure-digital-twins-and-azure-digital-twins-explorer"></a>Настройка Azure Digital Twins и Azure Digital Twins Explorer

Первым шагом в работе с Azure Digital Twins является настройка экземпляра Azure Digital Twins. После создания экземпляра службы и настройки ваших учетных данных для аутентификации в Azure Digital Twins Explorer вы сможете подключиться к экземпляру в Azure Digital Twins Explorer и передать в него данные примера далее в этом кратком руководстве.

Соответствующие действия описаны далее в разделе.

### <a name="set-up-an-azure-digital-twins-instance"></a>Настроить экземпляр Azure Digital Twins.

[!INCLUDE [digital-twins-prereq-instance.md](../../includes/digital-twins-prereq-instance.md)]

### <a name="set-up-local-azure-credentials"></a>Настройка локальных учетных данных Azure

Приложение Azure Digital Twins Explorer использует [DefaultAzureCredential](/dotnet/api/azure.identity.defaultazurecredential) (часть библиотеки `Azure.Identity`) для аутентификации пользователей в экземпляре Azure Digital Twins, запускаемом на локальном компьютере. Дополнительные сведения о различных способах аутентификации клиентского приложения в Azure Digital Twins см. в статье [о записи кода аутентификации приложения](how-to-authenticate-client.md).

При использовании такого типа аутентификации Azure Digital Twins Explorer будет искать учетные данные в локальной среде, например имя для входа Azure в локальной версии [Azure CLI](/cli/azure/install-azure-cli), в Visual Studio либо Visual Studio Code. Поэтому вам следует *войти в Azure локально* с помощью одного из этих механизмов, чтобы настроить учетные данные для приложения Azure Digital Twins Explorer.

Если вы уже вошли в Azure с помощью любого из этих методов, можете перейти к [следующему разделу](#run-and-configure-azure-digital-twins-explorer).

Если нет, установите локальную версию Azure CLI, выполнив следующие действия:

1. Следуйте инструкциям, приведенным на [странице установки](/cli/azure/install-azure-cli), чтобы выполнить установку для своей ОС.
1. Откройте окно консоли на своем компьютере.
1. Выполните команду `az login` и следуйте указаниям процесса аутентификации по входу в учетную запись Azure.
1. Возможный последний шаг: если вы используете несколько подписок Azure с этой учетной записью, задайте контекст аутентификации для подписки Azure, который будет содержать ваш экземпляр Azure Digital Twins, выполнив команду `az account set --subscription "<your-subscription-name-or-ID>"` (можно указать имя или значение идентификатора для подписки).

После входа приложение Azure Digital Twins Explorer автоматически применит учетные данные Azure, когда вы запустите его при работе со следующим разделом.

Теперь окно консоли аутентификации можно закрыть. Но вы можете оставить его открытым, чтобы использовать на следующем шаге.

### <a name="run-and-configure-azure-digital-twins-explorer"></a>Запуск и настройка Azure Digital Twins Explorer

Теперь запустите приложение Azure Digital Twins Explorer и настройте его для работы с экземпляром Azure Digital Twins.

1. Перейдите к расположению, в котором вы распаковали скачанную папку **Azure_Digital_Twins__ADT__explorer**.
Откройте окно консоли в папке **Azure_Digital_Twins__ADT__explorer/client/src**.

1. Запустите `npm install`, чтобы загрузить все необходимые зависимости.

1. Запустите приложение, выполнив команду `npm run start`.

   Через несколько секунд откроется окно браузера с приложением.

   :::image type="content" source="media/quickstart-adt-explorer/explorer-blank.png" alt-text="Окно браузера, в котором отображается приложение, запущенное на localhost:3000. Приложение с именем Azure Digital Twins Explorer содержит поля Query Explorer (Обозреватель запросов), Model View (Представление модели), Graph View (Представление графа) и Property Explorer (Обозреватель свойств). Данных на экране пока нет." lightbox="media/quickstart-adt-explorer/explorer-blank.png":::

1. Нажмите кнопку **Sign In** (Вход) в правом верхнем углу окна, как показано на следующем снимке экрана, чтобы настроить в Azure Digital Twins Explorer работу с ранее настроенным экземпляром.

   :::image type="content" source="media/quickstart-adt-explorer/sign-in.png" alt-text="Azure Digital Twins Explorer с выделенным значком Sign In (Войти) в верхней части окна. На значке изображен простой силуэт человека, перекрытый силуэтом ключа." lightbox="media/quickstart-adt-explorer/sign-in.png":::

1. Введите URL-адрес экземпляра Azure Digital Twins, который вы получили ранее при работе с разделом [Настройка экземпляра Azure Digital Twins](#set-up-an-azure-digital-twins-instance), в формате *https://{имя узла экземпляра}* .

>[!NOTE]
> Вы можете в любое время повторно просмотреть или изменить эту информацию, выбрав тот же значок для вызова поля **Sign In** (Вход). Он сохранит переданные значения.

> [!TIP]
> Если при подключении появляется сообщение об ошибке `SignalRService.subscribe`, убедитесь, что URL-адрес Azure Digital Twins начинается с префикса *https://* .

Если вы видите всплывающее окно **Запрос разрешений** от корпорации Майкрософт, предоставьте согласие для этого приложения и нажмите кнопку "Принять", чтобы продолжить.

## <a name="add-the-sample-data"></a>Добавление образца данных

Теперь импортируйте примеры сценария и графа в Azure Digital Twins Explorer. Пример сценария также расположен в папке **Azure_Digital_Twins__ADT__explorer**, которую вы скачали ранее.

### <a name="models"></a>Модели

Первым шагом при работе с Azure Digital Twins является определение словаря для среды. Для этого вы создадите пользовательские [модели](concepts-models.md), которые описывают существующие в среде типы сущностей.

Для создания моделей используется язык JSON-LD под названием DTDL. Каждая модель включает *свойства*, *телеметрию*, *связи* и *компоненты* для описания отдельного типа сущности. Позже эти модели будут применены в качестве основы для цифровых двойников, представляющих определенные экземпляры этих типов.

Как правило, при создании модели выполняются следующие три шага:

1. Создание определения модели. В этом кратком руководстве это не требуется, так как определение уже входит в пример решения.
1. Проверка правильности синтаксиса. В этом кратком руководстве это не требуется, так как проверка уже выполнена для примера решения.
1. Отправка определения в экземпляр Azure Digital Twins.
 
В этом кратком руководстве это не требуется, так как файлы модели уже созданы и проверены. Они входят в состав скачанного решения. В этом разделе описано, как отправить две предварительно написанные модели в экземпляр для определения в среде следующих компонентов:

* Этаж
* Комната

#### <a name="upload-models"></a>Отправка моделей

Выполните следующие шаги для отправки моделей.

1. В окне **Представление модели** щелкните значок **Отправить модель**.

   :::image type="content" source="media/quickstart-adt-explorer/upload-model.png" alt-text="Подсвеченный значок в середине окна &quot;Представление модели&quot;. В нем отображается стрелка, указывающая на облако." lightbox="media/quickstart-adt-explorer/upload-model.png":::
 
1. В появившемся поле выбора файла перейдите к папке **Azure_Digital_Twins__ADT__explorer/client/examples** в скачанном репозитории.
1. Выберите файлы **Room.json** и **Floor.json** и нажмите кнопку **ОК**. Вы можете передать любые дополнительные модели, но они не будут использоваться в этом кратком руководстве.
1. Следуйте указаниям в диалоговом окне с запросом выполнить вход в учетную запись Azure.

>[!NOTE]
>Если вы видите следующее сообщение об ошибке: :::image type="content" source="media/quickstart-adt-explorer/error-models-popup.png" alt-text="Всплывающее окно с текстом &quot;Ошибка: Ошибка выборки моделей: ClientAuthError: Ошибка открытия всплывающего окна. Это может произойти, если используется браузер IE или в браузере заблокированы всплывающие окна.&quot; и кнопка &quot;Закрыть&quot; в нижней части." border="false"::: 
> Попробуйте отключить блокирование всплывающих окон или используйте другой браузер.

Azure Digital Twins Explorer отправит выбранные файлы моделей в экземпляр Azure Digital Twins. Они должны появиться в окне **Представление модели** с указанием понятных имен и полных идентификаторов. Вы можете щелкнуть значки сведений в окне **Представление модели**, чтобы увидеть соответствующий код DTDL.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/model-info.png" alt-text="Окно &quot;Представление модели&quot; с двумя определениями модели: Floor (dtmi:example:Floor;1) и Room (dtmi:example:Room;1). Для каждой модели выделен значок &quot;Представление модели&quot; с буквой &quot;i&quot; в кружке." lightbox="media/quickstart-adt-explorer/model-info.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

### <a name="twins-and-the-twin-graph"></a>Цифровые двойники и граф двойников

Теперь, когда несколько моделей отправлено в ваш экземпляр Azure Digital Twins, можно добавить [цифровые двойники](concepts-twins-graph.md) согласно определениям моделей.

Цифровые двойники представляют фактические сущности в вашей бизнес-среде. Это могут быть датчики на ферме, фары автомобиля или (как в этом кратком руководстве) комнаты в здании. Вы можете создать любое количество двойников для любого типа модели, например несколько комнат с одной моделью *Room*. Вы подключите их с помощью отношений к *графу двойников*, который представляет полную среду.

При работе с этим разделом вы отправите предварительно созданные двойники, подключенные к предварительно созданному графу. Граф содержит два этажа и две комнаты, соединенные по такой схеме:

* Floor0
    - Содержит Room0.
* Floor1
    - Содержит Room1.

#### <a name="import-the-graph"></a>Импорт графа

Чтобы импортировать граф, выполните следующие действия.

1. В окне **Представление графа** щелкните значок **Импортировать граф**.

   :::image type="content" source="media/quickstart-adt-explorer/import-graph.png" alt-text="В окне &quot;Представление графа&quot; выделен значок. В нем отображается стрелка, указывающая на облако." lightbox="media/quickstart-adt-explorer/import-graph.png":::

2. В окне выбора файла перейдите к папке **Azure_Digital_Twins__ADT__explorer/client/examples** и щелкните файл электронной таблицы **buildingScenario.xlsx**. Этот файл содержит описание примера графа. Щелкните **ОК**.

   Через несколько секунд в Azure Digital Twins Explorer откроется представление **Import** (Импорт) с предварительным просмотром загружаемого графа.

3. Чтобы подтвердить отправку графа, щелкните значок **Сохранить** в правом верхнем углу поля **Представление графа**.

   :::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/graph-preview-save.png" alt-text="Выделенный значок &quot;Сохранить&quot; на панели предварительного просмотра графа." lightbox="media/quickstart-adt-explorer/graph-preview-save.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
   :::row-end:::

4. Теперь Azure Digital Twins Explorer применит переданный файл для создания запрашиваемых двойников и связей между ними. По завершении откроется диалоговое окно. Щелкните **Закрыть**.

   :::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/import-success.png" alt-text="Диалоговое окно с сообщением об успешном завершении импорта графа. В нем написано: &quot;Импорт успешно завершен. Импортировано двойников: 4. Импортировано связей: 2.&quot;" lightbox="media/quickstart-adt-explorer/import-success.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
    :::column:::
    :::column-end:::
   :::row-end:::

5. Теперь этот граф успешно отправлен в Azure Digital Twins Explorer. Чтобы увидеть граф, нажмите кнопку **Run Query** (Выполнить запрос) в области **GRAPH EXPLORER** (Обозреватель графа) в верхней части окна Azure Digital Twins Explorer.

   :::image type="content" source="media/quickstart-adt-explorer/run-query.png" alt-text="Выделенная кнопка &quot;Выполнить запрос&quot; в правом верхнем углу окна." lightbox="media/quickstart-adt-explorer/run-query.png":::

Это действие запускает стандартный запрос для выбора и отображения всех цифровых двойников. Azure Digital Twins Explorer извлекает из службы данные обо всех двойниках и связях между ними. По ним он формирует граф в поле **Представление графа**.

## <a name="explore-the-graph"></a>Просмотр графа

Теперь вы увидите отправленный граф примера сценария.

:::image type="content" source="media/quickstart-adt-explorer/graph-view-full.png" alt-text="Поле &quot;Представление графа&quot; с графом двойников. Стрелка с меткой contains соединяет круг с меткой floor1 и круг с меткой room1. Стрелка с меткой contains соединяет круг с меткой floor0 и круг с меткой room0.":::

Круги ("узлы" графа) представляют цифровые двойники. Линии между ними представляют связи. Двойник **Floor0** содержит **Room0**, а двойник **Floor1** содержит **Room1**.

Если вы используете мышь, части графа можно щелкнуть и перетащить.

### <a name="view-twin-properties"></a>Просмотр свойств двойника

Вы можете выбрать двойника, чтобы просмотреть список его свойств и их значений в окне **ОБОЗРЕВАТЕЛЬ СВОЙСТВ**.

Ниже приведены свойства двойника Room0.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/properties-room0.png" alt-text="Выделенное окно &quot;Обозреватель свойств&quot;, в котором отображаются свойства для Room0, в том числе поле $dtId со значением Room0, поле Temperature со значением 70 и поле Humidity со значением 30." lightbox="media/quickstart-adt-explorer/properties-room0.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Это означает что в комнате Room0 сейчас температура 70.

Ниже приведены свойства Room1.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/properties-room1.png" alt-text="Выделенное окно &quot;Обозреватель свойств&quot;, в котором отображаются свойства для Room1, в том числе поле $dtId со значением Room1, поле Temperature со значением 80 и поле Humidity со значением 60." lightbox="media/quickstart-adt-explorer/properties-room1.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Это означает что в комнате Room1 сейчас температура 80.

### <a name="query-the-graph"></a>Запрос графа

Главной особенностью Azure Digital Twins является возможность просто и эффективно [запрашивать](concepts-query-language.md) граф двойников, чтобы получать ответы о вашей среде.

Одним из способов вызова двойников в графе являются их *свойства*. Запросы по свойствам предоставляют самые разные данные. Например, вы можете выявить отклоняющиеся значения, требующие вашего внимания.

При работе с этим разделом вы выполните запрос и узнаете, сколько двойников в вашей среде имеют температуру выше 75.

Чтобы увидеть ответ, выполните следующий запрос в окне **Обозреватель запросов**.

:::code language="sql" source="~/digital-twins-docs-samples/queries/queries.sql" id="TemperatureQuery":::

Ранее вы видели, что в свойствах двойника для Room0 указана температура 70, а для Room1 — 80. Поэтому в результатах отображается только Room1.
    
:::image type="content" source="media/quickstart-adt-explorer/result-query-property-before.png" alt-text="Результаты запроса по свойству, которые содержат только Room1." lightbox="media/quickstart-adt-explorer/result-query-property-before.png":::

>[!TIP]
> В приведенном выше запросе также поддерживаются другие операторы сравнения (<, >, = и !=). Вы можете включить в запрос эти операторы, другие значения или свойства двойника, чтобы получить интересующие вас данные.

## <a name="edit-data-in-the-graph"></a>Изменение данных в графе

Azure Digital Twins Explorer позволяет изменять свойства двойников, представленных в графе. В этом разделе мы увеличим температуру Room0 до 76.

Для начала выберите **Room0**, чтобы открыть список свойств в поле **Обозреватель свойств**.

Свойства в этом списке доступны для редактирования. Выберите значение температуры **70**, чтобы активировать ввод нового значения. Введите **76** и щелкните значок **Сохранить**, чтобы обновить температуру до значения **76**.

:::row:::
    :::column:::
        :::image type="content" source="media/quickstart-adt-explorer/new-properties-room0.png" alt-text="Окно &quot;Обозреватель свойств&quot;, в котором отображаются свойства для Room0. В редактируемом поле отображается значение температуры 76 и выделен значок &quot;Сохранить&quot;." lightbox="media/quickstart-adt-explorer/new-properties-room0.png":::
    :::column-end:::
    :::column:::
    :::column-end:::
:::row-end:::

Теперь вы увидите окно **Сведения об исправлении**, в котором отображается код исправления, позволяющий выполнить это обновление через [API](how-to-use-apis-sdks.md) Azure Digital Twins. Щелкните **Закрыть**.

### <a name="query-to-see-the-result"></a>Запрос для просмотра результата

Чтобы убедиться, что граф успешно зарегистрировал обновление температуры для Room0, повторно запустите указанный выше запрос, чтобы получить список цифровых двойников в среде с температурой выше 75.

:::code language="sql" source="~/digital-twins-docs-samples/queries/queries.sql" id="TemperatureQuery":::

Теперь, когда температура Room0 изменилась с 70 на 76, в результатах должны отобразиться оба двойника.

:::image type="content" source="media/quickstart-adt-explorer/result-query-property-after.png" alt-text="Результаты запроса по свойствам, в которых отображаются Room0 и Room1." lightbox="media/quickstart-adt-explorer/result-query-property-after.png":::

## <a name="review-and-contextualize-learnings"></a>Просмотр и контекстуализация учебных моделей

С помощью этого краткого руководства вы создали экземпляр Azure Digital Twins, подключили его к Azure Digital Twins Explorer и заполнили его данными примера сценария.

Затем вы изучили граф, выполнив следующие действия:

* Используя запрос для ответа на вопрос о сценарии.
* Изменяя свойства в цифровом двойнике.
* Снова запустите запрос, чтобы увидеть, как изменился ответ в результате обновления.

Цель этого упражнения — продемонстрировать, как можно использовать граф Azure Digital Twins, чтобы ответить на вопросы о среде, даже если среда продолжит изменяться.

С помощью этого краткого руководства вы вручную изменили температуру. Azure Digital Twins позволяет подключать цифровые двойники к реальным устройствам Интернета вещей, благодаря чему они могут автоматически получать обновленные значения на основе данных телеметрии. С помощью этого решения вы можете создать динамический граф, который всегда отражает реальное состояние среды, и выполнять запросы в режиме реального времени для получения сведений о том, что происходит в вашей среде.

## <a name="clean-up-resources"></a>Очистка ресурсов

Чтобы окончательно завершить пример в этом кратком руководстве, сначала завершите работу консольного приложения. Это действие закрывает подключение к приложению Azure Digital Twins Explorer в браузере. Вы больше не сможете просматривать динамические данные в браузере. Теперь можно закрыть вкладку браузера.

Теперь вы можете выбрать ресурсы, которые нужно удалить, в зависимости от планируемых действий.

* **Если вы планируете продолжить работу с руководствами по Azure Digital Twins**, созданный в этом кратком руководстве экземпляр можно использовать повторно для работы со следующими статьями, поэтому удалять его не нужно.

[!INCLUDE [digital-twins-cleanup-clear-instance.md](../../includes/digital-twins-cleanup-clear-instance.md)]
 
[!INCLUDE [digital-twins-cleanup-basic.md](../../includes/digital-twins-cleanup-basic.md)]

Также, возможно, потребуется удалить папку проекта с вашего локального компьютера.

## <a name="next-steps"></a>Дальнейшие шаги

Далее перейдите к учебникам по Azure Digital Twins, чтобы создать собственный сценарий и средства взаимодействия Azure Digital Twins.

> [!div class="nextstepaction"]
> [Руководство. Написание кода для клиентского приложения](tutorial-code.md)