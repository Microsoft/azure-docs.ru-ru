---
title: Перемещение хранилища ключей в другой регион (Azure Key Vault) | Документация Майкрософт
description: В этой статье предлагаются рекомендации по перемещению хранилища ключей в другой регион.
services: key-vault
author: msmbaldwin
manager: ravijan
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: general
ms.topic: how-to
ms.date: 03/31/2021
ms.author: mbaldwin
ms.openlocfilehash: ac2f6347776c2f5d230065b80b1c0336e21e181c
ms.sourcegitcommit: 6686a3d8d8b7c8a582d6c40b60232a33798067be
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/20/2021
ms.locfileid: "107751802"
---
# <a name="move-an-azure-key-vault-across-regions"></a>Перемещение хранилища ключей между регионами Azure

Azure Key Vault не поддерживает операцию перемещения ресурсов, которая позволила бы перенести хранилище ключей из одного региона в другой. В этой статье описаны обходные пути, которые помогут организациям решить задачу перемещения хранилища ключей в другой регион. У каждого из обходных путей есть свои ограничения. Прежде чем пытаться применить их в рабочей среде, крайне важно оценить последствия этих решений.

Чтобы переместить хранилище ключей в другой регион, вам придется создать новое хранилище ключей в новом регионе, а затем вручную скопировать каждый секрет по отдельности из существующего хранилища ключей в новое. Для этого у вас есть два возможных подхода.

## <a name="design-considerations"></a>Рекомендации по проектированию

Прежде чем начать работу, примите во внимание следующие важные моменты.

* Имена хранилищ ключей должны быть глобально уникальными, то есть не удастся использовать прежнее имя хранилища.
* Вам придется перенастроить политики доступа и параметры сетевой конфигурации в новом хранилище ключей.
* Вам придется перенастроить обратимое удаление и защиту от очистки в новом хранилище ключей.
* Операции резервного копирования и восстановления не смогут сохранить параметры автоматической смены ключей. Возможно, эти параметры придется настраивать заново.

## <a name="option-1-use-the-key-vault-backup-and-restore-commands"></a>Вариант 1. Использование команд резервного копирования и восстановления для хранилища ключей

Вы можете создать резервные копии всех секретов, ключей и сертификатов в хранилище с помощью команды резервного копирования. Секреты скачиваются в виде зашифрованного большого двоичного объекта. Такой большой двоичный объект можно восстановить в новом хранилище ключей. Список команд Azure Key Vault для этого варианта см. [здесь](/powershell/module/azurerm.keyvault#key_vault).

Использование команд резервного копирования и восстановления имеет два ограничения:

* Вы не можете создавать резервную копию хранилища ключей и восстанавливать его в разных географических областях. Дополнительные сведения см. в статье [Географические области Azure](https://azure.microsoft.com/global-infrastructure/geographies/).

* Команда резервного копирования создает копии всех версий каждого секрета. Если у ваших секретов уже сменилось много предыдущих версий (например, более 10), размер запроса может превысить максимально допустимое значение и операция завершится ошибкой.

## <a name="option-2-manually-download-and-upload-the-key-vault-secrets"></a>Вариант 2. Скачивание и отправка секретов хранилища ключей вручную

Вы можете вручную скачать некоторые типы секретов. Например, сертификаты можно скачать в формате PFX-файлов. Этот вариант избавляет от географических ограничений для некоторых типов секретов, таких как сертификаты. PFX-файлы можно передать в любое хранилище ключей в любом регионе. Секреты скачиваются в формате, не защищенном паролем. Вы сами обязаны обеспечить защиту секретов на время их перемещения.