---
title: Способы создания сертификатов
description: Узнайте о различных вариантах создания или импорта Key Vault сертификата в Azure Key Vault. Существует несколько способов создания Key Vault сертификата.
services: key-vault
author: msmbaldwin
manager: rkarlin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: certificates
ms.topic: conceptual
ms.date: 01/07/2019
ms.author: mbaldwin
ms.openlocfilehash: a9545c040809331a5556b11f6cc7536931e2d421
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "93289575"
---
# <a name="certificate-creation-methods"></a>Способы создания сертификатов

 Сертификат Key Vault (KV) можно создать или импортировать в хранилище ключей. При создании сертификата KV в хранилище ключей создается закрытый ключ, который никогда не будет доступен для владельца сертификата. Существуют следующие способы создания сертификата в Key Vault.  

-   **Создание самозаверяющего сертификата.** При использовании этого способа создается пара открытого и закрытого ключей. Она будет связана с сертификатом. Сертификат будет подписан собственным ключом.  

-    **Создание сертификата вручную.** При использовании этого способа создается пара открытого и закрытого ключей и запрос на подпись сертификата X.509. Запрос на подпись может быть подписан центром регистрации или сертификации. Для завершения создания сертификата в Key Vault подписанный сертификат x509 может быть объединен с ожидающей парой ключей. Несмотря на то что для этого метода необходимо выполнить дополнительные шаги, он более безопасен, так как созданный закрытый ключ доступен только для Key Vault. Это описано на приведенной ниже схеме.  

![Создание сертификата с помощью собственного центра сертификации](../media/certificate-authority-1.png)  

Следующие описания соответствуют действиям, обозначенным зеленым цветом на предыдущей схеме.

1. На приведенной выше схеме приложение создает сертификат, который начинается с создания ключа в хранилище ключей.
2. Key Vault возвращает приложению запрос на подпись сертификата (CSR).
3. Приложение передает CSR выбранному центру сертификации (ЦС).
4. Выбранный ЦС отвечает на сертификат X509.
5. Приложение завершает создание сертификата путем слияния сертификата X509 из ЦС.

-   **Создание сертификата с помощью известного поставщика издателя.** При использовании этого метода необходимо выполнить разовую задачу создания объекта издателя. После создания объекта издателя в хранилище ключей можно ссылаться на его имя в политике сертификата KV. При запросе на создание такого сертификата KV создается пара ключей в хранилище и устанавливается связь со службой поставщика издателя, используя сведения в объекте издателя, на которые имеются ссылки для получения сертификата x509. Чтобы завершить создание сертификата KV, сертификат х509 будет извлечен из службы поставщика и объединен с парою ключей.  

![Создание сертификата с помощью партнерского центра сертификации Key Vault](../media/certificate-authority-2.png)  

Следующие описания соответствуют действиям, обозначенным зеленым цветом на предыдущей схеме.

1. На приведенной выше схеме приложение создает сертификат, который начинается с создания ключа в хранилище ключей.
2. Key Vault отправляет в ЦС запрос на сертификат TLS/SSL.
3. Приложение опрашивает в рамках цикла и ожидания Key Vault, ожидая завершения сертификата. Создание сертификата завершено, когда Key Vault получает от ЦС ответ с сертификатом x509.
4. ЦС отвечает на запрос сертификата TLS/SSL Key Vault с сертификатом TLS/SSL X. 509.
5. Создание нового сертификата завершается слиянием сертификата TLS/SSL X. 509 для центра сертификации.

## <a name="asynchronous-process"></a>Асинхронный процесс
Создание сертификата KV представляет собой асинхронный процесс. Эта операция возвращает код состояния HTTP 202 (Принято) и создает запрос на сертификат KV. Состояние запроса можно отслеживать путем опроса ожидающего объекта, созданного этой операцией. Полный URI ожидающего объекта возвращается в заголовке LOCATION.  

Когда запрос на создание сертификата KV завершается, статус ожидающего объекта изменится с "Выполняется" на "Готово" и будет создана новая версия сертификата KV. Она станет текущей версией.  

## <a name="first-creation"></a>Первое создание
 При создании сертификата KV в первый раз также создается адресуемый ключ и секрет с тем же именем, что и сертификат. Если имя уже используется, операция завершится ошибкой с кодом состояния HTTP 409 (конфликт).
Адресуемый ключ и секрет получают свои атрибуты из атрибутов сертификата KV. Адресуемый ключ и секрет, созданные таким образом, отмечены как управляемые ключи и секреты. Их временем существования управляет Key Vault. Управляемые ключи и секреты доступны только для чтения. Примечание. Если сертификат KV отключен или истек срок его действия, соответствующий ключ и секрет станут неработоспособными.  

 Если сертификат KV создается впервые, необходимо наличие политики.  Политику можно задать с помощью последовательных операций создания, чтобы заменить ресурс политики. Если политика не указана, для создания следующей версии сертификата KV используется ресурс политики службы. Обратите внимание, что в ходе выполнения запроса на создание следующей версии текущий сертификат KV и соответствующий адресуемый ключ и секрет остаются неизменными.  

## <a name="self-issued-certificate"></a>Самостоятельно выдаваемый сертификат
 Чтобы создать самостоятельно выдаваемый сертификат, в политике сертификата в качестве имени издателя укажите Self, как показано в следующем фрагменте политики сертификата.  

```  
"issuer": {  
       "name": "Self"  
    }  

```  

 Если имя издателя не указано, будет установлено значение Unknown. Если издатель неизвестен, владельцу сертификата придется вручную получать сертификат x509 от выбранного издателя, а затем объединять его с ожидающим объектом сертификата хранилища ключей, чтобы завершить создание сертификата.

```  
"issuer": {  
       "name": "Unknown"  
    }  

```  

## <a name="partnered-ca-providers"></a>Поставщики партнерского центра сертификации
Создание сертификата может быть выполнено вручную или с помощью издателя Self. Key Vault также сотрудничает с определенными поставщиками издателей, чтобы упростить создание сертификатов. У этих партнеров-поставщиков издателей можно заказать для хранилища ключей следующие сертификаты.  

|Поставщик|Тип сертификата|Настройка конфигурации  
|--------------|----------------------|------------------|  
|DigiCert;|Key Vault предоставляет OV или EV SSL-сертификаты в DigiCert| [Руководство по интеграции](./how-to-integrate-certificate-authority.md)
|GlobalSign;|Key Vault предоставляет OV или EV SSL-сертификаты в GlobalSign| [Руководство по интеграции](https://support.globalsign.com/digital-certificates/digital-certificate-installation/generating-and-importing-certificate-microsoft-azure-key-vault)

 Издатель сертификата — это сущность, представленная в Azure Key Vault (KV) как ресурс CertificateIssuer. Она используется для предоставления сведений об источнике сертификата KV, имени издателя, поставщика, учетных данных и других административных сведений.

Обратите внимание, что при размещении заказа поставщику издателя он может учесть или переопределить расширения сертификата x509 и срок действия сертификата на основе типа.  

 Авторизация. Требуется разрешение на создание сертификатов.

## <a name="see-also"></a>См. также:

 - [Мониторинг и администрирование процесса создания сертификатов](create-certificate-scenarios.md)