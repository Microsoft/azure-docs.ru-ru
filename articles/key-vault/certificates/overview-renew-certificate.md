---
title: О возобновлении действия сертификата Azure Key Vault
description: В этой статье описывается продление сертификатов Azure Key Vault.
services: key-vault
author: msmbaldwin
manager: rkarlin
tags: azure-resource-manager
ms.service: key-vault
ms.subservice: certificates
ms.topic: overview
ms.date: 07/20/2020
ms.author: sebansal
ms.openlocfilehash: c7948230164258aa785f3dd6c1f487c51ece9333
ms.sourcegitcommit: e6de1702d3958a3bea275645eb46e4f2e0f011af
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102487191"
---
# <a name="renew-your-azure-key-vault-certificates"></a>Продление сертификатов Azure Key Vault

С помощью Azure Key Vault можно легко подготавливать, администрировать и развертывать цифровые сертификаты для сети и поддерживать безопасный обмен данными между приложениями. Дополнительные сведения о сертификатах см. в статье [Сведения о сертификатах Azure Key Vault](./about-certificates.md).

Используя кратковременные сертификаты или увеличивая частоту их смены, можно предотвратить доступ к приложениям неавторизованными пользователями.

В этой статье описывается продление сертификатов Azure Key Vault.

## <a name="get-notified-about-certificate-expiration"></a>Получение уведомлений об истечении срока действия сертификатов
Чтобы получать уведомления о событиях, касающихся срока действия сертификата, необходимо добавить контакт сертификата. Контакты сертификатов содержат контактную информацию для отправки уведомлений, активируемых событиями времени существования сертификата. Информация о контактах совместно используется всеми сертификатами в хранилище ключей. Уведомление отправляется всем контактам, указанным для события, связанного с любым сертификатом в хранилище ключей.

### <a name="steps-to-set-certificate-notifications"></a>Чтобы настроить уведомления о сертификате, сделайте следующее:
Сначала добавьте в хранилище ключей контакт сертификата. Это можно сделать с помощью портала Azure или командлета PowerShell [`Add-AzureKeyVaultCertificateContact`](/powershell/module/azurerm.keyvault/add-azurekeyvaultcertificatecontact?view=azurermps-6.13.0).

Затем укажите, когда следует отправлять уведомления об истечении срока действия сертификата. Сведения о настройке атрибутов жизненного цикла сертификата см. в разделе, посвященном [настройке автоматической смены сертификата Key Vault](./tutorial-rotate-certificates.md#update-lifecycle-attributes-of-a-stored-certificate).

Если в политике сертификата настроено автоматическое продление, уведомление отправляется для следующих событий.

- Перед продлением сертификата.
- После продления сертификата. Указывает, был ли сертификат успешно продлен или произошла ошибка, требующая продления сертификата вручную.  

  Если для политики сертификата настроено продление вручную (только по электронной почте), тогда уведомление отправляется, когда пришло время продлить сертификат.  

В Key Vault есть три категории сертификатов:
-   сертификаты, созданные с помощью интегрированного центра сертификации, например DigiCert или GlobalSign;
-   сертификаты, созданные с помощью неинтегрированного центра сертификации;
-   Самозаверяющие сертификаты

## <a name="renew-an-integrated-ca-certificate"></a>Продление сертификата интегрированного центра сертификации 
Azure Key Vault обеспечивает комплексное обслуживание сертификатов, выданных доверенными центрами сертификации Майкрософт DigiCert и GlobalSign. Узнайте, как [интегрировать доверенный центр сертификации с Key Vault](./how-to-integrate-certificate-authority.md).

## <a name="renew-a-nonintegrated-ca-certificate"></a>Продление сертификата неинтегрированного центра сертификации 
С помощью Azure Key Vault можно импортировать сертификаты из любого центра сертификации. Это преимущество обеспечивает возможность интеграции с несколькими ресурсами Azure и упрощает развертывание. Если вы опасаетесь пропустить дату истечения срока действия сертификата или, что еще хуже, обнаружили, что срок его действия уже истек, ваше хранилище ключей поможет вам быть в курсе происходящего. Для сертификатов неинтегрированных центров сертификации хранилище ключей позволяет настроить уведомления по электронной почте о приближении истечения срока действия. Такие уведомления можно также задать для нескольких пользователей.

> [!IMPORTANT]
> Сертификат является объектом с версиями. Если срок действия текущей версии истекает, необходимо создать новую. По сути, каждая новая версия — это новый сертификат, состоящий из ключа и большого двоичного объекта, который связывает этот ключ с удостоверением. При использовании несвязанного центра сертификации хранилище ключей создает пару "ключ-значение" и возвращает запрос на подпись сертификата (CSR).

Для продления сертификата неинтегрированного центра сертификации выполните следующие действия.

1. Войдите на портал Azure, а затем откройте сертификат, который хотите продлить.
1. В области сертификата выберите **Новая версия**.
1. Выберите **Операция с сертификатом**.
1. Выберите **Скачать CSR**, чтобы скачать CSR-файл на локальный диск.
1. Отправьте CSR в выбранный центр сертификации, чтобы подписать запрос.
1. Перенесите подписанный запрос и выберите **Merge CSR** (Объединить CSR) в той же области операций с сертификатом.

> [!NOTE]
> Важно объединить подписанный запрос CSR с тем же запросом CSR, который вы создали. В противном случае ключ не будет совпадать.

Дополнительные сведения о создании CSR см. в статье [Создание и слияние CSR в Key Vault]( https://docs.microsoft.com/azure/key-vault/certificates/create-certificate-signing-request#azure-portal).

## <a name="renew-a-self-signed-certificate"></a>Продление самозаверяющего сертификата

Azure Key Vault также обеспечивает автоматическое продление самозаверяющих сертификатов. Дополнительные сведения об изменении политики выдачи и обновлении атрибутов жизненного цикла сертификата см. в [руководстве по настройке автоматической смены сертификата в Key Vault](./tutorial-rotate-certificates.md#update-lifecycle-attributes-of-a-stored-certificate).

## <a name="troubleshoot"></a>Диагностика
* Если выданный сертификат находится в состоянии *отключен* на портале Azure, перейдите в раздел **Операция с сертификатом**, чтобы просмотреть связанное с ним сообщение об ошибке.
* Тип ошибки The CSR used to get your certificate has already been used. Please try to generate a new certificate with a new CSR. (Файл CSR, используемый для получения сертификата, уже используется. Попытайтесь создать новый сертификат с новым файлом CSR.)
  Перейдите в раздел "Расширенная политика" сертификата и проверьте, отключен ли параметр **reuse key on renewal** (Использовать ключ повторно при возобновлении действия).


## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

**Как можно проверить функцию автоматической смены сертификата?**

Создайте сертификат со сроком действия в **1 месяц**, а затем задайте действие времени существования, при котором смена будет происходить при **1 %** . В результате сертификат будет меняться каждые 7,2 часа.
  
**Будут ли реплицированы теги после автопродления сертификата?**

Да, теги реплицируются после автопродления.

## <a name="next-steps"></a>Дальнейшие действия
*   [Интеграция Key Vault с центром сертификации DigiCert](how-to-integrate-certificate-authority.md)
*   [Руководство. Настройка автоматической смены сертификата в Key Vault](tutorial-rotate-certificates.md)
