---
title: Наборы утверждений Аттестации Azure
description: Наборы утверждений в Аттестации Azure.
services: attestation
author: msmbaldwin
ms.service: attestation
ms.topic: overview
ms.date: 08/31/2020
ms.author: mbaldwin
ms.openlocfilehash: afe2cf288cd4a15091e8278309b3ecf74a2d35a4
ms.sourcegitcommit: 65cef6e5d7c2827cf1194451c8f26a3458bc310a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2021
ms.locfileid: "98572754"
---
# <a name="claim-sets"></a>Наборы утверждений

Утверждения, созданные в процессе аттестации анклавов в Аттестации Microsoft Azure, можно разделить на следующие категории:

- **Входящие утверждения.** Утверждения, созданные Аттестацией Microsoft Azure по итогам синтаксического анализа свидетельства аттестации, которые могут использоваться авторами политик для определения правил авторизации в настраиваемой политике.

- **Исходящие утверждения.** Утверждения, созданные Аттестацией Azure и содержащие все утверждения, которые помещаются в токен аттестации.

- **Утверждения свойств.** Это утверждения, созданные Аттестацией Azure в качестве выходных данных. Сюда относятся все утверждения, которые представляют свойства маркера аттестации, например кодировка отчета, срок действия отчета и т. д.

### <a name="common-incoming-claims-across-all-attestation-types"></a>Общие входящие утверждения для всех типов аттестации

Ниже представлены утверждения, которые создаются Аттестацией Azure и могут применяться для определения правил аттестации в настраиваемой политике:
- **x-ms-ver** — версия схемы JWT (ожидается значение "1.0");
- **x-ms-attestation-type** — строковое значение, определяющее тип аттестации; 
- **x-ms-policy-hash** — хэш политики оценки в Аттестации Azure, который вычисляется по формуле BASE64URL(SHA256(UTF8(BASE64URL(UTF8(текст политики)))));
- **x-ms-policy-signer** — объект JSON с элементом "jwk", который содержит ключ, примененный клиентом для подписания политики при отправке подписанной политики.

Приведенные ниже утверждения считаются нерекомендуемыми, но полностью поддерживаются. Мы советуем не использовать нерекомендуемые имена утверждений.

Нерекомендуемое утверждение | Рекомендуемое утверждение 
--- | --- 
ver | x-ms-ver
tee | x-ms-attestation-type
maa-policyHash | x-ms-policy-hash
policy_hash | x-ms-policy-hash
policy_signer | x-ms-policy-signer

### <a name="common-outgoing-claims-across-all-attestation-types"></a>Общие исходящие утверждения для всех типов аттестации

Следующие утверждения определяются в токене [IETF JWT](https://tools.ietf.org/html/rfc7519) и используются Аттестацией Azure в объекте ответа:

- **утверждение jti (идентификатор токена JWT)** ;
- **утверждение iss (издатель)** ;
- **утверждение iat (время выдачи)** ;
- **утверждение exp (срок действия)** ;
- **утверждение nbf (не ранее)** .

Следующие утверждения определяются в токене [IETF EAT](https://tools.ietf.org/html/draft-ietf-rats-eat-03#page-9) и используются Аттестацией Azure в объекте ответа:
- **утверждение Nonce (значение nonce)** .

## <a name="claims-specific-to-sgx-enclaves"></a>Утверждения, относящиеся к анклавам SGX

### <a name="incoming-claims-specific-to-sgx-attestation"></a>Входящие утверждения, относящиеся к аттестации SGX

Ниже представлены утверждения, создаваемые службой аттестации SGX. С их помощью можно определять правила аттестации в настраиваемой политике:
- **x-ms-sgx-is-debuggable** — Логическое значение, определяющее включение отладки в этом анклаве.
- **x-ms-sgx-product-id**;
- **x-ms-sgx-mrsigner** — шестнадцатеричное значение поля mrsigner из предложения;
- **x-ms-sgx-mrenclave** — шестнадцатеричное значение поля mrenclave из предложения;
- **x-ms-sgx-svn** — номер версии безопасности, зашифрованный в предложении. 

### <a name="outgoing-claims-specific-to-sgx-attestation"></a>Исходящие утверждения, относящиеся к аттестации SGX

Следующие утверждения создаются службой и включаются в объект ответа для аттестации SGX:
- **x-ms-sgx-is-debuggable** — Логическое значение, определяющее включение отладки в этом анклаве.
- **x-ms-sgx-product-id**.
- **x-ms-ver**.
- **x-ms-sgx-mrsigner** — шестнадцатеричное значение поля mrsigner из предложения.
- **x-ms-sgx-mrenclave** — шестнадцатеричное значение поля mrenclave из предложения.
- **x-ms-sgx-svn** — номер версии безопасности, зашифрованный в предложении. 
- **x-ms-sgx-ehd** — хранящиеся в анклаве данные в кодировке BASE64URL.
- **x-ms-sgx-collateral** — объект JSON с описанием сопутствующих материалов, которые используются для аттестации. Значение для утверждения x-ms-sgx-collateral представляет собой вложенный объект JSON со следующими парами "ключ-значение":
    - **qeidcertshash** — значение SHA256 идентификатора QE, выдающего сертификаты;
    - **qeidcrlhash** — значение SHA256 идентификатора QE, выдающего список отзыва сертификатов;
    - **qeidhash** — значение SHA256 для идентификатора QE сопутствующих материалов;
    - **quotehash** — значение SHA256 для оцениваемого предложения;
    - **tcbinfocertshash** — значение SHA256 для информации о базе TCB, выдающей сертификаты;
    - **tcbinfocrlhash** — значение SHA256 для информации о базе TCB, выдающей список отзыва сертификатов;
    - **tcbinfohash** — объект JSON с описанием сопутствующих материалов, которые используются для аттестации.

Приведенные ниже утверждения считаются нерекомендуемыми, но полностью поддерживаются и будут включаться и далее. Мы советуем не использовать нерекомендуемые имена утверждений.

Нерекомендуемое утверждение | Рекомендуемое утверждение
--- | --- 
$is-debuggable | x-ms-sgx-is-debuggable
$sgx-mrsigner | x-ms-sgx-mrsigner
$sgx-mrenclave | x-ms-sgx-mrenclave
$product-id | x-ms-sgx-product-id
$svn | x-ms-sgx-svn
$tee | x-ms-attestation-type
maa-ehd | x-ms-sgx-ehd
aas-ehd | x-ms-sgx-ehd
maa-attestationcollateral | x-ms-sgx-collateral

## <a name="claims-issued-specific-to-trusted-platform-module-tpm-attestation"></a>Утверждения, выданные специально для аттестации доверенного платформенного модуля

### <a name="incoming-claims-can-also-be-used-as-outgoing-claims"></a>Входящие утверждения (могут использовать и в качестве исходящих)

- **aikValidated.**  Логическое значение с информацией о том, был ли проверен сертификат AIK (ключ удостоверения подлинности).
- **aikPubHash.**  Строка хэша, получаемая как base64(SHA256(открытый ключ AIK в формате DER)).
- **tpmVersion.**   Целое число, обозначающее основной номер версии доверенного платформенного модуля (TPM).
- **secureBootEnabled.** Логическое значение, указывающее, что безопасная загрузка включена.
- **iommuEnabled.**  Логическое значение, указывающее, что модуль управления памятью ввода-вывода (IOMMU) включен.
- **bootDebuggingDisabled.** Логическое значение, указывающее, что отладка загрузки отключена.
- **notSafeMode.**  Логическое значение, указывающее, что Windows не использует безопасный режим.
- **notWinPE.**  Логическое значение, обозначающее, что Windows не использует режим WinPE.
- **vbsEnabled.**  Логическое значение, обозначающее разрешение использовать VBS.
- **vbsReportPresent.**  Логическое значение, указывающее, что отчет по анклаву VBS доступен.
- **enclaveAuthorId.**  Строковое значение идентификатора автора анклава основного модуля этого анклава в кодировке Base64Url.
- **enclaveImageId.**  Строковое значение идентификатора образа анклава основного модуля этого анклава в кодировке Base64Url.
- **enclaveOwnerId.**  Строковое значение идентификатора владельца анклава в кодировке Base64Url.
- **enclaveFamilyId.**  Строковое значение идентификатора семьи анклава в кодировке Base64Url. (Это идентификатор семьи главного модуля анклава.)
- **enclaveSvn.**  Целое число, обозначающее номер версии безопасности главного модуля анклава.
- **enclavePlatformSvn.**  Целое число, обозначающее номер версии безопасности платформы, на которой размещается анклав.
- **enclaveFlags**.  Утверждение enclaveFlags — это целое число, содержащее флаги, которые описывают политику среды выполнения для этого анклава.
  
### <a name="outgoing-claims-specific-to-tpm-attestation"></a>Исходящие утверждения, относящиеся к аттестации доверенного платформенного модуля

- **policy_hash.**  Строковое значение хэша SHA256 для текста политики, которое вычисляется как BASE64URL(SHA256(BASE64URL(UTF8(текст политики)))).
- **policy_signer.**  Содержит JWK с открытым ключом или цепочкой сертификатов, которые присутствуют в заголовке подписанной политики.
- **ver (версия).**  Строковое значение, определяющее номер версии отчета. Сейчас это 1.0.
- **Утверждение cnf (подтверждение).**  Утверждение cnf применяется для идентификации ключа, подтверждающего право владения. Утверждения подтверждения определены в стандарте RFC 7800 и содержат открытую часть ключа аттестованного анклава в формате объекта JWK (JSON Web Key) (RFC 7517).
- **rp_data (данные проверяющей стороны).**  Любые данные проверяющей стороны, если они присутствуют в запросе, которые используются проверяющей стороной как элемент nonce для гарантии актуальности отчета.
- **Утверждение jti (идентификатор токена JWT).** Утверждение jti (идентификатор маркера JWT) предоставляет уникальный идентификатор JWT. Это значение идентификатора присваивается так, чтобы вероятность случайного присвоения того же значения другому объекту данных была ничтожно мала.

### <a name="property-claims"></a>Утверждения свойств

- **report_validity_in_minutes.** Это утверждение содержит целое число, которое обозначает срок действия токена.
  - **Значение по умолчанию (время).** Один день в минутах.
  - **Максимальное значение (время).** Один год в минутах.
- **omit_x5c.** Логическое значение, которое указывает, что Аттестация Azure должна исключить сертификат, который использовался для подтверждения подлинности службы. Если имеет значение True, к токену аттестации добавляется сертификат x5t. Если имеет значение False (по умолчанию), к токену аттестации добавляется сертификат x5c.

## <a name="next-steps"></a>Дальнейшие действия
- [Как создать и подписать файл политики аттестации](author-sign-policy.md)
- [Настройка службы "Аттестация Azure" с помощью PowerShell](quickstart-powershell.md)
