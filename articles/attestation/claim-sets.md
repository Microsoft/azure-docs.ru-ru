---
title: Наборы утверждений Аттестации Azure
description: Наборы утверждений в Аттестации Azure.
services: attestation
author: msmbaldwin
ms.service: attestation
ms.topic: overview
ms.date: 08/31/2020
ms.author: mbaldwin
ms.openlocfilehash: 0d6d5a08ea85ebb666acc0336f1e1d7ec5e097da
ms.sourcegitcommit: 32e0fedb80b5a5ed0d2336cea18c3ec3b5015ca1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/30/2021
ms.locfileid: "105044674"
---
# <a name="claim-sets"></a>Наборы утверждений

Утверждения, созданные в процессе аттестации анклавов в Аттестации Microsoft Azure, можно разделить на следующие категории:

- **Входящие утверждения.** Утверждения, созданные Аттестацией Microsoft Azure по итогам синтаксического анализа свидетельства аттестации, которые могут использоваться авторами политик для определения правил авторизации в настраиваемой политике.

- **Исходящие утверждения.** Утверждения, созданные Аттестацией Azure и включенные в токен аттестации.

- **Утверждения свойств.** Это утверждения, созданные Аттестацией Azure в качестве выходных данных. Сюда относятся все утверждения, которые представляют свойства маркера аттестации, например кодировка отчета, срок действия отчета и т. д.

## <a name="incoming-claims"></a>Входящие утверждения 

### <a name="sgx-attestation"></a>Аттестация SGX

Утверждения, с помощью которых авторы политик могут определять правила авторизации в политике аттестации SGX:

- **x-ms-sgx-is-debuggable** — Логическое значение, определяющее включение отладки в этом анклаве.
- **x-ms-sgx-product-id** — значение идентификатора продукта анклава SGX; 
- **x-ms-sgx-mrsigner** — шестнадцатеричное значение поля mrsigner из предложения;
- **x-ms-sgx-mrenclave** — шестнадцатеричное значение поля mrenclave из предложения.
- **x-ms-sgx-svn** — номер версии безопасности, зашифрованный в предложении. 

Приведенные ниже утверждения считаются нерекомендуемыми, но полностью поддерживаются и будут включаться и далее. Мы советуем не использовать нерекомендуемые имена утверждений.

Нерекомендуемое утверждение | Рекомендуемое утверждение
--- | --- 
$is-debuggable | x-ms-sgx-is-debuggable
$product-id | x-ms-sgx-product-id
$sgx-mrsigner | x-ms-sgx-mrsigner
$sgx-mrenclave | x-ms-sgx-mrenclave
$svn | x-ms-sgx-svn

### <a name="tpm-attestation"></a>Аттестация доверенного платформенного модуля

Утверждения, с помощью которых авторы политик могут определять правила авторизации в политике аттестации доверенного платформенного модуля:

- **aikValidated.** Логическое значение с информацией о том, был ли проверен сертификат AIK (ключ удостоверения подлинности).
- **aikPubHash.**  Строка хэша, получаемая как base64(SHA256(открытый ключ AIK в формате DER)).
- **tpmVersion.**   Целое число, обозначающее основной номер версии доверенного платформенного модуля (TPM).
- **secureBootEnabled.** Логическое значение, указывающее, что безопасная загрузка включена.
- **iommuEnabled.**  Логическое значение, указывающее, что модуль управления памятью ввода-вывода (IOMMU) включен.
- **bootDebuggingDisabled.** Логическое значение, указывающее, что отладка загрузки отключена.
- **notSafeMode.**  Логическое значение, указывающее, что Windows не использует безопасный режим.
- **notWinPE.**  Логическое значение, обозначающее, что Windows не использует режим WinPE.
- **vbsEnabled.**  Логическое значение, указывающее, что VBS включен.
- **vbsReportPresent.**  Логическое значение, указывающее, что отчет по анклаву VBS доступен.

### <a name="vbs-attestation"></a>Аттестация VBS

Кроме утверждений политики аттестации доверенного платформенного модуля, для определения правил авторизации в политике аттестации VBS авторы политик могут использовать следующие утверждения:

- **enclaveAuthorId.**  Строковое значение идентификатора автора анклава основного модуля этого анклава в кодировке Base64Url.
- **enclaveImageId.**  Строковое значение идентификатора образа анклава основного модуля этого анклава в кодировке Base64Url.
- **enclaveOwnerId.**  Строковое значение идентификатора владельца анклава в кодировке Base64Url.
- **enclaveFamilyId.**  Строковое значение идентификатора семьи анклава в кодировке Base64Url. (Это идентификатор семьи главного модуля анклава.)
- **enclaveSvn.**  Целое число, обозначающее номер версии безопасности главного модуля анклава.
- **enclavePlatformSvn.**  Целое число, обозначающее номер версии безопасности платформы, на которой размещается анклав.
- **enclaveFlags**.  Утверждение enclaveFlags — это целое число, содержащее флаги, которые описывают политику среды выполнения для этого анклава.

## <a name="outgoing-claims"></a>Исходящие утверждения 

### <a name="common-for-all-attestation-types"></a>Общие утверждения для всех типов аттестации

Аттестация Azure включает следующие утверждения в токене аттестации для всех типов аттестации: 

- **x-ms-ver** — версия схемы JWT (ожидается значение "1.0");
- **x-ms-attestation-type** — строковое значение, определяющее тип аттестации; 
- **x-ms-policy-hash** — хэш политики оценки в Аттестации Azure, который вычисляется по формуле BASE64URL(SHA256(UTF8(BASE64URL(UTF8(текст политики)))));
- **x-ms-policy-signer** — объект JSON с элементом jwk, который содержит ключ, примененный клиентом для подписания политики. Это применимо, когда клиент отправляет подписанную политику.

Следующие имена утверждений взяты из [спецификации IETF JWT](https://tools.ietf.org/html/rfc7519):

- **утверждение jti (идентификатор JWT)**  — уникальный идентификатор для JWT;
- **утверждение iss (издатель)**  — субъект, который создал токен JWT; 
- **утверждение iat (время выдачи)**  — время, в которое был создан токен JWT; 
- **утверждение exp (время окончания срока действия)**  — время окончания срока действия, начиная с которого маркер JWT не должен приниматься в обработку;
- **утверждение nbf (не ранее)**  — время, до которого маркер JWT не должен приниматься в обработку. 

Следующие имена утверждений взяты из [предварительной спецификации IETF EAT](https://tools.ietf.org/html/draft-ietf-rats-eat-03#page-9):

- **утверждение nonce** — непреобразованная непосредственная копия необязательного значения nonce, предоставленного клиентом; 

Приведенные ниже утверждения считаются нерекомендуемыми, но полностью поддерживаются и будут включаться и далее. Мы советуем не использовать нерекомендуемые имена утверждений.

Нерекомендуемое утверждение | Рекомендуемое утверждение
--- | --- 
ver | x-ms-ver
tee | x-ms-attestation-type
policy_hash | x-ms-policy-hash
maa-policyHash | x-ms-policy-hash
policy_signer  | x-ms-policy-signer

### <a name="sgx-attestation"></a>Аттестация SGX 

Ниже приведены создаваемые утверждения, которые включаются в токен аттестации службой для аттестации SGX.

- **x-ms-sgx-is-debuggable** — Логическое значение, определяющее включение отладки в этом анклаве.
- **x-ms-sgx-product-id** — значение идентификатора продукта анклава SGX; 
- **x-ms-sgx-mrsigner** — шестнадцатеричное значение поля mrsigner из предложения;
- **x-ms-sgx-mrenclave** — шестнадцатеричное значение поля mrenclave из предложения.
- **x-ms-sgx-svn** — номер версии безопасности, зашифрованный в предложении. 
- **x-ms-sgx-ehd** — хранящиеся в анклаве данные в кодировке BASE64URL.
- **x-ms-sgx-collateral** — объект JSON с описанием сопутствующих материалов, которые используются для аттестации. Значение для утверждения x-ms-sgx-collateral представляет собой вложенный объект JSON со следующими парами "ключ-значение":
    - **qeidcertshash** — значение SHA256 для идентификатора анклава цитирования (QE), выдающего сертификаты;
    - **qeidcrlhash** — значение SHA256 идентификатора QE, выдающего список отзыва сертификатов;
    - **qeidhash** — значение SHA256 для идентификатора QE сопутствующих материалов;
    - **quotehash** — значение SHA256 для оцениваемого предложения;
    - **tcbinfocertshash** — значение SHA256 для информации о базе TCB, выдающей сертификаты;
    - **tcbinfocrlhash** — значение SHA256 для информации о базе TCB, выдающей список отзыва сертификатов;
    - **tcbinfohash** — значение SHA256 информационных материалов TCB.

Приведенные ниже утверждения считаются нерекомендуемыми, но полностью поддерживаются и будут включаться и далее. Мы советуем не использовать нерекомендуемые имена утверждений.

Нерекомендуемое утверждение | Рекомендуемое утверждение
--- | --- 
$is-debuggable | x-ms-sgx-is-debuggable
$product-id | x-ms-sgx-product-id
$sgx-mrsigner | x-ms-sgx-mrsigner
$sgx-mrenclave | x-ms-sgx-mrenclave
$svn | x-ms-sgx-svn
$maa-ehd | x-ms-sgx-ehd
$aas-ehd | x-ms-sgx-ehd
$maa-attestationcollateral | x-ms-sgx-collateral

### <a name="tpm-and-vbs-attestation"></a>Аттестация доверенного платформенного модуля и VBS

- **cnf (подтверждение)** . Утверждение cnf применяется для идентификации ключа, подтверждающего право владения. Утверждение подтверждения определено в стандарте RFC 7800 и содержит открытую часть ключа аттестованного анклава в формате объекта JWK (JSON Web Key) (RFC 7517).
- **rp_data (данные проверяющей стороны).** Любые данные проверяющей стороны, если они присутствуют в запросе, которые используются проверяющей стороной как элемент nonce для гарантии актуальности отчета. rp_data добавляется только при наличии rp_data

## <a name="property-claims"></a>Утверждения свойств

### <a name="tpm-and-vbs-attestation"></a>Аттестация доверенного платформенного модуля и VBS

- **report_validity_in_minutes.** Это утверждение содержит целое число, которое обозначает срок действия токена.
  - **Значение по умолчанию (время).** Один день в минутах.
  - **Максимальное значение (время).** Один год в минутах.
- **omit_x5c.** Логическое значение, которое указывает, что Аттестация Azure должна исключить сертификат, который использовался для подтверждения подлинности службы. Если имеет значение True, к токену аттестации добавляется сертификат x5t. Если имеет значение False (по умолчанию), к токену аттестации добавляется сертификат x5c.

## <a name="next-steps"></a>Дальнейшие действия
- [Как создать и подписать файл политики аттестации](author-sign-policy.md)
- [Настройка службы "Аттестация Azure" с помощью PowerShell](quickstart-powershell.md)
