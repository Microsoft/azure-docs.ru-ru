---
title: Рабочий процесс аттестации Azure
description: Описание рабочего процесса аттестации Azure.
services: attestation
author: msmbaldwin
ms.service: attestation
ms.topic: overview
ms.date: 08/31/2020
ms.author: mbaldwin
ms.openlocfilehash: 27a97ceb2ca9a7b58df7200930e4e47d89c9ae89
ms.sourcegitcommit: 3c3ec8cd21f2b0671bcd2230fc22e4b4adb11ce7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2021
ms.locfileid: "98762206"
---
# <a name="workflow"></a>Рабочий процесс

Аттестация Microsoft Azure получает свидетельство от анклавов и оценивает свидетельство с учетом базового уровня безопасности Azure и настраиваемых политик. После успешной проверки аттестация Azure создает маркер аттестации для подтверждения надежности анклава.

Рабочий поток аттестации Azure содержит такие субъекты:

- **Проверяющая сторона** — компонент, который использует аттестацию Azure для проверки допустимости анклава. 
- **Клиент** — компонент, собирающий сведения из анклава и отправляющий запросы в аттестацию Azure. 
- **Аттестация Azure** — компонент, который принимает свидетельство анклава от клиента, проверяет его и возвращает клиенту маркер аттестации.


## <a name="intel-software-guard-extensions-sgx-enclave-validation-work-flow"></a>Рабочий процесс по проверке анклава Intel® Software Guard Extensions (SGX)

Ниже дано общее описание шагов типичного рабочего процесса аттестации анклава SGX (с использованием аттестации Azure).

1. Клиент собирает свидетельства из анклава. Свидетельство — это сведения о среде анклава и клиентской библиотеке, работающей в анклаве.
1. Клиенту присвоен универсальный код ресурса (URI), который ссылается на экземпляр аттестации Azure. Клиент отправляет свидетельство в Аттестацию Azure. Точная информация, отправляемая поставщику, зависит от типа анклава.
1. Аттестация Azure проверяет отправленные данные и оценивает их в соответствии с настроенной политикой. Если проверка завершается, аттестация Azure выдает маркер аттестации и возвращает его клиенту. В случае сбоя на этом шаге аттестация Azure сообщает клиенту об ошибке. 
1. Клиент отправляет маркер аттестации проверяющей стороне. Проверяющая сторона вызывает конечную точку метаданных открытого ключа аттестации Azure для получения сертификатов подписи. Затем проверяющая сторона проверяет подпись маркера аттестации и убеждается в надежности анклава. 

![Процесс по проверке анклава SGX](./media/sgx-validation-flow.png)

> [!Note]
> При отправке запросов на аттестацию в API версии [2018-09-01-preview](https://github.com/Azure/azure-rest-api-specs/tree/master/specification/attestation/data-plane/Microsoft.Attestation/stable/2018-09-01-preview) клиенту необходимо также отправить свидетельство в Аттестацию Azure вместе с маркером доступа Azure AD.

## <a name="trusted-platform-module-tpm-enclave-validation-work-flow"></a>Рабочий процесс проверки анклава доверенного платформенного модуля (TPM)

Ниже дано общее описание шагов типичного рабочего процесса аттестации анклава TPM (с использованием аттестации Azure):

1.  При загрузке устройства или платформы различные загрузчики и службы загрузки измеряют события, которые запущены TPM и безопасно хранятся (журнал TCG).
2.  Клиент собирает журналы TCG с устройства и квоту TPM, которая выступает в качестве свидетельства для аттестации.
3.  Клиенту присвоен универсальный код ресурса (URI), который ссылается на экземпляр аттестации Azure. Клиент отправляет свидетельство в Аттестацию Azure. Точная информация, отправляемая поставщику, зависит от платформы.
4.  Аттестация Azure проверяет отправленные данные и оценивает их в соответствии с настроенной политикой. Если проверка завершается, аттестация Azure выдает маркер аттестации и возвращает его клиенту. В случае сбоя на этом шаге аттестация Azure сообщает клиенту об ошибке. Обмен данными между клиентом и службой аттестации управляется протоколом TPM для аттестации Azure.
5.  Клиент затем отправляет маркер аттестации проверяющей стороне. Проверяющая сторона вызывает конечную точку метаданных открытого ключа аттестации Azure для получения сертификатов подписи. Затем проверяющая сторона проверяет подпись маркера аттестации и убеждается в надежности платформы.

![Процесс проверки TPM](./media/tpm-validation-flow.png)

## <a name="next-steps"></a>Дальнейшие действия
- [Как создать и подписать файл политики аттестации](author-sign-policy.md)
- [Настройка службы "Аттестация Azure" с помощью PowerShell](quickstart-powershell.md)
