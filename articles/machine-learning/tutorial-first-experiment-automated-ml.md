---
title: Создание автоматизированных моделей классификации ML
titleSuffix: Azure Machine Learning
description: Сведения о том, как обучать и развертывать модели классификации с помощью интерфейса автоматизированного машинного обучения службы "Машинное обучение Azure".
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: tutorial
author: cartacioS
ms.author: sacartac
ms.reviewer: nibaccam
ms.date: 12/21/2020
ms.custom: automl
ms.openlocfilehash: ad8a9f7af9ddabe969d090f80378ba5ff891d7f1
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101691949"
---
# <a name="tutorial-create-a-classification-model-with-automated-ml-in-azure-machine-learning"></a>Руководство по Создание модели классификации с использованием автоматизированного машинного обучения в службе "Машинное обучение Azure".


Из этого учебника вы узнаете, как с помощью интерфейса автоматизированного машинного обучения в Студии машинного обучение Azure создать простую модель классификации, не написав ни одной строки кода. Эта модель классификации прогнозирует согласие клиента на депозит с фиксированным сроком, предложенный финансовым учреждением.

Автоматическое машинное обучение позволяет автоматизировать задачи, которые занимают много времени. Автоматическое машинное обучение позволяет быстро выполнить итерацию множества сочетаний алгоритмов и гиперпараметров, пока не будет найдена лучшая модель на основе выбранных удачных метрик.

Пример прогнозирования временных рядов см. в статье [Руководство. Прогнозирование спроса на прокат велосипедов с помощью автоматизированного машинного обучения](tutorial-automated-ml-forecast.md).

Из этого руководства вы узнаете, как выполнять такие задачи:

> [!div class="checklist"]
> * Создайте рабочую область машинного обучения Azure.
> * Выполнение эксперимента автоматического машинного обучения.
> * Просмотр сведений об эксперименте.
> * Развертывание модели.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись Azure](https://aka.ms/AMLFree).

* Скачайте файл данных [**bankmarketing_train.csv**](https://automlsamplenotebookdata.blob.core.windows.net/automl-sample-notebook-data/bankmarketing_train.csv). Столбец **y** в нем указывает, подписан ли клиент на депозит с фиксированным сроком. Впоследствии он будет выбран в этом учебнике как целевой столбец для прогнозов. 

## <a name="create-a-workspace"></a>Создание рабочей области

Рабочая область машинного обучения Azure — это основной ресурс в облаке для экспериментов, обучения и развертывания моделей машинного обучения. Она связывает подписку и группу ресурсов Azure с легко используемым объектом в службе. 

Существует много [способов создания рабочей области](how-to-manage-workspace.md). В этом руководстве показано, как создать рабочую область с помощью портала Azure, веб-консоли для управления ресурсами Azure.

[!INCLUDE [aml-create-portal](../../includes/aml-create-in-portal.md)]

>[!IMPORTANT] 
> Запишите **рабочую область** и **подписку**. Они понадобятся вам для того, чтобы создать эксперимент в нужном месте. 

## <a name="get-started-in-azure-machine-learning-studio"></a>Начало работы в Студии машинного обучения Azure

Выполните указанные ниже действия по настройке и выполнению эксперимента с помощью студии "Машинное обучение Azure" в объединенном веб-интерфейсе на странице https://ml.azure.com, включающем в себя средства машинного обучения для выполнения сценариев обработки и анализа данных и предназначенном для специалистов в этой области с любым уровнем навыков. Студия не поддерживается в браузерах Internet Explorer.

1. Войдите в [Студию машинного обучения Azure](https://ml.azure.com).

1. Выберите свою подписку и рабочую область, которую создали.

1. Выберите **Начать**.

1. На панели слева выберите **Automated ML** (Автоматизированное ML) в разделе **Автор**.

   Так как это ваш первый эксперимент автоматизированного машинного обучения, вы увидите пустой список и ссылки на документацию.

   ![Страница "Начало работы"](./media/tutorial-first-experiment-automated-ml/get-started.png)

1. Выберите **+Новое выполнение автоматизированного машинного обучения**. 

## <a name="create-and-load-dataset"></a>Создание и загрузка набора данных

Прежде чем настроить эксперимент, отправьте файл данных в рабочую область в виде набора данных Машинного обучения Azure. Это позволит правильно отформатировать данные для эксперимента.

1. Создайте набор данных, выбрав из раскрывающегося списка **+ Create DataSet** (+Создать набор данных) пункт **From local files** (Из локальных файлов). 

    1. В форме **Общие сведения** присвойте набору данных имя и по желанию добавьте описание. Так как интерфейс автоматизированного машинного обучения сейчас поддерживает только табличные наборы данных, по умолчанию следует использовать тип набора данных *Табличный*.

    1. Выберите **Далее** внизу слева.

    1. В форме **Выбор хранилища данных и файлов** выберите хранилище данных по умолчанию, которое было автоматически настроено при создании рабочей области **workspaceblobstore (хранилище BLOB-объектов Azure)** . Сюда вы будете загружать файл данных, чтобы сделать его доступным для рабочей области.

    1. Нажмите кнопку **Обзор**.
    
    1. Выберите файл **bankmarketing_train.csv** на локальном компьютере. Это тот файл, который вы скачали при подготовке [необходимых компонентов](https://automlsamplenotebookdata.blob.core.windows.net/automl-sample-notebook-data/bankmarketing_train.csv).

    1. Присвойте набору данных уникальное имя и укажите дополнительное описание. 

    1. Нажмите кнопку **Далее** внизу слева, чтобы отправить его в контейнер по умолчанию, который был автоматически настроен при создании рабочей области.  
    
       Когда загрузка завершится, форма "Settings and preview" (Настройки и предварительный просмотр) будет автоматически заполнена в зависимости от типа файла. 
       
    1. Убедитесь, что форма **Settings and preview** (Настройки и предварительный просмотр) заполнена, как описано ниже, и щелкните **Далее**.
        
        Поле|Описание| Значение для руководства
        ---|---|---
        Формат файла|Свойство определяет структуру и тип данных, хранящихся в файле.| С разделителями
        Разделитель|Один или несколько символов для указания границы между&nbsp; отдельными, независимыми регионами в виде простого текста или других потоков данных. |Запятая
        Кодирование|Определяет, какой бит следует использовать в таблице схемы символов, чтобы считать набор данных.| UTF-8
        Заголовки столбцов| Указывает, как будут обрабатываться заголовки набора данных, если таковые имеются.| Все файлы имеют одинаковые заголовки
        Пропустить строки | Указывает, сколько строк, если таковые имеются, пропускается в наборе данных.| None

    1. Форма **Схема** позволяет выполнять дальнейшую настройку данных для этого эксперимента. В этом примере выберите переключатель для функции **day_of_week**, чтобы не включать его. Выберите **Далее**.
         ![Форма схемы](./media/tutorial-first-experiment-automated-ml/schema-tab-config.gif)
    1. В форме **Confirm details** (Подтверждение сведений) проверьте правильность сведений, которые ранее были введены в формах **Basic info, Datastore and file selection** (Базовые сведения, хранилище данных и выбор файлов) и **Settings and preview** (Параметры и просмотр).
    
    1. Выберите **Создать**, чтобы завершить создание набора данных.
    
    1. Выберите набор данных, когда он появится в списке.
    
    1. Используйте **Просмотр данных**, чтобы убедиться, что вы не включили **day_of_week**, затем выберите **Закрыть**.

    1. Нажмите кнопку **Далее**.

## <a name="configure-run"></a>Настройка запуска

После загрузки и настройки данных можно настроить эксперимент. Эта настройка включает в себя такие задачи разработки эксперимента, как выбор размера вычислительной среды и указание столбца, который необходимо спрогнозировать. 

1. Выберите переключатель **Создать**.

1. Заполните форму **Configure Run** (Настройка выполнения) следующим образом.
    1. Введите для эксперимента имя `my-1st-automl-experiment`.

    1. Выберите **y** в качестве столбца целевого объекта, для которого будут выполняться прогнозы. Этот столбец содержит сведения о том, подписан ли клиент на срочный депозит или нет.
    
    1. Выберите **+Создать вычислительную среду** и настройте целевой объект вычислений. Целевым объектом вычислений называется локальная или облачная среда, в которой будет запущен сценарий обучения или размещена развернутая служба. Для этого эксперимента мы используем облачный вычислительный ресурс. 
        1. Заполните форму **Виртуальная машина**, чтобы настроить вычислительную среду.

            Поле | Описание | Значение для руководства
            ----|---|---
            Приоритет&nbsp;виртуальной&nbsp;машины |Выберите приоритет, который должен иметь ваш эксперимент.| Выделенные
            Virtual&nbsp;machine&nbsp;type| Выберите тип виртуальной машины для вычислительной среды.|ЦП (центральный процессор)
            Virtual&nbsp;machine&nbsp;size| Выберите размер виртуальной машины для вычислительной среды. Список рекомендуемых размеров выводится с учетом ваших данных и типа эксперимента. |Standard_DS12_V2
        
        1. Выберите **Далее**, чтобы заполнить форму **Настройка параметров**.
        
            Поле | Описание | Значение для руководства
            ----|---|---
            Имя вычислительной среды |  Уникальное имя для идентификации контекста вычислительной среды. | automl-compute
            Min/Max nodes (Минимальное и максимальное количество узлов)| Для профилирования данных необходимо указать один или больше узлов.|Min nodes (Минимум узлов): 1<br>Max nodes (Максимум узлов): 6
            Время до уменьшения масштаба (сек) | Время простоя перед автоматическим уменьшением масштаба кластера до минимального количества узлов.|120 (по умолчанию)
            Дополнительные параметры | Параметры для настройки и авторизации виртуальной сети для эксперимента.| None               

        1. Выберите **Создать**, чтобы создать целевой объект вычислений. 

            **Операция займет несколько минут.** 

             ![Страница "Параметры"](./media/tutorial-first-experiment-automated-ml/compute-settings.png)

        1. Когда создание целевого объекта вычислений завершится, выберите его из раскрывающегося списка.

    1. Выберите **Далее**.

1. В форме **Task type and settings** (Тип задачи и параметры) завершите настройку эксперимента автоматического машинного обучения, указав тип задачи и параметры конфигурации машинного обучения.
    
    1.  Выберите **Классификация** в качестве типа задачи машинного обучения.

    1. Выберите **View additional configuration settings** (Просмотреть дополнительные параметры конфигурации) и заполните поля следующим образом. Эти настройки предназначены для лучшего управления заданием для обучения. В противном случае применяются значения по умолчанию, основанные на выборе эксперимента и данных.

        Дополнительные&nbsp;конфигурации|Описание|Значение&nbsp;для&nbsp;руководства
        ------|---------|---
        Основная метрика| Оценочная метрика, по которой будет проверяться алгоритм машинного обучения.|AUC_weighted
        Пояснения для наилучшей модели| Автоматическое отображение пояснений для лучшей модели, созданной с помощью автоматизированного машинного обучения.| Включить
        Запрещенные алгоритмы | Алгоритмы, которые вы хотите исключить из задания обучения.| None
        Критерий выхода| Если условия соблюдены, задание обучения останавливается. |Время&nbsp;задания&nbsp;обучения (ч): 1 <br> Порог&nbsp;оценки&nbsp;метрики: None
        Проверка | Выберите тип перекрестной проверки и число тестов.|Тип проверки:<br>перекрестная проверка в &nbsp;k-кратном порядке&nbsp;. <br> <br> Количество проверок: 2
        Параллелизм| Максимальное число выполняемых параллельных итераций за одну итерацию.| Максимальное число&nbsp;параллельных&nbsp;итераций: 5
        
        Щелкните **Сохранить**.
    
1. Нажмите кнопку **Готово**, чтобы запустить эксперимент. Откроется экран **Сведения о выполнении**, содержащий в верхней части значение **Состояние выполнения** после начала подготовки эксперимента. Это состояние обновляется по мере выполнения эксперимента. Уведомления также отображаются в правом верхнем углу студии, сообщая о состоянии эксперимента.

>[!IMPORTANT]
> Подготовка к запуску эксперимента занимает **10-15 минут**.
> С начала эксперимента на каждую итерацию уходит **2-3 минуты**.  <br> <br>
> В рабочей среде у вас будет время заняться другими делами. Но в рамках этого учебника мы рекомендуем начинать изучение протестированных алгоритмов на вкладке **Модели** сразу по мере их появления, пока остальные алгоритмы еще выполняются. 

##  <a name="explore-models"></a>Изучение моделей

Перейдите на вкладку **Модели**, чтобы просмотреть протестированные алгоритмы (модели). По умолчанию модели упорядочиваются по оценке метрики по мере их завершения. В этом учебнике в начале списка отображается модель, имеющая наибольшее значение по выбранной метрике **AUC_weighted**.

В ожидании завершения всех моделей эксперимента вы можете щелкнуть **Algorithm name** (Имя алгоритма) для любой завершенной модели, чтобы просмотреть сведения о ее эффективности. 

Чтобы просмотреть свойства, метрики и диаграммы производительности выбранной модели, воспользуйтесь вкладками **Подробности** и **Метрики** из следующего примера: 

![Сведения о выполнении итераций](./media/tutorial-first-experiment-automated-ml/run-detail.gif)

## <a name="model-explanations"></a>Пояснения к модели

Пока вы ожидаете завершения моделей, вы также можете взглянуть на пояснения к модели и узнать, какие функции данных (необработанные или спроектированные) влияют на прогнозы конкретной модели. 

Эти пояснения к модели можно создавать по запросу и суммировать на панели мониторинга с пояснениями к модели, которая находится на вкладке **Пояснения (предварительная версия)** .

Создание пояснений к модели: 
 
1. Выберите **Запустить 1** в верхней части окна, чтобы вернуться к экрану **Модели**. 
1. Перейдите на вкладку **Модели**.
1. Для этого руководства выберите первую модель **MaxAbsScaler, LightGBM**.
1. Нажмите кнопку **Создать пояснение к модели** в верхней части окна. Справа появится панель **Пояснение к модели**. 
1. Выберите ранее созданный объект **automl-compute**. Этот кластер вычислений запускает дочерний сеанс для создания пояснений к модели.
1. Нажмите **Создать** в нижней части окна. В верхней части экрана появится зеленое сообщение об успешном выполнении. 
    >[!NOTE]
    > Сеанс создания пояснений занимает от 2 до 5 минут.
1. Нажмите кнопку **Пояснения (предварительная версия)** . Эта вкладка заполняется после завершения сеанса создания пояснений.
1. Разверните панель слева и выберите строку с надписью **необработанные данные** в разделе **Функции**. 
1. Выберите вкладку **Важность статистической функции** справа. На этой диаграмме показано, какие функции данных влияют на прогнозы выбранной модели. 

    В этом примере *Длительность* имеет наибольшее влияние на прогнозы этой модели.
    
    ![Панель мониторинга с пояснением к модели](media/tutorial-first-experiment-automated-ml/model-explanation-dashboard.png)

## <a name="deploy-the-best-model"></a>Развертывание лучшей модели

Интерфейс автоматизированного машинного обучения позволяет развернуть лучшую модель как веб-службу, выполнив всего несколько действий. Развертывание — это интеграция модели для прогнозирования по новым данным и определения потенциальных новых возможностей. 

Для этого эксперимента развертывание в веб-службе предоставит финансовому учреждению итеративное и масштабируемое решение для определения потенциальных клиентов по депозитам с фиксированным сроком. 

Проверьте, завершено ли выполнение эксперимента. Для этого вернитесь на страницу родительского выполнения, выбрав **Run 1** (Запуск 1) в верхней части экрана. Состояние **Завершено** отображается в левом верхнем углу экрана. 

После выполнения эксперимента страница **Сведения** заполняется данными раздела **Best model summary** (Сводка по лучшей модели). В контексте этого эксперимента лучшей моделью принимается **VotingEnsemble**, исходя из значения метрики **AUC_weighted**.  

Мы развернем эту модель. Учитывайте, что процесс развертывания занимает около 20 минут. Процесс развертывания выполняется за несколько шагов, включая регистрацию модели, создание ресурсов и их настройку для веб-службы.

1. Выберите **VotingEnsemble**, чтобы открыть страницу для конкретной модели.

1. Нажмите кнопку **Развернуть** в левом верхнем углу.

1. Заполните панель **Deploy a model** (Развертывание модели), как показано ниже.

    Поле| Значение
    ----|----
    Deployment name (Имя развертывания)| my-automl-deploy
    Deployment description (Описание развертывания)| My first automated machine learning experiment deployment (Первое развертывание эксперимента автоматического машинного обучения)
    Тип вычисления | Выберите "Вычислительная операция Azure (ACI)"
    Включить проверку подлинности| Отключите. 
    Использовать настраиваемые развертывания| Отключите. Это позволяет автоматически создавать файл драйвера (скрипт оценки) и файл среды по умолчанию. 
    
    Для этого примера мы воспользуемся стандартными параметрами, доступными в меню *Дополнительно*. 

1. Выберите **Развернуть**.  

    В верхней части экрана **Выполнение** появится сообщение об успешном выполнении, выделенное зеленым цветом, а под надписью **Состояние развертывания** на панели **Сводка по модели** появится сообщение о состоянии. Периодически щелкайте **Обновить**, чтобы проверять состояние развертывания.
    
Теперь у вас есть рабочая веб-служба для создания прогнозов. 

Перейдите к [**дальнейшим действиям**](#next-steps), чтобы узнать больше о том, как использовать новую веб-службу, и протестируйте прогнозы, используя встроенную поддержку Power BI в Машинном обучении Azure.

## <a name="clean-up-resources"></a>Очистка ресурсов

Файлы развертывания имеют больший размер, чем файлы данных и экспериментов, поэтому их хранение обходится дороже. Вы можете удалить только файлы развертывания, чтобы снизить затраты на учетную запись, если хотите сохранить рабочую области и файлы экспериментов. В противном случае, если вы не планируете дальше использовать эти файлы, удалите всю группу ресурсов.  

### <a name="delete-the-deployment-instance"></a>Удаление промежуточного развертывания

Чтобы сохранить группу ресурсов и рабочую область для изучения других руководств и собственных исследований, удалите из службы "Машинное обучение Azure" по адресу https:\//ml.azure.com/ только экземпляр развертывания. 

1. Перейдите в [Машинное обучение Azure](https://ml.azure.com/). Перейдите в свою рабочую область и слева под областью **Ресурсы** выберите **Конечные точки**. 

1. Выберите развертывание для удаления и щелкните **Удалить**. 

1. Выберите **Продолжить**.

### <a name="delete-the-resource-group"></a>удаление группы ресурсов.

[!INCLUDE [aml-delete-resource-group](../../includes/aml-delete-resource-group.md)]

## <a name="next-steps"></a>Дальнейшие действия

В ходе работы с этим руководством по автоматизированному машинному обучению вы создали и развернули модель классификации с помощью интерфейса автоматизированного машинного обучения в службе "Машинное обучение Azure". Дополнительные сведения и дальнейшие процедуры вы найдете в следующих статьях:

> [!div class="nextstepaction"]
> [Использование веб-службы](/power-bi/connect-data/service-aml-integrate?context=azure%2fmachine-learning%2fcontext%2fml-context)

+ Дополнительные сведения [об автоматическом машинном обучении](concept-automated-ml.md).
+ Дополнительные сведения о классификационных метриках и графиках см. в статье [Общие сведения об автоматических результатах машинного обучения](how-to-understand-automated-ml.md).
+ Подробная информация о [добавлении признаков](how-to-configure-auto-features.md#featurization).
+ Подробная информация [о профилировании данных](how-to-connect-data-ui.md#profile).


>[!NOTE]
> Этот набор данных о банковском маркетинге предоставляется на условиях лицензии [Creative Commons (CCO: Public Domain)](https://creativecommons.org/publicdomain/zero/1.0/). Все права на отдельное содержимое базы данных предоставляются на условиях [лицензии на содержимое базы данных](https://creativecommons.org/publicdomain/zero/1.0/) и доступны в [Kaggle](https://www.kaggle.com/janiobachmann/bank-marketing-dataset). Этот набор данных изначально предоставлялся в [базе данных UCI для машинного обучения](https://archive.ics.uci.edu/ml/datasets/bank+marketing).<br><br>
> [Moro et al., 2014] S. Moro, P. Cortez and P. Rita. A Data-Driven Approach to Predict the Success of Bank Telemarketing. (Основанный на данных подход, позволяющий прогнозировать успешность телемаркетинга в банке.) Decision Support Systems (Системы поддержки принятия решений), Elsevier, 62:22-31, Июнь 2014 г.
