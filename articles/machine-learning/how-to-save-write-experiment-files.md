---
title: Где сохранять & записывать файлы экспериментов
titleSuffix: Azure Machine Learning
description: Узнайте, где сохранять входные и выходные файлы, чтобы избежать ошибок ограничений хранилища и экспериментов.
services: machine-learning
author: rastala
ms.author: roastala
manager: danielsc
ms.reviewer: nibaccam
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.custom: how-to
ms.date: 03/10/2020
ms.openlocfilehash: ad641c2270f94b9d902a25e8d061fb1137a0cdb7
ms.sourcegitcommit: e6de1702d3958a3bea275645eb46e4f2e0f011af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102518608"
---
# <a name="where-to-save-and-write-files-for-azure-machine-learning-experiments"></a>Где можно сохранять и записывать файлы для экспериментов Машинное обучение Azure


В этой статье вы узнаете, где сохранять входные файлы, а также где записывать выходные файлы из экспериментов, чтобы предотвратить ошибки ограничения хранилища и время работы эксперимента.

При запуске обучающих запусков на [целевом объекте вычислений](concept-compute-target.md)они изолируются от внешних сред. Цель этой схемы — обеспечить воспроизводимость и переносимость эксперимента. Если один и тот же скрипт запускается дважды на том же или другом целевом объекте вычислений, вы получаете те же результаты. При такой архитектуре целевые объекты вычислений можно рассматривать как вычислительные ресурсы без отслеживания состояния, у которых нет сходства с заданиями, которые выполняются после их завершения.

## <a name="where-to-save-input-files"></a>Место сохранения входных файлов

Прежде чем начать эксперимент на целевом объекте вычислений или на локальном компьютере, необходимо убедиться, что необходимые файлы доступны для целевого объекта вычислений, например файлы зависимостей и файлы данных, необходимые для выполнения кода.

Машинное обучение Azure запускает скрипты обучения, копируя весь исходный каталог. Если у вас есть конфиденциальные данные, которые не нужно передавать, используйте [файл. Ignore](how-to-save-write-experiment-files.md#storage-limits-of-experiment-snapshots) или не включайте его в исходный каталог. Вместо этого получите доступ к данным с помощью [хранилища](/python/api/azureml-core/azureml.data)данных.

Максимальный размер хранилища для моментальных снимков экспериментов составляет 300 МБ или 2000 файлов.

По этой причине рекомендуется:

* **Сохранение файлов в [хранилище данных](/python/api/azureml-core/azureml.data)машинное обучение Azure.** Это предотвращает проблемы с задержкой в экспериментах и имеет преимущества доступа к данным из удаленного целевого объекта вычислений, что означает, что проверка подлинности и подключение управляются Машинное обучение Azure. Узнайте больше о том, как указать хранилище данных в качестве исходного каталога, а также отправить файлы в хранилище в [данные Access из вашей](how-to-access-data.md) статьи.

* **Если вам требуется только несколько файлов данных и скриптов зависимости и не можете использовать хранилище,** поместите файлы в тот же каталог папки, в котором находится сценарий обучения. Укажите эту папку `source_directory` непосредственно в обучающем скрипте или в коде, который вызывает сценарий обучения.

<a name="limits"></a>

### <a name="storage-limits-of-experiment-snapshots"></a>Ограничения хранилища моментальных снимков экспериментов

Для экспериментов Машинное обучение Azure автоматически создает моментальный снимок кода на основе каталога, предлагаемого при настройке запуска. Это общее ограничение в 300 МБ и/или 2000 файлов. Если вы превысили это ограничение, вы увидите следующую ошибку:

```Python
While attempting to take snapshot of .
Your total snapshot size exceeds the limit of 300.0 MB
```

Чтобы устранить эту ошибку, храните файлы экспериментов в хранилище данных. Если вы не можете использовать хранилище данных, в таблице ниже представлены возможные альтернативные решения.

Описание эксперимента &nbsp;|Решение для ограничения хранилища
---|---
Менее 2000 файлов & не могут использовать хранилище данных| Переопределить предельный размер моментального снимка <br> `azureml._restclient.snapshots_client.SNAPSHOT_MAX_SIZE_BYTES = 'insert_desired_size'`<br> Это может занять несколько минут в зависимости от числа и размера файлов.
Необходимо использовать указанный каталог сценариев| [!INCLUDE [amlinclude-info](../../includes/machine-learning-amlignore-gitignore.md)]
Конвейер|Использовать другой подкаталог для каждого шага
Записные книжки Jupyter| Создайте `.amlignore` файл или переместите записную книжку в новый, пустой подкаталог и снова запустите код.

## <a name="where-to-write-files"></a>Место записи файлов

Из-за изоляции экспериментов изменения в файлах, происходящих во время выполнения, не всегда сохраняются вне среды. Если ваш сценарий изменяет локальные файлы для вычислений, изменения не сохраняются для следующего запуска эксперимента, и они не передаются обратно на клиентский компьютер автоматически. Таким образом, изменения, внесенные во время первого эксперимента, не должны влиять на них во втором.

При записи изменений рекомендуется записывать файлы в хранилище данных Машинное обучение Azure. См. статью [доступ к данным из хранилищ данных](how-to-access-data.md).

Если хранилище данных не требуется, запишите файлы в `./outputs` папку и/или `./logs` .

>[!Important]
> Две папки, *выходные данные* и *журналы*, получают особую обработку, машинное обучение Azure. Во время обучения при записи файлов в `./outputs` папки и `./logs` папок файлы автоматически отправляются в журнал выполнения, чтобы к ним можно было получить доступ после завершения выполнения.

* **Для выходных данных, таких как сообщения о состоянии или результаты оценки,** запишите файлы в `./outputs` папку, чтобы они сохранялись как артефакты в журнале выполнения. Учитывать число и размер файлов, записанных в эту папку, так как задержка может произойти при передаче содержимого в журнал выполнения. Если задержка является проблемой, рекомендуется записывать файлы в хранилище данных.

* **Чтобы сохранить записанный файл в виде журналов в журнале выполнения,** запишите файлы в `./logs` папку. Журналы отправляются в режиме реального времени, поэтому этот метод подходит для потоковой передачи динамических обновлений из удаленного запуска.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о [доступе к данным из хранилищ данных](how-to-access-data.md).

* Дополнительные сведения о [создании целевых объектов вычислений для обучения и развертывания модели](how-to-create-attach-compute-studio.md)