---
title: 'ML Studio (классическая модель): локальная SQL Server — Azure'
description: Используйте данные из базы данных SQL Server для выполнения расширенной аналитики с помощью Машинное обучение Azure Studio (классическая модель).
services: machine-learning
ms.service: machine-learning
ms.subservice: studio-classic
ms.topic: how-to
author: likebupt
ms.author: keli19
ms.custom: seodec18
ms.date: 03/13/2017
ms.openlocfilehash: 8cdf1029371e0e11c38616e7800652ca9debbba7
ms.sourcegitcommit: e972837797dbad9dbaa01df93abd745cb357cde1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100517405"
---
# <a name="perform-analytics-with-azure-machine-learning-studio-classic-using-a-sql-server-database"></a>Выполнение анализа с помощью Машинное обучение Azure Studio (классическая модель) с использованием базы данных SQL Server

**ПРИМЕНИМО К:**  ![Применимо к.](../../../includes/media/aml-applies-to-skus/yes.png)Студия машинного обучения (классическая)   ![Неприменимо к.](../../../includes/media/aml-applies-to-skus/no.png)[Машинное обучение Azure](../overview-what-is-machine-learning-studio.md#ml-studio-classic-vs-azure-machine-learning-studio)


Зачастую на предприятиях, работающих с локальными данными, используются преимущества масштабируемости и гибкости облака для рабочих нагрузок машинного обучения. Но при этом на предприятиях не хотят нарушать свои текущие бизнес-процессы и рабочие процессы, перемещая их локальные данные в облако. Машинное обучение Azure Studio (классическая модель) теперь поддерживает чтение данных из базы данных SQL Server, а затем обучение и вычисление модели с этими данными. Больше не требуется вручную копировать и синхронизировать данные между облаком и локальным сервером. Вместо этого модуль **Импорт данных** в машинное обучение Azure Studio (классическая модель) теперь может считываться непосредственно из базы данных SQL Server для заданий обучения и оценки.

В этой статье приводятся общие сведения о том, как исходящий SQL Server данные в Машинное обучение Azure Studio (классическая модель). Предполагается, что вы знакомы с основными понятиями студии, такими как рабочие области, модули, наборы данных, эксперименты и *т. д.*

> [!NOTE]
> Эта функция недоступна для бесплатных рабочих областей. Дополнительные сведения о ценах на машинное обучение и его уровнях см. [здесь](https://azure.microsoft.com/pricing/details/machine-learning/).
>
>

<!-- -->



## <a name="install-the-data-factory-self-hosted-integration-runtime"></a>Установка локальной среды выполнения интеграции фабрики данных
Чтобы получить доступ к базе данных SQL Server в среде Машинное обучение Azure Studio (классической), необходимо скачать и установить локально размещенную Integration Runtime фабрики данных, которая ранее называлась шлюзом Управление данными. При настройке подключения в Машинное обучение Studio (классическая модель) можно загрузить и установить Integration Runtime (IR) с помощью диалогового окна **скачать и зарегистрировать шлюз данных** , как описано ниже.


Среду выполнения интеграции также можно установить заранее, скачав и запустив пакет установки MSI из [Центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=39717). С помощью пакета установки MSI также можно обновить существующую среду выполнения интеграции до последней версии с сохранением всех параметров.

Для установки локальной среды выполнения интеграции фабрики данных необходимо выполнить следующие предварительные требования:

* Для локальной среды выполнения интеграции фабрики данных необходима 64-разрядная операционная система с установленной платформой .NET Framework 4.6.1 или более поздней версии.
* Поддерживаемые версии ОС Windows: Windows 10 , Windows Server 2012, Windows Server 2012 R2 и Windows Server 2016. 
* Рекомендуемая конфигурация для компьютера, на котором будет размещена среда выполнения интеграции: четырехъядерный процессор с тактовой частотой не менее 2 ГГц, не менее 8 ГБ ОЗУ и не менее 80 ГБ дискового пространства.
* Если хост-компьютер находится в спящем режиме, IR не будет отвечать на запросы данных. Поэтому перед установкой среды выполнения интеграции на компьютере следует настроить соответствующую схему управления питанием. Если компьютер настроен для использования режима гибернации, то во время установки среды выполнения отобразится соответствующее сообщение.
* Так как циклы копирования выполняются с определенной частотой, ресурсы компьютера (ЦП, память) используются нерегулярно: есть пиковые нагрузки, и есть время простоя. Использование ресурсов также зависит от объема перемещаемых данных. Когда выполняется несколько заданий копирования, в пиковые периоды уровень использования ресурсов системы повышается. Выше приведены минимальные требования к конфигурации, технически являющейся достаточной. Мы рекомендуем всегда иметь больше ресурсов, чем указано для минимальной конфигурации, так как нагрузка зависит от объема перемещаемых данных.

При настройке локальной среды выполнения интеграции фабрики данных учитывайте следующее:

* На одном компьютере может быть установлен только один экземпляр среды выполнения интеграции.
* Для нескольких локальных источников данных можно использовать одну среду выполнения интеграции.
* Несколько сред выполнения интеграции на разных компьютерах можно подключить к одному и тому же локальному источнику данных.
* Вы настраиваете IRs только для одной рабочей области за раз. В настоящее время IRs нельзя совместно использовать в рабочих областях.
* Для одной рабочей области можно настроить несколько сред выполнения интеграции. Например, вы можете использовать IR-данные, подключенные к тестовым источникам данных во время разработки, и рабочий IR, когда будете готовы к эксплуатацию.
* Среда выполнения интеграции необязательно должна находиться на том же компьютере, что и источник данных. Но если он расположен вблизи источника данных, это ускоряет подключение шлюза к этому источнику. Мы рекомендуем установить среду выполнения интеграции на компьютере, отличном от того, на котором размещен локальный источник данных, чтобы среда выполнения интеграции не конкурировала с источником данных за использование ресурсов.
* Если на компьютере уже установлен IR, обслуживающий Power BI или сценарии фабрики данных Azure, установите отдельный IR для Машинное обучение Azure Studio (классическая модель) на другом компьютере.

  > [!NOTE]
  > Локальная среда выполнения интеграции фабрики данных и шлюз Power BI не могут находиться на одном и том же компьютере.
  >
  >
* Необходимо использовать локально размещенную Integration Runtime фабрики данных для Машинное обучение Azure Studio (классическая модель), даже если для других данных используется Azure ExpressRoute. Источник данных следует считать локальным (то есть защищенным брандмауэром), даже если используется ExpressRoute. Для связи между студией машинного обучения и источником данных следует использовать локальную среду выполнения интеграции фабрики данных.

Дополнительные сведения о предварительных требованиях для установки, этапах установки и устранении неполадок см. в статье [Среда выполнения интеграции в фабрике данных](../../data-factory/concepts-integration-runtime.md).

## <a name="span-idusing-the-data-gateway-step-by-step-walk-classanchorspan-id_toc450838866-classanchorspanspaningress-data-from-your-sql-server-database-into-azure-machine-learning"></a><span id="using-the-data-gateway-step-by-step-walk" class="anchor"><span id="_Toc450838866" class="anchor"></span></span>Передача данных из базы данных SQL Server в Машинное обучение Azure
В этом пошаговом руководстве вы настроите фабрику данных Azure Integration Runtime в Машинное обучение Azure рабочей области, настроите ее, а затем прочитаете данные из базы данных SQL Server.

> [!TIP]
> Перед началом работы отключите блокирование всплывающих окон в браузере `studio.azureml.net` . Если вы используете браузер Google Chrome, скачайте и установите один из нескольких подключаемых модулей, доступных в интернет-магазине Google Chrome в разделе [расширений для приложений Click Once](https://chrome.google.com/webstore/search/clickonce?_category=extensions).
>
> [!NOTE]
> Локальная среда выполнения интеграции фабрики данных Azure ранее называлась "шлюзом управления данными". В этом пошаговом руководстве она по-прежнему будет называться "шлюзом".  

### <a name="step-1-create-a-gateway"></a>Шаг 1. Создание шлюза
Первым шагом является создание и Настройка шлюза для доступа к базе данных SQL.

1. Войдите в [машинное обучение Azure Studio (классическая модель)](https://studio.azureml.net/Home/) и выберите рабочую область, в которой вы хотите работать.
2. Щелкните колонку **Параметры** слева и выберите вкладку **Шлюзы данных** вверху.
3. Щелкните **НОВЫЙ ШЛЮЗ ДАННЫХ** в нижней части экрана.

    ![Новый шлюз данных](./media/use-data-from-an-on-premises-sql-server/new-data-gateway-button.png)
4. В диалоговом окне **Новый шлюз данных** введите **имя шлюза** и при необходимости добавьте его **описание**. Щелкните стрелку в нижнем правом углу, чтобы перейти к следующему шагу настройки.

    ![Ввод имени и описания шлюза данных](./media/use-data-from-an-on-premises-sql-server/new-data-gateway-dialog-enter-name.png)
5. В диалоговом окне Download and register data gateway (Скачивание и регистрация шлюза данных) скопируйте ключ регистрации шлюза в буфер обмена.

    ![Download and register data gateway (Скачивание и регистрация шлюза данных)](./media/use-data-from-an-on-premises-sql-server/download-and-register-data-gateway.png)
6. <span id="note-1" class="anchor"></span>Если вы еще не скачали и не установили шлюз управления данными Майкрософт, щелкните **Download data management gateway**(Скачать шлюз управления данными). Вы перейдете в Центр загрузки Майкрософт, где можно выбрать нужную версию шлюза, скачать ее и установить. Дополнительные сведения о необходимых условиях для установки, этапах установки и устранении неполадок можно найти в подразделах в начале статьи [Перемещение данных между локальными источниками и облаком при помощи шлюза управления данными](../../data-factory/tutorial-hybrid-copy-portal.md).
7. После установки шлюза откроется диспетчер конфигурации шлюза управления данными и появится диалоговое окно **Регистрация шлюза** . Вставьте **ключ регистрации шлюза**, скопированный в буфер обмена, и нажмите кнопку **Зарегистрировать**.
8. Если вы уже установили шлюз, запустите диспетчер конфигурации шлюза управления данными. Щелкните **Изменить ключ**, вставьте **ключ регистрации шлюза**, скопированный в буфер обмена на предыдущем шаге, и нажмите кнопку **ОК**.
9. Когда установка будет завершена, отобразится диалоговое окно **Регистрация шлюза** для диспетчера конфигурации шлюза управления данными Майкрософт. Вставьте ключ регистрации шлюза, скопированный в буфер обмена на предыдущем шаге, и щелкните **Зарегистрировать**.

    ![Зарегистрировать шлюз](./media/use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-register-gateway.png)
10. Настройка шлюза будет завершена после задания следующих значений на вкладке **Главная** в диспетчере конфигурации шлюза управления данными Майкрософт.

    * В полях **Имя шлюза** и **Имя экземпляра** указывается имя шлюза.
    * Для параметра **Регистрация** установлено значение **Зарегистрировано**.
    * В поле **Состояние** установлено значение **Запущено**.
    * Строка состояния в нижней части экрана **подключена к облачной службе Управление данными Gateway** вместе с зеленой галочкой.

      ![Диспетчер шлюза управления данными](./media/use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-registered.png)

      Машинное обучение Azure Studio (классическая модель) также обновляется после успешной регистрации.

    ![Успешная регистрация шлюза](./media/use-data-from-an-on-premises-sql-server/gateway-registered.png)
11. В диалоговом окне **Download and register data gateway** (Скачивание и регистрация шлюза данных) щелкните галочку, чтобы завершить настройку. На странице **Параметры** отображается состояние шлюза "В сети". В области справа можно просмотреть состояние и другие полезные сведения.

    ![Параметры шлюза](./media/use-data-from-an-on-premises-sql-server/gateway-status.png)
12. В шлюзе Microsoft Управление данными Configuration Manager перейдите на вкладку **сертификат** . Сертификат, указанный на этой вкладке, используется для шифрования и расшифровки учетных данных локального хранилища данных, указанного на портале. Это созданный по умолчанию сертификат. Корпорация Майкрософт рекомендует заменить его собственным сертификатом, сохраненном в системе управления сертификатами. Чтобы использовать вместо него собственный сертификат, щелкните **Изменить** .

    ![Изменение сертификата шлюза](./media/use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-certificate.png)
13. (Необязательно.) Если для устранения проблем со шлюзом вы хотите использовать подробное ведение журнала, то в диспетчере конфигурации шлюза управления данными перейдите на вкладку **Диагностика** и установите флажок **Включить запись подробных сведений в журнал для устранения неполадок**. Сведения о ведении журнала можно найти в Просмотр событий Windows в разделе **журналы приложений и служб**  - &gt; **Управление данными узле шлюз** . На вкладке **Диагностика** можно также проверить подключение к локальному источнику данных через шлюз.

    ![Включить подробное ведение журнала](./media/use-data-from-an-on-premises-sql-server/data-gateway-configuration-manager-verbose-logging.png)

Процесс установки шлюза завершается в Машинное обучение Azure Studio (классическая модель).
Теперь все готово к использованию локальных данных.

Для каждой рабочей области можно создать и настроить несколько шлюзов в студии (классическая модель). Например, можно использовать один шлюз, который будет подключаться к тестовым источникам данных во время разработки, и второй шлюз для подключения к рабочим источникам данных. Машинное обучение Azure Studio (классическая модель) предоставляет гибкие возможности настройки нескольких шлюзов в зависимости от корпоративной среды. В настоящее время шлюз между рабочими областями нельзя использовать, и на одном компьютере можно установить только один шлюз. Дополнительные сведения см. в статье [Перемещение данных между локальными источниками и облаком с помощью шлюза управления данными](../../data-factory/tutorial-hybrid-copy-portal.md).

### <a name="step-2-use-the-gateway-to-read-data-from-an-on-premises-data-source"></a>Шаг 2. Использование шлюза для чтения данных из локального источника данных
После настройки шлюза можно добавить модуль **Импорт данных** в эксперимент, который вводит данные из базы данных SQL Server.

1. В Машинное обучение Studio (классическая модель) выберите вкладку **эксперименты** , щелкните **+ создать** в левом нижнем углу и выберите **пустой эксперимент** (или выберите один из нескольких примеров экспериментов).
2. Найдите и перетащите модуль **Импорт данных** на холст эксперимента.
3. Внизу холста нажмите кнопку **Сохранить как** . В поле имя эксперимента введите "Машинное обучение Azure Studio (классическая модель) SQL Server". Выберите рабочую область и нажмите кнопку **ОК** .

   ![Сохранение эксперимента с новым именем](./media/use-data-from-an-on-premises-sql-server/experiment-save-as.png)
4. Щелкните модуль **Импорт данных**, чтобы выбрать его, а затем в области **Свойства** справа от полотна в раскрывающемся списке **Источник данных** выберите "Локальная база данных SQL".
5. Выберите **шлюз данных** , который вы установили и зарегистрировали. Вы можете установить еще один шлюз, выбрав "(Добавить шлюз данных…)".

   ![Выбор шлюза данных для модуля импорта данных](./media/use-data-from-an-on-premises-sql-server/import-data-select-on-premises-data-source.png)
6. Введите **имя сервера базы данных SQL** и **имя базы данных SQL**, а также **SQL-запрос к базе данных**, который требуется выполнить.
7. Нажмите кнопку **Enter values** (Введите значения) в разделе **Имя пользователя и пароль** и введите учетные данные базы данных. Можно использовать встроенную проверку подлинности Windows или проверку подлинности SQL Server в зависимости от настройки SQL Server.

   ![Ввод учетных данных базы данных](./media/use-data-from-an-on-premises-sql-server/database-credentials.png)

   Сообщение "values required" (Требуются значения) изменится на "values set" (Значения заданы) с зеленой галочкой. Необходимо только один раз ввести учетные данные, если только не изменится информация о базе данных или пароль. Машинное обучение Azure Studio (классическая модель) использует сертификат, указанный при установке шлюза для шифрования учетных данных в облаке. Azure никогда не хранит локальные учетные данные без шифрования.

   ![Свойства модуля "Импорт данных"](./media/use-data-from-an-on-premises-sql-server/import-data-properties-entered.png)
8. Щелкните **ЗАПУСТИТЬ** , чтобы выполнить эксперимент.

После завершения работы эксперимента можно визуализировать данные, импортированные из базы данных, щелкнув порт вывода модуля **Импорт данных** и выбрав **визуализировать**.

После завершения разработки эксперимента можно развернуть и ввести в эксплуатацию свою модель. При использовании службы пакетного выполнения данные из базы данных SQL Server, настроенной в модуле **Импорт данных** , будут считаться и использоваться для оценки. Хотя вы можете для оценки локальных данных использовать службу ответа на запросы, вместо нее корпорация Майкрософт рекомендует использовать [надстройку Excel](excel-add-in-for-web-services.md) . В настоящее время запись в базу данных SQL Server через **Экспорт данных** не поддерживается ни в экспериментах, ни в опубликованных веб-службах.