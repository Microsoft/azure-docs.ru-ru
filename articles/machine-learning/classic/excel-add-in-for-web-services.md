---
title: 'ML Studio (классическая модель): надстройка Excel для веб-служб — Azure'
description: Использование веб-служб машинного обучения Azure непосредственно из Excel без написания кода.
services: machine-learning
ms.service: machine-learning
ms.subservice: studio-classic
ms.topic: how-to
author: likebupt
ms.author: keli19
ms.custom: seodec18
ms.date: 02/01/2018
ms.openlocfilehash: 45d9e494b9f885cfa0680bec595aefcd4074d41e
ms.sourcegitcommit: e972837797dbad9dbaa01df93abd745cb357cde1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100520006"
---
# <a name="excel-add-in-for-azure-machine-learning-studio-classic-web-services"></a>Надстройка Excel для веб-служб Машинное обучение Azure Studio (классическая модель)

**ПРИМЕНИМО К:**  ![Применимо к.](../../../includes/media/aml-applies-to-skus/yes.png)Студия машинного обучения (классическая)   ![Неприменимо к.](../../../includes/media/aml-applies-to-skus/no.png)[Машинное обучение Azure](../overview-what-is-machine-learning-studio.md#ml-studio-classic-vs-azure-machine-learning-studio)


Excel упрощает непосредственный вызов веб-служб без необходимости написания какого-либо кода.

## <a name="steps-to-use-an-existing-web-service-in-the-workbook"></a>Использование существующей веб-службы в книге Excel

1. Откройте [пример файла Excel](https://aka.ms/amlexcel-sample-2), который содержит надстройки Excel и данные о пассажирах "Титаника". 
 
    > [!NOTE]
    > - Вы увидите список веб-служб, связанных с файлом, и флажок автоматического прогнозирования в нижней части экрана. Если установить этот флажок, прогнозы **всех** служб будут обновляться каждый раз после изменения входных данных. Если флажок не установлен, обновить прогнозы можно с помощью кнопки Predict All (Прогнозировать все). Чтобы включить автоматическое прогнозирование на уровне службы, перейдите к шагу 6.
    > - Надстройка Машинное обучение Azure Excel будет вызывать магазин надстроек Office для загрузки. Если ваша организация запрещает доступ к магазину надстроек Office, при загрузке надстройки будет отображаться сообщение об ошибке. В этом случае разверните надстройку Машинное обучение Azure Excel из центра администрирования Microsoft 365. Затем вызовите надстройку и добавьте веб-службу вручную, вставив URL-адрес и ключ API.

 

2. Выберите веб-службу, щелкнув по ней. В данном примере это "Прогноз выживших на "Титанике" (пример надстройки Excel)".
   
    ![Выберите веб-службу](./media/excel-add-in-for-web-services/image1.png)
3. Вы перейдете в раздел **Прогноз**.  Эта книга уже содержит образцы данных. В пустой книге можно выбрать ячейку в Excel и щелкнуть **Use sample data** (Использовать образцы данных).
4. Выделите данные с заголовками и щелкните значок диапазона входных данных.  Убедитесь, что установлен флажок "Мои данные содержат заголовки".
5. В разделе **Вывод** введите номер ячейки, в которую следует поместить выходные данные, в нашем примере это "H1".
6. Нажмите **Выполнить прогноз**. Если установить флажок автоматического прогнозирования, любые изменения в выбранных областях (указанные как входные данные) будут инициировать запрос и обновлять выходные ячейки без нажатия кнопки прогнозирования.
   
    ![Раздел «Прогноз»](./media/excel-add-in-for-web-services/image1.png)

Разверните новую веб-службу или используйте уже существующую. Дополнительные сведения о развертывании веб-службы см. в разделе [учебник 3. Развертывание модели кредитных рисков](tutorial-part3-credit-risk-deploy.md).

Получите ключ API для веб-службы. Источник получения ключа зависит от способа публикации: как классическая или как новая веб-служба машинного обучения.

**Использование классической веб-службы** 

1. В Машинное обучение Studio (классическая модель) щелкните раздел **веб-службы** на левой панели, а затем выберите веб-службу.
   
    ![Выбор веб-службы в студии машинного обучения](./media/excel-add-in-for-web-services/image4.png)
2. Скопируйте ключ API для веб-службы.
   
    ![Ключ API в Студии машинного обучения](./media/excel-add-in-for-web-services/image5.png)
3. На вкладке **Панель мониторинга** веб-службы щелкните ссылку **Запрос-ответ**.
4. Найдите раздел **Request URI** (URI запроса).  Скопируйте и сохраните URL-адрес.

> [!NOTE]
> Теперь можно войти на портал [веб-служб машинное обучение Azure](https://services.azureml.net) , чтобы получить ключ API для классической веб-службы машинное обучение.
> 
> 

**Использовать новую веб-службу**

1. На портале [веб-служб машинное обучение Azure](https://services.azureml.net) щелкните **веб-службы**, а затем выберите свою веб-службу. 
2. Щелкните **Consume**(Использование).
3. Найдите раздел **Basic consumption info** (Основные сведения об использовании). Скопируйте и сохраните **первичный ключ** и URL-адрес **запроса-ответа**.

## <a name="steps-to-add-a-new-web-service"></a>Действия для добавления новой веб-службы

1. Разверните новую веб-службу или используйте уже существующую. Дополнительные сведения о развертывании веб-службы см. в разделе [учебник 3. Развертывание модели кредитных рисков](tutorial-part3-credit-risk-deploy.md).
2. Щелкните **Consume**(Использование).
3. Найдите раздел **Basic consumption info** (Основные сведения об использовании). Скопируйте и сохраните **первичный ключ** и URL-адрес **запроса-ответа**.
4. В Excel перейдите к разделу **веб-службы** (если вы используете раздел **Predict** , щелкните стрелку "назад", чтобы перейти к списку веб-служб).
   
    ![Переход к выбору веб-службы](./media/excel-add-in-for-web-services/image3.png)
5. Щелкните **Добавить веб-службу**.
6. Вставьте URL-адрес в текстовое поле с меткой **URL** в надстройке Excel.
7. Вставьте ключ API (или первичный ключ) в текстовое поле с меткой **Ключ API**.
8. Нажмите кнопку **Добавить**.
   
    ![URL-адрес и ключ API для классической веб-службы.](./media/excel-add-in-for-web-services/image6.png)
9. Чтобы использовать веб-службу, следуйте инструкциям, указанным выше в разделе "Использование существующей веб-службы".

## <a name="sharing-your-workbook"></a>Предоставление общего доступа к книге
Во время сохранения книги также сохраняются ключи API (или первичные ключи) для веб-служб, которые вы добавили. Это означает, что доступ к книге следует предоставлять только тем лицам, которым вы доверяете.

Любые вопросы можно задать ниже в разделе комментариев или на нашем [форуме](/answers/topics/azure-machine-learning.html).