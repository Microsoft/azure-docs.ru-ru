---
title: Выполнение пакетных прогнозов с помощью конструктора Машинного обучения Azure
titleSuffix: Azure Machine Learning
description: Узнайте, как создать конвейер пакетной прогнозирования. Разверните конвейер в качестве параметризованной веб-службы и активируйте его из любой библиотеки HTTP.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.author: keli19
author: likebupt
ms.date: 02/05/2020
ms.topic: conceptual
ms.custom: how-to, designer
ms.openlocfilehash: dda47d3ff561d4d57045dbb28f8c411e193086d5
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "101657376"
---
# <a name="run-batch-predictions-using-azure-machine-learning-designer"></a>Выполнение пакетных прогнозов с помощью конструктора Машинного обучения Azure


Из этой статьи вы узнаете, как использовать конструктор для создания конвейера пакетного прогнозирования. Пакетное прогнозирование позволяет постоянно оценивать большие наборы данных по запросу с помощью веб-службы, которую можно активировать из любой библиотеки HTTP.

В этом практическом руководстве описано, как выполнять следующие задачи:

> [!div class="checklist"]
> * создание и публикация конвейера пакетного вывода;
> * использование конечной точки конвейера;
> * управление версиями конечных точек.

Сведения о настройке служб пакетной оценки с помощью пакета SDK см. в соответствующем [практическом руководстве](./tutorial-pipeline-batch-scoring-classification.md).

## <a name="prerequisites"></a>Предварительные требования

В этом руководстве предполагается, что у вас уже есть обучающий конвейер. Вводные сведения о конструкторе вы можете найти в [первой части руководства по конструктору](tutorial-designer-automobile-price-train-score.md). 

[!INCLUDE [machine-learning-missing-ui](../../includes/machine-learning-missing-ui.md)]

## <a name="create-a-batch-inference-pipeline"></a>Создание конвейера пакетного вывода

Обучающий конвейер должен быть запущен по крайней мере один раз, чтобы можно было создать конвейер вывода.

1. Перейдите на вкладку **Конструктор** в рабочей области.

1. Выберите обучающий конвейер, обучающий модель, которую вы хотите использовать для прогнозирования.

1. **Запустите** конвейер.

    ![Отправка конвейера](./media/how-to-run-batch-predictions-designer/run-training-pipeline.png)

Теперь, когда обучающий конвейер запущен, можно создать конвейер пакетного вывода.

1. Рядом с кнопкой **запуска** выберите новый раскрывающийся список **Создать конвейер вывода**.

1. Выберите **Конвейер пакетного вывода**.

    ![Создание конвейера пакетного вывода](./media/how-to-run-batch-predictions-designer/create-batch-inference.png)
    
Результатом является конвейер пакетного вывода по умолчанию. 

### <a name="add-a-pipeline-parameter"></a>Добавление параметра конвейера

Чтобы создать прогнозы для новых данных, можно либо вручную подключить другой набор данных в представлении черновика конвейера, либо создать параметр для набора данных. Параметры позволяют изменить поведение процесса пакетного вывода во время выполнения.

В этом разделе вы создадите параметр набора данных, чтобы указать другой набор данных для создания прогнозов.

1. Выберите модуль набор данных.

1. Справа от холста появится панель. В нижней части панели выберите **Задать в качестве параметра конвейера**.
   
    Введите имя параметра или примите значение по умолчанию.

    > [!div class="mx-imgBorder"]
    > ![Задание набора данных в качестве параметра конвейера](./media/how-to-run-batch-predictions-designer/set-dataset-as-pipeline-parameter.png)

## <a name="publish-your-batch-inference-pipeline"></a>Публикация конвейера пакетного вывода

Теперь можно приступать к развертыванию конвейера вывода. Это позволит развернуть конвейер и сделать его доступным для использования другими.

1. Нажмите кнопку **Опубликовать**.

1. В появившемся диалоговом окне разверните раскрывающийся список **Конечная точка конвейера** и выберите **Новая конечная точка конвейера**.

1. Укажите имя конечной точки и при необходимости — описание.

    В нижней части диалогового окна отображается параметр, который вы настроили со значением по умолчанию, — идентификатор набора данных, используемого во время обучения.

1. Нажмите кнопку **Опубликовать**.

![Публикация конвейера](./media/how-to-run-batch-predictions-designer/publish-inference-pipeline.png)


## <a name="consume-an-endpoint"></a>Использование конечной точки

Теперь у вас есть опубликованный конвейер с параметром набора данных. Конвейер будет использовать обученную модель, созданную в обучающем конвейере, для оценки набора данных, предоставленного в качестве параметра.

### <a name="submit-a-pipeline-run"></a>Запустите конвейер 

В этом разделе вы настроите ручной запуск конвейера и измените параметр конвейера для оценки новых данных. 

1. После завершения развертывания перейдите к разделу **Конечные точки**.

1. Выберите **Конечные точки конвейера**.

1. Выберите имя созданной вами конечной точки.

![Ссылка на конечную точку](./media/how-to-run-batch-predictions-designer/manage-endpoints.png)

1. Выберите **Опубликованные конвейеры**.

    На этом экране отображаются все конвейеры, опубликованные в указанной конечной точке.

1. Выберите опубликованный конвейер.

    На странице сведений о конвейере отображается подробный журнал выполнения и сведения о строке подключения к вашему конвейеру. 
    
1. Нажмите **Запустить**, чтобы осуществить выполнение конвейера вручную.

    ![Сведения о конвейере](./media/how-to-run-batch-predictions-designer/submit-manual-run.png)
    
1. Измените параметр, чтобы использовать другой набор данных.
    
1. Нажмите **Запустить**, чтобы запустить конвейер.

### <a name="use-the-rest-endpoint"></a>Использование конечной точки REST

Сведения об использовании конечных точек конвейера и опубликованных конвейерах см. в разделе **Конечные точки**.

Конечную точку REST конечной точки конвейера можно найти на панели обзора запуска. Вызывая конечную точку, вы используете опубликованный конвейер по умолчанию.

Опубликованный конвейер можно также использовать на странице **Опубликованные конвейеры**. Выберите опубликованный конвейер, и конечную точку RESTFUL можно найти на панели **Обзор опубликованного конвейера** справа от диаграммы. 

Чтобы выполнить вызов REST, потребуется заголовок аутентификации на основе носителя OAuth 2.0. Дополнительные сведения о настройке аутентификации в рабочей области и выполнении параметризованного вызова REST см. в следующем [разделе руководства](tutorial-pipeline-batch-scoring-classification.md#publish-and-run-from-a-rest-endpoint).

## <a name="versioning-endpoints"></a>Управление версиями конечных точек

Конструктор назначает версию каждому последующему конвейеру, который публикуется в конечной точке. Вы можете указать версию конвейера, которую требуется выполнить в качестве параметра вызова REST. Если номер версии не указан, конструктор будет использовать конвейер по умолчанию.

При публикации конвейера можно сделать его новым конвейером по умолчанию для этой конечной точки.

![Установка конвейера по умолчанию](./media/how-to-run-batch-predictions-designer/set-default-pipeline.png)

Новый конвейер по умолчанию можно также задать на вкладке **Опубликованные конвейеры** конечной точки.

![Настройка конвейера по умолчанию на странице опубликованного конвейера](./media/how-to-run-batch-predictions-designer/set-new-default-pipeline.png)

## <a name="limitations"></a>Ограничения

Если вы вносите некоторые изменения в обучающий конвейер, необходимо повторно отправить обучающий конвейер, **Обновить**  конвейер вывода и снова запустить конвейер вывода.

Обратите внимание, что в конвейере вывода будут обновляться только модели, а преобразование данных не будет обновлено.

Чтобы использовать обновленное преобразование в конвейере вывода, вам потребуется зарегистрировать выходные данные преобразования, предоставленные модулем преобразования, в виде набора данных.

![Снимок экрана: как зарегистрировать набор данных преобразования](./media/how-to-run-batch-predictions-designer/register-transformation-dataset.png)

Затем вручную замените модуль **TD-** в конвейере вывода зарегистрированным набором данных.

![Снимок экрана: как заменить модуль преобразования](./media/how-to-run-batch-predictions-designer/replace-td-module-batch-inference-pipeline.png)

Затем можно отправить конвейер вывода с обновленной моделью и преобразованием и опубликовать.

## <a name="next-steps"></a>Дальнейшие действия

Чтобы обучить и развернуть регрессионную модель, следуйте указаниям в [учебнике](tutorial-designer-automobile-price-train-score.md) по конструктору.
''
