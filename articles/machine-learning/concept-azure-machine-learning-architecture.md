---
title: Архитектура и основные понятия
titleSuffix: Azure Machine Learning
description: В этой статье вы получите общее представление об архитектуре, терминах и концепциях, которые составляют Машинное обучение Azure.
services: machine-learning
ms.service: machine-learning
ms.subservice: core
ms.topic: conceptual
ms.author: sgilley
author: sdgilley
ms.date: 08/20/2020
ms.custom: seoapril2019, seodec18
ms.openlocfilehash: dc1954c97da0d7f40deaf0f4efa7ca99793107bb
ms.sourcegitcommit: e6de1702d3958a3bea275645eb46e4f2e0f011af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102503697"
---
# <a name="how-azure-machine-learning-works-architecture-and-concepts"></a>Машинное обучение Azure: архитектура и основные понятия

Сведения об архитектуре и концепциях для [машинное обучение Azure](overview-what-is-azure-ml.md).  В этой статье приводятся общие сведения о компонентах и их взаимодействии, которые помогут в процессе создания, развертывания и обслуживания моделей машинного обучения.

## <a name="workspace"></a><a name="workspace"></a> Рабочей области

[Рабочая область машинного обучения](concept-workspace.md) — это ресурс верхнего уровня для машинное обучение Azure.

:::image type="content" source="media/concept-azure-machine-learning-architecture/architecture.svg" alt-text="Схема: Машинное обучение Azure архитектура рабочей области и ее компонентов":::

Рабочая область — это централизованное место:

* Управление ресурсами, используемыми для обучения и развертывания моделей, например [вычислений](#compute-instance)
* Сохраняйте ресурсы, создаваемые при использовании Машинное обучение Azure, включая:
  * [Среды](#environments)
  * [Эксперименты](#experiments)
  * [Конвейеры](#ml-pipelines)
  * [Наборы данных](#datasets-and-datastores)
  * [Models](#models)
  * [Конечные точки](#endpoints)

Рабочая область содержит другие ресурсы Azure, используемые рабочей областью:

+ [Реестр контейнеров Azure (запись контроля доступа)](https://azure.microsoft.com/services/container-registry/): регистрирует контейнеры DOCKER, используемые во время обучения и при развертывании модели. Чтобы сократить затраты, запись контроля доступа создается только при создании образов развертывания.
+ [Учетная запись хранения Azure](https://azure.microsoft.com/services/storage/). используется в качестве хранилища данных по умолчанию для рабочей области.  Здесь также хранятся записные книжки Jupyter, которые используются с Машинное обучение Azureными экземплярами для вычислений.
+ [Azure Application Insights](https://azure.microsoft.com/services/application-insights/): хранит сведения о мониторинге моделей.
+ [Azure Key Vault](https://azure.microsoft.com/services/key-vault/): хранит секреты, используемые целевыми объектами вычислений и другими важными сведениями, необходимыми для рабочей области.

Вы можете использовать рабочую область совместно с другими пользователями.

## <a name="computes"></a>Вычисляет

<a name="compute-targets"></a>[Целевой объект вычислений](concept-compute-target.md) — это любой компьютер или набор компьютеров, используемых для запуска сценария обучения или размещения развертывания службы. В качестве целевого объекта вычислений можно использовать локальный компьютер или удаленный ресурс вычислений.  С помощью целевых объектов вычислений вы можете начать обучение на локальном компьютере, а затем масштабировать его в облако, не меняя сценарий обучения.

В Машинное обучение Azure представлены две полностью управляемые облачные виртуальные машины, которые настроены для задач машинного обучения.

* <a name="compute-instance"></a>**Вычислительный экземпляр**. вычислительный экземпляр — это виртуальная машина, которая включает в себя несколько средств и сред, установленных для машинного обучения. Основное использование вычислительного экземпляра предназначено для рабочей станции разработки.  Вы можете начать работу с примерами записных книжек, не требующих настройки. Вычислительный экземпляр можно также использовать в качестве целевого объекта вычислений для обучения и задания с обработкой.

* **Кластеры вычислений**: кластеры виртуальных машин с возможностями масштабирования с несколькими узлами. Кластеры вычислений лучше подходят для целевых платформ вычислений для больших заданий и рабочей среды.  Кластер автоматически масштабируется при отправке задания.  Используйте в качестве цели для обучающих вычислений или для развертывания разработки и тестирования.

Дополнительные сведения о целевых объектах вычислений для обучения см. в разделе [обучение целевых вычислений](concept-compute-target.md#train).  Дополнительные сведения о целевых объектах для вычислений развертывания см. в разделе [цели развертывания](concept-compute-target.md#deploy).

## <a name="datasets-and-datastores"></a>Наборы данных и хранилища данных

[**Машинное обучение Azure наборы**](concept-data.md#datasets)  данных упрощают доступ к данным и работу с ними. Создавая набор данных, вы создаете ссылку на расположение источника данных вместе с копией его метаданных. Поскольку данные остаются в существующем расположении, не взимается дополнительная плата за хранение и не рискуйте целостность источников данных.

Дополнительные сведения см. в статье [Создание наборов данных Машинного обучения Azure](how-to-create-register-datasets.md).  Дополнительные примеры использования наборов данных см. в разделе с [примерами записных книжек](https://github.com/Azure/MachineLearningNotebooks/tree/master/how-to-use-azureml/work-with-data/datasets-tutorial).

Для безопасного подключения к службам хранилища Azure наборы данных используют [хранилища](concept-data.md#datastores) данных. Хранилища данных хранят сведения о подключении, не помещая при этом учетные данные проверки подлинности и целостность исходного источника. Они хранят сведения о подключении, такие как идентификатор подписки и авторизация маркера, в Key Vault, связанных с рабочей областью, поэтому вы можете безопасно получать доступ к хранилищу без необходимости жестко кодировать их в сценарии.

## <a name="environments"></a>Среды

[Рабочая область](#workspace)  >  **Среды**

[Среда](concept-environments.md) — это инкапсуляция среды, в которой происходит обучение или оценка модели машинного обучения. Среда определяет пакеты Python, переменные среды и параметры программного обеспечения для сценариев обучения и оценки.  

Примеры кода см. в разделе "Управление средами" статьи [использование сред](how-to-use-environments.md#manage-environments).

## <a name="experiments"></a>Эксперименты

[Рабочая область](#workspace)  >  **Эксперименты**

Эксперимент представляет собой совокупность нескольких запусков указанного сценария. Он всегда принадлежит рабочей области. При отправке запуска укажите имя эксперимента. Сведения о запуске хранятся в этом эксперименте. Если при отправке эксперимента имя не существует, автоматически создается новый эксперимент.
  
Пример использования эксперимента приведен в статье [ Руководство по обучению модели Машинного обучения](tutorial-1st-experiment-sdk-train.md).

### <a name="runs"></a>Запуски

[Рабочая область](#workspace)  >  [Эксперименты](#experiments)  >  **Выполнение**

Выполнение — это однократный запуск скрипта обучения. Обычно эксперимент содержит большое число выполнений.

Машинное обучение Azure записывает все выполнения и сохраняет в эксперименте следующую информацию:

* метаданные о запуске (метка времени, длительность и т. д.);
* метрики, записанные в журнал с помощью сценария;
* выходные файлы, автоматически собранные экспериментом или явным образом переданные вами;
* моментальный снимок каталога, содержащего скрипты, до запуска;

Вы создаете запуск при отправке сценария для обучения модели. Запуск может иметь ноль или более дочерних запусков. Например, запуск верхнего уровня может иметь два дочерних запуска, каждый из которых может иметь свои дочерние запуски.

### <a name="run-configurations"></a>Конфигурации выполнения

[Рабочая область](#workspace)  >  [Эксперименты](#experiments)  >  [Выполнение](#runs)  >  **Конфигурация запуска**

Конфигурация запуска определяет, как скрипт должен выполняться в указанном целевом объекте вычислений. Используйте конфигурацию, чтобы указать скрипт, целевой объект вычислений и среду машинного обучения Azure для выполнения, любые распределенные конфигурации заданий и некоторые дополнительные свойства. Дополнительные сведения о полном наборе настраиваемых параметров для запусков см. в разделе [скриптрунконфиг](/python/api/azureml-core/azureml.core.scriptrunconfig).

Конфигурацию запуска можно сохранить в файл внутри каталога, содержащего сценарий обучения.   Либо он может быть создан как объект в памяти и использован для отправки выполнения.

Примеры конфигурации запуска см. [в разделе Настройка обучающего запуска](how-to-set-up-training-targets.md).

### <a name="snapshots"></a>Моментальные снимки

[Рабочая область](#workspace)  >  [Эксперименты](#experiments)  >  [Выполнение](#runs)  >  **Моментальный снимок**

При отправке запуска Машинное обучение Azure сжимает каталог, содержащий сценарий, как ZIP-файл и отправляет его в целевой объект вычислений. ZIP-файл затем извлекается, и сценарий выполняется в нем. Машинное обучение Azure также сохраняет ZIP-файл в качестве моментального снимка как часть записи о выполнении. Любой пользователь с доступом к рабочей области может просмотреть запись о выполнении и загрузить моментальный снимок.

### <a name="logging"></a>Ведение журнала

Машинное обучение Azure автоматически записывает метрики стандартных запусков. Однако можно также [использовать пакет SDK для Python для регистрации произвольных метрик](how-to-track-experiments.md).

Существует несколько способов просмотра журналов: наблюдение за состоянием выполнения в режиме реального времени или просмотр результатов после завершения. Дополнительные сведения см. в статье [мониторинг и просмотр журналов выполнения машинного обучения](how-to-monitor-view-training-logs.md).


> [!NOTE]
> [!INCLUDE [amlinclude-info](../../includes/machine-learning-amlignore-gitignore.md)]

### <a name="git-tracking-and-integration"></a>Отслеживание и интеграция Git

При выполнении запуска обучения, в котором исходный каталог является локальным репозиторием Git, сведения о репозитории хранятся в журнале выполнения. Это работает с запусками, отправленными с помощью скрипта конфигурации запуска или конвейера ML. А также для выполнений, отправленных с помощью пакетов SDK или CLI Машинного обучения.

Дополнительные сведения см. в статье [Интеграция с Git для Машинного обучения Azure](concept-train-model-git-integration.md).

### <a name="training-workflow"></a>Рабочий процесс обучения

При запуске эксперимента для обучения модели выполняются следующие действия. Они показаны на схеме рабочего процесса обучения ниже:

* Машинное обучение Azure вызывается с помощью идентификатора моментального снимка для моментального снимка кода, сохраненного в предыдущем разделе.
* Машинное обучение Azure создает идентификатор запуска (необязательно) и маркер проверки подлинности Службы машинного обучения, который позже используется целевыми объектами вычислений, такими как Вычислительная среда Машинного обучения или виртуальные машины для взаимодействия со Службой машинного обучения.
* Для выполнения заданий обучения можно выбрать управляемый целевой объект вычислений (например, Вычислительная среда Машинного обучения) или неуправляемый целевой объект вычислений (например, виртуальные машины). Ниже приведены потоки данных для обоих сценариев:
   * Виртуальные машины или HDInsight, доступ к которым осуществляется с помощью учетных данных SSH в хранилище ключей в подписке Майкрософт. Машинное обучение Azure выполняет код управления на целевом объекте вычислений, который:

   1. Подготавливает среду. (Docker является параметром для виртуальных машин и локальных компьютеров. Чтобы понять, как работают запущенные эксперименты в контейнерах Docker, ознакомьтесь со следующими шагами для Вычислительной среды Машинного обучения.)
   1. Скачивает код.
   1. Настраивает переменные и конфигурации среды.
   1. Запускает пользовательские сценарии (моментальный снимок кода, упомянутый в предыдущем разделе).

   * Вычислительная среда Машинного обучения, доступ к которой осуществляется с помощью удостоверения, управляемого рабочей областью.
Так как Вычислительная среда Машинного обучения является управляемым целевым объектом вычислений (т. е. управляется корпорацией Майкрософт), она выполняется в вашей подписке Майкрософт.

   1. При необходимости запускается удаленное построение Docker.
   1. Код управления записывается в общую папку пользователя Файлов Azure.
   1. Контейнер запускается с помощью начальной команды. Это и есть код управления, описанный в предыдущем шаге.

* После завершения выполнения можно запросить запуски и метрики. На приведенной ниже схеме потока этот шаг выполняется, когда целевой объект вычислений для обучения записывает метрики выполнения обратно в Машинное обучение Azure из хранилища в базе данных Cosmos DB. Машинное обучение Azure могут вызывать клиенты. Машинное обучение, в свою очередь, будет извлекать метрики из базы данных Cosmos DB и возвращать их обратно клиенту.

[![Рабочий процесс обучения](media/concept-azure-machine-learning-architecture/training-and-metrics.png)](media/concept-azure-machine-learning-architecture/training-and-metrics.png#lightbox)

## <a name="models"></a>Модели

В простейшем смысле модель представляет собой фрагмент кода, который принимает входные данные и создает выходные данные. Создание модели машинного обучения включает в себя выбор алгоритма, предоставление ему данных и [настройку параметров](how-to-tune-hyperparameters.md). Обучение — это итеративный процесс, который создает обученную модель, включающую в себя все, чему модель научилась в процессе обучения.

Вы можете перенести модель, обученную за пределами Машинное обучение Azure. Или можно обучить модель, отправив [выполнение](#runs) [эксперимента](#experiments) в [целевой объект вычислений](#compute-targets) в машинное обучение Azure. После создания модели вы [регистрируете модель](#register-model) в рабочей области.

Машинное обучение Azure не зависит от платформы. Для создания модели можно использовать любую популярную платформу машинного обучения, например Scikit-learn, XGBoost, PyTorch, TensorFlow или Chainer.

Пример обучения модели с помощью Scikit-учиться см. в разделе [учебник. Обучение модели классификации изображений с машинное обучение Azure](tutorial-train-models-with-aml.md).


### <a name="model-registry"></a><a name="register-model"></a> Реестр модели

[Рабочая область](#workspace)  >  **Модели**

**Реестр Model** позволяет вести отслеживание всех моделей в рабочей области машинное обучение Azure.

Модели идентифицируются по имени и версии. При регистрации модели с уже имеющимся именем реестр предполагает, что это новая версия. Номер версии увеличивается, и новая модель регистрируется под тем же именем.

При регистрации модели вы можете указать дополнительные теги метаданных, а затем использовать эти теги для поиска моделей.

> [!TIP]
> Зарегистрированная модель — это логический контейнер для одного или нескольких файлов, составляющих эту модель. Например, если ваша модель хранится в нескольких файлах, их можно зарегистрировать как единую модель рабочей области Машинного обучения Azure. После регистрации вы сможете скачать или развернуть зарегистрированную модель, чтобы получить все зарегистрированные в ней файлы.

Удалить зарегистрированную модель нельзя, если она используется в любом активном развертывании.

Пример регистрации модели см. в статье [Руководство по обучению модели классификации изображений с помощью Службы машинного обучения Azure](tutorial-train-models-with-aml.md).

## <a name="deployment"></a>Deployment (Развертывание)

Вы развертываете [зарегистрированную модель](#register-model) в качестве конечной точки службы. Вам потребуются следующие компоненты:

* **Среда**. Эта среда инкапсулирует зависимости, необходимые для выполнения модели для вывода.
* **Код оценки**. Этот скрипт принимает запросы, оценивает запросы с помощью модели и возвращает результаты.
* **Конфигурация вывода**. Конфигурация вывода определяет среду, сценарий входа и другие компоненты, необходимые для запуска модели в качестве службы.

Дополнительные сведения об этих компонентах см. в разделе [Развертывание моделей с помощью машинное обучение Azure](how-to-deploy-and-where.md).

### <a name="endpoints"></a>Конечные точки

[Рабочая область](#workspace)  >  **Конечные точки**

Конечная точка — это экземпляр модели в формате веб-службы, которая может размещаться в облаке или модуле Интернета вещей для развертываний интегрированных устройств.

#### <a name="web-service-endpoint"></a>Конечная точка веб-службы

При развертывании модели в качестве веб-службы конечную точку можно развернуть в службе "экземпляры контейнеров Azure", "служба Kubernetes Azure" или "FPGA". В службу входят модель, скрипт и связанные файлы. Они помещаются в базовый образ контейнера, который содержит среду выполнения для модели. Образ включает конечную точку HTTP с балансировкой нагрузки, которая получает запросы на оценку, отправляемые в веб-службу.

Вы можете включить Application Insights телеметрии или телеметрии моделей для мониторинга веб-службы. Данные телеметрии доступны только вам.  Он хранится в Application Insights и экземплярах учетной записи хранения. Если вы включили автоматическое масштабирование, Azure будет автоматически масштабировать ваше развертывание.

На следующей схеме показан рабочий процесс вывода для модели, развернутой в качестве конечной точки веб-службы.

Дополнительные сведения:

* Пользователь регистрирует модель с помощью клиента, например пакета SDK для Машинного обучения Azure.
* Пользователь создает образ с помощью модели, файла оценки и других зависимостей модели.
* Образ Docker создается и сохраняется в службе "Реестр контейнеров Azure".
* Веб-служба развертывается на целевом объекте вычислений (Экземпляры контейнеров или AKS) с помощью образа, созданного на предыдущем шаге.
* Сведения о запросе оценки хранятся в Application Insights, которая находится в подписке пользователя.
* Данные телеметрии также отправляются в подписку Microsoft или Azure.

[![Рабочий процесс вывода](media/concept-azure-machine-learning-architecture/inferencing.png)](media/concept-azure-machine-learning-architecture/inferencing.png#lightbox)


Пример развертывания модели как веб-службы см. в статье [Руководство. Развертывание модели классификации изображений в Экземплярах контейнеров Azure](tutorial-deploy-models-with-aml.md).

#### <a name="real-time-endpoints"></a>конечные точки для прогнозирования в реальном времени.

При развертывании обученной модели в конструкторе [эту модель можно развернуть как конечную точку в режиме реального времени](tutorial-designer-automobile-price-deploy.md). Конечная точка в реальном времени обычно получает один запрос через конечную точку RESTFUL и возвращает прогноз в режиме реального времени. Это отличается от пакетной обработки, которая обрабатывает несколько значений одновременно и сохраняет результаты после завершения в хранилище данных.

#### <a name="pipeline-endpoints"></a>Конечные точки конвейера

Конечные точки конвейера позволяют программно вызывать [конвейеры машинного обучения](#ml-pipelines) через конечную точку RESTful. Конечные точки конвейера позволяют автоматизировать рабочие процессы конвейера.

Конечная точка конвейера — это коллекция опубликованных конвейеров. Эта логическая организация позволяет управлять и вызывать несколько конвейеров, используя одну и ту же конечную точку. Каждый опубликованный конвейер в конечной точке конвейера имеет версию. Для конечной точки можно выбрать конвейер по умолчанию или указать версию в вызове функции RESTFUL.
 

#### <a name="iot-module-endpoints"></a>Конечные точки модуля Интернета вещей

Развернутая конечная точка модуля Интернета вещей — это контейнер Docker, который содержит модель, соответствующий скрипт или приложение и все дополнительные зависимости. Эти модули развертываются с помощью Azure IoT Edge на пограничных устройствах.

Если вы включили функцию мониторинга, Azure собирает данные телеметрии из модели в модуле Azure IoT Edge. Данные телеметрии доступны только вам и хранятся в вашем экземпляре учетной записи хранения.

Azure IoT Edge гарантирует, что модуль запущен и отслеживает устройство, на котором он размещен. 
## <a name="automation"></a>Автоматизация

### <a name="azure-machine-learning-cli"></a>Интерфейс командной строки службы "Машинное обучение Azure" 

[Машинное обучение Azure CLI](reference-azure-machine-learning-cli.md) — это расширение Azure CLI, кросс-платформенный интерфейс командной строки для платформы Azure. Это расширение предоставляет команды для автоматизации действий машинного обучения.

### <a name="ml-pipelines"></a>Конвейеры машинного обучения

Вы используете [конвейеры машинного обучения](concept-ml-pipelines.md) для создания рабочих процессов и управления ими, которые объединяют этапы машинного обучения. Например, конвейер может включать этапы подготовки данных, обучения и развертывания модели, а также вывода и оценки. Каждый этап может охватывать несколько шагов, каждый из которых может автоматически выполняться в различных целевых объектах вычисления. 

Шаги конвейера можно использовать повторно или выполнять без повтора предыдущих шагов, если выходные данные таких шагов не должны изменяться. Например, вы можете повторно обучить модель без дорогостоящих этапов подготовки данных, если сами данные не изменялись. Кроме того, конвейеры позволяют специалистам по обработке и анализу данных параллельно работать над разными частями рабочего процесса машинного обучения.

## <a name="monitoring-and-logging"></a>Мониторинг и ведение журнала

Машинное обучение Azure предоставляет следующие возможности мониторинга и ведения журнала.

* Для специалистов по обработке и анализу __данных__ вы можете отслеживать эксперименты и данные журналов в учебных запусках. Дополнительные сведения см. в следующих статьях:
   * [Запуск, отслеживание и отмена обучающих запусков](how-to-manage-runs.md)
   * [Запись метрик для учебных запусков](how-to-track-experiments.md)
   * [Отслеживание экспериментов с помощью потока ML](how-to-use-mlflow.md)
   * [Визуализация выполняется с помощью TensorBoard](how-to-monitor-tensorboard.md)
* Для __администраторов__ можно отслеживать сведения о рабочей области, связанных ресурсах Azure и событиях, таких как создание и удаление ресурсов, с помощью Azure Monitor. Дополнительные сведения см. [в разделе мониторинг машинное обучение Azure](monitor-azure-machine-learning.md).
* Для __DevOps__ или __млопс__ можно отслеживать сведения, создаваемые моделями, развернутыми в виде веб-служб или модулей IOT Edge для выявления проблем с развертываниями и сбора данных, передаваемых в службу. Дополнительные сведения см. в разделе [сбора данных модели](how-to-enable-data-collection.md) и [мониторинг с помощью Application Insights](how-to-enable-app-insights.md).

## <a name="interacting-with-your-workspace"></a>Взаимодействие с рабочей областью

### <a name="studio"></a>Студия

[Машинное обучение Azure Studio](overview-what-is-machine-learning-studio.md) предоставляет веб-представление всех артефактов в рабочей области.  Вы можете просматривать результаты и сведения о наборах данных, экспериментах, конвейерах, моделях и конечных точках.  Вы также можете управлять ресурсами вычислений и хранилищами данных в студии.

В студии также доступны интерактивные средства, которые являются частью Машинное обучение Azure:

+ [Конструктор машинное обучение Azure](concept-designer.md) для выполнения действий рабочего процесса без написания кода
+ Веб-интерфейс для [автоматизированного машинного обучения](concept-automated-ml.md)
+ [Машинное обучение Azure записных книжках](how-to-run-jupyter-notebooks.md) для написания и выполнения собственного кода на интегрированных серверах записной книжки Jupyter.
+ Создание [меток для проектов](how-to-create-labeling-projects.md) для создания, управления и мониторинга проектов для пометки данных

### <a name="programming-tools"></a>Средства программирования

> [!IMPORTANT]
> Средства, отмеченные ниже (Предварительная версия), сейчас доступны в общедоступной предварительной версии.
> Предварительная версия предоставляется без соглашения об уровне обслуживания и не рекомендована для производственных рабочих нагрузок. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

+  [Пакет SDK Машинного обучения для Python](/python/api/overview/azure/ml/intro) позволяет взаимодействовать с этой службой в любой среде Python.
+ Взаимодействуйте со службой в любой среде R с помощью [пакета SDK машинное обучение Azure для R](https://azure.github.io/azureml-sdk-for-r/reference/index.html) (Предварительная версия).
+ Используйте [конструктор машинное обучение Azure](concept-designer.md) для выполнения действий рабочего процесса без написания кода. 
+ Используйте [машинное обучение Azure CLI](./reference-azure-machine-learning-cli.md) для автоматизации.
+ [Акселератор решений для многих моделей](https://aka.ms/many-models) (предварительная версия) основан на службе Машинного обучения Azure и позволяет обучать, использовать и обслуживать сотни и даже тысячи моделей машинного обучения.

## <a name="next-steps"></a>Дальнейшие действия

Чтобы быстро начать работу с Машинным обучением Azure, изучите следующие статьи:

* [Что такое Машинное обучение Azure?](overview-what-is-azure-ml.md)
* [Создание рабочей области машинного обучения Azure](how-to-manage-workspace.md)
* [Руководство (часть 1). Обучение модели](tutorial-train-models-with-aml.md)