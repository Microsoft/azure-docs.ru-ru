---
title: Настройка общего удостоверения
titleSuffix: Azure Data Science Virtual Machine
description: Узнайте, как создавать общие учетные записи пользователей, которые можно использовать в нескольких Виртуальных машинах для обработки и анализа данных. Для аутентификации пользователей в Виртуальной машине для обработки и анализа данных можно использовать Azure Active Directory или локальную службу Active Directory.
keywords: deep learning, AI, data science tools, data science virtual machine, geospatial analytics, team data science process
services: machine-learning
ms.service: data-science-vm
author: vijetajo
ms.author: vijetaj
ms.topic: conceptual
ms.date: 05/08/2018
ms.openlocfilehash: 43ef0f55f0b0f3ff9008f0ddf240ad0ea4f37df6
ms.sourcegitcommit: e972837797dbad9dbaa01df93abd745cb357cde1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100519734"
---
# <a name="set-up-a-common-identity-on-a-data-science-virtual-machine"></a>Настройка общего удостоверения для виртуальной машины для обработки и анализа данных

На виртуальной машине Microsoft Azure (ВМ), включая виртуальную машину для обработки и анализа данных (DSVM), вы создаете локальные учетные записи пользователей при подготовке виртуальной машины. С помощью их учетных данных пользователи проходят аутентификацию на данной виртуальной машине. Если у вас есть несколько виртуальных машин, к которым необходимо получить доступ, Управление учетными данными может оказаться очень громоздким. Отличным решением является развертывание общих учетных записей пользователей и управление с помощью стандартного поставщика удостоверений. Этот подход позволяет использовать один набор учетных данных для доступа к нескольким ресурсам в Azure, включая несколько Dsvm.

Active Directory является популярным поставщиком удостоверений и поддерживается в Azure как в облачной службе, так и в качестве локального каталога. Используя Azure Active Directory (Azure AD) или локальный каталога Active Directory, можно аутентифицировать пользователей на изолированной виртуальной машине для обработки и анализа данных или кластере DSVM, размещенном в масштабируемом наборе виртуальных машин Azure. Для этого следует присоединить экземпляры DSVM к домену Active Directory.

Если у вас уже есть Active Directory, вы можете использовать его в качестве общего поставщика удостоверений. Если у вас нет Active Directory, вы можете запустить управляемый экземпляр Active Directory в Azure с помощью [доменных служб Azure Active Directory](../../active-directory-domain-services/index.yml) (Azure AD DS).

В документации по [Azure AD](../../active-directory/index.yml) содержатся подробные [инструкции по управлению](../../active-directory/hybrid/whatis-hybrid-identity.md), включая рекомендации по подключению Azure AD к локальному каталогу, если у вас его есть.

В этой статье описывается, как настроить полностью управляемую службу Active Directory домена в Azure с помощью AD DS Azure. Затем вы можете присоединить Dsvm к управляемому домену Active Directory. Такой подход позволяет пользователям получать доступ к пулу Dsvm (и другим ресурсам Azure) через общую учетную запись пользователя и учетные данные.

## <a name="set-up-a-fully-managed-active-directory-domain-on-azure"></a>Настройка полностью управляемого домена Active Directory в Azure

Azure AD DS упрощает управление вашими удостоверениями, предоставляя полностью управляемую службу в Azure. В данном домене Active Directory вы можете управлять пользователями и группами. Чтобы настроить доменную Active Directory, размещенную в Azure, и учетные записи пользователей в каталоге, выполните следующие действия.

1. Добавьте пользователя в Active Directory на портале Azure. 

   1. Войдите в [центр администрирования Azure Active Directory](https://aad.portal.azure.com) , используя учетную запись глобального администратора каталога.
    
   1. Выберите **Azure Active Directory**, а затем щелкните **Пользователи и группы**.
    
   1. В списке **Пользователи и группы** выберите **все пользователи**, а затем выберите **Новый пользователь**.
   
        Откроется область " **пользователь** ":
      
        ![Область "Пользователь"](./media/add-user.png)
    
   1. Введите сведения о пользователе в соответствующих полях, например **Имя** и **Имя пользователя**. Частью имени пользователя, представляющей собой доменное имя, должно быть доменное имя по умолчанию, [domain name].onmicrosoft.com, или проверенное доменное имя, не являющееся федеративным, например [настроить доменное имя](../../active-directory/fundamentals/add-custom-domain.md) contoso.com.
    
   1. Скопируйте или иным способом запишите созданный пароль пользователя, чтобы после завершения этого процесса его можно было предоставить пользователю.
    
   1. При необходимости можно указать сведения, открыв колонку **Профиль**, **Группы** или **Роль каталога** для пользователя. 
    
   1. В разделе **пользователь** выберите **создать**.
    
   1. Безопасно распространите созданный пароль новому пользователю, чтобы он мог выполнить вход.

1. Создайте экземпляр Azure AD DS. Следуйте инструкциям в разделе  [включение Azure Active Directory доменных служб с помощью портал Azure](../../active-directory-domain-services/tutorial-create-instance.md) (раздел "Создание экземпляра и настройка основных параметров"). Очень важно обновить существующие пароли пользователей в Active Directory, чтобы синхронизировать их с паролями в Azure AD DS. Также важно добавить DNS в AD DS Azure, как описано в разделе "Заполнение полей в окне" Основные сведения "портал Azure, чтобы создать экземпляр AD DS Azure" в этом разделе.

1. Создайте отдельную подсеть DSVM в виртуальной сети, созданной в разделе "Создание и Настройка виртуальной сети" на предыдущем шаге.
1. Создайте один или несколько экземпляров DSVM в подсети DSVM.
1. Следуйте [инструкциям](../../active-directory-domain-services/join-ubuntu-linux-vm.md) по добавлению DSVM в Active Directory. 
1. Подключите файловый ресурс Azure для размещения домашней или записной книжки, чтобы Рабочая область могла быть подключена к любому компьютеру. (Если вам нужны достаточные разрешения на уровне файлов, вам потребуется сетевая файловая система [NFS], работающая на одной или нескольких виртуальных машинах.)

   1. [Создайте общий ресурс службы файлов Azure](../../storage/files/storage-how-to-create-file-share.md).
    
   2.  Подключите этот общий ресурс к DSVM Linux. При выборе **подключения** к общей папке службы файлов Azure в учетной записи хранения в портал Azure появится команда, которая будет запускаться в оболочке bash в Linux DSVM. Эта команда выглядит следующим образом:
   
   ```
   sudo mount -t cifs //[STORAGEACCT].file.core.windows.net/workspace [Your mount point] -o vers=3.0,username=[STORAGEACCT],password=[Access Key or SAS],dir_mode=0777,file_mode=0777,sec=ntlmssp
   ```
1. Например, предположим, что вы подключили общую папку файлов Azure в/Дата/воркспаце. Теперь создайте каталоги для каждого пользователя в общей папке:/Data/Workspace/User1,/Data/Workspace/user2 и т. д. Создайте каталог `notebooks` в рабочей области каждого пользователя. 
1. Создайте символьные ссылки для `notebooks` в `$HOME/userx/notebooks/remote`.   

Теперь у вас есть пользователи в экземпляре Active Directory, размещенном в Azure. Используя учетные данные Active Directory, пользователи могут входить в любые DSVM (SSH или JupyterHub), присоединенные к Azure AD DS. Так как рабочая область пользователя находится в общем ресурсе службы файлов Azure, у пользователей будет доступ к элементам Notebook и другим рабочим ресурсам с любой виртуальной машины для обработки и анализа данных при использовании JupyterHub.

Для автоматического масштабирования вы можете использовать масштабируемый набор виртуальных машин, чтобы создать пул виртуальных машин, которые все подключены к домену таким образом и к которым подключен общий диск. Пользователи могут входить на любой доступный компьютер в масштабируемом наборе виртуальных машин и иметь доступ к общему диску, где хранятся записные книжки. 

## <a name="next-steps"></a>Дальнейшие шаги

* [Безопасное хранение учетных данных для доступа на виртуальной машине для обработки и анализа данных](dsvm-secure-access-keys.md)