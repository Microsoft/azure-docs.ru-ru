---
title: Использование политик доступа в кэше Azure HPC
description: Создание и применение пользовательских политик доступа для ограничения клиентского доступа к целевым объектам хранилища в кэше Azure HPC
author: ekpgh
ms.service: hpc-cache
ms.topic: how-to
ms.date: 03/11/2021
ms.author: v-erkel
ms.openlocfilehash: eb9e71cc8ec463077e3b12b8738203a4945a2eab
ms.sourcegitcommit: 66ce33826d77416dc2e4ba5447eeb387705a6ae5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103471776"
---
# <a name="control-client-access"></a>Управление доступом клиентов

В этой статье объясняется, как создать и применить настраиваемые политики клиентского доступа для целевых объектов хранилища.

Политики клиентского доступа определяют, как клиенты могут подключаться к экспортам целевого объекта хранилища. Вы можете управлять такими объектами, как root squash и доступом на чтение и запись на узле клиента или на уровне сети.

Политики доступа применяются к пути к пространству имен. Это означает, что можно использовать разные политики доступа для двух различных операций экспорта в системе хранения NFS.

Эта функция предназначена для рабочих процессов, где необходимо контролировать, как разные группы клиентов обращаются к целевым объектам хранилища.

Если вам не требуется детальный контроль доступа к целевому хранилищу, можно использовать политику по умолчанию или настроить политику по умолчанию с дополнительными правилами. Например, если требуется включить корневую Squash для всех клиентов, подключающихся через кэш, можно изменить политику с именем **Default** , чтобы добавить корневой параметр squash.

## <a name="create-a-client-access-policy"></a>Создание политики клиентского доступа

Страница **политики клиентского доступа** на портал Azure используется для создания политик и управления ими. <!-- is there AZ CLI for this? -->

[![снимок экрана со страницей политик клиентского доступа. Определено несколько политик, и некоторые из них развернуты для отображения их правил](media/policies-overview.png)](media/policies-overview.png#lightbox)

Каждая политика состоит из правил. Правила применяются к узлам в порядке от наименьшей области (узла) до самой крупной (по умолчанию). При этом применяется первое правило, соответствующее правилам, и более поздние правила игнорируются.

Чтобы создать новую политику доступа, нажмите кнопку **+ Добавить политику доступа** в верхней части списка. Присвойте новой политике доступа имя и введите по крайней мере одно правило.

![снимок экрана: изменение колонки "политики доступа" с несколькими введенными правилами. Нажмите кнопку ОК, чтобы сохранить правило.](media/add-policy.png)

В оставшейся части этого раздела объясняются значения, которые можно использовать в правилах.

### <a name="scope"></a>Область

Термин область и фильтр адресов работают вместе, чтобы определить, на какие клиенты влияет это правило.

Используйте их, чтобы указать, применяется ли правило к отдельному клиенту (узлу), диапазону IP-адресов (сеть) или всем клиентам (по умолчанию).

Выберите подходящее значение **области** для правила:

* **Узел** — правило применяется к отдельному клиенту.
* **Сеть** — правило применяется к клиентам в диапазоне IP-адресов.
* **По умолчанию** — правило применяется ко всем клиентам.

Правила в политике оцениваются в указанном порядке. После того как запрос на подключение клиента соответствует одному правилу, остальные игнорируются.

### <a name="address-filter"></a>Фильтр адресов

Значение **фильтра адресов** указывает, какие клиенты соответствуют правилу.

Если для области задано **Размещение**, в фильтре можно указать только один IP-адрес. Для параметра область **по умолчанию** нельзя ввести IP-адреса в поле **фильтр адреса** , так как область по умолчанию соответствует всем клиентам.

Укажите IP-адрес или диапазон адресов для этого правила. Используйте нотацию CIDR (пример: 0.1.0.0/16), чтобы указать диапазон адресов.

### <a name="access-level"></a>Уровень доступа

Укажите, какие привилегии следует предоставить клиентам, соответствующим области и фильтру.

Параметры доступны **для чтения и записи**, **только для чтения** или **без доступа**.

### <a name="suid"></a>SUID

Установите флажок **SUID** , чтобы разрешить файлам в хранилище задавать идентификаторы пользователей при доступе.

SUID обычно используется для временного увеличения привилегий пользователя, чтобы пользователь мог выполнить задачу, связанную с этим файлом.

### <a name="submount-access"></a>Доступ к подподключению

Установите этот флажок, чтобы разрешить указанным клиентам напрямую подключать подкаталоги экспорта.

### <a name="root-squash"></a>Корневой Squash

Выберите, следует ли задавать корневые Squash для клиентов, соответствующих этому правилу.

Этот параметр определяет, как кэш Azure HPC обрабатывает запросы от привилегированного пользователя на клиентских компьютерах. Если параметр root Squash включен, корневые пользователи из клиента автоматически сопоставляются с непривилегированным пользователем при отправке запросов через кэш HPC Azure. Кроме того, он не позволяет клиентским запросам использовать биты разрешений Set-UID.

Если параметр root Squash отключен, запрос от корневого пользователя клиента (UID 0) передается в серверную систему хранения NFS в качестве корневого каталога. Такая конфигурация может допускать недопустимый доступ к файлам.

Установка корневых Squash для клиентских запросов может помочь компенсировать требуемый ``no_root_squash`` параметр в системах NAS, которые используются в качестве целевых объектов хранилища. (Дополнительные сведения о [необходимых компонентах хранилища NFS](hpc-cache-prerequisites.md#nfs-storage-requirements)). Она также может повысить безопасность при использовании целевых объектов хранилища BLOB-объектов Azure.

При включении корневого Squash необходимо также задать значение пользователя анонимного идентификатора. Портал принимает целочисленные значения от 0 до 4294967295. (Старые значения-2 и-1 поддерживаются для обеспечения обратной совместимости, но не рекомендуются для новых конфигураций.)

Эти значения сопоставлены с конкретными значениями пользователя:

* **-2** или **65534** (никто)
* **-1** или **65535** (без доступа)
* **0** (непривилегированный корень)

Система хранения может иметь другие значения со специальными значениями.

## <a name="update-access-policies"></a>Обновление политик доступа

Политики доступа можно изменить или удалить из таблицы на странице **политики клиентского доступа** .

Щелкните имя политики, чтобы открыть его для редактирования.

Чтобы удалить политику, установите флажок рядом с ее именем в списке, а затем нажмите кнопку **Удалить** в верхней части списка. Невозможно удалить политику с именем "default".

> [!NOTE]
> Нельзя удалить используемую политику доступа. Удалите политику из всех путей к пространству имен, содержащих ее, прежде чем пытаться удалить ее.

## <a name="next-steps"></a>Дальнейшие действия

* Примените политики доступа в путях к пространствам имен для целевых объектов хранилища. Дополнительные сведения см. в статье [Настройка агрегированного пространства имен](add-namespace-paths.md) .
