---
title: Обновление целевых объектов хранилища кэша HPC для Azure
description: Как изменить целевые объекты хранилища кэша HPC для Azure
author: ekpgh
ms.service: hpc-cache
ms.topic: how-to
ms.date: 03/10/2021
ms.author: v-erkel
ms.openlocfilehash: 0c505937d4adbe2596e91ed7269676e60ada8253
ms.sourcegitcommit: 2c1b93301174fccea00798df08e08872f53f669c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104772601"
---
# <a name="edit-storage-targets"></a>Изменение целевых расположений хранилищ

Целевые объекты хранилища можно удалять или изменять с помощью портал Azure или Azure CLI.

В зависимости от типа хранилища можно изменить следующие целевые значения хранилища:

* Для целевых объектов хранилища BLOB-объектов можно изменить путь к пространству имен и политику доступа.

* Для целевых объектов хранилища NFS эти значения можно изменить:

  * Пути к пространству имен
  * Политика доступа
  * Подкаталог экспорта или экспорта хранилища, связанный с путем к пространству имен
  * Модель использования

* Для целевых объектов хранилища ADLS-NFS можно изменить путь к пространству имен, политику доступа и модель использования.

Нельзя изменить имя, тип или систему хранения серверной части хранилища (контейнер больших двоичных объектов или имя узла или IP-адрес NFS). Если необходимо изменить эти свойства, удалите целевой объект хранилища и создайте замену новым значением.

> [!TIP]
> В [видеоролике Управление кэшем Azure HPC](https://azure.microsoft.com/resources/videos/managing-hpc-cache/) показано, как изменить целевой объект хранилища в портал Azure.

## <a name="remove-a-storage-target"></a>Удаление целевого объекта хранилища

### <a name="portal"></a>[Портал](#tab/azure-portal)

Чтобы удалить целевой объект хранилища, откройте страницу **целевые объекты хранилища** . Выберите целевой объект хранилища в списке и нажмите кнопку **Удалить** .

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[Настройте Azure CLI для кэша HPC Azure](./az-cli-prerequisites.md).

Чтобы удалить целевой объект хранилища из кэша, используйте команду [AZ HPC-Cache Storage — Remove](/cli/azure/ext/hpc-cache/hpc-cache/storage-target#ext-hpc-cache-az-hpc-cache-storage-target-remove) .

```azurecli
$ az hpc-cache storage-target remove --resource-group cache-rg --cache-name doc-cache0629 --name blob1

{- Finished ..
  "endTime": "2020-07-09T21:45:06.1631571+00:00",
  "name": "2f95eac1-aded-4860-b19c-3f089531a7ec",
  "startTime": "2020-07-09T21:43:38.5461495+00:00",
  "status": "Succeeded"
}
```

---

Удаление целевого объекта хранилища приводит к удалению связи системы хранения с этой системой кэша HPC Azure, но не изменяет серверную систему хранения. Например, если вы использовали контейнер хранилища BLOB-объектов Azure, контейнер и его содержимое все еще существуют после удаления из кэша. Вы можете добавить контейнер в другой кэш HPC Azure, повторно добавить его в этот кэш или удалить с портал Azure.

Все изменения файлов, хранящиеся в кэше, записываются в систему хранения серверной части перед удалением целевого объекта хранилища. Этот процесс может занять час или более, если в кэше находится большой объем измененных данных.

## <a name="change-a-blob-storage-targets-namespace-path"></a>Изменение пути к пространству имен целевого объекта хранилища BLOB-объектов

Пути к пространству имен — это пути, которые клиенты используют для подключения этого целевого объекта хранилища. (Дополнительные сведения см. в статье [планирование агрегированного пространства имен](hpc-cache-namespace.md) и [Настройка агрегированного пространства имен](add-namespace-paths.md)).

Путь к пространству имен — это единственное обновление, которое можно внести в целевой объект хранилища BLOB-объектов Azure. Используйте портал Azure или Azure CLI, чтобы изменить его.

### <a name="portal"></a>[Портал](#tab/azure-portal)

Используйте страницу **пространства имен** для кэша HPC Azure. Страница пространства имен более подробно описана в статье [Настройка агрегированного пространства имен](add-namespace-paths.md).

Щелкните имя пути, который необходимо изменить, и создайте новый путь в появившемся окне редактирования.

![Снимок экрана страницы пространства имен после щелчка по пути к пространству имен BLOB-объектов. поля "Изменить" отображаются на панели справа](media/update-namespace-blob.png)

После внесения изменений нажмите кнопку **ОК** , чтобы обновить целевой объект хранилища, или нажмите кнопку **Отмена** , чтобы отменить изменения.

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[Настройте Azure CLI для кэша HPC Azure](./az-cli-prerequisites.md).

Чтобы изменить пространство имен целевого объекта хранилища BLOB-объектов на Azure CLI, используйте команду [AZ HPC-Cache большого двоичного объекта — хранилище — обновление целевого объекта](/cli/azure/ext/hpc-cache/hpc-cache/blob-storage-target#ext-hpc-cache-az-hpc-cache-blob-storage-target-update). `--virtual-namespace-path`Можно изменить только значение.

  ```azurecli
  az hpc-cache blob-storage-target update --cache-name cache-name --name target-name \
    --resource-group rg --virtual-namespace-path "/new-path"
  ```

---

## <a name="update-an-nfs-storage-target"></a>Обновление целевого объекта хранилища NFS

Для целевых объектов хранилища NFS можно изменить или добавить пути к виртуальному пространству имен, изменить значения экспорта или подкаталогов NFS, на которые указывает путь к пространству имен, и изменить модель использования.

Целевые объекты хранилища в кэшах с некоторыми типами настраиваемых параметров DNS также имеют элемент управления для обновления своих IP-адресов. (Такой тип конфигурации является редким.)

Ниже приведены сведения.

* [Изменение обобщенных значений пространства имен](#change-aggregated-namespace-values) (путь к виртуальному пространству имен, политика доступа, экспорт и подкаталог экспорта)
* [Изменение модели использования](#change-the-usage-model)
* [Обновить DNS](#update-ip-address-custom-dns-configurations-only)

### <a name="change-aggregated-namespace-values"></a>Изменение значений агрегированных пространств имен

Можно использовать портал Azure или Azure CLI, чтобы изменить путь к пространству имен клиента, экспорт хранилища и подкаталог экспорта (если используется).

Ознакомьтесь с рекомендациями по [добавлению путей к пространству имен NFS](add-namespace-paths.md#nfs-namespace-paths) , если вам нужно напоминание о том, как создать несколько допустимых путей для одного целевого объекта хранилища.

### <a name="portal"></a>[Портал](#tab/azure-portal)

Используйте страницу **пространства имен** для кэша HPC Azure, чтобы обновить значения пространства имен. Эта страница более подробно описана в статье [Настройка агрегированного пространства имен](add-namespace-paths.md).

![снимок экрана страницы пространства имен портала со страницей обновления NFS, открытой справа](media/update-namespace-nfs.png)

1. Щелкните имя пути, который требуется изменить.
1. Используйте окно редактирования для ввода новых параметров виртуального пути, экспорта или подкаталога или для выбора другой политики доступа.
1. После внесения изменений нажмите кнопку **ОК** , чтобы обновить целевой объект хранилища, или **Отмена** , чтобы отменить изменения.

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[Настройте Azure CLI для кэша HPC Azure](./az-cli-prerequisites.md).

``--junction``Для изменения пути к пространству имен, экспорта NFS или экспорта подкаталога используйте параметр в команде [AZ HPC-Cache NFS-Storage-Target Update](/cli/azure/ext/hpc-cache/hpc-cache/nfs-storage-target) .

``--junction``Параметр использует следующие значения:

* ``namespace-path`` — Путь к виртуальному файлу клиента.
* ``nfs-export`` — Экспорт системы хранения, связываемый с путем, ориентированным на клиента
* ``target-path`` (необязательно) — подкаталог экспорта (при необходимости).

Пример: ``--junction namespace-path="/nas-1" nfs-export="/datadisk1" target-path="/test"``

Необходимо указать все три значения для каждого пути в ``--junction`` операторе. Используйте существующие значения для любых значений, которые не нужно изменять.

Имя кэша, имя целевого объекта хранилища и группа ресурсов также необходимы во всех командах обновления.

Пример команды:

```azurecli
az hpc-cache nfs-storage-target update --cache-name mycache \
  --name st-name --resource-group doc-rg0619 \
  --junction namespace-path="/new-path" nfs-export="/my-export" target-path="my-subdirectory"
```

---

### <a name="change-the-usage-model"></a>Изменение модели использования

Модель использования влияет на то, как кэш будет хранить данные. Дополнительные сведения см. в статье [Выбор модели использования](hpc-cache-add-storage.md#choose-a-usage-model) .

Чтобы изменить модель использования для целевого объекта хранилища NFS, используйте один из этих методов.

### <a name="portal"></a>[Портал](#tab/azure-portal)

Измените модель использования на странице **целевые объекты хранилища** в портал Azure. Щелкните имя целевого объекта хранилища, который необходимо изменить.

![снимок экрана со страницей "Изменить" для целевого объекта хранилища NFS](media/edit-storage-nfs.png)

Используйте раскрывающийся список выбора для выбора новой модели использования. Нажмите кнопку **ОК** , чтобы обновить целевой объект хранилища, или кнопку **Отмена** , чтобы отменить изменения.

### <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

[Настройте Azure CLI для кэша HPC Azure](./az-cli-prerequisites.md).

Используйте команду [AZ HPC-Cache NFS-Storage](/cli/azure/ext/hpc-cache/hpc-cache/nfs-storage-target#ext-hpc-cache-az-hpc-cache-nfs-storage-target-update) .

Команда Update почти идентична команде, используемой для добавления целевого объекта хранилища NFS. Дополнительные сведения и примеры см. в статье [Создание целевого объекта хранилища NFS](hpc-cache-add-storage.md#create-an-nfs-storage-target) .

Чтобы изменить модель использования, обновите ``--nfs3-usage-model`` параметр. Пример: ``--nfs3-usage-model WRITE_WORKLOAD_15``

Также требуются значения имени кэша, имени целевого объекта хранилища и группы ресурсов.

Если вы хотите проверить имена моделей использования, используйте команду [AZ HPC-Cache Usage-Model List](/cli/azure/ext/hpc-cache/hpc-cache/usage-model#ext-hpc-cache-az-hpc-cache-usage-model-list).

Если кэш остановлен или находится в неработоспособном состоянии, обновление будет применено после того, как кэш станет работоспособным.

---

### <a name="update-ip-address-custom-dns-configurations-only"></a>Обновить IP-адрес (только пользовательские конфигурации DNS)

Если в кэше используется конфигурация DNS, не используемая по умолчанию, IP-адрес целевого объекта хранилища NFS может измениться из-за внутренних изменений DNS. Если DNS-сервер изменяет IP-адрес внутренней системы хранения, кэш Azure HPC может потерять доступ к системе хранения.

В идеале следует работать с руководителем пользовательской DNS-системы кэша, чтобы спланировать обновления, так как эти изменения делают хранилище недоступным.

Если необходимо обновить IP-адрес целевого объекта хранилища, указанный в DNS, в списке целевых объектов хранилища появится кнопка. Нажмите кнопку **обновить DNS** , чтобы запросить новый IP-адрес у НАСТРАИВАЕМОГО DNS-сервера.

![Снимок экрана: список целевых объектов хранилища. Для одного целевого объекта хранилища — "..." меню в крайнем правом столбце открыто, и отобразятся два параметра: удаление и обновление DNS.](media/refresh-dns.png)

В случае успеха обновление займет менее двух минут. Одновременно можно обновить только один целевой объект хранилища. Дождитесь завершения предыдущей операции, прежде чем пытаться выполнить другую.

## <a name="update-an-adls-nfs-storage-target-preview"></a>Обновление целевого объекта хранилища ADLS-NFS (Предварительная версия)

Как и для целевых объектов NFS, можно изменить путь к пространству имен и модель использования для целевых объектов хранилища ADLS-NFS.

### <a name="change-an-adls-nfs-namespace-path"></a>Изменение пути к пространству имен ADLS-NFS

Используйте страницу **пространства имен** для кэша HPC Azure, чтобы обновить значения пространства имен. Эта страница более подробно описана в статье [Настройка агрегированного пространства имен](add-namespace-paths.md).

![снимок экрана страницы пространства имен портала с открытой страницей ADS-NFS Update](media/update-namespace-adls.png)

1. Щелкните имя пути, который требуется изменить.
1. Используйте окно редактирования, чтобы ввести новый виртуальный путь или обновить политику доступа.
1. После внесения изменений нажмите кнопку **ОК** , чтобы обновить целевой объект хранилища, или **Отмена** , чтобы отменить изменения.

### <a name="change-adls-nfs-usage-models"></a>Изменение моделей использования ADLS-NFS

Конфигурация для моделей использования ADLS-NFS идентична выбору модели использования NFS. Ознакомьтесь с инструкциями на портале в разделе [изменение модели использования](#change-the-usage-model) в NFS выше. Дополнительные инструменты для обновления целевых объектов хранилища ADLS-NFS находятся в разработке.


## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения об этих параметрах см. в статье [Добавление целевых объектов хранилища](hpc-cache-add-storage.md) .
* Дополнительные советы по использованию виртуальных путей см. [в статье Планирование обобщенного пространства имен](hpc-cache-namespace.md) .
