---
title: Шифрование неактивных данных в Azure Cosmos DB
description: Узнайте, как Azure Cosmos DB обеспечивает шифрование неактивных данных и как реализовать его.
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 05/19/2020
ms.custom: seodec18
ms.openlocfilehash: abe4bb3a53e3177857cb8041fd255ec916985054
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "93089871"
---
# <a name="data-encryption-in-azure-cosmos-db"></a>Шифрование данных в Azure Cosmos DB 
[!INCLUDE[appliesto-all-apis](includes/appliesto-all-apis.md)]

При шифровании неактивных данных обычно шифруются данные на устройствах долговременного хранения, например твердотельных накопителях (SSD) и жестких дисках (HDD). Основные базы данных хранятся в Cosmos DB на твердотельных накопителях. Мультимедийные вложения и резервные копии хранятся в хранилище BLOB-объектов Azure, как правило, на основе жестких дисков. С реализацией возможности шифрования неактивных данных Cosmos DB вы можете шифровать все базы данных, мультимедийные вложения и резервные копии. Шифруются как передаваемые данные (по сети), так и неактивные (долговременное хранение), обеспечивая непрерывное шифрование.

Azure Cosmos DB — службу PaaS — использовать очень просто. Так как все данные пользователей, хранимые в Azure Cosmos DB, шифруются как при хранении, так и при передаче, вам не нужно ничего делать. Другими словами, шифрование неактивных данных включено по умолчанию. Элементов управления для его включения и отключения нет. Azure Cosmos DB использует шифрование AES-256 во всех регионах, где выполняется учетная запись. Мы предоставляем эту функцию в соответствии с нашими [соглашениями об уровне обслуживания в отношении доступности и производительности](https://azure.microsoft.com/support/legal/sla/cosmos-db). Данные, хранимые в учетной записи Azure Cosmos, автоматически шифруются с помощью ключей, управляемых корпорацией Майкрософт (ключи, управляемые службой). При необходимости можно добавить второй уровень шифрования с собственными ключами, как описано в статье о [ключах, управляемых клиентом](how-to-setup-cmk.md).

## <a name="implementation-of-encryption-at-rest-for-azure-cosmos-db"></a>Реализация шифрования при хранении для Azure Cosmos DB

Шифрование неактивных данных реализуется с применением различных технологий обеспечения безопасности, включая безопасные системы хранения ключей, зашифрованные сети и криптографические API. Системы расшифровки и обработки данных должны взаимодействовать с системами управления ключами. На схеме показано, как разделено хранение зашифрованных данных и управление ключами. 

:::image type="content" source="./media/database-encryption-at-rest/design-diagram.png" alt-text="Схема структуры" border="false":::

Запрос пользователя выполняется и обрабатывается следующим образом:
- Учетная запись базы данных пользователя подготавливается, а ключи к хранилищу данных извлекаются по запросу к поставщику ресурсов службы управления.
- Пользователь создает подключение к Cosmos DB с помощью протокола HTTPS или безопасного транспортного протокола. (Пакеты SDK абстрагируют подробные сведения.)
- Пользователь отправляет документ JSON для сохранения, используя ранее созданное безопасное подключение.
- Документ JSON индексируется, если пользователь не отключил эту возможность.
- Документ JSON и данные индекса записываются в безопасное хранилище.
- Время от времени данные считываются из безопасного хранилища и архивируются в зашифрованное хранилище BLOB-объектов Azure.

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

### <a name="q-how-much-more-does-azure-storage-cost-if-storage-service-encryption-is-enabled"></a>Вопрос. Насколько дороже обходится служба хранилища Azure с включенной функцией "Шифрование службы хранилища"?
A. Дополнительные затраты не требуются.

### <a name="q-who-manages-the-encryption-keys"></a>Вопрос. Кто управляет ключами шифрования?
A. Ключами управляет корпорация Майкрософт.

### <a name="q-how-often-are-encryption-keys-rotated"></a>Вопрос. Как часто меняются ключи шифрования?
A. В корпорации Майкрософт есть ряд внутренних правил касательно смены ключей шифрования, которым следует Cosmos DB. Эти правила не публикуются. Однако корпорация Майкрософт публикует [жизненный цикл разработки защищенных приложений (SDL)](https://www.microsoft.com/sdl/default.aspx), который представляет собой часть внутренних рекомендаций и содержит полезные указания для разработчиков.

### <a name="q-can-i-use-my-own-encryption-keys"></a>Вопрос. Можно ли использовать собственные ключи шифрования?
Ответ. Да, эта функция теперь доступна для новых учетных записей Azure Cosmos DB и должна выполняться во время создания учетной записи. Дополнительные сведения см. в документе [с ключами, управляемыми клиентом](./how-to-setup-cmk.md) .

### <a name="q-what-regions-have-encryption-turned-on"></a>Вопрос. В каких регионах включено шифрование?
A. Шифрование пользовательских данных включено во всех регионах Azure Cosmos DB.

### <a name="q-does-encryption-affect-the-performance-latency-and-throughput-slas"></a>Вопрос. Влияет ли шифрование на пропускную способность и задержку производительности, определенные соглашениями об уровне обслуживания?
A. Нет, не влияет, так как шифрование при хранении включено для всех имеющихся или новых учетных записей. Дополнительные сведения об актуальных гарантиях см. на странице [соглашения об уровне обслуживания для Cosmos DB](https://azure.microsoft.com/support/legal/sla/cosmos-db).

### <a name="q-does-the-local-emulator-support-encryption-at-rest"></a>Вопрос. Поддерживает ли локальный эмулятор шифрование неактивных данных?
A. Эмулятор — это изолированное средство разработки и тестирования, которое не использует службы управления ключами, применяемые управляемой службой Cosmos DB. Мы советуем включить BitLocker на дисках, где хранятся конфиденциальные тестовые данные эмулятора. [Эмулятор поддерживает изменение каталога данных по умолчанию](local-emulator.md), а также использование известного расположения.

## <a name="next-steps"></a>Дальнейшие действия

* Вы можете добавить второй уровень шифрования с собственными ключами, как описано в статье о [ключах, управляемых клиентом](how-to-setup-cmk.md).
* Общие сведения о системе безопасности и последних усовершенствованиях Cosmos DB см. в статье [Безопасность базы данных в Azure Cosmos DB](database-security.md).
* Дополнительные сведения о сертификатах Майкрософт см. в [центре управления безопасностью Azure](https://azure.microsoft.com/support/trust-center/).