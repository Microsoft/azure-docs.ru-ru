---
title: Завершение срока действия данных в Azure Cosmos DB с помощью срока жизни
description: Функция TTL в Microsoft Azure Cosmos DB позволяет автоматически удалять документы из системы по прошествии определенного периода времени.
author: markjbrown
ms.author: mjbrown
ms.service: cosmos-db
ms.subservice: cosmosdb-sql
ms.topic: conceptual
ms.date: 11/04/2020
ms.reviewer: sngun
ms.openlocfilehash: cf9d0aea9ab9e79a5f184a42e1bb785b6fb870a7
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "93360094"
---
# <a name="time-to-live-ttl-in-azure-cosmos-db"></a>Срок жизни в Azure Cosmos DB
[!INCLUDE[appliesto-sql-api](includes/appliesto-sql-api.md)]

При использовании **срока жизни** или TTL Azure Cosmos DB предоставляет возможность автоматического удаления элементов из контейнера по истечении определенного периода времени. По умолчанию можно задать срок жизни на уровне контейнера и переопределить значения по элементу. После установки срока жизни на уровне контейнера или элемента Azure Cosmos DB будет автоматически удалять эти элементы по прошествии периода времени с момента их последнего изменения. Значение срока жизни настраивается в секундах. При настройке срока жизни система автоматически удаляет просроченные элементы на основе значения TTL, не требуя операции удаления, явно выданной клиентским приложением. Максимальное значение TTL — 2147483647.

Удаление элементов с истекшим сроком действия — это фоновая задача, использующая [единицы запроса](request-units.md)слева, которые являются единицами запросов, которые не использовались запросами пользователей. Даже после истечения срока жизни, если контейнер перегружен с запросами и в случае нехватки доступных единиц запроса, удаление данных откладывается. Данные удаляются, если для выполнения операции удаления достаточно свободного места. Несмотря на то, что удаление данных отложено, данные не возвращаются любыми запросами (любыми API) после истечения срока жизни.

> Это содержимое связано с Azure Cosmos DB сроком жизни хранилища транзакций. Если вы ищете значение TTL для аналитического хранилища, которое включает сценарии Ноетл HTAP через [ссылку Azure синапсе](./synapse-link.md), щелкните [здесь](./analytical-store-introduction.md#analytical-ttl).

## <a name="time-to-live-for-containers-and-items"></a>Срок жизни для контейнеров и элементов

Значение срока жизни задается в секундах и интерпретируется как Дельта с момента последнего изменения элемента. Вы можете установить срок жизни для контейнера или элемента в контейнере:

1. **Срок жизни контейнера** (устанавливается с использованием значения `DefaultTimeToLive`):

   - Если свойство отсутствует (или имеет значение NULL), срок действия элементов не истекает автоматически.

   - Если параметр указан и для него задано значение «-1», то оно равно бесконечности, а срок действия элементов по умолчанию истекает.

   - Если параметр указан и для него задано *ненулевое* число *n* , то срок действия элементов истекает через *"n"* секунд после их последнего изменения времени.

2. **Срок жизни элемента** (устанавливается с использованием значения `ttl`):

   - Это свойство применимо, только если значение `DefaultTimeToLive` присутствует и оно не имеет значения NULL для родительского контейнера.

   - Если свойство присутствует, оно переопределяет значение `DefaultTimeToLive` родительского контейнера.

## <a name="time-to-live-configurations"></a>Настройки срока жизни

- Если для параметра TTL задано значение *"n"* , то срок действия элементов в этом контейнере истекает через *n* секунд.  Если в контейнере есть элементы, для которых имеется собственное время жизни, установите значение-1 (указывает, что срок действия не истекает) или если некоторые элементы переопределили время в реальном времени с другим числом, срок действия этих элементов истекает в соответствии с настроенным значением TTL.

- Если для контейнера не задан срок жизни, срок жизни элемента в этом контейнере не будет действовать.

- Если срок жизни контейнера имеет значение -1, элемент в этом контейнере, срок жизни которого равен n, будет действителен в течение n секунд, а срок действия оставшихся элементов не истечет.

## <a name="examples"></a>Примеры

В этом разделе показаны некоторые примеры с разной временем жизни значений, назначенных контейнеру и элементам:

### <a name="example-1"></a>Пример 1

Для параметра TTL в контейнере задано значение null (DefaultTimeToLive = null)

|TTL для элемента| Результат|
|---|---|
|TTL = null|TTL отключен. Срок действия элемента не истекает (по умолчанию).|
|TTL =-1|TTL отключен. Срок действия элемента никогда не истечет.|
|TTL = 2000|TTL отключен. Срок действия элемента никогда не истечет.|

### <a name="example-2"></a>Пример 2

Значение срока жизни в контейнере равно-1 (DefaultTimeToLive =-1)

|TTL для элемента| Результат|
|---|---|
|TTL = null|Срок жизни включен. Срок действия элемента не истекает (по умолчанию).|
|TTL =-1|Срок жизни включен. Срок действия элемента никогда не истечет.|
|TTL = 2000|Срок жизни включен. Срок действия элемента истекает через 2000 секунд.|

### <a name="example-3"></a>Пример 3

Для параметра TTL в контейнере задано значение 1000 (DefaultTimeToLive = 1000).

|TTL для элемента| Результат|
|---|---|
|TTL = null|Срок жизни включен. Срок действия элемента истекает через 1000 секунд (по умолчанию).|
|TTL =-1|Срок жизни включен. Срок действия элемента никогда не истечет.|
|TTL = 2000|Срок жизни включен. Срок действия элемента истекает через 2000 секунд.|

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как настроить срок жизни в следующих статьях:

- [Как настроить срок жизни в Azure Cosmos DB](how-to-time-to-live.md)