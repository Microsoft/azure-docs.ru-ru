---
title: Оценка затрат с помощью планировщика ресурсов Azure Cosmos DB
description: Планировщик ресурсов Azure Cosmos DB позволяет оценить требуемые пропускную способность (количество единиц запросов в секунду) и затраты на рабочую нагрузку. В этой статье описывается, как использовать новую версию планировщика ресурсов для оценки требуемой пропускной способности и затрат.
author: deborahc
ms.service: cosmos-db
ms.subservice: cosmosdb-sql
ms.topic: how-to
ms.date: 07/30/2019
ms.author: dech
ms.openlocfilehash: 829fb28577fbb89c031a3b972d3ee5e04c935e9f
ms.sourcegitcommit: ba676927b1a8acd7c30708144e201f63ce89021d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/07/2021
ms.locfileid: "102435007"
---
# <a name="estimate-rus-using-the-azure-cosmos-db-capacity-planner"></a>Оценка единиц запросов в секунду с помощью планировщика ресурсов Azure Cosmos DB
[!INCLUDE[appliesto-sql-api](includes/appliesto-sql-api.md)]

Настройка баз данных и контейнеров Cosmos для Azure с правильным объемом подготовленной пропускной способности или [единиц запросов (единицы запроса в секунду)](request-units.md)для вашей рабочей нагрузки очень важно для оптимизации затрат и производительности. В этой статье описывается использование [планировщика](https://cosmos.azure.com/capacitycalculator/) ресурсов Azure Cosmos DB для оценки ТРЕБУЕМЫХ единиц запросов/s и стоимости рабочей нагрузки. 

## <a name="how-to-estimate-throughput-and-cost-with-azure-cosmos-db-capacity-planner"></a>Оценка пропускной способности и затрат с помощью планировщика ресурсов Azure Cosmos DB

Планировщик ресурсов можно использовать в двух режимах.

|**Режим**  |**Описание**  |
|---------|---------|
|Basic|Предоставляет быстрые, высокоуровневые единицы запросов в секунду и оценку затрат. В этом режиме предполагается, что параметры Azure Cosmos DB по умолчанию для политики индексирования, согласованности и других параметров. <br/><br/>Используйте базовый режим для быстрой и высокоуровневой оценки при оценке возможной рабочей нагрузки на Azure Cosmos DB.|
|Дополнительно|Предоставляет более подробные сведения о ЕДИНИЦах операций и затратах, а также возможность настройки дополнительных параметров — политики индексирования, уровня согласованности и других параметров, влияющих на стоимость и пропускную способность. <br/><br/>Используйте расширенный режим при оценке единиц запросов в секунду для нового проекта или необходимости более подробной оценки. |


## <a name="estimate-provisioned-throughput-and-cost-using-basic-mode"></a>Оценка подготовленной пропускной способности и затрат с помощью базового режима
Чтобы получить быструю оценку рабочей нагрузки с помощью базового режима, перейдите к [планировщику](https://cosmos.azure.com/capacitycalculator/)ресурсов. Введите следующие параметры в зависимости от рабочей нагрузки: 

|**Ввод**  |**Описание**  |
|---------|---------|
|Число регионов|Служба Azure Cosmos DB доступна во всех регионах Azure. Выберите число регионов, необходимых для рабочей нагрузки. Вы можете связать любое количество регионов с учетной записью Cosmos. Дополнительные сведения см. в разделе [глобальное распространение](distribute-data-globally.md) в Azure Cosmos DB.|
|Выполнение операций записи в нескольких регионах|Если включить [запись в несколько регионов](distribute-data-globally.md#key-benefits-of-global-distribution), приложение сможет выполнять чтение и запись в любой регион Azure. При отключении операций записи в несколько регионов приложение может записывать данные в один регион. <br/><br/> Включите запись в несколько регионов, если предполагается наличие активной рабочей нагрузки, требующей записи с низкой задержкой в разных регионах. Например, Рабочая нагрузка центра Интернета вещей, которая записывает данные в базу данных на высоких томах в разных регионах. <br/><br/> Запись в несколько регионов гарантирует доступность 99,999% для чтения и записи. Для операций записи в несколько регионов требуется дополнительная пропускная способность по сравнению с отдельными регионами записи. Дополнительные сведения см. в статье [об отличиях в одной и нескольких регионах](optimize-cost-regions.md) .|
|Общее количество хранимых данных (для каждого региона)|Общая оценочная сумма данных, хранящихся в ГБ, в одном регионе.|
|Размер элемента|Предполагаемый размер элемента данных (например, документа) в диапазоне от 1 КБ до 2 МБ. |
|Операций чтения в регион в секунду|Число операций чтения, ожидаемых в секунду. |
|Записей в секунду на регион|Количество операций записи, ожидаемых в секунду. |

После заполнения необходимых сведений выберите **вычислить**. На вкладке **Оценка стоимости** отображаются общие затраты на хранение и подготовленную пропускную способность. На этой вкладке можно развернуть ссылку " **Отображение сведений** ", чтобы получить сведения о пропускной способности, необходимой для запросов на чтение и запись. Каждый раз при изменении значения любого поля выберите **вычислить** , чтобы повторно вычислить оценочную стоимость. 

:::image type="content" source="./media/estimate-ru-with-capacity-planner/basic-mode.png" alt-text="Базовый режим планировщика ресурсов":::

## <a name="estimate-provisioned-throughput-and-cost-using-advanced-mode"></a>Оценка подготовленной пропускной способности и затрат в расширенном режиме

Расширенный режим позволяет предоставить больше параметров, влияющих на оценку единиц запросов/с. Чтобы использовать этот параметр, перейдите к [планировщику](https://cosmos.azure.com/capacitycalculator/) ресурсов и войдите в средство с помощью учетной записи, используемой для Azure. Параметр входа доступен в правом верхнем углу. 

После входа в систему можно увидеть дополнительные поля по сравнению с полями в базовом режиме. Введите дополнительные параметры в зависимости от рабочей нагрузки. 

|**Ввод**  |**Описание**  |
|---------|---------|
|API|Azure Cosmos DB — многомодельная и многоapi-служба. Для новых рабочих нагрузок выберите API SQL (ядро). |
|Число регионов|Служба Azure Cosmos DB доступна во всех регионах Azure. Выберите число регионов, необходимых для рабочей нагрузки. Вы можете связать любое количество регионов с учетной записью Cosmos. Дополнительные сведения см. в разделе [глобальное распространение](distribute-data-globally.md) в Azure Cosmos DB.|
|Выполнение операций записи в нескольких регионах|Если включить [запись в несколько регионов](distribute-data-globally.md#key-benefits-of-global-distribution), приложение сможет выполнять чтение и запись в любой регион Azure. При отключении операций записи в несколько регионов приложение может записывать данные в один регион. <br/><br/> Включите запись в несколько регионов, если предполагается наличие активной рабочей нагрузки, требующей записи с низкой задержкой в разных регионах. Например, Рабочая нагрузка центра Интернета вещей, которая записывает данные в базу данных на высоких томах в разных регионах. <br/><br/> Запись в несколько регионов гарантирует доступность 99,999% для чтения и записи. Для операций записи в несколько регионов требуется дополнительная пропускная способность по сравнению с отдельными регионами записи. Дополнительные сведения см. в статье [об отличиях в одной и нескольких регионах](optimize-cost-regions.md) .|
|Согласованность по умолчанию|Azure Cosmos DB поддерживает 5 уровней согласованности, позволяя разработчикам сбалансировать компромисс между согласованностью, доступностью и компромиссами задержки. Дополнительные сведения см. в статье [уровни согласованности](consistency-levels.md) . <br/><br/> По умолчанию Azure Cosmos DB использует согласованность сеанса, что гарантирует возможность чтения собственных операций записи в сеансе. <br/><br/> Выбор строгой или ограниченной устаревания потребует удвоения требуемых единиц запросов в секунду для операций чтения, по сравнению с сеансом, согласованный префикс и окончательная согласованность. Строгая согласованность с записью в нескольких регионах не поддерживается и будет автоматически по умолчанию выполнять операции записи в одну область с строгой согласованностью. |
|Политика индексирования|По умолчанию Azure Cosmos DB [индексирует все свойства](index-policy.md) во всех элементах для гибких и эффективных запросов (сопоставляется с политикой **автоматической** индексации). <br/><br/> Если вы выберете значение **Off**, ни одно из свойств не будет индексироваться. Это приводит к наименьшей ЕДИНИЦе оплаты за операции записи. Выберите параметр **Отключить** политику, если предполагается только [Чтение точек](/dotnet/api/microsoft.azure.cosmos.container.readitemasync) (уточняющие значения ключа) и/или операции записи, а запросы отсутствуют. <br/><br/> Пользовательская политика индексации позволяет включать или исключать определенные свойства из индекса для снижения пропускной способности записи и хранения. Дополнительные сведения см. в статьях [Политика индексирования](index-overview.md) и [примеры политик индексирования](how-to-manage-indexing-policy.md#indexing-policy-examples) .|
|Общее количество хранимых данных (для каждого региона)|Общая оценочная сумма данных, хранящихся в ГБ, в одном регионе.|
|Режим рабочей нагрузки|Выберите значение **устойчиво** , если объем рабочей нагрузки является постоянным. <br/><br/> Выберите **переменную** , если объем рабочей нагрузки изменяется с течением времени.  Например, в течение определенного дня или месяца. <br/><br/> Если выбран параметр переменная Рабочая нагрузка, доступны следующие параметры:<ul><li>Процент времени пиковой нагрузки: процент времени в месяце, в течение которого Рабочая нагрузка требует Пиковая (самая высокая) пропускная способность. <br/><br/> Например, если у вас есть рабочая нагрузка, которая имеет высокую активность во время 9:00 – 18:00 в рабочее время, то процент времени пиковой нагрузки составляет 45 часов с пиковой/730 ч/месяц = ~ 6%.<br/><br/></li><li>Операций чтения в секунду на один регион в пиковое число операций чтения в секунду в пиковую нагрузку.</li><li>Операций записи в секунду на регион в пиковое число — количество операций записи в секунду в пиковой нагрузке.</li><li>Операций чтения/с на регион вне пикового числа — количество операций чтения, ожидаемых в секунду в течение пиковой нагрузки.</li><li>Операций записи/с на регион вне пикового числа — количество операций записи, ожидаемых в секунду в течение пиковой нагрузки.</li></ul>С пиковыми и непиковыми интервалами можно оптимизировать затраты путем [программного масштабирования подготовленной пропускной способности](set-throughput.md#update-throughput-on-a-database-or-a-container) соответственно.|
|Размер элемента|Размер элемента данных (например, документа) в диапазоне от 1 КБ до 2 МБ. <br/><br/>Можно также **отправить образец документа (JSON)** для более точной оценки.<br/><br/>Если Рабочая нагрузка содержит несколько типов элементов (с другим содержимым JSON) в одном контейнере, можно отправить несколько документов JSON и получить оценку. Используйте кнопку **Добавить новый элемент** , чтобы добавить несколько примеров документов JSON.|

Можно также нажать кнопку **сохранить оценку** , чтобы скачать CSV-файл, содержащий текущую оценку. 

:::image type="content" source="./media/estimate-ru-with-capacity-planner/advanced-mode.png" alt-text="Расширенный режим планировщика ресурсов":::

Цены, показанные в планировщике мощностей Azure Cosmos DB, измеряются на основе общедоступных цен для пропускной способности и хранения. Все цены показаны в долларах США. Просмотрите [страницу цен на Azure Cosmos DB](https://azure.microsoft.com/pricing/details/cosmos-db/) , чтобы просмотреть все ставки по регионам.  

## <a name="estimating-throughput-for-queries"></a>Оценка пропускной способности для запросов

Калькулятор емкости Azure Cosmos предполагает чтение точки (чтение одного элемента, например документа, по ИДЕНТИФИКАТОРу и значению ключа секции) и запись для рабочей нагрузки. Чтобы оценить пропускную способность, необходимую для запросов, выполните запрос к набору репрезентативных данных в контейнере Cosmos и [получите оплату за единицу](find-request-unit-charge.md). Чтобы получить общее количество единиц запросов в секунду, умножьте счет на ЕДИНИЦу по количеству ожидаемых на выполнение запросам. 

Например, если для вашей рабочей нагрузки требуется запрос, ``SELECT * FROM c WHERE c.id = 'Alice'`` который выполняется 100 раз в секунду, а единица оплаты запроса — 10, то для обработки этих запросов потребуется 100 запросов/с * 10 единиц запросов в секунду или запрос = 1000 единиц запроса в секунду. Добавьте эти единицы запросов в секунду в ЕДИНИЦу запроса/s, необходимые для операций чтения или записи в рабочей нагрузке.

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения о [модели ценообразования Azure Cosmos DB](how-pricing-works.md).
* Создайте новую [учетную запись Cosmos, базу данных и контейнер](create-cosmosdb-resources-portal.md).
* Узнайте, как [оптимизировать подготовленные затраты на пропускную способность](optimize-cost-throughput.md).
* Узнайте, как [оптимизировать стоимость с зарезервированной емкостью](cosmos-db-reserved-capacity.md).