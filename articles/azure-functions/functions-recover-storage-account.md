---
title: 'Устранение ошибки: среда выполнения Функций Azure недоступен'
description: Узнайте, как устранять неполадки, связанные с недопустимой учетной записью хранения.
ms.topic: article
ms.date: 09/05/2018
ms.openlocfilehash: 9f6592b6d5ef88127a9dfca1e868564be0aa4ed5
ms.sourcegitcommit: d59abc5bfad604909a107d05c5dc1b9a193214a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/14/2021
ms.locfileid: "98217300"
---
# <a name="troubleshoot-error-azure-functions-runtime-is-unreachable"></a>Устранение ошибки: "среда выполнения Функций Azure недоступен"

Эта статья поможет устранить неполадки со следующей строкой ошибки, которая отображается в портал Azure:

> "Ошибка: среда выполнения Функций Azure недоступен. Щелкните здесь, чтобы получить сведения о конфигурации хранилища.

Эта проблема возникает, когда не удается запустить среду выполнения функций. Наиболее распространенной причиной этого является то, что приложение-функция потеряло доступ к своей учетной записи хранения. Дополнительные сведения см. в статье [требования к учетной записи хранения](storage-considerations.md#storage-account-requirements).

Оставшаяся часть этой статьи поможет устранить определенные причины этой ошибки, в том числе способ определения и разрешения каждого случая.

## <a name="storage-account-was-deleted"></a>Учетная запись хранения удалена

Для работы каждого приложения-функции нужна учетная запись хранения. Если эта учетная запись будет удалена, функции не будут работать.

Начните с поиска имени учетной записи хранения в параметрах приложения. `AzureWebJobsStorage`Или `WEBSITE_CONTENTAZUREFILECONNECTIONSTRING` содержит имя вашей учетной записи хранения как часть строки подключения. Дополнительные сведения см. в разделе [Справочник по параметрам приложений для функций Azure](./functions-app-settings.md#azurewebjobsstorage).

Выполните поиск учетной записи хранения в портал Azure, чтобы узнать, не существует ли она. Если она была удалена, повторно создайте учетную запись хранения и замените строки подключения к хранилищу. Код функции будет потерян, и его необходимо развернуть повторно.

## <a name="storage-account-application-settings-were-deleted"></a>Параметры приложения учетной записи хранения удалены

На предыдущем шаге, если не удается найти строку подключения учетной записи хранения, вероятно, она была удалена или перезаписана. Удаление параметров приложения чаще всего происходит при использовании слотов развертывания или сценариев Azure Resource Manager для установки параметров приложения.

### <a name="required-application-settings"></a>Необходимые параметры приложения

* Обязательно.
    * [`AzureWebJobsStorage`](./functions-app-settings.md#azurewebjobsstorage)
* Требуется для функций плана потребления и Premium:
    * [`WEBSITE_CONTENTAZUREFILECONNECTIONSTRING`](./functions-app-settings.md)
    * [`WEBSITE_CONTENTSHARE`](./functions-app-settings.md)

Дополнительные сведения см. в разделе [Справочник по параметрам приложений для функций Azure](./functions-app-settings.md).

### <a name="guidance"></a>Руководство

* Не проверять **параметр слота** для любого из этих параметров. При переключении слотов развертывания приложение функции останавливается.
* Не изменяйте эти параметры как часть автоматизированных развертываний.
* Эти параметры должны быть указаны и допустимы во время создания. Автоматическое развертывание, которое не содержит этих параметров, приводит к невозможности запуска приложения-функции, даже если эти параметры будут добавлены позже.

## <a name="storage-account-credentials-are-invalid"></a>Недопустимые учетные данные учетной записи хранения

Ранее обсуждаемые строки подключения учетной записи хранения необходимо обновить при повторном создании ключей хранилища. Дополнительные сведения об управлении ключами хранилища см. в статье [Создание учетной записи хранения Azure](../storage/common/storage-account-create.md).

## <a name="storage-account-is-inaccessible"></a>Учетная запись хранения недоступна

Приложение функции должно иметь доступ к учетной записи хранения. Распространенные проблемы, блокирующие доступ приложения-функции к учетной записи хранения:

* Приложение-функция развертывается в Среда службы приложений (ASE) без правильных правил сети для разрешения входящего и исходящего трафика в учетной записи хранения.

* Брандмауэр учетной записи хранения включен и не настроен для разрешения входящего и исходящего трафика функций. Дополнительные сведения см. в статье [Настройка брандмауэров службы хранилища Azure и виртуальных сетей](../storage/common/storage-network-security.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

## <a name="daily-execution-quota-is-full"></a>Квота ежедневного выполнения заполнена

Если настроена квота ежедневного выполнения, приложение-функция временно отключено, что приводит к тому, что многие элементы управления портала становятся недоступными. 

Чтобы проверить квоту в [портал Azure](https://portal.azure.com), выберите **функции платформы**  >  **приложение-функция параметры** в приложении функции. Если вы используете заданную **квоту ежедневного использования** , отображается следующее сообщение:

  > "Приложение-функция достигнута квота на ежедневное использование и была остановлена до следующего периода времени (24 часа)".

Чтобы устранить эту проблему, удалите или увеличьте дневную квоту, а затем перезапустите приложение. В противном случае выполнение приложения блокируется до следующего дня.

## <a name="app-is-behind-a-firewall"></a>Приложение находится за брандмауэром

Приложение функции может быть недоступным по одной из следующих причин:

* Приложение-функция размещается в [Среда службы приложений с балансировкой нагрузки с внутренней нагрузкой](../app-service/environment/create-ilb-ase.md) и настраивается для блокировки входящего интернет-трафика.

* У приложения-функции есть [ограничения на входящие IP](functions-networking-options.md#inbound-access-restrictions) , настроенные для блокировки доступа к Интернету. 

Портал Azure обращается непосредственно к выполняющемуся приложению для выборки списка функций и выполняет HTTP-вызовы к конечной точке KUDU. Параметры уровня платформы на вкладке **функции платформы** по-прежнему доступны.

Чтобы проверить конфигурацию ASE, выполните следующие действия.
1. Перейдите в группу безопасности сети (NSG) подсети, в которой находится ASE.
1. Проверьте правила входящего трафика, чтобы разрешить трафик, поступающий с общедоступного IP-адреса компьютера, на котором выполняется доступ к приложению. 
   
Можно также использовать портал на компьютере, подключенном к виртуальной сети, в которой выполняется приложение, или на виртуальной машине, работающей в виртуальной сети. 

Дополнительные сведения о конфигурации правил для входящих подключений см. в разделе "группы безопасности сети" статьи [рекомендации по работе с сетью для среда службы приложений](../app-service/environment/network-info.md#network-security-groups).

## <a name="next-steps"></a>Дальнейшие действия

Сведения о мониторинге приложений функции:

> [!div class="nextstepaction"]
> [Мониторинг Функций Azure](functions-monitoring.md)
