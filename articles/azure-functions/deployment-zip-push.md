---
title: Непрерывное развертывание Функций Azure из ZIP-файла
description: Публикация Функций Azure с помощью средств непрерывного развертывания службы развертывания Kudu из ZIP-файла.
ms.topic: conceptual
ms.date: 08/12/2018
ms.openlocfilehash: e104661dcdf1f6c6fd6dd5eb1024748980e7931f
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96018457"
---
# <a name="zip-deployment-for-azure-functions"></a>Развертывание Функций Azure из ZIP-файла

В этой статье описывается развертывание файлов проекта приложения-функции Azure из (сжатого) ZIP-файла. Вы узнаете, как принудительно начать развертывание, как с помощью интерфейса командной строки Azure, так и с помощью REST API. В [основных инструментах Функций Azure](functions-run-local.md) также используются эти API развертывания при публикации локального проекта в Azure.

Служба приложений Azure предоставляет широкий спектр параметров для непрерывной интеграции и развертывания Функций Azure. Дополнительные сведения см. в статье [Непрерывное развертывание для функций Azure](functions-continuous-deployment.md).

Чтобы ускорить разработку, может оказаться проще развернуть файлы проекта приложения-функции непосредственно из ZIP-файла. API развертывания ZIP-файла извлекает содержимое ZIP-файла в папку `wwwroot` приложения-функции. Это развертывание ZIP-файла осуществляется с помощью той же службы Kudu, которая обеспечивает непрерывное развертывание на основе интеграции, включая:

+ удаление файлов, оставшихся после предыдущих развертываний;
+ настройку развертывания, в том числе выполнение скриптов развертывания;
+ журналы развертывания.
+ синхронизацию триггеров функций в приложении-функции [План потребления](functions-scale.md).

Дополнительные сведения см. в [справочнике по развертыванию из ZIP-файлов](https://github.com/projectkudu/kudu/wiki/Deploying-from-a-zip-file).

## <a name="deployment-zip-file-requirements"></a>Требования к развертыванию из ZIP-файла

Используемый для принудительного развертывания ZIP-файл должен содержать все файлы, необходимые для выполнения функции.

>[!IMPORTANT]
> При использовании развертывания из ZIP-файла любые файлы из имеющегося развертывания, которые не найдены в ZIP-файле, будут удалены из приложения-функции.  

[!INCLUDE [functions-folder-structure](../../includes/functions-folder-structure.md)]

Приложение-функция включает все файлы и папки в каталоге `wwwroot`. При развертывании из ZIP-файла используется содержимое каталога `wwwroot`, а не сам каталог. При развертывании проекта библиотеки классов C# во вложенную папку `bin` в ZIP-архиве необходимо добавить скомпилированные файлы библиотеки и зависимости.

## <a name="download-your-function-app-files"></a>Загрузка файлов приложения-функции

При разработке на локальном компьютере несложно создать ZIP-файл папки проекта приложения-функции на компьютере разработчика.

Тем не менее вы могли создать свои функции с помощью редактора на портале Azure. Имеющийся проект приложения-функции можно загрузить одним из следующих способов:

+ **Из портал Azure:**

  1. Войдите на [портал Azure](https://portal.azure.com) и перейдите к своему приложению-функции.

  2. На вкладке **Обзор** выберите **Загрузить содержимое приложения**. Выберите параметры скачивания, а затем выберите команду **Загрузить**.

      ![Загрузка проекта приложения-функции](./media/deployment-zip-push/download-project.png)

     Загруженный ZIP-файл обладает правильным форматом, и он должен быть опубликован в приложении-функции с помощью принудительного развертывания из ZIP-файла. В этом случае вы также загружаете файлы, позволяющие открыть приложение-функцию непосредственно в Visual Studio.

+ **Использование API-интерфейсов RESTFUL:**

    Чтобы загрузить файлы из проекта `<function_app>`, выполните следующий вызов GET в API развертывания: 

    ```http
    https://<function_app>.scm.azurewebsites.net/api/zip/site/wwwroot/
    ```

    Добавление части `/site/wwwroot/` гарантирует, что ZIP-файл содержит только файлы проекта приложения-функции, а не всего сайта. Если вы еще не вошли в Azure, появится соответствующий запрос.  

ZIP-файл также можно загрузить из репозитория GitHub. При загрузке репозитория GitHub как ZIP-файла GitHub добавляет еще один уровень папки для ветви. Этот дополнительный уровень папки означает, что нельзя просто напрямую развернуть ZIP-файл после его загрузки из GitHub. Если вы используете репозиторий GitHub для поддержки приложения-функции, для развертывания своего приложения следует использовать [непрерывную интеграцию](functions-continuous-deployment.md).  

## <a name="deploy-by-using-azure-cli"></a><a name="cli"></a>Развертывание с помощью Azure CLI

Azure CLI можно использовать для активации принудительного развертывания. Активируйте принудительное развертывание ZIP-файла в свое приложение-функцию с помощью команды [az functionapp deployment source config-zip](/cli/azure/functionapp/deployment/source#az-functionapp-deployment-source-config-zip). Чтобы использовать эту команду, необходимо использовать Azure CLI версии 2.0.21 или более поздней версии. Чтобы просмотреть версию Azure CLI, воспользуйтесь командой `az --version`.

В следующей команде вместо заполнителя `<zip_file_path>` укажите путь к расположению ZIP-файла. Кроме того, замените на `<app_name>` уникальное имя приложения функции и замените на `<resource_group>` имя группы ресурсов.

```azurecli-interactive
az functionapp deployment source config-zip -g <resource_group> -n \
<app_name> --src <zip_file_path>
```

Эта команда выполняет развертывание файлов проекта из загруженного ZIP-файла для приложения-функции в Azure. Затем приложение перезапускается. Чтобы просмотреть список развертываний для этого приложения-функции, необходимо использовать REST API.

Если вы используете Azure CLI на локальном компьютере, `<zip_file_path>` — это путь к ZIP-файлу на компьютере. Можно также запустить Azure CLI в [Azure Cloud Shell](../cloud-shell/overview.md). При использовании Cloud Shell необходимо сначала отправить ZIP-файл развертывания в учетную запись Файлы Azure, связанную с Cloud Shell. В этом случае `<zip_file_path>` — это место хранения, используемое в учетной записи Cloud Shell. Дополнительные сведения см. в статье [Сохранение файлов в Azure Cloud Shell](../cloud-shell/persisting-shell-storage.md).

[!INCLUDE [app-service-deploy-zip-push-rest](../../includes/app-service-deploy-zip-push-rest.md)]

## <a name="run-functions-from-the-deployment-package"></a>Выполнение функций из пакета развертывания

Выполнять функции можно также непосредственно из файла пакета развертывания. Этот метод не предусматривает шаг развертывания, на котором файлы копируются из пакета в каталог `wwwroot` приложения-функции. Вместо этого файл пакета подключается с помощью среды выполнения Функций, а содержимое каталога `wwwroot` становится доступным только для чтения.  

Развертывание из ZIP-файла интегрируется с этой возможностью. Ее можно включить, задав для параметра приложения-функции `WEBSITE_RUN_FROM_PACKAGE` значение `1`. Дополнительные сведения см. в разделе [Run your Azure Functions from a package file](run-functions-from-deployment-package.md) (Запуск Функций Azure из файла пакета).

[!INCLUDE [app-service-deploy-zip-push-custom](../../includes/app-service-deploy-zip-push-custom.md)]

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Непрерывное развертывание для Функций Azure](functions-continuous-deployment.md)

[.zip push deployment reference topic]: https://github.com/projectkudu/kudu/wiki/Deploying-from-a-zip-file
