---
title: Выставление счетов за устойчивые функции — Функции Azure
description: Узнайте о внутренних поведениях Устойчивых функций и о том, как они влияют на выставление счетов за использование Функций Azure.
author: cgillum
ms.topic: overview
ms.date: 08/31/2019
ms.author: azfuncdf
ms.openlocfilehash: 2ec1b080c195a47caafd0120240b5fb61ede062b
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "97932288"
---
# <a name="durable-functions-billing"></a>Выставление счетов за Устойчивые функции

Счета за [Устойчивые функции](durable-functions-overview.md) выставляются так же, как и за Функции Azure. Дополнительные сведения см. на странице [цен на Функции Azure](https://azure.microsoft.com/pricing/details/functions/).

При выполнении функций оркестратора в рамках [плана потребления](../consumption-plan.md) Функций Azure необходимо знать некоторые особенности при выставлении счетов. В следующих разделах эти характеристики и их влияние описаны более подробно.

## <a name="orchestrator-function-replay-billing"></a>Выставление счетов за повторение функции оркестратора

[Функции оркестратора](durable-functions-orchestrations.md) могут повторяться несколько раз в течение всего времени действия оркестрации. Каждое повторение рассматривается средой выполнения функций Azure как отдельный вызов функции. По этой причине в плане потребления Функций Azure вам будет выставлен счет за каждое воспроизведение функции оркестратора. В других типах планов плата за повторение функции оркестратора не взимается.

## <a name="awaiting-and-yielding-in-orchestrator-functions"></a>Ожидание и возврат в функциях оркестратора

Когда функция оркестратора ожидает завершения асинхронного действия с помощью **ожидания** в C# или **приостановления** в JavaScript, среда выполнения считает, что это конкретное выполнение завершено. Выставление счетов за функцию оркестратора останавливается в этот момент. Оно не возобновляется до следующего воспроизведения функции оркестратора. Вы не оплачиваете время, потраченное на ожидание или возврат в функции оркестратора.

> [!NOTE]
> Функции, вызывающие другие функции, рассматриваются в качестве антишаблонных. Это связано с проблемой, известной как _двойная оплата_. Если функция напрямую вызывает другую функцию, обе операции выполняются одновременно. Вызываемая функция активно выполняет код, пока вызывающая функция ожидает ответа. В этом случае необходимо оплатить время, которое вызывающая функция тратит на ожидание выполнения вызываемой функции.
>
> В функциях оркестратора не существует двойного выставления счетов. Функция оркестратора прекращается, пока ожидается результат действия функции (или подсистемы).

## <a name="durable-http-polling"></a>Устойчивый опрос HTTP

Функции оркестратора поддерживают долго выполняющиеся HTTP-вызовы к внешним конечным точкам, как описано в статье о [функциях HTTP](durable-functions-http-features.md). Метод **CallHttpAsync** в C# и **callHttp** в JavaScript могут внутренне опрашивать конечную точку HTTP, следуя [асинхронному шаблону 202](durable-functions-http-features.md#http-202-handling).

В настоящее время прямое выставление счетов для внутренних операций опроса HTTP не проводится. Однако внутренний опрос может привести к периодическому воспроизведению функции оркестратора. Вам будут выставлены стандартные счета за эти внутренние воспроизведения функций.

## <a name="azure-storage-transactions"></a>Транзакции со службой хранилища Azure

Устойчивые функции используют службу хранилища Azure по умолчанию для сохранения состояния, обработки сообщений и управления разделами через аренду BLOB-объектов. Эта учетная запись хранения принадлежит вам, поэтому счета за транзакции выставляются для подписки Azure. Дополнительные сведения об артефактах службы хранилища Azure, используемых Устойчивыми функциями, см. в статье о [центрах задач](durable-functions-task-hubs.md).

На реальные затраты на хранилище Azure, вызванные приложением "Устойчивые функции", влияют несколько факторов.

* Одно приложение-функция связано с одним центром задач, который использует набор ресурсов службы хранилища Azure. Эти ресурсы используются всеми Устойчивыми функциями в приложении-функции. Фактическое число функций в приложении-функции не влияет на затраты на транзакции в службе хранилища Azure.
* Каждый экземпляр приложения-функции внутренне опрашивает несколько очередей в учетной записи хранения с использованием алгоритма экспоненциальной задержки. Бездействующее приложение опрашивает очереди реже, чем активное приложение, что приводит к снижению транзакционных издержек. Дополнительные сведения о поведении опроса очередей Устойчивыми функциями см. в [разделе "Опрос очередей" статьи "Производительность и масштабирование"](durable-functions-perf-and-scale.md#queue-polling).
* Во время работы в планах "Потребление" или "Премиум" Функций Azure [контроллер масштабирования Функций Azure](../event-driven-scaling.md) регулярно опрашивает все очереди центра задач в фоновом режиме. В случае понижения масштаба до умеренного уровня только один экземпляр контроллера масштабирования будет опрашивать эти очереди. Если приложение-функция масштабируется до большого количества экземпляров, могут быть добавлены дополнительные экземпляры контроллера масштабирования. Эти дополнительные экземпляры контроллера масштабирования могут увеличить общую стоимость транзакций очереди.
* Каждый экземпляр приложения-функции конкурирует за набор аренд BLOB-объектов. Эти экземпляры будут периодически вызывать службу BLOB-объектов Azure, чтобы обновить удерживаемые аренды или получить новые аренды. Количество аренд BLOB-объектов определяется в соответствии с количеством разделов, настроенных в центре задач. Масштабирование приложения-функции до большего количества экземпляров, скорее всего, увеличит затраты на транзакции хранилища Azure, связанные с этими операциями аренды.

Дополнительные сведения о ценах на службу хранилища Azure см. в документации по [ценам на службу хранилища Azure](https://azure.microsoft.com/pricing/details/storage/). 

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Дополнительные сведения о ценах для Функций Azure](https://azure.microsoft.com/pricing/details/functions/)
