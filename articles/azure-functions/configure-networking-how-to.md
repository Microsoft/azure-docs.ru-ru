---
title: Настройка функций Azure с помощью виртуальной сети
description: В этой статье показано, как выполнять определенные задачи виртуальной сети для функций Azure.
ms.topic: conceptual
ms.date: 3/13/2021
ms.custom: template-how-to
ms.openlocfilehash: a28a59a0de40bba7914d1920b42034fbbc223ddc
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104609535"
---
# <a name="how-to-configure-azure-functions-with-a-virtual-network"></a>Настройка функций Azure с помощью виртуальной сети

В этой статье показано, как выполнять задачи, связанные с настройкой приложения-функции для подключения и запуска в виртуальной сети. Дополнительные сведения о функциях и сетях Azure см. в статье [Сетевые параметры функций](functions-networking-options.md)Azure.

## <a name="restrict-your-storage-account-to-a-virtual-network"></a>Ограничьте учетную запись хранения виртуальной сети 

Когда вы создаете приложения-функции, необходимо создать или привязать учетную запись хранения Azure общего назначения, поддерживающую хранилища BLOB-объектов, очередей и таблиц. Эту учетную запись хранения можно заменить на ту, которая защищена конечными точками службы или частной конечной точкой. 

> [!NOTE]  
> В настоящее время эта функция работает для всех номеров SKU, поддерживаемых виртуальной сетью Windows, в специальном плане (служба приложений) и для планов Premium. План потребления не поддерживается. 

Чтобы настроить функцию с учетной записью хранения, которая ограничена частной сетью, выполните следующие действия.

1. Создайте функцию с учетной записью хранения, в которой не включены конечные точки службы.

1. Настройте функцию для подключения к виртуальной сети.

1. Создайте или настройте другую учетную запись хранения.  Это будет учетная запись хранения, защищенная с помощью конечных точек службы, и подключается к нашей функции.

1. [Создайте общую папку](../storage/files/storage-how-to-create-file-share.md#create-file-share) в защищенной учетной записи хранения.

1. Включите конечные точки службы или закрытую конечную точку для учетной записи хранения.  
    * При использовании подключений к частным конечным точкам учетной записи хранения потребуется частная конечная точка для `file` и `blob` подресурсов.  При использовании определенных возможностей, таких как Устойчивые функции, также требуются `queue` и `table` доступны через подключение частной конечной точки.
    * При использовании конечных точек службы включите подсеть, выделенную для приложений функций для учетных записей хранения.

1. Скопируйте файл и содержимое большого двоичного объекта из учетной записи хранения приложения-функции в защищенную учетную запись хранения и общую папку.

1. Скопируйте строку подключения для этой учетной записи хранения.

1. Обновите **Параметры приложения** в разделе **Конфигурация** для приложения функции следующим образом:

    | Имя параметра | Значение | Комментировать |
    |----|----|----|
    | `AzureWebJobsStorage`| строка подключения к хранилищу; | Это строка подключения для защищенной учетной записи хранения. |
    | `WEBSITE_CONTENTAZUREFILECONNECTIONSTRING` |  строка подключения к хранилищу; | Это строка подключения для защищенной учетной записи хранения. |
    | `WEBSITE_CONTENTSHARE` | Общая папка | Имя общей папки, созданной в защищенной учетной записи хранения, в которой находятся файлы развертывания проекта. |
    | `WEBSITE_CONTENTOVERVNET` | 1 | Новый параметр |
    | `WEBSITE_VNET_ROUTE_ALL` | 1 | Принудительно выполняет весь исходящий трафик через виртуальную сеть. Требуется, если учетная запись хранения использует подключения частной конечной точки. |
    | `WEBSITE_DNS_SERVER` | `168.63.129.16` | DNS-сервер, используемый приложением. Требуется, если учетная запись хранения использует подключения частной конечной точки. |

1. Нажмите кнопку **сохранить** , чтобы сохранить параметры приложения. Изменение параметров приложения приводит к перезапуску приложения.  

После перезапуска приложение-функция теперь подключается к защищенной учетной записи хранения.

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Параметры сети для Функций Azure](functions-networking-options.md)

