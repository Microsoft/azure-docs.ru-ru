---
title: Разработка Функций Azure с помощью Visual Studio Code
description: Узнайте, как разрабатывать и тестировать функции Azure с помощью расширения "функции Azure" для Visual Studio Code.
ms.topic: conceptual
ms.custom: devx-track-csharp
ms.date: 08/21/2019
ms.openlocfilehash: d4353e6be313d61716933879efa930e22472781b
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99493958"
---
# <a name="develop-azure-functions-by-using-visual-studio-code"></a>Разработка Функций Azure с помощью Visual Studio Code

[Расширение "функции Azure" для Visual Studio Code] позволяет локально разрабатывать функции и развертывать их в Azure. Если вы впервые сталкиваетесь с функциями Azure, дополнительные сведения см. в статье [Общие сведения о Функциях Azure](functions-overview.md).

Расширение функций Azure предоставляет следующие преимущества:

* Создание, редактирование и выполнение функций на локальном компьютере для разработки.
* Публикация проектов Функций Azure непосредственно в Azure.
* Создавайте свои функции на разных языках, используя преимущества Visual Studio Code.

Расширение можно использовать со следующими языками, которые поддерживаются средой выполнения функций Azure, начиная с версии 2. x:

* [Скомпилированный C#](functions-dotnet-class-library.md)
* [Скрипт C#](functions-reference-csharp.md)<sup>*</sup>
* [JavaScript](functions-reference-node.md)
* [Java](functions-reference-java.md)
* [PowerShell](functions-reference-powershell.md)
* [Python](functions-reference-python.md)

<sup>*</sup>Требует, чтобы [скрипт C# был задан как язык проекта по умолчанию](#c-script-projects).

В этой статье примеры в настоящее время доступны только для функций библиотеки классов JavaScript (Node.js) и C#.  

Эта статья содержит сведения об использовании расширения "функции Azure" для разработки функций и их публикации в Azure. Перед прочтением этой статьи необходимо [создать первую функцию с помощью Visual Studio Code](./create-first-function-vs-code-csharp.md).

> [!IMPORTANT]
> Не следует смешивать разработку локальной разработки и портала для одного приложения-функции. При публикации из локального проекта в приложение-функцию любые функции, разработанные на портале, будут перезаписаны в процессе развертывания.

## <a name="prerequisites"></a>Предварительные условия

Перед установкой и запуском расширения ["функции]Azure" для функций azure[для Visual Studio Code]необходимо соблюдать следующие требования.

* [Visual Studio Code](https://code.visualstudio.com/) , установленный на одной из [поддерживаемых платформ](https://code.visualstudio.com/docs/supporting/requirements#_platforms).

* Активная подписка Azure.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

Другие необходимые ресурсы, например учетная запись хранения Azure, создаются в подписке при [публикации с помощью Visual Studio Code](#publish-to-azure). 

### <a name="run-local-requirements"></a>Выполнение локальных требований

Эти предварительные требования необходимы только для [запуска и отладки функций локально](#run-functions-locally). Они не обязательно должны создавать или публиковать проекты в функциях Azure.

# <a name="c"></a>[C\#](#tab/csharp)

+ [Azure functions Core Tools](functions-run-local.md#install-the-azure-functions-core-tools) версии 2. x или более поздней. Пакет основных средств загружается и устанавливается автоматически при локальном запуске проекта. Основные средства включают всю среду выполнения функций Azure, поэтому загрузка и установка могут занять некоторое время.

+ [Расширение C#](https://marketplace.visualstudio.com/items?itemName=ms-dotnettools.csharp) для Visual Studio Code. 

+ [Средства .NET Core CLI](/dotnet/core/tools/?tabs=netcore2x).  

# <a name="java"></a>[Java](#tab/java)

+ [Azure functions Core Tools](functions-run-local.md#install-the-azure-functions-core-tools) версии 2. x или более поздней. Пакет основных средств загружается и устанавливается автоматически при локальном запуске проекта. Основные средства включают всю среду выполнения функций Azure, поэтому загрузка и установка могут занять некоторое время.

+ [Отладчик для расширения Java](https://marketplace.visualstudio.com/items?itemName=vscjava.vscode-java-debug).

+ Рекомендуется использовать [Java 8](/azure/developer/java/fundamentals/java-jdk-long-term-support) . Другие поддерживаемые версии см. в разделе [версии Java](functions-reference-java.md#java-versions).

+ [Maven 3 или более поздней версии](https://maven.apache.org/)

# <a name="javascript"></a>[JavaScript](#tab/nodejs)

+ [Azure functions Core Tools](functions-run-local.md#install-the-azure-functions-core-tools) версии 2. x или более поздней. Пакет основных средств загружается и устанавливается автоматически при локальном запуске проекта. Основные средства включают всю среду выполнения функций Azure, поэтому загрузка и установка могут занять некоторое время.

+ [Node.js](https://nodejs.org/), активная версия LTS и версия Maintenance LTS (рекомендуется 10.14.1). Используйте команду `node --version`, чтобы проверить установленную версию. 

# <a name="powershell"></a>[PowerShell](#tab/powershell)

+ [Azure functions Core Tools](functions-run-local.md#install-the-azure-functions-core-tools) версии 2. x или более поздней. Пакет основных средств загружается и устанавливается автоматически при локальном запуске проекта. Основные средства включают всю среду выполнения функций Azure, поэтому загрузка и установка могут занять некоторое время.

+ Рекомендуется использовать [PowerShell 7](/powershell/scripting/install/installing-powershell-core-on-windows) . Сведения о версии см. в статье [версии PowerShell](functions-reference-powershell.md#powershell-versions).

+ Среды выполнения [.NET Core 3.1](https://www.microsoft.com/net/download) и [.NET Core 2.1](https://dotnet.microsoft.com/download/dotnet-core/2.1).  

+ [Расширение PowerShell для Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell).  

# <a name="python"></a>[Python](#tab/python)

+ [Azure functions Core Tools](functions-run-local.md#install-the-azure-functions-core-tools) версии 2. x или более поздней. Пакет основных средств загружается и устанавливается автоматически при локальном запуске проекта. Основные средства включают всю среду выполнения функций Azure, поэтому загрузка и установка могут занять некоторое время.

+ [Python 3. x](https://www.python.org/downloads/). Сведения о версии см. в статье [версии Python](functions-reference-python.md#python-version) с помощью среды выполнения функций Azure.

+ [Расширение Visual Studio Code для Python](https://marketplace.visualstudio.com/items?itemName=ms-python.python).

---

[!INCLUDE [functions-install-vs-code-extension](../../includes/functions-install-vs-code-extension.md)]

## <a name="create-an-azure-functions-project"></a>Создание проекта Функций Azure

Расширение функции позволяет создать проект приложения-функции вместе с первой функцией. В следующих шагах показано, как создать функцию, активируемую HTTP, в новом проекте функций. [Триггер HTTP](functions-bindings-http-webhook.md) — это простейший шаблон триггера функции для демонстрации.

1. Из **Azure: функции** выберите значок **создать функцию** :

    ![Создание функции](./media/functions-develop-vs-code/create-function.png)

1. Выберите папку для проекта приложения-функции, а затем **выберите язык для проекта функции**.

1. Выберите шаблон функции **триггера HTTP** или нажмите кнопку **пропустить пока** , чтобы создать проект без функции. Вы всегда можете [Добавить функцию в проект](#add-a-function-to-your-project) позже.

    ![Выбор шаблона функции, активируемой HTTP-запросом](./media/functions-develop-vs-code/create-function-choose-template.png)

1. Введите **хттпексампле** в качестве имени функции и нажмите клавишу ВВОД, а затем выберите авторизация **функции** . Этот уровень авторизации требует предоставления [ключа функции](functions-bindings-http-webhook-trigger.md#authorization-keys) при вызове конечной точки функции.

    ![Выбор авторизации функции](./media/functions-develop-vs-code/create-function-auth.png)

    Функция создается на выбранном языке и в шаблоне для функции, активируемой HTTP.

    ![Шаблон функции, активируемой HTTP, в Visual Studio Code](./media/functions-develop-vs-code/new-function-full.png)

### <a name="generated-project-files"></a>Созданные файлы проекта

Шаблон проекта создает проект на выбранном языке и устанавливает необходимые зависимости. Для любого языка в новом проекте есть следующие файлы:

* **host.json**: позволяет настроить узел Функций. Эти параметры применяются при локальном запуске функций и при их запуске в Azure. Дополнительные сведения см. в [справочной статье о host.json](functions-host-json.md).

* **local.settings.json**: сохраняет параметры, используемые при локальном запуске функций. Эти параметры используются только при локальном запуске функций. Дополнительные сведения см. в разделе [локальный файл параметров](#local-settings-file).

    >[!IMPORTANT]
    >Поскольку local.settings.jsв файле могут содержать секреты, необходимо исключить его из системы управления версиями проекта.

В зависимости от языка создаются следующие файлы:

# <a name="c"></a>[C\#](#tab/csharp)

* [Файл библиотеки классов хттпексампле. CS](functions-dotnet-class-library.md#functions-class-library-project) , реализующий функцию.

# <a name="java"></a>[Java](#tab/java)

+ Файл pom.xml в корневой папке, определяющий проект и параметры развертывания, включая зависимости проектов и [версию Java](functions-reference-java.md#java-versions). pom.xml также содержит сведения о ресурсах Azure, создаваемых во время развертывания.   

+ [Файл functions. Java](functions-reference-java.md#triggers-and-annotations) в пути src, который реализует функцию.

# <a name="javascript"></a>[JavaScript](#tab/nodejs)

* package.jsфайла в корневой папке.

* Папка Хттпексампле, содержащая [function.jsдля файла определения](functions-reference-node.md#folder-structure) и [index.jsного](functions-reference-node.md#exporting-a-function)файла, Node.js файл, содержащий код функции.

# <a name="powershell"></a>[PowerShell](#tab/powershell)

* Папка Хттпексампле, содержащая [function.jsфайла определения](functions-reference-powershell.md#folder-structure) и файла run.ps1, который содержит код функции.
 
# <a name="python"></a>[Python](#tab/python)
    
* Файл requirements.txt уровня проекта, в котором перечислены пакеты, необходимые для функций.
    
* Папка Хттпексампле, содержащая [function.jsдля файла определения](functions-reference-python.md#folder-structure) и \_ \_ \_ \_ файла init. корректировки, который содержит код функции.

---

На этом этапе в функцию можно [Добавить входные и выходные привязки](#add-input-and-output-bindings) . [В проект также можно добавить новую функцию](#add-a-function-to-your-project).

## <a name="install-binding-extensions"></a>Установка расширений привязки

За исключением триггеров HTTP и таймера, привязки реализуются в пакетах расширений. Необходимо установить пакеты расширений для необходимых триггеров и привязок. Процесс установки расширений привязок зависит от языка проекта.

# <a name="c"></a>[C\#](#tab/csharp)

Выполните команду [DotNet Add Package](/dotnet/core/tools/dotnet-add-package) в окне терминала, чтобы установить пакеты расширений, необходимые в проекте. Следующая команда устанавливает расширение службы хранилища Azure, которое реализует привязки для хранилища BLOB-объектов, очередей и таблиц.

```bash
dotnet add package Microsoft.Azure.WebJobs.Extensions.Storage --version 3.0.4
```

# <a name="java"></a>[Java](#tab/java)

[!INCLUDE [functions-extension-bundles](../../includes/functions-extension-bundles.md)]

# <a name="javascript"></a>[JavaScript](#tab/nodejs)

[!INCLUDE [functions-extension-bundles](../../includes/functions-extension-bundles.md)]

# <a name="powershell"></a>[PowerShell](#tab/powershell)

[!INCLUDE [functions-extension-bundles](../../includes/functions-extension-bundles.md)]

# <a name="python"></a>[Python](#tab/python)

[!INCLUDE [functions-extension-bundles](../../includes/functions-extension-bundles.md)]

---

## <a name="add-a-function-to-your-project"></a>Добавление функции в проект

Новую функцию можно добавить в существующий проект, используя одну из стандартных функций шаблоны триггеров. Чтобы добавить новый триггер функции, выберите F1, чтобы открыть палитру команд, а затем найдите и выполните команду **функции Azure: CREATE FUNCTION**. Следуйте инструкциям на экране, чтобы выбрать тип триггера и определить необходимые атрибуты триггера. Если для триггера требуется ключ доступа или строка подключения для подключения к службе, перед созданием триггера функции подготовьте ее.

Результаты этого действия зависят от языка проекта:

# <a name="c"></a>[C\#](#tab/csharp)

В проект будет добавлен новый файл библиотеки классов C# (CS).

# <a name="java"></a>[Java](#tab/java)

В проект будет добавлен новый файл Java (. Java).

# <a name="javascript"></a>[JavaScript](#tab/nodejs)

В проекте будет создана новая папка. В этой папке содержится новый function.jsфайла и новый файл кода JavaScript.

# <a name="powershell"></a>[PowerShell](#tab/powershell)

В проекте будет создана новая папка. В этой папке содержится новый function.jsфайла и новый файл кода PowerShell.

# <a name="python"></a>[Python](#tab/python)

В проекте будет создана новая папка. В этой папке содержится новый function.jsфайла и новый файл кода Python.

---

## <a name="connect-to-services"></a><a name="add-input-and-output-bindings"></a>Подключение к службам

Вы можете подключить функцию к другим службам Azure, добавив входные и выходные привязки. Привязки соединяют вашу функцию с другими службами без необходимости написания кода подключения. Процесс добавления привязок зависит от языка проекта. Дополнительные сведения см. в статье [Основные понятия триггеров и привязок в Функциях Azure](functions-triggers-bindings.md).

В следующих примерах подключается к очереди хранилища с именем `outqueue` , где строка подключения для учетной записи хранения задается в `MyStorageConnection` параметре приложения в local.settings.json.

# <a name="c"></a>[C\#](#tab/csharp)

Обновите метод функции, чтобы добавить следующий параметр в `Run` Определение метода:

:::code language="csharp" source="~/functions-docs-csharp/functions-add-output-binding-storage-queue-cli/HttpExample.cs" range="17":::

Параметр `msg` относится к типу `ICollector<T>`, который представляет собой коллекцию сообщений, записываемых в выходную привязку после завершения функции. Следующий код добавляет сообщение в коллекцию:

:::code language="csharp" source="~/functions-docs-csharp/functions-add-output-binding-storage-queue-cli/HttpExample.cs" range="30-31":::

 Сообщения отправляются в очередь после завершения функции.

Дополнительные сведения см. в [статье Справочник по выходной привязке хранилища очередей](functions-bindings-storage-queue-output.md?tabs=csharp) . Дополнительные сведения о том, какие привязки можно добавить в функцию, см. в разделе [Добавление привязок в существующую функцию в](add-bindings-existing-function.md?tabs=csharp)функциях Azure. 

# <a name="java"></a>[Java](#tab/java)

Обновите метод функции, чтобы добавить следующий параметр в `Run` Определение метода:

:::code language="java" source="~/functions-quickstart-java/functions-add-output-binding-storage-queue/src/main/java/com/function/Function.java" range="20-21":::

`msg`Параметр является `OutputBinding<T>` типом, где — это `T` строка, которая записывается в выходную привязку по завершении выполнения функции. Следующий код задает сообщение в выходной привязке:

:::code language="java" source="~/functions-quickstart-java/functions-add-output-binding-storage-queue/src/main/java/com/function/Function.java" range="33-34":::

Это сообщение отправляется в очередь после завершения выполнения функции.

Дополнительные сведения см. в [статье Справочник по выходной привязке хранилища очередей](functions-bindings-storage-queue-output.md?tabs=java) . Дополнительные сведения о том, какие привязки можно добавить в функцию, см. в разделе [Добавление привязок в существующую функцию в](add-bindings-existing-function.md?tabs=java)функциях Azure. 

# <a name="javascript"></a>[JavaScript](#tab/nodejs)

[!INCLUDE [functions-add-output-binding-vs-code](../../includes/functions-add-output-binding-vs-code.md)]

В коде функции `msg` доступ к привязке осуществляется из `context` , как показано в следующем примере:

:::code language="javascript" range="5-7" source="~/functions-docs-javascript/functions-add-output-binding-storage-queue-cli/HttpExample/index.js":::

Это сообщение отправляется в очередь после завершения выполнения функции.

Дополнительные сведения см. в [статье Справочник по выходной привязке хранилища очередей](functions-bindings-storage-queue-output.md?tabs=javascript) . Дополнительные сведения о том, какие привязки можно добавить в функцию, см. в разделе [Добавление привязок в существующую функцию в](add-bindings-existing-function.md?tabs=javascript)функциях Azure. 

# <a name="powershell"></a>[PowerShell](#tab/powershell)

[!INCLUDE [functions-add-output-binding-vs-code](../../includes/functions-add-output-binding-vs-code.md)]

:::code language="powershell" range="18-19" source="~/functions-docs-powershell/functions-add-output-binding-storage-queue-cli/HttpExample/run.ps1":::

Это сообщение отправляется в очередь после завершения выполнения функции.

Дополнительные сведения см. в [статье Справочник по выходной привязке хранилища очередей](functions-bindings-storage-queue-output.md?tabs=powershell) . Дополнительные сведения о том, какие привязки можно добавить в функцию, см. в разделе [Добавление привязок в существующую функцию в](add-bindings-existing-function.md?tabs=powershell)функциях Azure. 

# <a name="python"></a>[Python](#tab/python)

[!INCLUDE [functions-add-output-binding-vs-code](../../includes/functions-add-output-binding-vs-code.md)]

Обновите `Main` Определение, чтобы добавить выходной параметр, `msg: func.Out[func.QueueMessage]` чтобы определение было похоже на следующий пример:

:::code language="python" range="6" source="~/functions-docs-python/functions-add-output-binding-storage-queue-cli/HttpExample/__init__.py":::

Следующий код добавляет строковые данные из запроса в очередь вывода:

:::code language="python" range="18" source="~/functions-docs-python/functions-add-output-binding-storage-queue-cli/HttpExample/__init__.py":::

Это сообщение отправляется в очередь после завершения выполнения функции.

Дополнительные сведения см. в [статье Справочник по выходной привязке хранилища очередей](functions-bindings-storage-queue-output.md?tabs=python) . Дополнительные сведения о том, какие привязки можно добавить в функцию, см. в разделе [Добавление привязок в существующую функцию в](add-bindings-existing-function.md?tabs=python)функциях Azure. 

---

[!INCLUDE [functions-sign-in-vs-code](../../includes/functions-sign-in-vs-code.md)]

## <a name="publish-to-azure"></a>Публикация в Azure

Visual Studio Code позволяет публиковать проект функций непосредственно в Azure. При этом вы создаете приложение-функцию и связанные ресурсы в своей подписке Azure. Приложение-функция обеспечивает контекст выполнения функций. Проект упаковывается и развертывается в новом приложении-функции в вашей подписке Azure.

При публикации из Visual Studio Code в новое приложение-функцию в Azure можно выбрать вариант быстрого создания приложения-функции, используя значения по умолчанию или расширенный путь, в котором имеется больший контроль над созданными удаленными ресурсами. 

При публикации из Visual Studio Code Вы получаете преимущества технологии [развертывания ZIP](functions-deployment-technologies.md#zip-deploy) . 

### <a name="quick-function-app-create"></a>Быстрое создание приложения функции

Когда вы выбираете пункт **+ создать новое приложение функции в Azure...**, расширение автоматически создает значения для ресурсов Azure, необходимых для приложения функции. Эти значения основаны на выбранном имени приложения функции. Пример использования значений по умолчанию для публикации проекта в новом приложении-функции в Azure см. в [статье Краткое руководство по Visual Studio Code](./create-first-function-vs-code-csharp.md#publish-the-project-to-azure).

Если необходимо предоставить явные имена для созданных ресурсов, необходимо выбрать расширенный путь создания.

### <a name="publish-a-project-to-a-new-function-app-in-azure-by-using-advanced-options"></a><a name="enable-publishing-with-advanced-create-options"></a>Публикация проекта в новом приложении-функции в Azure с помощью дополнительных параметров

Следующие шаги публикуют проект в новом приложении-функции, созданном с дополнительными параметрами создания:

1. В поле палета команды введите **функции Azure: развертывание в приложение функции**.

1. Если вы еще не вошли в систему, вам будет предложено **войти в Azure**. Вы также можете **создать бесплатную учетную запись Azure**. После входа в систему из браузера вернитесь к Visual Studio Code.

1. Если у вас несколько подписок, **выберите подписку** для приложения-функции, а затем щелкните **+ создать новый приложение-функция в Azure... _Дополнительно_**. Этот _дополнительный_ параметр обеспечивает более широкие возможности управления ресурсами, создаваемыми в Azure. 

1. Следуя инструкциям, укажите следующие сведения:

    | prompt | Значение | Описание |
    | ------ | ----- | ----------- |
    | Выбор приложения функции в Azure | Создание нового приложение-функция в Azure | В следующем запросе введите глобально уникальное имя, идентифицирующее новое приложение-функцию, а затем нажмите клавишу ВВОД. Допустимые символы для имени приложения-функции: `a-z`, `0-9` и `-`. |
    | Выберите ОС | Windows | Приложение функции выполняется в Windows. |
    | Выберите план размещения | План потребления | Используется [Размещение плана потребления](consumption-plan.md) на сервере. |
    | Выберите среду выполнения для нового приложения | Язык проекта | Среда выполнения должна соответствовать проекту, в котором выполняется публикация. |
    | Выберите группу ресурсов для новых ресурсов | Создать новую группу ресурсов | В следующем запросе введите имя группы ресурсов, например `myResourceGroup` , и нажмите клавишу ВВОД. Можно также выбрать существующую группу ресурсов. |
    | Выбор учетной записи хранения | Создание учетной записи хранения | В следующем запросе введите глобально уникальное имя для новой учетной записи хранения, используемой приложением-функцией, а затем нажмите клавишу ВВОД. Длина имени учетной записи хранения должна составлять от 3 до 24 символов и может содержать только цифры и строчные буквы. Можно также выбрать существующую учетную запись. |
    | Выбор расположения для новых ресурсов | region | Выберите расположение в ближайшем [регионе](https://azure.microsoft.com/regions/) или рядом с другими службами, к которым имеют доступ ваши функции. |

    После создания приложения-функции и применения пакета развертывания появится уведомление. Выберите **View Output** (Просмотреть выходные данные) в уведомлении, чтобы просмотреть результаты создания и развертывания ресурсов Azure.

### <a name="get-the-url-of-an-http-triggered-function-in-azure"></a><a name="get-the-url-of-the-deployed-function"></a>Получение URL-адреса функции, активируемой HTTP, в Azure

Чтобы вызвать функцию, активируемую HTTP, из клиента, вам потребуется URL-адрес функции при его развертывании в приложении-функции. Этот URL-адрес включает все необходимые ключи функций. Вы можете использовать расширение для получения этих URL-адресов для развернутых функций. Если вы просто хотите запустить удаленную функцию в Azure, используйте функциональные возможности этого расширения в [функции Execute Now](#run-functions-in-azure) .

1. Выберите F1, чтобы открыть палитру команд, а затем найдите и выполните команду **функции Azure: Копировать URL-адрес функции**.

1. Следуйте инструкциям на экране, чтобы выбрать приложение-функцию в Azure, а затем — конкретный триггер HTTP, который требуется вызвать.

URL-адрес функции копируется в буфер обмена вместе с любыми необходимыми ключами, передаваемыми `code` параметром запроса. Используйте HTTP-инструмент для отправки запросов POST или браузер для запросов GET к удаленной функции.  

При получении URL-адреса функций в Azure расширение использует учетную запись Azure для автоматического извлечения ключей, необходимых для запуска функции. Дополнительные [сведения о ключах доступа к функциям](security-concepts.md#function-access-keys). Для запуска функций, не активированных с помощью HTTP, необходимо использовать ключ администратора.

## <a name="republish-project-files"></a>Повторная публикация файлов проекта

При настройке [непрерывного развертывания](functions-continuous-deployment.md)приложение-функция в Azure обновляется при обновлении исходных файлов в подключенном исходном расположении. Рекомендуется непрерывное развертывание, но можно также повторно опубликовать обновления файлов проекта из Visual Studio Code.

> [!IMPORTANT]
> Публикация в существующее приложение-функцию перезаписывает содержимое этого приложения в Azure.

[!INCLUDE [functions-republish-vscode](../../includes/functions-republish-vscode.md)]

## <a name="run-functions"></a>Запуск функций

Расширение "функции Azure" позволяет выполнять отдельные функции либо в вашем проекте на локальном компьютере разработки, либо в подписке Azure. 

Для функций триггера HTTP расширение вызывает конечную точку HTTP. Для других типов триггеров он вызывает API администратора для запуска функции. Текст сообщения запроса, отправленного в функцию, зависит от типа триггера. Если для триггера требуются проверочные данные, вам будет предложено ввести данные в определенном формате JSON.

### <a name="run-functions-in-azure"></a>Запуск функций в Azure

Для выполнения функции в Azure из Visual Studio Code. 

1. В поле палета команды введите **функции Azure: выполнить функцию** и выберите подписку Azure. 

1. Выберите приложение функции в Azure из списка. Если приложение функции не отображается, убедитесь, что вы вошли в нужную подписку. 

1. Выберите из списка функцию, которую нужно запустить, и введите текст сообщения запроса в поле **введите текст запроса**. Нажмите клавишу ВВОД, чтобы отправить это сообщение запроса в свою функцию. Текст по умолчанию в поле **Ввод текста запроса** должен указывать на формат текста. Если приложение-функция не имеет функций, отображается сообщение об ошибке уведомления. 

1. При выполнении функции в Azure и возврате ответа в Visual Studio Code отобразится уведомление.
 
Вы также можете запустить функцию из области **Azure: функции** , щелкнув правой кнопкой мыши нужную функцию в приложении-функции в подписке Azure и выбрав пункт **выполнить функцию.**...

При выполнении функций в Azure расширение использует учетную запись Azure для автоматического получения ключей, необходимых для запуска функции. Дополнительные [сведения о ключах доступа к функциям](security-concepts.md#function-access-keys). Для запуска функций, не активированных с помощью HTTP, необходимо использовать ключ администратора.

### <a name="run-functions-locally"></a>Запуск функций в локальной среде

Локальная среда выполнения — это та же среда выполнения, в которой размещается приложение-функция в Azure. Локальные параметры считываются из [local.settings.jsв файле](#local-settings-file). Для локального запуска проекта функций необходимо соблюдение [дополнительных требований](#run-local-requirements).

#### <a name="configure-the-project-to-run-locally"></a>Настройка запуска проекта локально

Среда выполнения функций использует для внутренних целей учетную запись хранения Azure для всех типов триггеров, отличных от HTTP и веб-перехватчиков. Поэтому необходимо присвоить ключу **Values. AzureWebJobsStorage** строку подключения к допустимой учетной записи хранения Azure.

В этом разделе используется [расширение службы хранилища Azure для Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurestorage) с [Обозреватель службы хранилища Azure](https://storageexplorer.com/) для подключения и получения строки подключения к хранилищу.

Чтобы задать строку подключения к учетной записи хранения, выполните следующие действия:

1. В Visual Studio откройте **Cloud Explorer**, разверните **учетная запись хранения**  >  **ваша учетная запись хранения**, а затем выберите **Свойства** и скопируйте значение **основного значения строки подключения** .

2. В своем проекте откройте файл local.settings.json и задайте в качестве значения ключа **AzureWebJobsStorage** скопированную вами строку подключения.

3. Повторите предыдущий шаг, чтобы добавить уникальные ключи в массив **Values** для всех других подключений, которые необходимы для функций.

Дополнительные сведения см. в разделе [локальный файл параметров](#local-settings-file).

#### <a name="debug-functions-locally"></a><a name="debugging-functions-locally"></a>Отладка функций в локальной среде  

Чтобы выполнить отладку функций, нажмите клавишу F5. Если вы еще не скачали [основные средства][Azure functions Core Tools], вам будет предложено сделать это. После установки и запуска основных инструментов выходные данные отображаются в окне терминала. Это аналогично запуску `func host start` команды Core Tools из терминала, но с дополнительными задачами сборки и подключенным отладчиком.  

Когда проект запущен, вы можете использовать функцию **EXECUTE Now...** расширения, чтобы активировать функции, как при развертывании проекта в Azure. Если проект выполняется в режиме отладки, точки останова нападают Visual Studio Code как и следовало бы ожиданиям. 

1. В поле палета команды введите **функции Azure: выполнить функцию** и выберите **локальный проект**. 

1. Выберите функцию, которую требуется выполнить в проекте, и введите текст сообщения в поле **введите текст запроса**. Нажмите клавишу ВВОД, чтобы отправить это сообщение запроса в свою функцию. Текст по умолчанию в поле **Ввод текста запроса** должен указывать на формат текста. Если приложение-функция не имеет функций, отображается сообщение об ошибке уведомления. 

1. Когда функция выполняется локально и после получения ответа, в Visual Studio Code создается уведомление. Сведения о выполнении функции отображаются на панели **Терминал**.

Локальное выполнение функций не требует использования ключей. 

[!INCLUDE [functions-local-settings-file](../../includes/functions-local-settings-file.md)]

По умолчанию эти параметры не переносятся автоматически при публикации проекта в Azure. После завершения публикации вы можете выбрать параметры публикации из local.settings.jsв приложение функции в Azure. Дополнительные сведения см. в разделе  [Публикация параметров приложения](#publish-application-settings).

Значения **ConnectionStrings** никогда не публикуются.

Значения параметров приложения функции можно также считывать в коде в виде переменных среды. Дополнительные сведения см. в разделах переменные среды в следующих справочных статьях для конкретного языка:

* [Предкомпилированный код C#](functions-dotnet-class-library.md#environment-variables)
* [Скрипт C# (.csx)](functions-reference-csharp.md#environment-variables)
* [Java](functions-reference-java.md#environment-variables)
* [JavaScript](functions-reference-node.md#environment-variables)
* [PowerShell](functions-reference-powershell.md#environment-variables)
* [Python](functions-reference-python.md#environment-variables)

## <a name="application-settings-in-azure"></a>Параметры приложения в Azure

Параметры в файле local.settings.jsв проекте должны совпадать с параметрами приложения в приложении функции в Azure. Все параметры, добавляемые в local.settings.js, необходимо также добавить в приложение функции в Azure. Эти параметры не передаются автоматически при публикации проекта. Аналогичным образом все параметры, создаваемые в приложении функции [на портале](functions-how-to-use-azure-function-app-settings.md#settings) , должны быть загружены в локальный проект.

### <a name="publish-application-settings"></a>Опубликовать параметры приложения

Самый простой способ опубликовать необходимые параметры в приложении-функции в Azure — использовать ссылку **Отправить параметры** , которая появляется после публикации проекта.

![Отправка параметров приложения](./media/functions-develop-vs-code/upload-app-settings.png)

Параметры можно также опубликовать с помощью команды **функции Azure: отправить локальный параметр** в палитре команд. Вы можете добавить отдельные параметры в параметры приложения в Azure с помощью команды " **функции Azure": добавить новый параметр** .

> [!TIP]
> Не забудьте сохранить local.settings.jsв файле перед публикацией.

Если локальный файл зашифрован, он расшифровывается, публикуется и шифруется снова. Если имеются параметры, имеющие конфликтующие значения в двух расположениях, вам будет предложено выбрать способ продолжения.

Просмотрите существующие параметры приложения в области **Azure: функции** , развернув подписку, приложение функции и **Параметры приложения**.

![Просмотр параметров приложения функции в Visual Studio Code](./media/functions-develop-vs-code/view-app-settings.png)

### <a name="download-settings-from-azure"></a>Скачать параметры из Azure

Если вы создали параметры приложения в Azure, их можно скачать в local.settings.jsв файле с помощью команды " **функции Azure: скачать удаленные параметры"** .

Как и при передаче, если локальный файл зашифрован, он расшифровывается, обновляется и шифруется снова. Если имеются параметры, имеющие конфликтующие значения в двух расположениях, вам будет предложено выбрать способ продолжения.

## <a name="monitoring-functions"></a>Мониторинг функций

При [локальном запуске функций](#run-functions-locally)данные журнала передаются в консоль терминала. Вы также можете получать данные журнала при выполнении проекта функций в приложении-функции в Azure. Вы можете подключиться к журналам потоковой передачи в Azure, чтобы просмотреть данные журнала практически в реальном времени, или включить Application Insights, чтобы получить более полное представление о том, как работает приложение-функция.

### <a name="streaming-logs"></a>Журналы потоковой передачи.

При разработке приложения часто бывает удобно просматривать данные журнала практически в реальном времени. Можно просмотреть поток файлов журнала, создаваемых функциями. Эти выходные данные являются примером журналов потоковой передачи для запроса к функции, активируемой HTTP:

![Выходные данные журналов потоковой передачи для триггера HTTP](media/functions-develop-vs-code/streaming-logs-vscode-console.png)

Дополнительные сведения см. в разделе [Streaming Logs](functions-monitoring.md#streaming-logs).

[!INCLUDE [functions-enable-log-stream-vs-code](../../includes/functions-enable-log-stream-vs-code.md)]

> [!NOTE]
> Журналы потоковой передачи поддерживают только один экземпляр узла функций. Если функция масштабируется до нескольких экземпляров, данные из других экземпляров не отображаются в потоке журнала. [Live Metrics Stream](../azure-monitor/app/live-stream.md) в Application Insights поддерживает несколько экземпляров. Хотя потоковая аналитика также находится практически в реальном времени, она основана на [данных выборки](configure-monitoring.md#configure-sampling).

### <a name="application-insights"></a>Application Insights

Мы рекомендуем отслеживать выполнение функций, интегрируя приложение функции с Application Insights. При создании приложения-функции в портал Azure такая интеграция выполняется по умолчанию. При создании приложения функции во время публикации Visual Studio необходимо интегрировать Application Insights самостоятельно. Дополнительные сведения см. в разделе [Включение интеграции Application Insights](configure-monitoring.md#enable-application-insights-integration).

Дополнительные сведения о мониторинге с помощью Application Insights см. в статье [мониторинг функций Azure](functions-monitoring.md).

## <a name="c-script-projects"></a>\#Проекты скриптов C

По умолчанию все проекты C# создаются как [скомпилированные проекты библиотеки классов c#](functions-dotnet-class-library.md). Если вместо этого вы предпочитаете работать с проектами скриптов C#, в параметрах расширения функций Azure необходимо выбрать скрипт C# в качестве языка по умолчанию:

1. Выберите параметры настройки **файлов**  >    >  .

1. Перейдите в раздел **пользовательские параметры**  >  **расширения**  >  **функции Azure**.

1. Выберите **Сценарий C #** в **функции Azure: язык проекта**.

После выполнения этих действий вызовы, выполненные в базовых основных средствах, включают `--csx` параметр, который создает и публикует файлы проекта скрипта C# (. CSX). Если указан этот язык по умолчанию, все проекты, созданные по умолчанию, будут создаваться в проектах скриптов C#. При установке значения по умолчанию не будет предложено выбрать язык проекта. Чтобы создать проекты на других языках, необходимо изменить этот параметр или удалить его из settings.jsпользователя в файле. После удаления этого параметра появится запрос на выбор языка при создании проекта.

## <a name="command-palette-reference"></a>Справочник по палитре команд

Расширение "функции Azure" предоставляет полезный графический интерфейс в области для взаимодействия с приложениями-функциями в Azure. Те же функциональные возможности доступны и в виде команд в палитре команд (F1). Доступны следующие команды функций Azure:

|Команда "функции Azure"  | Описание  |
|---------|---------|
|**Добавить новые параметры**  |  Создает новый параметр приложения в Azure. Дополнительные сведения см. в разделе [Публикация параметров приложения](#publish-application-settings). Также может потребоваться [скачать этот параметр в локальные параметры](#download-settings-from-azure). |
| **Настройка источника развертывания** | Подключает приложение-функцию в Azure к локальному репозиторию Git. Дополнительные сведения см. в статье [непрерывное развертывание для функций Azure](functions-continuous-deployment.md). |
| **Подключение к репозиторию GitHub** | Подключает приложение-функцию к репозиторию GitHub. |
| **Копировать URL-адрес функции** | Возвращает удаленный URL-адрес функции, активируемой по HTTP, которая выполняется в Azure. Дополнительные сведения см. в разделе [Получение URL-адреса развернутой функции](#get-the-url-of-the-deployed-function). |
| **Создание приложения функции в Azure** | Создает новое приложение-функцию в подписке в Azure. Дополнительные сведения см. в разделе о [публикации в новом приложении-функции в Azure](#publish-to-azure).        |
| **Параметры расшифровки** | Расшифровывает [локальные параметры](#local-settings-file) , которые были зашифрованы с помощью **функций Azure: шифрование параметров**.  |
| **Удалить приложение-функция** | Удаляет приложение-функцию из подписки в Azure. Если в плане службы приложений нет других приложений, вы можете также удалить его. Другие ресурсы, например учетные записи хранения и группы ресурсов, не удаляются. Чтобы удалить все ресурсы, необходимо [Удалить группу ресурсов](functions-add-output-binding-storage-queue-vs-code.md#clean-up-resources). Ваш локальный проект не затрагивается. |
|**Удалить функцию**  | Удаляет существующую функцию из приложения-функции в Azure. Поскольку это удаление не влияет на локальный проект, вместо этого рекомендуется удалить функцию локально, а затем [повторно опубликовать проект](#republish-project-files). |
| **Удаление прокси-сервера** | Удаляет прокси-сервер функций Azure из приложения функции в Azure. Дополнительные сведения об учетных записях-посредниках см. в разделе [Работа с прокси-серверы функций Azure](functions-proxies.md). |
| **Удалить параметр** | Удаляет параметр приложения-функции в Azure. Это удаление не влияет на параметры в local.settings.jsфайла. |
| **Отключиться от репозитория**  | Удаляет подключение [непрерывного развертывания](functions-continuous-deployment.md) между приложением-функцией в Azure и репозиторием системы управления версиями. |
| **Скачать удаленные параметры** | Скачивание параметров из выбранного приложения функции в Azure в local.settings.jsв файле. Если локальный файл зашифрован, он расшифровывается, обновляется и шифруется снова. Если имеются параметры, имеющие конфликтующие значения в двух расположениях, вам будет предложено выбрать способ продолжения. Не забудьте сохранить изменения в local.settings.jsв файле перед выполнением этой команды. |
| **Изменить параметры** | Изменяет значение существующего параметра приложения функции в Azure. Эта команда не влияет на параметры в local.settings.jsфайла.  |
| **Параметры шифрования** | Шифрует отдельные элементы в `Values` массиве в [локальных параметрах](#local-settings-file). В этом файле `IsEncrypted` также имеет значение `true` , которое указывает, что локальная среда выполнения будет расшифровывать параметры перед их использованием. Зашифруйте локальные параметры, чтобы снизить риск утечки ценных сведений. В Azure параметры приложения всегда хранятся в зашифрованном виде. |
| **Выполнить функцию сейчас** | Запуск функции вручную с помощью API администратора. Эта команда используется для тестирования как локально во время отладки, так и для функций, выполняемых в Azure. При активации функции в Azure расширение сначала автоматически получает ключ администратора, который используется для вызова интерфейсов API удаленного администрирования, которые запускают функции в Azure. Текст сообщения, отправляемого в API, зависит от типа триггера. Триггеры таймера не нуждаются в передаче данных. |
| **Инициализация проекта для использования с VS Code** | Добавляет необходимые файлы проекта Visual Studio Code в существующий проект функций. Используйте эту команду для работы с проектом, созданным с помощью основных средств. |
| **Установка или обновление Azure Functions Core Tools** | Устанавливает или обновляет [Azure functions Core Tools], который используется для локального запуска функций. |
| **Повторное развертывание**  | Позволяет повторно развертывать файлы проекта из подключенного репозитория Git в определенное развертывание в Azure. Чтобы повторно опубликовать локальные обновления из Visual Studio Code, [повторно опубликуйте проект](#republish-project-files). |
| **Переименование параметров** | Изменяет имя ключа существующего параметра приложения функции в Azure. Эта команда не влияет на параметры в local.settings.jsфайла. После переименования параметров в Azure необходимо [скачать эти изменения в локальный проект](#download-settings-from-azure). |
| **Перезапуск** | Перезапускает приложение функции в Azure. При развертывании обновлений также перезапускается приложение функции. |
| **Задать AzureWebJobsStorage**| Задает значение `AzureWebJobsStorage` параметра приложения. Этот параметр требуется для функций Azure. Он задается при создании приложения-функции в Azure. |
| **Запуск** | Запускает остановленное приложение-функцию в Azure. |
| **Запуск потоковой передачи журналов** | Запускает журналы потоковой передачи для приложения функции в Azure. Используйте журналы потоковой передачи при удаленном устранении неполадок в Azure, если необходимо просмотреть данные журнала практически в реальном времени. Дополнительные сведения см. в разделе [Streaming Logs](#streaming-logs). |
| **Остановить** | Останавливает приложение-функцию, выполняющееся в Azure. |
| **Останавливает потоковую передачу журналов** | Останавливает журналы потоковой передачи для приложения функции в Azure. |
| **Переключить в качестве параметра слота** | Если этот параметр включен, обеспечивает сохранение параметров приложения для заданного слота развертывания. |
| **Azure Functions Core Tools удаления** | Удаляет Azure Functions Core Tools, необходимый для расширения. |
| **Отправка локальных параметров** | Отправляет параметры из local.settings.jsв файл в выбранное приложение функции в Azure. Если локальный файл зашифрован, он расшифровывается, перегружается и шифруется снова. Если имеются параметры, имеющие конфликтующие значения в двух расположениях, вам будет предложено выбрать способ продолжения. Не забудьте сохранить изменения в local.settings.jsв файле перед выполнением этой команды. |
| **Просмотр фиксации в GitHub** | Показывает последнюю фиксацию в определенном развертывании, когда приложение-функция подключено к репозиторию. |
| **Просмотр журналов развертывания** | Показывает журналы для конкретного развертывания в приложении-функции в Azure. |

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о Azure Functions Core Tools см. в разделе [Работа с Azure functions Core Tools](functions-run-local.md).

Дополнительные сведения о разработке функций, таких как библиотеки класса .NET, см. в статье [Справочник разработчика C# по функциям Azure](functions-dotnet-class-library.md). В этой статье также приведены ссылки на примеры использования атрибутов для объявления различных типов привязок, поддерживаемых функциями Azure.

[Расширение "Функции Azure" для Visual Studio Code]: https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-azurefunctions
[Azure Functions Core Tools]: functions-run-local.md