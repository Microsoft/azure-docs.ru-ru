---
title: Администрирование кэша Redis для Azure
description: Узнайте, как выполнять задачи администрирования, такие как перезагрузка и планирование обновлений кэша Redis для Azure.
author: yegu-ms
ms.service: cache
ms.topic: conceptual
ms.date: 07/05/2017
ms.author: yegu
ms.openlocfilehash: 0a79b0b5b5f21d1c75fec6b062f1ca91cfe9dd1f
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102219205"
---
# <a name="how-to-administer-azure-cache-for-redis"></a>Администрирование кэша Redis для Azure
В этом разделе описывается выполнение задач администрирования, таких как [перезагрузка](#reboot) и [планирование обновлений](#schedule-updates) для экземпляров кэша Redis для Azure.

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

## <a name="reboot"></a>Перезагрузка
Колонка **Перезагрузка** позволяет перезагрузить один или несколько узлов кэша. Функция перезагрузки дает возможность протестировать приложение на устойчивость в случае сбоя узла кэша.

![Снимок экрана, посвященный параметру меню "перезагрузить".](./media/cache-administration/redis-cache-administration-reboot.png)

Выберите узлы, которые нужно перезагрузить, и щелкните **Перезагрузить**.

![Снимок экрана, на котором показаны узлы, которые можно перезагрузить.](./media/cache-administration/redis-cache-reboot.png)

Если у вас кэш уровня "Премиум" с включенной кластеризацией, то вы можете выбрать сегменты кэша для перезагрузки.

![Перезагрузка](./media/cache-administration/redis-cache-reboot-cluster.png)

Чтобы перезагрузить один или несколько узлов кэша, выберите необходимые узлы и нажмите кнопку **Перезагрузить**. Если у вас кэш уровня "Премиум" с включенной кластеризацией, то выберите сегменты, требующие перезагрузки, и нажмите кнопку **Перезагрузить**. Через несколько минут выбранные узлы перезагружаются, а еще через несколько минут — возобновляют работу.

Воздействие на клиентские приложения зависит от того, какие узлы перезагружаются.

* **Главный** . при перезагрузке основного узла кэш Azure для Redis отключается на узел реплики и переводит его на основной сервер. Во время этой отработки отказа может возникать короткий интервал, когда попытки подключения к кэшу заканчиваются сбоем.
* **Реплика** . при перезагрузке узла реплики обычно не влияет на кэширование клиентов.
* **Первичная и реплика** . при перезагрузке обоих узлов кэша все данные теряются в кэше, а подключения к кэшу будут завершаться сбоем, пока основной узел не вернется в режим «в сети». Если вы настроили [сохраняемость данных](cache-how-to-premium-persistence.md), то последняя резервная копия восстанавливается, когда кэш снова становится доступным. Но все записи в кэше, выполненные после последней архивации, будут утеряны.
* **Узлы кэша уровня "Премиум" с включенной кластеризацией.** При перезагрузке одного или нескольких узлов кэша уровня "Премиум" с включенной кластеризацией процедура восстановления выбранных узлов такая же, как при перезагрузке соответствующих узлов некластеризованного кэша.

## <a name="reboot-faq"></a>Часто задаваемые вопросы о перезагрузке
* [Какой узел следует перезагрузить, чтобы протестировать приложение?](#which-node-should-i-reboot-to-test-my-application)
* [Можно ли перезагрузить кэш, чтобы очистить подключения клиентов?](#can-i-reboot-the-cache-to-clear-client-connections)
* [Сохранятся ли данные кэша после перезагрузки?](#will-i-lose-data-from-my-cache-if-i-do-a-reboot)
* [Можно ли перезагрузить кэш с помощью PowerShell, интерфейса командной строки или других средств управления?](#can-i-reboot-my-cache-using-powershell-cli-or-other-management-tools)

### <a name="which-node-should-i-reboot-to-test-my-application"></a>Какой узел следует перезагрузить, чтобы протестировать приложение?
Чтобы протестировать приложение на устойчивость в случае сбоя основного узла кэша, перезагрузите **главный** узел. Чтобы проверить устойчивость приложения к сбою узла реплики, перезагрузите узел **реплики** . Чтобы протестировать приложение на устойчивость в случае общего сбоя кэша, перезагрузите **оба** узла.

### <a name="can-i-reboot-the-cache-to-clear-client-connections"></a>Можно ли перезагрузить кэш, чтобы очистить подключения клиентов?
Да, при перезагрузке кэша все клиентские подключения очищаются. Перезагрузка может оказаться полезной, когда все подключения клиентов уже использованы из-за логической ошибки или ошибки в клиентском приложении. В каждой ценовой категории существуют [ограничения на подключение клиентов](cache-configure.md#default-redis-server-configuration) для различных размеров, и когда эти ограничения достигаются, последующие подключения не принимаются. Перезагрузка кэша позволяет очистить все подключения клиентов.

> [!IMPORTANT]
> Если перезагрузить кэш, чтобы очистить подключения клиентов, то StackExchange.Redis переподключается автоматически, когда узел Redis снова становится доступным. Если основную проблему не устранить, то подключения клиентов по-прежнему могут отсутствовать.
> 
> 



### <a name="will-i-lose-data-from-my-cache-if-i-do-a-reboot"></a>Сохранятся ли данные кэша после перезагрузки?
Если вы перезагрузите **главный** узел и узлы **реплики** , все данные в кэше (или в этом сегменте, если используется кэш уровня "Премиум" с включенной кластеризацией) могут быть потеряны, но это не гарантируется. Если вы настроили [сохраняемость данных](cache-how-to-premium-persistence.md), то последняя резервная копия будет восстановлена, когда кэш снова станет доступным. Но все записи в кэше, выполненные после архивации, будут утеряны.

Если перезагрузить только один из узлов, то, как правило, данные не теряются, но это все же может произойти. Например, если основной узел перезагружается и выполняется запись в кэш, данные из записи кэша теряются. Данные также могут быть утеряны, если вы перезагрузите один узел, а другой узел случайно выйдет из строя в то же время. Дополнительные сведения о возможных причинах потери данных см. в статье [What happened to my data in Redis?](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md) (Что произошло с моими данными в Redis?).

### <a name="can-i-reboot-my-cache-using-powershell-cli-or-other-management-tools"></a>Можно ли перезагрузить кэш с помощью PowerShell, интерфейса командной строки или других средств управления?
Да, инструкции по использованию PowerShell см. в разделе, посвященном [перезагрузке кэша Redis для Azure](cache-how-to-manage-redis-cache-powershell.md#to-reboot-an-azure-cache-for-redis).

## <a name="schedule-updates"></a>Планирование обновлений
Колонка **обновления в расписании** позволяет указать период обслуживания для экземпляра кэша. Период обслуживания позволяет управлять днями и временем недели, в течение которых можно обновлять виртуальные машины, на которых размещается кэш. Кэш Azure для Redis будет оптимальным решением для запуска и завершения обновления программного обеспечения Redis Server в течение заданного временного окна.

> [!NOTE] 
> Период обслуживания применяется к обновлениям сервера Redis и обновлениям операционной системы виртуальных машин, на которых размещается кэш. Период обслуживания не применяется к обновлениям ОС узла на узлах, на которых размещены виртуальные машины кэша или другие сетевые компоненты Azure. В редких случаях, когда кэши размещаются в старых моделях (можно определить, находится ли кэш в более старой модели, если DNS-имя кэша разрешается в суффикс «cloudapp.net», «chinacloudapp.cn», «usgovcloudapi.net» или «cloudapi.de»), период обслуживания не будет применяться к обновлениям гостевой ОС.
>


![Планирование обновлений](./media/cache-administration/redis-schedule-updates.png)

Чтобы задать период обслуживания, отметьте необходимые дни и укажите, когда будет начинаться период обслуживания в каждый из дней, а затем нажмите кнопку **ОК**. Обратите внимание, что время периода обслуживания указывается в формате UTC. 

Минимальный период обслуживания по умолчанию для обновлений — пять часов. Это значение нельзя настроить на портале Azure, но вы можете сделать это в PowerShell с помощью параметра `MaintenanceWindow` командлета [New-AzRedisCacheScheduleEntry](/powershell/module/az.rediscache/new-azrediscachescheduleentry). Дополнительные сведения см. в разделе "Можно ли управлять запланированными обновлениями с помощью PowerShell, интерфейса командной строки или других инструментов управления?"

## <a name="schedule-updates-faq"></a>Часто задаваемые вопросы о планировании обновлений
* [Когда происходят обновления, если функция планирования обновлений не используется?](#when-do-updates-occur-if-i-dont-use-the-schedule-updates-feature)
* [Какие типы обновлений выполняются в запланированный период обслуживания?](#what-type-of-updates-are-made-during-the-scheduled-maintenance-window)
* [Можно ли управлять запланированными обновлениями с помощью PowerShell, интерфейса командной строки или других средств управления?](#can-i-managed-scheduled-updates-using-powershell-cli-or-other-management-tools)

### <a name="when-do-updates-occur-if-i-dont-use-the-schedule-updates-feature"></a>Когда происходят обновления, если функция планирования обновлений не используется?
Если период обслуживания не указан, то обновления могут выполняться в любое время.

### <a name="what-type-of-updates-are-made-during-the-scheduled-maintenance-window"></a>Какие типы обновлений выполняются в запланированный период обслуживания?
В запланированный период обслуживания выполняются только обновления сервера Redis. Этот период обслуживания не распространяется на обновления Azure или обновления операционной системы виртуальной машины.

### <a name="can-i-managed-scheduled-updates-using-powershell-cli-or-other-management-tools"></a>Можно ли управлять запланированными обновлениями с помощью PowerShell, интерфейса командной строки или других средств управления?
Да, управлять запланированными обновлениями можно с помощью следующих командлетов PowerShell:

* [Get-AzRedisCachePatchSchedule](/powershell/module/az.rediscache/get-azrediscachepatchschedule);
* [New-AzRedisCachePatchSchedule](/powershell/module/az.rediscache/new-azrediscachepatchschedule);
* [New-AzRedisCacheScheduleEntry](/powershell/module/az.rediscache/new-azrediscachescheduleentry);
* [Remove-AzRedisCachePatchSchedule](/powershell/module/az.rediscache/remove-azrediscachepatchschedule).

## <a name="next-steps"></a>Следующие шаги
Дополнительные сведения о кэше Azure для функций Redis.

* [Кэш Azure для уровней служб Redis](cache-overview.md#service-tiers)

