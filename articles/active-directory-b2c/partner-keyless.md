---
title: Руководство по настройке без ключей для Azure Active Directory B2C
titleSuffix: Azure AD B2C
description: Руководство по настройке незащищенного ключей с помощью Azure Active Directory B2C для проверки подлинности без пароля
services: active-directory-b2c
author: gargi-sinha
manager: martinco
ms.service: active-directory
ms.workload: identity
ms.topic: how-to
ms.date: 1/17/2021
ms.author: gasinh
ms.subservice: B2C
ms.openlocfilehash: 7e6f19e03eee6fb6ddf946ea79d197a231f5f113
ms.sourcegitcommit: b39cf769ce8e2eb7ea74cfdac6759a17a048b331
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2021
ms.locfileid: "98690634"
---
# <a name="tutorial-for-configuring-keyless-with-azure-active-directory-b2c"></a>Руководство по настройке без ключей для Azure Active Directory B2C

В этом примере учебника мы предоставляем рекомендации по настройке Azure Active Directory (AD) [B2C с](https://keyless.io/)неограниченным доступом. Используя Azure AD B2C в качестве поставщика удостоверений, вы можете интегрировать беспроблемное взаимодействие с любыми клиентскими приложениями, чтобы предоставить пользователям полноценную проверку подлинности без пароля.

Решение незащищенного обращения без поддержки **Zero-Knowledge биометрической метрики (зкб™)** обеспечивает многофакторную проверку подлинности без пароля, что позволяет избежать мошенничества, фишинга и повторного использования учетных данных — все это повышает удобство работы клиентов и защищает конфиденциальность.

## <a name="pre-requisites"></a>Предварительные требования

Чтобы приступить к работе, вам потребуется:

- Подписка Azure. Если у вас нет подписки, вы можете получить [бесплатную учетную запись](https://azure.microsoft.com/free/).

- [Клиент Azure AD B2C](https://docs.microsoft.com/azure/active-directory-b2c/tutorial-create-tenant). Клиент должен быть связан с подпиской Azure.

- Недоступный облачный клиент, получите бесплатную [пробную учетную запись](https://keyless.io/go).

- Неиспользуемое приложение для проверки подлинности, установленное на устройстве пользователя.

## <a name="scenario-description"></a>Описание сценария

Интеграция без ключей включает следующие компоненты:

- Azure AD B2C — сервер авторизации, отвечающий за проверку учетных данных пользователя, также известный как поставщик удостоверений.

- Веб-и мобильные приложения — ваши мобильные или веб-приложения, которые вы выбираете для защиты с помощью незащищенных и Azure AD B2C.

- Мобильное приложение без ключей — мобильное приложение без поддержки будет использоваться для проверки подлинности в приложениях с поддержкой Azure AD B2C.

Реализация показана на следующей схеме архитектуры.

![На рисунке показана схема архитектуры без ключей](./media/partner-keyless/keyless-architecture-diagram.png)

|Шаг | Описание |
|:-----| :-----------|
| 1. | Пользователь прибывает на странице входа. Пользователи выбирают вход и регистрацию и вводят имя пользователя.
| 2. | Приложение отправляет атрибуты пользователя Azure AD B2C для проверки удостоверения.
| 3. | Azure AD B2C собирает атрибуты пользователя и отправляет атрибуты в без ключей для проверки подлинности пользователя с помощью мобильного приложения без ключей.
| 4. | Без ключей отправляет push-уведомление на мобильное устройство зарегистрированного пользователя для обеспечения конфиденциальности с сохранением проверки подлинности в форме биометрического сканирования лиц.
| 5. | После того как пользователь ответит на push-уведомление, ему предоставляется или запрещается доступ к приложению клиента на основе результатов проверки.

## <a name="integrate-with-azure-ad-b2c"></a>Интеграция с Azure AD B2C

### <a name="add-a-new-identity-provider"></a>Добавление нового поставщика удостоверений

Чтобы добавить нового поставщика удостоверений, выполните следующие действия.

1. Войдите в **[портал Azure](https://portal.azure.com/#home)** как глобальный администратор клиента Azure AD B2C.

2. Убедитесь, что вы используете каталог, содержащий клиент Azure AD B2C, выбрав в верхнем меню фильтр **каталог и подписка** и выбрав Каталог, содержащий ваш клиент.

3. Выберите **Все службы** в левом верхнем углу окна портала Azure, найдите службу **Azure AD B2C** и выберите ее.

4. Перейдите к **панели мониторинга**  >  **Azure Active Directory B2C**  >   **поставщики удостоверений** .

5. Выберите **поставщики удостоверений**.

6. Выберите **Добавить**.

### <a name="configure-an-identity-provider"></a>Настройка поставщика удостоверений

Чтобы настроить поставщик удостоверений, выполните следующие действия.

1. Выбор **типа поставщика удостоверений**  >  **OpenID Connect подключение (Предварительная версия)**
2. Заполните форму, чтобы настроить поставщик удостоверений:

   |Свойство | Значение |
   |:-----| :-----------|
   | Имя   | Ассоциаци |
   | URL-адрес метаданных | Вставьте URI размещенного приложения проверки подлинности с независимым именем, за которым следует конкретный путь, например https://keyless.auth/.well-known/openid-configuration |
   | Секрет клиента | Секрет, связанный с незащищенным экземпляром проверки подлинности, не совпадает с тем, который был настроен ранее. Вставьте выбранную сложную строку. Этот секрет будет использоваться позже в конфигурации контейнера без ключей.|
   | Идентификатор клиента | Идентификатор клиента. Этот идентификатор будет использоваться позже в конфигурации контейнера без ключей.|
   | Область | OpenId |
   | Тип ответа | id_token |
   | Режим ответа | form_post|

3. Щелкните **ОК**.

4. Установите флажок **сопоставлять утверждения поставщика удостоверений**.

5. Заполните форму для отображения поставщика удостоверений:

   |Свойство | Значение |
   |:-----| :-----------|
   | UserID    | Из подписки |
   | Отображаемое имя | Из подписки |
   | Режим ответа | Из подписки |

6. Нажмите кнопку **сохранить** , чтобы завершить настройку нового поставщика удостоверений Open ID Connect (OIDC).

### <a name="create-a-user-flow-policy"></a>Создание политики потока пользователя

Теперь вы должны увидеть параметр без ключей в качестве нового поставщика удостоверений OIDC, указанного в поставщиках удостоверений B2C.

1. В клиенте Azure AD B2C в разделе **политики** выберите **потоки пользователей**.

2. Выберите **Новый** поток пользователей.

3. Выберите **Регистрация и вход**, выберите **версию** и нажмите кнопку **создать**.

4. Введите **имя** политики.

5. В разделе Поставщики удостоверений выберите только что созданный поставщик удостоверений без ключей.

6. Настройте параметры потока пользователя. Вставьте имя и выберите созданный поставщик удостоверений. Также можно добавить адрес электронной почты. В этом случае Azure не будет перенаправлять процедуру входа непосредственно в неограниченный режим, а будет показывать экран, где пользователь может выбрать вариант для использования.

7. Оставьте поле **многофакторная идентификация** без изменений.

8. Выберите **принудительное применение политик условного доступа**

9. В разделе **атрибуты пользователей и утверждения маркеров** выберите **адрес электронной почты** в параметре получить атрибут. Вы можете добавить все атрибуты, которые Azure Active Directory могут получать сведения о пользователе, рядом с утверждениями, которые Azure AD B2C могут возвращаться в клиентское приложение.

10. Нажмите кнопку **создания**.

11. После успешного создания выберите новый **поток пользователя**.

12. На панели слева выберите **утверждения приложения**. В разделе Параметры установите флажок **Электронная почта** и нажмите кнопку **сохранить**.

## <a name="test-the-user-flow"></a>Тестирование потока пользователя

1. Откройте клиент Azure AD B2C и в разделе политики выберите инфраструктура процедур идентификации.

2. Выберите ранее созданный Сигнупсигнин.

3. Выберите запустить поток пользователя и выберите параметры:

   а. Приложение: выберите зарегистрированное приложение (пример — JWT)

   b. URL-адрес ответа: выберите URL-адрес перенаправления

   c. Выберите Выполнить поток пользователя.

4. Последовательно выберите процесс регистрации и создайте учетную запись.

5. Метод без ключей будет вызываться во время потока, после создания пользовательского атрибута. Если поток неполон, убедитесь, что пользователь не сохранен в каталоге.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения см. в следующих статьях:

- [Пользовательские политики в Azure AD B2C](https://docs.microsoft.com/azure/active-directory-b2c/custom-policy-overview)

- [Приступая к работе с пользовательскими политиками в Azure AD B2C](https://docs.microsoft.com/azure/active-directory-b2c/custom-policy-get-started?tabs=applications)