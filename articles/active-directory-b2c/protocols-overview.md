---
title: Протоколы аутентификации в Azure Active Directory B2C | Документация Майкрософт
description: Узнайте, как создавать приложения непосредственно с использованием протоколов, поддерживаемых Azure Active Directory B2C.
services: active-directory-b2c
author: msmimart
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 11/30/2018
ms.author: mimart
ms.subservice: B2C
ms.openlocfilehash: ed393f721d4461ebadea41f8dad707d4881865cd
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "78183911"
---
# <a name="azure-ad-b2c-authentication-protocols"></a>Azure AD B2C: протоколы проверки подлинности
Azure Active Directory B2C (Azure AD B2C) предоставляет приложениям "идентификацию как услугу" благодаря поддержке двух стандартных отраслевых протоколов: OpenID Connect и OAuth 2.0. Хотя эта служба соответствует стандартам, любые две реализации этих протоколов могут иметь небольшие различия.

Сведения в этом руководстве помогут вам, если вы планируете не использовать одну из наших библиотек с открытым исходным кодом, а писать код с отправкой и обработкой HTTP-запросов напрямую. Мы рекомендуем ознакомиться с этим руководством, прежде чем углубляться в детали каждого конкретного протокола. Но если вы уже знакомы с Azure AD B2C, вы можете сразу перейти к [справочным руководствам по протоколам](#protocols).

<!-- TODO: Need link to libraries above -->

## <a name="the-basics"></a>Основные сведения
Каждое приложение, которое использует Azure AD B2C, необходимо зарегистрировать в каталоге B2C на [портале Azure](https://portal.azure.com). В процессе регистрации приложения будут установлены несколько параметров приложения:

* **Идентификатор приложения** , уникально определяющий ваше приложение.
* **Универсальный код ресурса (URI) перенаправления** или **идентификатор пакета** , который можно использовать для направления ответов обратно в приложение.
* Несколько других зависящих от сценария значений. Дополнительные сведения см. в статье [Azure Active Directory B2C: регистрация приложения](tutorial-register-applications.md).

После регистрации приложение взаимодействует с Azure Active Directory (Azure AD), отправляя запросы к конечной точке:

```
https://{tenant}.b2clogin.com/{tenant}.onmicrosoft.com/oauth2/v2.0/authorize
https://{tenant}.b2clogin.com/{tenant}.onmicrosoft.com/oauth2/v2.0/token
```

Почти во всех потоках обмена данными в OAuth и OpenID Connect участвуют четыре стороны:

![Схема, показывающая четыре роли OAuth 2,0](./media/protocols-overview/protocols_roles.png)

* **Сервер авторизации** — это конечная точка Azure AD. Сервер авторизации безопасно обрабатывает все данные, касающиеся сведений о пользователе и доступе. Он также обрабатывает отношения доверия между сторонами потока. Он отвечает за проверку удостоверения пользователя, предоставление и блокировку доступа к ресурсам, а также выпуск маркеров. Он также называется поставщиком удостоверений.

* **Владельцем ресурса** обычно является конечный пользователь. Это сторона, владеющая данными, которая может предоставлять третьим сторонам доступ к этим данным или к ресурсу.

* **Клиент OAuth** — это ваше приложение. Оно определяется идентификатором приложения. Обычно это сторона, с которой взаимодействуют пользователи. Клиент OAuth также запрашивает маркеры у сервера авторизации. Владелец ресурса должен предоставить клиенту разрешение на доступ к ресурсу.

* **Сервер ресурсов** — это место, где находится ресурс или данные. Он доверяет серверу авторизации безопасную проверку подлинности и авторизацию клиента OAuth. Он также использует токены доступа носителя для предоставления доступа к ресурсу.

## <a name="policies-and-user-flows"></a>Политики и потоки пользователей
Политики Azure AD B2C, возможно, являются наиболее важной функцией службы. Azure AD B2C расширяет стандартные протоколы OAuth 2.0 и OpenID Connect путем введения политик. Они позволяют Azure AD B2C выполнять множество других операций кроме простой проверки подлинности и авторизации.

Чтобы вам было проще настроить наиболее распространенные задачи идентификации, на портале Azure AD B2C реализованы предопределенные настраиваемые политики, которые называются **потоками пользователей**. В потоках пользователей полностью описан процесс идентификации пользователя, включая регистрацию, вход и изменение профиля. Потоки пользователей можно задавать в административном интерфейсе пользователя. Их можно выполнять с помощью специального параметра запроса в HTTP-запросах проверки подлинности.

Политики и потоки пользователей не являются стандартными компонентами OAuth 2.0 и OpenID Connect. Поэтому нужно уделить некоторое время их изучению. Дополнительные сведения см. в [справочнике по потокам пользователей Azure AD B2C](user-flow-overview.md).

## <a name="tokens"></a>Токены
В реализации OAuth 0.2 и OpenID Connect в Azure AD B2C широко используются токены носителя, включая токены носителя в виде веб-токенов JSON (JWT). Токен носителя — это упрощенный маркер безопасности, предоставляющий его носителю доступ к защищенному ресурсу.

В этом смысле носителем является любая сторона, которая может предъявить маркер. Перед получением токена носителя сторона должна пройти проверку подлинности в Azure AD. Однако если не выполняются действия, необходимые для защиты маркера во время его передачи и хранения, то его может перехватить и использовать несанкционированная сторона.

У некоторых маркеров безопасности есть встроенный механизм, который предотвращает их использование несанкционированными сторонами, но токены носителя не имеют такого механизма. Они должны передаваться по защищенному каналу, например по протоколу TLS (HTTPS).

Если токен носителя передается вне зашифрованного канала, злоумышленник может использовать атаку "злоумышленник в середине", чтобы получить токен и использовать его для несанкционированного доступа к защищенному ресурсу. Те же принципы безопасности применяются при сохранении или кэшировании токенов носителя для последующего использования. Необходимо всегда проверять, что приложение передает и сохраняет токены носителя безопасным образом.

Дополнительные сведения о безопасности при применении токенов носителя см. в [этом документе (раздел 5)](https://tools.ietf.org/html/rfc6750).

Дополнительные сведения о различных типах маркеров, используемых в Azure AD B2C, см. в [справочнике по маркерам Azure AD](tokens-overview.md).

## <a name="protocols"></a>Протоколы
Если вы хотите ознакомиться с некоторыми примерами запросов, можете начать с одного из следующих учебников. Каждый из них соответствует определенному сценарию проверки подлинности. Сведения о том, как выбрать правильный поток, см. в статье о [типах приложений, которые можно создать с помощью Azure AD B2C](application-types.md).

* [Создание мобильного и собственного приложения с использованием OAuth 2.0](authorization-code-flow.md)
* [Построение веб-приложений с помощью OpenID Connect](openid-connect.md)
* [Создание одностраничных приложений с использованием неявного потока OAuth 2.0](implicit-flow-single-page-application.md)

