---
title: Включение фильтрации по возрасту в Azure Active Directory B2C | Документация Майкрософт
description: Сведения о том, как определять несовершеннолетних пользователей вашего приложения.
services: active-directory-b2c
author: msmimart
manager: celestedg
ms.service: active-directory
ms.workload: identity
ms.topic: how-to
ms.date: 03/09/2021
ms.author: mimart
ms.subservice: B2C
zone_pivot_groups: b2c-policy-type
ms.openlocfilehash: 71a3b38da6a63824a42f64052bf16a5fe0e25483
ms.sourcegitcommit: 956dec4650e551bdede45d96507c95ecd7a01ec9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "102522465"
---
# <a name="enable-age-gating-in-azure-active-directory-b2c"></a>Включение фильтрации по возрасту в Azure Active Directory B2C

[!INCLUDE [active-directory-b2c-choose-user-flow-or-custom-policy](../../includes/active-directory-b2c-choose-user-flow-or-custom-policy.md)]

Ограничение возраста в Azure Active Directory B2C (Azure AD B2C) позволяет выдать дополнительные компоненты, которые хотят использовать ваше приложение, с согласия родителей или без него. Вы можете заблокировать незначительное время входа в приложение. Или разрешить использование для завершения входа и предоставить приложению незначительное состояние. 

>[!IMPORTANT]
>Эта функция предоставляется в общедоступной предварительной версии. Не используйте эту функцию для рабочих приложений.
>

Если для потока пользователя включена ограничение возраста, пользователи запросят дату рождения и страну проживания. Пользователь, который еще не вводил эту информацию, должен будет ввести ее для следующего входа. Правила применяются при каждом входе пользователя.

![Снимок экрана: поток сбора сведений о сроке хранения](./media/age-gating/age-gating-information-gathering.png)

Azure AD B2C использует введенные сведения, чтобы определить, является ли пользователь несовершеннолетним. Затем в учетной записи обновляется поле **ageGroup**. Возможны следующие значения: `null`, `Undefined`, `Minor`, `Adult` или `NotAdult`.  На основе значений **ageGroup** и **consentProvidedForMinor** вычисляется значение для поля **legalAgeGroupClassification**.


## <a name="prerequisites"></a>Предварительные условия

[!INCLUDE [active-directory-b2c-customization-prerequisites](../../includes/active-directory-b2c-customization-prerequisites.md)]

## <a name="set-up-your-tenant-for-age-gating"></a>Настройка проверки возраста в клиенте

Чтобы использовать ограничение возраста в потоке пользователя, необходимо настроить клиент так, чтобы он имел дополнительные свойства.

1. Убедитесь, что вы используете каталог, содержащий клиент Azure AD B2C, выбрав фильтр " **каталог и подписка** " в верхнем меню. Выберите каталог, содержащий ваш клиент.
1. Выберите **Все службы** в левом верхнем углу портала Azure, найдите службу **Azure AD B2C** и выберите ее.
1. Выберите **Properties** (Свойства) для клиента в меню слева.
1. В области **возраст** выберите **настроить**.
1. После завершения операции в клиенте будет включена фильтрация по возрасту.

::: zone pivot="b2c-user-flow"

## <a name="enable-age-gating-in-your-user-flow"></a>Включение фильтрации по возрасту в потоке пользователя

Настроив в клиенте фильтрацию по возрасту, вы сможете применять эту функцию в тех [потоках пользователей](user-flow-versions.md), где она включена. Чтобы включить фильтрацию по возрасту, сделайте следующее:

1. Создайте поток пользователя с включенной фильтрацией по возрасту.
1. Создав поток пользователя, выберите в меню пункт **Properties** (Свойства).
1. В разделе **Age gating** (Фильтрация по возрасту) выберите **Enabled** (Включено).
1. Для **регистрации или входа** выберите способ управления пользователями.
    - Разрешите дополнительным приложениям доступ к приложению.
    - Блокировать только небольшие из них, которые имеют разрешение на доступ к приложению.
    - Запрещает доступ к приложению всем дополнительным параметрам.
1. Для параметра **включено** выберите один из следующих параметров.
    - **Отправить JSON обратно в приложение** . Этот параметр отправляет ответ обратно в приложение, которое было заблокировано дополнительным.
    - **Показать страницу ошибки** — пользователю отображается страница с сообщением о том, что им не удается получить доступ к приложению.

## <a name="test-your-user-flow"></a>Тестирование потока пользователя

1. Чтобы проверить политику, выберите пункт **выполнить пользовательскую последовательность**.
1. Для **приложения** выберите веб-приложение с именем *testapp1* , которое вы зарегистрировали ранее. В поле **URL-адрес ответа** должно содержаться значение `https://jwt.ms`.
1. Нажмите кнопку **запустить поток пользователя** .
1. Войдите в локальную или социальную учетную запись. Затем выберите страну проживания и дату рождения, которая имитирует дополнительный. 
1. Повторите тест и выберите дату рождения, которая имитирует взрослый.  

При входе в систему в качестве дополнительной ошибки появится следующее сообщение об ошибке: *увы, вход заблокирован. Конфиденциальность и законы безопасности в вашей стране запрещают доступ к учетным записям, принадлежащим детям.*

::: zone-end

::: zone pivot="b2c-custom-policy"

## <a name="enable-age-gating-in-your-custom-policy"></a>Включить ограничение возраста в пользовательской политике

1. Получите пример политики возраст на сайте [GitHub](https://github.com/azure-ad-b2c/samples/tree/master/age-gating).
1. Замените строку `yourtenant` именем вашего клиента Azure AD B2C в каждом файле. Например, если имя вашего клиента B2C — *contosob2c*, все экземпляры `yourtenant.onmicrosoft.com` должны иметь вид `contosob2c.onmicrosoft.com`.
1. Отправьте файлы политики.

::: zone-end

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте, как [управлять доступом пользователей в Azure AD B2C](manage-user-access.md).

