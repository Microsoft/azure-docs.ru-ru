---
title: Балансировка нагрузки пула узлов виртуальных рабочих столов Windows — Azure
description: Сведения о методах балансировки нагрузки пула узлов для среды виртуальных рабочих столов Windows.
author: Heidilohr
ms.topic: conceptual
ms.date: 10/12/2020
ms.author: helohr
manager: lizross
ms.openlocfilehash: fd8f9e4a3ef63cd97f96af3d4f96a2bb65c3cd09
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "91951865"
---
# <a name="host-pool-load-balancing-methods"></a>Методы балансировки нагрузки пула узлов

>[!IMPORTANT]
>Это содержимое применимо к Виртуальному рабочему столу Windows с объектами Azure Resource Manager для Виртуального рабочего стола Windows. Если вы используете Виртуальный рабочий стол Windows (классический) без объектов Azure Resource Manager, ознакомьтесь с [этой статьей](./virtual-desktop-fall-2019/host-pool-load-balancing-2019.md).

Виртуальный рабочий стол Windows поддерживает два метода балансировки нагрузки. Каждый метод определяет, на каком узле сеансов будет размещаться сеанс пользователя при подключении к ресурсу в пуле узлов.

В виртуальном рабочем столе Windows доступны следующие методы балансировки нагрузки:

- Балансировка нагрузки по горизонтали позволяет равномерно распределять пользовательские сеансы между узлами сеансов в пуле узлов.
- Балансировка нагрузки с глубиной в первую очередь позволяет перегрузить узел сеансов с пользовательскими сеансами в пуле узлов. По достижении порогового значения ограничения сеанса подсистема балансировки нагрузки направляет новые подключения пользователей к следующему узлу сеанса в пуле узлов, пока не достигнет предела и т. д.

Каждый пул узлов может настраивать только один тип балансировки нагрузки. Однако оба метода балансировки нагрузки имеют следующие характеристики, независимо от того, в каком пуле узлов они находятся.

- Если у пользователя уже есть сеанс в пуле узлов и выполняется его повторное подключение к этому сеансу, подсистема балансировки нагрузки будет успешно перенаправлять их на узел сеансов с помощью существующего сеанса. Это поведение применяется, даже если свойство Алловневконнектионс узла сеанса имеет значение false.
- Если у пользователя еще нет сеанса в пуле узлов, подсистема балансировки нагрузки не будет рассматривать узлы сеансов, свойство Алловневконнектионс которых имеет значение false во время балансировки нагрузки.

## <a name="breadth-first-load-balancing-method"></a>Метод балансировки нагрузки по ширине

Метод балансировки нагрузки с балансом по ширине позволяет распределять пользовательские соединения для оптимизации этого сценария. Этот метод идеально подходит для организаций, которые хотят обеспечить оптимальную работу пользователей, подключающихся к среде виртуального рабочего стола в составе пула.

Сначала метод «по ширине» сначала запрашивает узлы сеансов, разрешающие новые соединения. Затем метод выбирает узел сеанса случайным образом из половины набора узлов сеансов с минимальным количеством сеансов. Например, при наличии девяти компьютеров с 11, 12, 13, 14, 15, 16, 17, 18 и 19 сеансами новый создаваемый сеанс не будет автоматически переходить на первый компьютер. Вместо этого он может подключиться к любому из первых пяти компьютеров с наименьшим числом сеансов (11, 12, 13, 14, 15).

## <a name="depth-first-load-balancing-method"></a>Метод балансировки нагрузки с глубиной до первого

Метод балансировки нагрузки с глубиной в первый раз позволяет одновременно загружает один узел сеанса, чтобы оптимизировать его для этого сценария. Этот метод идеально подходит для организаций с учетом затрат, которым требуется более детальный контроль над количеством виртуальных машин, выделенных для пула узлов.

Сначала метод Depth выполняет запрос к узлам сеансов, которые разрешают новые соединения и не проводили превышение максимального числа сеансов. Затем метод выбирает узел сеанса с наибольшим числом сеансов. Если имеется связь, метод выбирает в запросе первый узел сеанса.

>[!IMPORTANT]
>Алгоритм балансировки нагрузки с глубиной первого уровня распределяет сеансы между узлами сеансов на основе максимального ограничения на количество узлов сеансов. Этот параметр является обязательным при использовании алгоритма балансировки нагрузки с глубиной в первую очередь. Для оптимального взаимодействия с пользователем не забудьте изменить параметр максимального количества узлов сеансов на число, которое лучше подходит для вашей среды.