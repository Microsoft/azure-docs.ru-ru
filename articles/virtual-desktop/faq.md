---
title: Вопросы и ответы по виртуальным рабочим столам Windows — Azure
description: Часто задаваемые вопросы и рекомендации по работе с виртуальным рабочим столом Windows.
author: Heidilohr
ms.topic: conceptual
ms.date: 03/09/2021
ms.author: helohr
manager: lizross
ms.openlocfilehash: ffea2d84f1a5149670976beef3b9af847ae31a35
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104582142"
---
# <a name="windows-virtual-desktop-faq"></a>Вопросы и ответы о Виртуальном рабочем столе Windows

В этой статье содержатся ответы на часто задаваемые вопросы и рекомендации по использованию виртуальных рабочих столов Windows.

## <a name="what-are-the-minimum-admin-permissions-i-need-to-manage-objects"></a>Каковы минимальные разрешения администратора, необходимые для управления объектами?

Если требуется создать пулы узлов и другие объекты, необходимо назначить роль участника в подписке или группе ресурсов, с которой вы работаете.

Необходимо назначить роль администратора доступа пользователей в группе приложений, чтобы публиковать группы приложений для пользователей или групп пользователей.

Чтобы запретить администратору управлять сеансами пользователей, например отправлять сообщения пользователям, выписывать пользователей и т. д., можно создавать пользовательские роли. Пример:

```powershell
"actions": [
"Microsoft.Resources/deployments/operations/read",
"Microsoft.Resources/tags/read",
"Microsoft.Authorization/roleAssignments/read",
"Microsoft.DesktopVirtualization/hostpools/sessionhosts/usersessions/*",
"Microsoft.DesktopVirtualization/hostpools/sessionhosts/read",
"Microsoft.DesktopVirtualization/hostpools/sessionhosts/write"
],
"notActions": [],
"dataActions": [],
"notDataActions": []
}
```

## <a name="does-windows-virtual-desktop-support-split-azure-active-directory-models"></a>Поддерживает ли виртуальные рабочие столы Windows разделение моделей Azure Active Directory?

Когда пользователь назначается группе приложений, служба выполняет простое назначение роли Azure. В результате Azure Active Directory пользователя (AD) и Azure AD группы приложений должны находиться в одном расположении. Все объекты службы, такие как пулы узлов, группы приложений и рабочие области, также должны находиться в том же Azure AD, что и пользователь.

Виртуальные машины (VM) можно создавать в разных Azure AD, если вы синхронизируете Active Directory с Azure AD в той же виртуальной сети.

## <a name="what-are-location-restrictions"></a>Что такое ограничения расположения?

Со всеми ресурсами службы связано расположение. Расположение пула узлов определяет, в каком географе хранятся метаданные службы для пула узлов. Группа приложений не может существовать без пула узлов. Если вы добавите приложения в группу приложений RemoteApp, вам также потребуется узел сеанса для определения приложений меню "Пуск". Для любого действия группы приложений также потребуется доступ к связанным данным в пуле узлов. Чтобы убедиться, что данные не передаются между несколькими расположениями, расположение группы приложений должно совпадать с местоположением пула узлов.

Рабочие области также должны находиться в том же расположении, что и их группы приложений. При каждом обновлении рабочей области связанная с ней группа приложений обновляется вместе с ней. Как и в случае с группами приложений, служба требует, чтобы все рабочие области были связаны с группами приложений, созданными в том же расположении.

## <a name="how-do-you-expand-an-objects-properties-in-powershell"></a>Как развернуть свойства объекта в PowerShell?

При запуске командлета PowerShell отображаются только имя и расположение ресурса.

Пример:

```powershell
Get-AzWvdHostPool -Name 0224hp -ResourceGroupName 0224rg

Location Name   Type
-------- ----   ----
westus   0224hp Microsoft.DesktopVirtualization/hostpools
```

Чтобы просмотреть все свойства ресурса, добавьте либо `format-list` или `fl` в конец командлета.

Пример:

```powershell
Get-AzWvdHostPool -Name 0224hp -ResourceGroupName 0224rg |fl
```

Чтобы просмотреть конкретные свойства, добавьте определенные имена свойств после `format-list` или `fl` .

Пример:

```powershell
Get-AzWvdHostPool -Name demohp -ResourceGroupName 0414rg |fl CustomRdpProperty

CustomRdpProperty : audiocapturemode:i:0;audiomode:i:0;drivestoredirect:s:;redirectclipboard:i:1;redirectcomports:i:0;redirectprinters:i:1;redirectsmartcards:i:1;screen modeid:i:2;
```

## <a name="does-windows-virtual-desktop-support-guest-users"></a>Поддерживает ли Windows виртуальные рабочие столы гостевые пользователи?

Виртуальный рабочий стол Windows не поддерживает гостевые учетные записи Azure AD. Например, предположим, что у группы гостевых пользователей Microsoft 365 E3 для каждого пользователя, Windows E3 для каждого пользователя или лицензии WIN VDA в своей компании, но они являются гостевыми пользователями в Azure AD другой компании. Другая компания управляет объектами пользователей гостевых пользователей в Azure AD и Active Directory как локальные учетные записи.

Вы не можете использовать собственные лицензии, чтобы воспользоваться преимуществами третьей стороны. Кроме того, в настоящее время виртуальный рабочий стол Windows не поддерживает учетную запись Майкрософт (MSA).

## <a name="why-dont-i-see-the-client-ip-address-in-the-wvdconnections-table"></a>Почему в таблице Ввдконнектионс не отображается IP-адрес клиента?

В настоящее время у нас нет надежного способа для получения IP-адресов, поэтому мы не включаем это значение в таблицу.

## <a name="how-does-windows-virtual-desktop-handle-backups"></a>Как виртуальный рабочий стол Windows обрабатывает резервные копии?

В Azure существует несколько вариантов обработки резервных копий. Вы можете использовать службу архивации Azure, Site Recovery и моментальные снимки.

## <a name="does-windows-virtual-desktop-support-third-party-collaboration-apps"></a>Поддерживают ли виртуальные рабочие столы Windows сторонние приложения для совместной работы?

В настоящее время виртуальный рабочий стол Windows оптимизирован для рабочих групп. В настоящее время корпорация Майкрософт не поддерживает сторонние приложения для совместной работы, такие как Zoom. Сторонние организации отвечают за предоставление пользователям рекомендаций по совместимости. Виртуальный рабочий стол Windows также не поддерживает Skype для бизнеса.

## <a name="can-i-change-from-pooled-to-personal-host-pools"></a>Можно ли переключиться из пула в пулы личных узлов?

После создания пула узлов изменить его тип невозможно. Однако вы можете переместить все виртуальные машины, которые вы регистрируете в пул узлов, в другой тип пула узлов.

## <a name="whats-the-largest-profile-size-fslogix-can-handle"></a>Каков самый крупный размер профиля, который Фслогикс может справиться?

Ограничения или квоты в Фслогикс зависят от структуры хранилища, используемой для хранения файлов виртуального жесткого диска (X) профиля пользователя.

В следующей таблице приводится пример того, сколько операций ввода-вывода для профиля Фслогикс требуется для поддержки каждого пользователя. Требования могут сильно различаться в зависимости от пользователя, приложений и действий в каждом профиле.

| Ресурс | Требование |
|---|---|
| Устойчивое состояние операций ввода-вывода | 10 |
| Вход и выход в систему операций ввода-вывода | 50 |

Пример в этой таблице относится только к одному пользователю, но его можно использовать для оценки требований к общему числу пользователей в вашей среде. Например, требуется около 1 000 операций ввода-вывода в секунду для 100 пользователей и около 5 000 операций ввода-вывода во время входа и выхода.

## <a name="is-there-a-scale-limit-for-host-pools-created-in-the-azure-portal"></a>Существует ли ограничение масштабирования для пулов узлов, созданных в портал Azure?

Эти факторы могут повлиять на предел масштабирования для пулов узлов:

- Шаблон Azure ограничен 800 объектами. Дополнительные сведения см. в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-resource-manager/management/azure-subscription-service-limits.md#template-limits). Каждая виртуальная машина также создает около шести объектов, что означает, что вы можете создавать около 132 виртуальных машин при каждом запуске шаблона.

- Существуют ограничения на количество ядер, которые можно создать для каждого региона и каждой подписки. Например, при наличии подписки Соглашение Enterprise можно создать 350 ядер. Необходимо разделить 350 на количество ядер на виртуальную машину по умолчанию или собственное ограничение на число ядер, чтобы определить, сколько виртуальных машин можно создать каждый раз при запуске шаблона. Дополнительные сведения см. в статье [ограничения виртуальных машин — Azure Resource Manager](../azure-resource-manager/management/azure-subscription-service-limits.md#virtual-machines-limits---azure-resource-manager).

- Имя префикса виртуальной машины и число виртуальных машин меньше 15 символов. Дополнительные сведения см. в статье [правила именования и ограничения для ресурсов Azure](../azure-resource-manager/management/resource-name-rules.md#microsoftcompute).

## <a name="can-i-manage-windows-virtual-desktop-environments-with-azure-lighthouse"></a>Можно ли управлять средами виртуальных рабочих столов Windows с помощью Azure Лигхсаусе?

Azure Лигхсаусе не полностью поддерживает управление средами виртуальных рабочих столов Windows. Так как Лигхсаусе сейчас не поддерживает управление пользователями клиентского клиента Azure AD, пользователи Лигхсаусе по-прежнему должны входить в Azure AD, который клиенты используют для управления пользователями.

Вы также не можете использовать подписки песочницы CSP в службе виртуальных рабочих столов Windows. Дополнительные сведения см. в статье [Интеграция изолированной учетной записи](/partner-center/develop/set-up-api-access-in-partner-center#integration-sandbox-account).

Наконец, если вы включили поставщик ресурсов из учетной записи владельца CSP, учетные записи клиентов CSP не смогут изменять поставщик ресурсов.

## <a name="how-often-should-i-turn-my-vms-on-to-prevent-registration-issues"></a>Как часто следует включать виртуальные машины для предотвращения проблем с регистрацией?

После регистрации виртуальной машины в пуле узлов в службе виртуальных рабочих столов Windows агент регулярно обновляет токен виртуальной машины всякий раз, когда виртуальная машина активна. Сертификат для маркера регистрации действителен в течение 90 дней. В связи с этим ограничением в 90 дней рекомендуется запускать виртуальные машины каждые 90 дн. При включении виртуальной машины в течение этого времени срок действия маркера регистрации истечет или он станет недействительным. Если вы запустили виртуальную машину через 90 дней и столкнулись с проблемами регистрации, следуйте инструкциям в разделе [руководство по устранению неполадок агента виртуальных рабочих столов Windows](troubleshoot-agent.md#your-issue-isnt-listed-here-or-wasnt-resolved) , чтобы удалить виртуальную машину из пула узлов, переустановить агент и повторно зарегистрировать его в пуле.

## <a name="can-i-set-availability-options-when-creating-host-pools"></a>Можно ли задать параметры доступности при создании пулов узлов?

Да. Пулы узлов виртуальных рабочих столов Windows позволяют выбрать группу доступности или зоны доступности при создании виртуальной машины. Эти варианты доступности совпадают с параметрами, используемыми в Azure COMPUTE. При выборе зоны для виртуальной машины, созданной в пуле узлов, этот параметр автоматически применяется ко всем виртуальным машинам, создаваемым в этой зоне. Если вы предпочитаете распределять виртуальные машины пула узлов по нескольким зонам, необходимо выполнить инструкции из статьи [Добавление виртуальных машин с портал Azure](expand-existing-host-pool.md#add-virtual-machines-with-the-azure-portal) , чтобы вручную выбрать новую зону для каждой СОЗДАВАЕМОЙ виртуальной машины.

## <a name="which-availability-option-is-best-for-me"></a>Какой вариант доступности лучше всего подходит для меня?

Параметр доступности, который следует использовать для виртуальных машин, зависит от расположения образа и его управляемых полей диска. В следующей таблице объясняется отношение каждого параметра с этими переменными, чтобы определить, какой вариант лучше подходит для развертывания. 

| Параметр доступности | Расположение образа | Кнопка "использовать управляемый диск" (переключатель) |
|---|---|---|
| Нет | Коллекции | Отключено по умолчанию со значением "Да" |
| Нет | Хранилище BLOB-объектов | Включено с "No" по умолчанию |
| Зона доступности | Коллекция (параметр хранилища BLOB-объектов отключен) | Отключено по умолчанию со значением "Да" |
| Группа доступности с управляемым номером SKU (управляемый диск) | Коллекции | Отключено по умолчанию со значением "Да" |
| Группа доступности с управляемым номером SKU (управляемый диск) | Хранилище BLOB-объектов | Включено с "No" по умолчанию |
| Группа доступности с управляемым номером SKU (управляемый диск) | Хранилище BLOB-объектов (параметр коллекции отключен) | Отключено с "No" по умолчанию |
| Группа доступности (созданная пользователем) | Коллекции | Отключено по умолчанию со значением "Да" |
| Группа доступности (созданная пользователем) | Хранилище BLOB-объектов | Включено с "No" по умолчанию |
