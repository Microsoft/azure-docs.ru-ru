---
title: Приступая к работе с агентом виртуальных рабочих столов Windows
description: Обзор агента виртуальных рабочих столов Windows и процессов обновления.
author: Sefriend
ms.topic: conceptual
ms.date: 12/16/2020
ms.author: sefriend
manager: clarkn
ms.openlocfilehash: ecc4a5a17186eddd4223715462b14399bdf702df
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104601896"
---
# <a name="get-started-with-the-windows-virtual-desktop-agent"></a>Приступая к работе с агентом виртуальных рабочих столов Windows

В среде службы виртуальных рабочих столов Windows есть три основных компонента: клиент удаленный рабочий стол, служба и виртуальные машины. Эти виртуальные машины находятся в подписке клиента, где установлены агент виртуальных рабочих столов Windows и загрузчик агента. Агент выступает в качестве промежуточного Communicator между службой и виртуальными машинами, обеспечивая возможность подключения. Поэтому при возникновении проблем с установкой, обновлением или настройкой агента виртуальные машины не смогут подключаться к службе. Загрузчик агента — это исполняемый файл, загружающий агент. 

В этой статье вы получите краткий обзор процессов установки и обновления агента.

>[!NOTE]
>Эта документация не относится к агенту Фслогикс или агенту клиента удаленный рабочий стол.


## <a name="initial-installation-process"></a>Процесс начальной установки

Агент виртуальных рабочих столов Windows изначально устанавливается одним из двух способов. Если вы подготавливаете виртуальные машины в портал Azure и Azure Marketplace, агент и загрузчик агента устанавливаются автоматически. При подготовке виртуальных машин с помощью PowerShell необходимо вручную загрузить MSI-файлы агента и загрузчика агента при [создании пула узлов виртуальных рабочих столов Windows с помощью PowerShell](create-host-pools-powershell.md#register-the-virtual-machines-to-the-windows-virtual-desktop-host-pool). При установке агента одновременно устанавливаются параллельный стек виртуальных рабочих столов Windows и агент мониторинга Geneva. Чтобы пользователи могли безопасно устанавливать обратные подключения "сервер-клиент", требуется параллельный компонент стека. Агент мониторинга Geneva отслеживает работоспособность агента. Все три из этих компонентов необходимы для правильной работы сквозного подключения пользователей.

>[!IMPORTANT]
>Для успешной установки агента виртуальных рабочих столов Windows, параллельного стека и агента мониторинга Geneva необходимо разблокировать все URL-адреса, перечисленные в [списке требуемые URL-адреса](safe-url-list.md#virtual-machines). Для использования службы виртуальных рабочих столов Windows необходимо разблокировать эти URL-адреса.

## <a name="agent-update-process"></a>Процесс обновления агента

Служба виртуальных рабочих столов Windows обновляет агент каждый раз, когда обновление станет доступным. Обновления агента могут включать новые функции или исправления для предыдущих проблем. После установки первоначальной версии агента виртуальных рабочих столов Windows агент регулярно запрашивает службу виртуальных рабочих столов Windows, чтобы определить, доступна ли более новая версия компонента "агент", "стек" или "Мониторинг". Если более новая версия любого из компонентов уже развернута, то обновленный компонент устанавливается автоматически.

Новые версии агента развертываются через регулярные интервалы в виклонг периодах во всех подписках Azure. Эти периоды обновления называются «рейсами». В случае наступления рейса вы можете увидеть, что виртуальные машины в пуле узлов получают обновление агента в разное время. Все агенты виртуальных машин во всех подписках будут обновлены до конца периода развертывания. Система рейсов виртуальных рабочих столов Windows повышает надежность службы, обеспечивая стабильность и качество обновления агента.


>[!NOTE]
>- Когда агент мониторинга Geneva обновляется до последней версии, старая задача Женеватаск находится и отключается перед созданием новой задачи для нового агента мониторинга. Более ранняя версия агента мониторинга не удаляется, если последняя версия агента мониторинга имеет проблему, которая требует возврата к более ранней версии, чтобы исправить ошибку. Если в последней версии возникла проблема, старый агент мониторинга будет включен повторно, чтобы продолжить доставку данных мониторинга. Все версии монитора, которые ранее были установлены до последнего обновления, будут удалены из виртуальной машины.
>- На виртуальной машине одновременно хранятся три версии стека параллельных вычислений. Это позволяет быстро восстановиться, если в обновлении возникли проблемы. Самая ранняя версия стека удаляется из виртуальной машины при каждом обновлении стека.

Эта установка обновления обычно длится 2-3 минут на новой виртуальной машине и не должна приводить к потере подключения или прекращению работы виртуальной машины. Этот процесс обновления относится к виртуальным рабочим столам Windows (классическая модель) и последней версии Windows Virtual Desktop с Azure Resource Manager.

## <a name="next-steps"></a>Дальнейшие действия

Теперь, когда у вас есть более полное представление о агенте виртуальных рабочих столов Windows, ниже приведены некоторые ресурсы, которые могут помочь вам:

- Если возникли проблемы с агентом или подключением, ознакомьтесь с [руководством по устранению неполадок агента виртуальных рабочих столов Windows](troubleshoot-agent.md).
