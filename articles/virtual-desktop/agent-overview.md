---
title: Приступая к работе с агентом виртуальных рабочих столов Windows
description: Обзор агента виртуальных рабочих столов Windows и процессов обновления.
author: Sefriend
ms.topic: conceptual
ms.date: 12/16/2020
ms.author: sefriend
manager: clarkn
ms.openlocfilehash: 325502255e84e38a39ca5b90ee4126354c0d425b
ms.sourcegitcommit: fc401c220eaa40f6b3c8344db84b801aa9ff7185
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/20/2021
ms.locfileid: "98601239"
---
# <a name="get-started-with-the-windows-virtual-desktop-agent"></a>Приступая к работе с агентом виртуальных рабочих столов Windows

В среде службы виртуальных рабочих столов Windows есть три основных компонента: клиент удаленный рабочий стол, служба и виртуальные машины. Эти виртуальные машины находятся в подписке клиента, где установлены агент виртуальных рабочих столов Windows и загрузчик агента. Агент выступает в качестве промежуточного Communicator между службой и виртуальными машинами, обеспечивая возможность подключения. Поэтому при возникновении проблем с установкой, обновлением или настройкой агента виртуальные машины не смогут подключаться к службе. Загрузчик агента — это исполняемый файл, загружающий агент. 

В этой статье вы получите краткий обзор процессов установки и обновления агента.

>[!NOTE]
>Эта документация не относится к агенту Фслогикс или агенту клиента удаленный рабочий стол.


## <a name="initial-installation-process"></a>Процесс начальной установки

Агент виртуальных рабочих столов Windows изначально устанавливается одним из двух способов. Если вы подготавливаете виртуальные машины в портал Azure и Azure Marketplace, агент и загрузчик агента устанавливаются автоматически. При подготовке виртуальных машин с помощью PowerShell необходимо вручную загрузить MSI-файлы агента и загрузчика агента при [создании пула узлов виртуальных рабочих столов Windows с помощью PowerShell](create-host-pools-powershell.md#register-the-virtual-machines-to-the-windows-virtual-desktop-host-pool). При установке агента одновременно устанавливаются параллельный стек виртуальных рабочих столов Windows и агент мониторинга Geneva. Чтобы пользователи могли безопасно устанавливать обратные подключения "сервер-клиент", требуется параллельный компонент стека. Агент мониторинга Geneva отслеживает работоспособность агента. Все три из этих компонентов необходимы для правильной работы сквозного подключения пользователей.

>[!IMPORTANT]
>Для успешной установки агента виртуальных рабочих столов Windows, параллельного стека и агента мониторинга Geneva необходимо разблокировать все URL-адреса, перечисленные в [списке требуемые URL-адреса](safe-url-list.md#virtual-machines). Для использования службы виртуальных рабочих столов Windows необходимо разблокировать эти URL-адреса.

## <a name="agent-update-process"></a>Процесс обновления агента

Служба виртуальных рабочих столов Windows автоматически обновляет агент, когда обновление станет доступным. Обновления агента могут включать новые функции или устранять предыдущие проблемы. После установки первоначальной версии агента виртуальных рабочих столов Windows агент регулярно опрашивает службу виртуальных рабочих столов Windows, чтобы определить наличие более новой версии агента и доступных компонентов. При наличии новой версии загрузчик агента автоматически скачивает последнюю версию агента, параллельный стек и агент мониторинга Geneva.

>[!NOTE]
>- Когда агент мониторинга Geneva обновляется до последней версии, старая задача Женеватаск находится и отключается перед созданием новой задачи для нового агента мониторинга. Более ранняя версия агента мониторинга не удаляется, если последняя версия агента мониторинга имеет проблему, которая требует возврата к более ранней версии, чтобы исправить ошибку. Если в последней версии возникла проблема, старый агент мониторинга будет включен повторно, чтобы продолжить доставку данных мониторинга. Все версии монитора, которые ранее были установлены до последнего обновления, будут удалены из виртуальной машины.
>- На виртуальной машине одновременно хранятся три версии стека параллельных вычислений. Это позволяет быстро восстановиться, если в обновлении возникли проблемы. Самая ранняя версия стека удаляется из виртуальной машины при каждом обновлении стека.

Эта установка обновления обычно длится 2-3 минут на новой виртуальной машине и не должна приводить к потере подключения или прекращению работы виртуальной машины. Этот процесс обновления относится к виртуальным рабочим столам Windows (классическая модель) и последней версии Windows Virtual Desktop с Azure Resource Manager.

## <a name="next-steps"></a>Следующие шаги

Теперь, когда у вас есть более полное представление о агенте виртуальных рабочих столов Windows, ниже приведены некоторые ресурсы, которые могут помочь вам:

- Если возникли проблемы с агентом или подключением, ознакомьтесь с [руководством по устранению неполадок агента виртуальных рабочих столов Windows](troubleshoot-agent.md).