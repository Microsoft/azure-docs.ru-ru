---
title: Общий ресурс контейнера профиля Фслогикс Windows для виртуальных рабочих столов — Azure
description: Как настроить контейнер Фслогикс Profile для пула узлов виртуальных рабочих столов Windows с помощью общей папки на основе виртуальной машины.
author: Heidilohr
ms.topic: how-to
ms.date: 08/20/2019
ms.author: helohr
manager: lizross
ms.openlocfilehash: 35b692033cc16f276b48bc6d973b27d994c1082a
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "88002591"
---
# <a name="create-a-profile-container-for-a-host-pool-using-a-file-share"></a>Создание контейнера профиля для пула узлов с помощью общей папки

Служба виртуальных рабочих столов Windows предлагает контейнеры профилей Фслогикс в качестве рекомендуемого решения для профилей пользователей. Не рекомендуется использовать решение "диск профиля пользователя" (UPD), которое будет считаться устаревшим в будущих версиях виртуальных рабочих столов Windows.

Из этой статьи вы узнаете, как настроить общую папку контейнера профилей Фслогикс для пула узлов с помощью общей папки на основе виртуальной машины. Мы настоятельно рекомендуем использовать службы файлов Azure вместо файловых ресурсов. Дополнительную документацию по Фслогикс см. на [сайте фслогикс](https://docs.fslogix.com/).

>[!NOTE]
>Если вы ищете сравнительные материалы о различных вариантах хранения контейнера профиля Фслогикс в Azure, см. статью [Параметры хранилища для контейнеров профилей фслогикс](store-fslogix-profile.md).

## <a name="create-a-new-virtual-machine-that-will-act-as-a-file-share"></a>Создание новой виртуальной машины, которая будет использоваться в качестве файлового ресурса

При создании виртуальной машины убедитесь, что она размещена в той же виртуальной сети, что и виртуальные машины пула узлов, или в виртуальной сети с подключением к виртуальным машинам пула узлов. Создать виртуальную машину можно несколькими способами:

- [Создание виртуальной машины из образа коллекции Azure](../virtual-machines/windows/quick-create-portal.md#create-virtual-machine)
- [Создание виртуальной машины из управляемого образа](../virtual-machines/windows/create-vm-generalized-managed.md)
- [Создание виртуальной машины из неуправляемого образа](https://github.com/Azure/azure-quickstart-templates/tree/master/101-vm-from-user-image)

После создания виртуальной машины присоедините ее к домену, выполнив следующие действия.

1. [Подключитесь к виртуальной машине](../virtual-machines/windows/quick-create-portal.md#connect-to-virtual-machine), указав учетные данные, которые вы использовали при создании этой виртуальной машины.
2. На виртуальной машине откройте **Панель управления** и выберите **Система**.
3. Выберите **Имя компьютера**, щелкните **Изменить параметры** и выберите **Изменить**.
4. Выберите **Домен** и введите имя домена Active Directory в этой виртуальной сети.
5. Выполните аутентификацию с учетной записью домена, которая имеет права на присоединение компьютеров к домену.

## <a name="prepare-the-virtual-machine-to-act-as-a-file-share-for-user-profiles"></a>Подготовка виртуальной машины к использованию в качестве файлового ресурса для профилей пользователей

Ниже приведены общие инструкции по подготовке виртуальной машины к использованию в качестве файлового ресурса для профилей пользователей.

1. Добавьте пользователей Windows Virtual Desktop Active Directory в [группу безопасности Active Directory](/windows/security/identity-protection/access-control/active-directory-security-groups/). Эта группа безопасности будет использоваться для проверки подлинности пользователей виртуальных рабочих столов Windows на только что созданной виртуальной машине с общей папкой.
2. [Подключитесь к виртуальной машине с общей папкой](../virtual-machines/windows/quick-create-portal.md#connect-to-virtual-machine).
3. На виртуальной машине с общей папкой создайте папку на **диске C** , которая будет использоваться в качестве общего ресурса профиля.
4. Щелкните правой кнопкой мыши новую папку, выберите пункт **Свойства**, выберите **Общий** доступ, а затем щелкните **Расширенный общий доступ.**...
5. Выберите **общий доступ к этой папке**, выберите **разрешения...**, а затем нажмите кнопку **Добавить...**.
6. Найдите группу безопасности, в которую вы добавили пользователей виртуальных рабочих столов Windows, а затем убедитесь, что группа имеет **полный доступ**.
7. После добавления группы безопасности щелкните правой кнопкой мыши папку, выберите пункт **Свойства**, выберите **общий доступ**, а затем скопируйте **сетевой путь** , который будет использоваться для дальнейшего использования.

Дополнительные сведения о разрешениях см. в [документации по фслогикс](/fslogix/fslogix-storage-config-ht/).

## <a name="configure-the-fslogix-profile-container"></a>Настройка контейнера профиля Фслогикс

Чтобы настроить виртуальные машины с помощью программного обеспечения Фслогикс, выполните следующие действия на каждом компьютере, зарегистрированном в пуле узлов:

1. [Подключитесь к виртуальной машине](../virtual-machines/windows/quick-create-portal.md#connect-to-virtual-machine), указав учетные данные, которые вы использовали при создании этой виртуальной машины.
2. Запустите Интернет браузер и перейдите по [этой ссылке](https://go.microsoft.com/fwlink/?linkid=2084562) , чтобы скачать агент фслогикс.
3. Перейдите к \\ \\ \\ выпуску Win32 или \\ \\ x64 \\ в ZIP-файле и запустите **фслогиксаппссетуп** , чтобы установить агент фслогикс.  Дополнительные сведения об установке Фслогикс см. в статье [Загрузка и установка фслогикс](/fslogix/install-ht/).
4. Перейдите в раздел **Program Files**  >  **фслогикс**  >  **Apps** (программы), чтобы подтвердить установку агента.
5. В меню Пуск запустите **программу Regedit** от имени администратора. Перейдите в раздел **Computer \\ HKEY_LOCAL_MACHINE \\ Software \\ фслогикс**.
6. Создайте ключ с именем **Profiles**.
7. Создайте следующие значения для ключа Profiles:

| Имя                | Type               | Данные и значение                        |
|---------------------|--------------------|-----------------------------------|
| Активировано             | DWORD              | 1                                 |
| вхдлокатионс        | Многострочное значение | "Сетевой путь к общей папке"     |

>[!IMPORTANT]
>Чтобы усилить защиту среды Виртуального рабочего стола Windows в Azure, мы рекомендуем не открывать входящий порт 3389 для виртуальных машин. Виртуальный рабочий стол Windows не требует открытия входящего порта 3389, чтобы пользователи могли получить доступ к виртуальным машинам пула узла. Если вам все же нужно открыть порт 3389 для устранения неполадок, мы рекомендуем использовать[JIT-доступ к виртуальным машинам](../security-center/security-center-just-in-time.md).
