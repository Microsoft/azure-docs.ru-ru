---
title: Руководство по Создание политики WAF для Azure Front Door при помощи портала Azure
description: Из этого руководства вы узнаете, как создать политику брандмауэра веб-приложения с помощью портала Azure.
author: vhorne
ms.service: web-application-firewall
services: web-application-firewall
ms.topic: tutorial
ms.date: 02/18/2021
ms.author: victorh
ms.openlocfilehash: 8b1d1007e817bafe3d75f0f0d7c3fc6eb5470854
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101729476"
---
# <a name="tutorial-create-a-web-application-firewall-policy-on-azure-front-door-using-the-azure-portal"></a>Руководство по Создание политики брандмауэра веб-приложения для Azure Front Door на портале Azure

В этом учебнике показано, как создать простейшую политику брандмауэра веб-приложения (WAF) и применить ее к интерфейсному узлу в Azure Front Door.

В этом руководстве описано следующее:

> [!div class="checklist"]
> * Создание политики WAF
> * связывание ее с интерфейсным узлом;
> * настройка правил WAF.

## <a name="prerequisites"></a>Предварительные требования

Создайте профиль Front Door, следуя инструкциям, описанным в статье [Краткое руководство. Создание профиля Front Door для высокодоступного глобального веб-приложения](../../frontdoor/quickstart-create-front-door.md). 

## <a name="create-a-web-application-firewall-policy"></a>Создание политики брандмауэра веб-приложения

Сначала создайте на портале базовую политику WAF с управляемым набором правил по умолчанию (DRS). 

1. В левой верхней части экрана выберите **Создать ресурс**, выполните поиск по запросу **WAF**, выберите элемент **Брандмауэр веб-приложения (предварительная версия)** и щелкните **Создать**.
2. На вкладке **Основные сведения** страницы **Создание политики WAF** введите или выберите указанные ниже сведения, примите значения по умолчанию для остальных параметров и нажмите кнопку **Проверить и создать**.

    | Параметр                 | Значение                                              |
    | ---                     | ---                                                |
    | Подписка            |Выберите имя своей подписки Front Door.|
    | Группа ресурсов          |Выберите имя группы ресурсов Front Door.|
    | Имя политики             |Введите уникальное имя для политики WAF.|

   :::image type="content" source="../media/waf-front-door-create-portal/basic.png" alt-text="Снимок экрана: страница &quot;Создание политики WAF&quot;, на которой показаны кнопка &quot;Просмотр и создание&quot;, а также поля для подписки, группы ресурсов и имени политики." border="false":::

3. На вкладке **Ассоциация** страницы **Создание политики WAF** выберите **Добавить интерфейсный узел**, введите указанные ниже сведения, а затем нажмите кнопку **Добавить**.

    | Параметр                 | Значение                                              |
    | ---                     | ---                                                |
    | Front Door              | Выберите имя профиля Front Door.|
    | Узел внешнего интерфейса           | Выберите имя узла Front Door и нажмите кнопку **Добавить**.|
    
    > [!NOTE]
    > Если интерфейсный узел связан с политикой WAF, он недоступен для выбора. Сначала необходимо удалить интерфейсный узел из связанной политики, а затем повторно связать его с новой политикой WAF.
1. Выберите **Проверить и создать**, а затем выберите **Создать**.

## <a name="configure-web-application-firewall-rules-optional"></a>Настройка правил брандмауэра веб-приложения (необязательно)

### <a name="change-mode"></a>Изменение режима

После создании политики WAF она по умолчанию находится в режиме **обнаружения**. В режиме **обнаружения** WAF не блокирует запросы. Вместо этого запросы, соответствующие правилам WAF, регистрируются в журналах WAF.
Чтобы увидеть WAF в действии, можно изменить режим с **Обнаружение** на **Предотвращение**. В режиме **предотвращения** запросы, соответствующие правилам, которые определены в наборе правил по умолчанию (DRS), блокируются и регистрируются в журналах WAF.

 :::image type="content" source="../media/waf-front-door-create-portal/policy.png" alt-text="Снимок экрана: раздел параметров политики. Переключатель режима установлен в значение &quot;Предотвращение&quot;." border="false":::

### <a name="custom-rules"></a>Настраиваемые правила

Вы можете создать пользовательское правило, выбрав команду **Добавить настраиваемое правило** в разделе **Настраиваемые правила**. Откроется страница настройки пользовательского правила. Ниже приведен пример настройки пользовательского правила для блокировки запроса, если строка запроса содержит **blockme**.

:::image type="content" source="../media/waf-front-door-create-portal/customquerystring2.png" alt-text="Снимок экрана: страница конфигурации настраиваемого правила с параметрами для правила, которое позволяет проверить, содержит ли переменная QueryString значение blockme." border="false":::

### <a name="default-rule-set-drs"></a>Набор правил по умолчанию (DRS)

Набор правил по умолчанию, управляемый Azure, включен по умолчанию. Текущая версия по умолчанию — DefaultRuleSet_1.0. В брандмауэре веб-приложения (страница **Управляемые правила**, раздел **Назначение**) недавно доступный набор правил Microsoft_DefaultRuleSet_1.1 будет отображаться в раскрывающемся списке.

Чтобы отключить отдельное правило в группе правил, разверните правила в этой группе, установите **флажок** перед номером правила и щелкните **Отключить** на вкладке выше. Чтобы изменить типы действий для отдельных правил в наборе правил, установите флажок перед номером правила, а затем выберите вкладку **Изменение действия** выше.

 :::image type="content" source="../media/waf-front-door-create-portal/managed2.png" alt-text="Снимок экрана: страница управляемых правил с набором правил, группами правил, правилами, а также кнопками включения, отключения и изменения действий. Проверяется одно правило." border="false":::

## <a name="clean-up-resources"></a>Очистка ресурсов

Если группа ресурсов и связанные с ней ресурсы вам больше не нужны, их можно удалить.

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Узнайте больше о Azure Front Door](../../frontdoor/front-door-overview.md)
