---
title: Брандмауэр веб-приложения Azure в службе "Передняя дверца" Azure — часто задаваемые вопросы
description: В этой статье содержатся ответы на часто задаваемые вопросы о брандмауэре веб-приложения на передней дверце Azure.
services: web-application-firewall
author: vhorne
ms.service: web-application-firewall
ms.devlang: na
ms.topic: article
ms.date: 05/05/2020
ms.author: victorh
ms.openlocfilehash: 5c2763112b1aa2d58f5dc57cea72a3d0bdea961e
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "95545675"
---
# <a name="frequently-asked-questions-for-azure-web-application-firewall-on-azure-front-door-service"></a>Часто задаваемые вопросы о брандмауэре веб-приложения Azure в службе "Передняя дверь" Azure

В этой статье содержатся ответы на часто задаваемые вопросы о брандмауэре веб-приложения Azure (WAF) в функциях и функциях службы "Передняя дверь" Azure. 

## <a name="what-is-azure-waf"></a>Что такое Azure WAF?

Azure WAF — это брандмауэр веб-приложения, который помогает защитить веб-приложения от распространенных угроз, таких как внедрение кода SQL, межсайтовые сценарии и другие веб-атаки. Вы можете определить политику WAF, состоящую из сочетания настраиваемых и управляемых правил для управления доступом к веб-приложениям.

Политику Брандмауэра веб-приложения Azure можно применить к веб-приложениям, расположенным на Шлюзе приложений или Azure Front Doors.

## <a name="what-is-waf-on-azure-front-door"></a>Что такое WAF в передней дверце Azure? 

Передняя дверца Azure — это Высокомасштабируемая глобально распределенная сеть для распространения приложений и содержимого. Azure WAF, интегрированная с передней дверцей, останавливает атаки типа "отказ в обслуживании" и нацеленные на них приложения на границе сети Azure, близко к источникам атак перед входом в виртуальную сеть, обеспечивает защиту без ущерба для производительности.

## <a name="does-azure-waf-support-https"></a>Поддерживает ли Azure WAF поддержку протокола HTTPS?

Передняя дверь предлагает разгрузку TLS. WAF изначально интегрирован с интерфейсной дверцей и может проверять запрос после расшифровки.

## <a name="does-azure-waf-support-ipv6"></a>Поддерживает ли Azure WAF поддержку IPv6?

Да. Можно настроить ограничение IP-адресов для IPv4 и IPv6.

## <a name="how-up-to-date-are-the-managed-rule-sets"></a>Насколько актуальны наборы управляемых правил?

Мы делаем все возможное, чтобы справиться с изменением ландшафта угроз. После обновления нового правила оно добавляется в набор правил по умолчанию с новым номером версии.

## <a name="what-is-the-propagation-time-if-i-make-a-change-to-my-waf-policy"></a>Что такое время распространения, если я вносит изменения в мою политику WAF?

Глобальное развертывание политики WAF обычно занимает около 5 минут и часто завершается.

## <a name="can-waf-policies-be-different-for-different-regions"></a>Могут ли WAF политики различаться для разных регионов?

При интеграции с передней дверцей WAF является глобальным ресурсом. Одна и та же конфигурация применяется ко всем расположениям передней дверцы.
 
## <a name="how-do-i-limit-access-to-my-back-end-to-be-from-front-door-only"></a>Разделы справки ограничить доступ к моей серверной части только из передней дверцы?

Вы можете настроить список управления доступом IP-адресов в серверной части, чтобы разрешить только диапазоны исходящих IP-адресов передней дверцы и запретить любой прямой доступ из Интернета. Теги службы поддерживаются для использования в виртуальной сети. Кроме того, можно проверить допустимость поля заголовка HTTP "перенаправление на узел" для веб-приложения.

## <a name="which-azure-waf-options-should-i-choose"></a>Какие параметры Azure WAF следует выбрать?

Существует два варианта применения политик WAF в Azure. WAF с передней дверцей Azure — это глобально распределенное решение для обеспечения безопасности. WAF с шлюзом приложений — это региональное, выделенное решение. Мы рекомендуем выбрать решение на основе общих требований к производительности и безопасности. Дополнительные сведения см. [в статье балансировка нагрузки с помощью пакета доставки приложений Azure](../../frontdoor/front-door-lb-with-azure-app-delivery-suite.md).

## <a name="whats-the-recommended-approach-to-enabling-waf-on-front-door"></a>Каков рекомендуемый подход к включению WAF на передней дверце?

При включении WAF в существующем приложении часто встречаются ложные срабатывания, где правила WAF обнаруживают допустимый трафик как угрозу. Чтобы снизить риск воздействия на пользователей, рекомендуется следующий процесс:

* Включите [режим **обнаружения**](./waf-front-door-create-portal.md#change-mode) WAF, чтобы убедиться, что WAF не блокирует запросы во время работы с этим процессом.
  > [!IMPORTANT]
  > В этом процессе описывается, как включить WAF для нового или существующего решения, если ваш приоритет сводится к уменьшению числа беспорядки для пользователей приложения. При атаке или приближении угрозы может потребоваться немедленно развернуть WAF в режиме **предотвращения** и использовать процесс настройки для отслеживания и настройки WAF с течением времени. Это может привести к блокированию трафика, поэтому мы советуем использовать его только в случае угрозы.
* Следуйте нашим [рекомендациям по настройке WAF](./waf-front-door-tuning.md). Для этого процесса необходимо включить ведение журнала диагностики, регулярно просматривать журналы и добавлять исключения правил и другие способы их устранения.
* Повторяйте весь процесс, регулярно проверяя журналы, пока не будет удовлетворено, что допустимый трафик не блокируется. Весь процесс может занять несколько недель. В идеале после каждого изменения настройки должно быть меньше ложных срабатываний.
* Наконец, включите WAF в **режиме предотвращения**.
* Даже после запуска WAF в рабочей среде следует следить за мониторингом журналов, чтобы определить любые другие ложные срабатывания. Регулярная проверка журналов также поможет определить реальные попытки атак, которые были заблокированы.

## <a name="do-you-support-same-waf-features-in-all-integrated-platforms"></a>Поддерживаются ли одни и те же функции WAF во всех интегрированных платформах?

В настоящее время правила Модсек CR 2.2.9, CR 3,0 и CR 3,1 поддерживаются только для WAF в шлюзе приложений. Правила ограничения скорости, географической фильтрации и набора правил по умолчанию для управляемых Azure поддерживаются только с WAF в передней дверце Azure.

## <a name="is-ddos-protection-integrated-with-front-door"></a>Интегрирована ли от атак DDoS защита с передней дверцей? 

Внешняя дверца Azure, глобально распределенная на краях сети Azure, может снизить и географически изолировать атаки большого объема. Вы можете создать настраиваемую политику WAF для автоматической блокировки и ограничения скорости атак HTTP (s) с известными подписями. Кроме того, вы можете включить стандарт защиты от атак DDoS в виртуальной сети, в которой развернуты серверные концы. Клиенты Azure от атак DDoS Protection Standard получают дополнительные преимущества, включая защиту от затрат, гарантию соглашения об уровне обслуживания и доступ экспертов из группы от атак DDoS быстрого реагирования для немедленной помощи во время атаки. Дополнительные сведения см. [в статье Защита от атак DDoS на передней дверце](../../frontdoor/front-door-ddos.md).

## <a name="why-do-additional-requests-above-the-threshold-configured-for-my-rate-limit-rule-get-passed-to-my-backend-server"></a>Почему дополнительные запросы выше порогового значения, настроенного для правила ограничения скорости, передаются моему внутреннему серверу?

Правило ограничения скорости может ограничивать слишком высокий трафик с любого IP-адреса клиента. Вы можете настроить пороговое значение числа веб-запросов, разрешенных с IP-адреса клиента в течение одной минуты или в течение пяти минут. Для детализированного управления скоростью ограничение скорости может сочетаться с дополнительными условиями соответствия, такими как сопоставление параметров HTTP (S). 

Запросы от одного и того же клиента часто прибывают к одному и тому же серверу первой дверцы. В этом случае вы увидите, что дополнительные запросы выше порогового значения будут заблокированы немедленно. 

Однако возможно, что запросы от одного клиента могут поступать на другой сервер передней дверцы, который еще не обновил счетчик ограничения скорости. Например, клиент может открыть новое соединение для каждого запроса, а пороговое значение — низкая. В этом случае первый запрос к новому серверу переднего плана будет проходить проверку ограничения скорости. Пороговое значение ограничения скорости обычно задается с высоким уровнем защиты от атак типа "отказ в обслуживании" с любого IP-адреса клиента. При очень низком пороге можно увидеть дополнительные запросы выше порогового значения.

## <a name="next-steps"></a>Дальнейшие действия

- Узнайте больше о [брандмауэре веб-приложения Azure](../overview.md).
- Узнайте больше о [Azure Front Door](../../frontdoor/front-door-overview.md).