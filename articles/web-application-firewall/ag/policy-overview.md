---
title: Обзор политики брандмауэра веб-приложения Azure (WAF)
description: В этой статье представлены общие сведения о политиках брандмауэра веб-приложений (WAF) Global, site и URI.
services: web-application-firewall
ms.topic: article
author: winthrop28
ms.service: web-application-firewall
ms.date: 11/20/2020
ms.author: victorh
ms.openlocfilehash: 59ca0b85ba2aff29bdb2ad3379c1054041d2b4cb
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96518742"
---
# <a name="azure-web-application-firewall-waf-policy-overview"></a>Обзор политики брандмауэра веб-приложения Azure (WAF)

Политики брандмауэра веб-приложения содержат все параметры и конфигурации WAF. Сюда входят исключения, настраиваемые правила, управляемые правила и т. д. Затем эти политики связаны с шлюзом приложений (глобальным), прослушивателем (на сайт) или правилом на основе пути (для каждого URI), чтобы они вступили в силу.

Количество политик, которые можно создать, не ограничено. Для вступления в силу при создании политики ее необходимо связать с шлюзом приложений. Он может быть связан с любым сочетанием шлюзов приложений, прослушивателей и правил на основе пути.

## <a name="global-waf-policy"></a>Глобальная политика WAF

При глобальном связывании политики WAF каждый сайт за WAF шлюза приложений защищен с помощью тех же управляемых правил, настраиваемых правил, исключений и других настроенных параметров.

Если требуется применить одну политику ко всем сайтам, можно связать политику с шлюзом приложений. Дополнительные сведения см. в статье [Создание политик брандмауэра веб-приложений для шлюза приложений](create-waf-policy-ag.md) для создания и применения политики WAF с помощью портал Azure. 

## <a name="per-site-waf-policy"></a>Политика WAF для каждого сайта

С помощью политик WAF для разных сайтов можно защитить несколько сайтов с разными требованиями к безопасности, расположенных за одним WAF. Например, если у вас есть пять сайтов за WAF, у вас может быть пять отдельных политик WAF (по одной для каждого прослушивателя) для настройки исключений, настраиваемых правил, наборов управляемых правил и всех остальных параметров WAF для каждого сайта.

Допустим, к шлюзу приложений применена глобальная политика. Затем вы применяете к прослушивателю этого шлюза приложений другую политику. Политика прослушивателя будет применена только к этому прослушивателю. Глобальная политика шлюза приложений будет по-прежнему применяться ко всем другим прослушивателям и правилам на основе путей, которым не назначена определенная политика.

## <a name="per-uri-policy"></a>Политика для каждого URI

Чтобы еще больше настроить уровень URI, можно связать политику WAF с правилом на основе пути. Если в одном сайте есть определенные страницы, для которых требуются разные политики, можно внести изменения в политику WAF, которая влияет только на заданный универсальный код ресурса (URI). Это может применяться к странице оплаты или входа или другим URI, которым требуется еще более конкретная политика WAF, чем у других сайтов, расположенных за WAF.

Как и в случае с политиками WAF для каждого сайта, более конкретные политики переопределяют менее конкретные. Это означает, что политика на основе универсального кода ресурса (URI) на карте URL-пути переопределяет любую политику для каждого или глобального WAF, расположенную выше.

### <a name="example"></a>Пример

Предположим, у вас есть три сайта: contoso.com, fabrikam.com и adatum.com, которые находятся за одним шлюзом приложений. Вы хотите применить WAF ко всем трем сайтам, но вам потребуется дополнительная защита с помощью adatum.com, так как клиенты могут посещать, просматривать и покупать продукты.

К WAF можно применить глобальную политику с некоторыми базовыми параметрами, исключениями или пользовательскими правилами, если это необходимо, чтобы предотвратить некоторые ложные срабатывания от блокировки трафика. В этом случае нет необходимости выполнять глобальные правила внедрения кода SQL, так как fabrikam.com и contoso.com являются статическими страницами без серверной части SQL. Поэтому эти правила можно отключить в глобальной политике.

Эта глобальная политика подходит для contoso.com и fabrikam.com, но необходимо более внимательно использовать adatum.com, где обрабатываются сведения о входе и платежи. Вы можете применить политику для каждого узла к прослушивателю adatum и оставить выполняющиеся правила SQL. Также предположим, что есть файл cookie, блокирующий некоторый трафик, поэтому можно создать исключение для этого файла cookie, чтобы предотвратить ложное срабатывание. 

Универсальный код ресурса (URI) adatum.com/payments — это то, что необходимо соблюдать осторожность. Поэтому примените к этому URI другую политику и оставьте все правила включенными, а также удалите все исключения.

В этом примере имеется глобальная политика, которая применяется к двум сайтам. У вас есть политика для каждого сайта, которая применяется к одному сайту, а затем политика на основе URI, применяемая к одному конкретному правилу, основанному на пути. См. статью [Настройка политик WAF для каждого сайта с помощью Azure PowerShell](per-site-policies.md) для соответствующего PowerShell в этом примере.

## <a name="existing-waf-configurations"></a>Существующие конфигурации WAF

Все новые параметры WAF брандмауэра веб-приложения (настраиваемые правила, конфигурации набора управляемых правил, исключения и т. д.) существуют в политике WAF. Если у вас уже есть WAF, эти параметры могут по-прежнему существовать в конфигурации WAF. Дополнительные сведения о переходе к новой политике WAF см. [в статье Миграция конфигурации WAF в политику WAF](./migrate-policy.md). 


## <a name="next-steps"></a>Дальнейшие действия

- [Создайте политики "на сайт" и "на универсальный код ресурса" с помощью Azure PowerShell](per-site-policies.md).
