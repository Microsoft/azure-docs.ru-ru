---
title: Ограничения — база данных Azure для PostgreSQL — один сервер
description: В этой статье описываются ограничения в базе данных Azure для PostgreSQL-Single Server, такие как число параметров подключения и подсистемы хранилища.
author: sunilagarwal
ms.author: sunila
ms.service: postgresql
ms.topic: conceptual
ms.date: 01/28/2020
ms.custom: fasttrack-edit
ms.openlocfilehash: 7cee2be3c1d7a97b87560873d6cef07ec361ee99
ms.sourcegitcommit: 73d80a95e28618f5dfd719647ff37a8ab157a668
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2021
ms.locfileid: "105605184"
---
# <a name="limits-in-azure-database-for-postgresql---single-server"></a>Ограничения в базе данных Azure для PostgreSQL — один сервер
В следующих разделах описываются действующие ограничения емкости и функциональных возможностей в службе базы данных. Дополнительные сведения о уровнях ресурсов (вычислений, памяти, хранилища) см. [в статье ценовые категории.](concepts-pricing-tiers.md)


## <a name="maximum-connections"></a>Максимальное количество соединений
Ниже показаны максимальное число подключений на ценовую категорию и виртуальных ядер. Системе Azure требуется пять подключений для отслеживания Базы данных Azure для PostgreSQL. 

|**Ценовая категория**| **Виртуальные ядра**| **Максимальное число подключений** | **Максимальное число пользовательских соединений** |
|---|---|---|---|
|Basic| 1| 55 | 50|
|Basic| 2| 105 | 100|
|Общее назначение| 2| 150| 145|
|Общее назначение| 4| 250| 245|
|Общее назначение| 8| 480| 475|
|Общее назначение| 16| 950| 945|
|Общее назначение| 32| 1500| 1495|
|Общее назначение| 64| 1900| 1895|
|С оптимизацией для операций в памяти| 2| 300| 295|
|С оптимизацией для операций в памяти| 4| 500| 495|
|С оптимизацией для операций в памяти| 8| 960| 955|
|С оптимизацией для операций в памяти| 16| 1900| 1895|
|С оптимизацией для операций в памяти| 32| 1987| 1982|

При превышении предельного количества подключений может появиться следующая ошибка:
> FATAL: sorry, too many clients already (Неустранимая ошибка: уже подключено слишком много клиентов)

> [!IMPORTANT]
> Для обеспечения оптимальной работы рекомендуется использовать пул подключений, например Пгбаунцер, для эффективного управления подключениями.

PostgreSQL подключение, даже бездействующее, может занять около 10 МБ памяти. Кроме того, создание новых соединений занимает некоторое время. Большинство приложений запрашивают много кратковременных соединений, из-за которых и возникает такая ситуация. В результате для реальной рабочей нагрузки будет меньше доступных ресурсов, что приведет к снижению производительности. Предотвратить такую ситуацию поможет использование пула подключений, который сокращает количество бездействующих подключений и повторно использует существующие подключения. Дополнительные сведения см. в этой [записи блога](https://techcommunity.microsoft.com/t5/azure-database-for-postgresql/not-all-postgres-connection-pooling-is-equal/ba-p/825717).

## <a name="functional-limitations"></a>Ограничения функциональных возможностей
### <a name="scale-operations"></a>Операции масштабирования
- В настоящее время динамическое масштабирование из ценовой категории "Базовый" и в нее не поддерживается.
- Уменьшение размера хранилища сервера в настоящее время не поддерживается.

### <a name="server-version-upgrades"></a>Обновления версии сервера
- В настоящее время автоматический переход между основными версиями ядра СУБД не поддерживается. Чтобы выполнить обновление до следующей основной версии, [восстановите дамп](./howto-migrate-using-dump-and-restore.md) на сервере, который был создан с новой версией ядра.

> Обратите внимание, что до PostgreSQL версии 10 [Политика управления версиями PostgreSQL](https://www.postgresql.org/support/versioning/) считала обновлением _основной версии_ до увеличения первого _или_ второго числа (например, 9,5 до 9,6 считалось обновлением _основной_ версии).
> Начиная с версии 10, только изменение первого числа считается обновлением основной версии (например, 10,0 на 10,1 — это _дополнительное_ обновление версии, а 10 – 11 — обновление _основной_ версии).

### <a name="vnet-service-endpoints"></a>Конечные точки службы виртуальной сети
- Поддержка конечных точек службы виртуальной сети предназначена только для серверов общего назначения и серверов, оптимизированных для операций в памяти.

### <a name="restoring-a-server"></a>Восстановление сервера
- При использовании компонента PITR создается сервер с той же ценовой категорией, что и сервер, с которого он восстанавливается.
- На новом сервере, созданном во время восстановления, нет правил брандмауэра, которые были настроены на сервере-источнике. Для этого нового сервера правила брандмауэра нужно настроить отдельно.
- Восстановление удаленного сервера не поддерживается.

### <a name="utf-8-characters-on-windows"></a>Символы UTF-8 в Windows
- В некоторых сценариях символы UTF-8 не полностью поддерживаются в среде PostgreSQL с открытым исходным кодом в операционной системе Windows, что влияет на службу "База данных Azure для PostgreSQL". Дополнительные сведения см. в беседе об [ошибке 15476 в postgresql-archive](https://www.postgresql-archive.org/BUG-15476-Problem-on-show-trgm-with-4-byte-UTF-8-characters-td6056677.html).

### <a name="gss-error"></a>Ошибка GSS
Если вы увидите ошибку, связанную с **GSS**, скорее всего используется клиент или драйвер более новой версии, которую одиночный сервер Azure Postgres поддерживает пока не полностью. Эта ошибка влияет на [драйвер JDBC версий 42.2.15 и 42.2.16](https://github.com/pgjdbc/pgjdbc/issues/1868).
   - Мы планируем завершить обновление до конца ноября. Сейчас рекомендуется использовать рабочую версию драйвера.
   - Или попробуйте отключить запрос GSS.  Используйте параметр подключения, например `gssEncMode=disable`.

### <a name="storage-size-reduction"></a>Уменьшение размера хранилища
Размер хранилища не может быть уменьшен. Необходимо создать новый сервер с требуемым размером хранилища, вручную выполнить дамп, [восстановить](./howto-migrate-using-dump-and-restore.md) и перенести базы данных на новый сервер.

## <a name="next-steps"></a>Дальнейшие действия
- См. [доступные возможности в каждой ценовой категории](concepts-pricing-tiers.md).
- См. [поддерживаемые версии базы данных PostgreSQL](concepts-supported-versions.md).
- Узнайте [Как выполнить резервное копирование и восстановление сервера в службе "База данных Azure для PostgreSQL" с помощью портала Azure](howto-restore-server-portal.md).
