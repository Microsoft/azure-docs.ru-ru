---
title: Выбор оптимального параметра сервера PostgreSQL в Azure
description: В этой статье приведены рекомендации по выбору оптимального параметра сервера PostgreSQL для развертываний.
author: sunilagarwal
ms.author: sunila
ms.custom: mvc
ms.service: postgresql
ms.topic: overview
ms.date: 09/21/2020
ms.openlocfilehash: db80ae66761e49ce90f25a22f0e74cf8a1300796
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "98797228"
---
# <a name="choose-the-right-postgresql-server-option-in-azure"></a>Выбор оптимального параметра сервера PostgreSQL в Azure

В Azure ваши рабочие нагрузки сервера PostgreSQL могут выполняться на размещенной виртуальной машине в качестве решения IaaS (инфраструктура как услуга) или PaaS (платформа как услуга). PaaS имеет несколько вариантов развертывания, каждый из которых содержит несколько уровней служб. Выбор варианта IaaS или PaaS в первую очередь зависит от того, хотите ли вы управлять базой данных, применять исправления и создавать резервные копии или же вы хотите делегировать эти операции Azure.

Принимая решение, рассмотрите следующие три варианта в PaaS или на виртуальных машинах Azure (IaaS).
- [База данных Azure для PostgreSQL — Отдельный сервер](./overview-single-server.md)
- [Гибкий сервер Базы данных Azure для PostgreSQL](./flexible-server/overview.md)
- [База данных Azure для PostgreSQL с Гипермасштабированием (Citus)](hyperscale/index.yml)

Вариант **PostgreSQL на виртуальных машинах Azure** относится к отраслевым категориям IaaS. С помощью этой службы можно запустить сервер PostgreSQL внутри полностью управляемой виртуальной машины в облачной платформе Azure. Все последние версии и выпуски PostgreSQL можно установить на виртуальной машине IaaS. Наиболее существенным отличием от Базы данных Azure для PostgreSQL является то, что PostgreSQL на виртуальных машинах Azure позволяет контролировать ядро СУБД. Однако эти возможности контроля означают дополнительные обязанности по управлению виртуальными машинами и многими задачами администрирования баз данных (DBA). Эти задачи включают в себя обслуживание и исправление серверов баз данных, восстановление баз данных и проектирование высокого уровня доступности.

Основные различия между этими вариантами показаны в приведенной ниже таблице.

| **Attribute** | **Postgres на виртуальных машинах Azure** | **PostgreSQL как PaaS** |
| ----- | ----- | ----- |
| <B> Соглашение об уровне обслуживания относительно доступности |— 99,99 % с группами доступности <br> — 99,95 % с одиночными виртуальными машинами | — одиночный сервер — 99,99 % <br> — гибкий сервер — недоступен в предварительной версии <br> — Гипермасштабирование (Citus) — 99,95 % (если включена высокая доступность)|
| <B> Исправление операционной системы и PostgreSQL | — организуется пользователем | — одиночный сервер — автоматически <br> — гибкий сервер — автоматически с помощью дополнительного управляемого пользователем периода <br> — Гипермасштабирование (Citus) — автоматически |
| <B> Высокий уровень доступности | — клиенты проектируют, внедряют, тестируют и поддерживают высокую доступность. Это могут быть возможности кластеризации, репликации и т. д. | — одиночный сервер — встроенный <br> — гибкий сервер — встроенный <br> — Гипермасштабирование (Citus) — проектируется с резервным узлом |
| <B> Избыточность в пределах зоны | — виртуальные машины Azure можно настроить для работы в разных зонах доступности. Для локального решения клиенты должны создавать и обслуживать собственные дополнительные центры обработки данных, а также управлять ими. | — одиночный сервер: Нет <br> — гибкий сервер: Да <br> — Гипермасштабирование (Citus): Нет |
| <B> Гибридный сценарий | — организуется пользователем |— одиночный сервер: Реплика чтения <br> — гибкий сервер: Недоступно на этапе предварительной версии <br> — Гипермасштабирование (Citus): Нет |
| <B> Резервное копирование и восстановление | — организуется пользователем | — одиночный сервер — поставляется с конфигурацией пользователя для локальных и географических учетных записей <br> — гибкий сервер — поставляется с конфигурацией пользователя в хранилище, избыточном между зонами <br> — Гипермасштабирование (Citus) — встроенное |
| <B> Мониторинг операций базы данных | — организуется пользователем | — одиночный сервер, гибкий сервер и масштабирование (Citus): Все они предоставляют клиентам возможность настраивать предупреждения об операциях с базами данных и выполнять действия при достижении пороговых значений. |
| <B> Расширенная защита от угроз | — клиенты должны самостоятельно создать эту защиту. |— одиночный сервер: Да <br> — гибкий сервер: Недоступно на этапе предварительной версии <br> — Гипермасштабирование (Citus): Нет |
| <B> Аварийное восстановление | — организуется пользователем | — одиночный сервер: Геоизбыточная резервная копия и реплика чтения <br> — гибкий сервер: Недоступно на этапе предварительной версии <br> — Гипермасштабирование (Citus): Нет |
| <B> Интеллектуальная производительность | — организуется пользователем | — одиночный сервер: Да <br> — гибкий сервер: Недоступно на этапе предварительной версии <br> — Гипермасштабирование (Citus): Нет |

## <a name="total-cost-of-ownership-tco"></a>Совокупная стоимость владения

Совокупная стоимость владения часто является основным фактором, определяющим лучшее решение для размещения баз данных. Это верно независимо от того, являетесь ли вы начинающим разработчиком, стесненным в деньгах, либо группой в солидной организации с ограниченным бюджетом. В этом разделе описываются основные сведения о выставлении счетов и лицензировании в Azure, которые применяются к Базе данных Azure для PostgreSQL и PostgreSQL на виртуальных машинах Azure.

## <a name="billing"></a>Выставление счетов

В настоящее время База данных Azure для PostgreSQL доступна в виде службы на нескольких уровнях с различными ценами на ресурсы. Счета за все ресурсы выставляются ежечасно по фиксированной ставке. Последние сведения о поддерживаемых в настоящее время уровнях служб, размерах вычислительных ресурсов и объемах хранения см. [на странице цен](https://azure.microsoft.com/pricing/details/postgresql/server/). Уровни служб и размеры вычислительных ресурсов можно динамически настраивать в соответствии с различными потребностями пропускной способности вашего приложения. Счета выставляются за исходящий интернет-трафик по обычным [тарифам на передачу данных](https://azure.microsoft.com/pricing/details/data-transfers/).

Корпорация Майкрософт автоматически настраивает, устанавливает исправления и обновляет программное обеспечение базы данных с помощью Базы данных Azure для PostgreSQL. Эти автоматизированные действия снижают затраты на администрирование. Кроме того, База данных Azure для PostgreSQL содержит [автоматизированный канал резервного копирования](). Эти функции помогают значительно экономить средства, особенно при наличии большого количества баз данных. С другой стороны, благодаря PostgreSQL на виртуальных машинах Azure можно выбрать и запустить любую версию PostgreSQL. Однако необходимо оплатить подготовленную виртуальную машину, затраты на хранение, связанные с данными, резервным копированием, мониторингом данных и хранением журналов, а также расходы на конкретный используемый тип лицензии PostgreSQL (если таковая имеется).

База данных Azure для PostgreSQL предоставляет встроенный высокий уровень доступности для любого типа прерывания работы на уровне узлов, обеспечивая уровень обслуживания службы 99,99 %, предусмотренный Соглашением об уровне обслуживания. Для обеспечения высокого уровня доступности базы данных на виртуальных машинах используются функции, как например [потоковая репликация](https://www.postgresql.org/docs/12/warm-standby.html#STREAMING-REPLICATION), доступные в базе данных PostgreSQL. Использование параметра высокой доступности не дает дополнительных гарантий уровня обслуживания. Однако это позволяет достичь более чем 99,99 % доступности базы данных за дополнительную плату и за счет повышения затрат на администрирование.

Дополнительную информацию см. в следующих статьях:
- [Цены на Базу данных Azure для PostgreSQL](https://azure.microsoft.com/pricing/details/postgresql/server/)
- [Цены на виртуальные машины Azure](https://azure.microsoft.com/pricing/details/virtual-machines/)
- [Калькулятор цен Azure](https://azure.microsoft.com/pricing/calculator/)

## <a name="administration"></a>Администрирование

Для многих компаний решение о переходе в облачную службу позволит уменьшить не только расходы, но и сложность администрирования системы.

С помощью IaaS корпорация Майкрософт выполняет следующие действия:

- Управляет базовой инфраструктурой.
- Автоматически устанавливает исправления для базового оборудования и ОС.

С помощью PaaS корпорация Майкрософт выполняет следующие действия:

- Управляет базовой инфраструктурой.
- Автоматически устанавливает исправления для базового оборудования, ОС и ядра СУБД.
- Управляет высокой доступностью базы данных.
- Автоматически выполняет резервное копирование и реплицирует все данные для аварийного восстановления.
- По умолчанию шифрует неактивные и перемещаемые данные.
- Наблюдает за сервером и предоставляет функции для анализа производительности процессов и рекомендации по производительности.

С помощью Базы данных Azure для PostgreSQL можно продолжить администрирование базы данных. При этом больше не требуется управлять ядром СУБД, операционной системой или оборудованием. Ниже перечислены примеры элементов, которые можно продолжить администрировать.

- Базы данных
- Вход
- Настройка индексов
- Настройка запросов
- Аудит
- Безопасность

Кроме того, при настройке высокой доступности для другого центра обработки данных требуется минимальная (или вовсе не требуется) конфигурация и администрирование.

- Решение PostgreSQL на виртуальных машинах Azure позволит полностью контролировать операционную систему и конфигурацию экземпляра сервера PostgreSQL. В рамках виртуальной машины вы определяете, когда следует обновлять операционную систему и программное обеспечение базы данных, а также какие исправления применять. Вы также определяете, когда устанавливать дополнительное программное обеспечение, например антивирусное приложение. Некоторые предлагаемые функции автоматизации позволяют значительно упростить процессы исправления, резервного копирования и обеспечения высокой доступности. Вы можете контролировать размер виртуальной машины, количество дисков и их конфигурации хранения. Дополнительные сведения см. в статье [Размеры виртуальных машин в Azure](../virtual-machines/sizes.md).

## <a name="time-to-move-to-azure-postgresql-service-paas"></a>Переход на использование службы Azure PostgreSQL (PaaS)

- База данных Azure для PostgreSQL идеально подойдет для приложений, разработанных для облачной среды, так как для них эффективность разработки и сокращение времени выхода на рынок новых решений являются критическими. Благодаря функциональным возможностям, схожим с возможностями администратора базы данных, она идеально подходит для разработчиков облачных служб, так как позволяет уменьшить необходимость управления базовой операционной системой и базой данных.

- Если вы хотите избежать затрат времени и средств на приобретение нового локального оборудования, PostgreSQL на виртуальных машинах Azure — это подходящее решение для приложений, требующих точного контроля и настройки ядра СУБД PostgreSQL, которое не поддерживается службой или требует доступ к базовой ОС.

## <a name="next-steps"></a>Следующие шаги

- Цены на Базу данных [Azure для PostgreSQL](https://azure.microsoft.com/pricing/details/postgresql/server/).
- Приступите к работе, создав первый сервер.