---
title: Оптимизация операций вставки в базу данных Azure для PostgreSQL — один сервер
description: В этой статье описывается, как оптимизировать операции с массовыми вставками в базе данных Azure для PostgreSQL-Single Server.
author: dianaputnam
ms.author: dianas
ms.service: postgresql
ms.topic: how-to
ms.date: 5/6/2019
ms.openlocfilehash: 4d10f06577738364e3f4a0ea40221d37ebfb31c0
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "86116290"
---
# <a name="optimize-bulk-inserts-and-use-transient-data-on-an-azure-database-for-postgresql---single-server"></a>Оптимизация операций вставки и использования временных данных в базе данных Azure для PostgreSQL — один сервер 
В этой статье описывается оптимизация операций массовой вставки и использование временных данных на сервере службы "База данных Azure для PostgreSQL".

## <a name="use-unlogged-tables"></a>Использование нерегистрируемых таблиц
Если ваши операции рабочей нагрузки включают временные данные или вставляют большие наборы данных в пакетном режиме, рассмотрите возможность использования нерегистрируемых таблиц.

Нерегистрируемые таблицы — это функция PostgreSQL, которая может эффективно оптимизировать операции массовой вставки. PostgreSQL использует упреждающее протоколирование (WAL). Она по умолчанию обеспечивает атомарность и устойчивость. Атомарность, согласованность, изолированность и устойчивость составляют свойства ACID. 

Вставка в нерегистрируемую таблицу означает, что PostgreSQL выполняет вставку без записи в журнал транзакций, что само по себе является операцией ввода-вывода. Таким образом, эти таблицы значительно быстрее, чем обычные.

Создайте нерегистрируемую таблицу, используя следующие параметры:
- создайте нерегистрируемую таблицу с помощью синтаксиса `CREATE UNLOGGED TABLE <tableName>`;
- преобразуйте существующую регистрируемую таблицу в нерегистрируемую с помощью синтаксиса `ALTER TABLE <tableName> SET UNLOGGED`.  

Чтобы отменить процесс, используйте синтаксис `ALTER TABLE <tableName> SET LOGGED`.

## <a name="unlogged-table-tradeoff"></a>Недостатки нерегистрируемой таблицы
Нерегистрируемые таблицы неустойчивы к сбоям. Нерегистрируемая таблица автоматически усекается после сбоя, и ее данные могут быть потеряны в случае некорректного завершения работы. Содержимое нерегистрируемой таблицы не реплицируется на резервные серверы. Любые индексы в нерегистрируемой таблице также не регистрируются автоматически. После завершения операции вставки преобразуйте таблицу в регистрируемую, чтобы операция вставки была устойчивой.

При некоторых клиентских рабочих нагрузках наблюдается повышение производительности примерно от 15 до 20 % в случае использования нерегистрируемых таблиц.

## <a name="next-steps"></a>Дальнейшие действия
Проверьте свою рабочую нагрузку на использование временных данных и массовой вставки. Ознакомьтесь со следующей документацией PostgreSQL:
 
- [Сведения о командах SQL для создания таблиц](https://www.postgresql.org/docs/current/static/sql-createtable.html)
