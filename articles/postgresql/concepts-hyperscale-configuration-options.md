---
title: Параметры конфигурации — "масштабирование" (Цитус) — база данных Azure для PostgreSQL
description: Параметры для группы серверов с горизонтальным масштабированием (Цитус), включая вычисление узлов, хранение и регионы.
author: jonels-msft
ms.author: jonels
ms.service: postgresql
ms.subservice: hyperscale-citus
ms.topic: conceptual
ms.date: 1/12/2021
ms.openlocfilehash: 48537483501165d4a978afdbd05560613170d187
ms.sourcegitcommit: 16887168729120399e6ffb6f53a92fde17889451
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/13/2021
ms.locfileid: "98165617"
---
# <a name="azure-database-for-postgresql--hyperscale-citus-configuration-options"></a>Параметры конфигурации базы данных Azure для PostgreSQL — Scale (Цитус)

## <a name="compute-and-storage"></a>Вычислительные ресурсы и ресурсы хранилища
 
Вы можете выбрать параметры вычислений и хранилища независимо для рабочих узлов и узла координатора в группе серверов с горизонтальным масштабированием (Цитус).  Вычислительные ресурсы поставляются в виде виртуальных ядер, которые представляют собой логические ЦП основного оборудования. Размер хранилища для подготовки относится к емкости, доступной для координатора и рабочих узлов в группе серверов Цитус. Хранилище включает файлы базы данных, временные файлы, журналы транзакций и журналы сервера postgres.
 
| Ресурс              | Рабочий узел           | Узел координатора      |
|-----------------------|-----------------------|-----------------------|
| Compute, виртуальных ядер       | 4, 8, 16, 32, 64      | 4, 8, 16, 32, 64      |
| Память на виртуальное ядро, гиб | 8                     | 4                     |
| Размер хранилища, тиб     | 0,5, 1, 2             | 0,5, 1, 2             |
| Тип хранилища          | Общее назначение (SSD) | Общее назначение (SSD) |
| Количество операций ввода-вывода в секунду                  | До 3 операций ввода-вывода в секунду/гиб      | До 3 операций ввода-вывода в секунду/гиб      |

Общий объем ОЗУ в одном узле с горизонтальным масштабированием (Цитус) основан на выбранном количестве виртуальных ядер.

| Виртуальные ядра | Один рабочий узел, гиб ОЗУ | Узел координатора, гиб ОЗУ |
|--------|--------------------------|---------------------------|
| 4      | 32                       | 16                        |
| 8      | 64                       | 32                        |
| 16     | 128                      | 64                        |
| 32     | 256                      | 128                       |
| 64     | 432                      | 256                       |

Общий объем хранилища, который вы подготавливаете, также определяет емкость ввода-вывода, доступную для каждого узла Worker и координатора.

| Размер хранилища, тиб | Максимальное значение IOPS |
|-------------------|--------------|
| 0,5               | 1536        |
| 1                 | 3072        |
| 2                 | 6 148        |

Для всего кластера с горизонтальным масштабированием (Цитус) агрегированные операции ввода-вывода работают со следующими значениями:

| Рабочие узлы | 0,5 Тиб, всего операций ввода-вывода | 1 Тиб, всего операций ввода-вывода | 2 Тиб, всего операций ввода-вывода |
|--------------|---------------------|-------------------|-------------------|
| 2            | 3072               | 6144             | 12 296            |
| 3            | 4 608               | 9 216             | 18 444            |
| 4            | 6144               | 12 288            | 24 592            |
| 5            | 7 680               | 15,360            | 30 740            |
| 6            | 9 216               | 18 432            | 36 888            |
| 7            | 10 752              | 21 504            | 43 036            |
| 8            | 12 288              | 24 576            | 49 184            |
| 9            | 13 824              | 27 648            | 55 332            |
| 10           | 15,360              | 30 720            | 61 480            |
| 11           | 16 896              | 33 792            | 67 628            |
| 12           | 18 432              | 36 864            | 73 776            |
| 13           | 19 968              | 39 936            | 79 924            |
| 14           | 21 504              | 43 008            | 86 072            |
| 15           | 23 040              | 46 080            | 92 220            |
| 16           | 24 576              | 49 152            | 98 368            |
| 17           | 26 112              | 52 224            | 104 516           |
| 18           | 27 648              | 55 296            | 110 664           |
| 19           | 29 184              | 58 368            | 116 812           |
| 20           | 30 720              | 61 440            | 122 960           |

## <a name="regions"></a>Регионы
Группы серверов с масштабированием (Цитус) доступны в следующих регионах Azure:

* Северная и Южная Америки:
    * Центральная Канада
    * Центральная часть США
    * Восточная часть США
    * восточная часть США 2
    * Центрально-северная часть США
    * Западная часть США 2
* Азиатско-Тихоокеанский регион:
    * Восточная Австралия
    * Japan East
    * Республика Корея, центральный регион
    * Southeast Asia
* Европа
    * Северная Европа
    * южная часть Соединенного Королевства
    * Западная Европа

Некоторые из этих регионов не могут быть изначально активированы во всех подписках Azure. Если вы хотите использовать регион из списка выше и не видите его в подписке или если вы хотите использовать регион, отсутствующий в этом списке, отправьте [запрос в службу поддержки](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest).

## <a name="limits-and-limitations"></a>Квоты и ограничения

В следующем разделе описываются ограничения емкости и функциональных ограничений в службе "масштабирование (Цитус)".

### <a name="maximum-connections"></a>Максимальное количество соединений

Каждое PostgreSQL соединение (даже неактивные) использует не менее 10 МБ памяти, поэтому важно ограничить одновременные соединения. Ниже приведены ограничения, которые мы выбрали для поддержания работоспособности узлов.

* Узел координатора
   * Максимальное число подключений: 300
   * Максимальное число пользовательских соединений: 297
* Рабочий узел
   * Максимальное число подключений: 600
   * Максимальное число пользовательских соединений: 597

Попытки подключения за пределами этих ограничений завершатся ошибкой. Система резервирует три подключения для мониторинга узлов, поэтому для запросов пользователей доступно три подключения, чем общее число подключений.

Установка новых соединений занимает некоторое время. Это работает для большинства приложений, которые запрашивают много кратковременных соединений. Мы рекомендуем использовать пул подключений для сокращения бездействующих транзакций и повторного использования существующих подключений. Дополнительные сведения см. в этой [записи блога](https://techcommunity.microsoft.com/t5/azure-database-for-postgresql/not-all-postgres-connection-pooling-is-equal/ba-p/825717).

### <a name="storage-scaling"></a>Масштабирование хранилища

Хранилище в координаторе и рабочих узлах можно масштабировать (увеличить), но нельзя уменьшить (уменьшить).

### <a name="storage-size"></a>Объем памяти

На узлах координатора и рабочей роли поддерживается до 2 Тиб хранилища. Сведения о доступных параметрах хранилища и вычислении операций ввода-вывода см. [выше](#compute-and-storage) для размеров узлов и кластеров.

### <a name="database-creation"></a>Создание базы данных

Портал Azure предоставляет учетные данные для подключения к ровно одной базе данных на каждую группу серверов горизонтальной шкалы (Цитус), которая является `citus` базой данных. Создание другой базы данных в настоящее время не разрешено, и команда CREATE DATABASE завершится ошибкой.

## <a name="pricing"></a>Цены
Наиболее актуальные сведения о стоимости см. в статье [Цены на Базу данных Azure для PostgreSQL](https://azure.microsoft.com/pricing/details/postgresql/).
Чтобы увидеть стоимость требуемой конфигурации, [портал Azure](https://portal.azure.com/#create/Microsoft.PostgreSQLServer) отображает месячную стоимость на вкладке **Настройка** в зависимости от выбранных параметров. Если у вас нет подписки Azure, для расчета цены можно воспользоваться калькулятором цен Azure. На веб-сайте [калькулятора цен Azure](https://azure.microsoft.com/pricing/calculator/) выберите **Добавить элементы**, разверните категорию **базы данных** и выберите **база данных Azure для PostgreSQL — изменение масштаба (Цитус)** для настройки параметров.
 
## <a name="next-steps"></a>Дальнейшие действия
Узнайте, как [создать группу серверов с горизонтальным масштабированием (Цитус) на портале](quickstart-create-hyperscale-portal.md).
