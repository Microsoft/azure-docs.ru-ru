---
title: Общие сведения о хранении данных в вашей среде — служба "аналитика временных рядов Azure" | Документация Майкрософт
description: В этой статье описываются две параметра, которые контролируют хранение данных в среде службы "Аналитика временных рядов Azure".
ms.service: time-series-insights
services: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: diviso
ms.reviewer: jasonh, kfile
ms.workload: big-data
ms.topic: conceptual
ms.date: 09/29/2020
ms.custom: seodec18
ms.openlocfilehash: 4f236679d0662df852581a6a8408ed6bc0d4e3fe
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "91535695"
---
# <a name="understand-data-retention-in-azure-time-series-insights-gen1"></a>Общие сведения о хранении данных в Azure Time Series Insights Gen1

> [!CAUTION]
> Эта статья посвящена службе "Аналитика временных рядов Azure" 1-го поколения.

В этой статье описываются два основных параметра, которые влияют на хранение данных в среде службы "аналитика временных рядов Azure".

## <a name="video"></a>Видео

### <a name="the-following-video-summarizes-azure-time-series-insights-data-retention-and-how-to-plan-for-itbr"></a>В следующем видео представлена сводка по хранению данных службы "аналитика временных рядов Azure" и их планированию.</br>

> [!VIDEO https://www.youtube.com/embed/03x6zKDQ6DU]

Каждая из сред службы "аналитика временных рядов Azure" имеет параметр, который управляет **временем хранения данных**. Это значение охватывает период от 1 до 400 дней. Данные удаляются в зависимости от емкости хранилища среды или продолжительности хранения, в зависимости от того, что происходит раньше.

Кроме того, в среде службы "аналитика временных рядов Azure" **превышено значение параметра поведение хранилища** . Он управляет поведением приема и очистки, когда достигается максимальная емкость среды. При настройке можно выбрать одно из двух поведений:

- **Очистка старых данных** (по умолчанию).  
- **Остановка приема данных**.

> [!NOTE]
> По умолчанию при создании среды для периода удержания настроена **очистка старых данных**. Этот параметр можно переключать по мере необходимости после создания с помощью портал Azure на странице **Настройка** среды службы "аналитика временных рядов Azure".
>
> - Сведения о том, как настроить политики хранения, см. [в статье Настройка хранения в службе "аналитика временных рядов Azure](time-series-insights-how-to-configure-retention.md)".

Обе политики хранения данных подробно описаны ниже.

## <a name="purge-old-data"></a>Очистка старых данных

- **Очистка старых данных** — это значение по умолчанию для сред службы "аналитика временных рядов Azure".  
- **Очистка старых данных** предпочтительнее, когда пользователям нужно всегда иметь актуальные *данные* в среде службы "аналитика временных рядов Azure".
- Параметр **очистить старые данные** *удаляет* данные, когда превышены ограничения среды (время хранения, размер или количество, в зависимости от того, что происходит в первый раз). По умолчанию установлено хранение до 30 дней.
- Самые старые полученные данные очищаются первыми (подход «первым в первом»).

### <a name="example-one"></a>Пример 1

Обратите внимание на пример среды, в которой настроена реакция на событие хранения **Продолжить прием и очищать старые данные**.

Срок **хранения данных** равен 400 дням. Значение **емкости** равно единице S1, которая содержит 30 ГБ общей емкости. Предположим, что входящие данные накапливаются в среднем до 500 МБ каждый день. Эта среда может сохранять данные только 60 дней, учитывая скорость входящих данных, так как максимальная емкость достигается через 60 дней. Входящие данные накапливаются следующим образом: 500 МБ каждый день x 60 дней = 30 ГБ.

В 61st день среда отображает актуальные данные, но очищает самые старые данные старше 60 дней. Очистка позволяет принимать новые потоки данных для изучения. Если пользователь хочет сохранить данные дольше, необходимо увеличить размер среды, добавив дополнительные единицы или отправив меньшее количество данных.  

### <a name="example-two"></a>Пример 2

Обратите внимание на то, что в среде также настроена реакция на событие хранения **Продолжить прием и очищать старые данные**. В этом примере для **времени хранения данных** установлено меньшее значение — 180 дней. Значение **емкости** равно единице S1, которая содержит 30 ГБ общей емкости. Чтобы хранить данные в течение 180 дней, ежедневный прием данных не должен превышать 0,166 ГБ (166 МБ).  

Каждый раз, когда длина ежедневных входящих данных в этой среде превышает 0,166 ГБ в день, данные не могут храниться в течение 180 дней, так как некоторые данные очищаются. Рассмотрим эту же среду в насыщенный интервал времени. Предположим, что скорость входящих данных окружения может увеличиваться до среднего 0,189 ГБ в день. В таком интервале времени сохраняются данные за 158 дней (30 ГБ / 0,189 = 158,73 дней хранения). Это меньше желаемого интервала времени хранения данных.

## <a name="pause-ingress"></a>Остановка приема данных

- Параметр **приостановка** входящих данных предназначен для того, чтобы гарантировать, что данные не очищаются, если достигнут предел размера и количества до их срока хранения.  
- **Приостановка** приема данных предоставляет пользователям дополнительное время на увеличение емкости среды, прежде чем данные очищаются из-за нарушения срока хранения.
- Она помогает защитить вас от потери данных, но может создать возможность потери последних данных, если входные данные приостановлены за пределами срока хранения источника события.
- Однако после достижения максимальной емкости среды Среда приостанавливает передачу данных, пока не будут выполнены следующие дополнительные действия:

  - Вы увеличиваете максимальную емкость среды, чтобы добавить дополнительные единицы масштабирования, как описано в статье [масштабирование среды службы "аналитика временных рядов Azure](time-series-insights-how-to-scale-your-environment.md)".
  - Достигнут срок хранения данных, и данные очищаются, что обеспечивает среду ниже максимальной емкости.

### <a name="example-three"></a>Пример 3

Рассмотрим среду с реакцией хранения на событие, настроенную на **остановку приема данных**. В этом примере **срок хранения данных** составляет 60 дней. Значение **емкости** равно трем (3) единицам S1. Предположим, что в эту среду ежедневно поступает 2 ГБ данных. Прием данных приостанавливается после достижения максимальной емкости.

В это время среда отображает один и тот же набор данных, пока не возобновится входящий трафик или пока не будет включен параметр **продолжить** вход (что приведет к очистке старых данных, чтобы освободить место для новых данных).

Когда прием данных возобновляется:

- Данные передаются в том порядке, в котором они были получены источником событий.
- События индексируются на основе метки времени, если политики хранения в источнике событий не превышены. Дополнительные сведения о конфигурации хранения источника событий см. в статье [Часто задаваемые вопросы о Центрах событий](../event-hubs/event-hubs-faq.md)

> [!IMPORTANT]
> Необходимо установить предупреждения во избежание остановки приема данных. Возможна потеря данных, так как для источников событий Azure хранение по умолчанию составляет 1 день. Поэтому как только прием данных приостановится, самые последние данные будут утеряны. Чтобы это не произошло, сделайте следующее. Увеличьте емкость или переключитесь на реакцию на событие **Очистка старых данных**.

В затронутых концентраторах событий рассмотрите возможность настройки свойства **хранения сообщений** , чтобы снизить потери данных при наведении приостановки в службе "аналитика временных рядов Azure".

[![Хранение сообщений концентратора событий.](media/time-series-insights-concepts-retention/event-hub-retention.png)](media/time-series-insights-concepts-retention/event-hub-retention.png#lightbox)

Если в источнике событий () не настроено ни одного свойства `timeStampPropertyName` , по умолчанию служба "аналитика временных рядов Azure" использует отметку времени прибытия в концентраторе событий в качестве оси X. Если `timeStampPropertyName` настроено что-то другое, среда ищет параметр, настроенный `timeStampPropertyName` в пакете данных при анализе событий.

Узнайте [, как масштабировать среду службы "аналитика временных рядов Azure](time-series-insights-how-to-scale-your-environment.md) ", чтобы масштабировать среду в соответствии с дополнительной емкостью или увеличить продолжительность удержания.

## <a name="next-steps"></a>Дальнейшие действия

- Сведения о настройке и изменении параметров хранения данных см. [в этой статьи](time-series-insights-how-to-configure-retention.md).

- Узнайте, как [снизить задержку в службе "аналитика временных рядов Azure](time-series-insights-environment-mitigate-latency.md)".
