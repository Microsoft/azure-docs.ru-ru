---
title: Модель временных рядов (Azure Time Series Insights) Gen2 | Документация Майкрософт
description: Сведения о модели временных рядов в Gen2 Azure Time Series Insights.
author: deepakpalled
ms.author: dpalled
manager: diviso
ms.workload: big-data
ms.service: time-series-insights
services: time-series-insights
ms.topic: conceptual
ms.date: 01/22/2021
ms.custom: seodec18
ms.openlocfilehash: 37c24f2d785bbdd9847e0dadaa47969f5b090ef2
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101698099"
---
# <a name="time-series-model-in-azure-time-series-insights-gen2"></a>Модель временных рядов в Gen2 "аналитика временных рядов Azure"

В этой статье описывается модель временных рядов, возможности и способы начала создания и обновления собственных моделей в среде Gen2 "аналитика временных рядов Azure".

> [!TIP]
>
> * Перейдите к [демонстрационной среде фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " для примера модели рабочего ряда в реальном времени.
> * Узнайте, [как работать с моделью временных рядов](./how-to-edit-your-model.md) с помощью обозревателя службы "аналитика временных рядов Azure".

## <a name="summary"></a>Итоги

В большинстве случаев данные, собираемые с устройств Интернета вещей, не содержат контекстных сведений, что усложняет поиск и не позволяет быстро анализировать датчики. Основной мотивацией модели временных рядов является упрощение поиска и анализа данных из Интернета вещей или временных рядов. Эта цель достигается за счет включения контроль, обслуживания и обогащения данных временных рядов, чтобы помочь подготовить готовые к отправке наборам данные для анализа.

## <a name="scenario-contosos-new-smart-oven"></a>Сценарий: Новая смарт-печь компании Contoso

**Рассмотрим вымышленный сценарий использования компании Contoso Smart печь.** В этом сценарии предположим, что каждая Интеллектуальная микросхема Contoso имеет пять датчиков температуры, по одному для каждого из четырех ведущих единиц записи и один для самой печь. До последнего времени каждый датчик температуры Contoso отправил, хранит и наглядно выдает данные по отдельности. Для наблюдения за устройством кухни компания Contoso основывалась на базовых диаграммах, по одной на каждый отдельный датчик.

Хотя компания Contoso была удовлетворена первоначальным решением для работы с данными и визуализацией, некоторые ограничения стали очевидными:

* Клиенты хотят узнать, насколько горячий в целом печь, когда в большинстве случаев будут включены самые популярные устройства. Компания Contoso имела больше сложностей при анализе и представлении единого ответа о условиях общей печь.
* Инженеры компании Contoso хотят убедиться, что самые популярные запущенные службы запускаются одновременно, не приведут к неэффективному отображению энергии. Возникли трудности с перекрестным связыванием, какие датчики температуры и напряжения связаны друг с другом и как их можно разместить в хранилище.
* Группа специалистов по контролю качества Contoso хотела проводить аудит и сравнение истории между двумя версиями датчика. Возникли трудности при определении того, какие данные принадлежали к версии датчика.

Без возможности структурировать, упорядочивать и определять модель временных рядов «Smart печь», каждый датчик температуры поддерживает ненайденные, изолированные и менее информативные точки данных. Включение этих точек данных в ценную аналитику было сложнее, так как каждый набор данных был создан независимо от других.

Эти ограничения выявили важность средств агрегирования и визуализации интеллектуальных данных, сопровождающих новую печь компании Contoso:

* Визуализация данных оказывается полезной, если вы можете связать и объединить данные в удобном для просмотра виде. Примером является отображение датчиков напряжения и датчиков температуры.
* Управление многомерными данными для нескольких сущностей вместе с функциями сравнения, масштабирования и временных диапазонов может быть трудно выполнить.

**Модель временных рядов предоставляет удобное решение** для многих сценариев, встречающихся в этом вымышленном примере:

[![Пример создания диаграммы Smart печь модели временных рядов](media/v2-update-tsm/time-series-model-smart-oven.png)](media/v2-update-tsm/time-series-model-smart-oven.png#lightbox)

* Модель временных рядов играет важную роль в запросах и навигации, так как она контекстуализес данные, позволяя выполнять сравнения в пределах временных диапазонов, а также между датчиками и типами устройств. (**A**)
* Данные в дальнейшем контекстуальны, поскольку данные, сохраняемые в модели временных рядов, сохраняют вычисления запросов временных рядов в виде переменных и повторно используют их во время выполнения запроса.
* Модель временных рядов упорядочивает и объединяет данные для улучшения возможностей визуализации и управления. (**Б**)

### <a name="key-capabilities"></a>Ключевые возможности

С целью упрощения и простоты управления контекстом временных рядов модель временных рядов включает следующие возможности в Gen2 Azure Time Series Insights. Она поможет вам в следующих аспектах.

* Создание и Управление вычислениями или формулами с использованием скалярных функций, агрегатных операций и т. д.
* Определите связи типа «родители-потомки», чтобы включить навигацию, Поиск и ссылку.
* Определите свойства, связанные с экземплярами, определенные как *поля экземпляров*, и используйте их для создания иерархий.

### <a name="components"></a>Components

Модель временного ряда содержит три основных компонента:

* [Экземпляры модели временных рядов](#time-series-model-instances)
* [Иерархии моделей временных рядов](#time-series-model-hierarchies)
* [Типы моделей временных рядов](#time-series-model-types)

Эти компоненты объединяются для указания модели временных рядов и организации данных.

[![Обзорная диаграмма модели временных рядов](media/v2-update-tsm/time-series-model-overview.png)](media/v2-update-tsm/time-series-model-overview.png#lightbox)

Модель временных рядов можно создать и управлять с помощью обозревателя службы " [аналитика временных рядов Azure](./concepts-ux-panels.md)". Параметрами модели временных рядов можно управлять через [API параметров модели](/rest/api/time-series-insights/reference-model-apis).

## <a name="time-series-model-instances"></a>Экземпляры моделей временных рядов

*Экземпляры* модели временных рядов являются виртуальными представлениями временных рядов.

В большинстве случаев экземпляры уникально идентифицируются по **deviceId** или **assetId**, которые сохраняются как идентификаторы временных рядов.

Экземпляры имеют описательные сведения, связанные с ними, называемые *свойствами экземпляра*, например идентификатор временных рядов, тип, имя, описание, иерархии и поля экземпляра. Свойства экземпляр содержат, как минимум, сведения об иерархии.

*Поля экземпляра* представляют собой коллекцию описательных сведений, которые могут включать значения для уровней иерархии, а также для производителей, операторов и т. д.

После настройки источника событий для среды Gen2 "аналитика временных рядов Azure" экземпляры автоматически обнаруживаются и создаются в модели временных рядов. Экземпляры можно создавать или обновлять с помощью обозревателя службы "аналитика временных рядов Azure" с помощью запросов модели временных рядов.

[Демонстрационная версия фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " предоставляет несколько примеров динамических экземпляров.

[![Пример экземпляра модели временных рядов](media/v2-update-tsm/time-series-model-instance.png)](media/v2-update-tsm/time-series-model-instance.png#lightbox)

### <a name="instance-properties"></a>Свойства экземпляра

Экземпляры определяются с помощью **тимесериесид**, **typeId**, **Name**, **Description**, **хиерарчидс** и **инстанцефиелдс**. Каждый экземпляр сопоставляется только с одним *типом* и одной или несколькими *иерархиями*.

| Свойство | Описание |
| --- | ---|
| тимесериесид | Уникальный идентификатор временного ряда, с которым связан экземпляр. В большинстве случаев экземпляры уникально идентифицируются свойством, например deviceId или assetId. В некоторых случаях можно использовать более конкретный составной идентификатор, сочетающий до 3 свойств. |
| Типа | Уникальный идентификатор строки с учетом регистра для типа модели временных рядов, с которым связан экземпляр. По умолчанию все обнаруженные новые экземпляры связываются с типом по умолчанию.
| name | Свойство **Name** является необязательным и учитывает регистр. Если **имя** недоступно, по умолчанию используется значение **тимесериесид**. Если указано имя, **тимесериесид** [также](./concepts-ux-panels.md#4-time-series-well)остается доступным в. |
| description; | Текстовое описание экземпляра. |
| хиерарчидс | Определяет, к каким иерархиям принадлежит экземпляр. |
| инстанцефиелдс | Свойства экземпляра и любые статические данные, определяющие экземпляр. Они определяют значения свойств иерархии или неиерархические свойства и в то же время обеспечивают индексацию для выполнения операций поиска. |

> [!NOTE]
> Иерархии строятся с помощью полей экземпляров. Дополнительные **инстанцефиелдс** можно добавить для дальнейших определений свойств экземпляров.

Экземпляры имеют следующее представление JSON:

```JSON
{
  "timeSeriesId": ["PU2"],
  "typeId": "545314a5-7166-4b90-abb9-fd93966fa39b",
  "hierarchyIds": ["95f0a8d1-a3ef-4549-b4b3-f138856b3a12"],
  "description": "Pump #2",
  "instanceFields": {
    "Location": "Redmond",
    "Fleet": "Fleet 5",
    "Unit": "Pump Unit 3",
    "Manufacturer": "Contoso",
    "ScalePres": "0.54",
    "scaleTemp": "0.54"
  }
}
```

> [!TIP]
> Инструкции по созданию, чтению, обновлению и удалению API экземпляра (CRUD) см. в статье о [запросах данных](./concepts-query-overview.md#time-series-model-query-tsm-q-apis) и [документации по API экземпляра](/rest/api/time-series-insights/reference-model-apis#instances-api).

## <a name="time-series-model-hierarchies"></a>Иерархии моделей временных рядов

*Иерархии* модели временных рядов упорядочивают экземпляры, указывая имена свойств и их связи.

Вы можете настроить несколько иерархий в определенной среде Gen2 временных рядов Azure. Экземпляр модели временных рядов может сопоставляться с одной или несколькими иерархиями (отношение "многие ко многим").

[Демонстрация фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " отображает стандартный экземпляр и иерархию типов.

[![Пример иерархии модели временных рядов](media/v2-update-tsm/time-series-model-hierarchies.png)](media/v2-update-tsm/time-series-model-hierarchies.png#lightbox)

### <a name="hierarchy-definition"></a>Определение иерархии

Иерархии определяются по **идентификатору** иерархии, **имени** и **источнику**.

| Свойство | Описание |
| ---| ---|
| идентификатор | Уникальный идентификатор иерархии, используемый, например, при определении экземпляра. |
| name | Строка, используемая для предоставления имени иерархии. |
| source | Указывает организационную иерархию или путь, который является порядком "родители-потомки" в нисходящей иерархии, который пользователи хотят создать. Карта связей родителей и потомков определяет поле экземпляров. |

Иерархии представлены в формате JSON следующим образом:

```JSON
{
  "hierarchies": [
    {
      "id": "6e292e54-9a26-4be1-9034-607d71492707",
      "name": "Location",
      "source": {
        "instanceFieldNames": [
          "state",
          "city"
        ]
      }
    },
    {
      "id": "a28fd14c-6b98-4ab5-9301-3840f142d30e",
      "name": "ManufactureDate",
      "source": {
        "instanceFieldNames": [
          "year",
          "month"
        ]
      }
    }
  ]
}
```

В предыдущем примере JSON:

* `Location` Определяет иерархию с родительским `states` и дочерним `cities` . `location`У каждого из них может быть несколько `states` , которые, в свою очередь, могут иметь несколько `cities` .
* `ManufactureDate` Определяет иерархию с родительским `year` и дочерним `month` . `ManufactureDate`У каждого из них может быть несколько `years` , которые, в свою очередь, могут иметь несколько `months` .

> [!TIP]
> Инструкции по созданию, чтению, обновлению и удалению API-интерфейсов иерархии см. в статье Создание [запросов к данным](concepts-query-overview.md#time-series-model-query-tsm-q-apis) и [Документация по API иерархии](/rest/api/time-series-insights/reference-model-apis#hierarchies-api).

### <a name="hierarchy-example"></a>Пример иерархии

Рассмотрим пример, где в иерархии **H1** находится `building` , `floor` и `room` как часть определения **инстанцефиелднамес** :

```JSON
{
  "id": "aaaaaa-bbbbb-ccccc-ddddd-111111",
  "name": "H1",
  "source": {
    "instanceFieldNames": [
      "building",
      "floor",
      "room"
    ]
  }
}
```

Учитывая поля экземпляра, используемые в предыдущем определении, и несколько временных рядов, атрибуты и значения иерархии отображаются, как показано в следующей таблице.

| Идентификатор временного ряда | Поля экземпляра |
| --- | --- |
| ID1 | "здание" = "1000", "Floor" = "10", "комната" = "55"  |
| ID2 | "здание" = "1000", "комната" = "55" |
| ID3 | "Floor" = "10" |
| ID4 | "здание" = "1000", "Floor" = "10"  |
| ID5 | Не задано ни "сборка", "этаж" или "комната". |

Временные ряды **id1** и **ID4** отображаются как часть иерархии **H1** в обозревателе службы " [аналитика временных рядов Azure](./concepts-ux-panels.md) ", так как они полностью определены и правильно упорядочивают параметры *сборки*, *этажа* и *комнаты* .

Другие классифицируются по *неродительским экземплярам* , так как они не соответствуют указанной иерархии данных.

## <a name="time-series-model-types"></a>Типы моделей временных рядов

*Типы* моделей временных рядов помогают определить переменные или формулы для выполнения вычислений. Типы связаны с конкретным экземпляром.

Один тип может содержать одну или несколько переменных. Например, экземпляр модели временных рядов может иметь тип *датчик температуры*, который состоит из переменных *Средняя температура*, *Минимальная температура* и *Максимальная температура*.

[Демонстрация фермы "Ветер Contoso](https://insights.timeseries.azure.com/preview/samples) " визуализирует несколько типов временных рядов, связанных с соответствующими экземплярами.

[![Пример типа модели временных рядов](media/v2-update-tsm/time-series-model-types.png)](media/v2-update-tsm/time-series-model-types.png#lightbox)

> [!TIP]
> Инструкции по созданию, чтению, обновлению и удалению API типов (CRUD) см. в статье о [запросах данных](concepts-query-overview.md#time-series-model-query-tsm-q-apis) и [документации по API типа](/rest/api/time-series-insights/reference-model-apis#types-api).

### <a name="type-properties"></a>Свойства типа

Типы моделей временных рядов определяются по **идентификатору**, **имени**, **описанию** и **переменным**.

| Свойство | Описание |
| ---| ---|
| идентификатор | Уникальный идентификатор строки с учетом регистра для типа. |
| name | Строка, используемая для предоставления имени типа. |
| description; | Строковое описание типа. |
| variables | Укажите переменные, связанные с типом. |

Типы соответствуют следующему примеру JSON:

```JSON
{
  "types": [
    {
      "id": "1be09af9-f089-4d6b-9f0b-48018b5f7393",
      "name": "DefaultType",
      "description": "Default type",
      "variables": {
        "EventCount": {
          "kind": "aggregate",
          "value": null,
          "filter": null,
          "aggregation": {
            "tsx": "count()"
          }
        },
        "Interpolated Speed": {
          "kind": "numeric",
          "value": {
              "tsx": "$event['Speed-Sensor'].Double"
          },
          "filter": null,
          "interpolation": {
              "kind": "step",
              "boundary": {
                  "span": "P1D"
              }
          },
          "aggregation": {
              "tsx": "right($value)"
          }
        }
      }
    }
  ]
}
```

Типы моделей временных рядов могут иметь множество переменных, задающих правила формул и вычисления для событий. Узнайте больше о [том, как определить переменные модели временных рядов](./concepts-variables.md)

## <a name="next-steps"></a>Дальнейшие действия

* Дополнительные сведения об изменении модели с помощью API см. в справочной документации по [модели временных рядов](/rest/api/time-series-insights/reference-model-apis) .

* Изучите формулы и вычисления, которые можно создать с помощью [переменных модели временных рядов](./concepts-variables.md)

* Дополнительные сведения о [запросах данных](concepts-query-overview.md) в Gen2 службы "аналитика временных рядов Azure"