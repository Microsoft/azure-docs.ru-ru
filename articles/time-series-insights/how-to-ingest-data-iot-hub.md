---
title: Как добавить источник событий центра Интернета вещей в службу "аналитика временных рядов Azure" | Документация Майкрософт
description: Узнайте, как добавить источник событий центра Интернета вещей в среду службы "аналитика временных рядов Azure".
ms.service: time-series-insights
services: time-series-insights
author: deepakpalled
ms.author: dpalled
manager: diviso
ms.reviewer: v-mamcge, jasonh, kfile
ms.workload: big-data
ms.topic: conceptual
ms.date: 01/21/2021
ms.custom: seodec18
ms.openlocfilehash: 85773ec66dbe567afcfd1afca1d14aa0119fb8f6
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "103464026"
---
# <a name="add-an-iot-hub-event-source-to-your-azure-time-series-insight-environment"></a>Добавление источника событий центра Интернета вещей в среду службы "аналитика временных рядов Azure"

Из этой статьи вы узнаете, как с помощью портала Azure добавить в среду службы "Аналитика временных рядов Azure" источник события, который считывает данные из центра Интернета вещей Azure.

> [!NOTE]
> Инструкции, приведенные в этой статье, относятся к средам Azure Time Series Insights Gen 1 и Azure Time Series Insights 2.

## <a name="prerequisites"></a>Предварительные требования

* Создание среды службы " [аналитика временных рядов Azure](./tutorial-set-up-environment.md)".
* Создайте [центр Интернета вещей с помощью портала Azure](../iot-hub/iot-hub-create-through-portal.md).
* В центр Интернета вещей должны отправляться активные события сообщений.
* Создайте выделенную группу потребителей в центре Интернета вещей, из которой будет использоваться среда службы "аналитика временных рядов Azure". Каждый источник событий "аналитика временных рядов Azure" должен иметь собственную выделенную группу потребителей, которая не является общей для других потребителей. Если несколько модулей чтения используют события из одной группы потребителей, все читатели, скорее всего, будут работать с ошибками. Дополнительные сведения см. в статье [Azure IOT для разработчиков](../iot-hub/iot-hub-devguide.md).

### <a name="add-a-consumer-group-to-your-iot-hub"></a>Добавление группы потребителей в Центр Интернета вещей

Группы объектов-получателей используются приложениями для извлечения данных из Центра Интернета вещей Azure. Чтобы обеспечить надежное чтение данных из центра Интернета вещей, предоставьте выделенную группу потребителей, которая используется только в этой среде службы "аналитика временных рядов Azure".

Чтобы добавить группу объектов-получателей в центр Интернета вещей:

1. В [портал Azure](https://portal.azure.com)найдите и откройте центр Интернета вещей.

1. В разделе **Параметры** выберите **встроенные конечные точки**, а затем выберите конечную точку **события** .

   [![На странице встроенных конечных точек нажмите кнопку "События"](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-connect-iot-hub.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-connect-iot-hub.png#lightbox)

1. В разделе **Группы потребителей** введите уникальное имя для группы объектов-получателей. Используйте это же имя в среде службы "аналитика временных рядов Azure" при создании нового источника событий.

1. Щелкните **Сохранить**.

## <a name="add-a-new-event-source"></a>Добавление нового источника событий

1. Войдите на [портал Azure](https://portal.azure.com).

1. В меню слева выберите **Все ресурсы**. Выберите среду службы "аналитика временных рядов Azure".

1. В разделе **Параметры** выберите **источники событий**, а затем нажмите кнопку **добавить**.

   [![Выберите источники событий, а затем нажмите кнопку "Добавить"](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-add-event-source.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-add-event-source.png#lightbox)

1. В области **создать источник события** в поле **имя источника события** введите уникальное для этой среды Azure Time Series Insights имя. Например, введите **event-stream**.

1. Для **источника** выберите **Центр Интернета вещей**.

1. Выберите значение для параметра **Вариант импорта**:

   * Выберите **Использовать Центр Интернета вещей в доступных подписках**, если в одной из ваших подписок уже есть центр Интернета вещей. Этот вариант — самый простой подход.

     [![Выберите параметры в области нового источника событий](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-select-an-import-option.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-select-an-import-option.png#lightbox)

   * В следующей таблице описаны обязательные свойства для варианта **Использовать Центр Интернета вещей в доступных подписках**:

       [![Область нового источника событий — свойства, которые нужно задать при выборе варианта "Использовать Центр Интернета вещей в доступных подписках".](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-create-configure-confirm.png)](media/time-series-insights-how-to-add-an-event-source-iothub/tsi-create-configure-confirm.png#lightbox)

       | Свойство. | Описание |
       | --- | --- |
       | Подписка | Подписка, к которой принадлежит нужный центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя выбранного центра Интернета вещей. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Выберите политику общего доступа. Политику общего доступа можно найти на вкладке Параметры центра Интернета вещей. Каждая политика общего доступа имеет имя, разрешения, заданные пользователем, и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ указывается автоматически. |

   * Выберите **Указать параметры Центра Интернета вещей вручную**, если центр Интернета вещей не входит в вашу подписку или для него нужно указать дополнительные параметры.

      В следующей таблице описаны обязательные свойства при выборе варианта **Указать параметры Центра Интернета вещей вручную**:

       | Свойство. | Описание |
       | --- | --- |
       | Идентификатор подписки | Подписка, к которой принадлежит нужный центр Интернета вещей. |
       | Группа ресурсов | Имя группы ресурсов, в которой создан центр Интернета вещей. |
       | IoT hub name (Имя Центра Интернета вещей) | Имя центра Интернета вещей. При создании центра Интернета вещей вы ввели имя для него. |
       | IoT hub policy name (Имя политики Центра Интернета вещей) | Политика общего доступа. Политику общего доступа можно создать на вкладке Параметры центра Интернета вещей. Каждая политика общего доступа имеет имя, разрешения, заданные пользователем, и ключи доступа. Политика общего доступа для источника событий *должна* иметь разрешения на **подключение службы**. |
       | Ключ политики Центра Интернета вещей | Ключ общего доступа, используемый для аутентификации доступа к пространству имен Служебной шины Azure. Введите первичный или вторичный ключ здесь. |

   * Оба параметра имеют следующие параметры конфигурации:

       | Свойство. | Описание |
       | --- | --- |
       | Группа потребителей Центра Интернета вещей | Группа объектов-получателей, которая считывает события из центра Интернета вещей. Мы настоятельно рекомендуем использовать выделенную группу объектов-получателей для источника событий. |
       | Формат сериализации событий | В настоящее время JSON — это единственный доступный формат сериализации. Сообщения событий должны быть в этом формате, иначе данные не удастся прочитать. |
       | Имя свойства для метки времени | Чтобы определить это значение, необходимо иметь представление о формате данных сообщений, отправляемых в центр Интернета вещей. Это значение представляет собой **имя** определенного свойства события в данных сообщения, которое нужно использовать в качестве метки времени для события. Для этого значения учитывается регистр. Если оставить значение пустым, в качестве метки времени события будет использоваться **время постановки события в очередь** в пределах источника событий. |

1. Добавьте выделенное имя группы потребителей "аналитика временных рядов Azure", добавленное в центр Интернета вещей.

1. Нажмите кнопку **создания**.

1. После создания источника событий служба "аналитика временных рядов Azure" автоматически запускает потоковую передачу данных в вашу среду.

## <a name="next-steps"></a>Следующие шаги

* [Определите политики доступа к данным](./concepts-access-policies.md), чтобы защитить ваши данные.

* [Отправка событий](time-series-insights-send-events.md) в источник событий.

* Доступ к своей среде в [обозревателе службы "аналитика временных рядов Azure](https://insights.timeseries.azure.com)".
