---
title: Включение удаленного графического интерфейса для Linux в Службах лабораторий Azure | Документация Майкрософт
description: Узнайте, как включить удаленный рабочий стол для виртуальных машин Linux в лаборатории в Службах лабораторий Azure.
ms.topic: article
ms.date: 06/26/2020
ms.openlocfilehash: 34c940fec388bb0e79ab5e1db9be6d52fb223873
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94647959"
---
# <a name="enable-graphical-remote-desktop-for-linux-virtual-machines-in-azure-lab-services"></a>Включение удаленного графического интерфейса для виртуальных машин Linux в Службах лабораторий Azure
В этой статье показано, как выполнять следующие задачи:

- Включение удаленного графического интерфейса для виртуальной машины Linux.
- Подключение к виртуальной машине Linux по протоколу удаленного рабочего стола (RDP) или через клиент удаленного рабочего стола X2Go.

## <a name="set-up-graphical-remote-desktop-solution"></a>Настройка решения удаленного графического интерфейса
При создании лаборатории на основе образа **Linux** для нее автоматически настраивается поддержка **SSH** (Secure Shell), чтобы инструктор мог подключиться к виртуальной машине шаблона из командной строки по протоколу SSH.  Аналогичным образом после публикации виртуальной машины шаблона учащиеся могут подключаться к своим виртуальным машинам по протоколу SSH.

Чтобы подключиться к виртуальной машине Linux через **графический пользовательский интерфейс**, мы рекомендуем использовать **RDP** или **X2Go**.  Для обоих вариантов инструктору нужно выполнить на виртуальной машине шаблона дополнительную настройку.

### <a name="rdp-setup"></a>Настройка RDP
Чтобы использовать RDP, инструктор должен выполнить следующее:
  - Включить подключение к удаленному рабочему столу, в частности для того, чтобы открыть на виртуальной машине порт для протокола удаленного рабочего стола.
  - Установить сервер RDP для удаленного рабочего стола.
  - Установить среду графического интерфейса Linux (MATE, XFCE и т. п.).

### <a name="x2go-setup"></a>Настройка X2Go
Чтобы использовать X2Go, инструктор должен выполнить следующее:
- Установить сервер X2Go для удаленного рабочего стола.
- Установить среду графического интерфейса Linux (MATE, XFCE и т. п.).

X2Go использует тот же порт, который уже включен для SSH.  Это означает, что на виртуальной машине не нужно выполнять дополнительных действий для открытия порта X2Go.

> [!NOTE]
> В некоторых случаях, например в Ubuntu LTS 18.04, X2Go обеспечивает лучшую производительность.  Если при работе с RDP вы испытываете задержки во взаимодействии с графическим интерфейсом, попробуйте перейти на X2Go для повышения производительности.

> [!IMPORTANT]
>  В некоторых образах Marketplace уже установлена среда графического интерфейса и сервер удаленного рабочего стола.  Например, [виртуальная машина для обработки и анализа данных для Linux (Ubuntu)](https://azuremarketplace.microsoft.com/marketplace/apps/microsoft-dsvm.ubuntu-1804) уже имеет [XFCE и X2Go Server, установленные и настроенные для подключения клиентов](../machine-learning/data-science-virtual-machine/dsvm-ubuntu-intro.md#x2go).

## <a name="enable-remote-desktop-connection-for-rdp"></a>Разрешение подключения к удаленному рабочему столу для RDP

Этот шаг нужен только для подключений по протоколу RDP.  Если вы планируете вместо него использовать X2Go, сразу переходите к следующему разделу, так как X2Go использует порт SSH.

1.  Во время создания лаборатории инструктор может настроить **Разрешение подключения к удаленному рабочему столу**.  Этот параметр необходимо **включить**, чтобы открыть порт на виртуальной машине Linux, который используется для сеанса удаленного рабочего стола по протоколу RDP.  В противном случае, если этот параметр будет **отключен**, открывается только порт для SSH.
  
    ![Снимок экрана, на котором показано окно "Новая лаборатория" с параметром "включить подключение к удаленному рабочему столу".](./media/how-to-enable-remote-desktop-linux/enable-rdp-option.png)

2. В окне **Разрешение подключения к удаленному рабочему столу** выберите элемент **Продолжить с удаленным рабочим столом**. 

    ![Включение подключения к удаленному рабочему столу для образа Linux](./media/how-to-enable-remote-desktop-linux/enabling-remote-desktop-connection-dialog.png)

## <a name="install-rdp-or-x2go"></a>Установка RDP или X2Go

После создания лаборатории инструктор должен убедиться, что на виртуальной машине шаблона установлены среда графического интерфейса и сервер удаленного рабочего стола.  Прежде всего ему нужно подключиться к виртуальной машине шаблона по SSH, чтобы установить на нее следующие пакеты:
- сервер RDP или X2Go для удаленного рабочего стола;
- среда графического интерфейса Linux (MATE, XFCE и т. п.).

Когда все будет готово, инструктор может подключиться к виртуальной машине шаблона с помощью клиента **Удаленный рабочий стол (Майкрософт) (RDP)** или **X2Go**.

Чтобы настроить виртуальную машину шаблона, выполните следующие шаги.

1. Если на панели инструментов отображается элемент **Настроить шаблон**, выберите его. Затем выберите **Продолжить** в диалоговом окне **Настройка шаблона**. Запустится шаблон виртуальной машины.  

    ![Настройка шаблона](./media/how-to-enable-remote-desktop-linux/customize-template.png)
1. После запуска шаблона виртуальной машины можно выбрать на панели инструментов элемент **Подключение к шаблону**, а затем — элемент **Подключение через SSH**. 

    ![Подключение к шаблону по протоколу RDP после создания лаборатории](./media/how-to-enable-remote-desktop-linux/rdp-after-lab-creation.png) 
1. Отобразится диалоговое окно **Подключение к виртуальной машине**. Возле текстового поля нажмите кнопку **Копировать**, чтобы скопировать его содержимое в буфер обмена. Сохраните сведения о подключении по SSH. Эти сведения позволят подключиться к виртуальной машине из терминала SSH (например, [PuTTY](https://www.putty.org/)).
 
    ![Строка SSH-подключения](./media/how-to-enable-remote-desktop-linux/ssh-connection-string.png)

4. Установите RDP или X2Go вместе с любой средой графического интерфейса на ваш выбор.  Инструкции по этому процессу вы найдете по этим ссылкам:
    - [установка и настройка RDP](../virtual-machines/linux/use-remote-desktop.md);
    - [установка и настройка X2Go](https://github.com/Azure/azure-devtestlab/tree/master/samples/ClassroomLabs/Scripts/X2GoRemoteDesktop).

## <a name="connect-to-the-template-vm-via-the-gui"></a>Подключение к виртуальной машине шаблона через графический пользовательский интерфейс

Когда виртуальная машина шаблона будет готова, инструктор может подключиться к ней через графический пользовательский интерфейс с помощью клиента **Удаленный рабочий стол (Майкрософт) (RDP)** или **X2Go**.  Выбор клиента зависит от того, какой протокол вы настроили на виртуальной машине шаблона в качестве сервера удаленного рабочего стола — RDP или X2Go.  

### <a name="microsoft-remote-desktop-rdp-client"></a>Клиент "Удаленный рабочий стол (Майкрософт)" (RDP)

Клиент "Удаленный рабочий стол (Майкрософт)" (RDP) используется для подключения к виртуальной машине шаблона, на которой настроен протокол RDP.  Этот клиент можно использовать на оборудовании Windows, Chromebook, Mac и т. п.  Дополнительные сведения см. в статье [о клиентах удаленного рабочего стола](/windows-server/remote/remote-desktop-services/clients/remote-desktop-clients).

Выполните описанные ниже действия для того типа компьютера, который вы используете для подключения к виртуальной машине шаблона.

- Windows
  1. Щелкните **Подключение к шаблону** на панели инструментов лаборатории, а затем выберите элемент **Подключение через RDP**, чтобы подключиться к виртуальной машине шаблона. 
  1. Сохраните файл RDP и используйте его для подключения к шаблону виртуальной машины через клиент удаленного рабочего стола. 
  1. Как правило, "Клиент удаленного рабочего стола" уже установлен и настроен в Windows.  А значит, вам достаточно щелкнуть файл RDP, чтобы открыть его и запустить удаленный сеанс.

- Mac
  1. Щелкните **Подключиться к шаблону** на панели инструментов лаборатории, а затем выберите **Подключиться через RDP**, чтобы сохранить RDP-файл.  
  1. После этого выполните инструкции из руководства [Подключение к виртуальной машине с помощью RDP на компьютере Mac](connect-virtual-machine-mac-remote-desktop.md).

- Chromebook
  1. Щелкните **Подключиться к шаблону** на панели инструментов лаборатории, а затем выберите **Подключиться через RDP**, чтобы сохранить RDP-файл.  
  1. После этого выполните инструкции из руководства [Подключение к виртуальной машине с помощью RDP на компьютере Chromebook](connect-virtual-machine-chromebook-remote-desktop.md).

### <a name="x2go-client"></a>Клиент X2Go

Клиент X2Go используется для подключения к виртуальной машине шаблона, на которой настроен протокол X2Go.  Используя сведения о подключении по SSH к виртуальной машине шаблона, выполните действия из руководства [по подключению к виртуальной машине с помощью X2Go](how-to-use-remote-desktop-linux-student.md#connect-to-the-student-vm-using-x2go).

## <a name="next-steps"></a>Дальнейшие действия
После того как инструктор настроит RDP или X2Go на виртуальной машине шаблона и опубликует ее, учащиеся смогут подключаться к своим виртуальным машинам через удаленный графический пользовательский интерфейс или по протоколу SSH.

Дополнительные сведения см. в разделе:
 - [Подключение к виртуальной машине Linux](how-to-use-remote-desktop-linux-student.md)