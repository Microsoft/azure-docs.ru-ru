---
title: Подключение к виртуальной машине Linux с помощью Azure бастиона
description: Из этой статьи вы узнаете, как подключиться к виртуальной машине Linux с помощью Azure бастиона.
services: bastion
author: cherylmc
ms.service: bastion
ms.topic: how-to
ms.date: 02/12/2021
ms.author: cherylmc
ms.openlocfilehash: 5d61c2a1a0f5d7b26809621af6dfa88cf5080320
ms.sourcegitcommit: e972837797dbad9dbaa01df93abd745cb357cde1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100518187"
---
# <a name="connect-using-ssh-to-a-linux-virtual-machine-using-azure-bastion"></a>Подключение по протоколу SSH к виртуальной машине Linux с помощью Azure бастиона

В этой статье показано, как безопасно и легко подключаться по протоколу SSH к виртуальным машинам Linux в виртуальной сети Azure. Подключиться к виртуальной машине можно непосредственно из портал Azure. При использовании Azure бастиона виртуальные машины не нуждаются в клиенте, агенте или дополнительном программном обеспечении. Дополнительные сведения об Azure бастиона см. в [обзоре](bastion-overview.md).

Вы можете использовать Azure бастиона для подключения к виртуальной машине Linux с помощью SSH. Для проверки подлинности можно использовать и имя пользователя, и пароль, и ключи SSH. Подключиться к виртуальной машине с помощью ключей SSH можно одним из следующих способов:

* Закрытый ключ, который вы вводите вручную
* Файл, содержащий сведения о закрытом ключе

Закрытый ключ SSH должен иметь формат, который начинается с  `"-----BEGIN RSA PRIVATE KEY-----"` и заканчивается на `"-----END RSA PRIVATE KEY-----"` .

## <a name="prerequisites"></a>Предварительные требования

Убедитесь, что вы настроили узел бастиона Azure для виртуальной сети, в которой находится виртуальная машина. Дополнительные сведения см. в статье [Создание узла бастиона Azure](./tutorial-create-host-portal.md). После подготовки и развертывания службы бастиона в виртуальной сети ее можно использовать для подключения к любой виртуальной машине в этой виртуальной сети. 

При использовании бастиона для подключения предполагается, что вы используете RDP для подключения к виртуальной машине Windows и SSH для подключения к виртуальным машинам Linux. Сведения о подключении к виртуальной машине Windows см. в статье [Подключение к виртуальной машине](bastion-connect-vm-rdp.md)Windows.

### <a name="required-roles"></a>Обязательные роли

Для подключения нужны такие роли:

* роль читателя на виртуальной машине;
* роль читателя на сетевом адаптере с частным IP-адресом для виртуальной машины;
* роль читателя в ресурсе Бастиона Azure.

### <a name="ports"></a>Порты

Чтобы подключиться к виртуальной машине Linux по протоколу SSH, на виртуальной машине должны быть открыты следующие порты:

* Входящий порт: SSH (22)

## <a name="connect-using-username-and-password"></a><a name="username"></a>Подключение: использование имени пользователя и пароля

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="На снимке экрана показан обзор виртуальной машины в портал Azure с выбранным подключением":::
1. После выбора бастиона появится боковая панель с тремя вкладками: RDP, SSH и бастиона. Если бастиона был подготовлен для виртуальной сети, вкладка бастиона активна по умолчанию. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./tutorial-create-host-portal.md).

   :::image type="content" source="./media/bastion-connect-vm-ssh/bastion.png" alt-text="Снимок экрана: диалоговое окно &quot;подключение к виртуальной машине&quot; с выбранным БАСТИОНА":::
1. Введите имя пользователя и пароль для подключения SSH к виртуальной машине.
1. После ввода ключа нажмите кнопку **подключить** .

## <a name="connect-manually-enter-a-private-key"></a><a name="privatekey"></a>Подключение: ввод закрытого ключа вручную

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="На снимке экрана показан обзор виртуальной машины в портал Azure с выбранным подключением":::
1. После выбора бастиона появится боковая панель с тремя вкладками: RDP, SSH и бастиона. Если бастиона был подготовлен для виртуальной сети, вкладка бастиона активна по умолчанию. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./tutorial-create-host-portal.md).

   :::image type="content" source="./media/bastion-connect-vm-ssh/bastion.png" alt-text="Диалоговое окно &quot;подключение к виртуальной машине&quot; с выбранным БАСТИОНА.":::
1. Введите имя пользователя и выберите **закрытый ключ SSH**.
1. Введите закрытый ключ в текстовое поле **закрытый ключ SSH** (или вставьте его напрямую).
1. После ввода ключа нажмите кнопку **подключить** .

## <a name="connect-using-a-private-key-file"></a><a name="ssh"></a>Подключение: использование файла закрытого ключа

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="Подключение выбрано":::
1. После выбора бастиона появится боковая панель с тремя вкладками: RDP, SSH и бастиона. Если бастиона был подготовлен для виртуальной сети, вкладка бастиона активна по умолчанию. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./tutorial-create-host-portal.md).

   :::image type="content" source="./media/bastion-connect-vm-ssh/bastion.png" alt-text="БАСТИОНА выбрано.":::
1. Введите имя пользователя и выберите **закрытый ключ SSH из локального файла**.
1. Нажмите кнопку **обзора** (значок папки в локальном файле).
1. Найдите файл и нажмите кнопку **Открыть**.
1. Выберите **Подключиться** , чтобы подключиться к виртуальной машине. После нажатия кнопки подключить SSH-подключение к этой виртуальной машине будет открываться непосредственно в портал Azure. Это подключение работает через HTML5 через порт 443 службы бастиона на частном IP-адресе виртуальной машины.

## <a name="connect-using-a-private-key-stored-in-azure-key-vault"></a><a name="akv"></a>Подключение: использование закрытого ключа, хранящегося в Azure Key Vault

>[!NOTE]
>Обновление портала для этой функции в настоящее время выполняется в регионах.
>

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.
1. После выбора бастиона появится боковая панель с тремя вкладками: RDP, SSH и бастиона. Если бастиона был подготовлен для виртуальной сети, вкладка бастиона активна по умолчанию. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](bastion-create-host-portal.md).

   :::image type="content" source="./media/bastion-connect-vm-ssh/bastion.png" alt-text="Вкладка бастиона":::
1. Введите имя пользователя и выберите **закрытый ключ SSH из Azure Key Vault**.
1. Выберите **Azure Key Vault** раскрывающийся список и выберите ресурс, в котором сохранен закрытый ключ SSH. Если вы не настроили Azure Key Vault ресурс, см. раздел [Создание хранилища ключей](../key-vault/general/quick-create-portal.md) и сохранение закрытого ключа SSH в качестве значения нового секрета Key Vault.

   :::image type="content" source="./media/bastion-connect-vm-ssh/key-vault.png" alt-text="Azure Key Vault":::;

Убедитесь, что у вас есть **список** и **получите** доступ к секретам, хранящимся в ресурсе Key Vault. Чтобы назначить и изменить политики доступа для Key Vault ресурса, см. раздел [Назначение политики доступа Key Vault](../key-vault/general/assign-access-policy-portal.md).

1. Выберите раскрывающийся список **Azure Key Vault секрет** и выберите Key Vault секрет, содержащий значение закрытого ключа SSH.
1. Выберите **Подключиться** , чтобы подключиться к виртуальной машине. После нажатия кнопки подключить SSH-подключение к этой виртуальной машине будет открываться непосредственно в портал Azure. Это подключение работает через HTML5 через порт 443 службы бастиона на частном IP-адресе виртуальной машины.

## <a name="next-steps"></a>Дальнейшие шаги

Ознакомьтесь с [часто задаваемыми вопросами о бастиона](bastion-faq.md)
