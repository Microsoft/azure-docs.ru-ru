---
title: Подключение к виртуальной машине Linux с помощью Azure бастиона
description: Из этой статьи вы узнаете, как подключиться к виртуальной машине Linux с помощью Azure бастиона.
services: bastion
author: cherylmc
ms.service: bastion
ms.topic: how-to
ms.date: 02/12/2021
ms.author: cherylmc
ms.openlocfilehash: a5cda5d4d447bc04f853ea4a9abd15be75e7e177
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100588622"
---
# <a name="connect-using-ssh-to-a-linux-virtual-machine-using-azure-bastion"></a>Подключение по протоколу SSH к виртуальной машине Linux с помощью Azure бастиона

В этой статье показано, как безопасно и легко подключаться по протоколу SSH к виртуальным машинам Linux в виртуальной сети Azure. Подключиться к виртуальной машине можно непосредственно из портал Azure. При использовании Azure бастиона виртуальные машины не нуждаются в клиенте, агенте или дополнительном программном обеспечении. Дополнительные сведения об Azure бастиона см. в [обзоре](bastion-overview.md).

Вы можете использовать Azure бастиона для подключения к виртуальной машине Linux с помощью SSH. Для проверки подлинности можно использовать и имя пользователя, и пароль, и ключи SSH. Подключиться к виртуальной машине с помощью ключей SSH можно одним из следующих способов:

* Закрытый ключ, который вы вводите вручную
* Файл, содержащий сведения о закрытом ключе

Закрытый ключ SSH должен иметь формат, который начинается с  `"-----BEGIN RSA PRIVATE KEY-----"` и заканчивается на `"-----END RSA PRIVATE KEY-----"` .

## <a name="prerequisites"></a>Предварительные условия

Убедитесь, что вы настроили узел бастиона Azure для виртуальной сети, в которой находится виртуальная машина. Дополнительные сведения см. в статье [Создание узла бастиона Azure](./tutorial-create-host-portal.md). После подготовки и развертывания службы бастиона в виртуальной сети ее можно использовать для подключения к любой виртуальной машине в этой виртуальной сети. 

При использовании бастиона для подключения предполагается, что вы используете RDP для подключения к виртуальной машине Windows и SSH для подключения к виртуальным машинам Linux. Сведения о подключении к виртуальной машине Windows см. в статье [Подключение к виртуальной машине](bastion-connect-vm-rdp.md)Windows.

### <a name="required-roles"></a>Обязательные роли

Для подключения нужны такие роли:

* роль читателя на виртуальной машине;
* роль читателя на сетевом адаптере с частным IP-адресом для виртуальной машины;
* роль читателя в ресурсе Бастиона Azure.

### <a name="ports"></a>Порты

Чтобы подключиться к виртуальной машине Linux по протоколу SSH, на виртуальной машине должны быть открыты следующие порты:

* Входящий порт: SSH (22)

## <a name="connect-using-username-and-password"></a><a name="username"></a>Подключение: использование имени пользователя и пароля

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="На снимке экрана показан обзор виртуальной машины в портал Azure с выбранным подключением":::
1. После выбора бастиона щелкните **использовать бастиона**. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./quickstart-host-portal.md).
1. На странице **подключение с помощью Azure бастиона** введите **имя пользователя** и **пароль**.

   :::image type="content" source="./media/bastion-connect-vm-ssh/password.png" alt-text="Проверка пароля":::
1. Выберите **Подключиться** , чтобы подключиться к виртуальной машине.

## <a name="connect-manually-enter-a-private-key"></a><a name="privatekey"></a>Подключение: ввод закрытого ключа вручную

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="На снимке экрана показан обзор виртуальной машины в портал Azure с выбранным подключением":::
1. После выбора бастиона щелкните **использовать бастиона**. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./quickstart-host-portal.md).
1. На странице **подключение с помощью Azure бастиона** введите **имя пользователя** и **закрытый ключ SSH**.

   :::image type="content" source="./media/bastion-connect-vm-ssh/ssh-private-key.png" alt-text="Проверка подлинности с закрытым ключом SSH":::
1. Введите закрытый ключ в текстовое поле **закрытый ключ SSH** (или вставьте его напрямую).
1. Выберите **Подключиться** , чтобы подключиться к виртуальной машине.

## <a name="connect-using-a-private-key-file"></a><a name="ssh"></a>Подключение: использование файла закрытого ключа

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="На снимке экрана показан обзор виртуальной машины в портал Azure с выбранным подключением":::
1. После выбора бастиона щелкните **использовать бастиона**. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./quickstart-host-portal.md).
1. На странице **подключение с помощью Azure бастиона** введите **имя пользователя** и **закрытый ключ SSH из локального файла**.

   :::image type="content" source="./media/bastion-connect-vm-ssh/private-key-file.png" alt-text="Файл закрытого ключа SSH":::

1. Найдите файл и нажмите кнопку **Открыть**.
1. Выберите **Подключиться** , чтобы подключиться к виртуальной машине. После нажатия кнопки подключить SSH-подключение к этой виртуальной машине будет открываться непосредственно в портал Azure. Это подключение работает через HTML5 через порт 443 службы бастиона на частном IP-адресе виртуальной машины.

## <a name="connect-using-a-private-key-stored-in-azure-key-vault"></a><a name="akv"></a>Подключение: использование закрытого ключа, хранящегося в Azure Key Vault

>[!NOTE]
>Обновление портала для этой функции в настоящее время выполняется в регионах.
>

1. Откройте [портал Azure](https://portal.azure.com). Перейдите к виртуальной машине, к которой необходимо подключиться, а затем нажмите кнопку **подключить** и выберите **бастиона** в раскрывающемся списке.

   :::image type="content" source="./media/bastion-connect-vm-ssh/connect.png" alt-text="На снимке экрана показан обзор виртуальной машины в портал Azure с выбранным подключением":::
1. После выбора бастиона щелкните **использовать бастиона**. Если вы не подготовили бастиона для виртуальной сети, см. статью [Настройка бастиона](./quickstart-host-portal.md).
1. На странице **подключение с помощью Azure бастиона** введите **имя пользователя** и выберите **закрытый ключ SSH из Azure Key Vault**.

   :::image type="content" source="./media/bastion-connect-vm-ssh/ssh-key-vault.png" alt-text="Закрытый ключ SSH из Azure Key Vault":::
1. Выберите **Azure Key Vault** раскрывающийся список и выберите ресурс, в котором сохранен закрытый ключ SSH. Если вы не настроили Azure Key Vault ресурс, см. раздел [Создание хранилища ключей](../key-vault/general/quick-create-portal.md) и сохранение закрытого ключа SSH в качестве значения нового секрета Key Vault.

   :::image type="content" source="./media/bastion-connect-vm-ssh/key-vault.png" alt-text="Azure Key Vault":::;

   Убедитесь, что у вас есть **список** и **получите** доступ к секретам, хранящимся в ресурсе Key Vault. Чтобы назначить и изменить политики доступа для Key Vault ресурса, см. раздел [Назначение политики доступа Key Vault](../key-vault/general/assign-access-policy-portal.md).
1. Выберите раскрывающийся список **Azure Key Vault секрет** и выберите Key Vault секрет, содержащий значение закрытого ключа SSH.
1. Выберите **Подключиться** , чтобы подключиться к виртуальной машине. После нажатия кнопки подключить SSH- **Подключение** к этой виртуальной машине будет открываться непосредственно в портал Azure. Это подключение работает через HTML5 через порт 443 службы бастиона на частном IP-адресе виртуальной машины.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об Azure бастиона см. в разделе [часто задаваемые вопросы о бастиона](bastion-faq.md). 
