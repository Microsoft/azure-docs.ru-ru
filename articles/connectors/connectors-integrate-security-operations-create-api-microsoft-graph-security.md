---
title: Интеграция и управление операциями безопасности & Microsoft Graph безопасность
description: Улучшите защиту от угроз, обнаружение и реагирование на приложения с помощью Microsoft Graph & безопасности Azure Logic Apps
services: logic-apps
ms.suite: integration
author: ecfan
ms.author: preetikr
ms.reviewer: v-ching, estfan, logicappspm
ms.topic: article
ms.date: 02/21/2020
tags: connectors
ms.openlocfilehash: a83cd68df2f1d722517d6239bf6959075860d0b8
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "94888544"
---
# <a name="improve-threat-protection-by-integrating-security-operations-with-microsoft-graph-security--azure-logic-apps"></a>Улучшение защиты от угроз путем интеграции операций обеспечения безопасности с Microsoft Graph Security — Azure Logic Apps

С помощью [Azure Logic Apps](../logic-apps/logic-apps-overview.md) и соединителя [Microsoft Graph Security](/graph/security-concept-overview) можно улучшить эффективность обнаружения угроз вашего приложения, защиты от них и реагирования на них, создав автоматизированные рабочие процессы для интеграции продуктов безопасности, служб и партнеров корпорации Майкрософт. Например, вы можете создавать [сборники схем Центра безопасности Azure](../security-center/workflow-automation.md), которые отслеживают и управляют объектами Microsoft Graph Security, такими как оповещения. Ниже приведены некоторые сценарии, поддерживаемые соединителем безопасности Microsoft Graph.

* Получение оповещений на основе запросов или по идентификатору оповещения. Например, можно получить список с оповещениями высокой степени серьезности.

* Обновление оповещений. Например, можно обновить назначения оповещений, добавить комментарии к оповещениям или пометить оповещения с помощью тегов.

* Мониторинг создания или изменения оповещений путем создания [подписок на оповещения (веб-перехватчики)](/graph/api/resources/webhooks).

* Управление подписками на оповещения. Например, можно получить активные подписки, продлить их срок действия или удалить.

Рабочий процесс приложения логики может использовать действия, которые получают ответы от соединителя Microsoft Graph Security и делают эти выходные данные доступными для других действий в рабочем процессе. Вы также можете применять другие действия в рабочем процессе, используя выходные данные из действий соединителя Microsoft Graph Security. Например, при получении предупреждений с высоким уровнем серьезности с помощью соединителя Microsoft Graph Security их можно отправить в сообщении электронной почты с использованием соединителя Outlook. 

Дополнительные сведения о безопасности Microsoft Graph см. в статье [Обзор API безопасности Microsoft Graph](/graph/security-concept-overview). Если вы не знакомы с приложениями логики, ознакомьтесь с [Azure Logic Apps?](../logic-apps/logic-apps-overview.md). Если вы ищете Power автоматизировать или PowerApps, см. статью что такое Power [автоматизиру?](https://flow.microsoft.com/) или [что такое Power Apps?](https://powerapps.microsoft.com/)

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, [зарегистрируйтесь для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/). 

* Чтобы использовать соединитель Microsoft Graph Security, необходимо *явно предоставить* согласие администратора клиента Azure Active Directory (AD), которое является частью [требований проверки подлинности Microsoft Graph Security](/graph/security-authorization). Для этого согласия требуется идентификатор и имя приложения соединителя Microsoft Graph Security, которые также можно найти на портале [Azure](https://portal.azure.com).

  | Свойство. | Значение |
  |----------|-------|
  | **Имя приложения** | `MicrosoftGraphSecurityConnector` |
  | **Идентификатор приложения** | `c4829704-0edc-4c3d-a347-7c4a67586f3c` |
  |||

  Чтобы предоставить согласие для соединителя, администратор клиента Azure AD может выполнить следующие действия:

  * [Предоставить согласие администратора клиента для приложений Azure AD](../active-directory/develop/v2-permissions-and-consent.md).

  * Во время первого запуска приложения логики приложение может запросить согласие у администратора клиента Azure AD с помощью [интерфейса согласия на применение](../active-directory/develop/application-consent-experience.md).
   
* Базовые знания [создания приложений логики](../logic-apps/quickstart-create-first-logic-app-workflow.md).

* Приложение логики, в котором требуется получить доступ к объектам Microsoft Graph Security, например оповещениям. Чтобы использовать триггер безопасности Microsoft Graph, требуется пустое приложение логики. Для использования Microsoft Graph действия по обеспечению безопасности требуется приложение логики, которое начинается с соответствующего триггера для вашего сценария.

## <a name="connect-to-microsoft-graph-security"></a>Подключение к Microsoft Graph Security 

[!INCLUDE [Create connection general intro](../../includes/connectors-create-connection-general-intro.md)]

1. Войдите на [портал Azure](https://portal.azure.com/) и откройте свое приложение логики в конструкторе приложений логики, если оно еще не открыто.

1. Для пустых приложений логики добавьте триггер и все необходимые действия перед добавлением Microsoft Graph действия по обеспечению безопасности.

   -или-

   Для существующих приложений логики на последнем шаге, куда необходимо добавить Microsoft Graph действия по обеспечению безопасности, выберите **новый шаг**.

   -или-

   Чтобы добавить действие между шагами, переместите указатель на стрелку между шагами. Выберите отображаемый знак плюса (+) и щелкните **Добавить действие**.

1. В поле поиска введите "microsoft graph security" в качестве фильтра. В списке действий выберите любое необходимое действие.

1. Войдите, используя учетные данные безопасности Microsoft Graph Security.

1. Укажите необходимые сведения для выбранного действия и продолжайте создание рабочего процесса приложения логики.

## <a name="add-triggers"></a>Добавить триггеры

В Azure Logic Apps каждое приложение логики должно запускаться по [триггеру](../logic-apps/logic-apps-overview.md#logic-app-concepts), который активируется, когда происходит определенное событие или если выполняются заданные условия. Каждый раз, когда срабатывает триггер, обработчик Logic Apps создает экземпляр приложения логики и начинает выполнение рабочего процесса приложения.

> [!NOTE] 
> При срабатывании триггера триггер обрабатывает все новые оповещения. Если оповещения не получены, запуск триггера пропускается. Следующий опрос триггера происходит на основе интервала повторения, указанного в свойствах триггера.

В этом примере показано, как можно запустить рабочий процесс приложения логики при отправке новых оповещений в приложение.

1.  В портал Azure или Visual Studio создайте пустое приложение логики, которое открывает Конструктор приложений логики. В этом примере используется портал Azure.

1.  В конструкторе в поле поиска введите "Microsoft Graph Security" в качестве фильтра. В списке триггеры выберите этот триггер: **для всех новых оповещений** .

1.  В триггере укажите сведения об оповещениях, которые требуется отслеживать. Для получения дополнительных свойств откройте список **Добавить новый параметр** и выберите параметр, чтобы добавить это свойство в триггер.

   | Свойство. | Свойство (JSON) | Обязательно | Тип | Описание |
   |----------|-----------------|----------|------|-------------|
   | **Интервал** | `interval` | Да | Целое число | Положительное целое число, которое описывает, как часто выполняется рабочий процесс с учетом заданной частоты. Ниже приведены минимальный и максимальный интервалы. <p><p>— Месяц: 1–16 месяцев; <br>— День: 1–500 дней; <br>— Час: 1–12 000 часов; <br>— Минута: 1–72 000 минут; <br>— Секунда: 1–9 999 999 секунд. <p>Например, если интервал равен 6, а значение частоты — "Месяц", то повтор будет происходить каждые 6 месяцев. |
   | **Частота** | `frequency` | Да | Строка | Единица времени для повторения: **Секунда**, **Минута**, **Час**, **День**, **Неделя** или **Месяц**. |
   | **Часовой пояс** | `timeZone` | нет | Строка | Применяется только при указании времени начала, так как этот триггер не принимает [смещение от UTC](https://en.wikipedia.org/wiki/UTC_offset). Выберите часовой пояс, который необходимо применить. |
   | **Время начала** | `startTime` | нет | Строка | Укажите дату и время начала в следующем формате: <p><p>ГГГГ-ММ-ДДTчч:мм:сс, если выбран часовой пояс <p>-или- <p>ГГГГ-ММ-ДДTчч:мм:ссZ, если часовой пояс не выбран. <p>Например, если вы хотите 18 сентября 2017 в 2:00 PM, укажите "2017-09-18T14:00:00" и выберите часовой пояс, например тихоокеанское время (зима). Или укажите 2017-09-18T14:00:00Z без часового пояса. <p>**Примечание.** Время начала не может превышать 49 лет в будущем. оно должно соответствовать [спецификации даты и времени ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations) в [формате даты и времени](https://en.wikipedia.org/wiki/Coordinated_Universal_Time)в формате UTC, но без [смещения в формате UTC](https://en.wikipedia.org/wiki/UTC_offset). Если вы не выберите часовой пояс, то необходимо в конце добавить букву Z без пробелов. Эта буква Z ссылается на соответствующее [судовое время](https://en.wikipedia.org/wiki/Nautical_time). <p>В простых расписаниях время начала определяет первый случай выполнения задания, а в сложных расписаниях триггер срабатывает не раньше, чем наступит время начала. [*Как можно использовать дату и время начала?*](../logic-apps/concepts-schedule-automated-recurring-tasks-workflows.md#start-time) |
   ||||||

1.  По завершении нажмите кнопку **Сохранить** на панели инструментов конструктора.

1.  Теперь продолжайте добавлять действия в приложение логики для задач, которые необходимо выполнить с результатами триггера.

## <a name="add-actions"></a>Добавление действий

Ниже приведены более подробные сведения об использовании различных действий, доступных с помощью соединителя Microsoft Graph Security.

### <a name="manage-alerts"></a>Управление оповещениями

Чтобы отфильтровать, отсортировать или получить последние результаты, предоставьте *только* параметры запроса [ODATA, поддерживаемые Microsoft Graph](/graph/query-parameters). *Не указывайте* полный базовый URL-адрес или действие HTTP, например, `https://graph.microsoft.com/v1.0/security/alerts`, операцию `GET` или `PATCH`. Ниже приведен конкретный пример, который показывает параметры для действия **Получение оповещений**, когда требуется получить список с оповещениями с высокой степенью серьезности.

`Filter alerts value as Severity eq 'high'`

Дополнительные сведения о запросах, которые можно использовать с этим соединителем, см. в справочной документации по [оповещениям Microsoft Graph Security](/graph/api/alert-list). Чтобы улучшить взаимодействие с этим соединителем, узнайте больше об [оповещениях свойств схемы](/graph/api/resources/alert), поддерживаемых соединителем.

| Действие | Описание |
|--------|-------------|
| **Получение оповещений** | Получение предупреждений, отфильтрованных на основе одного или нескольких [свойств предупреждения](/graph/api/resources/alert), например `Provider eq 'Azure Security Center' or 'Palo Alto Networks'` . | 
| **Получение оповещения по идентификатору** | Получение определенного оповещения на основе идентификатора. | 
| **Обновить оповещение** | Обновление определенного оповещения на основе его идентификатора. Чтобы убедиться, что вы передаете требуемые и редактируемые свойства в запросе, см. [эту статью](/graph/api/alert-update). Например, чтобы назначить оповещение аналитику по системам безопасности для проведения расследования, можно обновить свойство оповещения **Кому назначено**. |
|||

### <a name="manage-alert-subscriptions"></a>Управление подписками на оповещения

Microsoft Graph поддерживает [*подписки*](/graph/api/resources/subscription) или [*веб-перехватчики*](/graph/api/resources/webhooks). Чтобы получить, обновить или удалить подписки, введите параметры запроса [ODATA, поддерживаемые Microsoft Graph](/graph/query-parameters), в конструкцию сущности Microsoft Graph и включите в нее `security/alerts`, а затем — запрос ODATA. *Не следует включать* базовый URL-адрес, например `https://graph.microsoft.com/v1.0`. Вместо этого используйте формат из данного примера:

`security/alerts?$filter=status eq 'NewAlert'`

| Действие | Описание |
|--------|-------------|
| **Создание подписок** | [Создайте подписку](/graph/api/subscription-post-subscriptions), уведомляющую о любых изменениях. В этой подписке можно отфильтровать определенные типы оповещений. Например, можно создать подписку, уведомляющую об оповещениях с высокой степенью серьезности. |
| **Получение активных подписок** | [Получает активные подписки](/graph/api/subscription-list). | 
| **Обновить подписку** | [Обновляет подписку](/graph/api/subscription-update), предоставив ее идентификатор. Например, чтобы продлить подписку, можно обновить свойство подписки `expirationDateTime`. | 
| **Удалить подписку** | [Удаляет подписку](/graph/api/subscription-delete), предоставив ее идентификатор. | 
||| 

### <a name="manage-threat-intelligence-indicators"></a>Управление индикаторами аналитики угроз

Чтобы отфильтровать, отсортировать или получить последние результаты, предоставьте *только* параметры запроса [ODATA, поддерживаемые Microsoft Graph](/graph/query-parameters). *Не указывайте* полный базовый URL-адрес или действие HTTP, например, `https://graph.microsoft.com/beta/security/tiIndicators`, операцию `GET` или `PATCH`. Ниже приведен конкретный пример, в котором показаны параметры для действия **Get тииндикаторс** , если требуется список с `DDoS` типом угрозы:

`Filter threat intelligence indicator value as threatType eq 'DDoS'`

Дополнительные сведения о запросах, которые можно использовать с этим соединителем, см. [в разделе «необязательные параметры запроса» в справочной документации по индикатору Microsoft Graph безопасности для анализа угроз](/graph/api/tiindicators-list). Чтобы создать расширенные возможности этого соединителя, ознакомьтесь с дополнительными сведениями о [свойствах схемы](/graph/api/resources/tiindicator) , которые поддерживает соединитель.

| Действие | Описание |
|--------|-------------|
| **Получение индикаторов аналитики угроз** | Get Тииндикаторс Filtered на основе одного или нескольких [свойств тииндикатор](/graph/api/resources/tiindicator), например `threatType eq 'MaliciousUrl' or 'DDoS'` |
| **Получить индикатор аналитики угроз по ИДЕНТИФИКАТОРу** | Получение конкретного Тииндикатора на основе идентификатора Тииндикатор. | 
| **Создать индикатор для аналитики угроз** | Создайте новый Тииндикатор путем отправки в коллекцию Тииндикаторс. Чтобы убедиться, что в запросе передаются необходимые свойства, ознакомьтесь со свойствами, [необходимыми для создания тииндикатор](/graph/api/tiindicators-post). |
| **Отправка нескольких индикаторов аналитики угроз** | Создавайте несколько новых Тииндикаторс, публикуя коллекцию Тииндикаторс. Чтобы убедиться, что в запросе передаются обязательные свойства, см. [свойства, необходимые для отправки нескольких тииндикаторс](/graph/api/tiindicator-submittiindicators). |
| **Обновить индикатор аналитики угроз** | Обновите определенную Тииндикатор на основе идентификатора Тииндикатор. Чтобы обеспечить передачу требуемых и редактируемых свойств в запросе, см. раздел [редактируемые свойства для тииндикатор](/graph/api/tiindicator-update). Например, чтобы обновить действие, применяемое при сопоставлении индикатора в средстве безопасности Таржетпродукт, можно обновить свойство **Action** тииндикатор. |
| **Обновление нескольких индикаторов аналитики угроз** | Обновление нескольких Тииндикаторс. Чтобы обеспечить передачу обязательных свойств в запросе, ознакомьтесь со [свойствами, необходимыми для обновления нескольких тииндикаторс](/graph/api/tiindicator-updatetiindicators). |
| **Удалить индикатор аналитики угроз по ИДЕНТИФИКАТОРу** | Удаление определенного Тииндикатор на основе идентификатора Тииндикатор. |
| **Удаление нескольких индикаторов аналитики угроз по идентификаторам** | Удалите несколько Тииндикаторс по идентификаторам. Чтобы убедиться, что в запросе передаются необходимые свойства, ознакомьтесь со свойствами, [необходимыми для удаления нескольких тииндикаторс по идентификаторам](/graph/api/tiindicator-deletetiindicators). |
| **Удаление нескольких индикаторов логики операций с угрозами по внешним идентификаторам** | Удалите несколько Тииндикаторс по внешним идентификаторам. Чтобы убедиться, что в запросе передаются необходимые свойства, ознакомьтесь со свойствами, [необходимыми для удаления нескольких тииндикаторс по внешним идентификаторам](/graph/api/tiindicator-deletetiindicatorsbyexternalid). |
|||

## <a name="connector-reference"></a>Справочник по соединителям

Дополнительные технические сведения о триггерах, действиях и ограничениях, которые приведены в описании OpenAPI соединителя (прежнее название — Swagger), можно найти на [странице справки](/connectors/microsoftgraphsecurity/) соединителя.

## <a name="next-steps"></a>Дальнейшие действия

См. дополнительные сведения о других [соединителях Logic Apps](../connectors/apis-list.md).
