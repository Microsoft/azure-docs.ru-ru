---
title: Развертывание Micro Focus Enterprise Server 5,0 в AKS | Документация Майкрософт
description: Перемещайте рабочие нагрузки мэйнфреймов IBM z/OS с помощью среды разработки и тестирования Micro Focus на виртуальных машинах Azure.
services: virtual-machines
documentationcenter: ''
author: maggsl
ms.author: edprice
manager: edprice
editor: edprice
ms.topic: conceptual
ms.date: 06/29/2020
tags: ''
keywords: ''
ms.service: multiple
ms.openlocfilehash: 9e5b3857c2252a939080206fb1f92cc422f326fc
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102564362"
---
# <a name="deploy-micro-focus-enterprise-server-50-to-aks"></a>Развертывание Micro Focus Enterprise Server 5,0 в AKS

В другой [статье](./run-enterprise-server-container.md)я принимаю инструкции по запуску Micro Focus Enterprise Server 5,0 в контейнере DOCKER. В качестве дальнейших действий я хотел бы продемонстрировать, как сделать это на один шаг дальше и развернуть созданный образ DOCKER в службе Azure Kubernetes Service (AKS).

Служба Kubernetes Azure — это управляемая служба оркестрации на основе Kubernetes. Она позволяет развертывать, масштабировать и управлять контейнерами DOCKER (и другими приложениями на основе контейнеров) в кластере узлов контейнеров.

Это процесс в три этапа. Для этого необходимо:

1.  Создайте реестр контейнеров Azure для хранения образа DOCKER.

2.  Создайте кластер Azure Kubernetes для запуска образа DOCKER.

3.  Запустите приложение.

Это позволяет масштабировать (и масштабировать) рабочие нагрузки модернизации мэйнфрейма в Azure, выполнив истинное преимущество облачной платформы.

Всё? Давайте начнем!

## <a name="create-the-azure-container-registry"></a>Создание реестра контейнеров Azure

В портал Azure выберите **создать ресурс** в левом верхнем углу. На панели мониторинга Marketplace выберите **контейнеры,** а затем **Реестр контейнеров**. Откроется панель **Реестр создание контейнера** , в которой необходимо ввести **имя реестра**, **подписку Azure**, **группу ресурсов** и **Расположение**. Необходимо разрешить **имя реестра** , поэтому оно должно быть уникальным. Выберите **группу ресурсов** , которая использовалась в предыдущей записи блога, и то же соответствующее **Расположение**. Выберите **включить** для **учетной записи администратора** и **базовый** для **номера SKU**. После заполнения всех элементов выберите **создать**.

![Создание интерфейса реестра контейнеров](media/deploy-image-1.png)

После развертывания реестра выберите **Переход к ресурсу**. Откроется Главная Колонка для реестра контейнеров Azure. Приятной функцией является пункт меню **быстрое начало** . Выберите его, и вы увидите инструкции по отправке и получению образов в реестр. Давайте проверим:

1.  **Установка DOCKER** — вам не нужно беспокоиться об этом, так как это уже сделано.

2.  **Запустите базовый образ "Hello-World"** — опять же, это необязательно, но вы можете попробовать его.

3.  **Войдите в реестр контейнеров** — это необходимо сделать на виртуальной машине. Скопируйте команду в буфер обмена или в Блокнот.

    Для созданного мною реестра используется команда: **DOCKER login acrmf50.azurecr.IO**

4.  **Принудительная отправка в реестр** — это необходимо сделать для образа Micro Focus, а затем войти в виртуальную машину.

5.  **Извлекать из реестра** — это не имеет значения для этого пошагового руководства, но хорошо знать, нужно ли запускать другой образ DOCKER.

Прежде чем покинуть портал, необходимо получить учетные данные для реестра, чтобы можно было выполнить вход. Выйдите из колонки **быстрое начало** и выберите **ключи доступа** в меню Реестр. Скопируйте **имя пользователя** и один из **паролей** (два) в буфер обмена или в Блокнот. Они потребуются позже для входа в систему.

Теперь, когда вы уверены, что нужно сделать, войдите на виртуальную машину.

## <a name="rdp-to-the-virtual-machine-you-used-to-create-the-docker-image"></a>Подключение RDP к виртуальной машине, использованной для создания образа DOCKER

Так как вы уже создали образ DOCKER на сервере Windows 2016, необходимо войти в эту виртуальную машину. Из этой виртуальной машины вы можете отправить образ в только что созданный реестр контейнеров Azure. Перейдите к виртуальной машине в портал Azure, а затем выберите **Обзор** и **подключитесь**. При этом вы подключаетесь к виртуальной машине через протокол удаленного рабочего стола (RDP). При создании виртуальной машины необходимо использовать учетные данные.

## <a name="log-in-and-push-the-image-to-the-registry"></a>Войдите и отправьте образ в реестр.

После входа откройте командную строку и запустите следующие команды docker:

-   **образы DOCKER** — отображает список всех установленных на данный момент образов на виртуальной машине. Запишите значение **микрофокуса/ES-акктдемо** , так как это тот, с которым вы будете работать.

-   **имя входа docker acrmf50.azurecr.IO** — правильный формат: *имя входа \<registry name\> DOCKER*. Замените имя, использованное при создании реестра.

    -   Вам потребуется **имя пользователя** и **пароль** , скопированные из портал Azure. Должно отобразиться примерно следующее:

    ![Снимок экрана командной строки администратора](media/deploy-image-2.png)

-   **маркер DOCKER, микрофокус или ES-акктдемо acrmf50.azurecr.IO/ES-acctdemo — этот тег подкрепляет** соответствующий образ с именем репозитория. **Примечание**. Если имя не \<microfocus/es-acctdemo\> работает, попробуйте использовать полный идентификатор образа. После выполнения команды введите **Images DOCKER — No-TRUNC**. Вы должны увидеть нечто вроде следующего изображения. Обратите внимание, что изображение правильно помечено.

    ![Выбор экрана командной строки администратора](media/deploy-image-3.png)

-   **DOCKER push acrmf50.azurecr.IO/ES-acctdemo** — это запускает фактическую передачу в репозиторий. Поскольку размер равен 15 ГБ, выполнение займет несколько минут. Если все происходит правильно, вы увидите нечто вроде следующего изображения.

    ![Экран командной строки администратора](media/deploy-image-4.png)

Теперь вернитесь к портал Azure, в частности к **репозиторию**. В меню **репозитория** выберите **репозитории**, и вы увидите список **ES-акктдемо** . Теперь создайте кластер AKS.

## <a name="create-the-azure-kubernetes-aks-cluster"></a>Создание кластера Azure Kubernetes (AKS)

В портал Azure выберите **создать ресурс** , а затем **контейнеры или служба Kubernetes** в меню **Marketplace** . Затем необходимо заполнить колонку **Создание кластера Kubernetes** . Не забудьте хранить кластер в том же регионе и группе ресурсов, которые использовались. Можно принять остальные значения по умолчанию, за исключением **количества узлов,** которое должно быть равно 1. Когда все будет готово, нажмите кнопку **Просмотр и создание**.

![Экран создания кластера Kubernetes](media/deploy-image-5.png)

По завершении развертывания будут размещены артефакты **службы Kubernetes** в **группе ресурсов** , выбранной в колонке. Однако фактический кластер будет иметь собственную группу ресурсов, созданную во время развертывания. Если в меню слева выбрать **группы ресурсов** , их можно найти на основе соглашения об именовании. Вот изображение My — это последнее в списке.

![Снимок экрана: группы ресурсов](media/deploy-image-6.png)

**Запуск образа**

Пришло время извлечь изображение и запустить его в AKS. Самый простой способ сделать это из портал Azure — использовать Cloud Shell. Значок находится в правом верхнем углу портал Azure. Обратите внимание, что в этом пошаговом руководстве я использую оболочку Bash.

![Снимок экрана значка Cloud Shell](media/deploy-image-7.png)

После загрузки оболочки введите следующую команду:

**kubectl запуск ES-акктдемо--Image acrmf50.azurecr.io/es-acctdemo--Port = 9040**

Это извлекает образ из репозитория **acrmf50.azurecr.IO** и загружает его в AKS. Затем он запускает образ с открытым портом 9040. Вы можете вспомнить, что этот порт был открыт для образа DOCKER. Требуется для доступа к корпоративному серверу.

Kubernetes должен реагировать на сообщение о том, что развертывание было создано.

![Снимок экрана сообщения о развертывании](media/deploy-image-8.jpg)

Чтобы проверить, работает ли контейнер, введите: **kubectl Get** Pods.

Вы должны увидеть ES-акктдемо как выполняющийся модуль Pod, как показано на следующем рисунке.

![Снимок экрана ES — акктдемо как выполняющийся модуль](media/deploy-image-9.png)

Поздравляем! Теперь вы используете Enterprise Server в службе Azure Kubernetes. В следующей статье я покажу, как получить доступ к административной консоли Enterprise Server, а также как использовать Kubernetes для масштабирования развертывания.
