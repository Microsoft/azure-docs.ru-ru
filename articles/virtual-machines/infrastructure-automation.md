---
title: Использование средств автоматизации инфраструктуры
description: Узнайте, как использовать средства автоматизации инфраструктуры, такие как Ansible, Chef, Puppet, terraform и Pack, для создания виртуальных машин в Azure и управления ими.
author: cynthn
ms.service: virtual-machines
ms.topic: conceptual
ms.workload: infrastructure
ms.date: 07/17/2020
ms.author: cynthn
ms.openlocfilehash: a20c19c3da89801570ca4d74a646e3cf0d8434b6
ms.sourcegitcommit: b39cf769ce8e2eb7ea74cfdac6759a17a048b331
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2021
ms.locfileid: "98675908"
---
# <a name="use-infrastructure-automation-tools-with-virtual-machines-in-azure"></a>Использование средств автоматизации инфраструктуры на виртуальных машинах в Azure

Средства автоматизации, как правило, позволяют быстро и согласованно создавать виртуальные машины Azure в нужном масштабе, а также управлять ими. Существует множество средств и решений, которые помогают полностью автоматизировать жизненный цикл развертывания и администрирования инфраструктуры Azure. В этой статье приведены сведения о некоторых средствах автоматизации инфраструктуры Azure. Обычно их используют с такими целями:

- Автоматизация настройки виртуальных машин:
    - К средствам относятся [Ansible](#ansible), [Chef](#chef), [Puppet](#puppet)и [шаблон Azure Resource Manager](#azure-resource-manager-template).
    - средства для настройки определенных виртуальных машин, например [cloud-init](#cloud-init) для виртуальных машин Linux, [PowerShell Desired State Configuration (DSC)](#powershell-dsc) и [расширение пользовательских скриптов Azure](#azure-custom-script-extension) для всех виртуальных машин Azure.

- Автоматизация управления инфраструктурой:
    - средства автоматизации сборки настраиваемых образов виртуальных машин, например [Packer](#packer), и инфраструктуры, например [Terraform](#terraform);
    - [служба автоматизации Azure](#azure-automation), которая может выполнять действия в инфраструктуре Azure и локальной среде.

- Автоматизация развертывания и доставки приложений:
    - [Azure DevOps Services](#azure-devops-services) и [Jenkins](#jenkins).

## <a name="ansible"></a>Ansible
[Ansible](https://www.ansible.com/) — это модуль автоматизации управления конфигурацией, создания виртуальных машин и развертывания приложений. Это средство выполняет проверку подлинности целевых машин и управление ими на основе модели без агентов (обычно с помощью ключей SSH). Задачи конфигурации и количество модулей Ansible для их выполнения определены в сборниках схем. Дополнительные сведения см. в статье [How Ansible works](https://www.ansible.com/how-ansible-works) (Принципы работы Ansible).

Вы узнаете, как выполнять следующие задачи:

- [Установка и настройка Ansible для управления виртуальными машинами в Azure](/azure/developer/ansible/install-on-linux-vm)
- [Создайте виртуальную машину Linux](/azure/developer/ansible/vm-configure).
- [Управление виртуальной машиной Linux](/azure/developer/ansible/vm-manage)


## <a name="chef"></a>Chef
[Chef](https://www.chef.io/) — это платформа автоматизации, которая помогает определить параметры настройки и развертывания инфраструктуры, а также управления ею. Дополнительный компонент Chef Habitat позволяет автоматизировать управление жизненным циклом приложения (не инфраструктуры), а Chef InSpec — обеспечение соответствия требованиям политик и безопасности. Клиенты Chef установлены на целевых виртуальных машинах, а на одном или нескольких центральных серверах Chef хранится конфигурация и осуществляется управление ею. Дополнительные сведения см. в статье [An Overview of Chef](https://docs.chef.io/chef_overview.html) (Общие сведения о Chef).

Вы узнаете, как выполнять следующие задачи:

- [Build, deploy, and manage with Chef Automate, the Continuous Automation Platform](https://azuremarketplace.microsoft.com/marketplace/apps/chef-software.chef-automate?tab=Overview) (Создание, развертывание и управление с помощью платформы непрерывной автоматизации Chef Automate)
- [Автоматизация развертывания виртуальной машины Azure с помощью Chef](/azure/developer/chef/windows-vm-configure)


## <a name="puppet"></a>Puppet
[Puppet](https://www.puppet.com) — это платформа автоматизации корпоративного уровня, обрабатывающая доставку и развертывание приложений. На целевых виртуальных машинах установлены агенты, которые позволяют главному серверу Puppet выполнять манифесты, определяющие требуемую конфигурацию инфраструктуры и виртуальных машин Azure. Puppet можно интегрировать с другими решениями, такими как Jenkins и GitHub, что позволяет улучшить рабочие процессы DevOps. Дополнительные сведения см. в статье [How Puppet works](https://puppet.com/products/how-puppet-works) (Принципы работы Puppet).

Вы узнаете, как выполнять следующие задачи:

- [Разверните Puppet](https://puppet.com/docs/puppet/5.5/install_windows.html).


## <a name="cloud-init"></a>Cloud-init
[Пакет cloud-init](https://cloudinit.readthedocs.io) — широко используемое средство, используемое для настройки виртуальной машины Linux при ее первой загрузке. Вы можете использовать cloud-init для установки пакетов, записи файлов или настройки пользователей и параметров безопасности. Так как cloud-init вызывается при начальной загрузке, к вашей конфигурации не нужно применять какие-либо дополнительные действия или агентов.  Дополнительные сведения о том, как правильно отформатировать файлы, `#cloud-config`, см. на [сайте документации по cloud-init](https://cloudinit.readthedocs.io/en/latest/topics/format.html#cloud-config-data).  Файлы `#cloud-config` — это текстовые файлы, закодированные в формате base64.

Кроме того, cloud-init работает с разными дистрибутивами. Например, для установки пакета не используется **apt-get install** или **yum install**. Вместо этого можно определить список пакетов для установки. Файл cloud-init автоматически использует собственный инструмент управления пакетами из выбранного дистрибутива.

Мы активно работаем с нашими партнерами по Linux дистрибутив, чтобы иметь доступ к изображениям с поддержкой Cloud-init в Azure Marketplace. Эти образы обеспечивают бесперебойную работу развертываний и конфигураций cloud-init с виртуальными машинами и масштабируемыми наборами виртуальных машин (VMSS).
Дополнительные сведения о cloud-init в Azure:

- [Поддержка cloud-init для виртуальных машин Linux в Azure](./linux/using-cloud-init.md)
- [Руководство по автоматизации настройки виртуальных машин при помощи cloud-init](./linux/tutorial-automate-vm-deployment.md)


## <a name="powershell-dsc"></a>PowerShell DSC
[PowerShell Desired State Configuration](/powershell/scripting/dsc/overview/overview) — это платформа управления, которая позволяет определить конфигурацию целевых виртуальных машин. DSC также можно использовать в Linux через [сервер Open Management Infrastructure](https://collaboration.opengroup.org/omi/).

Конфигурации DSC определяют компоненты, которые следует установить на виртуальной машине, а также параметры настройки узла. На каждом целевом узле, который обрабатывает запрашиваемые действия на основе отправленных конфигураций, выполняется модуль локального диспетчера конфигураций (LCM). Опрашивающий сервер — это веб-служба, запущенная на центральном узле lkz хранения конфигурации DSC и связанных ресурсов. Этот сервер взаимодействует с модулем LCM на каждом целевом узле и тем самым предоставляет требуемую конфигурацию и отчеты о соответствии.

Вы узнаете, как выполнять следующие задачи:

- [Краткое руководство по настройке требуемого состояния](/powershell/scripting/dsc/quickstarts/website-quickstart)
- [Настройка опрашивающего веб-сервера DSC](/powershell/scripting/dsc/pull-server/pullserver)
- [Начало работы с настройкой требуемого состояния (DSC) для Linux](/powershell/scripting/dsc/getting-started/lnxgettingstarted)


## <a name="azure-custom-script-extension"></a>Расширение пользовательских скриптов Azure
Расширение пользовательских скриптов Azure для [Linux](./extensions/custom-script-linux.md) или [Windows](./extensions/custom-script-windows.md) скачивает и выполняет скрипты на виртуальных машинах Azure. Это расширение можно использовать при создании виртуальной машины или с любой другой целью после ее создания.

Скрипты можно скачать из хранилища Azure или любого общедоступного расположения, например репозитория GitHub. Расширение пользовательских скриптов позволяет создавать скрипты на любом языке, выполняющемся на исходной виртуальной машине. С помощью этих скриптов вы можете устанавливать приложения или нужным образом настраивать виртуальную машину. Чтобы защитить учетные данные, конфиденциальные сведения, например пароли, можно хранить в защищенной конфигурации. Эти учетные данные расшифровываются только на виртуальной машине.

Вы узнаете, как выполнять следующие задачи:

- [Создание виртуальной машины с помощью NGINX](/previous-versions/azure/virtual-machines/scripts/virtual-machines-linux-cli-sample-create-vm-nginx?toc=%2fcli%2fazure%2ftoc.json)
- [Создание виртуальной машины IIS с помощью PowerShell](/previous-versions/azure/virtual-machines/scripts/virtual-machines-windows-powershell-sample-create-vm-iis)


## <a name="packer"></a>Packer
[Packer](https://www.packer.io) автоматизирует процесс сборки при создании настраиваемого образа виртуальной машины Azure. Это средство позволяет определить операционную систему и выполнить скрипты настройки виртуальной машины, выполняемые после задания конфигурации. После настройки виртуальная машина записывается как образ управляемого диска. Packer автоматизирует создание ресурсов исходной виртуальной машины, сети и хранилища, выполнение скриптов конфигурации и создание образа виртуальной машины.

Вы узнаете, как выполнять следующие задачи:

- [Создание образов виртуальных машин Linux в Azure с помощью Packer](./linux/build-image-with-packer.md)
- [Использование Packer для создания образов виртуальных машин Windows в Azure](./windows/build-image-with-packer.md)


## <a name="terraform"></a>Terraform
[Terraform](https://www.terraform.io) — это средство автоматизации, которое позволяет определить и создать целую инфраструктуру Azure на языке HashiCorp Configuration Language (HCL). Это средство помогает определить шаблоны автоматизации создания ресурсов виртуальной машины, хранилища и сети определенного приложения. Имеющиеся шаблоны Terraform можно использовать на других платформах с Azure. Это позволяет обеспечить согласованность и упростить развертывание инфраструктуры, не переходя на шаблон Azure Resource Manager.

Вы узнаете, как выполнять следующие задачи:

- [Установка и настройка Terraform для подготовки виртуальных машин и другой инфраструктуры в Azure](/azure/developer/terraform/getting-started-cloud-shell)
- [Создание базовой инфраструктуры в Azure с помощью Terraform](/azure/developer/terraform/create-linux-virtual-machine-with-infrastructure)


## <a name="azure-automation"></a>Служба автоматизации Azure
[Служба автоматизации Azure](https://azure.microsoft.com/services/automation/) обрабатывает набор задач, выполняемых на целевых виртуальны машинах, с помощью модулей runbook. Эта служба позволяет управлять имеющимися виртуальными машинами. С ее помощью вы не сможете создать инфраструктуру. Службу автоматизации Azure можно запустить на виртуальных машинах Windows и Linux, а также на локальных виртуальных или физических виртуальных машинах с помощью гибридной рабочей роли Runbook. Модули runbook можно хранить в репозитории системы управления версиями, например GitHub. Эти модули можно выполнять вручную или по заданному расписанию.

Служба автоматизации Azure также предоставляет службу DSC, которая позволяет создавать определения настройки заданного набора виртуальных машин. DSC гарантирует применение необходимой конфигурации и обеспечивает согласованность виртуальной машины. Azure Automation DSC можно запустить на виртуальных машинах Windows и Linux.

Вы узнаете, как выполнять следующие задачи:

- [Создайте Runbook PowerShell](../automation/learn/automation-tutorial-runbook-textual-powershell.md).
- [Использование гибридной рабочей роли Runbook для управления локальными ресурсами](../automation/automation-hybrid-runbook-worker.md).
- [Приступая к работе с DSC службы автоматизации Azure](../automation/automation-dsc-getting-started.md)


## <a name="azure-devops-services"></a>Azure DevOps Services
[Azure DevOps Services](https://www.visualstudio.com/team-services/) — это набор средств, позволяющих отслеживать код и предоставлять к нему общий доступ, использовать автоматизированные сборки и создавать конвейеры непрерывной интеграции и разработки (CI/CD). Azure DevOps Services интегрируется с Visual Studio и другими редакторами, что упрощает его использование. Кроме того, этот набор средств позволяет создавать и настраивать виртуальные машины Azure, а затем развертывать код на них.

Дополнительные сведения

- [Azure DevOps Services](/azure/devops/user-guide/index?view=vsts).


## <a name="jenkins"></a>Jenkins
[Jenkins](https://jenkins.io) — это сервер непрерывной интеграции, который помогает развертывать и тестировать приложения, а также создать автоматизированные конвейеры доставки кода. Базовую платформу Jenkins можно расширить с помощью большого количества подключаемых модулей, а веб-перехватчики позволяют интегрировать ее с другими продуктами. Вы можете вручную установить Jenkins на виртуальной машине Azure, запустить Jenkins в контейнере Docker или использовать готовый образ Azure Marketplace.

Вы узнаете, как выполнять следующие задачи:

- [Создание инфраструктуры разработки на виртуальной машине Linux в Azure с помощью Jenkins, GitHub и DOCKER](/azure/developer/jenkins/pipeline-with-github-and-docker).


## <a name="azure-resource-manager-template"></a>Шаблон Azure Resource Manager
[Azure Resource Manager](../azure-resource-manager/templates/overview.md) — это служба развертывания и управления для Azure. Она обеспечивает уровень управления, позволяющий создавать, обновлять и удалять ресурсы в подписке Azure. Вы можете использовать ее функции управления, такие как управление доступом, блокировка и добавление тегов, чтобы защитить и упорядочить ресурсы после развертывания.

Вы узнаете, как выполнять следующие задачи:

- [Развертывание плашечных виртуальных машин с помощью шаблона диспетчер ресурсов](./linux/spot-template.md).
- [Создайте виртуальную машину Windows на основе шаблона диспетчер ресурсов](./windows/ps-template.md).
- [Скачайте шаблон для виртуальной машины](/previous-versions/azure/virtual-machines/windows/download-template).
- [Создайте шаблон Azure Image Builder](./linux/image-builder-json.md).

## <a name="next-steps"></a>Следующие шаги
Средства автоматизации инфраструктуры в Azure позволяют выполнять разные задачи. Вы можете использовать решения, которые максимально отвечают вашим потребностям и требованиям среды. Чтобы приступить к работе и оценить несколько стандартных средств Azure, ознакомьтесь с руководством по автоматизации настройки виртуальной машины [Linux](./linux/tutorial-automate-vm-deployment.md) или [Windows](./windows/tutorial-automate-vm-deployment.md).