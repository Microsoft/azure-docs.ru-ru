---
title: Группы размещения близкого взаимодействия
description: Узнайте, как использовать группы размещения близкого взаимодействия в Azure.
author: cynthn
ms.author: cynthn
ms.service: virtual-machines
ms.subservice: proximity-placement-groups
ms.topic: conceptual
ms.date: 3/07/2021
ms.reviewer: zivr
ms.openlocfilehash: 1a65a1e4ecd989f3a7c4968c424472c3c6dfe472
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102559081"
---
# <a name="proximity-placement-groups"></a>Группы размещения близкого взаимодействия

Размещение виртуальных машин в одном регионе сокращает физическое расстояние между экземплярами. Поместив их в одну зону доступности, вы также объедините их физически ближе друг к другу. Тем не менее, по мере роста объема Azure одна зона доступности может охватывать несколько физических центров обработки данных, что может привести к задержке в сети, влияющей на приложение. 

Чтобы виртуальные машины максимально близки к максимально возможной задержке, следует развернуть их в группе размещения с учетом расположения.

Группа размещения близкого взаимодействия — это логическая группировка, используемая для того, чтобы ресурсы вычислений Azure физически размещались близко друг к другу. Группа размещения близкого взаимодействия удобны для рабочих нагрузок, где требуется низкая задержка.


- Низкая задержка между автономными виртуальными машинами.
- Низкая задержка между виртуальными машинами в одной группе доступности или масштабируемом наборе виртуальных машин. 
- Низкая задержка между автономными виртуальными машинами, виртуальными машинами из нескольких групп доступности или несколькими масштабируемыми наборами. Можно использовать несколько ресурсов вычислений в одной группе размещения для объединения многоуровневого приложения. 
- Низкая задержка между несколькими уровнями приложения с использованием различных типов оборудования. Например, запуск серверной части с помощью серии M в группе доступности и внешнего интерфейса в экземпляре серии D в масштабируемом наборе в одной из групп размещения с близкой назначением.


![Рисунок для групп размещения с близкой нарядом](./media/virtual-machines-common-ppg/ppg.png)

## <a name="using-proximity-placement-groups"></a>Использование групп размещения с учетом расположения 

Группа размещения с близкой назначением — это новый тип ресурса в Azure. Необходимо создать его, прежде чем использовать его с другими ресурсами. После создания его можно использовать с виртуальными машинами, группами доступности или масштабируемыми наборами виртуальных машин. Группа размещения с учетом расположения указывается при создании ресурсов вычислений, предоставляющих идентификатор группы размещения близости. 

Можно также переместить существующий ресурс в группу размещения с учетом расположения. При перемещении ресурса в группу размещения с учетом расположения необходимо сначала отменить (освободить) ресурс-контейнер, так как он будет повторно развернут в другом центре обработки данных в регионе для удовлетворения ограничения совместного размещения. 

В случае групп доступности и масштабируемых наборов виртуальных машин следует задать группу размещения с учетом расположения на уровне ресурсов, а не на отдельных виртуальных машинах. 

Группа размещения с близкой назначением является ограничением совместного размещения, а не механизмом закрепления. Он закреплен в определенном центре обработки данных с развертыванием первого ресурса для его использования. После того как все ресурсы, использующие группу размещения с учетом расположения, были остановлены (освобождены) или удалены, они больше не фиксируются. Поэтому при использовании группы размещения с несколькими виртуальными машинами важно указать все требуемые типы в начале шаблона, если это возможно, или следовать последовательности развертывания, что повысит вероятность успешного развертывания. В случае сбоя развертывания перезапустите развертывание с размером виртуальной машины, который завершился сбоем в качестве первого развернутого размера.

## <a name="what-to-expect-when-using-proximity-placement-groups"></a>Что следует рассчитывать при использовании групп размещения с учетом расположения 
Группы размещения с близкой назначением предлагают совместное размещение в одном центре обработки данных. Однако, поскольку группы размещения близкого взаимодействия представляют дополнительное ограничение развертывания, могут возникать сбои выделения. Существует несколько вариантов использования, когда при использовании групп размещения с учетом расположения могут возникнуть сбои выделения:

- Когда вы запрашиваете первую виртуальную машину в группе размещения с учетом расположения, центр обработки данных выбирается автоматически. В некоторых случаях второй запрос номера SKU виртуальной машины может завершиться ошибкой, если он не существует в этом центре обработки данных. В этом случае возвращается ошибка **оверконстраинедаллокатионрекуест** . Чтобы избежать этого, попробуйте изменить порядок развертывания номеров SKU или разворачивать оба ресурса с помощью одного шаблона ARM.
-   В случае эластичных рабочих нагрузок, в которых вы добавляете и удаляете экземпляры виртуальных машин, наличие ограничения группы размещения с учетом расположения в развертывании может привести к сбою запроса, что приведет к ошибке **аллокатионфаилуре** . 
- Остановка (освобождение) и запуск виртуальных машин по мере необходимости — это еще один способ достижения эластичности. Так как емкость не сохраняется после завершения (освобождения) виртуальной машины, ее повторный запуск может привести к ошибке **аллокатионфаилуре** .

## <a name="planned-maintenance-and-proximity-placement-groups"></a>Плановое обслуживание и группы размещения с учетом расположения

Запланированные события обслуживания, такие как списание оборудования в центре обработки данных Azure, потенциально могут повлиять на выравнивание ресурсов в группах размещения близости. Ресурсы можно переместить в другой центр обработки данных, нарушая совместное размещение и задержку задержки, связанные с группой размещения с учетом расположения.

### <a name="check-the-alignment-status"></a>Проверка состояния выравнивания

Вы можете выполнить следующие действия, чтобы проверить состояние выравнивания для групп размещения с учетом расположения.


- Состояние совместного размещения группы размещения с учетом расположения можно просмотреть с помощью портала, CLI и PowerShell.

    -   При использовании PowerShell состояние совместного размещения можно получить с помощью командлета Get-AzProximityPlacementGroup, включив необязательный параметр "-Колокатионстатус".

    -   При использовании интерфейса командной строки состояние совместного размещения можно получить с помощью `az ppg show` , включив необязательный параметр "--include-корасположение-Status".

- Для каждой группы размещения с учетом расположения в свойстве "состояние совместного **размещения** " содержится сводка по текущему состоянию выравнивания сгруппированных ресурсов. 

    - С **согласованием**: ресурс находится в той же учетом неизбежного увеличения задержки группы размещения с учетом расположения.

    - **Неизвестно**: освобождается по крайней мере один ресурс виртуальной машины. После успешного запуска возвращается состояние "выполнено **".**

    - **Не согласовано**: по крайней мере один ресурс виртуальной машины не соответствует группе размещения с учетом расположения. Конкретные ресурсы, которые не были согласованы, будут также вызваны отдельно в разделе членство.

- Для групп доступности можно просмотреть сведения о выравнивании отдельных виртуальных машин на странице обзора группы доступности.

- Для масштабируемых наборов сведения о выравнивании отдельных экземпляров можно просмотреть на вкладке **экземпляры** страницы **Обзор** масштабируемого набора. 


### <a name="re-align-resources"></a>Повторно выровняйте ресурсы 

Если группа размещения близкого расположения — `Not Aligned` , можно стоп\деаллокате и перезапустить затронутые ресурсы. Если виртуальная машина находится в группе доступности или масштабируемом наборе, сначала необходимо стоппед\деаллокатед все виртуальные машины в группе доступности или масштабируемом наборе, прежде чем перезапустить их.

В случае сбоя выделения из-за ограничений развертывания может потребоваться стоп\деаллокате все ресурсы в группе размещения с близкого края (включая выровненные ресурсы), а затем перезапустите их для восстановления выравнивания.

## <a name="best-practices"></a>Рекомендации 
- Для наименьшей задержки используйте группы размещения близкого взаимодействия с ускоренной сетью. Дополнительные сведения см. в статьях [Создание виртуальной машины Linux с ускоренной сетью](../virtual-network/create-vm-accelerated-networking-cli.md) или [Создание виртуальной машины Windows с ускоренной сетью](../virtual-network/create-vm-accelerated-networking-powershell.md).
- Развертывание всех размеров виртуальных машин в одном шаблоне. Чтобы избежать размещения на оборудовании, которое не поддерживает все требуемые номера SKU и размеры виртуальных машин, включите все уровни приложения в один шаблон, чтобы все они были развернуты одновременно.
- Если вы задаете скрипты развертывания с помощью PowerShell, CLI или пакета SDK, может возникнуть ошибка выделения памяти `OverconstrainedAllocationRequest` . В этом случае следует отменить или освободить все существующие виртуальные машины, а также изменить последовательность в скрипте развертывания, чтобы она начиналась с номера SKU или размеров виртуальной машины, для которых произошел сбой. 
- При повторном использовании существующей группы размещения, из которой были удалены виртуальные машины, дождитесь полного завершения удаления, прежде чем добавлять в него виртуальные машины.
- Если задержка является первым приоритетом, помещайте виртуальные машины в группу размещения с учетом расположения и все решение в зоне доступности. Но если устойчивость является высшим приоритетом, распространение экземпляров между несколькими зонами доступности (одна группа размещения с одинаковым размещением не может охватывать зоны).

## <a name="next-steps"></a>Дальнейшие действия

Развертывание виртуальной машины в группе размещения с учетом расположения с помощью [Azure CLI](./linux/proximity-placement-groups.md) или [PowerShell](./windows/proximity-placement-groups.md)

Узнайте, как [проверить задержку в сети](../virtual-network/virtual-network-test-latency.md).

Узнайте, как [оптимизировать пропускную способность сети](../virtual-network/virtual-network-optimize-network-bandwidth.md).  

Узнайте, как [использовать группы размещения близкого взаимодействия с приложениями SAP](./workloads/sap/sap-proximity-placement-scenarios.md).