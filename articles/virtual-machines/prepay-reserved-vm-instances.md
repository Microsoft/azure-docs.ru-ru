---
title: Предоплата за виртуальные машины Azure для экономии денег
description: Узнайте, как воспользоваться службой Azure Reserved Virtual Machine Instances для сокращения затрат на вычисления.
author: vikramdesai01
manager: vikramdesai01
ms.service: virtual-machines
ms.subservice: sizes
ms.topic: conceptual
ms.workload: infrastructure-services
ms.date: 10/30/2017
ms.author: vikdesai
ms.openlocfilehash: e6cf097e927c4606885dd3f885de6ab8235bf6be
ms.sourcegitcommit: b39cf769ce8e2eb7ea74cfdac6759a17a048b331
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2021
ms.locfileid: "98682600"
---
# <a name="save-costs-with-azure-reserved-vm-instances"></a>Экономия расходов с помощью Azure Reserved VM Instances


При фиксации в зарезервированном экземпляре виртуальной машины Azure вы можете сэкономить деньги. Скидка на резервирование автоматически применяется к количеству работающих виртуальных машин, которые соответствуют области и атрибутам резервирования. Для получения скидок не нужно назначать резервирование виртуальной машине. Покупка зарезервированного экземпляра охватывает только вычислительную часть использования виртуальной машины. Для виртуальных машин Windows показатель использования делится на два отдельных счетчика. Есть счетчик вычислений, который аналогичен показателю Linux и счетчику IP-адресов Windows. Плата, которую вы видите при совершении покупки, будет взиматься только за затраты на вычисление. В оплату не входят расходы на программное обеспечение Windows. Дополнительные сведения о затратах на программное обеспечение см. [в разделе затраты на программное обеспечение, не включаемые в Azure reserved VM Instances](../cost-management-billing/reservations/reserved-instance-windows-software-costs.md).

## <a name="determine-the-right-vm-size-before-you-buy"></a>Определение нужного размера виртуальной машины перед покупкой

Перед покупкой резервирования следует определить необходимый размер виртуальной машины. Следующие разделы помогут определить правильный размер виртуальной машины.

### <a name="use-reservation-recommendations"></a>Использование рекомендаций по резервированию

Вы можете использовать рекомендации по резервированию, чтобы определить резервирования, которые следует приобрести.

- Рекомендации по приобретению и Рекомендуемые количества отображаются при покупке зарезервированного экземпляра виртуальной машины в портал Azure.
- Помощник по Azure предоставляет рекомендации по приобретению отдельных подписок.  
- Вы можете использовать API для получения рекомендаций по покупке как для общей области, так и для области одной подписки. Дополнительные сведения см. в разделе [API рекомендации по приобретению зарезервированных экземпляров для корпоративных клиентов](/rest/api/billing/enterprise/billing-enterprise-api-reserved-instance-recommendation).
- Для пользователей Соглашение Enterprise (EA) и клиентов Майкрософт (MCA) доступны рекомендации по приобретению общих и отдельных областей подписки с [пакетом содержимого Azure Consumption Insights Power BI](/power-bi/service-connect-to-azure-consumption-insights).

### <a name="services-that-get-vm-reservation-discounts"></a>Службы, которые получают скидки на резервирование виртуальных машин

Резервирование виртуальных машин может применяться к использованию виртуальной машины, созданной из нескольких служб, а не только для развертываний виртуальных машин. Ресурсы, которые получают скидки на резервирование, изменяются в зависимости от параметра гибкости размера экземпляра.

#### <a name="instance-size-flexibility-setting"></a>Параметр гибкости размера экземпляра

Параметр гибкость размера экземпляра определяет, какие службы получают скидки на зарезервированные экземпляры.

Независимо от того, включен ли параметр или выключен, скидки на резервирование автоматически применяются к любому соответствующему использованию виртуальной машины, если параметр *ConsumedService* равен `Microsoft.Compute`. Поэтому проверьте данные об использовании для значения *ConsumedService*. Некоторые примеры:

- Виртуальные машины
- Масштабируемые наборы виртуальных машин
- Служба контейнеров
- Развертывания пакетной службы Azure (в режиме пользовательских подписок)
- Служба Azure Kubernetes (AKS)
- Service Fabric

Если эта настройка включена, скидки на резервирование автоматически применяются к соответствующему использованию виртуальных машин, когда *ConsumedService* является одним из следующих элементов:

- Microsoft.Compute;
- Microsoft.ClassicCompute
- Microsoft.Batch
- Microsoft.MachineLearningServices
- Microsoft.Kusto

Проверьте значение *ConsumedService* в данных об использовании, чтобы определить, подходит ли использование для скидки на резервирование.

Дополнительные сведения о гибкости размера экземпляров см. в статье [Гибкость размеров виртуальных машин при использовании зарезервированных экземпляров виртуальных машин](reserved-vm-instance-size-flexibility.md).

### <a name="analyze-your-usage-information"></a>Анализ сведений об использовании

Проанализируйте сведения об использовании, чтобы определить, какие резервирования следует приобрести. Данные об использовании доступны в файле использования и API-интерфейсах. Используйте их вместе, чтобы определить, какое резервирование следует приобрести. Проверьте наличие экземпляров виртуальных машин с высоким уровнем использования на ежедневной основе, чтобы определить количество резервируемых резервирований. Избегайте `Meter` подкатегории и `Product` полей в данных об использовании. Они не различают размеры виртуальных машин, которые используют хранилище класса Premium. Если вы используете эти поля для определения размера виртуальной машины для приобретения резервирования, вы можете купить неправильный размер. Тогда вы не получите желаемую скидку на резервирование. Вместо этого обратитесь к `AdditionalInfo` полю в файле использования или API использования, чтобы определить правильный размер виртуальной машины.

В файле использования отображается плата за расчетный период и ежедневное использование. Сведения о скачивании файла использования см. в статье [Просмотр и скачивание данных об использовании и расходах Azure](../cost-management-billing/understand/download-azure-daily-usage.md). Затем с помощью сведений о файле использования можно [определить, какое резервирование будет приобретено](../cost-management-billing/reservations/determine-reservation-purchase.md).

### <a name="purchase-restriction-considerations"></a>Рекомендации по ограничениям покупки

Зарезервированные экземпляры виртуальных машин доступны для большинства размеров виртуальных машин с некоторыми исключениями. Скидки на резервирование не применяются к следующим виртуальным машинам:

- Серия **виртуальных машин** серии A, серии Av2 или G.

- **Предварительная версия или Акционная виртуальные** машины — любой ряд виртуальных машин или размер, который находится на этапе предварительной версии, или использует счетчик рекламных акций.

- **Облака** . резервирование недоступно для приобретения в Германии и в регионах Китая.

- **Недостаточная квота** . для резервирования в рамках одной подписки должна быть доступна квота виртуальных ЦП в подписке для новой RI. Например, если целевая подписка имеет квоту на 10 виртуальных ЦП для серии D, вы не сможете приобрести резервирование для 11 экземпляров Standard_D1. При проверке квоты для резервирования учитываются все виртуальные машины, уже размещенные в подписке. Например, если подписка имеет квоту на 10 виртуальных ЦП для серии D и два развернутых экземпляра Standard_D1, в этой подписке можно приобрести резервирование для 10 экземпляров Standard_D1. Чтобы устранить эту проблему, можно [создать запрос на увеличение квоты](../azure-portal/supportability/resource-manager-core-quotas-request.md) .

- **Ограничения емкости** . в редких обстоятельствах Azure ограничивает покупку новых резервирований для подмножества размеров виртуальных машин из-за нехватки емкости в регионе.

## <a name="buy-a-reserved-vm-instance"></a>Приобретение Reserved VM Instance

Зарезервированный экземпляр виртуальной машины можно купить в [портал Azure](https://portal.azure.com/#blade/Microsoft_Azure_Reservations/CreateBlade/referrer/documentation/filters/%7B%22reservedResourceType%22%3A%22VirtualMachines%22%7D). Платите за резервирование [наперед или ежемесячными платежами](../cost-management-billing/reservations/prepare-buy-reservation.md).
Эти требования применяются для приобретения зарезервированного экземпляра виртуальной машины.

- Необходимо быть членом роли владельца по крайней мере для одной подписки EA или подписки с оплатой по мере использования.
- Для подписок EA параметр **Добавить зарезервированные экземпляры** должен быть включен на [портале EA](https://ea.azure.com/). Если этот параметр отключен, необходимо быть администратором подписки EA.
- В рамках программы для поставщиков облачных решений (CSP) только агенты администрирования или агенты продаж могут приобрести резервирования.

Чтобы купить экземпляр, выполните следующие действия.

1. Войдите на [портал Azure](https://portal.azure.com).
1. Выберите **Все службы** > **Резервирование**.
1. Щелкните **Добавить**, чтобы приобрести новое резервирование, а затем выберите **Виртуальная машина**.
1. Заполните обязательные поля. Работающие экземпляры виртуальной машины, соответствующие выбранным атрибутам, подходят для получения скидки на резервирование. Фактическое число экземпляров виртуальной машины, получающих скидку, зависит от области и выбранного количества.

При наличии соглашения EA можно использовать **параметр добавить дополнительные** , чтобы быстро добавить дополнительные экземпляры. Параметр недоступен для других типов подписки.


| Поле      | Описание|
|------------|--------------|
|Подписка|Подписка, используемая для оплаты резервирования. Резервирование оплачивается с помощью метода оплаты, указанного для подписки. Тип подписки должен быть соглашением Enterprise (номера предложения: MS-AZR-0017P или MS-AZR-0148P) или соглашением с клиентами Майкрософт или индивидуальной подпиской с оплатой по мере использования (номера предложений: MS-AZR-0003P или MS-AZR-0023P). Расходы вычитаются из предоплаты Azure (ранее назывались денежными обязательствами), если они доступны, или оплачиваются как избыточные. Для подписки с тарифами с оплатой по мере использования плата оплачивается по методу оплаты кредитной карты или счета-фактуры в подписке.|    
|Область       |Область резервирования может охватывать одну подписку или несколько подписок (общая область). Если выбрать: <ul><li>**Одна группа ресурсов** — скидка по резервированию применяется к подходящим ресурсам только в выбранной группе ресурсов.</li><li>**Одна подписка** — скидка по резервированию применяется к подходящим ресурсам только в выбранной подписке.</li><li>**Общая область резервирования** — скидка по резервированию применяется к подходящим ресурсам во всех допустимых подписках в контексте выставления счетов. Для клиентов EA контекст выставления счетов — это регистрация. Для отдельных подписок с оплатой по мере использования областью выставления счетов считаются все допустимые подписки, созданные администратором учетной записи.</li></ul>|
|Регион    |Регион Azure, на который распространяется резервирование.|    
|Размер виртуальной машины     |Размер экземпляров виртуальной машины.|
|Оптимизировать для     |Гибкость размера экземпляра виртуальной машины выбрана по умолчанию. Щелкните **Дополнительные параметры** , чтобы изменить значение гибкости размера экземпляра, чтобы применить скидку резервирования к другим виртуальным машинам в той же [группе размеров виртуальной машины](reserved-vm-instance-size-flexibility.md). Приоритет емкости назначает приоритет емкости центра обработки данных для развертываний. Она обеспечивает дополнительную уверенность в возможности запуска экземпляров виртуальных машин по мере необходимости. Приоритет емкости доступен только в том случае, если область резервирования является одиночной подпиской. |
|Термин        |Один или три года. Также доступен 5-летний срок, доступный только для виртуальных машин HBv2.|
|количество;    |Число экземпляров, приобретаемых в рамках резервирования. Это количество работающих экземпляров виртуальной машины, которые могут получить скидку. Например, если вы используете 10 Standard_D2 виртуальных машин в восточной части США, то для максимального увеличения преимуществ для всех работающих виртуальных машин следует указать количество 10. |

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RE2PjmT]

## <a name="usage-data-and-reservation-utilization"></a>Данные об использовании и использование резервирования

В данных об использовании указана нулевая эффективная цена за использование, на которое распространяется скидка на резервирование. Вы можете увидеть, какой экземпляр виртуальной машины получил скидку резервирования для каждого резервирования.

Дополнительные сведения о том, как скидки на резервирование отображаются в данных об использовании, см. в статье [сведения об использовании резервирования Azure для регистрации на предприятии](../cost-management-billing/reservations/understand-reserved-instance-usage-ea.md) , если вы ЯВЛЯЕТЕСЬ клиентом EA. Если у вас есть отдельная подписка, см. статью [сведения об использовании резервирования Azure для подписки с оплатой по мере использования](../cost-management-billing/reservations/understand-reserved-instance-usage.md).

## <a name="change-a-reservation-after-purchase"></a>Изменение резервирования после покупки

После приобретения в резервирование можно внести следующие типы изменений:

- Обновить область резервирования
- Гибкость размера экземпляра (если применимо)
- владельца;

Можно также разделить резервирование на небольшие фрагменты и объединить уже разделенные резервирования. Ни одно из изменений не вызывает новую коммерческую транзакцию или не изменяет дату окончания резервирования.

Следующие типы изменений нельзя внести после приобретения, непосредственно:

- Регион существующего резервирования
- SKU
- количество;
- Длительность

Тем не менее можно выполнить *Обмен* резервированиями, если необходимо внести изменения.

## <a name="cancel-exchange-or-refund-reservations"></a>Отмена, обмен резервирования, возмещение средств за резервирование

Вы можете отменить и обменять резервирования, а также вернуть вложенные в резервирование средства, но при этом применяются определенные ограничения. Дополнительные сведения см. в статье [Self-service exchanges and refunds for Azure Reservations](../cost-management-billing/reservations/exchange-and-refund-azure-reservations.md) (Самостоятельное выполнение обмена и возмещения средств для резервирований Azure).

## <a name="need-help-contact-us"></a>Требуется помощь? Свяжитесь с нами.

Если у вас есть вопросы или вам нужна помощь, [создайте запрос в службу поддержки](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest).

## <a name="next-steps"></a>Дальнейшие действия

- Сведения об управлении резервированием см. в разделе [Управление резервированиями в Azure](../cost-management-billing/reservations/manage-reserved-vm-instance.md).
- Дополнительные сведения о резервировании в Azure см. по следующим ссылкам:
    - [Основные сведения о резервировании в Azure](../cost-management-billing/reservations/save-compute-costs-reservations.md)
    - [Управление резервированиями в Azure](../cost-management-billing/reservations/manage-reserved-vm-instance.md)
    - [Сведения о применении скидки на зарезервированный экземпляр виртуальной машины](../cost-management-billing/manage/understand-vm-reservation-charges.md)
    - [Общие сведения об использовании резервирования Azure для отдельной подписки с оплатой по мере использования](../cost-management-billing/reservations/understand-reserved-instance-usage.md)
    - [Общие сведения об использовании зарезервированных экземпляров Azure с Соглашением о регистрации Enterprise](../cost-management-billing/reservations/understand-reserved-instance-usage-ea.md)
    - [Затраты на программное обеспечение Windows, которые не включены в стоимость зарезервированных экземпляров Azure](../cost-management-billing/reservations/reserved-instance-windows-software-costs.md)
    - [Приобретение зарезервированных экземпляров Azure](/partner-center/azure-reservations)