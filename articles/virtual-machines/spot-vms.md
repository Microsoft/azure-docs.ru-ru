---
title: Использование виртуальных машин точки Azure
description: Узнайте, как использовать виртуальные машины Azure для хранения затрат.
author: cynthn
ms.service: virtual-machines
ms.workload: infrastructure-services
ms.topic: how-to
ms.date: 10/05/2020
ms.author: cynthn
ms.reviewer: jagaveer
ms.openlocfilehash: 1e3934a8ff91d764a5148b3d490b44f30983a284
ms.sourcegitcommit: 2bd0a039be8126c969a795cea3b60ce8e4ce64fc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/14/2021
ms.locfileid: "98202136"
---
# <a name="use-spot-vms-in-azure"></a>Использование плашечных виртуальных машин в Azure

Использование точечных виртуальных машин позволяет применить неиспользуемую емкость наших ресурсов со значительной экономией. В любой момент времени, когда эта емкость становится нужна, инфраструктура Azure вытесняет точечные виртуальные машины. Это означает, что точечные виртуальные машины прекрасно подходят для рабочих нагрузок, для которых допустимы прерывания, например для заданий пакетной обработки, сред разработки или тестирования, больших вычислительных рабочих нагрузок и других.

Объем доступной емкости может варьироваться в зависимости от размера, региона, времени суток и других параметров. При развертывании точечных виртуальных машин в Azure им выделяется доступная емкость (при наличии), но соглашение об уровне обслуживания для них не поддерживается. Точечная виртуальная машина не поддерживает гарантии высокого уровня доступности. В любой момент времени, когда емкость становится нужна для других целей, инфраструктура Azure вытесняет точечные виртуальные машины с 30-секундным предупреждением. 


## <a name="eviction-policy"></a>Политика вытеснения

Виртуальные машины могут быть вытеснены в зависимости от доступной емкости или настроенной вами максимальной цены. При создании точки на виртуальной машине можно задать политику вытеснения для отмены *распределения* (по умолчанию) или *Удалить*. 

Политика *освобождения* ПЕРЕмещает виртуальную машину в остановленное состояние, что позволяет повторно развернуть ее позже. Однако нет гарантии, что распределение будет выполнено успешно. Освобожденные виртуальные машины будут подсчитываться по квоте, а плата за ресурсы хранилища будет заряжена для базовых дисков. 

Если вы хотите, чтобы виртуальная машина была удалена при удалении, можно задать политику вытеснения для *удаления*. Удаленные виртуальные машины удаляются вместе с их базовыми дисками, поэтому вы не будете получать оплату за хранилище. 

Вы можете принять участие в получении уведомлений в виртуальной машине с помощью [Azure запланированные события](./linux/scheduled-events.md). Вы получите информацию о предстоящем вытеснении виртуальных машин, и у вас будет 30 секунд до вытеснения для завершения всех заданий и корректной остановки работы. 


| Параметр | Результат |
|--------|---------|
| Максимальная цена не ниже текущей цены. | Виртуальная машина будет развернута, пока есть доступная емкость и не превышена квота. |
| Максимальная цена ниже текущей цены. | Виртуальная машина не развертывается. Вы получите сообщение об ошибке с информацией о том, что максимальная цена должна быть не ниже текущей цены. |
| Перезапуск или остановка и освобождение виртуальной машины, если максимальная цена не ниже текущей цены | Виртуальная машина будет развернута, если есть доступная емкость и не превышена квота. |
| Перезапуск или остановка и освобождение виртуальной машины, если максимальная цена ниже текущей цены | Вы получите сообщение об ошибке с информацией о том, что максимальная цена должна быть не ниже текущей цены. | 
| Цена на виртуальную машину выросла и превысила максимальную цену. | Виртуальная машина вытесняется. Вы получите 30-секундное уведомление перед вытеснением. | 
| После вытеснения цена на виртуальную машину снова опускается ниже максимальной цены. | Виртуальная машина не перезапускается автоматически. Вы можете запустить виртуальную машину вручную, и она будет оплачиваться по текущей цене. |
| Если установлена максимальная цена `-1` | Виртуальная машина не будет вытесняться по критерию цены. Максимальной ценой всегда будет считаться текущая цена, вплоть до уровня стандартной цены на виртуальные машины. Цена никогда не будет превышать стандартную цену.| 
| Изменение максимальной цены | Для изменения максимальной цены виртуальную машину придется освободить. Освободите виртуальную машину, установите новую максимальную цену и обновите виртуальную машину. |


## <a name="limitations"></a>Ограничения

Для точечных виртуальных машин не поддерживаются следующие размеры.
 - Серия B
 - Рекламные версии любого размера (например, рекламные размеры Dv2, NV, NC и H)

Точечные виртуальные машины можно развертывать в любом регионе, кроме Azure для Китая (21Vianet).

<a name="channel"></a>

В настоящее время поддерживаются следующие [типы предложений](https://azure.microsoft.com/support/legal/offer-details/) :

-   Соглашение Enterprise
-   Оплата по мере использования
-   Спонсорские
- Для поставщика облачных служб (CSP) обратитесь к своему партнеру.


## <a name="pricing"></a>Цены

Цена на точечные виртуальные машины может изменяться в зависимости от региона и ценовой категории. Дополнительные сведения см. на страницах с информацией о ценах на виртуальные машины [Linux](https://azure.microsoft.com/pricing/details/virtual-machines/linux/) и [Windows](https://azure.microsoft.com/pricing/details/virtual-machines/windows/). 

Вы также можете запросить сведения о ценах с помощью [API розничных цен Azure](/rest/api/cost-management/retail-prices/azure-retail-prices) , чтобы запросить информацию о ценах. Объект `meterName` и `skuName` будет содержать `Spot` .

Переменное ценообразование позволяет вам указать максимальную цену в долларах США с точностью до 5 знаков после запятой. Например, значение `0.98765` определяет максимальную цену 0,98765 долларов США в час. Если вы укажете для максимальной цены значение `-1`, виртуальная машине не будет вытесняться по критерию цены. Цена на такую виртуальную машину будет определяться меньшим из двух значений: текущая цена точечных виртуальных машин или цена на стандартные виртуальные машины, но только при условии наличия емкости и соблюдения квоты.

## <a name="pricing-and-eviction-history"></a>Журнал цен и вытеснения

Вы можете просмотреть исторические цены и ставки вытеснений для каждого размера в регионе на портале. Выберите **Просмотр истории цен и сравните цены в ближайших регионах** , чтобы просмотреть таблицу или график цен для определенного размера.  Ниже приведены примеры цен и вытеснения на следующих изображениях. 

**Диаграмма**.

:::image type="content" source="./media/spot-chart.png" alt-text="Снимок экрана параметров региона с разницей в ценах и процентах вытеснения в виде диаграммы.":::

**Таблица**:

:::image type="content" source="./media/spot-table.png" alt-text="Снимок экрана параметров региона с разницей в ценах и ставках вытеснения в виде таблицы.":::



##  <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

**Вопрос.** Можно ли считать, что после создания точечная виртуальная машина ничем не отличается от стандартной?

**Ответ.** Да, за исключением того, что для точечных виртуальных машин отсутствует соглашение об уровне обслуживания и они могут быть вытеснены в любое время.


**Вопрос.** Что делать, если вытеснена виртуальная машина, а емкость по-прежнему нужна?

**Ответ.** Если емкость вам нужна без промедлений, используйте стандартные виртуальные машины вместо точечных.


**Вопрос.** Как выполняется управление квотой для точечных виртуальных машин?

**Ответ.** Для точечных виртуальных машин выделяется отдельный пул квот. Эти квоты совместно используются всеми точечными виртуальными машинами и экземплярами масштабируемых наборов. Дополнительные сведения см. в статье [Подписка Azure, границы, квоты и ограничения службы](../azure-resource-manager/management/azure-subscription-service-limits.md).


**Вопрос.** Могу ли я запросить увеличение квоты на точечные экземпляры?

**Ответ.** Да, вы можете отправить запрос на увеличение квоты для точечных виртуальных машин, используя [стандартный процесс запроса квот](../azure-portal/supportability/per-vm-quota-requests.md).


**Вопрос.** Где можно задать вопрос?

**Ответ.** Разместите вопрос с тегом `azure-spot` в разделе [вопросов и ответов](/answers/topics/azure-spot.html). 


**Вопрос.** Как изменить максимальную цену для плашечной виртуальной машины?

Ответ **.** Прежде чем можно будет изменить максимальную цену, необходимо освободить виртуальную машину. Затем можно изменить максимальную цену на портале в разделе **конфигурации** для виртуальной машины. 

## <a name="next-steps"></a>Дальнейшие действия
Используйте интерфейс [командной строки](./linux/spot-cli.md), [портал](spot-portal.md), [шаблон ARM](./linux/spot-template.md)или [PowerShell](./windows/spot-powershell.md) для развертывания плашечных виртуальных машин.

Также можно развернуть [масштабируемый набор с другими экземплярами виртуальных машин](../virtual-machine-scale-sets/use-spot.md).

Если возникает ошибка, см. раздел [коды ошибок](./error-codes-spot.md).
