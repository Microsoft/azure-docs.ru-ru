---
title: Общие сведения о выделенных узлах Azure для виртуальных машин
description: Узнайте больше о том, как можно использовать выделенные узлы Azure для развертывания виртуальных машин.
author: cynthn
ms.service: virtual-machines
ms.subservice: dedicated-hosts
ms.topic: conceptual
ms.workload: infrastructure
ms.date: 12/07/2020
ms.author: cynthn
ms.reviewer: zivr
ms.openlocfilehash: 46de182c7acfaf75b2e65fa318717348dd1c4b73
ms.sourcegitcommit: b4647f06c0953435af3cb24baaf6d15a5a761a9c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/02/2021
ms.locfileid: "101667341"
---
# <a name="azure-dedicated-hosts"></a>Выделенные узлы Azure

Выделенный узел Azure — это служба, предоставляющая выделенные для одной подписки Azure физические серверы, способные вместить одну или несколько виртуальных машин. Выделенные узлы — это те же физические серверы, которые используются в наших центрах обработки данных, предоставляемые в качестве ресурса. Вы можете подготавливать выделенные узлы в пределах региона, зоны доступности и домена сбоя. Затем вы можете разместить в подготовленных узлах виртуальные машины с любой конфигурацией, которая соответствует вашим потребностям.


## <a name="benefits"></a>Преимущества 

Резервирование всего узла обеспечивает следующие преимущества:

-   Изоляция оборудования на физическом уровне сервера. На узлах не будут размещаться другие виртуальные машины. Выделенные узлы развертываются в одном и том же центре обработки данных и используют одну и ту же сеть и базовую инфраструктуру хранения как другие, не изолированные узлы.
-   Управление событиями обслуживания, инициированными платформой Azure. Хотя большинство событий обслуживания почти не оказывает влияния на виртуальные машины, существуют некоторые конфиденциальные рабочие нагрузки, в которых каждая секунда приостановки может оказать влияние на работу. С помощью выделенных узлов можно принять участие в окне обслуживания, чтобы снизить влияние на службу.
-   Благодаря преимуществам гибридного использования Azure вы можете использовать собственные лицензии для Windows и SQL в Azure. Использование гибридных преимуществ предоставляет дополнительные преимущества. Дополнительные сведения см. в разделе [преимущество гибридного использования Azure](https://azure.microsoft.com/pricing/hybrid-benefit/).


## <a name="groups-hosts-and-vms"></a>Группы, узлы и виртуальные машины  

![Просмотр новых ресурсов для выделенных узлов.](./media/virtual-machines-common-dedicated-hosts/dedicated-hosts2.png)

**Группа узлов** — это ресурс, который представляет собой коллекцию выделенных узлов. Группа узлов создается в регионе и зоне доступности, и в нее добавляются узлы.

**Узел** — это ресурс, сопоставленный с физическим сервером в центре обработки данных Azure. Физический сервер выделяется при создании узла. Узел создается в группе узлов. Узел имеет номер SKU, описывающий, какие размеры виртуальных машин можно создать. На каждом узле может размещаться несколько виртуальных машин разного размера, если они находятся в одном и том же наборе.


## <a name="high-availability-considerations"></a>Рекомендации по высокой доступности 

Для обеспечения высокой доступности необходимо развернуть несколько виртуальных машин, распределенных по нескольким узлам (не менее 2). С помощью выделенных узлов Azure у вас есть несколько вариантов для подготовки инфраструктуры к формированию границ изоляции ошибок.

### <a name="use-availability-zones-for-fault-isolation"></a>Использование Зоны доступности для изоляции сбоев

Зоны доступности — уникальные физические расположения в пределах одного региона Azure. Каждая зона состоит из одного или нескольких центров обработки данных, оснащенных независимыми системами электроснабжения, охлаждения и сетевого взаимодействия. Группа узлов создается в одной зоне доступности. После создания все узлы будут помещены в эту зону. Чтобы обеспечить высокий уровень доступности в разных зонах, необходимо создать несколько групп узлов (по одной на каждую зону) и соответствующим образом распространить узлы.

При назначении группы узлов в зону доступности все виртуальные машины, созданные на этом узле, должны быть созданы в той же зоне.

### <a name="use-fault-domains-for-fault-isolation"></a>Использование доменов сбоя для изоляции сбоев

Узел можно создать в определенном домене сбоя. Как и в случае с виртуальными машинами в масштабируемом наборе или группе доступности, узлы в разных доменах сбоя будут размещаться в разных физических стойках в центре обработки данных. При создании группы узлов необходимо указать количество доменов сбоя. При создании узлов в группе узлов необходимо назначить домен сбоя для каждого узла. Виртуальным машинам не требуется назначение домена сбоя.

Домены сбоя не совпадают с совместном размещением. Наличие того же домена сбоя для двух узлов не означает, что они находятся в близком друг к другу.

Домены сбоя входят в область группы узлов. Не следует делать никаких предположений относительно сглаживания между двумя группами узлов (если они находятся в разных зонах доступности).

Виртуальные машины, развернутые на узлах с разными доменами сбоя, будут иметь свои базовые службы управляемых дисков на нескольких метках хранилища, чтобы повысить защиту от сбоев в изоляции.

### <a name="using-availability-zones-and-fault-domains"></a>Использование Зоны доступности и доменов сбоя

Обе возможности можно использовать совместно для обеспечения еще большей изоляции сбоя. В этом случае необходимо указать зону доступности и число доменов сбоя в для каждой группы узлов, назначить домен сбоя каждому из узлов в группе и назначить зону доступности для каждой виртуальной машины.

Приведенный [здесь](https://github.com/Azure/azure-quickstart-templates/blob/master/201-vm-dedicated-hosts/README.md) пример шаблона диспетчер ресурсов использует зоны и домены сбоя для распространения узлов для обеспечения максимальной устойчивости в регионе.


## <a name="manual-vs-automatic-placement"></a>Сравнение ручного и автоматического размещения 

При создании виртуальной машины в Azure можно выбрать, какой выделенный узел использовать. Можно также использовать параметр для автоматического размещения виртуальных машин на существующих узлах в группе узлов. 

При создании новой группы узлов убедитесь, что выбран параметр Автоматическое размещение виртуальных машин. При создании виртуальной машины выберите группу узлов и позвольте Azure выбрать оптимальный узел для виртуальной машины. 

Для групп узлов, для которых включено автоматическое размещение, не требуется, чтобы все виртуальные машины автоматически размещались. Вы по-прежнему сможете явно выбрать узел, даже если для группы узлов выбрано автоматическое размещение. 

### <a name="limitations"></a>Ограничения

Известные проблемы и ограничения при использовании автоматического размещения виртуальных машин:

- Вы не сможете применять преимущества гибридного использования Azure на выделенных узлах.
- Вы не сможете повторно развернуть виртуальную машину. 
- Вы не сможете использовать виртуальные машины серии Lsv2, NVasv4, NVsv3, Msv2 или M с выделенными узлами. 


## <a name="virtual-machine-scale-set-support"></a>Поддержка масштабируемого набора виртуальных машин

Масштабируемые наборы виртуальных машин позволяют обрабатывать группы виртуальных машин как один ресурс и применять политики доступности, управления, масштабирования и оркестрации в качестве групп. Существующие выделенные узлы также можно использовать для масштабируемых наборов виртуальных машин. 

При создании масштабируемого набора виртуальных машин можно указать существующую группу узлов, чтобы все экземпляры виртуальных машин создавались на выделенных узлах.

При создании масштабируемого набора виртуальных машин в выделенной группе узлов применяются следующие требования.

- Необходимо включить автоматическое размещение виртуальных машин.
- Параметр доступности группы узлов должен соответствовать масштабируемому набору. 
    - Для региональных масштабируемых наборов следует использовать региональную группу узлов (созданную без указания зоны доступности).
    - Группа узлов и масштабируемый набор должны использовать одну и ту же зону доступности. 
    - Количество доменов сбоя для уровня группы узлов должно соответствовать количеству доменов сбоя для масштабируемого набора. Портал Azure позволяет указать *максимальное распространение* для масштабируемого набора, который устанавливает число доменов сбоя, равное 1.
- Выделенные узлы должны быть созданы первыми, с достаточной емкостью и теми же параметрами для зон масштабируемого набора и доменов сбоя.
- Поддерживаемые размеры виртуальных машин для выделенных узлов должны совпадать с размером, используемым для масштабируемого набора.

Не все параметры оркестрации и оптимизации масштабируемого набора поддерживаются выделенными узлами. Примените следующие параметры к масштабируемому набору. 
- Перенаполнение не рекомендуется, и по умолчанию отключено. Можно включить перегрузку, но при выделении масштабируемого набора произойдет сбой, если группа узлов не имеет емкости для всех виртуальных машин, включая перезагруженные экземпляры. 
- Использование режима оркестрации Скалесетвм 
- Не используйте группы размещения с учетом расположения для совместного размещения



## <a name="maintenance-control"></a>Управление обслуживанием

Инфраструктура, поддерживающая виртуальные машины, иногда может быть обновлена для повышения надежности, производительности, безопасности и запуска новых функций. Платформа Azure пытается максимально уменьшить влияние обслуживания платформы, если это возможно, но клиенты с *конфиденциальными* рабочими нагрузками не могут допускать даже несколько секунд, которые виртуальная машина должна быть заморожена или отключена для обслуживания.

**Управление обслуживанием** предоставляет клиентам возможность пропускать регулярные обновления платформы, запланированные на их отдельных узлах, а затем применять их во время выбора в течение интервала в течение 35 дней. В пределах периода обслуживания можно применять обслуживание непосредственно на уровне узла в любом порядке. После завершения периода обслуживания Корпорация Майкрософт перемещается вперед и применяет ожидающее обслуживание к узлам в порядке, который может не соответствовать определенным пользователем доменам сбоя.

Дополнительные сведения см. в разделе [Управление обновлениями платформы с помощью управления обслуживанием](./maintenance-control.md).

## <a name="capacity-considerations"></a>Рекомендации по емкости

После подготовки выделенного узла Azure назначает его физическому серверу. Это гарантирует доступность емкости при необходимости подготовки виртуальной машины. Azure использует всю емкость в регионе (или зоне) для выбора физического сервера для узла. Это также означает, что клиенты могут иметь возможность увеличивать объем выделенного узла, не заботясь о нехватке места в кластере.

## <a name="quotas"></a>Квоты

Существует два типа квоты, которые используются при развертывании выделенного узла.

1. Выделенная квота виртуальных ЦП узла. По умолчанию предельная квота составляет 3000 виртуальных ЦП для каждого региона.
1. Квота семейства размеров виртуальных машин. Например, подписка с **оплатой по мере** использования может иметь квоту 10 виртуальных ЦП, доступную для ряда Dsv3 size в регионе Восточная часть США. Чтобы развернуть выделенный узел Dsv3, необходимо запросить увеличение квоты по крайней мере до 64 виртуальных ЦП, прежде чем можно будет развернуть выделенный узел. 

Чтобы запросить увеличение квоты, создайте запрос в службу поддержки в [портал Azure](https://portal.azure.com/#blade/Microsoft_Azure_Support/HelpAndSupportBlade/newsupportrequest).

Подготовка выделенного узла будет использовать как выделенный узел виртуальных ЦП, так и квоту семейства виртуальных машин виртуальных ЦП, но не будет использоваться региональный виртуальных ЦП.


![Снимок экрана со страницей "использование и квоты" на портале](./media/virtual-machines-common-dedicated-hosts/quotas.png)

Дополнительные сведения см. в статье [квоты виртуальной машины виртуальных ЦП](./windows/quotas.md).

Бесплатная пробная версия и подписки MSDN не имеют квоты для выделенных узлов Azure.

## <a name="pricing"></a>Цены

За каждый выделенный узел начисляются пользователи независимо от того, сколько виртуальных машин развернуто. В месячной выплате вы увидите новый тип ресурса для оплаты узлов. Виртуальные машины на выделенном узле по-прежнему будут отображаться в вашем заявлении, но будут иметь цену 0.

Цена узла устанавливается на основе семейства виртуальных машин, типа (размер оборудования) и региона. Цена узла определяется по сравнению с максимальным размером виртуальной машины, поддерживаемой на узле.

Плата за использование программного обеспечения, хранение и сеть выставляется отдельно от узла и виртуальных машин. Эти оплачиваемые элементы не меняются.

Дополнительные сведения см. на странице [цен на выделенный узел Azure](https://aka.ms/ADHPricing).

Вы также можете сэкономить на затратах с помощью [зарезервированного экземпляра выделенных узлов Azure](prepay-dedicated-hosts-reserved-instances.md).
 
## <a name="sizes-and-hardware-generations"></a>Размеры и поколения оборудования

Номер SKU определяется для узла и представляет собой ряд размеров и тип виртуальной машины. Вы можете смешивать несколько виртуальных машин различных размеров на одном узле, если они имеют один и тот же размер. 

*Тип* — это создание оборудования. Различные типы оборудования для одной и той же серии виртуальных машин будут принадлежать разным поставщикам ЦП и разным поколениям ПРОЦЕССОРов и количеству ядер. 

Размеры и типы оборудования зависят от региона. Дополнительные сведения см. на [странице с ценами узлов](https://aka.ms/ADHPricing).

> [!NOTE]
> После подготавливаемый выделенного узла нельзя изменить его размер или тип. Если требуется другой размер типа, потребуется создать новый узел.  

## <a name="host-life-cycle"></a>Жизненный цикл узла


Azure отслеживает состояние работоспособности узлов и управляет им. При запросе к узлу будут возвращены следующие состояния:

| Состояние работоспособности   | Описание       |
|----------|----------------|
| Узел доступен     | Нет известных проблем с вашим узлом.   |
| Основное приложение в расследовании  | У нас возникли проблемы с ведущим узлом, о котором мы ищем. Это переходное состояние, необходимое для того, чтобы Azure попытается определить область и основную причину обнаруженной проблемы. Могут повлиять виртуальные машины, работающие на узле. |
| Ожидание освобождения узла   | Azure не удается восстановить работоспособное состояние узла и попросит повторно развернуть виртуальные машины из этого узла. Если `autoReplaceOnFailure` включен, виртуальные машины будут восстановлены  на работоспособное оборудование. В противном случае виртуальная машина может работать на узле, который собирается завершиться сбоем.|
| Узел освобожден  | Все виртуальные машины были удалены с узла. Вы больше не платите за этот узел, так как оборудование было вычислено из вращения.   |


## <a name="next-steps"></a>Дальнейшие действия

- Выделенный узел можно развернуть с помощью [Azure PowerShell](./windows/dedicated-hosts-powershell.md), [портала](./dedicated-hosts-portal.md)и [Azure CLI](./linux/dedicated-hosts-cli.md).

- [Здесь](https://github.com/Azure/azure-quickstart-templates/blob/master/201-vm-dedicated-hosts/README.md) можно найти пример шаблона, в котором используются как зоны, так и домены сбоя для обеспечения максимальной устойчивости в регионе.

- Вы также можете сэкономить на затратах с помощью [зарезервированного экземпляра выделенных узлов Azure](prepay-dedicated-hosts-reserved-instances.md).
