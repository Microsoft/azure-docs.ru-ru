---
title: Перемещение файлов на виртуальные машины Linux в Azure и обратно с помощью SCP
description: Безопасное перемещение файлов на виртуальную машину Linux в Azure и с нее с помощью SCP и пары ключей SSH.
author: cynthn
ms.service: virtual-machines
ms.collection: linux
ms.workload: infrastructure
ms.topic: how-to
ms.date: 07/12/2017
ms.author: cynthn
ms.subservice: disks
ms.openlocfilehash: 83b57055ee7a3fedab014abeab96520c3877b843
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102558446"
---
# <a name="move-files-to-and-from-a-linux-vm-using-scp"></a>Перемещение файлов на виртуальную машину Linux и с нее с помощью SCP

В этой статье показано, как перемещать файлы между рабочей станцией и виртуальной машиной Azure под управлением Linux, используя протокол SCP. Быстрое и безопасное перемещение файлов между рабочей станцией и виртуальной машиной с Linux является важной частью управления инфраструктурой Azure. 

Для этой статьи необходима виртуальная машина Linux, развернутая в Azure с помощью [файлов открытого и закрытого ключей SSH](mac-create-ssh-keys.md). Кроме того, нужен клиент SCP для локального компьютера. Он создан на основе SSH и включен в стандартную оболочку Bash на большинстве компьютеров Linux и Mac, а также в некоторые оболочки Windows.

## <a name="quick-commands"></a>Быстрые команды

Копирование файла на виртуальную машину под управлением Linux

```bash
scp file azureuser@azurehost:directory/targetfile
```

Копирование файла с виртуальной машины под управлением Linux

```bash
scp azureuser@azurehost:directory/file targetfile
```

## <a name="detailed-walkthrough"></a>Подробное пошаговое руководство

В качестве примера мы переместим файл конфигурации Azure на виртуальную машины Linux и извлечем каталог файлов журнала, используя SCP и ключи SSH.   

## <a name="ssh-key-pair-authentication"></a>Аутентификация с помощью пары ключей SSH

SCP использует SSH на транспортном уровне. Протокол SSH осуществляет аутентификацию на целевом узле, перемещая файл в зашифрованный канал, который по умолчанию предоставляется для SSH-подключения. Для аутентификации SSH можно использовать имена пользователей и пароли. Тем не менее по соображениям безопасности рекомендуется использовать аутентификацию с открытым и закрытым ключами SSH. После аутентификации подключения с помощью SSH инструмент SCP начинает копирование файла. При использовании правильно настроенного файла `~/.ssh/config`, а также открытого и закрытого ключей SSH подключение SCP можно установить, указав только имя сервера (или IP-адрес). При наличии только одного ключа SSH инструмент SCP будет искать его в каталоге `~/.ssh/` и использовать по умолчанию для входа на виртуальную машину.

Дополнительные сведения о настройке файла `~/.ssh/config`, а также открытом и закрытом ключах SSH см. в статье [Как создать и использовать пару из открытого и закрытого ключей SSH для виртуальных машин Linux в Azure](mac-create-ssh-keys.md).

## <a name="scp-a-file-to-a-linux-vm"></a>Копирование файла на виртуальную машину Linux с помощью SCP

В первом примере файл конфигурации Azure копируется на виртуальную машину Linux, которая используется для автоматизации развертывания. Так как этот файл содержит учетные данные API Azure, в том числе секреты, важно обеспечить его безопасность. Зашифрованный туннель, предоставляемый SSH-подключением, защищает содержимое файла.

Следующая команда копирует локальный файл *.azure/config* на виртуальную машину Azure с полным доменным именем *myserver.eastus.cloudapp.azure.com*. Имя пользователя администратора на этой виртуальной машине Azure — *azureuser*. Файл копируется в каталог */home/azureuser*. Подставьте собственные значения в эту команду.

```bash
scp ~/.azure/config azureuser@myserver.eastus.cloudapp.com:/home/azureuser/config
```

## <a name="scp-a-directory-from-a-linux-vm"></a>Копирование каталога с виртуальной машины Linux с помощью SCP

В этом примере выполняется копирование каталога с файлами журнала с виртуальной машины Linux на вашу рабочую станцию. Файл журнала может содержать или не содержать секретные данные. Однако применение SCP гарантирует шифрование содержимого файлов журналов. Самый простой способ передать каталог и файлы журналов на рабочую станцию — использовать SCP для безопасной передачи файлов.

Следующая команда копирует файлы из каталога */home/azureuser/logs/* на виртуальной машине Azure в локальный каталог /tmp.

```bash
scp -r azureuser@myserver.eastus.cloudapp.com:/home/azureuser/logs/. /tmp/
```

`-r`Флаг указывает scpу рекурсивно копировать файлы и каталоги из каталога, указанного в команде.  Обратите также внимание, что синтаксис для командной строки аналогичен синтаксису команды копирования `cp`.

## <a name="next-steps"></a>Дальнейшие действия

* [Управление пользователями, SSH и проверка или восстановление дисков в виртуальных машинах Azure с помощью расширения VMAccess](../extensions/vmaccess.md?toc=/azure/virtual-machines/linux/toc.json)
