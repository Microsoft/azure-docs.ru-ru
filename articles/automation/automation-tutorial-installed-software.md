---
title: Получение данных об установленном на виртуальных машинах программном обеспечении с помощью службы автоматизации Azure | Документация Майкрософт
description: В этой статье описываются сведения о программном обеспечении, установленном на виртуальных машинах в среде.
services: automation
keywords: данные инвентаризации, автоматизация, отслеживание
ms.date: 04/11/2018
ms.topic: tutorial
ms.subservice: change-inventory-management
ms.custom: mvc
ms.openlocfilehash: 8451067ae86e95269c0c2f22554e1654ac64c1e4
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "100593776"
---
# <a name="discover-what-software-is-installed-on-your-vms"></a>Получение данных об установленном программном обеспечении на виртуальных машинах

Из этого учебника вы узнаете, как использовать Отслеживание изменений и инвентаризацию в службе автоматизации Azure, чтобы определить, какое программное обеспечение установлено в среде. Вы можете собирать и просматривать сведения об установленных на компьютерах программном обеспечении, файлах, управляющих программах, службах и разделах реестра Windows. Отслеживание конфигураций поможет вам локализовать операционные проблемы в любом сегменте среды и получить сведения о текущем состоянии компьютеров.

Из этого руководства вы узнаете, как выполнить следующие задачи:

> [!div class="checklist"]
> * Включение решения для отслеживания изменений и инвентаризации
> * Включение виртуальной машины Azure
> * Включение виртуальной машины, не относящейся к Azure
> * просмотреть установленное программное обеспечение;
> * поиск установленного программного обеспечения в журналах инвентаризации.

## <a name="prerequisites"></a>Предварительные требования

Для работы с этим учебником необходимы указанные ниже компоненты.

* Подписка Azure. Если у вас ее нет, [активируйте преимущества для подписчиков MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) или [зарегистрируйте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
* [Учетная запись службы автоматизации](./index.yml) для хранения runbook наблюдателя и действия, а также задачи Наблюдателя.
* [Виртуальная машина](../virtual-machines/windows/quick-create-portal.md), для которой необходимо включить функцию.

## <a name="log-in-to-azure"></a>Вход в Azure

Войдите на портал Azure по адресу https://portal.azure.com.

## <a name="enable-change-tracking-and-inventory"></a>Включение решения для отслеживания изменений и инвентаризации

Чтобы выполнить задачи в сначала нужно настроить службу отслеживания изменений и инвентаризации. Если функция была включена ранее, этот шаг не является обязательным.

>[!NOTE]
>Если эти поля выделены серым цветом, для этой виртуальной машины включена другая функция автоматизации. Вам необходимо использовать ту же рабочую область и учетную запись службы автоматизации.

1. Перейдите к своей учетной записи службы автоматизации и в разделе **Управление конфигурацией** выберите элемент **Инвентаризация** или **Отслеживание изменений**.

2. Выберите рабочую область [Log Analytics](../azure-monitor/logs/log-query-overview.md). Эта рабочая область собирает данные, создаваемые такими компонентами, как Отслеживание изменений и инвентаризация. Рабочая область предоставляет единое расположение для проверки и анализа данных из нескольких источников.

[!INCLUDE [azure-monitor-log-analytics-rebrand](../../includes/azure-monitor-log-analytics-rebrand.md)]

3. Выберите учетную запись службы автоматизации, которую вы хотите использовать.

4. Настройте расположение для развертывания.

5. Нажмите кнопку **Включить**, чтобы развернуть функцию для виртуальной машины. 

    ![Баннер конфигурации для инвентаризации](./media/automation-tutorial-installed-software/enableinventory.png)

Во время установки виртуальная машина подготавливается к работе с помощью агента Log Analytics для Windows и [гибридной рабочей роли Runbook](automation-hybrid-runbook-worker.md). Включение функции отслеживания изменений и инвентаризации может занять до 15 минут. В это время не закрывайте окно браузера.

Когда функция будет включена, сведения об установленном программном обеспечении и изменениях на виртуальной машине начнут передаваться в журналы Azure Monitor. На получение данных для анализа может уйти от 30 минут до 6 часов.

## <a name="add-an-azure-vm-to-change-tracking-and-inventory"></a>Добавление Отслеживания изменений и инвентаризации на виртуальной машине Azure

1. В своей учетной записи службы автоматизации в разделе **Управление конфигурацией** выберите элемент **Инвентаризация** или **Отслеживание изменений**.

2. Выберите **Добавить виртуальную машину Azure**.

3. Выберите нужную виртуальную машину из списка. 

4. Щелкните элемент **Включить**, чтобы включить Отслеживание изменений и инвентаризацию на виртуальной машине. Агент Log Analytics для Windows развертывается на виртуальной машине и настраивает ее для обмена данными с рабочей областью Log Analytics. Операция установки может занять несколько минут. 

5. На этом этапе при необходимости можно выбрать новую виртуальную машину из списка, чтобы включить ее для этой функции.

## <a name="add-a-non-azure-machine-to-change-tracking-and-inventory"></a>Добавление компьютера, не связанного с Azure, для Отслеживания изменений и инвентаризации

Чтобы включить для этой функции компьютеры, не связанные с Azure, выполните приведенные ниже действия.

1. Установите [агент Log Analytics для Windows](../azure-monitor/agents/agent-windows.md) или [Log Analytics для Linux](automation-linux-hrw-install.md) в зависимости от операционной системы. 

2. Перейдите к своей учетной записи службы автоматизации и в разделе **Управление конфигурацией** выберите элемент **Инвентаризация** или **Отслеживание изменений**. 

3. Щелкните **Управление компьютерами**. Вы увидите список компьютеров, которые передают данные в рабочую область Log Analytics, для которых Отслеживание изменений и инвентаризация не включены. Выберите параметр с учетом вашей среды.

    * **Enable on all available machines** (Включить на всех доступных компьютерах) — этот параметр включает функцию на всех компьютерах, которые в данный момент передают данные в рабочую область Log Analytics.
    * **Enable on all available machines and future machines** (Включить на всех доступных и добавляемых компьютерах) — этот параметр включает функцию на всех компьютерах, которые передают данные в рабочую область Log Analytics, а также всех компьютерах, добавляемых в рабочую область.
    * **Enable on selected machines** (Включить на выбранных компьютерах) — этот параметр включает функцию только на выбранных компьютерах.

    ![Управление компьютерами](./media/automation-tutorial-installed-software/manage-machines.png)

## <a name="view-installed-software"></a>просмотреть установленное программное обеспечение;

Когда вы включите функции для отслеживания изменений и инвентаризации, собранные данные отобразятся на странице "Инвентаризация".

1. В своей учетной записи службы автоматизации в разделе **Управление конфигурацией** выберите **Инвентаризация**.

2. На странице "Инвентаризация" щелкните вкладку **Программное обеспечение**.

3. Обратите внимание на таблицу со списком обнаруженного программного обеспечения. Программное обеспечение группируется по именам и версиям. В таблице предоставляются обобщенные сведения о каждой строке с информацией о программном обеспечении. Эти сведения включают имя программного обеспечения, версию, издателя, время последнего обновления (для компьютера в этой группе) и число компьютеров (на которых установлено это программное обеспечение).

    ![Инвентаризация программного обеспечения](./media/automation-tutorial-installed-software/inventory-software.png)

4. Щелкните любую строку, чтобы просмотреть свойства программного обеспечения в этой строке и список имен компьютеров, на которых оно установлено.

5. Вы можете найти нужные программное обеспечение или группу, введя строку для поиска в текстовое поле прямо над списком программного обеспечения.
С помощью фильтра можно выполнять поиск по названию, версии и (или) издателю программного обеспечения. Например, поиск по строке **Contoso** возвращает список программного обеспечения, у которого название, имя издателя или версия содержат подстроку **Contoso**.

## <a name="search-inventory-logs-for-installed-software"></a>поиск установленного программного обеспечения в журналах инвентаризации.

Функция отслеживания изменений и инвентаризации создает данные журнала, которые отправляются в журналы Azure Monitor. Чтобы выполнить поиск по этим журналам, выберите **Log Analytics** в верхней части страницы "Инвентаризация". Данные об инвентаризации хранятся в типе `ConfigurationData`.

Следующий пример запроса Log Analytics возвращает результаты инвентаризации для издателя — корпорации Майкрософт.

```loganalytics
ConfigurationData
| where ConfigDataType == "Software"
| where Publisher == "Microsoft Corporation"
| summarize arg_max(TimeGenerated, *) by SoftwareName, Computer
```

Дополнительные сведения о поиске по файлам журналов в журналах Azure Monitor см. в статье [Анализ данных журнала в Azure Monitor](../azure-monitor/logs/log-query-overview.md).

## <a name="see-the-software-inventory-for-a-single-machine"></a>Просмотр результатов инвентаризации программного обеспечения для одного компьютера

Чтобы просмотреть результаты инвентаризации программного обеспечения для одного компьютера, откройте на странице ресурсов виртуальной машины Azure сведения об инвентаризации или примените в журналах Azure Monitor фильтр по конкретному компьютеру. Ниже приводится пример запроса Log Analytics, который возвращает список программного обеспечения на виртуальной машине с именем **ContosoVM**.

```loganalytics
ConfigurationData
| where ConfigDataType == "Software"
| summarize arg_max(TimeGenerated, *) by SoftwareName, CurrentVersion
| where Computer =="ContosoVM"
| render table
| summarize by Publisher, SoftwareName
```

## <a name="next-steps"></a>Дальнейшие действия

Из этого учебника вы узнали, как просматривать результаты инвентаризации программного обеспечения и как выполнить следующие действия:

> [!div class="checklist"]
> * Включение решения для отслеживания изменений и инвентаризации
> * Включение виртуальной машины Azure
> * Включение виртуальной машины, не относящейся к Azure
> * просмотреть установленное программное обеспечение;
> * поиск установленного программного обеспечения в журналах инвентаризации.

См. дополнительные сведения о функции отслеживания изменений и инвентаризации, чтобы узнать о ней подробнее.

> [!div class="nextstepaction"]
> [Общие сведения об отслеживании изменений и инвентаризации](change-tracking/overview.md)
