---
title: Устранение неполадок службы автоматизации Azure — проблемы функции "Отслеживание и инвентаризация изменений"
description: В этой статье рассказывается, как устранять неполадки и разрешать проблемы функции "Отслеживание и инвентаризации изменений" службы автоматизации Azure.
services: automation
ms.subservice: change-inventory-management
ms.date: 01/31/2019
ms.topic: troubleshooting
ms.openlocfilehash: 516f1a4e5e7c677b17a2941ee3c300db44d49a3b
ms.sourcegitcommit: 100390fefd8f1c48173c51b71650c8ca1b26f711
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/27/2021
ms.locfileid: "98896551"
---
# <a name="troubleshoot-change-tracking-and-inventory-issues"></a>Устранение неполадок с Отслеживанием изменений и инвентаризации

В этой статье описывается, как устранять неполадки и устранять проблемы с отслеживанием и инвентаризацией изменений в службе автоматизации Azure. Общие сведения о функциях отслеживания изменений и инвентаризации см. в [Обзор функции "Отслеживание и инвентаризация изменений"](../change-tracking/overview.md).

## <a name="windows"></a>Windows

### <a name="scenario-change-tracking-and-inventory-records-arent-showing-for-windows-machines"></a><a name="records-not-showing-windows"></a>Сценарий. Записи отслеживания и инвентаризации изменений не отображаются для компьютеров Windows

#### <a name="issue"></a>Проблема

Вы не видите никаких результатов отслеживания и инвентаризации изменений для компьютеров Windows, для которых была включена эта функция.

#### <a name="cause"></a>Причина

Эта ошибка может быть вызвана следующими причинами.

* Агент Azure Log Analytics для Windows не работает.
* Обмен данными в учетной записи службы автоматизации заблокирован.
* Не скачаны пакеты управления для отслеживания и инвентаризации изменений.
* Включенная виртуальная машина может быть взята с клонированного компьютера, который не был подготовлен с помощью программы подготовки системы (sysprep) с установленным агентом Службы анализа журналов для Windows.

#### <a name="resolution"></a>Решение

На компьютере агента Службы анализа журналов перейдите в папку **C:\Program Files\Microsoft Monitoring Agent\Agent\Tools** и выполните следующие команды.

```cmd
net stop healthservice
StopTracing.cmd
StartTracing.cmd VER
net start healthservice
```

Если вам по-прежнему нужна помощь, можно собрать сведения диагностики и обратиться в службу поддержки.

> [!NOTE]
> По умолчанию агент Службы анализа журналов включает трассировку ошибок. Чтобы включить подробные сообщения об ошибках, как в предыдущем примере, используйте параметр `VER`. Для трассировки информации используйте `INF` при вызове `StartTracing.cmd`.

##### <a name="log-analytics-agent-for-windows-not-running"></a>Агент Службы анализа журналов для Windows не работает

Убедитесь, что на компьютере выполняется агент Службы анализа журналов для Windows (**HealthService.exe**).

##### <a name="communication-to-automation-account-blocked"></a>Обмен данными с учетной записью службы автоматизации заблокирован

Проверьте компонент "Просмотр событий" на компьютере, а также найдите любые события, которые содержат слово `changetracking`.

Чтобы узнать, какие адреса и порты должны быть разрешены для работы отслеживания и инвентаризации изменений, см. [Планирование сети](../automation-hybrid-runbook-worker.md#network-planning).

##### <a name="management-packs-not-downloaded"></a>Пакеты управления не скачаны

Убедитесь, что на локальном компьютере существуют следующие пакеты управления отслеживания и инвентаризации изменений.

* `Microsoft.IntelligencePacks.ChangeTrackingDirectAgent.*`
* `Microsoft.IntelligencePacks.InventoryChangeTracking.*`
* `Microsoft.IntelligencePacks.SingletonInventoryCollection.*`

##### <a name="vm-from-cloned-machine-that-has-not-been-sysprepped"></a>Виртуальная машина на клонированном компьютере не прошла подготовки sysprep

При использовании клонированного образа сначала выполните sysprep образа, а потом установите агент Службы анализа журналов для Windows.

## <a name="linux"></a>Linux

### <a name="scenario-no-change-tracking-and-inventory-results-on-linux-machines"></a>Сценарий: Нет результатов отслеживания и инвентаризации изменений на компьютерах Linux

#### <a name="issue"></a>Проблема

Вы не видите никаких результатов отслеживания и инвентаризации изменений для компьютеров Linux, для которых включена эта функция. 

#### <a name="cause"></a>Причина
Ниже приведены возможные причины этой проблемы.
* Агент Службы анализа журналов для Linux не работает.
* Агент Службы анализа журналов для Linux настроен неправильно.
* Существуют конфликты мониторинга целостности файлов (FIM).

#### <a name="resolution"></a>Решение 

##### <a name="log-analytics-agent-for-linux-not-running"></a>Агент Службы анализа журналов для Linux не работает

Убедитесь, что управляющая программа агента Службы анализа журналов для Linux (**omsagent**) запущена на компьютере. Выполните следующий запрос в рабочей область Службы анализа журналов, связанной с вашей учетной записью службы автоматизации.

```loganalytics Copy
Heartbeat
| summarize by Computer, Solutions
```

Если компьютер не отображается в результатах запроса, он давно не синхронизировался. Вероятно, существует ошибка локальной конфигурации и необходимо переустановить агент. Сведения об установке и настройке см. в статье [Сбор данных журнала с помощью агента Службы анализа журналов](../../azure-monitor/platform/log-analytics-agent.md).

Если компьютер отображается в результатах запроса, проверьте конфигурацию области. См. [Определение решений мониторинга в Azure Monitor](../../azure-monitor/insights/solution-targeting.md).

Дополнительные сведения об устранении этой проблемы см. в разделе [Проблема: не отображаются данные Linux](../../azure-monitor/platform/agent-linux-troubleshoot.md#issue-you-are-not-seeing-any-linux-data).

##### <a name="log-analytics-agent-for-linux-not-configured-correctly"></a>Агент Службы анализа журналов для Linux неправильно настроен

Возможно, агент Службы анализа журналов для Linux неправильно настроен для сбора выходных данных журнала и командной строки с помощью средства сбора журналов OMS. См. [Обзор функции "Отслеживание и инвентаризация изменений"](../change-tracking/overview.md).

##### <a name="fim-conflicts"></a>Конфликты FIM

Возможно, функция FIM Центра безопасности Azure неправильно проверяет целостность файлов Linux. Убедитесь, что FIM работает и правильно настроена для мониторинга файлов Linux. См. [Обзор функции "Отслеживание и инвентаризация изменений"](../change-tracking/overview.md).

## <a name="next-steps"></a>Дальнейшие действия

Если вы не нашли здесь свою проблему или рекомендации не позволили ее решить, попробуйте использовать один из следующих каналов для получения дополнительной поддержки.

* Получите ответы специалистов Azure на [форумах Azure](https://azure.microsoft.com/support/forums/).
* Подпишитесь на [@AzureSupport](https://twitter.com/azuresupport) — официальный канал Microsoft Azure для работы с клиентами. Служба поддержки Azure взаимодействует с сообществом Azure, предоставляя ответы, поддержку и советы экспертов.
* Отправьте запрос в службу поддержки Azure Перейдите на [сайт поддержки Azure](https://azure.microsoft.com/support/options/) и выберите **Получить поддержку**.
