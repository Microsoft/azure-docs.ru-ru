---
title: Входящие и исходящие IP-адреса
description: Узнайте, как входящие и исходящие IP-адреса используются в службе приложений Azure при их изменении, а также о том, как найти адреса для приложения.
ms.topic: article
ms.date: 08/25/2020
ms.custom: seodec18
ms.openlocfilehash: 4237e51251a7ece05800aa7efa328a9c6cf65e76
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "104591373"
---
# <a name="inbound-and-outbound-ip-addresses-in-azure-app-service"></a>Входящие и исходящие IP-адреса в Службе приложений Azure

[Служба приложений Azure](overview.md) является мультитенантной, за исключением [сред службы приложений](environment/intro.md). Приложения, которые не находятся в среде службы приложений (то есть не находятся на [изолированном уровне](https://azure.microsoft.com/pricing/details/app-service/)), используют сетевую инфраструктуру совместно с другими приложениями. Это означает, что входящий и исходящий IP-адреса в приложении могут различаться, а в определенных ситуациях даже изменяться по ходу работы.

[Среды службы приложений](environment/intro.md) используют выделенные сетевые инфраструктуры, поэтому приложения в среде службы приложений получают выделенные статические IP-адреса для входящих и исходящих подключений.

## <a name="how-ip-addresses-work-in-app-service"></a>Как IP-адреса работают в службе приложений

Приложение службы приложений выполняется в плане службы приложений, а планы службы приложений развертываются в одну из единиц развертывания в инфраструктуре Azure (внутренне называется веб-пространством). Каждой единице развертывания назначается набор виртуальных IP-адресов, который включает один общедоступный входящий IP-адрес и набор [исходящих IP-адресов](#find-outbound-ips). Все планы службы приложений в одной и той же единице развертывания и выполняющихся в них экземплярах приложений используют один и тот же набор виртуальных IP-адресов. Для Среда службы приложений (план службы приложений на [изолированном уровне](https://azure.microsoft.com/pricing/details/app-service/)) план службы приложений — это сама единица развертывания, поэтому виртуальные IP-адреса выделены для него в результате.

Так как вы не можете переместить план службы приложений между единицами развертывания, виртуальные IP-адреса, назначенные приложению, обычно остаются неизменными, но существуют исключения.

## <a name="when-inbound-ip-changes"></a>Если изменяется входящий IP-адрес

Независимо от количества масштабированных экземпляров, каждое приложение использует только один входящий IP-адрес. Входящий IP-адрес может измениться, если вы выполните любое из следующих действий:

- Удалите приложение и повторно создайте его в другой группе ресурсов (может измениться единица развертывания).
- Удалите последнее приложение в сочетании с группой ресурсов _и_ регионом и создайте его заново (может измениться единица развертывания).
- Удаление существующей привязки TLS/SSL на основе IP-адреса, например во время обновления сертификата (см. статью об [обновлении сертификата](configure-ssl-certificate.md#renew-certificate)).

## <a name="find-the-inbound-ip"></a>Поиск входящего IP-адреса

Просто выполните следующую команду в локальном терминале:

```bash
nslookup <app-name>.azurewebsites.net
```

## <a name="get-a-static-inbound-ip"></a>Получение статического входящего IP-адреса

Для некоторых задач приложениям может потребоваться выделенный статический IP-адрес. Чтобы получить статический входящий IP-адрес, необходимо [защитить личный домен](configure-ssl-bindings.md#secure-a-custom-domain). Если для защиты приложения не требуются функции TLS, можно даже передать самозаверяющий сертификат для этой привязки. В привязке TLS на основе IP-адреса сертификат привязан к самому IP-адресу, поэтому служба приложений подготавливает статический IP-адрес, чтобы сделать это. 

## <a name="when-outbound-ips-change"></a>Если изменяются исходящие IP-адреса

Независимо от количества масштабированных экземпляров, каждое приложение в каждый конкретный момент времени использует определенный набор исходящих IP-адресов. Любое исходящее подключение из приложения службы приложений, например к внутренней базе данных, использует один из исходящих IP-адресов в качестве IP-адреса источника. Используемый IP-адрес выбирается случайным образом во время выполнения, поэтому серверная служба должна открыть свой брандмауэр для всех исходящих IP-адресов приложения.

Набор исходящих IP-адресов для приложения изменяется при выполнении одного из следующих действий.

- Удалите приложение и повторно создайте его в другой группе ресурсов (может измениться единица развертывания).
- Удалите последнее приложение в сочетании с группой ресурсов _и_ регионом и создайте его заново (может измениться единица развертывания).
- Масштабируйте свое приложение между более низкими уровнями ("**базовый**", " **стандартный**" и " **премиум**") и уровнем " **премиум v2** " (IP-адреса могут добавляться в набор или вычитаться из него).

Набор всех возможных исходящих IP-адресов, которые может использовать приложение, независимо от ценовых категорий, путем поиска `possibleOutboundIpAddresses` свойства или в поле **Дополнительные исходящие IP-адреса** в колонке **Свойства** в портал Azure. См. также раздел [Поиск исходящих IP-адресов](#find-outbound-ips).

## <a name="find-outbound-ips"></a>Поиск исходящих IP-адресов

Чтобы найти на портале Azure исходящие IP-адреса, которые используются в конкретный момент в приложении, щелкните **Свойства** в области навигации приложения слева. Они перечислены в поле **Исходящие IP-адреса** .

Эти же сведения можно получить, выполнив следующую команду в [Cloud Shell](../cloud-shell/quickstart.md).

```azurecli-interactive
az webapp show --resource-group <group_name> --name <app_name> --query outboundIpAddresses --output tsv
```

```azurepowershell
(Get-AzWebApp -ResourceGroup <group_name> -name <app_name>).OutboundIpAddresses
```

Чтобы найти _все_ возможные исходящие IP-адреса для приложения, независимо от ценовых категорий, щелкните **свойства** в левой области навигации приложения. Они перечислены в поле **Дополнительные исходящие IP-адреса** .

Эти же сведения можно получить, выполнив следующую команду в [Cloud Shell](../cloud-shell/quickstart.md).

```azurecli-interactive
az webapp show --resource-group <group_name> --name <app_name> --query possibleOutboundIpAddresses --output tsv
```

```azurepowershell
(Get-AzWebApp -ResourceGroup <group_name> -name <app_name>).PossibleOutboundIpAddresses
```

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как ограничить входящий трафик по IP-адресам источников.

> [!div class="nextstepaction"]
> [Ограничения статических IP-адресов](app-service-ip-restrictions.md)
