---
title: Безопасность
description: Сведения о том, как служба приложений помогает защитить ваше приложение, а также о последующей блокировке приложения для защиты от угроз.
keywords: azure app service, web app, mobile app, api app, function app, security, secure, secured, compliance, compliant, certificate, certificates, https, ftps, tls, trust, encryption, encrypt, encrypted, ip restriction, authentication, authorization, authn, autho, msi, managed service identity, managed identity, secrets, secret, patching, patch, patches, version, isolation, network isolation, ddos, mitm
ms.topic: article
ms.date: 08/24/2018
ms.custom: seodec18
ms.openlocfilehash: 61bffcfa8b98ed666e450c344023258b752e4880
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "98736111"
---
# <a name="security-in-azure-app-service"></a>Безопасность в Службе приложений Azure

В этой статье описывается, как [Служба приложений Azure](overview.md) помогает защитить ваше веб-приложение, серверную часть мобильного приложения и приложение API, а также [приложение-функцию](../azure-functions/index.yml). Здесь также приводятся сведения о том, как дополнительно защитить приложение с помощью встроенных функций службы приложений.

[!INCLUDE [app-service-security-intro](../../includes/app-service-security-intro.md)]

В следующих разделах показано, как в дальнейшем защитить приложение службы приложений от угроз.

## <a name="https-and-certificates"></a>Протокол HTTPS и сертификаты

Служба приложений позволяет защитить приложения с помощью протокола [HTTPS](https://wikipedia.org/wiki/HTTPS). При создании приложения его доменное имя по умолчанию ( \<app_name> . azurewebsites.NET) уже доступно по протоколу HTTPS. Если вы [настраиваете личный домен для приложения](app-service-web-tutorial-custom-domain.md), вам также нужно [защитить его с помощью TLS/SSL-сертификата](configure-ssl-bindings.md), чтобы браузеры клиента могли установить с ним безопасные HTTPS-подключения. Служба приложений поддерживает несколько типов сертификата:

- бесплатный управляемый сертификат Службы приложений;
- сертификат Службы приложений;
- сторонний сертификат;
- сертификат, импортированный из Azure Key Vault.

Чтобы узнать больше, ознакомьтесь с [добавлением TLS/SSL-сертификата в Службу приложений Azure](configure-ssl-certificate.md).

## <a name="insecure-protocols-http-tls-10-ftp"></a>Незащищенные протоколы (HTTP, TLS 1.0, FTP)

Чтобы защитить ваше приложение от всех незашифрованных подключений (HTTP), служба приложений предоставляет конфигурацию в один щелчок для принудительного использования HTTPS. Незащищенные запросы отсеиваются еще до того, как они достигнут кода приложения. Дополнительные сведения см. в разделе [Принудительное использование HTTPS](configure-ssl-bindings.md#enforce-https).

Протокол [TLS](https://wikipedia.org/wiki/Transport_Layer_Security) версии 1.0 больше не считается безопасным в соответствии с отраслевыми стандартами, такими как [PCI DSS](https://wikipedia.org/wiki/Payment_Card_Industry_Data_Security_Standard). Служба приложений позволяет отключить устаревшие протоколы путем принудительного использования протокола [TLS версии 1.1 или 1.2](configure-ssl-bindings.md#enforce-tls-versions).

Служба приложений поддерживает протоколы FTP и FTPS для развертывания файлов. Но если возможно, лучше использовать протокол FTPS вместо FTP. Если один из этих протоколов или оба протокола не используются, нужно [их отключить](deploy-ftp.md#enforce-ftps).

## <a name="static-ip-restrictions"></a>Ограничения статических IP-адресов

По умолчанию приложение службы приложений принимает запросы со всех IP-адресов из Интернета, но вы можете ограничить доступ небольшим подмножеством IP-адресов. Служба приложений в Windows позволяет определить список IP-адресов, с которых разрешен доступ к вашему приложению. Список разрешений может содержать отдельные IP-адреса или их диапазон, который определяется маской подсети. Дополнительные сведения см. в статье [Ограничения статических IP-адресов в Службе приложений Azure](app-service-ip-restrictions.md).

Для службы приложений в Windows можно также динамически ограничить IP-адреса, настроив _web.config_. Дополнительные сведения см. в разделе [Dynamic IP \<dynamicIpSecurity> Security](/iis/configuration/system.webServer/security/dynamicIpSecurity/).

## <a name="client-authentication-and-authorization"></a>Аутентификация и авторизация клиента

Служба приложений Azure обеспечивает аутентификацию "под ключ" и авторизацию пользователей или клиентских приложений. При включении с помощью такой аутентификации обеспечивается вход пользователей и клиентских приложений с минимальным использованием или без использования кода приложения. Вы можете реализовать собственное решение аутентификации и авторизации или разрешить это сделать службе приложений. Модуль аутентификации и авторизации обрабатывает веб-запросы перед их передачей коду приложения, и отклоняет несанкционированные запросы до того, как они достигнут кода.

Аутентификация и авторизация службы приложений поддерживают несколько поставщиков аутентификации, включая Azure Active Directory, учетные записи Майкрософт, Facebook, Google и Twitter. Дополнительные сведения см. в статье [Проверка подлинности и авторизация в службе приложений Azure](overview-authentication-authorization.md).

## <a name="service-to-service-authentication"></a>Аутентификация между службами

При аутентификации внутренней службы служба приложений предоставляет два разных механизма в зависимости от ваших потребностей:

- **Удостоверение службы**. Войдите в удаленный ресурс, используя удостоверение самого приложения. Служба приложений позволяет легко создать [управляемое удостоверение](overview-managed-identity.md), которое можно использовать для проверки подлинности в других службах, например в [Базе данных SQL Azure](/azure/sql-database/) или [Azure Key Vault](../key-vault/index.yml). Комплексное руководство по этому подходу см. в статье [Руководство. Безопасное подключение к базе данных SQL Azure из службы приложений с использованием управляемого удостоверения](app-service-web-tutorial-connect-msi.md).
- **От имени (OBO)** . Предоставьте делегированный доступ к удаленным ресурсам от имени пользователя. При использовании Azure Active Directory в качестве поставщика аутентификации приложение Службы приложений может выполнять делегированный вход в удаленную службу, например [API Microsoft Graph](../active-directory/develop/microsoft-graph-intro.md) или приложение удаленного API в Службе приложений. Соответствующие сведения о сквозной аутентификации для этого подхода см. в статье [Руководство по сквозной проверке подлинности и авторизации в службе приложений Azure](tutorial-auth-aad.md).

## <a name="connectivity-to-remote-resources"></a>Подключение к удаленным ресурсам

Есть три типа удаленных ресурсов, к которым приложению может потребоваться доступ: 

- [Ресурсы Azure](#azure-resources)
- [Ресурсы внутри виртуальной сети Azure](#resources-inside-an-azure-virtual-network).
- [Локальные ресурсы](#on-premises-resources).

В каждом из этих случаев служба приложений предоставляет способ выполнить безопасные подключения, но вы должны по-прежнему соблюдать рекомендации по безопасности. Например, всегда используйте зашифрованные подключения, даже если внутренний ресурс разрешает незашифрованные. Кроме того, настройте для внутренней службы Azure минимальный набор IP-адресов. Вы можете найти исходящие IP-адреса для приложения, ознакомившись со статьей [Входящие и исходящие IP-адреса в Службе приложений Azure](overview-inbound-outbound-ips.md).

### <a name="azure-resources"></a>Ресурсы Azure

Когда приложение подключается к ресурсам Azure, например [базе данных SQL](https://azure.microsoft.com/services/sql-database/) и [службе хранилища Azure](../storage/index.yml), оно остается в пределах Azure и не пересекает границы сети. Однако оно проходит через общедоступную сеть в Azure, поэтому всегда проверяйте, зашифровано ли оно. 

Если приложение размещено в [среде службы приложений](environment/intro.md), вы должны [подключиться к поддерживаемым службам Azure с использованием конечных точек служб для виртуальной сети](../virtual-network/virtual-network-service-endpoints-overview.md).

### <a name="resources-inside-an-azure-virtual-network"></a>Ресурсы внутри виртуальной сети Azure

Ваше приложение может получить доступ к ресурсам в [виртуальной сети Azure](../virtual-network/index.yml) через [интеграцию виртуальной сети](web-sites-integrate-with-vnet.md). Интеграция с виртуальной сетью устанавливается с помощью VPN-подключения "точка — сеть". Затем приложение может получить доступ к ресурсам в виртуальной сети, используя их частные IP-адреса. Тем не менее подключение "точка — сеть" все еще проходит через общие сети в Azure. 

Чтобы полностью изолировать подключение к ресурсам из общих сетей в Azure, создайте свое приложение в [среде службы приложений](environment/intro.md). Так как среда службы приложений всегда развертывается в выделенную виртуальную сеть, связь между вашим приложением и ресурсами в виртуальной сети полностью изолирована. Сведения о других аспектах безопасности сети в среде службы приложений см. в разделе об [изоляции сети](#network-isolation).

### <a name="on-premises-resources"></a>Локальные ресурсы

Есть три способа безопасного получения доступа к локальным ресурсам, таким как базы данных. 

- [Гибридное подключение](app-service-hybrid-connections.md). Устанавливает подключение типа "точка — точка" к удаленному ресурсу через TCP-туннель. TCP-туннель устанавливается с помощью протокола TLS 1.2 с общедоступными ключами подписи (SAS).
- [Интеграция виртуальной сети](web-sites-integrate-with-vnet.md) с VPN-подключением "сеть — сеть". Выполняется, как описано в разделе о [ресурсах внутри виртуальной сети Azure](#resources-inside-an-azure-virtual-network), но виртуальную сеть можно подключить к локальной сети через [VPN-подключение "сеть — сеть"](../vpn-gateway/tutorial-site-to-site-portal.md). В этой топологии сети приложение может подключаться к локальным ресурсам, например другим ресурсам в виртуальной сети.
- [Среда службы приложений](environment/intro.md) с VPN-подключением "сеть — сеть". Сведения описаны в разделе о [ресурсах внутри виртуальной сети Azure](#resources-inside-an-azure-virtual-network), но виртуальную сеть можно подключить к локальной сети через [VPN-подключение "сеть — сеть"](../vpn-gateway/tutorial-site-to-site-portal.md). В этой топологии сети приложение может подключаться к локальным ресурсам, например другим ресурсам в виртуальной сети.

## <a name="application-secrets"></a>Секреты приложений

Не храните секреты приложений, такие как учетные данные базы данных, маркеры API и закрытые ключи в файлах кода или конфигурации. Общепринятым подходом является доступ к ним как [переменным среды](https://wikipedia.org/wiki/Environment_variable) с использованием стандартного шаблона на выбранном вами языке. В службе приложений определить переменные среды можно с помощью [параметров приложения](configure-common.md#configure-app-settings) (и, особенно для приложений .NET, [строк подключения](configure-common.md#configure-connection-strings)). Параметры приложения и строки подключения хранятся в зашифрованном виде в Azure, и расшифровываются только перед введением в память процесса приложения при его запуске. Ключи шифрования регулярно меняются.

Кроме того, вы можете интегрировать приложение службы приложений с [Azure Key Vault](../key-vault/index.yml) для расширенного управления секретами. При получении [доступа к Key Vault с помощью управляемого удостоверения](../key-vault/general/tutorial-net-create-vault-azure-web-app.md) приложение службы приложений может безопасно получить доступ к нужным секретам.

## <a name="network-isolation"></a>Сетевая изоляция

За исключением ценового уровня **Изолированный** на всех уровнях приложения запускаются в общей сетевой инфраструктуре в службе приложений. Например, общедоступные IP-адреса и интерфейсные подсистемы балансировки нагрузки используются совместно с другими клиентами. **Изолированный** уровень обеспечивает полную изоляцию сети с помощью запуска приложений внутри выделенной [среды службы приложений](environment/intro.md). Среда службы приложений запускается в вашем экземпляре [виртуальной сети Azure](../virtual-network/index.yml). Это дает такие возможности: 

- Выполнить обслуживание приложений через выделенную общедоступную конечную точку с выделенными внешними интерфейсами.
- Выполнить обслуживание внутреннего приложения с помощью внутреннего балансировщика нагрузки (ILB), который обеспечивает доступ только внутри виртуальной сети Azure. У балансировщика ILB есть IP-адрес из частной подсети, который обеспечивает полную изоляцию приложений из Интернета.
- [Использовать балансировщик ILB за брандмауэром веб-приложения(WAF)](environment/integrate-with-application-gateway.md). WAF предлагает защиту на уровне предприятия для общедоступных приложений, такую как защита от атак DDoS, фильтрация URI и предотвращение внедрения SQL.

Дополнительные сведения см. в статье [Общие сведения о средах службы приложений](environment/intro.md).