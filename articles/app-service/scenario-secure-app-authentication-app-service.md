---
title: Учебник. Добавление проверки подлинности в веб-приложение в Службе приложений Azure | Azure
description: Из этого учебника вы узнаете, как включить проверку подлинности и авторизацию в веб-приложении, работающем в Службе приложений Azure. Ограничьте доступ к веб-приложению для пользователей в организации.
services: active-directory, app-service-web
author: rwike77
manager: CelesteDG
ms.service: app-service-web
ms.topic: tutorial
ms.workload: identity
ms.date: 11/09/2020
ms.author: ryanwi
ms.reviewer: stsoneff
ms.custom: azureday1
ms.openlocfilehash: a8bd2ef1348692bf57f7e5cb7b6606cfcfd324fe
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96905576"
---
# <a name="tutorial-add-authentication-to-your-web-app-running-on-azure-app-service"></a>Руководство по добавлению проверки подлинности в веб-приложение, работающее в Службе приложений Azure

Узнайте, как включить проверку подлинности в веб-приложении, работающем в Службе приложений Azure, и ограничить доступ для пользователей в организации.

:::image type="content" source="./media/scenario-secure-app-authentication-app-service/web-app-sign-in.svg" alt-text="Экран &quot;Схема, отображающая вход пользователя.&quot;" border="false":::

Служба приложений обеспечивает встроенную поддержку проверки подлинности и авторизации, поэтому для входа пользователей в систему и предоставления доступа к данным необходимо написать минимальный код или обойтись без кода в веб-приложении. Использовать модуль проверки подлинности и авторизации Службы приложений не обязательно, но это упрощает проверку подлинности и авторизацию для вашего приложения. В этой статье показано, как защитить веб-приложение с помощью модуля проверки подлинности и авторизации Службы приложений, используя Azure Active Directory (Azure AD) в качестве поставщика удостоверений.

Модуль аутентификации и авторизации включается и настраивается с помощью параметров портала Azure и приложения. Для кода приложения не нужны пакеты SDK, определенные языки или изменения. Поскольку модуль поддерживает различные поставщики удостоверений, включая Azure AD, учетную запись Майкрософт, Facebook, Google и Twitter. Если модуль аутентификации и авторизации включен, каждый входящий HTTP-запрос проходит через него перед обработкой кодом приложения. Дополнительные сведения см. в статье [Проверка подлинности и авторизация в службе приложений Azure](overview-authentication-authorization.md).

В этом руководстве вы узнаете, как:

> [!div class="checklist"]
>
> * настроить проверку подлинности для веб-приложения;
> * ограничить доступ к веб-приложению для пользователей в организации.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

## <a name="create-and-publish-a-web-app-on-app-service"></a>Создание и публикация веб-приложения в Службе приложений

Для работы с этим учебником потребуется развернуть веб-приложение в Службе приложений. Вы можете использовать существующее веб-приложение или создать и опубликовать веб-приложение в Службе приложений, выполнив инструкции из [краткого руководства по ASP.NET Core](quickstart-dotnetcore.md).

Независимо от того, создали вы веб-приложение или используете существующее, запишите имя веб-приложения и группы ресурсов, в которой развернуто веб-приложение. Эти имена вам понадобятся при дальнейшей работе с этим учебником. В этом учебнике примеры имен в процедурах и на снимках экрана содержат *SecureWebApp*.

## <a name="configure-authentication-and-authorization"></a>Настройка проверки подлинности и авторизации

Теперь у вас есть веб-приложение, работающее в Службе приложений. Вы можете включить проверку подлинности и авторизацию для веб-приложения. В качестве поставщика удостоверений будет использоваться Azure AD. Дополнительные сведения см. в статье [Настройка проверки подлинности Azure AD для приложения Службы приложений](configure-authentication-provider-aad.md).

В меню [портала Azure](https://portal.azure.com) выберите **Группы ресурсов** или выполните поиск по запросу **Группы ресурсов** на любой странице и выберите этот пункт.

В разделе **Группы ресурсов** найдите и выберите свою группу ресурсов. В разделе **Обзор** выберите страницу управления приложения.

:::image type="content" alt-text="Снимок экрана, на котором показано, как выбрать страницу управления приложения." source="./media/scenario-secure-app-authentication-app-service/select-app-service.png":::

В левом меню вашего приложения выберите **Проверка подлинности или авторизация**, а затем включите проверку подлинности Службы приложений, выбрав **Включено**.

В раскрывающемся списке **Предпринимаемое действие, если проверка подлинности для запроса не выполнена** выберите **Войти с использованием Azure Active Directory**.

В разделе **Поставщики проверки подлинности** выберите **Azure Active Directory**. Выберите **Экспресс**, а затем примите настройки по умолчанию, чтобы создать приложение Active Directory. Щелкните **ОК**.

:::image type="content" alt-text="Снимок экрана: проверка подлинности типа &quot;Экспресс&quot;." source="./media/scenario-secure-app-authentication-app-service/configure-authentication.png":::

На странице **Проверка подлинности или авторизация** нажмите кнопку **Сохранить**.

После того как вы увидите уведомление с сообщением `Successfully saved the Auth Settings for <app-name> App`, обновите страницу портала.

Теперь у вас есть приложение, которое защищено функциями проверки подлинности и авторизации в Службе приложений.

## <a name="verify-limited-access-to-the-web-app"></a>Проверка ограниченного доступа к веб-приложению

При включении модуля проверки подлинности и авторизации Службы приложений в клиенте Azure AD была создана регистрация приложения. Регистрация приложения имеет то же отображаемое имя, что и веб-приложение. Чтобы проверить параметры, выберите в меню портала **Azure Active Directory**, а затем — **Регистрация приложений**. Выберите созданную регистрацию приложения. На странице обзора убедитесь, что для параметра **Поддерживаемые типы учетных записей** задано значение **Только моя организация**.

:::image type="content" alt-text="Снимок экрана: проверка доступа." source="./media/scenario-secure-app-authentication-app-service/verify-access.png":::

Чтобы убедиться, что для пользователей вашей организации ограничен доступ к приложению, запустите браузер в режиме инкогнито или частном режиме и перейдите по адресу `https://<app-name>.azurewebsites.net`. Вы должны быть перенаправлены на защищенную страницу входа. Это доказывает, что пользователи, которые не прошли проверку подлинности, не имеют доступа к сайту. Войдите в систему как пользователь организации, чтобы получить доступ к сайту. Вы также можете открыть новый браузер и попытаться войти с помощью личной учетной записи, чтобы убедиться, что у пользователей за пределами организации нет доступа.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы завершили работу с этим учебником и вам больше не требуется веб-приложение или связанные с ним ресурсы, необходимо [очистить созданные ресурсы](scenario-secure-app-clean-up-resources.md).

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как:

> [!div class="checklist"]
>
> * настроить проверку подлинности для веб-приложения;
> * ограничить доступ к веб-приложению для пользователей в организации.

> [!div class="nextstepaction"]
> [Доступ Службы приложения к хранилищу](scenario-secure-app-access-storage.md)
