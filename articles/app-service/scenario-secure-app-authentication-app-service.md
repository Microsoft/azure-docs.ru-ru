---
title: Учебник. Добавление проверки подлинности в веб-приложение в Службе приложений Azure | Azure
description: Из этого учебника вы узнаете, как включить проверку подлинности и авторизацию в веб-приложении, работающем в Службе приложений Azure. Ограничьте доступ к веб-приложению для пользователей в организации.
services: active-directory, app-service-web
author: rwike77
manager: CelesteDG
ms.service: app-service-web
ms.topic: tutorial
ms.workload: identity
ms.date: 04/02/2021
ms.author: ryanwi
ms.reviewer: stsoneff
ms.custom: azureday1
ms.openlocfilehash: b17cb6906a37d2cab4383fac18400b35dc8adb2f
ms.sourcegitcommit: 3f684a803cd0ccd6f0fb1b87744644a45ace750d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/02/2021
ms.locfileid: "106223211"
---
# <a name="tutorial-add-authentication-to-your-web-app-running-on-azure-app-service"></a>Руководство по добавлению проверки подлинности в веб-приложение, работающее в Службе приложений Azure

Узнайте, как включить проверку подлинности в веб-приложении, работающем в Службе приложений Azure, и ограничить доступ для пользователей в организации.

:::image type="content" source="./media/scenario-secure-app-authentication-app-service/web-app-sign-in.svg" alt-text="Экран &quot;Схема, отображающая вход пользователя.&quot;" border="false":::

Служба приложений обеспечивает встроенную поддержку проверки подлинности и авторизации, поэтому для входа пользователей в систему и предоставления доступа к данным необходимо написать минимальный код или обойтись без кода в веб-приложении. Использовать модуль проверки подлинности и авторизации Службы приложений не обязательно, но это упрощает проверку подлинности и авторизацию для вашего приложения. В этой статье показано, как защитить веб-приложение с помощью модуля проверки подлинности и авторизации Службы приложений, используя Azure Active Directory (Azure AD) в качестве поставщика удостоверений.

Модуль аутентификации и авторизации включается и настраивается с помощью параметров портала Azure и приложения. Для кода приложения не нужны пакеты SDK, определенные языки или изменения. Поскольку модуль поддерживает различные поставщики удостоверений, включая Azure AD, учетную запись Майкрософт, Facebook, Google и Twitter. Если модуль аутентификации и авторизации включен, каждый входящий HTTP-запрос проходит через него перед обработкой кодом приложения. Дополнительные сведения см. в статье [Проверка подлинности и авторизация в службе приложений Azure](overview-authentication-authorization.md).

В этом руководстве вы узнаете, как:

> [!div class="checklist"]
>
> * настроить проверку подлинности для веб-приложения;
> * ограничить доступ к веб-приложению для пользователей в организации.

[!INCLUDE [quickstarts-free-trial-note](../../includes/quickstarts-free-trial-note.md)]

## <a name="create-and-publish-a-web-app-on-app-service"></a>Создание и публикация веб-приложения в Службе приложений

Для работы с этим учебником потребуется развернуть веб-приложение в Службе приложений. Вы можете использовать существующее веб-приложение или создать и опубликовать веб-приложение в Службе приложений, выполнив инструкции из [краткого руководства по ASP.NET Core](quickstart-dotnetcore.md).

Независимо от того, создали вы веб-приложение или используете существующее, запишите имя веб-приложения и группы ресурсов, в которой развернуто веб-приложение. Эти имена вам понадобятся при дальнейшей работе с этим учебником. 

## <a name="configure-authentication-and-authorization"></a>Настройка проверки подлинности и авторизации

Теперь у вас есть веб-приложение, работающее в Службе приложений. Вы можете включить проверку подлинности и авторизацию для веб-приложения. В качестве поставщика удостоверений будет использоваться Azure AD. Дополнительные сведения см. в статье [Настройка проверки подлинности Azure AD для приложения Службы приложений](configure-authentication-provider-aad.md).

В меню [портала Azure](https://portal.azure.com) выберите **Группы ресурсов** или выполните поиск по запросу **Группы ресурсов** на любой странице и выберите этот пункт.

В разделе **Группы ресурсов** найдите и выберите свою группу ресурсов. В разделе **Обзор** выберите страницу управления приложения.

:::image type="content" alt-text="Снимок экрана, на котором показано, как выбрать страницу управления приложения." source="./media/scenario-secure-app-authentication-app-service/select-app-service.png":::

В меню слева в приложении выберите **Проверка подлинности** и щелкните **Добавить поставщик удостоверений**.

На странице **Добавление поставщика удостоверений** выберите **Майкрософт** в качестве **поставщика удостоверений** для входа в удостоверения Майкрософт и Azure AD.

В разделе **Регистрация приложения** > **Тип регистрации приложения** выберите **Создание регистрации приложения**.

В разделе **Регистрация приложения** > **Поддерживаемые типы учетных записей** выберите **Текущий клиент — один клиент**.

В разделе **Параметры проверки подлинности службы приложений** оставьте для параметра **Проверка подлинности** значение **Требуется проверка подлинности**, а для параметра **Запросы без проверки подлинности** — значение **Перенаправление HTTP 302 Found: рекомендуется для веб-сайтов**.

В нижней части страницы **Добавление поставщика удостоверений** нажмите кнопку **Добавить**, чтобы включить проверку подлинности для веб-приложения.

:::image type="content" alt-text="Снимок экрана: настройка проверки подлинности." source="./media/scenario-secure-app-authentication-app-service/configure-authentication.png":::

Теперь у вас есть приложение, которое защищено функциями проверки подлинности и авторизации в Службе приложений.

## <a name="verify-limited-access-to-the-web-app"></a>Проверка ограниченного доступа к веб-приложению

При включении модуля проверки подлинности и авторизации Службы приложений в клиенте Azure AD была создана регистрация приложения. Регистрация приложения имеет то же отображаемое имя, что и веб-приложение. Чтобы проверить параметры, выберите в меню портала **Azure Active Directory**, а затем — **Регистрация приложений**. Выберите созданную регистрацию приложения. На странице обзора убедитесь, что для параметра **Поддерживаемые типы учетных записей** задано значение **Только моя организация**.

:::image type="content" alt-text="Снимок экрана: проверка доступа." source="./media/scenario-secure-app-authentication-app-service/verify-access.png":::

Чтобы убедиться, что для пользователей вашей организации ограничен доступ к приложению, запустите браузер в режиме инкогнито или частном режиме и перейдите по адресу `https://<app-name>.azurewebsites.net`. Вы должны быть перенаправлены на защищенную страницу входа. Это доказывает, что пользователи, которые не прошли проверку подлинности, не имеют доступа к сайту. Войдите в систему как пользователь организации, чтобы получить доступ к сайту. Вы также можете открыть новый браузер и попытаться войти с помощью личной учетной записи, чтобы убедиться, что у пользователей за пределами организации нет доступа.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы завершили работу с этим учебником и вам больше не требуется веб-приложение или связанные с ним ресурсы, необходимо [очистить созданные ресурсы](scenario-secure-app-clean-up-resources.md).

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как:

> [!div class="checklist"]
>
> * настроить проверку подлинности для веб-приложения;
> * ограничить доступ к веб-приложению для пользователей в организации.

> [!div class="nextstepaction"]
> [Доступ Службы приложения к хранилищу](scenario-secure-app-access-storage.md)
