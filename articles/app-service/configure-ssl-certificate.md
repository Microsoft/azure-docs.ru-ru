---
title: Добавление TLS/SSL-сертификатов и управление ими
description: Создайте бесплатный сертификат, импортируйте сертификат Службы приложений, сертификат Key Vault или купите сертификат Службы приложений в Службе приложений Azure.
tags: buy-ssl-certificates
ms.topic: tutorial
ms.date: 10/25/2019
ms.reviewer: yutlin
ms.custom: seodec18
ms.openlocfilehash: e563981d3a68375105256aa6015aa94ada91326b
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101711711"
---
# <a name="add-a-tlsssl-certificate-in-azure-app-service"></a>Добавление TLS/SSL-сертификата в Службу приложений Azure

[Служба приложений Azure](overview.md) — это служба веб-размещения с самостоятельной установкой исправлений и высоким уровнем масштабируемости. В этой статье показано, как создать, передать или импортировать закрытый или общедоступный сертификат в Службу приложений. 

После добавления сертификата в приложение Службы приложений или [приложение-функцию](../azure-functions/index.yml) с его помощью можно [защитить настраиваемое DNS-имя](configure-ssl-bindings.md) или [использовать его в коде приложения](configure-ssl-certificate-in-code.md).

> [!NOTE]
> Сертификат, переданный в приложение, хранится в единице развертывания, привязанной к сочетанию группы ресурсов и региона приложения (внутренне называется *веб-пространством*). Это сделает сертификат доступным другим приложениям в том же сочетании группы ресурсов и региона. 

В следующей таблице перечислены варианты добавления сертификатов в Службу приложений.

|Параметр|Описание|
|-|-|
| Создание бесплатного управляемого сертификата Службы приложений (предварительная версия) | Закрытый сертификат, который легко использовать, если требуется только защитить [личный домен](app-service-web-tutorial-custom-domain.md) `www` или любой другой защищенный домен в Службе приложений. |
| Приобретение сертификата Службы приложений | Закрытый сертификат, управляемый Azure. Он сочетает простоту автоматического управления сертификатами и гибкость возможностей продления и экспорта. |
| Импорт сертификата из Key Vault | Это удобно, если вы используете [Azure Key Vault](../key-vault/index.yml) для управления [сертификатами PKCS12](https://wikipedia.org/wiki/PKCS_12). Ознакомьтесь с [требованиями к закрытым сертификатам](#private-certificate-requirements). |
| Передача закрытого сертификата | Если у вас уже есть закрытый сертификат от стороннего поставщика, вы можете его передать. Ознакомьтесь с [требованиями к закрытым сертификатам](#private-certificate-requirements). |
| Передача открытого сертификата | Открытые сертификаты не используются для защиты личных доменов, но их можно загрузить в код, если они нужны для доступа к удаленным ресурсам. |

## <a name="prerequisites"></a>предварительные требования

Ознакомьтесь со следующими статьями:

- [Создайте приложение службы приложений](./index.yml).
- Только бесплатный сертификат: сопоставьте поддомен (например, `www.contoso.com`) со Службой приложений с помощью [записи CNAME](app-service-web-tutorial-custom-domain.md#map-a-cname-record).

## <a name="private-certificate-requirements"></a>Требования к закрытым сертификатам

> [!NOTE]
> Веб-приложения Azure **не** поддерживают AES256, поэтому все PFX-файлы должны быть зашифрованы с помощью TripleDES.

И [бесплатный управляемый сертификат Службы приложений](#create-a-free-certificate-preview), и [сертификат Службы приложений](#import-an-app-service-certificate) соответствуют требованиям Службы приложений. Если вы решили передать или импортировать закрытый сертификат в Службу приложений, то этот сертификат должен соответствовать следующим требованиям. Он:

* должен быть экспортирован в [PFX-файл, защищенный паролем](https://en.wikipedia.org/w/index.php?title=X.509&section=4#Certificate_filename_extensions);
* должен содержать закрытый ключ длиной не менее 2048 битов;
* должен содержать все промежуточные сертификаты из цепочки сертификатов.

Чтобы защитить личный домен в привязке TLS, сертификат должен соответствовать дополнительным требованиям:

* должен содержать данные [расширенного использования ключа](https://en.wikipedia.org/w/index.php?title=X.509&section=4#Extensions_informing_a_specific_usage_of_a_certificate) для аутентификации сервера (OID = 1.3.6.1.5.5.7.3.1);
* должен быть подписан доверенным центром сертификации;

> [!NOTE]
> **Сертификаты с шифрованием на основе эллиптических кривых (ECC)** можно использовать со службой приложений, но это не описано в этой статье. Чтобы создать сертификаты ECC, обратитесь к своему центру сертификации за конкретными указаниями.

[!INCLUDE [Prepare your web app](../../includes/app-service-ssl-prepare-app.md)]

## <a name="create-a-free-certificate-preview"></a>Создание бесплатного сертификата (предварительная версия)

Бесплатный управляемый сертификат Службы приложений — это полноценное решение для защиты настраиваемого DNS-имени в Службе приложений. Это полностью функциональный TLS/SSL-сертификат, который управляется Службой приложений и обновляется автоматически. Бесплатный сертификат имеет следующие ограничения:

- не поддерживает групповые сертификаты;
- не поддерживает незащищенные домены;
- не может быть экспортирован;
- не поддерживается в Среде службы приложений (ASE);
- не поддерживает записи A (например, автоматическое продление не работает с записями A).

> [!NOTE]
> бесплатный сертификат выдается DigiCert. Для некоторых доменов верхнего уровня необходимо явно разрешить DigiCert как издателя сертификата, создав [запись домена CAA](https://wikipedia.org/wiki/DNS_Certification_Authority_Authorization) со значением: `0 issue digicert.com`.
> 

Вот как можно создать бесплатный управляемый сертификат Службы приложений.

На <a href="https://portal.azure.com" target="_blank">портале Azure</a> в меню слева выберите **Службы приложений** >  **\<app-name>** .

В левой области навигации приложения выберите **Параметры TLS/SSL** > **Сертификаты закрытых ключей (PFX)**  > **Создание управляемого сертификата Службы приложений**.

![Создание бесплатного сертификата в Службе приложений](./media/configure-ssl-certificate/create-free-cert.png)

В диалоговом окне отображаются все защищенные домены, которые правильно сопоставлены с приложением с помощью записи CNAME. Выберите личный домен, для которого нужно создать бесплатный сертификат, и выберите **Создать**. Для каждого поддерживаемого личного домена можно создать только один сертификат.

По завершении операции вы увидите сертификат в списке **Сертификаты закрытых ключей**.

![Создание бесплатного сертификата завершено](./media/configure-ssl-certificate/create-free-cert-finished.png)

> [!IMPORTANT] 
> Чтобы защитить личный домен с помощью этого сертификата, необходимо создать привязку к сертификату. Следуйте инструкциям в разделе [Create binding](configure-ssl-bindings.md#create-binding) (Создание привязки).
>

## <a name="import-an-app-service-certificate"></a>Импорт сертификата Службы приложений

Если вы приобрели сертификат Службы приложений из Azure, то Azure управляет следующими задачами:

- осуществляет процесс приобретения на GoDaddy;
- выполняет проверку домена сертификата;
- хранит сертификат в [Azure Key Vault](../key-vault/general/overview.md);
- управляет продлением сертификата (ознакомьтесь с разделом [Renew certificate](#renew-certificate) (Продление сертификата));
- автоматически синхронизирует сертификат с импортированными копиями в приложениях Службы приложений.

Чтобы приобрести сертификат Службы приложений, перейдите к разделу [Start certificate order](#start-certificate-order) (Заказ сертификата).

Если у вас уже есть действующий сертификат Службы приложений, вы можете:

- [импортировать сертификат в Службу приложений](#import-certificate-into-app-service);
- [управлять сертификатом](#manage-app-service-certificates), например, продлить срок действия, переназначить ключ и экспортировать его.
> [!NOTE]
> В настоящее время служба "Сертификаты службы приложений" не поддерживается в национальных облаках Azure.

### <a name="start-certificate-order"></a>Порядок работы с сертификатом

Порядок работы с сертификатом службы приложений находится на <a href="https://portal.azure.com/#create/Microsoft.SSL" target="_blank">странице создания сертификаты службы приложений</a>.

![Приобретение сертификата Службы приложений](./media/configure-ssl-certificate/purchase-app-service-cert.png)

Чтобы выполнить настройку сертификата, воспользуйтесь сведениями из следующей таблицы. По завершении нажмите кнопку **Создать**.

| Параметр | Описание |
|-|-|
| Имя | Понятное имя сертификата службы приложений. |
| Имя узла незащищенного домена | Укажите здесь корневой домен. Выданный сертификат защищает *оба* домена: корневой домен и поддомен `www`. В выданном сертификате поле "Common Name" (Общее имя) содержит корневой домен, а поле "Subject Alternative Name" (Альтернативное имя субъекта) — домен `www`. Чтобы защитить только поддомен, укажите здесь полное доменное имя вместе с поддоменом (например, `mysubdomain.contoso.com`).|
| Подписка | Подписка, которая будет содержать сертификат. |
| Группа ресурсов | Группа ресурсов, которая будет содержать сертификат. Например, можно использовать новую группу ресурсов или ту же группу ресурсов, что и для приложения службы приложений. |
| SKU сертификата | Определяет тип создаваемого сертификата независимо от того, является ли сертификат стандартным или [групповым](https://wikipedia.org/wiki/Wildcard_certificate). |
| Условия использования | Щелкните, чтобы подтвердить, что вы принимаете условия использования. Сертификаты можно получить на сайте GoDaddy. |

> [!NOTE]
> Сертификаты службы приложений, приобретенные в Azure, выдаются GoDaddy. Для некоторых доменов верхнего уровня необходимо явно разрешить GoDaddy как издателя сертификата, создав [запись домена CAA](https://wikipedia.org/wiki/DNS_Certification_Authority_Authorization) со значением: `0 issue godaddy.com`.
> 

### <a name="store-in-azure-key-vault"></a>Хранение в Azure Key Vault

После завершения процесса приобретения сертификата нужно выполнить еще некоторые действия, прежде чем его можно будет использовать. 

На странице [Сертификаты службы приложений](https://portal.azure.com/#blade/HubsExtension/Resources/resourceType/Microsoft.CertificateRegistration%2FcertificateOrders) выберите сертификат и щелкните **Конфигурация сертификата** > **Шаг 1. Сохранение**.

![Настройка хранилища Key Vault для сертификата Службы приложений](./media/configure-ssl-certificate/configure-key-vault.png)

[Key Vault](../key-vault/general/overview.md) — это служба Azure, которая помогает защитить криптографические ключи и секреты, используемые облачными приложениями и службами. Данное хранилище можно выбрать для сертификатов службы приложений.

Чтобы создать новое хранилище или выбрать существующее, на странице **Состояние Key Vault** щелкните **Репозиторий Key Vault**. Если был выбран вариант создать новое хранилище, то для его настройки используйте сведения из следующей таблицы, а затем щелкните "Создать". Создайте новое Хранилище ключей в той же подписке и группе ресурсов, что и приложение Службы приложений.

| Параметр | Описание |
|-|-|
| Имя | Уникальное имя, содержащее буквы, цифры и дефисы. |
| Группа ресурсов | Рекомендуется выбирать группу ресурсов, идентичную сертификату службы приложений. |
| Расположение | Предназначено для выбора расположения, идентичного тому, где находится приложение службы приложений. |
| Ценовая категория | Дополнительные сведения см. в статье [Цены на Key Vault ](https://azure.microsoft.com/pricing/details/key-vault/). |
| Политики доступа| Определяет приложения и разрешает доступ к ресурсам хранилища. Ее можно настроить позднее, выполнив инструкции из статьи [Назначение политики доступа к Key Vault с помощью портала Azure](../key-vault/general/assign-access-policy-portal.md). |
| Доступ к виртуальной сети | Ограничьте доступ к хранилищу для определенных виртуальных сетей Azure. Воспользовавшись сведениями из статьи [Настройка брандмауэров и виртуальных сетей Azure Key Vault](../key-vault/general/network-security.md), его можно настроить потом. |

После выбора хранилища закройте страницу **Репозиторий Key Vault**. Возле параметра **Шаг 1. Сохранение** должен отображаться зеленый значок галочки, который оповещает об успехе. На протяжении выполнения следующего шага данная страница должна быть открыта.

### <a name="verify-domain-ownership"></a>Проверка принадлежности домена;

На той же странице **Конфигурация сертификата**, которую вы использовали в последнем шаге, щелкните **Шаг 2. Проверка**.

![Проверка домена для сертификата Службы приложений](./media/configure-ssl-certificate/verify-domain.png)

Выберите **Проверка службы приложений**. Так как домен уже был сопоставлен веб-приложением ранее (см. раздел [Предварительные требования](#prerequisites)), он считается проверенным. Щелкните **Проверка** для завершения. Нажимайте кнопку **Обновить** до того момента, пока не появится сообщение **Домен для сертификата проверен**.

> [!NOTE]
> Поддерживаются четыре метода проверки домена. 
> 
> - **Служба приложений** —это наиболее удобный вариант проверки домена, который уже был сопоставлен с приложением службы приложений в одной подписке. Преимущество этого метода в том, что приложение службы приложений уже проверило владельца домена.
> - **Домен**. Выполняется проверка [домена службы приложений, который вы приобрели в Azure](manage-custom-dns-buy-domain.md). Azure автоматически добавляет проверочную запись типа TXT и завершает процесс.
> - **Почта**. Выполняется проверка домена путем отправки электронной почты администратору домена. После выбора данного параметра будут предоставлены инструкции.
> - **Вручную**. Выполняется проверка, используется ли в домене HTML-страница (только для сертификата типа **Стандартный**) или запись типа TXT DNS. После выбора данного параметра будут предоставлены инструкции.

### <a name="import-certificate-into-app-service"></a>Импорт сертификата в Службу приложений

На <a href="https://portal.azure.com" target="_blank">портале Azure</a> в меню слева выберите **Службы приложений** >  **\<app-name>** .

В левой области навигации приложения выберите **Параметры TLS/SSL** > **Сертификаты закрытых ключей (PFX)**  > **Импортировать сертификат службы приложений**.

![Импорт сертификата Службы приложений в Службу приложений](./media/configure-ssl-certificate/import-app-service-cert.png)

Выберите приобретенный сертификат и нажмите кнопку **ОК**.

По завершении операции вы увидите сертификат в списке **Сертификаты закрытых ключей**.

![Импорт сертификата Службы приложений завершен](./media/configure-ssl-certificate/import-app-service-cert-finished.png)

> [!IMPORTANT] 
> Чтобы защитить личный домен с помощью этого сертификата, необходимо создать привязку к сертификату. Следуйте инструкциям в разделе [Create binding](configure-ssl-bindings.md#create-binding) (Создание привязки).
>

## <a name="import-a-certificate-from-key-vault"></a>Импорт сертификата из Key Vault

Если для управления сертификатами используется Azure Key Vault, то можно импортировать сертификат PKCS12 из Key Vault в Службу приложений, если он [соответствует требованиям](#private-certificate-requirements).

### <a name="authorize-app-service-to-read-from-the-vault"></a>Авторизация Службы приложений на чтение из хранилища
По умолчанию поставщик ресурсов Службы приложений не имеет доступ к Key Vault. Чтобы использовать Key Vault для развертывания сертификата, необходимо [авторизовать для поставщика ресурсов доступ на чтение к KeyVault](../key-vault/general/assign-access-policy-cli.md). 

`abfa0a7c-a6b6-4736-8310-5855508787cd` — это имя субъекта-службы поставщика ресурсов для Службы приложений, одинаковое для всех подписок Azure. Для облачной среды Azure для государственных организаций используйте `6a02c803-dafd-4136-b4c3-5a6f318b4714` вместо имени субъекта-службы поставщика ресурсов.

### <a name="import-a-certificate-from-your-vault-to-your-app"></a>Импорт сертификата из хранилища в приложение

На <a href="https://portal.azure.com" target="_blank">портале Azure</a> в меню слева выберите **Службы приложений** >  **\<app-name>** .

В левой области навигации приложения выберите **Параметры TLS/SSL** > **Сертификаты закрытых ключей (PFX)**  > **Импорт сертификата Key Vault**.

![Импорт сертификата Key Vault в Службу приложений](./media/configure-ssl-certificate/import-key-vault-cert.png)

Чтобы выбрать сертификат, воспользуйтесь сведениями из следующей таблицы.

| Параметр | Описание |
|-|-|
| Подписка | Подписка, к которой принадлежит хранилище Key Vault. |
| Key Vault | Хранилище с сертификатом, который необходимо импортировать. |
| Сертификат | Выберите из списка сертификатов PKCS12 в хранилище. Все сертификаты PKCS12 в хранилище отображаются с отпечатком, но не все поддерживаются в Службе приложений. |

По завершении операции вы увидите сертификат в списке **Сертификаты закрытых ключей**. Если импорт завершается ошибкой, сертификат не соответствует [требованиям для Службы приложений](#private-certificate-requirements).

![Импорт сертификата Key Vault завершен](./media/configure-ssl-certificate/import-app-service-cert-finished.png)

> [!NOTE]
> Если вы обновляете сертификат в Key Vault, используя новый сертификат, служба приложений автоматически синхронизирует его в течение 48 часов.

> [!IMPORTANT] 
> Чтобы защитить личный домен с помощью этого сертификата, необходимо создать привязку к сертификату. Следуйте инструкциям в разделе [Create binding](configure-ssl-bindings.md#create-binding) (Создание привязки).
>

## <a name="upload-a-private-certificate"></a>Передача закрытого сертификата

После получения сертификата от поставщика сертификата выполните инструкции из этого раздела, чтобы подготовить сертификат для использования в Службе приложений.

### <a name="merge-intermediate-certificates"></a>Объединение промежуточных сертификатов

Если цепочка сертификатов из центра сертификации содержит несколько сертификатов, их необходимо объединить по порядку.

Чтобы сделать это, откройте каждый полученный сертификат в текстовом редакторе.

Создайте файл для объединенных сертификатов и присвойте ему имя _mergedcertificate.crt_. В текстовом редакторе скопируйте содержимое каждого сертификата в этот файл. Порядок сертификатов должен соответствовать порядку в цепочке сертификатов, начиная вашим сертификатом и заканчивая корневым сертификатом. Это должно выглядеть следующим образом:

```
-----BEGIN CERTIFICATE-----
<your entire Base64 encoded SSL certificate>
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
<The entire Base64 encoded intermediate certificate 1>
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
<The entire Base64 encoded intermediate certificate 2>
-----END CERTIFICATE-----

-----BEGIN CERTIFICATE-----
<The entire Base64 encoded root certificate>
-----END CERTIFICATE-----
```

### <a name="export-certificate-to-pfx"></a>Экспорт сертификата в PFX-файл

Экспортируйте объединенный TLS/SSL-сертификат с закрытым ключом, с помощью которого был создан запрос сертификата.

Если запрос сертификата был создан с помощью OpenSSL, то вы создали файл закрытого ключа. Чтобы экспортировать сертификат в PFX-файл, выполните следующую команду. Замените заполнители _&lt;private-key-file>_ и _&lt;merged-certificate-file>_ путями к закрытому ключу и объединенному файлу сертификатов.

```bash
openssl pkcs12 -export -out myserver.pfx -inkey <private-key-file> -in <merged-certificate-file>  
```

При появлении запроса определите пароль для экспорта. Позже этот пароль потребуется при передаче TLS/SSL-сертификата в службу приложений.

Если вы создали запрос на сертификат с помощью IIS или _Certreq.exe_, установите сертификат на локальный компьютер, а затем [экспортируйте его в PFX](/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc754329(v=ws.11)).

### <a name="upload-certificate-to-app-service"></a>Передача сертификата в Службу приложений

Теперь вы можете передать сертификат в Службу приложений.

На <a href="https://portal.azure.com" target="_blank">портале Azure</a> в меню слева выберите **Службы приложений** >  **\<app-name>** .

В левой области навигации приложения выберите **Параметры TLS/SSL** > **Сертификаты закрытых ключей (PFX)**  > **Отправка сертификата**.

![Передача закрытого сертификата в Службу приложений](./media/configure-ssl-certificate/upload-private-cert.png)

В разделе **PFX-файл сертификата** выберите свой PFX-файл. В поле **Пароль сертификата** введите пароль, созданный при экспорте PFX-файла. По завершении щелкните **Отправить**. 

По завершении операции вы увидите сертификат в списке **Сертификаты закрытых ключей**.

![Передача сертификата завершена](./media/configure-ssl-certificate/create-free-cert-finished.png)

> [!IMPORTANT] 
> Чтобы защитить личный домен с помощью этого сертификата, необходимо создать привязку к сертификату. Следуйте инструкциям в разделе [Create binding](configure-ssl-bindings.md#create-binding) (Создание привязки).
>

## <a name="upload-a-public-certificate"></a>Передача открытого сертификата

Поддерживаются открытые сертификаты в формате *CER*. 

На <a href="https://portal.azure.com" target="_blank">портале Azure</a> в меню слева выберите **Службы приложений** >  **\<app-name>** .

В левой области навигации приложения выберите **Параметры TLS/SSL** > **Сертификаты закрытых ключей (PFX)**  > **Загрузка сертификата открытого ключа**.

В поле **Имя** введите имя сертификата. В поле **CER-файл сертификата** выберите свой CER-файл.

Щелкните **Отправить**.

![Передача открытого сертификата в Службу приложений](./media/configure-ssl-certificate/upload-public-cert.png)

После передачи сертификата скопируйте отпечаток сертификата и ознакомьтесь с разделом [Использование SSL-сертификата в коде приложения службы приложений Azure](configure-ssl-certificate-in-code.md#make-the-certificate-accessible).

## <a name="manage-app-service-certificates"></a>Управление сертификатами Службы приложений

В этом разделе показано, как управлять сертификатом Службы приложений, приобретенным в процессе [импорта сертификата Службы приложений](#import-an-app-service-certificate).

- [Переназначение ключа сертификата](#rekey-certificate)
- [Продление сертификата](#renew-certificate)
- [Экспорт сертификата](#export-certificate)
- [Удаление сертификата](#delete-certificate)

### <a name="rekey-certificate"></a>Переназначение ключа сертификата

Если вы считаете, что закрытый ключ сертификата скомпрометирован, то вы можете переназначить его ключ. Выберите сертификат на странице [Сертификаты службы приложений](https://portal.azure.com/#blade/HubsExtension/Resources/resourceType/Microsoft.CertificateRegistration%2FcertificateOrders), а затем в области навигации слева выберите **Переназначение ключа и синхронизация**.

Для запуска процесса щелкните **Переназначение ключа**. Этот процесс может занять от 1 до 10 минут.

![Переназначение ключа сертификата Службы приложений](./media/configure-ssl-certificate/rekey-app-service-cert.png)

При создании ключа развертывается новый сертификат, выданный центром сертификации.

После завершения операции переназначения ключа щелкните **Синхронизировать**. Операция синхронизации автоматически обновляет привязки имен узлов для сертификата в Службе приложений, не вызывая простоя в работе ваших приложений.

> [!NOTE]
> Если не щелкнуть **Синхронизировать**, то Служба приложений автоматически синхронизирует сертификат в течение 48 часов.

### <a name="renew-certificate"></a>Продление сертификата

Чтобы включить автоматическое обновление сертификата в любое время, на странице [Сертификаты службы приложений](https://portal.azure.com/#blade/HubsExtension/Resources/resourceType/Microsoft.CertificateRegistration%2FcertificateOrders) выберите сертификат, а затем в области навигации слева щелкните **Параметры автовозобновления**. По умолчанию сертификаты Службы приложений имеют срок действия в один год.

Выберите **Вкл.** и нажмите кнопку **Сохранить**. Если автоматическое обновление включено, сертификаты начнут автоматически обновляться за 60 дней до истечения их срока действия.

![Автоматическое продление сертификата Службы приложений](./media/configure-ssl-certificate/auto-renew-app-service-cert.png)

Чтобы обновить сертификат вручную, щелкните **Обновление вручную**. Вы можете запросить обновление сертификата вручную за 60 дней до истечения срока действия.

После завершения операции продления щелкните **Синхронизировать**. Операция синхронизации автоматически обновляет привязки имен узлов для сертификата в Службе приложений, не вызывая простоя в работе ваших приложений.

> [!NOTE]
> Если не щелкнуть **Синхронизировать**, то Служба приложений автоматически синхронизирует сертификат в течение 48 часов.

### <a name="export-certificate"></a>Экспорт сертификата

Так как Сертификаты службы приложений представляют собой [секрет Key Vault](../key-vault/general/about-keys-secrets-certificates.md), вы можете экспортировать его копию в PFX-файл и использовать его для других служб Azure или за пределами Azure.

Чтобы экспортировать сертификат Службы приложений в виде PFX-файла, выполните приведенные ниже команды в [Cloud Shell](https://shell.azure.com). Вы можете также выполнить их локально, если [установлен Azure CLI](/cli/azure/install-azure-cli). Замените заполнители именами, которые использовались при [создании сертификата Службы приложений](#start-certificate-order).

```azurecli-interactive
secretname=$(az resource show \
    --resource-group <group-name> \
    --resource-type "Microsoft.CertificateRegistration/certificateOrders" \
    --name <app-service-cert-name> \
    --query "properties.certificates.<app-service-cert-name>.keyVaultSecretName" \
    --output tsv)

az keyvault secret download \
    --file appservicecertificate.pfx \
    --vault-name <key-vault-name> \
    --name $secretname \
    --encoding base64
```

Скачанный файл *appservicecertificate.pfx* — это необработанный файл PKCS12, содержащий открытый и закрытый сертификаты. В каждом запросе используйте пустую строку для пароля импорта и парольной фразы PEM.

### <a name="delete-certificate"></a>Удаление сертификата 

Удаление сертификата Службы приложений является окончательным и необратимым. Удаление ресурса Сертификата службы приложений приведет к отзыву соответствующего сертификата. Все привязки в Службе приложений к этому сертификату становятся недействительными. Чтобы предотвратить случайное удаление, Azure блокирует сертификат. Чтобы удалить сертификат Службы приложений, необходимо сначала снять блокировку на его удаление.

Выберите сертификат на странице [Сертификаты службы приложений](https://portal.azure.com/#blade/HubsExtension/Resources/resourceType/Microsoft.CertificateRegistration%2FcertificateOrders), а затем в области навигации слева выберите **Блокировки**.

Найдите для сертификата блокировку типа **Удаление**. Справа от нее выберите **Удалить**.

![Удаление блокировки для сертификата Службы приложений](./media/configure-ssl-certificate/delete-lock-app-service-cert.png)

Теперь можно удалить сертификат Службы приложений. В левой области навигации выберите **Обзор** > **Удалить**. В диалоговом окне подтверждения введите имя сертификата и выберите **ОК**.

## <a name="automate-with-scripts"></a>Автоматизация с помощью сценариев

### <a name="azure-cli"></a>Azure CLI

[!code-azurecli[main](../../cli_scripts/app-service/configure-ssl-certificate/configure-ssl-certificate.sh?highlight=3-5 "Bind a custom TLS/SSL certificate to a web app")] 

### <a name="powershell"></a>PowerShell

[!code-powershell[main](../../powershell_scripts/app-service/configure-ssl-certificate/configure-ssl-certificate.ps1?highlight=1-3 "Bind a custom TLS/SSL certificate to a web app")]

## <a name="more-resources"></a>Дополнительные ресурсы

* [Защита пользовательского доменного имени с помощью привязки TLS/SSL в Службе приложений Azure](configure-ssl-bindings.md)
* [Принудительное использование HTTPS](configure-ssl-bindings.md#enforce-https)
* [Принудительное применение TLS 1.1/1.2](configure-ssl-bindings.md#enforce-tls-versions)
* [Использование TLS/SSL-сертификата в коде в Службе приложений Azure](configure-ssl-certificate-in-code.md)
* [FAQ: Configuration and management FAQs for Web Apps in Azure](./faq-configuration-and-management.md) (Часто задаваемые вопросы о настройке и управлении для функции "Веб-приложения" в Azure)
