---
title: Часто задаваемые вопросы о запуске встроенных контейнеров
description: Найдите ответы на часто задаваемые вопросы о встроенных контейнерах Linux в службе приложений Azure.
keywords: служба приложений azure, веб-приложение, вопросы и ответы, linux, oss, веб-приложение для контейнеров, мультиконтейнер, многоконтейнерный
author: msangapu-msft
ms.topic: article
ms.date: 10/30/2018
ms.author: msangapu
ms.custom: seodec18
ms.openlocfilehash: 6faec27bf368b3eb45e05a91307df6027bda93b1
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100094004"
---
# <a name="azure-app-service-on-linux-faq"></a>Служба приложений Azure на платформе Linux: вопросы и ответы

После выпуска службы приложений на платформе Linux мы работаем над добавлением функций и усовершенствованиями нашей платформы. В этой статье приведены ответы на вопросы, которые наши клиенты нам недавно задавали.

Если у вас есть вопросы, задайте их в комментарии к этой статье.

## <a name="built-in-images"></a>Встроенные образы

**Я хочу разветвление встроенных контейнеров DOCKER, предоставляемых платформой. Где можно найти эти файлы?**

Все файлы Docker можно найти на портале [GitHub](https://github.com/azure-app-service). Все контейнеры Docker можно найти в репозитории [Docker Hub](https://hub.docker.com/u/appsvc/).

<a id="#startup-file"></a>

**Какие значения будут доступны в разделе "Загрузочный файл" при настройке стека времени выполнения?**

| Стек           | Ожидаемое значение                                                                         |
|-----------------|----------------------------------------------------------------------------------------|
| Java SE         | команда для запуска приложения JAR (например, `java -jar /home/site/wwwroot/app.jar --server.port=80` ) |
| Tomcat          | расположение скрипта для выполнения необходимых конфигураций (например, `/home/site/deployments/tools/startup_script.sh` ).          |
| Node.js         | файл конфигурации PM2 или файл скрипта                                |
| .NET Core       | имя скомпилированной библиотеки DLL как `dotnet <myapp>.dll`                                 |
| Ruby            | Скрипт Ruby, с которым требуется инициализировать приложение                     |

Эти команды или скрипты выполняются после запуска встроенного контейнера DOCKER, но перед запуском кода приложения.

## <a name="management"></a>Управление

**Что происходит при нажатии кнопки перезагрузки на портале Azure?**

Это действие аналогично перезагрузке Docker.

**Можно ли использовать Secure Shell (SSH) для подключения к виртуальной машине контейнера приложения?**

Да, вы можете это сделать при помощи сайта системы управления версиями (SCM).

> [!NOTE]
> Можно также подключиться к контейнеру приложения непосредственно с локального компьютера разработки с помощью SSH, SFTP или Visual Studio Code (для динамической отладки приложений Node.js). См. дополнительные сведения об [удаленной отладке и SSH в службе приложений в Linux](https://azure.github.io/AppService/2018/05/07/New-SSH-Experience-and-Remote-Debugging-for-Linux-Web-Apps.html).
>

**Как создать план службы приложений Linux с помощью пакета SDK или шаблона Azure Resource Manager?**

Задайте для поля **зарезервированное** поле службы приложений *значение true*.

## <a name="continuous-integration-and-deployment"></a>Непрерывная интеграция и развертывание

**Мое веб-приложение по-прежнему использует старый образ контейнера DOCKER после обновления образа в центре DOCKER. Поддерживается ли непрерывная интеграция и развертывание пользовательских контейнеров?**

Да. Сведения о настройке непрерывной интеграции и развертывания для реестра контейнеров Azure или Docker Hub см. в статье [Непрерывное развертывание с использованием платформы Azure "Веб-приложения для контейнеров"](./deploy-ci-cd-custom-container.md). Для частных реестров контейнер можно обновить, остановив и снова запустив свое веб-приложение. Либо измените (добавьте) пустой параметр приложения, чтобы принудительно обновить контейнер.

**Поддерживаются ли промежуточные среды?**

Да.

**Можно ли развернуть веб-приложение с помощью *WebDeploy или MSDeploy*?**

Да. Для параметра `WEBSITE_WEBDEPLOY_USE_SCM` приложения необходимо задать значение *false*.

**Развертывание приложения Git завершается сбоем при использовании веб-приложения Linux. Как можно обойти эту неполадку?**

В случае сбоя развертывания Git для веб-приложения Linux можно выбрать следующие варианты развертывания кода приложения:

- Использование функции непрерывной поставки (Предварительная версия). исходный код приложения можно сохранить в репозитории Git Azure DevOps или в репозитории GitHub для использования непрерывной поставки Azure. Дополнительные сведения см. в блоге [Use Azure portal to setup Continuous Delivery for Web App On Linux](https://blogs.msdn.microsoft.com/devops/2017/05/10/use-azure-portal-to-setup-continuous-delivery-for-web-app-on-linux/) (Настройка непрерывной доставки для веб-приложения на платформе Linux с помощью портала Azure).

- Используйте [API развертывания ZIP-файлов](https://github.com/projectkudu/kudu/wiki/Deploying-from-a-zip-file). Чтобы использовать этот API, [установите SSH-подключение к веб-приложению](configure-linux-open-ssh-session.md) и перейдите в папку, в которую требуется развернуть код. Выполните следующий код:

   ```bash
   curl -X POST -u <user> --data-binary @<zipfile> https://{your-sitename}.scm.azurewebsites.net/api/zipdeploy
   ```

   Если происходит ошибка и отображается сообщение о том, что команда `curl` не найдена, убедитесь, что вы установили curl с помощью команды `apt-get install curl`, прежде чем выполнили предыдущую команду `curl`.

## <a name="language-support"></a>Поддержка языков

**Я хочу использовать WebSocket в своем приложении Node.js. Нужно ли для этого выбрать какие-либо специальные параметры или настройки?**

Да. На сервере в коде Node.js нужно отключить `perMessageDeflate`. Например, если вы используете socket.io, примените следующий код:

```nodejs
const io = require('socket.io')(server,{
  perMessageDeflate :false
});
```

**Поддерживаются ли некомпилированные приложения .NET Core?**

Да.

**Поддерживает ли Composer диспетчер зависимостей для приложений PHP?**

Да. Во время развертывания Git сервер Kudu определяет развертывание приложения PHP (на основе файла composer.lock), после чего Kudu активирует установку Composer.

## <a name="custom-containers"></a>Пользовательские контейнеры

**Я использую собственный пользовательский контейнер. Платформа должна подключить общую папку SMB к `/home/` каталогу.**

Если `WEBSITES_ENABLE_APP_SERVICE_STORAGE` параметр не **указан** или имеет значение *false*, то `/home/` каталог **не будет совместно** использоваться экземплярами масштабирования, а записываемые файлы **не будут сохраняться** при перезапуске. Явное задание значения `WEBSITES_ENABLE_APP_SERVICE_STORAGE` *true* включит подключение.

**Мой пользовательский контейнер долго запускается, и платформа перезапускает контейнер до завершения его запуска.**

Можно настроить для платформы время ожидания перед перезапуском контейнера. Это можно сделать, указав для параметра приложения `WEBSITES_CONTAINER_START_TIME_LIMIT` нужное значение. Значение по умолчанию — 230 секунд, а максимальное значение — 1800 секунд.

**Какой формат используется для URL-адреса сервера частного реестра?**

Нужно указать полный URL-адрес реестра, включая `http://` или `https://`.

**Какой формат используется для имени образа в частном реестре?**

Добавьте полное имя образа, включая URL-адрес частного реестра (например, myacr.azurecr.io/dotnet:latest). [На портале нельзя вводить](https://feedback.azure.com/forums/169385-web-apps/suggestions/31304650) имена образов, которые используют пользовательский порт. Для установки `docker-custom-image-name` Используйте [ `az` программу командной строки](/cli/azure/webapp/config/container#az-webapp-config-container-set).

**Можно ли предоставить несколько портов в образе настраиваемого контейнера?**

Мы не поддерживаем предоставление более чем одного порта.

**Можно ли использовать собственное хранилище?**

Да, [функция использования собственного хранилища](./configure-connect-to-azure-storage.md) находится на этапе предварительной версии.

**Почему мне не удается просматривать файловую систему или выполняющиеся процессы моего пользовательского контейнера на сайте SCM?**

Сайт SCM выполняется в отдельном контейнере. Поэтому вы не можете проверить файловую систему или выполняющиеся процессы контейнера приложения.

**Мой пользовательский контейнер прослушивает порт, отличный от порта 80. Как настроить приложение для маршрутизации запросов к этому порту?**

Мы используем автоматическое определение порта. Вы также можете указать параметр приложения *WEBSITES_PORT* и присвоить ему номер нужного порта. Ранее платформа использовала параметр приложения *PORT*. Мы планируем отказаться от этого параметра приложения и использовать исключительно *WEBSITES_PORT*.

**Нужно ли реализовать протокол HTTPS в своем настраиваемом контейнере?**

Нет, платформа обрабатывает завершение протокола HTTPS на общих внешних интерфейсах.

## <a name="multi-container-with-docker-compose"></a>Несколько контейнеров с Docker Compose

**Как настроить Реестр контейнеров Azure (ACR) для использования с мультиконтейнером?**

Для использования ACR с мультиконтейнером **все образы контейнеров** должны размещаться на одном сервере реестра ACR. После того как они находятся на одном и том же сервере реестра, необходимо создать параметры приложения, а затем обновить файл конфигурации Docker Compose, включив в него имя образа записи контроля доступа.

Создайте следующие параметры приложений:

- DOCKER_REGISTRY_SERVER_USERNAME
- DOCKER_REGISTRY_SERVER_URL (полный URL-адрес, пример: `https://<server-name>.azurecr.io` )
- DOCKER_REGISTRY_SERVER_PASSWORD (включить доступ с правами администратора в параметрах ACR)

В файле конфигурации укажите образ ACR, как в следующем примере:

```yaml
image: <server-name>.azurecr.io/<image-name>:<tag>
```

**Как узнать, какой контейнер доступен из Интернета?**

- Доступ может быть открыт только к одному контейнеру
- Доступны только порты 80 и 8080 (предоставляемые порты)

Ниже приведены правила определения доступного контейнера в порядке приоритета.

- Параметру приложения `WEBSITES_WEB_CONTAINER_NAME` присвоено имя контейнера
- Первый контейнер, который определяет порт 80 или 8080
- Если ни одно из приведенных выше правил не выполняется, доступным (предоставляемым) будет первый контейнер, определенный в файле


## <a name="web-sockets"></a>веб-сокеты

Веб-сокеты поддерживаются в приложениях Linux.

> [!IMPORTANT]
> Веб-сокеты в настоящее время не поддерживаются для приложений Linux в планах служба приложений (цен. категория "Бесплатный"). Мы работаем над удалением этого ограничения и планируем поддерживать до пяти подключений через веб-сокет в планах служба приложений (цен. категория "Бесплатный").

## <a name="pricing-and-sla"></a>Цены и соглашение об уровне обслуживания

**Сколько сейчас стоит общедоступная служба?**

Цены зависят от SKU и региона, но вы можете просмотреть дополнительные сведения на странице цен: [цены на службу приложений](https://azure.microsoft.com/pricing/details/app-service/linux/).

## <a name="other-questions"></a>Другие вопросы

**Что означает "Запрошенная функция недоступна в группе ресурсов"?**

Это сообщение может появиться при создании веб-приложения с помощью Azure Resource Manager (ARM). В зависимости от текущего ограничения для одной и той же группы ресурсов нельзя смешивать приложения Windows и Linux в одном регионе.

**Какие символы поддерживаются в именах параметров приложения?**

Для параметров приложения можно использовать только буквы (A–Z, a–z), цифры (0–9) и символ подчеркивания (_).

**Где можно отправить запрос на новые возможности?**

Вы можете отправить свои идеи на [форум отзывов о веб-приложениях](https://aka.ms/webapps-uservoice). Добавьте [Linux] в заголовок своей идеи.

## <a name="next-steps"></a>Дальнейшие действия

- [Общие сведения о службе приложений на платформе Linux](overview.md#app-service-on-linux).
- [Настройка промежуточных сред в службе приложений Azure](deploy-staging-slots.md)
- [Непрерывное развертывание с помощью Веб-приложение для контейнеров](./deploy-ci-cd-custom-container.md)
