---
title: Настройка пользовательских параметров
description: Настройте параметры, которые применяются ко всей среде Службы приложений Azure. Узнайте, как это сделать с помощью шаблонов Azure Resource Manager.
author: ccompy
ms.assetid: 1d1d85f3-6cc6-4d57-ae1a-5b37c642d812
ms.topic: tutorial
ms.date: 01/29/2021
ms.author: ccompy
ms.custom: mvc, seodec18
ms.openlocfilehash: 5c1e81d02aa35a40a296f04e456be09eeed10331
ms.sourcegitcommit: 2dd0932ba9925b6d8e3be34822cc389cade21b0d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2021
ms.locfileid: "99226394"
---
# <a name="custom-configuration-settings-for-app-service-environments"></a>Настраиваемые параметры конфигурации для сред службы приложений
## <a name="overview"></a>Обзор
Так как среды службы приложений (ASE) изолированы для одного клиента, существуют определенные параметры конфигурации, которые можно применить только для сред службы приложений. В этой статье описываются различные настройки, доступные для сред службы приложений.

Сведения о том, как создать среду службы приложений, см. в статье [Создание среды службы приложений](app-service-web-how-to-create-an-app-service-environment.md).

Настройки среды службы приложений можно сохранить с помощью массива в новом атрибуте **clusterSettings** . Этот атрибут можно найти в словаре "Свойства" сущности *hostingEnvironments* Azure Resource Manager.

В следующем сокращенном фрагменте шаблона Resource Manager показан атрибут **clusterSettings** .

```json
"resources": [
{
    "apiVersion": "2015-08-01",
    "type": "Microsoft.Web/hostingEnvironments",
    "name": ...,
    "location": ...,
    "properties": {
        "clusterSettings": [
            {
                "name": "nameOfCustomSetting",
                "value": "valueOfCustomSetting"
            }
        ],
        "workerPools": [ ...],
        etc...
    }
}
```

Атрибут **clusterSettings** можно включить в шаблон Resource Manager для обновления среды службы приложений.

## <a name="use-azure-resource-explorer-to-update-an-app-service-environment"></a>Обновление среды службы приложений с помощью обозревателя ресурсов Azure
Среду службы приложений можно также обновлять с помощью [обозревателя ресурсов Azure](https://resources.azure.com).  

1. В обозревателе ресурсов перейдите к узлу для среды службы приложений (**subscriptions** > **resourceGroups** > **providers** > **Microsoft.Web** > **hostingEnvironments**). Затем щелкните ту среду службы приложений, которую хотите обновить.
2. В области справа, в верхней панели инструментов щелкните **Чтение/запись** , чтобы разрешить интерактивное редактирование в обозревателе ресурсов.  
3. Нажмите синюю кнопку **Изменить** , чтобы сделать шаблон Resource Manager доступным для редактирования.
4. Прокрутите область справа вниз. В самом низу области находится атрибут **clusterSettings**. Здесь можно ввести или обновить его значение.
5. Введите (или скопируйте и вставьте) массив значений параметров конфигурации в атрибут **clusterSettings** .  
6. Нажмите зеленую кнопку **РАЗМЕСТИТЬ** в верхней части области справа, чтобы зафиксировать изменение среды службы приложений.

Однако после отправки изменения для его вступления в силу потребуется время, равное количеству внешних интерфейсов в среде службы приложений, умноженному на 30 минут.
Например, если среда службы приложений имеет четыре внешних интерфейса, для завершения обновления конфигурации потребуется примерно два часа. Во время развертывания изменения конфигурации в среде службы приложений не может выполняться никаких других операций масштабирования или изменения конфигурации.

## <a name="enable-internal-encryption"></a>Включение внутреннего шифрования

Среда службы приложений работает по принципу "черного ящика", т. е. в ней не отображаются внутренние компоненты или обмен данными в системе. Чтобы обеспечить более высокую пропускную способность, по умолчанию шифрование между внутренними компонентами отключено. Система защищена за счет того, что трафик недоступен для отслеживания или доступа. Если у вас есть требования к соответствию, предусматривающие полное шифрование пути данных из точки в точку, вы можете обеспечить шифрование всего пути данных с помощью параметра clusterSetting.  

```json
"clusterSettings": [
    {
        "name": "InternalEncryption",
        "value": "true"
    }
],
```
Присвоив параметру InternalEncryption значение true, вы обеспечите шифрование внутреннего сетевого трафика в ASE между внешними интерфейсами и рабочими ролями, шифрование файла подкачки, а также шифрование рабочих дисков. Включение InternalEncryption в качестве clusterSetting может повлиять на производительность системы. Когда вы внесете изменения, чтобы включить InternalEncryption, Среда службы приложений (ASE) будет пребывать в нестабильном состоянии, пока изменения не распространятся полностью. Полное распространение изменений может занять несколько часов в зависимости от количества экземпляров в ASE. Мы настоятельно рекомендуем не включать параметр InternalEncryption в ASE, пока она используется. Если вам нужно включить InternalEncryption для активно используемой Среды службы приложений, мы настоятельно рекомендуем перенаправлять трафик в резервную среду до завершения операции. 


## <a name="disable-tls-10-and-tls-11"></a>Отключение TLS 1.0 и TLS 1.1

Если вы хотите управлять параметрами TLS для отдельных приложений, следуйте рекомендациям, предоставленным с документацией о [принудительном применении версий TLS](../configure-ssl-bindings.md#enforce-tls-versions). 

Чтобы запретить весь входящий трафик TLS 1.0 и TLS 1.1 для всех приложений в ASE, укажите следующую запись **clusterSettings**:

```json
"clusterSettings": [
    {
        "name": "DisableTls1.0",
        "value": "1"
    }
],
```

В параметрах указана версия 1.0, но при настройке отключаются TLS 1.0 и TLS 1.1.

## <a name="change-tls-cipher-suite-order"></a>Порядок изменения комплекта шифров TLS 
ASE поддерживает смену набора шифров по умолчанию. По умолчанию используется тот же набор шифров, что и в службе с несколькими арендаторами. Изменение набора шифров влияет на все развертывание Службы приложений, следовательно это возможно только в ASE с одним арендатором. Для ASE требуется два комплекта шифров: TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 и TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256. Если вы хотите использовать для работы с ASE самый надежный и минимально необходимый набор шифров, используйте только эти два обязательных шифра. Чтобы ASE использовала только необходимые шифры, измените параметр **clusterSettings**, как показано ниже. 

```json
"clusterSettings": [
    {
        "name": "FrontEndSSLCipherSuiteOrder",
        "value": "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"
    }
],
```

> [!WARNING]
> Если для набора шрифтов указаны недопустимые значения, шифров (которые не распознаются в SChannel), подключение к серверу по протоколу TLS может быть разорвано. В этом случае необходимо удалить запись *FrontEndSSLCipherSuiteOrder* из **clusterSettings** и отправить обновленный шаблон Resource Manager, чтобы восстановить параметры комплекта шифров по умолчанию.  Используйте эту возможность с осторожностью.

## <a name="get-started"></a>Начало работы
На сайте шаблонов быстрого запуска Azure Resource Manager есть шаблон с базовым определением для [создания среды службы приложений](https://azure.microsoft.com/documentation/templates/201-web-app-ase-create/).

<!-- LINKS -->

<!-- IMAGES -->
