---
title: Настройка приложений на портале
description: Узнайте, как настроить общие параметры для приложения службы приложений в портал Azure. Параметры приложения, Конфигурация приложения, строки подключения, платформа, стек языка, контейнер и т. д.
keywords: служба приложений Azure, веб-приложение, параметры приложения, переменные среды
ms.assetid: 9af8a367-7d39-4399-9941-b80cbc5f39a0
ms.topic: article
ms.date: 12/07/2020
ms.custom: devx-track-csharp, seodec18
ms.openlocfilehash: ec9e3b6ca4b07003852681523a21b87ab7b8671b
ms.sourcegitcommit: e7179fa4708c3af01f9246b5c99ab87a6f0df11c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/30/2020
ms.locfileid: "97825965"
---
# <a name="configure-an-app-service-app-in-the-azure-portal"></a>Настройка приложения службы приложений в портал Azure

В этой статье объясняется, как настроить общие параметры для веб-приложений, серверной части для мобильных устройств или приложения API с помощью [портал Azure].

## <a name="configure-app-settings"></a>Настройка параметров приложения

В службе приложений параметры приложения являются переменными, передаваемыми как переменные среды в код приложения. Для приложений и пользовательских контейнеров Linux служба приложений передает параметры приложения в контейнер с помощью `--env` флага, чтобы задать переменную среды в контейнере.

На [Портал Azure] найдите и выберите **Службы приложений**, а затем выберите приложение. 

![Поиск служб приложений](./media/configure-common/search-for-app-services.png)

В меню слева приложения выберите **Конфигурация**  >  **Параметры приложения**.

![Параметры приложения](./media/configure-common/open-ui.png)

Для разработчиков ASP.NET и ASP.NET Core Установка параметров приложения в службе приложений выполняется так же, как и `<appSettings>` в *Web.config* или *appsettings.js*, но значения в службе приложений переопределяются в *Web.config* или *appsettings.js*. Можно использовать параметры разработки (например, локальный пароль MySQL) в *Web.config* или *appsettings.jsв* и рабочих секретах (например, пароль базы данных MySQL Azure) безопасно в службе приложений. Этот же код использует параметры разработки при локальной отладке и использует свои рабочие секреты при развертывании в Azure.

Другие стеки языков, аналогично, получают параметры приложения в виде переменных среды во время выполнения. Инструкции по стеку для конкретного языка см. в следующих статьях:

- [ASP.NET Core](configure-language-dotnetcore.md#access-environment-variables)
- [Node.js](configure-language-nodejs.md#access-environment-variables)
- [PHP](configure-language-php.md#access-environment-variables)
- [Python](configure-language-python.md#access-environment-variables)
- [Java](configure-language-java.md#configure-data-sources)
- [Ruby](configure-language-ruby.md#access-environment-variables)
- [Пользовательские контейнеры](configure-custom-container.md#configure-environment-variables)

Параметры приложения всегда шифруются при хранении.

> [!NOTE]
> Параметры приложения можно также разрешить из [Key Vault](../key-vault/index.yml) с помощью [Key Vault ссылок](app-service-key-vault-references.md).

### <a name="show-hidden-values"></a>Показывать скрытые значения

По умолчанию для обеспечения безопасности значения параметров приложения скрыты на портале. Чтобы увидеть скрытое значение параметра приложения, щелкните поле **значение** этого параметра. Чтобы просмотреть значения всех параметров приложения, нажмите кнопку **Показать значение** .

### <a name="add-or-edit"></a>Добавить или изменить

Чтобы добавить новый параметр приложения, щелкните **создать параметр приложения**. В диалоговом окне можно [прикрепить параметр к текущему слоту](deploy-staging-slots.md#which-settings-are-swapped).

Чтобы изменить параметр, нажмите кнопку " **изменить** " справа.

По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

> [!NOTE]
> В контейнере Linux по умолчанию или в пользовательском контейнере Linux любая вложенная структура ключей JSON в имени параметра приложения, например, `ApplicationInsights:InstrumentationKey` должна быть настроена в службе приложений как `ApplicationInsights__InstrumentationKey` имя ключа. Иными словами, любые `:` символы следует заменить на `__` (двойное подчеркивание).
>

### <a name="edit-in-bulk"></a>Изменить в групповой операции

Чтобы добавить или изменить параметры приложения в групповой операции, нажмите кнопку **Расширенное редактирование** . По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

Параметры приложения имеют следующее форматирование JSON:

```json
[
  {
    "name": "<key-1>",
    "value": "<value-1>",
    "slotSetting": false
  },
  {
    "name": "<key-2>",
    "value": "<value-2>",
    "slotSetting": false
  },
  ...
]
```

### <a name="automate-app-settings-with-the-azure-cli"></a>Автоматизируйте параметры приложения с помощью Azure CLI

Для создания и управления параметрами из командной строки можно использовать Azure CLI.

- Присвойте значение параметру с помощью команды [AZ webapp config app settings Set](/cli/azure/webapp/config/appsettings#az_webapp_config_appsettings_set):

    ```azurecli-interactive
    az webapp config appsettings set --name <app-name> --resource-group <resource-group-name> --settings <setting-name>="<value>"
    ```
        
    Замените на `<setting-name>` имя параметра и `<value>` присвойте ему значение. Эта команда создает параметр, если он еще не существует.
    
- Отобразите все параметры и их значения с помощью команды [AZ webapp config appSettings List](/cli/azure/webapp/config/appsettings#az_webapp_config_appsettings_list):
    
    ```azurecli-interactive
    az webapp config appsettings list --name <app-name> --resource-group <resource-group-name>
    ```
    
- Удалите один или несколько параметров с помощью команды [AZ webapp config app settings Delete](/cli/azure/webapp/config/appsettings#az_webapp_config_appsettings_delete):

    ```azurecli-interactive
    az webapp config appsettings delete --name <app-name> --resource-group <resource-group-name> --setting-names {<names>}
    ```
    
    Замените на `<names>` список имен параметров, разделенных пробелами.

## <a name="configure-connection-strings"></a>Настройка строк подключения

На [Портал Azure] найдите и выберите **Службы приложений**, а затем выберите приложение. В меню слева приложения выберите **Конфигурация**  >  **Параметры приложения**.

![Параметры приложения](./media/configure-common/open-ui.png)

Для разработчиков ASP.NET и ASP.NET Core установка строк подключения в службе приложений выполняется так же, как и `<connectionStrings>` в *Web.config*, но значения, заданные в службе приложений, переопределяют их в *Web.config*. Параметры разработки (например, файл базы данных) в *Web.config* и рабочих секретах (например, учетные данные базы данных SQL) можно безопасно использовать в службе приложений. Этот же код использует параметры разработки при локальной отладке и использует свои рабочие секреты при развертывании в Azure.

Для других стеков языков лучше использовать [Параметры приложения](#configure-app-settings) , так как для доступа к значениям строкам подключения требуется специальное форматирование в переменных ключах. 

> [!NOTE]
> Существует один случай, когда вместо параметров приложения для языков non-.NET может потребоваться использовать строки подключения: некоторые типы баз данных Azure архивируются вместе с приложением, _только_ если вы настроили строку подключения для базы данных в приложении службы приложений. Дополнительные сведения см. в разделе [что получает резервное копирование](manage-backup.md#what-gets-backed-up). Если эта автоматическая архивация не нужна, используйте параметры приложения.

Во время выполнения строки подключения доступны в виде переменных среды с префиксом со следующими типами соединений:

* Server `SQLCONNSTR_`  
* MySQL: `MYSQLCONNSTR_` 
* SQLAzure `SQLAZURECONNSTR_` 
* Пользовательская: `CUSTOMCONNSTR_`
* PostgreSQL `POSTGRESQLCONNSTR_`  

Например, можно получить доступ к строке подключения MySql с именем *connectionstring1* в качестве переменной среды `MYSQLCONNSTR_connectionString1` . Инструкции по стеку для конкретного языка см. в следующих статьях:

- [ASP.NET Core](configure-language-dotnetcore.md#access-environment-variables)
- [Node.js](configure-language-nodejs.md#access-environment-variables)
- [PHP](configure-language-php.md#access-environment-variables)
- [Python](configure-language-python.md#access-environment-variables)
- [Java](configure-language-java.md#configure-data-sources)
- [Ruby](configure-language-ruby.md#access-environment-variables)
- [Пользовательские контейнеры](configure-custom-container.md#configure-environment-variables)

Строки подключения всегда шифруются при хранении.

> [!NOTE]
> Строки подключения можно также разрешить из [Key Vault](../key-vault/index.yml) с помощью [Key Vault ссылок](app-service-key-vault-references.md).

### <a name="show-hidden-values"></a>Показывать скрытые значения

По умолчанию значения для строк подключения скрыты на портале для обеспечения безопасности. Чтобы увидеть скрытое значение строки подключения, просто щелкните поле **значение** этой строки. Чтобы просмотреть значения всех строк подключения, нажмите кнопку **Показать значение** .

### <a name="add-or-edit"></a>Добавить или изменить

Чтобы добавить новую строку подключения, нажмите кнопку **создать строку подключения**. В диалоговом окне можно [прикрепить строку подключения к текущему слоту](deploy-staging-slots.md#which-settings-are-swapped).

Чтобы изменить параметр, нажмите кнопку " **изменить** " справа.

По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

### <a name="edit-in-bulk"></a>Изменить в групповой операции

Чтобы добавить или изменить строки подключения в групповой операции, нажмите кнопку **Расширенное редактирование** . По завершении нажмите кнопку **Обновить**. Не забудьте нажать кнопку **сохранить** назад на странице **Конфигурация** .

Строки подключения имеют следующее форматирование JSON:

```json
[
  {
    "name": "name-1",
    "value": "conn-string-1",
    "type": "SQLServer",
    "slotSetting": false
  },
  {
    "name": "name-2",
    "value": "conn-string-2",
    "type": "PostgreSQL",
    "slotSetting": false
  },
  ...
]
```

<a name="platform"></a>
<a name="alwayson"></a>

## <a name="configure-general-settings"></a>Настройка общих параметров

На [Портал Azure] найдите и выберите **Службы приложений**, а затем выберите приложение. В меню слева приложения выберите **Конфигурация**  >  **Общие параметры**.

![Общие параметры](./media/configure-common/open-general.png)

Здесь можно настроить некоторые общие параметры для приложения. Для некоторых параметров необходимо выполнить [масштабирование до более высоких](manage-scale-up.md)ценовых категорий.

- **Параметры стека**: программный стек для запуска приложения, включая версии языка и пакета SDK.

    Для приложений Linux и настраиваемых приложений-контейнеров можно выбрать версию языковой среды выполнения и задать необязательную **команду запуска** или файл команд запуска.

    ![Общие параметры для контейнеров Linux](./media/configure-common/open-general-linux.png)

- **Параметры платформы**: позволяет настраивать параметры для платформы размещения, включая:
    - **Разрядность: 32**-разрядная или 64-разрядная.
    - **Протокол WebSocket**: например, для [ASP.NET SignalR] или [Socket.IO](https://socket.io/).
    - **Always on**: обеспечивает загрузку приложения даже при отсутствии трафика. Он необходим для непрерывных веб-заданий или для веб-заданий, запускаемых с помощью выражения CRON.
      > [!NOTE]
      > Используя функцию Always On, балансировщик нагрузки клиентского интерфейса отправляет запрос в корень приложения. Не удается настроить конечную точку приложения для службы приложений.
    - **Версия управляемого конвейера**: [режим конвейера]IIS. Если у вас есть устаревшее приложение, для которого требуется более старая версия IIS, задайте **классический** .
    - **Версия HTTP**: значение **2,0** , чтобы включить поддержку протокола [HTTPS/2](https://wikipedia.org/wiki/HTTP/2) .
    > [!NOTE]
    > Большинство современных браузеров поддерживают протокол HTTP/2 только через TLS, а для незашифрованного трафика продолжает использоваться протокол HTTP/1.1. Чтобы обеспечить подключение клиентских браузеров к приложению по протоколу HTTP/2, обеспечьте безопасность настраиваемого DNS-имени. Дополнительные сведения см. [в статье Защита настраиваемого DNS-имени с помощью привязки TLS/SSL в службе приложений Azure](configure-ssl-bindings.md).
    - **Сопоставление arr**. в развертывании с несколькими экземплярами убедитесь, что клиент направляется на один и тот же экземпляр в течение сеанса. Этот параметр можно установить в значение **Off** для приложений без отслеживания состояния.
- **Отладка**: включить удаленную отладку для [ASP.NET](troubleshoot-dotnet-visual-studio.md#remotedebug), [ASP.NET Core](/visualstudio/debugger/remote-debugging-azure)или [Node.js](configure-language-nodejs.md#debug-remotely) приложений. Этот параметр автоматически отключается через 48 часов.
- **Входящие сертификаты клиентов**: требовать [взаимной проверки подлинности](app-service-web-configure-tls-mutual-auth.md)сертификаты клиентов.

## <a name="configure-default-documents"></a>Настройка документов по умолчанию

Этот параметр предназначен только для приложений Windows.

На [Портал Azure] найдите и выберите **Службы приложений**, а затем выберите приложение. В меню слева приложения выберите **Конфигурация**  >  **документы по умолчанию**.

![Стандартные документы](./media/configure-common/open-documents.png)

Документом по умолчанию является веб-страница, отображаемая по корневому URL-адресу веб-сайта. Используется первый найденный файл в списке. Чтобы добавить новый документ по умолчанию, нажмите кнопку **создать документ**. Не забудьте нажать кнопку **сохранить**.

Если приложение использует модули, которые маршрутизируются по URL-адресу вместо использования статического содержимого, нет необходимости использовать документы по умолчанию.

## <a name="configure-path-mappings"></a>Настройка сопоставлений путей

На [Портал Azure] найдите и выберите **Службы приложений**, а затем выберите приложение. В меню слева приложения выберите   >  **сопоставления путей** конфигурации.

![Сопоставления путей](./media/configure-common/open-path.png)

> [!NOTE] 
> На вкладке **сопоставления пути** могут отображаться параметры операционной системы, отличные от показанного в примере.

### <a name="windows-apps-uncontainerized"></a>Приложения Windows (неконтейнерные)

Для приложений Windows можно настроить сопоставления обработчика IIS и виртуальные приложения и каталоги.

Сопоставления обработчиков позволяют добавить обработчики пользовательских скриптов для обработки запросов к конкретным расширениям файлов. Чтобы добавить пользовательский обработчик, нажмите кнопку **создать сопоставление обработчика**. Настройте обработчик следующим образом:

- **Расширение**. Расширение файла, которое требуется обработано, например *\* PHP* или *handler. FCGI*.
- **Обработчик скриптов**. Абсолютный путь к обработчику скрипта. Запросы к файлам, которые соответствуют расширению файла, обрабатываются обработчиком скриптов. Используйте путь `D:\home\site\wwwroot` для указания корневого каталога веб-приложения.
- **Аргументы**. Необязательные аргументы командной строки для обработчика скриптов.

У каждого приложения есть корневой путь по умолчанию ( `/` ), сопоставленный с `D:\home\site\wwwroot` , где код развертывается по умолчанию. Если корневой каталог приложения находится в другой папке или в репозитории имеется несколько приложений, вы можете изменить или добавить здесь виртуальные приложения и каталоги. 

На вкладке **сопоставления пути** щелкните **новое виртуальное приложение или каталог**. 

- Чтобы установить соответствие между виртуальным каталогом и физическим путем, оставьте флажок **Каталог** установленным. Укажите виртуальный каталог и соответствующий относительный (физический) путь к корню веб-сайта ( `D:\home` ).
- Чтобы пометить виртуальный каталог как веб-приложение, снимите флажок **Каталог** .
  
  ![Флажок каталога](./media/configure-common/directory-check-box.png)

### <a name="containerized-apps"></a>Контейнерные приложения

Вы можете [Добавить пользовательское хранилище для контейнерного приложения](configure-connect-to-azure-storage.md). Контейнерные приложения включают все приложения Linux, а также настраиваемые контейнеры Windows и Linux, выполняющиеся в службе приложений. Щелкните **создать подключение к службе хранилища Azure** и настройте настраиваемое хранилище следующим образом.

- **Имя**: отображаемое имя.
- **Параметры конфигурации**: **базовый** или **Расширенный**.
- **Учетные записи хранения**. учетная запись хранения с нужным контейнером.
- **Тип хранилища**: **большие двоичные объекты Azure** или **файлы Azure**.
  > [!NOTE]
  > Приложения контейнеров Windows поддерживают только файлы Azure.
- **Контейнер хранилища**: для базовой конфигурации — нужного контейнера.
- **Имя общего ресурса**: для дополнительной конфигурации — имя общей папки.
- **Ключ доступа**: для расширенной настройки — ключ доступа.
- **Путь подключения**: абсолютный путь в контейнере для подключения пользовательского хранилища.

Дополнительные сведения см. [в статье доступ к службе хранилища Azure в качестве общей сетевой папки из контейнера службы приложений](configure-connect-to-azure-storage.md).

## <a name="configure-language-stack-settings"></a>Настройка параметров языкового стека

Для приложений Linux см.:

- [ASP.NET Core](configure-language-dotnetcore.md)
- [Node.js](configure-language-nodejs.md)
- [PHP](configure-language-php.md)
- [Python](configure-language-python.md)
- [Java](configure-language-java.md)
- [Ruby](configure-language-ruby.md)

## <a name="configure-custom-containers"></a>Настройка пользовательских контейнеров

См. статью [Настройка пользовательского контейнера Linux для службы приложений Azure](configure-custom-container.md) .

## <a name="next-steps"></a>Дальнейшие действия

- [Настройка личного доменного имени в службе приложений Azure]
- [Настройка промежуточных сред в службе приложений Azure]
- [Защита пользовательского доменного имени с помощью привязки TLS/SSL в Службе приложений Azure](configure-ssl-bindings.md)
- [Включить журналы диагностики](troubleshoot-diagnostic-logs.md)
- [Масштабирование приложения в службе приложений Azure]
- [Основы мониторинга в службе приложений Azure]
- [Изменение параметров applicationHost.config с помощью applicationHost. xdt](https://github.com/projectkudu/kudu/wiki/Xdt-transform-samples)

<!-- URL List -->

[ASP.NET SignalR]: https://www.asp.net/signalr
[Портал Azure]: https://portal.azure.com/
[Настройка личного доменного имени в службе приложений Azure]: ./app-service-web-tutorial-custom-domain.md
[Настройка промежуточных сред в службе приложений Azure]: ./deploy-staging-slots.md
[How to: Monitor web endpoint status]: ./web-sites-monitor.md
[Основы мониторинга в службе приложений Azure]: ./web-sites-monitor.md
[режим конвейера]: https://www.iis.net/learn/get-started/introduction-to-iis/introduction-to-iis-architecture#Application
[Масштабирование приложения в службе приложений Azure]: ./manage-scale-up.md
