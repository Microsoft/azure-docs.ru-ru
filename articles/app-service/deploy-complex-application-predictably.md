---
title: Предсказуемое развертывание приложений с помощью ARM
description: Узнайте, как развертывать несколько приложений службы приложений Azure как единое целое и прогнозируемым способом с помощью шаблонов управления ресурсами Azure и сценариев PowerShell.
ms.assetid: bb51e565-e462-4c60-929a-2ff90121f41d
ms.topic: article
ms.date: 01/06/2016
ms.custom: seodec18
ms.openlocfilehash: 8742b590af89954cb8480e5282827bcd5228673b
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "101095829"
---
# <a name="provision-and-deploy-microservices-predictably-in-azure"></a>Предсказуемые подготовка и развертывание микрослужб в Azure
В этом руководстве описано, как предсказуемо с помощью шаблонов групп ресурсов JSON и скриптов PowerShell подготовить и развернуть приложение, состоящее из [микрослужб](https://en.wikipedia.org/wiki/Microservices), в [службу приложений Azure](https://azure.microsoft.com/services/app-service/) как единое целое. 

Залогом успеха при подготовке и развертывании крупномасштабных приложений, которые состоят из разъединенных микрослужб, являются повторяемость и предсказуемость. [Служба приложений Azure](https://azure.microsoft.com/services/app-service/) позволяет создавать микрослужбы, которые содержат веб-приложения, серверные части мобильных приложений и приложения API. [Azure Resource Manager](../azure-resource-manager/management/overview.md) позволяет управлять микрослужбами как единым целым, вместе с зависимостями ресурсов, например параметрами управления базами данных и систем управления версиями. Теперь можно также развернуть такое приложение с помощью шаблонов JSON и простых скриптов PowerShell. 

## <a name="what-you-will-do"></a>Выполняемая задача
В этом учебнике будет развернуто приложение, которое включает в себя:

* два приложения службы приложений (т. е. две микрослужбы);
* базу данных SQL внутреннего сервера;
* параметры приложения, строки подключения и система управления версиями;
* анализы приложений, предупреждения, параметры автоматического масштабирования.

## <a name="tools-you-will-use"></a>Используемые инструменты
В этом учебнике будут использоваться следующие инструменты. Так как подробное изучение инструментов не входит в задачу данного учебника, будем придерживаться беглого сценария и остановимся лишь на кратком введении к каждому инструменту и скажем, где можно будет найти дополнительную информацию о них. 

### <a name="azure-resource-manager-templates-json"></a>Шаблоны диспетчера ресурсов Azure (JSON)
Каждый раз при создании приложения, например в службе приложений Azure, Azure Resource Manager использует шаблон JSON для создания всей группы ресурсов с ресурсами компонентов. Сложный шаблон из [Azure Marketplace](../marketplace/index.yml) может содержать базу данных, учетные записи хранения, план службы приложений, само приложение, правила генерации оповещений, параметры приложения, параметры автоматического масштабирования и др. Все эти шаблоны доступны через PowerShell. Дополнительные сведения о создании шаблонов Azure Resource Manager см. [здесь](../azure-resource-manager/templates/template-syntax.md).

### <a name="azure-sdk-26-for-visual-studio"></a>Пакет SDK для Azure 2.6 для Visual Studio
Новейший пакет SDK содержит улучшения для поддержки шаблонов диспетчера ресурсов в редакторе JSON. Здесь можно быстро создать шаблон группы ресурсов с нуля или открыть существующий шаблон JSON (например, скачанный шаблон коллекции) для изменения, заполнения файла параметров и даже развертывания группы ресурсов непосредственно из решения для групп ресурсов Azure.

Дополнительные сведения см. в разделе [Пакет SDK для Azure версии 2.6 для Visual Studio](https://azure.microsoft.com/blog/2015/04/29/announcing-the-azure-sdk-2-6-for-net/).

### <a name="azure-powershell-080-or-later"></a>Azure PowerShell 0.8.0 или более поздней версии
Начиная с версии 0.8.0, установка Azure PowerShell в дополнение к модулю Azure содержит модуль диспетчера ресурсов Azure. Этот новый модуль позволяет создавать скрипты развертывания групп ресурсов.

Дополнительные сведения см. в разделе [использование Azure PowerShell с Azure Resource Manager](../azure-resource-manager/management/manage-resources-powershell.md)

### <a name="azure-resource-explorer"></a>Обозреватель ресурсов Azure
Этот [инструмент предварительного просмотра](https://resources.azure.com) позволяет изучать определения JSON всех групп ресурсов в подписке и отдельных ресурсов. Этот инструмент предназначен для изменения определений JSON ресурса, удаления всей иерархии ресурсов и создания новых ресурсов.  Сведения, доступные в этом средстве, очень полезны для создания шаблонов, так как они показывают, какие свойства необходимо задать для конкретного типа ресурса, правильные значения и т. д. Вы даже можете создать группу ресурсов на [портале Azure](https://portal.azure.com/), а затем проверить определения JSON в средстве обозревателя, чтобы помочь вам темплатизе группу ресурсов.

### <a name="deploy-to-azure-button"></a>Кнопка "Развертывание в Azure"
При использовании GitHub для управления версиями можно поместить кнопку [Deploy to Azure](https://docs.microsoft.com/azure/azure-resource-manager/templates/deploy-to-azure-button) (Развернуть в Azure) в свой файл README.MD, которая обеспечивает готовый пользовательский интерфейс развертывания в Azure. Хотя это можно сделать для любого простого приложения, этот параметр можно расширить, чтобы организовать развертывание группы ресурсов как единого целого, помещая файл azuredeploy.json в корневой репозиторий. Этот файл JSON, который содержит шаблон группы ресурсов, используется кнопкой "Развертывание в Azure" для создания группы ресурсов. Например, см. образец [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp), который будет использоваться в этом руководстве.

## <a name="get-the-sample-resource-group-template"></a>Получение образца шаблона группы ресурсов
Теперь давайте сразу к делу.

1. Перейдите к образцу службы приложений [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) .
2. В readme.md щелкните **Развертывание в Azure**.
3. Вы будете перенаправлены на веб-сайт [Развертывание в Azure](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fazure-appservice-samples%2FToDoApp%2Fmaster%2Fazuredeploy.json) и получите запрос на ввод параметров развертывания. Обратите внимание, что большая часть полей уже заполнена именем репозитория и какими-либо случайными строками. При необходимости можно изменить все поля, но для этого нужно ввести имя и пароль администратора SQL Server, а затем щелкнуть **Далее**.
   
   ![Отображает входные параметры развертывания на сайте Deploy-to-Azure.](./media/app-service-deploy-complex-application-predictably/gettemplate-1-deploybuttonui.png)
4. Затем щелкните **Развернуть** для запуска процесса развертывания. Когда процесс подойдет к завершению, перейдите по ссылке http://todoapp*XXXX*.azurewebsites.net для просмотра развернутого приложения. 
   
   ![Показывает процесс развертывания приложения.](./media/app-service-deploy-complex-application-predictably/gettemplate-2-deployprogress.png)
   
   При первом переходе к приложению пользовательский интерфейс будет работать немного медленнее, так как приложение только запускается, но убедитесь, что это полнофункциональное приложение.
5. На странице «Развертывание» откройте ссылку **Управление** , чтобы увидеть новое приложение на портале Azure.
6. В раскрывающемся списке **Основные компоненты** щелкните ссылку "Группа ресурсов". Обратите внимание, что приложение уже подключено к репозиторию GitHub в разделе **Внешний проект**. 
   
   ![Отображает ссылку на группу ресурсов в раскрывающемся списке Essentials.](./media/app-service-deploy-complex-application-predictably/gettemplate-3-portalresourcegroup.png)
7. Обратите внимание, что в колонке "Группа ресурсов" уже есть два приложения и одна база данных SQL в группе ресурсов.
   
   ![Показывает ресурсы, доступные в группе ресурсов.](./media/app-service-deploy-complex-application-predictably/gettemplate-4-portalresourcegroupclicked.png)

Все, что вы могли видеть в течение этих нескольких минут, — это полностью развернутое приложение, состоящее из двух микрослужб, со всеми компонентами, зависимостями, параметрами, базами данных и непрерывной публикацией, которое настроено диспетчером ресурсов Azure с помощью автоматической оркестрации. Все это было проделано с помощью двух вещей:

* кнопки "Развертывание в Azure";
* файла azuredeploy.json в корневом каталоге репозитория.

Это же приложение можно развернуть десятки, сотни или тысячи раз и каждый раз с точно такой же конфигурацией. Повторяемость и предсказуемость такого подхода позволяет легко и надежно развертывать крупномасштабные приложения.

## <a name="examine-or-edit-azuredeployjson"></a>Изучение (или изменение) файла AZUREDEPLOY.JSON
Теперь давайте посмотрим, как был настроен репозиторий GitHub. Вы будете использовать редактор JSON в пакете SDK для Azure .NET, поэтому, если вы еще не установили [пакет SDK для Azure .NET 2.6](https://azure.microsoft.com/downloads/), сделайте это сейчас.

1. Клонируйте репозиторий [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) с помощью выбранного инструмента git. На снимке экрана ниже я делаю это в Team Explorer в Visual Studio 2013.
   
   ![Показывает, как использовать средство Git для клонирования репозитория ToDoApp.](./media/app-service-deploy-complex-application-predictably/examinejson-1-vsclone.png)
2. В корневом каталоге репозитория откройте файл azuredeploy.json в Visual Studio. Если панель структуры JSON не отображается, необходимо установить пакет SDK для Azure .NET.
   
   ![Отображает панель структуры JSON в Visual Studio.](./media/app-service-deploy-complex-application-predictably/examinejson-2-vsjsoneditor.png)

Я не буду описывать все подробности формата JSON, но в разделе [Дополнительные ресурсы](#resources) приведены ссылки для изучения языка шаблонов групп ресурсов. Здесь я просто выберу для отображения интересные возможности, которые помогут вам приступить к работе при создании пользовательского шаблона для развертывания приложения.

### <a name="parameters"></a>Параметры
Просмотрите раздел параметров, где вы увидите, что большинство из этих параметров можно ввести на запрос, формируемый командой кнопки **Deploy to Azure** (Развернуть в Azure). Веб-сайт кнопки **Deploy to Azure** (Развернуть в Azure) заполняет входные элементы пользовательского интерфейса на основе параметров, определенных в файле azuredeploy.json. Эти параметры используются в определениях ресурсов, таких как имена ресурсов, значения свойств и т. д.

### <a name="resources"></a>Ресурсы
В узле "Ресурсы" можно видеть, что определены четыре ресурса верхнего уровня, включая экземпляр SQL Server, план службы приложений и два приложения. 

#### <a name="app-service-plan"></a>План службы приложений
Начнем с простого ресурса корневого уровня в JSON. В структуре JSON щелкните план службы приложений с именем **[hostingPlanName]** , чтобы выделить соответствующий код JSON. 

![Отображает раздел [hostingPlanName] кода JSON.](./media/app-service-deploy-complex-application-predictably/examinejson-3-appserviceplan.png)

Обратите внимание, что элемент `type` указывает на строку для плана службы приложений (он был вызван с фермы серверов уже довольно давно), а другие элементы и свойства заполняются на основе параметров, определенных в файле JSON, и этот ресурс не содержит никаких вложенных ресурсов.

> [!NOTE]
> Обратите внимание, что значение `apiVersion` сообщает Azure, какая версия интерфейса REST API будет использоваться с определением ресурса JSON, и оно может повлиять на форматирование ресурса в `{}`. 
> 
> 

#### <a name="sql-server"></a>SQL Server
Затем щелкните ресурс SQL Server с именем **SQLServer** в структуре JSON.

![Показывает SQL Server ресурс с именем SQLServer в структуре JSON.](./media/app-service-deploy-complex-application-predictably/examinejson-4-sqlserver.png)

Обратите внимание на следующее в выделенном коде JSON.

* Использование параметров гарантирует, что создаваемые ресурсы именуются и настраиваются так, чтобы они были согласованы друг с другом.
* Ресурс SQLServer содержит два вложенных ресурса, у которых имеются разные значения для `type`.
* Вложенные ресурсы в `“resources”: […]`, где определены база данных и правила брандмауэра, содержат элемент `dependsOn`, указывающий на идентификатор ресурса для ресурса SQLServer корневого уровня. Этим диспетчеру ресурсов Azure сообщается, что "перед созданием ресурса уже должен существовать другой ресурс и, если этот другой ресурс определен в шаблоне, сначала создайте его".
  
  > [!NOTE]
  > Дополнительные сведения об использовании `resourceId()` см. в статье [Функции шаблонов Azure Resource Manager](../azure-resource-manager/templates/template-functions-resource.md#resourceid).
  > 
  > 
* Результатом работы элемента `dependsOn` будет то, что диспетчер ресурсов Azure сможет узнать, какие ресурсы могут быть созданы в параллельном режиме и какие ресурсы должны быть созданы последовательно. 

#### <a name="app-service-app"></a>Приложение службы приложений
Теперь перейдем к реальным приложениям, которые значительно сложнее. Щелкните приложение [variables('apiSiteName')] в структуре JSON, чтобы выделить его код JSON. Теперь вы увидите гораздо более интересные вещи. Поэтому я расскажу об этих особенностях по очереди.

##### <a name="root-resource"></a>Корневой ресурс
Приложение зависит от двух разных ресурсов. Это означает, что Azure Resource Manager создаст приложение только после создания плана службы приложений и экземпляра SQL Server.

![Показывает зависимости приложений от плана службы приложений и экземпляра SQL Server.](./media/app-service-deploy-complex-application-predictably/examinejson-5-webapproot.png)

##### <a name="app-settings"></a>Параметры приложения
Параметры приложения также определены в качестве вложенного ресурса.

![Показывает параметры приложения, определенные как вложенные ресурсы в коде JSON.](./media/app-service-deploy-complex-application-predictably/examinejson-6-webappsettings.png)

В элементе `properties` для `config/appsettings` имеется два параметра приложений в формате `"<name>" : "<value>"`.

* `PROJECT` — это [параметр KUDU](https://github.com/projectkudu/kudu/wiki/Customizing-deployments) , который сообщает развертыванию Azure, какой проект требуется использовать в решении Visual Studio с несколькими проектами. Позже я расскажу, как настроить систему управления версиями, но, поскольку код ToDoApp входит в многопроектное решение Visual Studio, этот параметр необходим.
* `clientUrl` — это просто параметр приложения, используемый кодом приложения.

##### <a name="connection-strings"></a>Строки подключения
Строки подключения также определены в качестве вложенного ресурса.

![Показывает, как строки подключения определяются как вложенные ресурсы в коде JSON.](./media/app-service-deploy-complex-application-predictably/examinejson-7-webappconnstr.png)

В элементе `properties` для `config/connectionstrings` каждая строка подключения также определяется как пара "имя:значение" с определенным форматом `"<name>" : {"value": "…", "type": "…"}`. Возможные значения для элемента `type`: `MySql`, `SQLServer`, `SQLAzure` и `Custom`.

> [!TIP]
> Чтобы открыть полный список типов строк подключения, выполните следующую команду в Azure PowerShell: \[Enum]::GetNames("Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.DatabaseType").
> 
> 

##### <a name="source-control"></a>Система управления версиями
Параметры системы управления версиями также определены в качестве вложенного ресурса. Диспетчер ресурсов Azure использует этот ресурс для настройки непрерывной публикации (см. пояснение `IsManualIntegration` ниже) и для автоматического запуска развертывания кода приложения во время обработки JSON-файла.

![Показывает, как параметры системы управления версиями определяются как вложенные ресурсы в коде JSON.](./media/app-service-deploy-complex-application-predictably/examinejson-8-webappsourcecontrol.png)

`RepoUrl` и `branch` должны быть интуитивно понятны, а также должны указывать на репозиторий Git и имя ветви для публикации. Опять же, они определяются входными параметрами. 

Обратите внимание, что в элементе `dependsOn` в дополнение к самому ресурсу приложение `sourcecontrols/web` также зависит от `config/appsettings` и `config/connectionstrings`. Это происходит потому, что после настройки `sourcecontrols/web` процесс развертывания Azure автоматически попытается развернуть, собрать и запустить код приложения. Таким образом, вставка этой зависимости помогает убедиться, что перед запуском кода приложение обладает доступом к необходимым параметрам приложения и строкам подключения. 

> [!NOTE]
> Обратите внимание, что для `IsManualIntegration` установлено значение `true`. Это свойство в руководстве необходимо, так как у вас фактически нет репозитория GitHub, поэтому в действительности вы не можете предоставить разрешение в Azure для настройки непрерывной публикации из [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) (т. е. передавать автоматические обновления репозитория в Azure). Значение по умолчанию `false` для указанного репозитория можно использовать только в том случае, если вы заранее настроили учетные данные владельца GitHub на [портале Azure](https://portal.azure.com/). Другими словами, если вы ранее настроили систему управления версиями для GitHub или BitBucket для любого приложения на [портале Azure](https://portal.azure.com/) с помощью своих учетных данных пользователя, Azure запомнит данные и в будущем будет использовать их при развертывании любого приложения из GitHub или BitBucket. Однако если вы еще не сделали этого, развертывание шаблона JSON завершится ошибкой при попытке Azure Resource Manager настроить параметры системы управления версиями для приложения, так как невозможно будет войти в GitHub или BitBucket с учетными данными владельца репозитория.
> 
> 

## <a name="compare-the-json-template-with-deployed-resource-group"></a>Сравнение шаблона JSON с развернутой группой ресурсов
Здесь можно просмотреть все колонки приложения на [портале Azure](https://portal.azure.com/), однако есть и другой, не менее полезный инструмент. Перейдите к инструменту предварительного просмотра [Обозреватель ресурсов Azure](https://resources.azure.com) , формирующему JSON-представление всех групп ресурсов в ваших подписках, которые фактически существуют на внутреннем сервере Azure. Вы также можете просмотреть, как иерархия JSON группы ресурсов в Azure соответствует иерархии в файле шаблона, использованного для его создания.

Например, при переходе в инструмент [Обозреватель ресурсов Azure](https://resources.azure.com) и развертывании узлов в обозревателе отображаются группы ресурсов и ресурсы корневого уровня, которые собираются по соответствующим типам ресурсов.

![Просмотрите ресурсы группы ресурсов и корневого уровня в расширенном средстве обозревателя ресурсов Azure.](./media/app-service-deploy-complex-application-predictably/ARM-1-treeview.png)

Если внимательнее рассмотреть приложение, можно увидеть подробности его конфигурации, как это показано на снимке экрана ниже.

![Выполните детализацию, чтобы просмотреть сведения о конфигурации в приложении.](./media/app-service-deploy-complex-application-predictably/ARM-2-jsonview.png)

Кроме того, вложенные ресурсы должны иметь иерархию, очень похожую на иерархию в файле шаблона JSON, и вы должны убедиться, что параметры приложения, строки подключения и т. д. правильно отображаются в области JSON. Отсутствие здесь параметров может указывать на проблему с файлом JSON и может помочь при отладке файла шаблона JSON.

## <a name="deploy-the-resource-group-template-yourself"></a>Развертывание шаблона группы ресурсов вручную
Кнопка **Развертывание в Azure** — это отлично, но она позволяет развернуть шаблон группы ресурсов в azuredeploy.json только в том случае, если azuredeploy.json уже помещен в GitHub. Пакет SDK для Azure .NET также предоставляет средства для развертывания любого файла шаблона JSON непосредственно с локального компьютера. Выполните указанные ниже действия:

1. В Visual Studio выберите **Файл** > **Создать** > **Проект**.
2. Щелкните **Visual C#**  >  **Cloud**  >  **Группа ресурсов Azure**, а затем нажмите кнопку **ОК**.
   
   ![Создайте новый проект в качестве группы ресурсов Azure в пакете SDK для Azure .NET.](./media/app-service-deploy-complex-application-predictably/deploy-1-vsproject.png)
3. В разделе **Выберите шаблон Azure** выберите **Пустой шаблон** и нажмите кнопку **ОК**.
4. Перетащите файл azuredeploy.json в папку **Шаблон** нового проекта.
   
   ![Показывает результат перетаскивания azuredeploy.jsфайла в папку шаблона проекта.](./media/app-service-deploy-complex-application-predictably/deploy-2-copyjson.png)
5. В обозревателе решений откройте скопированный файл azuredeploy.json.
6. Только для примера давайте добавим некоторые стандартные ресурсы Application Insight нашего файла JSON, нажав кнопку **Добавить ресурс**. Если вас интересует только развертывание файла JSON, пропустите шаги развертывания.
   
   ![Отображается кнопка Добавить ресурс, которую можно использовать для добавления стандартных ресурсов Application Insights в файл JSON.](./media/app-service-deploy-complex-application-predictably/deploy-3-newresource.png)
7. Выберите **Application Insights для веб-приложений**, убедитесь, что выбран существующий план службы приложений и выбрано приложение, а затем нажмите кнопку **Добавить**.
   
   ![Отображает выбор Application Insights для веб-приложений, имя, план службы приложений и веб-приложение.](./media/app-service-deploy-complex-application-predictably/deploy-4-newappinsight.png)
   
   Теперь вы сможете увидеть несколько новых ресурсов в зависимости от ресурса и его роли, его зависимости от плана службы приложений или приложения. Эти ресурсы не включены существующим определением, и вы собираетесь изменить их.
   
   ![Просмотрите новые ресурсы, которые имеют зависимости от плана службы приложений или приложения.](./media/app-service-deploy-complex-application-predictably/deploy-5-appinsightresources.png)
8. В структуре JSON щелкните **appInsights AutoScale** , чтобы выделить его код JSON. Это параметр масштабирования для плана службы приложений.
9. В выделенном коде JSON найдите свойства `location` и `enabled`, а затем задайте их, как показано ниже.
   
   ![Показывает свойства Location и Enabled в коде JSON автомасштабирования appInsights и значения, которые необходимо задать для них.](./media/app-service-deploy-complex-application-predictably/deploy-6-autoscalesettings.png)
10. В структуре JSON щелкните **CPUHigh appInsights** , чтобы выделить код JSON. Это предупреждение.
11. Найдите свойства `location` и `isEnabled`, а затем задайте их, как показано ниже. Выполните то же самое для других трех предупреждений (фиолетового цвета).
    
    ![Показывает свойства Location и Enable в коде Кпухигх appInsights JSON и значения, которые необходимо задать для них.](./media/app-service-deploy-complex-application-predictably/deploy-7-alerts.png)
12. Теперь все готово для развертывания. Щелкните проект правой кнопкой мыши и выберите пункт **развернуть**  >  **новое развертывание**.
    
    ![Показывает, как развернуть новый проект.](./media/app-service-deploy-complex-application-predictably/deploy-8-newdeployment.png)
13. Войдите в свою учетную запись Azure, если вы еще этого не сделали.
14. Выберите существующую группу ресурсов в подписке или создайте новую. Выберите файл **azuredeploy.json**, а затем нажмите кнопку **Изменить параметры**.
    
    ![Показывает, как изменить параметры в azuredeploy.jsфайле.](./media/app-service-deploy-complex-application-predictably/deploy-9-deployconfig.png)
    
    Теперь в удобной таблице можно изменить все параметры, определенные в файле шаблона. Параметры, определяющие значения по умолчанию, уже будут иметь значения по умолчанию, а параметры, определяющие список допустимых значений, будут отображаться в виде раскрывающихся списков.
    
    ![Показывает параметры, определяющие список допустимых значений в виде раскрывающихся списков.](./media/app-service-deploy-complex-application-predictably/deploy-10-parametereditor.png)
15. Заполните все пустые параметры и используйте [адрес репозитория GitHub для ToDoApp](https://github.com/azure-appservice-samples/ToDoApp.git) в **repoUrl**. Нажмите кнопку **Сохранить**.
    
    ![Отображает только что заполненные параметры для azuredeploy.jsфайла.](./media/app-service-deploy-complex-application-predictably/deploy-11-parametereditorfilled.png)
    
    > [!NOTE]
    > Автоматическое масштабирование — это функция, предлагаемая в категории **Standard** или более высокой категории. Предупреждения уровня плана — это возможности, предлагаемые в категории **Basic** или более высокой. Для просмотра всех новых ресурсов App Insights необходимо задать для параметра **sku** значение **Standard** или **Premium**.
    > 
    > 
16. Щелкните **Развернуть**. Если вы выбрали параметр **Сохранить пароль**, пароль будет сохранен в файле параметров **в виде обычного текста**. В противном случае вам будет предложено ввести пароль для базы данных во время развертывания.

Вот и все! Теперь нужно просто перейти на [портал Azure](https://portal.azure.com/) и с помощью инструмента [Обозреватель ресурсов Azure](https://resources.azure.com) просмотреть новые параметры автоматического масштабирования и предупреждения, добавляемые в развертываемое приложение JSON.

Действия, описанные в этом разделе, главным образом охватывают следующее.

1. Подготовка файла шаблона
2. Создание файла параметров для использования в файле шаблона
3. Развертывание файла шаблона с файлом параметров

Последний шаг можно легко выполнить с помощью командлета PowerShell. Чтобы увидеть, что делает Visual Studio при развертывании приложения, откройте сценарий Scripts\Deploy-AzureResourceGroup.ps1. Не пугайтесь обилия кода, а просто обратите внимание на код, необходимый для выполнения развертывания файла шаблона с файлом параметров.

![Отображает соответствующий код в скрипте, который необходимо использовать для развертывания файла шаблона с помощью файла параметров.](./media/app-service-deploy-complex-application-predictably/deploy-12-powershellsnippet.png)

Именно последний командлет `New-AzureResourceGroup`выполняет это действие. Все это должно показать вам, как с помощью соответствующего инструментария сравнительно легко выполнить предсказуемое развертывание приложения в облаке. Каждый раз при запуске командлета с тем же шаблоном и тем же файлом параметров вы получите тот же результат.

## <a name="summary"></a>Итоги
В DevOps повторяемость и предсказуемость являются ключевыми факторами для любого успешного развертывания крупномасштабных приложений, состоящих из микрослужб. В этой статье рассматривалось развертывание приложения, состоящего из двух микрослужб, в Azure как отдельной группы ресурсов с помощью шаблона диспетчера ресурсов Azure. Надеемся, что вы смогли узнать все, что необходимо для преобразования приложения в Azure в шаблон, и сможете предсказуемо подготовить его и развернуть в Azure. 

<a name="resources"></a>

## <a name="more-resources"></a>Дополнительные ресурсы
* [Язык шаблонов в диспетчере ресурсов Azure](../azure-resource-manager/templates/template-syntax.md)
* [Создание шаблонов Azure Resource Manager](../azure-resource-manager/templates/template-syntax.md)
* [Azure Resource Manager функции шаблона](../azure-resource-manager/templates/template-functions.md)
* [Развертывание приложения с использованием шаблона диспетчера ресурсов Azure](../azure-resource-manager/templates/deploy-powershell.md)
* [Использование Azure PowerShell с диспетчером ресурсов Azure](../azure-resource-manager/management/manage-resources-powershell.md)
* [Устранение неполадок при развертывании групп ресурсов в Azure](../azure-resource-manager/templates/common-deployment-errors.md)

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения о синтаксисе JSON и свойствах для типов ресурсов, развертываемых в этой статье, см. таких справочниках:

* [Microsoft.Sql/servers](/azure/templates/microsoft.sql/servers)
* [Microsoft.Sql/servers/databases](/azure/templates/microsoft.sql/servers/databases)
* [Microsoft.Sql/servers/firewallRules](/azure/templates/microsoft.sql/servers/firewallrules)
* [Microsoft. Web/serverfarms](/azure/templates/microsoft.web/serverfarms)
* [Microsoft. Web/Sites](/azure/templates/microsoft.web/sites)
* [Microsoft. Web/Sites/слоты](/azure/templates/microsoft.web/sites/slots)
* [Microsoft. Insights/autoscalesettings](/azure/templates/microsoft.insights/autoscalesettings)
