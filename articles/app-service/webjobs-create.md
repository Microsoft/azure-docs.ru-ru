---
title: Выполнение фоновых задач с помощью веб-заданий
description: Узнайте, как использовать веб-задания для выполнения фоновых задач в службе приложений Azure. Выберите один из множества форматов скриптов и запустите их с помощью выражений CRON.
author: ggailey777
ms.assetid: af01771e-54eb-4aea-af5f-f883ff39572b
ms.topic: conceptual
ms.date: 10/16/2018
ms.author: glenga
ms.reviewer: msangapu;suwatch;pbatum;naren.soni
ms.custom: seodec18
adobe-target: true
adobe-target-activity: DocsExp–386541–A/B–Enhanced-Readability-Quickstarts–2.19.2021
adobe-target-experience: Experience B
adobe-target-content: ./webjobs-create-ieux
ms.openlocfilehash: 8afc8ca9b0dedb10ecdb30e8abb22a5d0986de5b
ms.sourcegitcommit: c27a20b278f2ac758447418ea4c8c61e27927d6a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "101723883"
---
# <a name="run-background-tasks-with-webjobs-in-azure-app-service"></a>Выполнение фоновых задач с помощью веб-заданий в службе приложений Azure

В этой статье показано, как развертывать веб-задания с помощью [портала Azure](https://portal.azure.com) для отправки исполняемого файла или сценария. Дополнительные сведения о том, как разрабатывать и развертывать веб-задания с помощью Visual Studio см. в статье [Develop and deploy WebJobs using Visual Studio - Azure App Service](webjobs-dotnet-deploy-vs.md) (Разработка и развертывание веб-заданий с помощью Visual Studio в службе приложений Azure).

## <a name="overview"></a>Обзор
Веб-задания — это функция [службы приложений Azure](index.yml) , которая позволяет запускать программу или сценарий в том же экземпляре, что и приложение, приложение API или мобильное приложение. Для использования веб-заданий дополнительные затраты не требуются.

> [!IMPORTANT]
> Веб-задания пока не поддерживаются Службой приложений в Linux.

Пакет SDK веб-заданий Azure может использоваться с веб-заданиями для упрощения многих задач программирования. Дополнительные сведения см. в разделе [Информация о пакете SDK веб-заданий](https://github.com/Azure/azure-webjobs-sdk/wiki).

Функции Azure предоставляют еще один способ запуска программ и сценариев. Сравнение веб-заданий и функций см. в статье [Сравнение Microsoft Flow, Logic Apps, функций и веб-заданий Azure](../azure-functions/functions-compare-logic-apps-ms-flow-webjobs.md).

## <a name="webjob-types"></a>Типы веб-заданий

В следующей таблице описаны различия между *непрерывными* и *активируемыми* веб-заданиями.


|С задержкой  |Активируемые  |
|---------|---------|
| Запускается сразу после создания веб-задания. Чтобы предотвратить завершение задания, программа или сценарий обычно выполняют свою работу в бесконечном цикле. Если задание завершается, его можно перезапустить. | Запускается только при активации вручную или по расписанию. |
| Запускается на всех экземплярах, где выполняется веб-приложение. При необходимости можно ограничить веб-задание одним экземпляром. |Запускается на одном экземпляре, который выбран Azure для балансировки нагрузки.|
| Поддерживает удаленную отладку. | Не поддерживает удаленную отладку.|

[!INCLUDE [webjobs-always-on-note](../../includes/webjobs-always-on-note.md)]

## <a name="supported-file-types-for-scripts-or-programs"></a><a name="acceptablefiles"></a>Поддерживаемые типы файлов для сценариев и программ

Поддерживаются следующие типы файлов:

* .cmd, .bat, .exe (с использованием командной строки Windows)
* .ps1 (с использованием PowerShell)
* .sh (с использованием Bash)
* .php (с использованием PHP)
* .py (с использованием Python)
* .js (с использованием Node.js)
* .jar (с использованием Java)

## <a name="create-a-continuous-webjob"></a><a name="CreateContinuous"></a>Создание непрерывного веб-задания

<!-- 
Several steps in the three "Create..." sections are identical; 
when making changes in one don't forget the other two.
-->

> [!IMPORTANT]
> Если система управления версиями настроена для приложения, веб-задания должны быть развернуты в рамках интеграции системы управления версиями. После настройки системы управления версиями с помощью приложения веб-задание нельзя добавить на портале Azure.

1. На [портале Azure](https://portal.azure.com) перейдите на страницу **Служба приложений** веб-приложения службы приложений, приложения API или мобильного приложения.

2. Выберите **Веб-задания**.

   ![Выбор веб-заданий](./media/web-sites-create-web-jobs/select-webjobs.png)

2. На странице **Веб-задания** выберите **Добавить**.

    ![Страница веб-задания](./media/web-sites-create-web-jobs/wjblade.png)

3. В окне **Добавление веб-задания** задайте значения параметров, указанные в таблице.

   ![Снимок экрана, на котором показаны параметры добавления веб-заданий, которые необходимо настроить.](./media/web-sites-create-web-jobs/addwjcontinuous.png)

   | Параметр      | Образец значения   | Описание  |
   | ------------ | ----------------- | ------------ |
   | **Имя** | myContinuousWebJob | Имя, которое является уникальным в пределах приложения службы приложений. Оно должно начинаться с буквы или цифры и не может содержать специальные символы, отличные от "-" и "_". |
   | **Отправка файла** | ConsoleApp.zip | *ZIP*-файл, который содержит исполняемый файл или файл сценария, а также все вспомогательные файлы, необходимые для запуска программы или сценария. Поддерживаемые типы исполняемых файлов или файлов сценариев перечислены в разделе [Поддерживаемые типы файлов](#acceptablefiles). |
   | **Тип** | С задержкой | [Типы веб-заданий](#webjob-types) описаны ранее в этой статье. |
   | **Масштаб** | Несколько экземпляров | Доступно только для непрерывных веб-заданий. Определяет, будет ли программа или сценарий выполняться на всех экземплярах или только на одном экземпляре. Вариант для запуска на нескольких экземплярах не применяется в [ценовых категориях](https://azure.microsoft.com/pricing/details/app-service/?ref=microsoft.com&utm_source=microsoft.com&utm_medium=docs&utm_campaign=visualstudio) "Бесплатный" или "Общий". | 

4. Нажмите кнопку **ОК**.

   Новое веб-задание появится на странице **Веб-задания**.

   ![Список веб-заданий](./media/web-sites-create-web-jobs/listallwebjobs.png)

2. Чтобы остановить или перезапустить непрерывное веб-задание, щелкните правой кнопкой мыши веб-задание в списке и выберите **Остановить** или **Запустить**.

    ![Остановка непрерывного веб-задания](./media/web-sites-create-web-jobs/continuousstop.png)

## <a name="create-a-manually-triggered-webjob"></a><a name="CreateOnDemand"></a>Создание активируемого вручную веб-задания

<!-- 
Several steps in the three "Create..." sections are identical; 
when making changes in one don't forget the other two.
-->

1. На [портале Azure](https://portal.azure.com) перейдите на страницу **Служба приложений** веб-приложения службы приложений, приложения API или мобильного приложения.

2. Выберите **Веб-задания**.

   ![Выбор веб-заданий](./media/web-sites-create-web-jobs/select-webjobs.png)

2. На странице **Веб-задания** выберите **Добавить**.

    ![Страница веб-задания](./media/web-sites-create-web-jobs/wjblade.png)

3. В окне **Добавление веб-задания** задайте значения параметров, указанные в таблице.

   ![Снимок экрана, на котором показаны параметры, которые необходимо задать для создания веб-задания, запускаемого вручную.](./media/web-sites-create-web-jobs/addwjtriggered.png)

   | Параметр      | Образец значения   | Описание  |
   | ------------ | ----------------- | ------------ |
   | **Имя** | myTriggeredWebJob | Имя, которое является уникальным в пределах приложения службы приложений. Оно должно начинаться с буквы или цифры и не может содержать специальные символы, отличные от "-" и "_".|
   | **Отправка файла** | ConsoleApp.zip | *ZIP*-файл, который содержит исполняемый файл или файл сценария, а также все вспомогательные файлы, необходимые для запуска программы или сценария. Поддерживаемые типы исполняемых файлов или файлов сценариев перечислены в разделе [Поддерживаемые типы файлов](#acceptablefiles). |
   | **Тип** | Активируемые | [Типы веб-заданий](#webjob-types) описаны ранее в этой статье. |
   | **Триггеры** | Вручную | |

4. Нажмите кнопку **ОК**.

   Новое веб-задание появится на странице **Веб-задания**.

   ![Список веб-заданий](./media/web-sites-create-web-jobs/listallwebjobs.png)

7. Чтобы запустить веб-задание, щелкните правой кнопкой мыши его имя в списке и нажмите **Запустить**.
   
    ![Запуск веб-задания](./media/web-sites-create-web-jobs/runondemand.png)

## <a name="create-a-scheduled-webjob"></a><a name="CreateScheduledCRON"></a> Создание запланированного веб-задания

<!-- 
Several steps in the three "Create..." sections are identical; 
when making changes in one don't forget the other two.
-->

1. На [портале Azure](https://portal.azure.com) перейдите на страницу **Служба приложений** веб-приложения службы приложений, приложения API или мобильного приложения.

2. Выберите **Веб-задания**.

   ![Выбор веб-заданий](./media/web-sites-create-web-jobs/select-webjobs.png)

2. На странице **Веб-задания** выберите **Добавить**.

   ![Страница веб-задания](./media/web-sites-create-web-jobs/wjblade.png)

3. В окне **Добавление веб-задания** задайте значения параметров, указанные в таблице.

   ![Страница добавления веб-задания](./media/web-sites-create-web-jobs/addwjscheduled.png)

   | Параметр      | Образец значения   | Описание  |
   | ------------ | ----------------- | ------------ |
   | **Имя** | myScheduledWebJob | Имя, которое является уникальным в пределах приложения службы приложений. Оно должно начинаться с буквы или цифры и не может содержать специальные символы, отличные от "-" и "_". |
   | **Отправка файла** | ConsoleApp.zip | *ZIP*-файл, который содержит исполняемый файл или файл сценария, а также все вспомогательные файлы, необходимые для запуска программы или сценария. Поддерживаемые типы исполняемых файлов или файлов сценариев перечислены в разделе [Поддерживаемые типы файлов](#acceptablefiles). |
   | **Тип** | Активируемые | [Типы веб-заданий](#webjob-types) описаны ранее в этой статье. |
   | **Триггеры** | Запланировано | Для надежной работы расписания включите функцию Always On. Она доступна только в ценовых категориях "Базовый", "Стандартный" и "Премиум".|
   | **Выражение CRON** | 0 0/20 * * * * | Выражения [CRON](#ncrontab-expressions) описаны в следующем разделе. |

4. Нажмите кнопку **ОК**.

   Новое веб-задание появится на странице **Веб-задания**.

   ![Список веб-заданий](./media/web-sites-create-web-jobs/listallwebjobs.png)

## <a name="ncrontab-expressions"></a>Выражения НКРОНТАБ

Можно ввести [выражение нкронтаб](../azure-functions/functions-bindings-timer.md#ncrontab-expressions) на портале или включить `settings.job` файл в корень *ZIP* -файла веб-задания, как показано в следующем примере:

```json
{
    "schedule": "0 */15 * * * *"
}
```

Дополнительные сведения см. в разделе [Планирование запуска веб-задания](webjobs-dotnet-deploy-vs.md#scheduling-a-triggered-webjob).

[!INCLUDE [webjobs-cron-timezone-note](../../includes/webjobs-cron-timezone-note.md)]

## <a name="view-the-job-history"></a><a name="ViewJobHistory"></a> Просмотр журнала заданий

1. Выберите веб-задание, журнал которого необходимо просмотреть, а затем нажмите кнопку **Журналы**.
   
   ![Кнопка "Журналы"](./media/web-sites-create-web-jobs/wjbladelogslink.png)

2. На странице **WebJob Details** (Подробности веб-задания) выберите время, чтобы просмотреть подробные сведения об одном выполнении.
   
   ![Подробности веб-задания](./media/web-sites-create-web-jobs/webjobdetails.png)

3. На странице **WebJob Details** (Подробности веб-задания) выберите **Переключить выходные данные**, чтобы увидеть текст содержимого журнала.
   
    ![Сведения о выполнении веб-задания](./media/web-sites-create-web-jobs/webjobrundetails.png)

   Чтобы просмотреть текст вывода в отдельном окне браузера, щелкните ссылку **скачать**. Чтобы скачать текст, щелкните ссылку **скачать** правой кнопкой мыши и выберите команду для сохранения содержимого файла в контекстном меню браузера.
   
5. Выберите ссылку навигации **Веб-задания** в верхней части страницы, чтобы перейти к списку веб-заданий.

    ![Навигация веб-заданий](./media/web-sites-create-web-jobs/breadcrumb.png)
   
    ![Список веб-заданий на панели мониторинга журнала](./media/web-sites-create-web-jobs/webjobslist.png)
   
## <a name="next-steps"></a><a name="NextSteps"></a> Дальнейшие действия

Пакет SDK веб-заданий Azure может использоваться с веб-заданиями для упрощения многих задач программирования. Дополнительные сведения см. в разделе [Информация о пакете SDK веб-заданий](https://github.com/Azure/azure-webjobs-sdk/wiki).
