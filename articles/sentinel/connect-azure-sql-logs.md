---
title: Подключение журналов диагностики и аудита базы данных SQL Azure к Azure Sentinel
description: Узнайте, как подключить журналы диагностики базы данных SQL Azure и журналы аудита безопасности к Azure Sentinel.
author: yelevin
manager: rkarlin
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.topic: how-to
ms.date: 01/06/2021
ms.author: yelevin
ms.openlocfilehash: a3a09ceffc75e2d396d7bd7aeedd97b7f2b6ec2b
ms.sourcegitcommit: 8245325f9170371e08bbc66da7a6c292bbbd94cc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/07/2021
ms.locfileid: "99807739"
---
# <a name="connect-azure-sql-database-diagnostics-and-auditing-logs"></a>Подключение журналов диагностики и аудита базы данных SQL Azure

SQL Azure — это полностью управляемое ядро базы данных платформы как услуга (PaaS), которое обрабатывает большинство функций управления базами данных, таких как обновление, исправление, резервное копирование и мониторинг, без участия пользователя. 

Соединитель базы данных SQL Azure позволяет выполнять потоковую передачу журналов аудита и диагностики баз данных в Azure Sentinel, что позволяет постоянно отслеживать действия во всех экземплярах.

- Подключение журналов диагностики позволяет отправить журналы диагностики баз данных различных типов в рабочую область Sentinel Azure.

- Подключение журналов аудита позволяет выполнять потоковую передачу журналов аудита безопасности из всех баз данных SQL Azure на уровне сервера.

Дополнительные сведения о [мониторинге баз данных SQL Azure](../azure-sql/database/metrics-diagnostic-telemetry-logging-streaming-export-configure.md).

## <a name="prerequisites"></a>Предварительные требования

- У вас должны быть разрешения на чтение и запись в рабочей области Sentinel Azure.

- Для подключения к журналам аудита необходимо иметь разрешения на чтение и запись для параметров аудита SQL Server Azure.

## <a name="connect-to-azure-sql-database"></a>Подключение к базе данных SQL Azure
    
1. В меню навигации меток Azure выберите **соединители данных**.

1. Выберите **базу данных SQL Azure** из коллекции соединителей данных, а затем на панели предварительного просмотра выберите **открыть страницу соединителя**  .

1. В разделе **Конфигурация** на странице соединителя Обратите внимание на две категории журналов, которые можно подключить.

### <a name="connect-diagnostics-logs"></a>Подключение журналов диагностики

1. В разделе **журналы диагностики** разверните узел **включить журналы диагностики в каждой из баз данных SQL Azure вручную**.

1. Щелкните ссылку **Open Azure sql >** , чтобы открыть колонку ресурсов **SQL Azure** .

1. **(Необязательно)** Чтобы легко найти ресурс базы данных, щелкните **Добавить фильтр** на панели Фильтры вверху.
    1. В раскрывающемся списке **Фильтр** выберите **тип ресурса**.
    1. В раскрывающемся списке **значение** снимите флажок **выбрать все** и выберите **база данных SQL**.
    1. Нажмите кнопку **Применить**.
    
1. Выберите ресурс базы данных, журналы диагностики которого вы хотите отправить в Azure Sentinel.

    > [!NOTE]
    > Для каждого ресурса базы данных, журналы которого необходимо получить, необходимо повторить этот процесс, начиная с этого шага.

1. На странице ресурсов выбранной базы данных в разделе **мониторинг** в меню Навигация выберите **параметры диагностики**.

    1. Щелкните ссылку **+ Добавить параметр диагностики** в нижней части таблицы.

    1. На экране **параметры диагностики** введите имя в поле  **имя параметра диагностики** .
    
    1. В столбце **назначение** установите флажок **отправить в log Analytics рабочую область** . Под ним будут отображаться два новых поля. Выберите подходящую **подписку** и **log Analytics рабочую область** (где находится метка Azure).

    1. В столбце **Категория сведения** установите флажки для журналов и типов метрик, которые требуется принять. Рекомендуется выбирать все доступные типы в **журнале** и **метрике**.

    1. Выберите **сохранить** в верхней части экрана.

- Кроме того, вы можете использовать указанный **сценарий PowerShell** для подключения журналов диагностики.
    1. В разделе **журналы диагностики** разверните узел **включить с помощью скрипта PowerShell**.

    1. Скопируйте блок кода и вставьте его в PowerShell.

### <a name="connect-audit-logs"></a>Подключение журналов аудита

1. В разделе **журналы аудита (Предварительная версия)** разверните узел **включить журналы аудита во всех базах данных SQL Azure (на уровне сервера)**.

1. Щелкните ссылку **Open Azure sql >** , чтобы открыть колонку ресурсов " **серверы SQL Server** ".

1. Выберите SQL Server, журналы аудита которого вы хотите отправить в Azure Sentinel.

    > [!NOTE]
    > Для каждого серверного ресурса, журналы которого необходимо получить, необходимо повторить этот процесс, начиная с этого шага.

1. На странице ресурсов выбранного сервера в разделе **Безопасность** в меню Навигация выберите **Аудит**.

    1. Переместите переключатель **включить аудит SQL для Azure** в положение **вкл**.

    1. В разделе **назначение журнала аудита** выберите **log Analytics (Предварительная версия)**.
    
    1. В открывшемся списке рабочих областей выберите рабочую область (где находится метка Azure).

    1. Выберите **сохранить** в верхней части экрана.

- Кроме того, вы можете использовать указанный **сценарий PowerShell** для подключения журналов диагностики.
    1. В разделе **журналы аудита** разверните узел **включить с помощью скрипта PowerShell**.

    1. Скопируйте блок кода и вставьте его в PowerShell.


> [!NOTE]
>
> С этим конкретным соединителем данных индикаторы состояния подключения (цветовая полоса в коллекции соединителей данных и значки подключения рядом с именами типов данных) отображаются как *подключенные* (зеленые), только если данные были приняты в течение последних двух недель. По прошествии двух недель без приема данных соединитель будет отображаться как отключенный. В то время, когда поступает больше данных, состояние *Connected* будет возвращено.

## <a name="next-steps"></a>Дальнейшие действия
В этом документе вы узнали, как подключить диагностику базы данных SQL Azure и журналы аудита к Azure Sentinel. Ознакомьтесь с дополнительными сведениями об Azure Sentinel в соответствующих статьях.
- Узнайте, как [отслеживать свои данные и потенциальные угрозы](quickstart-get-visibility.md).
- Узнайте, как приступить к [обнаружению угроз с помощью Azure Sentinel](tutorial-detect-threats-built-in.md).