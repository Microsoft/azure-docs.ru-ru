---
title: Возможности поискового заметок в Azure Sentinel | Документация Майкрософт
description: Используйте встроенные запросы поиска Sentinel Azure, чтобы запрашивать правильные вопросы по поиску проблем в данных.
services: sentinel
documentationcenter: na
author: yelevin
manager: rkarlin
editor: ''
ms.assetid: 6aa9dd27-6506-49c5-8e97-cc1aebecee87
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.devlang: na
ms.topic: conceptual
ms.custom: mvc
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/10/2019
ms.author: yelevin
ms.openlocfilehash: b88185a09e69b1c7bd6c6c58b8e22190b4a2e394
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100576752"
---
# <a name="hunt-for-threats-with-azure-sentinel"></a>Поиск угроз с помощью Azure Sentinel

Если вы исследователю, кто хочет быть в состоянии профилактического рассмотрения угроз безопасности, мощные средства поиска и запросов в Azure Sentinel помогут найти угрозы безопасности в источниках данных Организации. Но системы и устройства безопасности создают горы данных, которые могут быть трудно анализировать и фильтровать в осмысленных событиях. Чтобы помочь аналитикам безопасности просматривать новые аномалии, которые не были обнаружены приложениями безопасности, встроенные запросы поиска с помощью Azure Sentinel посвящены вам в поиске проблем в данных, уже существующих в сети. 

Например, один встроенный запрос предоставляет данные о наиболее редких процессах, выполняемых в вашей инфраструктуре. Предупреждение о каждом запуске не требуется, но может быть полностью безобидным, но, возможно, стоит взглянуть на запрос, чтобы увидеть, есть ли что-то необычное. 



Поиск маркеров Azure позволяет воспользоваться следующими возможностями:

- Встроенные запросы. чтобы приступить к работе, начальная страница предоставляет предварительно загруженные примеры запросов, предназначенные для начала работы и знакомства с таблицами и языком запросов. Эти встроенные запросы поиска разрабатываются законами корпорации Майкрософт по безопасности на постоянной основе, добавляя новые запросы и тонкой настройке существующих запросов, чтобы предоставить точку входа для поиска новых обнаружений и выяснить, где начать поиск новичков в новых атаках. 

- Мощный язык запросов с технологией IntelliSense: основан на языке запросов, который обеспечивает гибкость, необходимую для поиска на следующем уровне.

- Создание собственных закладок. в процессе поиска вы можете столкнуться с результатами или результатами, панелями мониторинга или действиями, которые выглядят непривычными или подозрительными. Чтобы пометить эти элементы, чтобы в будущем можно было вернуться к ним, используйте функции закладок. Закладки позволяют сохранить элементы для последующего использования, чтобы создать инцидент для расследования. Дополнительные сведения о закладках см. [в статье Использование закладок в поиске](hunting.md).
- Использование записных книжек для автоматического исследования: записные книжки подобны пошаговым модули PlayBook, которые можно создать, чтобы проанализировать этапы исследования и поиска.  Записные книжки инкапсулируют все действия по поиску в многократно используемом сборник тренировочных заданий, который можно использовать совместно с другими пользователями в Организации. 
- Запрос сохраненных данных: данные доступны в таблицах для запроса. Например, можно запрашивать создание процессов, события DNS и многие другие типы событий.

- Ссылки на сообщество: Используйте преимущества улучшенного сообщества, чтобы найти дополнительные запросы и источники данных.
 
## <a name="get-started-hunting"></a>Поиск в начале работы

1. На портале Sentinel Azure щелкните Поиск **.**
  ![Azure Sentinel начинает поиск](media/tutorial-hunting/hunting-start.png)

2. При **открытии страницы Поиск** все запросы на поиск отображаются в одной таблице. В таблице перечислены все запросы, написанные группой аналитиков безопасности корпорации Майкрософт, а также все созданные или измененные дополнительные запросы. Каждый запрос содержит описание того, для чего он выполняет поиск, и сведения о типе данных, на котором он выполняется. Эти шаблоны группируются по различным тактикам. значки в правой категории классифицируют тип угрозы, например начальный доступ, сохраняемость и утечка. Эти шаблоны запросов поиска можно фильтровать с помощью любого поля. Любой запрос можно сохранить в избранное. При сохранении запроса в избранное запрос автоматически выполняется каждый раз при обращении **к странице поиска** . Можно создать собственный запрос поиска или клонировать и настроить существующий шаблон запроса поиска. 
 
2. Нажмите кнопку **выполнить запрос** на странице сведений о запросе поиска, чтобы выполнить любой запрос, не закрывая страницу поиска.  Число совпадений отображается в таблице. Просмотр списка запросов поиска и их совпадений. Проверьте, с какой стадией в цепочке уничтожения связано сопоставление.

3. Выполните быструю проверку базового запроса в области сведения о запросе или нажмите кнопку **просмотреть результат запроса** , чтобы открыть запрос в log Analytics. В нижней части страницы Просмотрите сопоставления для запроса.

4.    Щелкните строку и выберите **Добавить закладку** , чтобы добавить строки для анализа. это можно сделать для любых элементов, которые выглядят подозрительными. 

5. Затем вернитесь **на главную страницу** Поиск и щелкните вкладку **закладки** , чтобы просмотреть все подозрительные действия. 

6. Выберите закладку и нажмите кнопку **исследовать** , чтобы открыть процесс расследования. Закладки можно отфильтровать. Например, если вы изучаете кампанию, можно создать тег для кампании, а затем отфильтровать все закладки на основе кампании.

1. После того как вы обнаружите, какой запрос поиска обеспечивает высокую ценность для возможных атак, можно также создать настраиваемые правила обнаружения на основе запроса и получить эти сведения в виде оповещений для ответчиков инцидентов безопасности.

 

## <a name="query-language"></a>Язык запросов 

Поиск в Azure Sentinel основан на языке запросов Kusto. Дополнительные сведения о языке запросов и поддерживаемых операторах см. в разделе [Справочник по языку запросов](../azure-monitor/logs/get-started-queries.md).

## <a name="public-hunting-query-github-repository"></a>Общий репозиторий GitHub для запросов поиска

Ознакомьтесь с [репозиторием запросов](https://github.com/Azure/Orion)поиска. Contribute и использование примеров запросов, совместно используемых нашими клиентами.

 

## <a name="sample-query"></a>Пример запроса

Типичный запрос содержит имя таблицы и ряд операторов, разделенных символом \|.

В приведенном выше примере начните с имени таблицы SecurityEvent и добавьте элементы с погрузкой по мере необходимости.

1. Определите фильтр времени, чтобы проверить только записи за предыдущие семь дней.

2. Добавьте фильтр в запрос, чтобы отображалось только событие с ИДЕНТИФИКАТОРом 4688.

3. Добавьте фильтр в запрос в командной строке, чтобы он содержал только экземпляры cscript.exe.

4. Проецировать только интересующие вас столбцы и ограничивают результаты до 1000 и нажмите кнопку **выполнить запрос**.
5. Щелкните зеленый треугольник и выполните запрос. Вы можете проверить запрос и запустить его, чтобы найти аномальное поведение.

## <a name="useful-operators"></a>Полезные операторы

Язык запросов является мощным и имеет множество доступных операторов. здесь перечислены некоторые полезные операторы:

**где** — фильтровать таблицу по подмножеству строк, которые соответствуют предикату.

**Сводка** . формирует таблицу, которая выполняет статистическую обработку содержимого входной таблицы.

**объединение** — объединение строк двух таблиц для формирования новой таблицы путем сопоставления значений указанных столбцов из каждой таблицы.

**Count** — возврат количества записей во входном наборе записей.

**Top** — возвращает первые N записей, отсортированных по указанным столбцам.

**Limit** — возврат к указанному числу строк.

**проект** — выберите столбцы для включения, переименования или удаления и вставки новых вычисленных столбцов.

**расширение** — создание вычисляемых столбцов и добавление их к результирующему набору.

**make** — возврат динамического (JSON) массива из набора уникальных значений, которые выражение expr принимает в группе

**Find** — Поиск строк, соответствующих предикату в наборе таблиц.

## <a name="save-a-query"></a>Сохранение запроса

Можно создать или изменить запрос и сохранить его как собственный запрос или предоставить к нему доступ пользователям, наявляющимся в том же клиенте.

   ![Сохранение запроса](./media/tutorial-hunting/save-query.png)

Создать новый запрос поиска:

1. Нажмите кнопку **создать запрос** и выберите **сохранить**.
2. Заполните все пустые поля и выберите **сохранить**.

   ![Создать запрос](./media/tutorial-hunting/new-query.png)

Клонирование и изменение существующего запроса поиска:

1. Выберите запрос поиска в таблице, которую необходимо изменить.
2. Нажмите кнопку с многоточием (...) в строке запроса, который необходимо изменить, и выберите **клонировать запрос**.

   ![клонировать запрос](./media/tutorial-hunting/clone-query.png)
 

3. Измените запрос и выберите **создать**.

   ![Пользовательский запрос](./media/tutorial-hunting/custom-query.png)

## <a name="next-steps"></a>Дальнейшие действия
В этой статье вы узнали, как выполнить поиск с помощью Azure Sentinel. Ознакомьтесь с дополнительными сведениями об Azure Sentinel в соответствующих статьях.


- [Использование записных книжек для выполнения автоматизированного поисковых кампаний](notebooks.md)
- [Использование закладок для сохранения интересных сведений во время охоты](bookmarks.md)