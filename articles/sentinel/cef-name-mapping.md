---
title: Ключ общего формата событий (CEF) и сопоставление полей CommonSecurityLog
description: Эта статья сопоставляет ключи CEF с соответствующими именами полей в CommonSecurityLog в Azure Sentinel.
services: sentinel
author: batamig
ms.author: bagol
ms.service: azure-sentinel
ms.subservice: azure-sentinel
ms.topic: reference
ms.date: 03/16/2021
ms.openlocfilehash: 6c23fe86af030d371e12914062bb9558e8db3484
ms.sourcegitcommit: 2c1b93301174fccea00798df08e08872f53f669c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "104776300"
---
# <a name="cef-and-commonsecuritylog-field-mapping"></a>Сопоставление полей CEF и CommonSecurityLog

В приведенных ниже таблицах имена полей общих событий формата (CEF) сопоставляются с именами, которые они используют в CommonSecurityLogах Sentinel Azure, и могут быть полезны при работе с источником данных CEF в Sentinel.

Дополнительные сведения см. в статье [Подключение внешнего решения с помощью общего формата событий](connect-common-event-format.md).

## <a name="a---c"></a>A — C

|Имя ключа CEF  |Имя поля CommonSecurityLog  |Описание  |
|---------|---------|---------|
| ACT    |    <a name="deviceaction"></a> девицеактион     |  Действие, указанное в событии.       |
|   app  |    ApplicationProtocol     |  Протокол, используемый в приложении, например HTTP, HTTPS, SSHv2, Telnet, POP, ИМПа, IMAP и т. д.   |
| cnt    |    EventCount     |  Число, связанное с событием, показывающее, сколько раз было замечено одно и то же событие.       |
| | | |

## <a name="d"></a>D

|Имя ключа CEF  |Имя CommonSecurityLog  |Описание  |
|---------|---------|---------|
|Поставщик устройства     |  девицевендор       | Строка, которая вместе с определениями продукта и версии устройства уникально определяет тип отправляющего устройства.       |
|Продукт устройства     |   девицепродукт      |   Строка, которая вместе с определениями поставщиков и версий устройств уникально определяет тип отправляющего устройства.        |
|Версия устройства     |   девицеверсион      |      Строка, которая вместе с определениями продуктов и поставщиков устройств уникально определяет тип отправляющего устройства.     |
|девицеевентклассид     |   девицеевентклассид     |   Строка или целое число, служащая уникальным идентификатором для каждого типа событий.      |
| дестинатионднсдомаин    | дестинатионднсдомаин        |   DNS-часть полного доменного имени (FQDN).      |
| destinationServiceName | дестинатионсервиценаме | Служба, на которую ссылается событие. Например, `sshd`.|
| дестинатионтранслатедаддресс | дестинатионтранслатедаддресс | Определяет переведенное расположение, на которое ссылается событие в IP-сети, в качестве IP-адреса IPv4. |
| дестинатионтранслатедпорт | дестинатионтранслатедпорт | Порт после перевода, например брандмауэр. <br>Допустимые номера портов: `0` - `65535` |
| девицедиректион | <a name="communicationdirection"></a> коммуникатиондиректион | Любые сведения о направлении наблюдаемого обмена данными. Допустимые значения: <br>- `0` = Входящее <br>- `1` = Исходящий трафик |
| девицеднсдомаин | девицеднсдомаин | Часть DNS-домена, которая является полным доменным именем (FQDN); |
| девицеекстерналид | девицеекстерналид | Имя, уникально идентифицирующее устройство, создающее событие. |
| девицефаЦилити | девицефаЦилити | Средство, создающее событие.|
| девицеинбаундинтерфаце | девицеинбаундинтерфаце |Интерфейс, в котором пакет или данные были указаны на устройстве.  |
| девицентдомаин | девицентдомаин | Домен адреса устройства Windows |
| девицеаутбаундинтерфаце | девицеаутбаундинтерфаце |Интерфейс, в котором пакет или данные остаются на устройстве. |
| девицепайлоадид |девицепайлоадид |Уникальный идентификатор полезных данных, связанных с событием. |
| девицепроцесснаме | ProcessName | Имя процесса, связанное с событием. <br><br>Например, в UNIX процесс, создающий запись системного журнала. |
| девицетранслатедаддресс | девицетранслатедаддресс | Определяет переведенный адрес устройства, на который ссылается событие, в IP-сети. <br><br>Формат является IPv4-адресом. |
| дхост |дестинатионхостнаме | Назначение, на которое ссылается событие в IP-сети.  <br>Формат должен быть полным доменным именем, связанным с узлом назначения, если узел доступен. Например, `host.domain.com` или `host`. |
| дмак | дестинатионмакаддресс | Конечный MAC-адрес (FQDN) |
| днтдом | дестинатионнтдомаин | Имя домена Windows для адреса назначения.|
| dpid | дестинатионпроцессид |Идентификатор процесса назначения, связанного с событием.|
| дприв | дестинатионусерпривилежес | Определяет привилегии места назначения. <br>Допустимые значения: `Admninistrator` , `User` , `Guest` |
| дпрок | дестинатионпроцесснаме | Имя процесса назначения события, например `telnetd` или `sshd.` |
| DPT | DestinationPort | Порт назначения. <br>Допустимые значения: `*0` - `65535` |
| кон | дестинатионип | Адрес IpV4 назначения, на который ссылается событие в IP-сети. |
| дтз | девицетимезон | Часовой пояс устройства, создающего событие |
| DUID |дестинатионусерид | Идентифицирует целевого пользователя по ИДЕНТИФИКАТОРу. |
| дусер | дестинатионусернаме |Идентифицирует целевого пользователя по имени.|
| dvc | девицеаддресс | IPv4-адрес устройства, создающего событие. |
| двчост | DeviceName | Полное доменное имя, связанное с узлом устройства, если узел доступен. Например, `host.domain.com` или `host`.| 
| двкмак | девицемакаддресс | MAC-адрес устройства, создающего событие. |
| двкпид | ИД процесса | Определяет идентификатор процесса на устройстве, создающем событие. |

## <a name="e---i"></a>E-I

|Имя ключа CEF  |Имя CommonSecurityLog  |Описание  |
|---------|---------|---------|
|end     |  EndTime       | Время окончания действия, связанного с событием.        |
|externalId    |   ExternalID      | Идентификатор, используемый исходным устройством. Как правило, эти значения увеличивают значения, связанные с событием.        |
|филекреатетиме     |  филекреатетиме      | Время создания файла.        |
|FileHash     |   FileHash      |   Хэш-код файла.      |
|fileId     |   FileID      |Идентификатор, связанный с файлом, например иноде.         |
| филемодификатионтиме | филемодификатионтиме |Время последнего изменения файла. |
| filePath | FilePath | Полный путь к файлу, включая имя файла. Пример: `C:\ProgramFiles\WindowsNT\Accessories\wordpad.exe` или `/usr/bin/zip`.|
| филепермиссион |филепермиссион |Разрешения файла. |
| fileType | FileType | Тип файла, например канал, сокет и т. д.|
|fname | FileName| Имя файла без пути. |
| fsize | FileSize | Размер файла. |
|Узел    |  Компьютер       | Узел, из системного журнала        |
|in     |  ReceivedBytes      |Число переданных байтов.         |
| | | |

## <a name="m---p"></a>M-P

|Имя ключа CEF  |Имя CommonSecurityLog  |Описание  |
|---------|---------|---------|
|msg   |  Сообщение       | Сообщение, в котором содержатся дополнительные сведения о событии.        |
|Имя     |  Действие       |   Строка, представляющая понятное и понятное описание события.     |
|олдфилекреатетиме     |  олдфилекреатетиме       | Время создания старого файла.        |
|олдфилехаш     |   олдфилехаш      |   Хэш старого файла.      |
|олдфилеид     |   олдфилеид     |   И идентификатор, связанный со старым файлом, например иноде.      |
| олдфилемодификатионтиме | олдфилемодификатионтиме |Время последнего изменения старого файла. |
| олдфиленаме |  олдфиленаме |Имя старого файла. |
| олдфилепас | олдфилепас | Полный путь к старому файлу, включая имя файла. <br>Например, `C:\ProgramFiles\WindowsNT\Accessories\wordpad.exe` или `/usr/bin/zip`.|
| олдфилепермиссион | олдфилепермиссион |Разрешения старого файла. |
|олдфилесизе | олдфилесизе | Размер старого файла.|
| олдфилетипе | олдфилетипе | Тип старого файла, например канал, сокет и т. д.|
| out | SentBytes | Число байтов, переданных для исходящей передачи. |
| Результат | Результат | Результат события, например `success` или `failure` .|
|proto    |  Протокол       | Транспортный протокол, определяющий используемый протокол уровня 4. <br><br>Возможные значения — имена протоколов, например `TCP` или `UDP` .        |
| | | |

## <a name="r---t"></a>R-T

|Имя ключа CEF  |Имя CommonSecurityLog  |Описание  |
|---------|---------|---------|
|Причина     |  Причина      |Причина, по которой было создано событие аудита. <br><br>Например, `Bad password` или `Unknown user`.         |
|Запрос     |   RequestURL      | URL-адрес, к которому обращается HTTP-запрос, включая протокол. Например `http://www/secure.com`.        |
|requestClientApplication     |   рекуестклиентаппликатион      |   Агент пользователя, связанный с запросом.      |
| requestContext | RequestContext | Описывает содержимое, из которого поступил запрос, например источник ссылки HTTP. |
| рекуесткукиес | рекуесткукиес |Файлы cookie, связанные с запросом. |
| requestMethod | рекуестмесод | Метод, используемый для доступа к URL-адресу. <br><br>Допустимые значения включают в себя такие методы `POST` , как, `GET` и т. д. |
| rt | рецеипттиме | Время получения события, связанного с действием. |
|Severity     |  <a name="logseverity"></a> LogSeverity       |  Строка или целое число, описывающие важность события.<br><br> Допустимые строковые значения: `Unknown` , `Low` , `Medium` , `High` , `Very-High` <br><br>Допустимые целые значения: `0` - `3` = Low, `4` - `6` = средний, `7` - `8` = High, `9` - `10` = Very-High |
| shost    | SourceHostName        |Определяет источник, на который ссылается событие в IP-сети. Формат должен быть полным доменным именем (ДКДН), связанным с исходным узлом, если узел доступен. Например, `host` или `host.domain.com`. |
| смак | саурцемакаддресс | MAC-адрес источника. |
| снтдом | саурцентдомаин | Имя домена Windows для исходного адреса. |
| sourceDnsDomain | саурцеднсдомаин | Домен DNS-часть полного полного доменного имени. |
| sourceServiceName | саурцесервиценаме | Служба, отвечающая за создание события. |
| саурцетранслатедаддресс | саурцетранслатедаддресс | Идентифицирует преобразованный источник, на который ссылается событие в IP-сети. |
| саурцетранслатедпорт | саурцетранслатедпорт | Исходный порт после перевода, например брандмауэр. <br>Допустимые номера портов: `0`  -  `65535` . |
| spid | саурцепроцессид | Идентификатор исходного процесса, связанного с событием.|
| сприв | саурцеусерпривилежес | Привилегии исходного пользователя. <br><br>Допустимые значения: `Administrator` , `User` , `Guest` |
| sproc | саурцепроцесснаме | Имя исходного процесса события.|
| спт | SourcePort | Номер исходного порта. <br>Допустимые номера портов: `0`  -  `65535` . |
| src | SourceIP |Источник, на который ссылается событие в IP-сети, в виде адреса IPv4. |
| start | StartTime | Время начала действия, на которое ссылается событие. |
| SUID | саурцеусерид | Идентифицирует пользователя источника по ИДЕНТИФИКАТОРу. |
| type | EventType | Тип события. Значения значений включают: <br>- `0`: базовое событие <br>- `1`: агрегированная <br>- `2`: событие корреляции <br>- `3`: событие действия <br><br>**Примечание**. Это событие можно опустить для базовых событий. |
| | | |

## <a name="unmapped-fields"></a>Несопоставленные поля

Следующие имена полей **CommonSecurityLog** не имеют сопоставлений в ключах CEF:


|Имя поля CommonSecurityLog  |Описание  |
|---------|---------|
|**оригиналлогсеверити**     |  Всегда пусто, поддерживается для интеграции с Цискоаса. <br>Дополнительные сведения о значениях серьезности журнала см. в поле [LogSeverity](#logseverity) .       |
|**RemoteIP**     |     Удаленный IP-адрес. <br>Это значение основано на поле [коммуникатиондиректион](#communicationdirection) , если это возможно.     |
|**ремотепорт**     |   Удаленный порт. <br>Это значение основано на поле [коммуникатиондиректион](#communicationdirection) , если это возможно.      |
|**симплифиеддевицеактион**     |   Упрощает значение [девицеактион](#deviceaction) для статического набора значений, сохраняя исходное значение в поле [девицеактион](#deviceaction) . <br>Например: `Denied`  >  `Deny` .      |
|     |         |


## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения см. в статье [Подключение внешнего решения с помощью общего формата событий](connect-common-event-format.md).
