---
title: Приложение Azure весны для облачного доступа в виртуальной сети
description: Доступ к приложению в Azure Веснного облака в виртуальной сети.
author: MikeDodaro
ms.author: brendm
ms.service: spring-cloud
ms.topic: how-to
ms.date: 11/11/2020
ms.custom: devx-track-java
ms.openlocfilehash: 37c8b4bc186c217ecb27638f5f50297102345de7
ms.sourcegitcommit: 1f1d29378424057338b246af1975643c2875e64d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2021
ms.locfileid: "99576537"
---
# <a name="access-your-application-in-a-private-network"></a>Доступ к приложению в частной сети

В этом документе объясняется, как получить доступ к конечной точке приложения в частной сети.  Чтобы получить доступ, необходимо создать в подписке **зону Azure частная зона DNS** , чтобы преобразовать или разрешить частное полное доменное имя (FQDN) в его IP-адрес.

Когда в виртуальной сети развертывается **назначение конечной точки** для приложений в экземпляре облачной службы Azure весны, конечная точка является частным полным доменным именем. Домен доступен только в частной сети. Приложения и службы используют конечную точку приложения. Они включают **конечную точку теста** , описанную в статье [Просмотр приложений и развертываний](spring-cloud-howto-staging-environment.md#view-apps-and-deployments). **Потоковая передача журналов**, описанная в статье [потоки журналов облачного приложения Azure весны в реальном времени](spring-cloud-howto-log-streaming.md), также работает только в частной сети.

## <a name="create-a-private-dns-zone"></a>Создание частной зоны DNS

Следующая процедура создает частную зону DNS для приложения в частной сети.

1. Откройте портал Azure. В верхнем поле поиска найдите **зоны частная зона DNS** и выберите **Частная зона DNS зоны** из результата.

2. На странице **Частная зона DNS зоны** выберите **+ Добавить**.

3. Заполните форму на странице **Создание зоны частная зона DNS** . Введите **<span>Private.azuremicroservices.IO</span>** в качестве **имени** зоны.

4. Выберите **Review + Create** (Просмотреть и создать).

5. Нажмите кнопку **создания**.

Создание зоны может занять несколько минут.

## <a name="link-the-virtual-network"></a>Связывание виртуальной сети

Чтобы связать частную зону DNS с виртуальной сетью, необходимо создать связь с виртуальной сетью.

1. Выберите ресурс частной зоны DNS, созданный ранее: **<span>Private.azuremicroservices.IO</span>** 

2. В левой области выберите **Virtual network links** (Связи виртуальных сетей).

3. Выберите **Добавить**.

4. Введите **ссылку Azure-пружины-Cloud-DNS** , чтобы указать **имя ссылки**.

5. В поле **Виртуальная сеть** выберите созданную виртуальную сеть, как описано в разделах [развертывание Azure с пружинным облаком в виртуальной сети Azure (Вставка в виртуальную сеть)](spring-cloud-tutorial-deploy-in-azure-virtual-network.md).

    ![Добавление виртуальной сети](media/spring-cloud-access-app-vnet/add-virtual-network-link.png)

6. Нажмите кнопку **ОК**.

## <a name="create-dns-record"></a>Создание записи DNS

Чтобы использовать частную зону DNS для преобразования или разрешения DNS, необходимо создать в зоне запись типа "A".

1. Выберите ресурс виртуальной сети, который вы создали, как описано в разделах [развертывание Azure веснного облака в виртуальной сети Azure (Вставка в виртуальную сеть)](spring-cloud-tutorial-deploy-in-azure-virtual-network.md).

2. В поле поиска **подключенные устройства** введите *kubernetes-Internal*.

3. В отфильтрованном результате найдите **устройство** , подключенное к **подсети** среды выполнения службы экземпляра службы, и скопируйте его **IP-адрес**. В этом примере IP-адрес — *10.1.0.7*.

    [![Создать запись ](media/spring-cloud-access-app-vnet/create-dns-record.png) DNS](media/spring-cloud-access-app-vnet/create-dns-record.png)

Вы также можете получить IP-адрес с помощью следующей команды AZ CLI:

```azurecli
SPRING_CLOUD_RG= # Resource group name of your Azure Spring Cloud service instance
SPRING_CLOUD= # Name of your Azure Spring Cloud service instance

SERVICE_RUNTIME_RG=`az spring-cloud show -g $SPRING_CLOUD_RG -n $SPRING_CLOUD --query \
"properties.networkProfile.serviceRuntimeNetworkResourceGroup" -o tsv`

IP_ADDRESS=`az network lb frontend-ip list --lb-name kubernetes-internal -g \
$SERVICE_RUNTIME_RG --query "[0].privateIpAddress" -o tsv`
```

4. Выберите ресурс частной зоны DNS, созданный ранее: **<span>Private.azuremicroservices.IO</span>**.

5. Выберите **+ Набор записей**.

6. В окне **Добавление набора записей** введите или выберите следующие сведения:

    |Параметр     |Значение                                                                      |
    |------------|---------------------------------------------------------------------------|
    |Имя        |Введите *\** .                                                                 |
    |Тип        |Выберите                                                                |
    |СРОК ЖИЗНИ         |Введите *1*                                                                  |
    |Единица срока жизни    |Выбор **часов**                                                           |
    |IP-адрес  |Введите IP-адрес, скопированный на шаге 3. В примере введите *10.1.0.7*.    |

    Нажмите кнопку **ОК**.

    ![Добавление записи зоны частного DNS](media/spring-cloud-access-app-vnet/private-dns-zone-add-record.png)

## <a name="assign-private-fqdn-for-your-application"></a>Назначение частного полного доменного имени для приложения

После выполнения процедуры, описанной в разделе [Создание и развертывание приложений микрослужб](spring-cloud-tutorial-deploy-in-azure-virtual-network.md), можно назначить частное полное доменное имя приложения.

1. Выберите экземпляр облачной службы Azure весны, развернутой в виртуальной сети, и откройте вкладку **приложения** в меню слева.

2. Выберите приложение, чтобы отобразить страницу **обзора** .

3. Выберите **назначить конечную точку** , чтобы назначить частное полное доменное имя для приложения. Это может занять несколько минут.

    ![Назначить закрытую конечную точку](media/spring-cloud-access-app-vnet/assign-private-endpoint.png)

4. Назначенное частное полное доменное имя ( **URL-адрес** с меткой) теперь доступно. Доступ к нему можно получить только в частной сети, но не в Интернете.

## <a name="access-application-private-fqdn"></a>Доступ к частному полному доменному имени приложения

После назначения можно получить доступ к частному полному доменному имени приложения в частной сети. Например, можно создать компьютер Jumpbox в той же виртуальной сети или в одноранговой виртуальной сети, а также на этом компьютере, на котором Jumpbox доступ к частному полному доменному имени.

![Доступ к частной конечной точке в виртуальной сети](media/spring-cloud-access-app-vnet/access-private-endpoint.png)

## <a name="next-steps"></a>Следующие шаги

- [Предоставление приложениям доступа к Интернету с помощью шлюза приложений и брандмауэра Azure](spring-cloud-expose-apps-gateway-azure-firewall.md)

## <a name="see-also"></a>См. также раздел

- [Устранение неполадок Azure Spring Cloud в виртуальной сети](spring-cloud-troubleshooting-vnet.md)
- [Обязательства клиентов в отношении запуска Azure Spring Cloud в виртуальной сети](spring-cloud-vnet-customer-responsibilities.md)