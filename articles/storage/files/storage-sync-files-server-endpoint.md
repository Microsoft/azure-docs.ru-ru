---
title: Добавление и удаление конечных точек сервера службы "Синхронизация файлов Azure" | Документация Майкрософт
description: Узнайте, как добавить или удалить конечную точку сервера с Синхронизация файлов Azure. Конечная точка сервера — это определенное расположение на зарегистрированном сервере, например папка на томе сервера.
author: roygara
ms.service: storage
ms.topic: how-to
ms.date: 07/19/2018
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: f75f0d1ae12db11590f8ce62f3c7b4c0f3e12817
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96013944"
---
# <a name="addremove-an-azure-file-sync-server-endpoint"></a>Добавление и удаление конечных точек сервера службы "Синхронизация файлов Azure"
Служба "Синхронизация файлов Azure" позволяет централизованно хранить файловые ресурсы организации в службе файлов Azure, обеспечивая гибкость, производительность и совместимость локального файлового сервера. Это достигается путем преобразования серверов Windows Server в быстрый кэш общей папки Azure. Для локального доступа к данным вы можете использовать любой протокол (в том числе SMB, NFS и FTPS), доступный в Windows Server. Кроме того, вы можете создать любое число кэшей в любом регионе.

*Конечная точка сервера* представляет конкретное расположение на *зарегистрированном сервере*, например папку на томе сервера или в корне тома. В том же томе могут находиться несколько конечных точек сервера, если их пространства имен не перекрываются (например, F:\sync1 и F:\sync2), и каждая конечная точка синхронизируется с уникальной группой синхронизации. Политики распределения по уровням облака можно настроить отдельно для каждой конечной точки сервера. При добавлении расположения сервера с имеющимся набором файлов в качестве конечной точки сервера в группу синхронизации эти файлы будут объединены с любыми другими файлами, которые уже находятся в других конечных точках в группе синхронизации.

Сведения о комплексном процессе развертывания службы "Синхронизация файлов Azure" см. в [этой статье](storage-sync-files-deployment-guide.md).

## <a name="prerequisites"></a>Предварительные условия
Чтобы создать конечную точку сервера, сначала убедитесь, что соблюдены следующие условия: 
- На сервере установлен и зарегистрирован агент службы синхронизации файлов Azure. Инструкции по установке агента службы "Синхронизация файлов Azure" см. в статье [Управление зарегистрированными серверами в службе "Синхронизация файлов Azure" (предварительная версия)](storage-sync-files-server-registration.md). 
- Убедитесь, что служба синхронизации хранилища развернута. Сведения о развертывании службы синхронизации хранилища см. в статье [Развертывание службы синхронизации файлов Azure (предварительная версия)](storage-sync-files-deployment-guide.md). 
- Убедитесь, что группа синхронизации развернута. Узнайте, как [создать группу синхронизации](storage-sync-files-deployment-guide.md#create-a sync-group-and-a-cloud-endpoint).
- Убедитесь, что сервер подключен к Интернету и вы имеете доступ к Azure. Для всех подключений между сервером и нашей службой мы используем порт 443.

## <a name="add-a-server-endpoint"></a>Добавление конечной точки сервера
Чтобы добавить конечную точку сервера, перейдите к нужной группе синхронизации и выберите "Добавление конечной точки сервера".

![Добавление новой конечной точки сервера в области группы синхронизации](media/storage-sync-files-server-endpoint/add-server-endpoint-1.png)

В разделе **Add server endpoint** (Добавить конечную точку сервера) необходимо указать следующую информацию:

- **Зарегистрированный сервер.** Имя сервера или кластера для создания конечной точки сервера.
- **Путь.** Путь на Windows Server, синхронизируемый в рамках группы синхронизации.
- **Уровни в облаке.** Параметр, позволяющий включать и отключать распределение по уровням облака. Если включено распределение по уровням облака, файлы будут *распределяться* по общим папкам Azure. При этом локальные общие папки преобразуются в кэш, а не полную копию набора данных. Это упрощает управление эффективностью пространства на сервере.
- **Свободное место на томе.** Объем свободного места, резервируемого на томе, где находится конечная точка сервера. Например, если объем свободного места тома с единственной конечной точкой сервера равен 50 %, примерно половина объема данных будет распределяться по уровням компонента "Файлы Azure". Независимо от того, включено ли распределение по уровням в облаке, общий файловый ресурс Azure всегда содержит полную копию данных в группе синхронизации.

Выберите **Создать**, чтобы добавить конечную точку сервера. Файлы в пространстве имен группы синхронизации теперь будут синхронизироваться. 

## <a name="remove-a-server-endpoint"></a>Удаление конечной точки сервера
Если вы хотите прекратить использование службы синхронизации файлов Azure c данной конечной точкой сервера, вы можете удалить эту конечную точку. 

> [!Warning]  
> Не пытайтесь устранять проблемы с синхронизацией, распределением по уровням облака или любым другим аспектом службы синхронизации файлов Azure путем удаления и повторного создания конечной точки сервера, если таких инструкций не предоставил инженер корпорации Майкрософт. Удаление конечной точки сервера является необратимой операцией, и многоуровневые файлы в конечной точке сервера не будут повторно подключены к их расположениям в общей папке Azure после восстановления конечной точки сервера, что приведет к ошибкам синхронизации. Также обратите внимание, что многоуровневые файлы, которые существуют вне пространства имен конечных точек сервера, могут быть потеряны. Многоуровневые файлы могут существовать в конечной точке сервера, даже если распределение по уровням облака не было включено.

Все многоуровневые файлы необходимо отозвать перед удалением конечной точки сервера. Для этого отключите распределение по уровням облака в конечной точке сервера, а затем выполните следующий командлет PowerShell, чтобы отозвать все многоуровневые файлы в пространстве имен конечной точки сервера.

```PowerShell
Import-Module "C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll"
Invoke-StorageSyncFileRecall -Path <path-to-to-your-server-endpoint> -Order CloudTieringPolicy
```
При указании параметра `-Order CloudTieringPolicy` будут отозваны последние измененные файлы.
Другие необязательные, но полезные параметры:
* `-ThreadCount` Определяет, сколько файлов можно вызвать параллельно.
* `-PerFileRetryCount`Определяет, как часто будет пытаться отозвать заблокированный файл.
* `-PerFileRetryDelaySeconds`Определяет время в секундах между повторными попытками вызова и всегда используется в сочетании с предыдущим параметром.

> [!Note]  
> Если на локальном томе, на котором размещен сервер, недостаточно свободного места для отзыва всех многоуровневых данных, командлет `Invoke-StorageSyncFileRecall` завершится сбоем.  

Чтобы удалить конечную точку сервера, сделайте следующее:

1. Перейдите к службе синхронизации хранилища, в которой зарегистрирован сервер.
2. Перейдите к необходимой группе синхронизации.
3. Удалите необходимую конечную точку сервера в группе синхронизации службы синхронизации хранилища. Для этого щелкните правой кнопкой мыши соответствующую конечную точку на панели группы синхронизации.

    ![Удаление конечной точки сервера из группы синхронизации](media/storage-sync-files-server-endpoint/remove-server-endpoint-1.png)

## <a name="next-steps"></a>Дальнейшие действия
- [Управление зарегистрированными серверами в службе "Синхронизация файлов Azure" (предварительная версия)](storage-sync-files-server-registration.md)
- [Планирование развертывания службы синхронизации файлов Azure (предварительная версия)](storage-sync-files-planning.md)
- [Мониторинг Синхронизации файлов Azure](storage-sync-files-monitoring.md)
