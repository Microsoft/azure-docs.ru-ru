---
title: Создание и использование общей папки службы "Файлы Azure" на виртуальных машинах Windows
description: Создание и использование общей папки Файлов Azure на портале Azure. Подключитесь к виртуальной машине Windows, подключитесь к общей папке Файлов и отправьте в нее файл.
author: roygara
ms.service: storage
ms.topic: quickstart
ms.date: 02/01/2019
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: 4c5629f80c37c9f79dc9a39c4d8304acbee9679d
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92489580"
---
# <a name="quickstart-create-and-manage-azure-files-share-with-windows-virtual-machines"></a>Краткое руководство. Создание общей папки службы "Файлы Azure" и управление ею с помощью виртуальных машин Windows

В статье описано, как создать и использовать общую папку службы "Файлы Azure". В этом кратком руководстве описано, как быстро настроить общую папку службы "Файлы Azure", чтобы вы получили общее представление о работе этой службы. Если вам нужны более подробные инструкции по созданию и использованию общих папок Azure в локальной среде, см. статью [Использование общей папки Azure в Windows](storage-how-to-use-files-windows.md).

Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на [портал Azure](https://portal.azure.com).

## <a name="prepare-your-environment"></a>Подготовка среды

В этом кратком руководстве вы настроите следующие элементы:

- учетную запись хранения Azure и общую папку Azure;
- виртуальную машину под управлением Windows Server 2016 Datacenter.

### <a name="create-a-storage-account"></a>Создание учетной записи хранения

Прежде чем приступить к работе с общей папкой Azure, необходимо создать учетную запись хранения Azure. Учетная запись хранения общего назначения версии 2 предоставляет доступ ко всем службам хранилища Azure (большим двоичным объектам, файлам, очередям и таблицам). Это краткое руководство создает учетную запись хранения общего назначения версии 2, но создание любого типа учетной записи хранения происходит таким же образом. Учетная запись хранения может содержать неограниченное число файловых ресурсов. В общем ресурсе может храниться любое число файлов, насколько это позволяет емкость учетной записи хранения.

[!INCLUDE [storage-create-account-portal-include](../../../includes/storage-create-account-portal-include.md)]

### <a name="create-an-azure-file-share"></a>создать файловый ресурс Azure;

Затем вы создадите общий файловый ресурс.

1. После развертывания учетной записи хранения Azure выберите **Перейти к ресурсу**.
1. Выберите **Файлы** из области учетной записи хранения.

    ![Выбор плитки "Файлы"](./media/storage-files-quick-create-use-windows/click-files.png)

1. Выберите **Общая папка**.

    ![Нажмите кнопку добавления общей папки](./media/storage-files-quick-create-use-windows/create-file-share.png)

1. Задайте новой папке имя *qsfileshare*, укажите значение 1 в меню **Квота** и выберите **Создать**. Размер квоты не может превышать 5 ТиБ, а для этого руководства будет достаточно 1 ГиБ.
1. Создайте новый файл TXT с именем *qsTestFile* на локальном компьютере.
1. Выберите новую общую папку и в расположении общей папки выберите **Отправить**.

    ![Отправка файла](./media/storage-files-quick-create-use-windows/create-file-share-portal5.png)

1. Перейдите в расположение созданного файла TXT, выберите *qsTestFile.txt*, а затем — **Отправить**.

Итак, вы создали учетную запись хранения Azure и общую папку Azure с одним файлом внутри. Теперь вы создадите виртуальную машину Azure с Windows Server 2016 Datacenter, выполняющую роль локального сервера в этом кратком руководстве.

### <a name="deploy-a-vm"></a>Развертывание виртуальной машины

1. Затем разверните меню в левой части портала и выберите **Создать ресурс** в верхнем левом углу портала Azure.
1. В поле поиска над списком ресурсов **Azure Marketplace** найдите и выберите **Windows Server 2016 Datacenter**, затем выберите **Создать**.
1. На вкладке **Основные сведения** в разделе **Сведения о проекте** выберите группу ресурсов, созданную для этого краткого руководства.

   ![Ввод основных сведений о виртуальной машине в колонке портала](./media/storage-files-quick-create-use-windows/vm-resource-group-and-subscription.png)

1. В разделе **Сведения об экземпляре** задайте виртуальной машине имя *qsVM*.
1. Оставьте значения по умолчанию для **региона**, **параметров доступности**, **образа** и **размера**.
1. В разделе **Учетная запись администратора** укажите *VMadmin* в поле **Имя пользователя** и в поле **Пароль** установите пароль для виртуальной машины.
1. В разделе **Правила входящего порта**, щелкните **Разрешить выбранные порты**, а затем выберите **RDP (3389)** и **HTTP** из раскрывающегося списка.
1. Выберите **Проверить и создать**.
1. Нажмите кнопку **создания**. Создание виртуальной машины займет несколько минут.

1. После развертывания виртуальной машины выберите **Перейти к ресурсу**.

На этом этапе вы создали виртуальную машину и подключили диск данных. Теперь необходимо подключиться к виртуальной машине.

### <a name="connect-to-your-vm"></a>Подключение к виртуальной машине

1. На странице свойств виртуальной машины выберите **Подключиться**.

   ![Подключение к виртуальной машине Azure с портала](./media/storage-files-quick-create-use-windows/connect-vm.png)

1. На странице **Подключение к виртуальной машине** сохраните значения по умолчанию, чтобы использовать подключение по **IP-адресу** через **порт номер** *3389*, и выберите **Скачать RDP-файл**.
1. Откройте скачанный RDP-файл и при появлении запроса щелкните **Подключиться**.
1. В окне **Безопасность Windows** выберите **Варианты выбора** и нажмите **Использовать другую учетную запись**. Введите имя пользователя в формате *localhost\имя_пользователя*, где &lt;имя_пользователя&gt; — это имя администратора виртуальной машины. Введите пароль, заданный для виртуальной машины, и нажмите кнопку **ОК**.

   ![Дополнительные варианты](./media/storage-files-quick-create-use-windows/local-host2.png)

1. При входе в систему может появиться предупреждение о сертификате. Выберите **Да** или **Продолжить**, чтобы создать подключение.

## <a name="map-the-azure-file-share-to-a-windows-drive"></a>Сопоставление общей папки Azure с диском Windows

1. На портале Azure перейдите к общей папке *qsfileshare* и выберите **Подключиться**.
1. Скопируйте содержимое второго поля и вставьте его в **Блокнот**.

   ![Снимок экрана: показано содержимое второго поля, которое необходимо скопировать и вставить в Блокнот.](./media/storage-files-quick-create-use-windows/portal_netuse_connect2.png)

1. На виртуальной машине откройте **проводник** и в окне выберите **Этот ПК**. В результате изменятся меню, доступные на ленте. В меню **Компьютер** выберите **Подключить сетевой диск**.
1. Выберите букву диска и введите UNC-путь. Если вы следовали рекомендациям по именованию из этого краткого руководства, скопируйте *\\qsstorageacct.file.core.windows.net\qsfileshare* из **Блокнота**.

   Убедитесь, что установлены оба флажка.

   ![Снимок экрана диалогового окна "Подключение сетевого диска"](./media/storage-files-quick-create-use-windows/mountonwindows10.png)

1. Нажмите кнопку **Готово**.
1. В диалоговом окне **Безопасность Windows** выполните следующее:

   - Скопируйте из Блокнота имя учетной записи хранения, начинающееся с AZURE\, и вставьте его в диалоговом окне **Безопасность Windows** в качестве имени пользователя. Если вы следовали рекомендациям по именованию из этого краткого руководства, скопируйте *AZURE\qsstorageacct*.
   - Скопируйте из Блокнота ключ учетной записи хранения и вставьте его в диалоговом окне **Безопасность Windows** в качестве пароля.

      ![UNC-путь из области подключения службы файлов Azure](./media/storage-files-quick-create-use-windows/portal_netuse_connect3.png)

## <a name="create-a-share-snapshot"></a>Создание моментального снимка общего ресурса

Теперь, после сопоставления диска, можно создать моментальный снимок.

1. На портале перейдите к общей папке и выберите **Создать моментальный снимок**.

   ![Создание моментального снимка](./media/storage-files-quick-create-use-windows/create-snapshot.png)

1. На виртуальной машине откройте файл *qstestfile.txt*, введите текст "этот файл изменен", сохраните изменения и закройте файл.
1. Создайте еще один моментальный снимок.

## <a name="browse-a-share-snapshot"></a>Просмотр моментальных снимков общей папки

1. В общей папке выберите **Просмотреть моментальные снимки**.
1. В области **Моментальные снимки файловых ресурсов** выберите первый моментальный снимок в списке.

   ![Выбранный моментальный снимок в списке меток времени](./media/storage-files-quick-create-use-windows/snapshot-list.png)

1. В области этого моментального снимка выберите файл *qsTestFile.txt*.

## <a name="restore-from-a-snapshot"></a>Восстановление с использованием моментального снимка

1. В колонке моментального снимка общей папки щелкните файл *qsTestFile* правой кнопкой мыши и нажмите кнопку **Восстановить**.
1. Выберите **Перезаписать исходный файл**.

   ![Кнопки "Скачать" и "Восстановить"](./media/storage-files-quick-create-use-windows/snapshot-download-restore-portal.png)

1. Откройте файл на виртуальной машине. Файл был восстановлен в первоначальной редакции.

## <a name="delete-a-share-snapshot"></a>Удаление моментального снимка общего ресурса

1. В общей папке выберите **Просмотреть моментальные снимки**.
1. В области **Моментальные снимки файловых ресурсов** выберите последний моментальный снимок в списке и щелкните **Удалить**.

   ![Кнопка "Удалить"](./media/storage-files-quick-create-use-windows/portal-snapshots-delete.png)

## <a name="use-a-share-snapshot-in-windows"></a>Использование в Windows моментальных снимков общей папки

Как и локальные моментальные снимки VSS, моментальные снимки подключенной общей папки Azure можно просматривать на вкладке "Предыдущие версии".

1. В проводнике перейдите в подключенную общую папку.

   ![Подключенный общий ресурс в проводнике](./media/storage-files-quick-create-use-windows/snapshot-windows-mount.png)

1. Выберите файл *qsTestFile.txt*, щелкните правой кнопкой мыши и в меню выберите **Свойства**.

   ![Контекстное меню для выбранного каталога](./media/storage-files-quick-create-use-windows/snapshot-windows-previous-versions.png)

1. Выберите пункт **Предыдущие версии**, чтобы просмотреть список моментальных снимков общих ресурсов для этого каталога.

1. Чтобы открыть моментальный снимок, выберите **Открыть**.

   ![Вкладка "Предыдущие версии"](./media/storage-files-quick-create-use-windows/snapshot-windows-list.png)

## <a name="restore-from-a-previous-version"></a>Восстановление из предыдущей версии

1. Выберите **Восстановить**. Это действие рекурсивно копирует содержимое всего каталога в исходное расположение на момент создания моментального снимка.

   ![Кнопка "Восстановить" в сообщении с предупреждением](./media/storage-files-quick-create-use-windows/snapshot-windows-restore.png) Примечание. Если файл не был изменен, предыдущая версия для этого файла не будет отображаться, так как этот файл совпадает с версией в моментальном снимке. Это схоже с принципом работы на файловом сервере Windows.

## <a name="clean-up-resources"></a>Очистка ресурсов

[!INCLUDE [storage-files-clean-up-portal](../../../includes/storage-files-clean-up-portal.md)]

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Использование файлового ресурса Azure в Windows](storage-how-to-use-files-windows.md)
