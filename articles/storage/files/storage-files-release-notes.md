---
title: Заметки о выпуске агента службы "Синхронизация файлов Azure" | Документация Майкрософт
description: Ознакомьтесь с заметками о выпуске агента Синхронизация файлов Azure, который позволяет централизовать общие файловые ресурсы Организации в службе файлов Azure.
services: storage
author: wmgries
ms.service: storage
ms.topic: conceptual
ms.date: 12/17/2020
ms.author: wgries
ms.subservice: files
ms.openlocfilehash: 4f2bdf3d5c34ffb4f3ec95c27bbdaf312adb4204
ms.sourcegitcommit: ea822acf5b7141d26a3776d7ed59630bf7ac9532
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/03/2021
ms.locfileid: "99526404"
---
# <a name="release-notes-for-the-azure-file-sync-agent"></a>Заметки о выпуске агента службы "Синхронизация файлов Azure"
Служба "Синхронизация файлов Azure" позволяет централизованно хранить файловые ресурсы организации в службе файлов Azure, обеспечивая гибкость, производительность и совместимость локального файлового сервера. Установки серверов Windows Server преобразовываются в быстрый кэш общего файлового ресурса Azure. Для локального доступа к данным вы можете использовать любой протокол, доступный в Windows Server (в том числе SMB, NFS и FTPS). Кроме того, вы можете создать любое количество кэшей.

В этой статье рассматриваются заметки о выпуске для поддерживаемых версий агента службы "Синхронизация файлов Azure".

## <a name="supported-versions"></a>Поддерживаемые версии
Поддерживаются следующие версии агента Синхронизация файлов Azure:

| Веха | Номер версии агента | Дата выпуска | Состояние |
|----|----------------------|--------------|------------------|
| V 11.2 Release — [KB4539952](https://support.microsoft.com/topic/azure-file-sync-agent-v11-2-release-february-2021-c956eaf0-cd8e-4511-98c0-e5a1f2c84048)| 11.2.0.0 | 2 февраля 2021 г. | Поддерживается — перелет |
| Версия 11.1, выпуск — [KB4539951](https://support.microsoft.com/en-us/help/4539951)| 11.1.0.0 | 4 ноября 2020 г. | Поддерживается |
| Версия 10.1 — [KB4522411](https://support.microsoft.com/en-us/help/4522411)| 10.1.0.0 | 5 июня 2020 г. | Поддерживается |
| Накопительный пакет обновлений за май 2020 г. — [KB4522412](https://support.microsoft.com/help/4522412)| 10.0.2.0 | 19 мая 2020 г. | Поддерживается |
| Выпуск версии 10 — [KB4522409](https://support.microsoft.com/en-us/help/4522409)| 10.0.0.0 | 9 апреля 2020 г. | Поддерживается |
| Накопительный пакет обновлений за декабрь 2019 г. — [KB4522360](https://support.microsoft.com/help/4522360)| 9.1.0.0 | 12 декабря 2019 г. | Поддерживается — срок действия версии агента истечет 16 февраля 2021 г. |
| Выпуск версии 9 — [KB4522359](https://support.microsoft.com/help/4522359)| 9.0.0.0 | 2 декабря 2019 г. | Поддерживается — срок действия версии агента истечет 16 февраля 2021 г. |
| Выпуск версии 8 — [KB4511224](https://support.microsoft.com/help/4511224)| 8.0.0.0 | 8 октября 2019 г. | Поддерживается — срок действия версии агента истечет 12 января 2021 г. |

## <a name="unsupported-versions"></a>Неподдерживаемые версии
Срок действия следующих версий агента Синхронизация файлов Azure истек, и они больше не поддерживаются:

| Веха | Номер версии агента | Дата выпуска | Состояние |
|----|----------------------|--------------|------------------|
| Выпуск версии 7 | 7.0.0.0 — 7.2.0.0 | Недоступно | Не поддерживается. срок действия версий агента истек 1 сентября 2020 г. |
| Выпуск версии 6 | 6.0.0.0–6.3.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 21 апреля 2020 г. |
| Выпуск версии 5 | 5.0.2.0–5.2.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 18 марта 2020 г. |
| Выпуск версии 4 | 4.0.1.0–4.3.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 6 ноября 2019 г. |
| Выпуск версии 3 | 3.1.0.0–3.4.0.0 | Недоступно | Не поддерживается. Срок действия версий агента истек 19 августа 2019 г. |
| Агенты общедоступной предварительной версии | 1.1.0.0 — 3.0.13.0 | Недоступно | Не поддерживается. Версии агента истекли 1 октября 2018 г. |

### <a name="azure-file-sync-agent-update-policy"></a>Политика обновления агента службы синхронизации файлов Azure
[!INCLUDE [storage-sync-files-agent-update-policy](../../../includes/storage-sync-files-agent-update-policy.md)]

## <a name="agent-version-11200"></a>Версия агента 11.2.0.0
Следующие заметки о выпуске предназначены для версии 11.2.0.0 агента Синхронизация файлов Azure, выпущенного 2 февраля 2021 г. Эти заметки являются дополнением к заметкам о выпуске, указанным для версии 11.1.0.0.

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы 
- Если сеанс синхронизации был отменен из-за большого количества ошибок для каждого элемента, синхронизация может пройти через выверку при запуске нового сеанса, если служба Синхронизация файлов Azure определит пользовательский сеанс синхронизации для исправления ошибок, связанных с каждым элементом.
- Регистрация сервера с помощью командлета Register-AzStorageSyncServer может завершиться ошибкой с ошибкой "необработанное исключение".
- Новый командлет PowerShell (Add-Сторажесинкалловедсерверендпоинтпас) для настройки допустимых путей к конечным точкам сервера на сервере. Этот командлет полезен для сценариев, в которых развертывание Синхронизация файлов Azure управляется поставщиком облачных решений (CSP) или поставщиком услуг, и клиент хочет настроить разрешенные пути к конечным точкам сервера на сервере. При создании конечной точки сервера, если указанный путь отсутствует в списке разрешений, то создание конечной точки сервера завершится ошибкой. Обратите внимание, что это необязательная функция, и все поддерживаемые пути разрешены по умолчанию при создании конечной точки сервера.  

    
    - Чтобы добавить разрешенный путь к конечной точке сервера, выполните следующие команды PowerShell на сервере:

    ```powershell
    Import-Module 'C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll' -verbose
    Add-StorageSyncAllowedServerEndpointPath -Path <path>
    ```  

    - Чтобы получить список поддерживаемых путей, выполните следующую команду PowerShell:
    
    ```powershell
    Get-StorageSyncAllowedServerEndpointPath
    ```     
    - Чтобы удалить путь, выполните следующую команду PowerShell:
    
    ```powershell
    Remove-StorageSyncAllowedServerEndpointPath -Path <path>
    ```  
## <a name="agent-version-11100"></a>Версия агента 11.1.0.0
Следующие заметки о выпуске предназначены для версии 11.1.0.0 агента Синхронизация файлов Azure (выпущен 4 ноября 2020).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы
- Новые режимы распределения по уровням облака для управления первоначальным скачиванием и упреждающим отзывом
    - Начальный режим загрузки. Теперь можно выбрать способ первоначальной загрузки файлов на новую конечную точку сервера. Хотите, чтобы все файлы были многоуровневые или все файлы были скачаны на сервер с помощью времени последнего изменения? Это можно сделать! Не удается использовать распределение по уровням облака? Теперь вы можете не использовать многоуровневые файлы в системе. Дополнительные сведения см. в разделе [Создание конечной точки сервера](./storage-sync-files-deployment-guide.md?tabs=azure-portal%252cproactive-portal#create-a-server-endpoint) в документации по развертыванию синхронизация файлов Azure.
    - Режим упреждающего отзыва. при каждом создании или изменении файла можно заранее отозвать его на серверы, указанные в той же группе синхронизации. Это делает файл доступным для использования на каждом указанном сервере. Работают ли команды по всему миру над теми же данными? Включите упреждающий отзыв, чтобы при поступлении команды на следующее утро все файлы, обновленные командой в другом часовом поясе, были скачаны и готовы к работе. Дополнительные сведения см. в разделе [упреждающий отзыв новых и измененных файлов из общего файлового ресурса Azure](./storage-sync-files-deployment-guide.md?tabs=azure-portal%252cproactive-portal#proactively-recall-new-and-changed-files-from-an-azure-file-share) в документации по развертыванию синхронизация файлов Azure.

- Исключение приложений из отслеживания времени последнего доступа на уровне облака. Теперь вы можете исключить приложения из отслеживания времени последнего доступа. Когда приложение обращается к файлу, время последнего доступа к файлу обновляется в базе данных уровня облака. Приложения, которые проверяют файловую систему, например антивирусную программу, приводят к тому, что все файлы имеют одинаковое время последнего доступа, что влияет на распределение файлов по уровням.

    Чтобы исключить приложения из отслеживания времени последнего доступа, добавьте имя процесса в параметр реестра Хеаттраккингпроцесснамиксклусионлист, который находится в разделе HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Azure\StorageSync.

    Пример: reg ADD "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Azure\StorageSync"/v Хеаттраккингпроцесснамиксклусионлист/t REG_MULTI_SZ/d "SampleApp.exe\0AnotherApp.exe"/f

    > [!Note]  
    > Процессы дедупликации данных и файлового сервера диспетчер ресурсов (FSRM) исключаются по умолчанию (жестко закодированные), а список исключений процессов обновляется каждые 5 минут.

- Различные улучшения производительности и надежности
    - Улучшена производительность обнаружения изменений для обнаружения файлов, измененных в общей папке Azure.
    - Улучшенная производительность отправки синхронизации.
    - Начальная передача теперь выполняется из моментального снимка VSS, что сокращает количество ошибок, возникающих при каждом элементе, и сбои сеансов синхронизации.
    - Синхронизируйте улучшения надежности для определенных шаблонов ввода-вывода.
    - Исправлена ошибка, препятствующая восстановлению базы данных синхронизации на отказоустойчивых кластерах при отработке отказа.
    - Улучшена производительность отзыва при доступе к многоуровневый файлу.

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](./storage-sync-files-planning.md#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ. Дополнительные сведения см. в разделе [Рекомендуемые системные ресурсы](./storage-sync-files-planning.md#recommended-system-resources).
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и (или) учетную запись хранения можно переместить в другую группу ресурсов, подписку или клиент Azure AD. После перемещения службы синхронизации хранилища или учетной записи хранения необходимо предоставить приложению Microsoft. StorageSync доступ к учетной записи хранения (см. раздел [обеспечение доступа к учетной записи хранения у синхронизация файлов Azure](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)).

    > [!Note]  
    > При создании облачной конечной точки служба синхронизации хранилища и учетная запись хранения должны находиться в одном клиенте Azure AD. После создания облачной конечной точки службу синхронизации хранилища и учетную запись хранения можно переместить в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-10100"></a>Версия агента 10.1.0.0
Следующие заметки о выпуске предназначены для версии 10.1.0.0 агента Синхронизация файлов Azure, выпущенного 5 июня 2020 г. Эти примечания являются дополнением к заметкам о выпуске, указанным для версии 10.0.0.0 и 10.0.2.0.

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка частных конечных точек Azure
    - Трафик синхронизации в службу синхронизации хранилища теперь можно отправить в закрытую конечную точку. Это обеспечивает туннелирование через подключение ExpressRoute или VPN. Дополнительные сведения см. в разделе [Настройка сетевых конечных точек синхронизация файлов Azure](./storage-sync-files-networking-endpoints.md).
- Синхронизированная метрика файлов теперь будет отображать ход выполнения при выполнении большой синхронизации, а не в конце.
- Различные улучшения надежности установки агентов, распределения по уровням облака, синхронизации и телеметрии

## <a name="agent-version-10020"></a>Версия агента 10.0.2.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 10.0.2.0 (выпущено 19 мая 2020 г.). Они являются дополнением к заметкам о выпуске для версии 10.0.0.0.

Исправление в этом выпуске:  
- Агент синхронизации хранилища (FileSyncSvc) часто аварийно завершает работу после установки агента службы "Синхронизация файлов Azure" версии 10.

> [!Note]  
>Этот выпуск не был отправлен на серверы, которые настроены на автоматическое обновление при появлении новой версии. Чтобы установить это обновление, воспользуйтесь Центром обновления Майкрософт или каталогом Центра обновления Майкрософт (инструкции по установке см. на [этой странице](https://support.microsoft.com/help/4522412)).

## <a name="agent-version-10000"></a>Версия агента 10.0.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 10.0.0.0 (выпущено 9 апреля 2020 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Улучшен ход выполнения синхронизации на портале
    - С выпуском агента версии 10 на портале Azure в скором времени начнет отображаться тип выполняемого сеанса синхронизации. Пример: первоначальное скачивание, регулярное скачивание, фоновый отзыв (случаи быстрого аварийного восстановления) и т. д. 

- Улучшен интерфейс портала с распределением по уровням в облаке
    - Если у вас есть файлы, которые не удается распределить по уровням или отозвать, можно просмотреть ошибки распределения по уровням в свойствах конечной точки сервера.
    - Дополнительные сведения о распределении по уровням в облаке доступны для конечной точки сервера:
        - размер локального кэша;
        - эффективность использования кэша;
        - сведения о политике распределения по уровням в облаке: размер тома, текущее свободное пространство или время последнего обращения к самому старому файлу в локальном кэше.
    - Эти изменения будут отправлены на портал Azure вскоре после начального выпуска агента версии 10.

- Поддержка перемещения службы синхронизации хранилища и (или) учетной записи хранения в другой клиент Azure Active Directory
    - Синхронизация файлов Azure теперь поддерживает перемещение службы синхронизации хранилища и (или) учетной записи хранения в другую группу ресурсов или подписку, а также в другой клиент Azure AD.
    
- Различные улучшения производительности и надежности
    - Обнаружение изменений в общей папке Azure может завершиться ошибкой, если правила виртуальной сети (VNET) и брандмауэра настроены для учетной записи хранения.
    - Уменьшено потребление памяти, связанное с отзывом. 
    - Повышена производительность при использовании командлета [Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection).
    - Прочие улучшения надежности. 
    
### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](./storage-sync-files-planning.md#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и (или) учетную запись хранения можно переместить в другую группу ресурсов, подписку или клиент Azure AD. После перемещения службы синхронизации хранилища или учетной записи хранения необходимо предоставить приложению Microsoft. StorageSync доступ к учетной записи хранения (см. раздел [обеспечение доступа к учетной записи хранения у синхронизация файлов Azure](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)).

    > [!Note]  
    > При создании облачной конечной точки служба синхронизации хранилища и учетная запись хранения должны находиться в одном клиенте Azure AD. После создания облачной конечной точки службу синхронизации хранилища и учетную запись хранения можно переместить в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.

## <a name="agent-version-9100"></a>Версия агента 9.1.0.0
Приведенные ниже заметки о выпуске относятся к агенту службы "Синхронизация файлов Azure" версии 9.1.0.0 (выпущено 12 декабря 2019 г.). Они являются дополнением к заметкам о выпуске для версии 9.0.0.0.

Исправление в этом выпуске:  
- Сбой синхронизации с одной из следующих ошибок после обновления агента службы "Синхронизация файлов Azure" до версии 9.0:
    - 0x8e5e044e (JET_errWriteConflict)
    - 0x8e5e0450 (JET_errInvalidSesid)
    - 0x8e5e0442 (JET_errInstanceUnavailable)

## <a name="agent-version-9000"></a>Версия агента 9.0.0.0
Приведенные ниже заметки о выпуске относятся к агенту службы "Синхронизация файлов Azure" версии 9.0.0.0 (выпущено 2 декабря 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Поддержка автоматического резервного копирования и самостоятельного восстановления
    - Теперь пользователи могут также восстанавливать многоуровневые файлы (наряду с файлами на диске) с помощью функции «Предыдущая версия» из моментальных снимков VSS, созданных после включения функции самостоятельного восстановления на томе. До выпуска V9 функция предыдущей версии не поддерживалась для многоуровневых файлов. Эта функция должна быть включена отдельно для каждого тома, на котором имеется конечная точка с включенным распределением по уровням в облаке. Дополнительные сведения см. на следующих ресурсах:  
[Автоматическое резервное копирование и самостоятельное восстановление с помощью предыдущих версий и VSS (служба теневого копирования томов)](./storage-sync-files-deployment-guide.md#self-service-restore-through-previous-versions-and-vss-volume-shadow-copy-service). 
 
- Поддержка больших размеров общей папки 
    - Синхронизация файлов Azure теперь поддерживает до 64 ТиБ и 100 млн файлов в одном синхронизированном пространстве имен.  
 
- Поддержка дедупликации данных для Server 2019 
    - Дедупликация данных теперь поддерживается (независимо от того, включено ли распределение по уровням облака на одной или нескольких конечных точках сервера в томе) в Windows Server 2016 и Windows Server 2019. Для поддержки дедупликации данных на томах с распределением по уровням облака на сервере 2019 необходимо установить Windows Update [KB4520062](https://support.microsoft.com/help/4520062) . 
 
- Оптимизирован минимальный размер для распределения файла по уровню 
    - Минимальный размер файла для распределения файла по уровню теперь зависит от размера кластера файловой системы и составляет два кластера файловой системы. Например, размер кластера файловой системы NTFS по умолчанию равен 4 КБ, а результирующий минимальный размер файла для распределения по уровням равен 8 КБ. 
 
- Командлет проверки возможности подключения к сети 
    - В рамках конфигурации Синхронизации файлов Azure необходимо связаться с несколькими конечными точками службы. У каждой из них есть собственное DNS-имя, которое должно быть доступно серверу. Эти URL-адреса также относятся к региону, в котором зарегистрирован сервер. После регистрации сервера можно использовать командлет проверки подключения (PowerShell и служебная программа регистрации сервера) для тестирования связи со всеми URL-адресами, которые относятся к этому серверу. Этот командлет может быть полезен при устранении неполадок, если незавершенная связь не позволяет серверу в полной мере использовать Синхронизацию файлов Azure. Кроме того, с помощью этого командлета можно настроить конфигурацию прокси-сервера и брандмауэра.  
 
        Чтобы запустить проверку возможности подключения к сети, выполните следующие команды PowerShell: 
 
        Import-Module "C:\Program Files\Azure\StorageSyncAgent\StorageSync.Management.ServerCmdlets.dll"  
        Test-StorageSyncNetworkConnectivity
 
- Улучшение удаления конечной точки сервера при включенном распределении по уровням в облаке 
    - Как и раньше, удаление конечной точки сервера не приводит к удалению файлов в общей папке Azure. Однако поведение точек повторного анализа на локальном сервере изменилось. Точки повторного анализа (указатели на файлы, которые не являются локальными на сервере) теперь удаляются при удалении конечной точки сервера. Полностью кэшированные файлы остаются на сервере. Это улучшение было сделано для предотвращения появления [потерянных многоуровневых файлов](./storage-sync-files-troubleshoot.md?tabs=portal1%252cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint) при удалении конечной точки сервера. Если конечная точка сервера создана заново, точки повторного анализа для многоуровневых файлов будут вновь созданы на сервере.  
 
- Улучшения производительности и надежности. 
    - Сокращены сбои при отзыве. Размер отзыва теперь автоматически корректируется в зависимости от пропускной способности сети. 
    - Улучшена производительность скачивания при добавлении нового сервера в группу синхронизации. 
    - Уменьшено число несинхронизированных файлов из-за конфликтов ограничений. 
    - Файлы не удается распределить по уровням или они неожиданно отзываются в определенных сценариях, если путь к конечной точке сервера является точкой подключения тома.
    
### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](./storage-sync-files-planning.md#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования. Дополнительные сведения см. в разделе [Распределенные по уровням файлы недоступны на сервере после удаления конечной точки сервера](./storage-sync-files-troubleshoot.md?tabs=portal1%252cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint).
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
- Если файл pagefile.sys находится в томе с включенным распределением по уровням в облаке, возможно, файлы не удастся распределить по уровням. Файл pagefile.sys должен находиться в томе с отключенным распределением по уровням в облаке.

## <a name="agent-version-8000"></a>Версия агента 8.0.0.0
Приведенные ниже заметки о выпуске предназначены для агента службы "Синхронизация файлов Azure" версии 8.0.0.0 (выпущено 8 октября 2019 г.).

### <a name="improvements-and-issues-that-are-fixed"></a>Улучшения и решенные проблемы

- Улучшения производительности восстановления
    - Сокращено время восстановления при использовании Azure Backup. Восстановленные файлы будут синхронизироваться с серверами службы "Синхронизация файлов Azure" гораздо быстрее. 
- Улучшен интерфейс портала с распределением по уровням в облаке  
    - Если у вас есть распределенные по уровням файлы, которые не удается отозвать, можно просмотреть ошибки отзыва в свойствах конечной точки сервера. Кроме того, в сведениях о работоспособности конечной точки сервера теперь будут отображаться ошибки и действия по устранению рисков, если на сервере не загружен драйвер фильтра распределения по уровням в облаке.
- Упрощенная установка агента
    - Модуль Az \ AzureRM PowerShell больше не требуется для регистрации сервера, что ускоряет и упрощает установку.
- Различные улучшения производительности и надежности

### <a name="evaluation-tool"></a>Средство оценки
Прежде чем развертывать службу "Синхронизация файлов Azure", следует оценить, совместима ли она с вашей системой, с помощью средства оценки этой службы. Это средство является командлетом Azure PowerShell, который проверяет наличие потенциальных проблем с файловой системой и набором данных, таких как неподдерживаемые символы или неподдерживаемая версия операционной системы. Инструкции по установке и использованию см. в разделе о [средстве оценки](./storage-sync-files-planning.md#evaluation-cmdlet) руководства по планированию. 

### <a name="agent-installation-and-server-configuration"></a>Установка агента и конфигурация сервера
Дополнительные сведения о том, как установить и настроить агент службы "Синхронизация файлов Azure" с помощью Windows Server, см. в статье о [планировании развертывания службы "Синхронизация файлов Azure"](storage-sync-files-planning.md) и [практическом руководстве по развертыванию службы "Синхронизация файлов Azure"](storage-sync-files-deployment-guide.md).

- Пакет установки агента нужно устанавливать с разрешениями более высокого уровня (администратора).
- Агент не поддерживается в развертывании Nano Server.
- Агент поддерживается только в Windows Server 2019 и Windows Server 2016 и Windows Server 2012 R2.
- Агент требует по крайней мере 2 ГиБ памяти. Если сервер выполняется на виртуальной машине с включенной динамической памятью, в виртуальной машине должна быть настроена память объемом не менее 2048 МиБ.
- Служба агента синхронизации хранилища (FileSyncSvc) не поддерживает конечные точки сервера, которые размещены в томе со сжатым каталогом данных о системном томе (SVI). Использование этой конфигурации может привести к непредвиденным результатам.

### <a name="interoperability"></a>Совместимость
- Антивирусные программы, приложения архивации, а также другие приложения, которые получают доступ к многоуровневым файлам, вызывают нежелательные отзывы, если они не учитывают автономный атрибут и пропускают чтение содержимого этих файлов. Дополнительные сведения см. в статье об [устранении неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md).
- Фильтры блокировки файлов FSRM могут стать причиной постоянных сбоев синхронизации.
- Выполнение средства sysprep на сервере, где установлен агент службы "Синхронизация файлов Azure", не поддерживается и может привести к непредвиденным результатам. Устанавливать агент Синхронизации файлов Azure нужно после развертывания образа сервера и завершения мини-установки sysprep.

### <a name="sync-limitations"></a>Ограничения синхронизации
Следующие элементы не синхронизируются, но остальная часть системы продолжает работать в обычном режиме:
- Файлы с неподдерживаемыми символами. Со списком неподдерживаемых символов можно ознакомиться в [руководстве по устранению неполадок](storage-sync-files-troubleshoot.md#handling-unsupported-characters).
- Файлы или каталоги, которые оканчиваются точкой.
- Пути длиной более 2048 символов.
- Часть списка управления доступом на уровне пользователей (DACL) в дескрипторе безопасности размером более 2 КБ. (Эта проблема возникает только при наличии более 40 записей контроля доступа (ACE) на одном элементе.)
- Часть системного списка управления доступом (SACL) в дескрипторе безопасности, который используется для аудита.
- Дополнительные атрибуты.
- Альтернативные потоки данных.
- Точки повторного анализа.
- Жесткие связи.
- Сжатие (для серверного файла) не сохраняется при синхронизации изменений в этом файле из других конечных точек.
- Файлы, зашифрованные с помощью файловой системы EFS (или другого пользовательского режима шифрования). Служба не может считывать такие данные.

    > [!Note]  
    > Служба "Синхронизация файлов Azure" всегда шифрует передаваемые данные. Неактивные данные можно зашифровать в Azure.
 
### <a name="server-endpoint"></a>Конечная точка сервера
- Конечную точку сервера можно создавать только на томе NTFS. Сейчас служба "Синхронизация файлов Azure" не поддерживает ReFS и FAT, FAT32 и другие файловые системы.
- Многоуровневые файлы станут недоступными для использования, если их не отозвать перед удалением конечной точки сервера. Чтобы восстановить доступ к файлам, повторно создайте конечную точку сервера. Если с момента удаления конечной точки сервера прошло 30 дней или если была удалена конечная точка облака, многоуровневые файлы, которые не были отозваны, станут непригодными для использования. Дополнительные сведения см. в разделе [Распределенные по уровням файлы недоступны на сервере после удаления конечной точки сервера](./storage-sync-files-troubleshoot.md?tabs=portal1%252cazure-portal#tiered-files-are-not-accessible-on-the-server-after-deleting-a-server-endpoint).
- Но для системного тома не поддерживается распределение по уровням облака. Чтобы создать конечную точку сервера на системном томе, отключите распределение по уровням облака при ее создании.
- Отказоустойчивую кластеризацию поддерживают только кластеризованные диски. Общие тома кластера (CSV) ее не поддерживают.
- Конечная точка сервера не может быть вложенной. Она может сосуществовать параллельно с другой конечной точкой на одном томе.
- Не храните файл ОС или файл подкачки приложения в расположении конечной точки сервера.
- В случае переименования сервера его имя на портале не обновляется.

### <a name="cloud-endpoint"></a>Облачная конечная точка
- Служба "Синхронизация файлов Azure" поддерживает внесение изменений непосредственно в файловый ресурс Azure. Однако внесенные изменения сначала должны быть обнаружены заданием обнаружения изменений этой службы. Задание обнаружения изменений инициируется для облачной конечной точки каждые 24 часа. Для немедленной синхронизации файлов, измененных в общей папке Azure, можно использовать командлет PowerShell [Invoke-AzStorageSyncChangeDetection](/powershell/module/az.storagesync/invoke-azstoragesyncchangedetection), вручную инициировав обнаружение изменений в общей папке Azure. Кроме того, изменения, внесенные в файловый ресурс Azure с помощью протокола REST, не приведут к обновлению времени последнего изменения SMB и не будут распознаны как изменение службой синхронизации.
- Службу синхронизации хранилища и/или учетную запись хранения можно переместить в другую группу ресурсов или подписку в рамках существующего клиента Azure AD. Если учетная запись хранения перемещена, необходимо предоставить службе Hybrid File Sync доступ к учетной записи хранилища (см. в разделе [Убедитесь, что служба "Синхронизация файлов Azure" имеет доступ к учетной записи хранения](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)).

    > [!Note]  
    > Служба "Синхронизация файлов Azure" не поддерживает перемещение подписки в другой клиент Azure AD.

### <a name="cloud-tiering"></a>Распределение по уровням облака
- Если многоуровневый файл копируется в другое расположение с помощью Robocopy, полученный файл не будет распределен по уровням. Вы можете задать автономный атрибут, так как Robocopy неправильно включает его в операциях копирования.
- При копировании файлов с помощью robocopy используйте параметр /MIR, чтобы сохранить метки времени файлов. Таким образом, старые файлы будут перемещены на другой уровень раньше, чем файлы, доступ к которым был получен недавно.
