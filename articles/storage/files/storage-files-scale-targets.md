---
title: Целевые показатели масштабируемости и производительности службы файлов Azure
description: 'Ознакомьтесь с такими целевыми показателями масштабируемости и производительности службы файлов Аzure: емкость, частота запросов и предельная входящая и исходящая пропускная способность.'
author: roygara
ms.service: storage
ms.topic: conceptual
ms.date: 02/12/2021
ms.author: rogarana
ms.subservice: files
ms.openlocfilehash: aa24989103cca5bb7031a21ca106b93ada0c3904
ms.sourcegitcommit: 6776f0a27e2000fb1acb34a8dddc67af01ac14ac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2021
ms.locfileid: "103149466"
---
# <a name="azure-files-scalability-and-performance-targets"></a>Целевые показатели масштабируемости и производительности службы файлов Azure
Служба [файлов Azure](storage-files-introduction.md) предлагает полностью управляемые общие файловые ресурсы в облаке, доступные через протоколы файловой системы SMB и NFS. В этой статье описываются целевые показатели масштабируемости и производительности службы файлов Azure и службы синхронизации файлов Azure.

Приведенные здесь целевые показатели масштабируемости и производительности предельно высоки, но на них могут оказывать негативное воздействие другие параметры вашего развертывания. Например, пропускная способность файла также может быть ограничена доступной пропускной способностью сети, а не только серверами, на которых размещены файловые ресурсы Azure. Мы настоятельно рекомендуем протестировать модель использования, чтобы определить, соответствуют ли показатели масштабируемости и производительности службы файлов Azure вашим требованиям. Мы также стремимся постепенно увеличивать предельные показатели. 

## <a name="azure-files-scale-targets"></a>Целевые показатели масштабируемости службы файлов Azure
Общие папки Azure развертываются в учетных записях хранения. Это объекты верхнего уровня, которые представляют общий пул хранилища. Этот пул хранилища можно использовать для развертывания нескольких файловых ресурсов. Поэтому необходимо учитывать три категории: учетные записи хранения, общие файловые ресурсы Azure и файлы.

### <a name="storage-account-scale-targets"></a>Целевые показатели масштабирования учетной записи хранения
Azure поддерживает несколько типов учетных записей хранения для различных сценариев хранилища, которые могут иметь клиенты, но для службы файлов Azure существуют два основных типа учетных записей хранения. Тип учетной записи хранения, который необходимо создать, зависит от того, хотите ли вы создать стандартный файловый ресурс или общую папку Premium: 

- **Учетные записи хранения общего назначения версии 2.** Такие учетные записи хранения позволяют развертывать общие папки Azure на оборудовании на основе жестких дисков (HDD) уровня "Стандартный". Наряду с общими папками Azure такие учетные записи хранения поддерживают и другие ресурсы хранилища, включая контейнеры больших двоичных объектов, очереди и таблицы. Общие файловые ресурсы можно развернуть в оптимизированных для транзакции (по умолчанию), горячий или холодном уровнях.

- **Учетные записи хранения FileStorage.** Такие учетные записи хранения позволяют развертывать общие папки Azure на оборудовании на основе твердотельных накопителей (SSD) уровня "Премиум". Учетные записи FileStorage можно использовать только для хранения общих папок Azure. Другие ресурсы хранилища (контейнеры больших двоичных объектов, очереди, таблицы и т. д.) нельзя развертывать в учетной записи FileStorage.

| attribute | Учетные записи хранения GPv2 (Standard) | Учетные записи хранения Филестораже (Premium) |
|-|-|-|
| Количество учетных записей хранилища на подписку на регион | 250 | 250 |
| Максимальная емкость учетной записи хранения | 5 ПИБ<sup>1</sup> | 100 Тиб (подготовлено) |
| Максимальное количество файловых ресурсов | Неограниченно | Без ограничений общий размер всех общих ресурсов должен быть меньше максимального, чем максимальная емкость учетной записи хранения. |
| Максимальное число одновременных запросов | 20 000 операций ввода-вывода<sup>1</sup> | 100 000 операций ввода-вывода в секунду |
| Максимальное число входящих | <ul><li>США и Европа: 10 GBP/с<sup>1</sup></li><li>Другие регионы (LRS/ZRS): 10 GBP/с<sup>1</sup></li><li>Другие регионы (GRS): 5 GBP/с<sup>1</sup></li></ul> | 4 136 MiB/с |
| Максимальное число исходящих входящих | 50 GBP/с<sup>1</sup> | 6 204 MiB/с |
| Максимальное число правил виртуальной сети | 200 | 200 |
| Максимальное число правил IP-адресов | 200 | 200 |
| Операции чтения управления | 800 за 5 минут | 800 за 5 минут |
| Операции записи управления | 10 в секунду/1200 в час | 10 в секунду/1200 в час |
| Операции со списком управления | 100 за 5 минут | 100 за 5 минут |

<sup>1</sup> учетные записи хранения общего назначения версии 2 поддерживают более высокие ограничения емкости и более высокие ограничения для входящего трафика по запросу. Чтобы подать запрос на увеличение ограничений для учетной записи, обратитесь в [службу поддержки Azure](https://azure.microsoft.com/support/faq/).

### <a name="azure-file-share-scale-targets"></a>Целевые объекты масштабирования общей папки Azure
| attribute | Стандартные общие папки<sup>1</sup> | Общие папки ценовой категории "Премиум" |
|-|-|-|
| Минимальный размер общего файла | Не минимально | 100 гиб (подготовлено) |
| Размер подготовленной единицы увеличения/уменьшения | Н/Д | 1 гиб |
| Максимальный размер общей папки | <ul><li>100 Тиб с включенной функцией большого общего файлового ресурса<sup>2</sup></li><li>5 Тиб, по умолчанию</li></ul> | 100 Тиб |
| Максимальное количество файлов в общей папке | Без ограничений | Без ограничений |
| Максимальная частота запросов (максимальное число операций ввода-вывода в секунду) | <ul><li>10 000 с включенной функцией большого общего файлового ресурса<sup>2</sup></li><li>1 000 или 100 запросов на 100 мс, по умолчанию</li></ul> | <ul><li>Базовые операции ввода-вывода: 400 + 1 операций ввода-вывода в секунду на гиб, до 100 000</li><li>Разбивка на операции ввода-вывода в секунду: максимум (4000, 3 раза операций ввода-вывода на гиб), до 100 000</li></ul> |
| Максимальное значение входящего трафика для одной общей папки | <ul><li>До 300 MiB/с, с включенной функцией больших файловых ресурсов<sup>2</sup></li><li>До 60 MiB/с, по умолчанию</li></ul> | 40 MiB/s + 0,04 * подготовленная гиб |
| Максимальное значение исходящего трафика для одной общей папки | <ul><li>До 300 MiB/с, с включенной функцией больших файловых ресурсов<sup>2</sup></li><li>До 60 MiB/с, по умолчанию</li></ul> | 60 MiB/s + 0,06 * подготовленная гиб |
| Максимальное число моментальных снимков общих ресурсов | моментальные снимки 200 | моментальные снимки 200 |
| Максимальная длина имени объекта максимальное (папок и файлов) | 2048 символов | 2048 символов |
| Максимальное количество компонентов в имени пути (в пути \A\B\C\D каждая буква обозначает компонент) | 255 символов | 255 символов |
| Ограничение жесткой связи (только NFS) | Н/Д | 178 |
| Максимальное количество каналов SMB Multichannel | Недоступно | 4 |
| Максимальное число хранимых политик доступа на общую папку | 5 | 5 |

<sup>1</sup> ограничения для стандартных файловых ресурсов применяются ко всем трем уровням, доступным для стандартных файловых ресурсов: оптимизированные, активные и интересные.

<sup>2</sup> по умолчанию для стандартных файловых ресурсов имеет значение 5 тиб. Дополнительные сведения о том, как увеличить 100 масштаб стандартных файловых ресурсов, см. в статье [Включение и создание больших файловых](./storage-files-how-to-create-large-file-share.md) ресурсов.

### <a name="file-scale-targets"></a>Целевые объекты масштабирования файлов
| attribute | Файлы в стандартных файловых ресурсах  | Файлы в общих файловых ресурсах уровня "Премиум"  |
|-|-|-|
| Максимальный размер файла | 4 ТиБ | 4 ТиБ |
| Максимальное число одновременных запросов | 1 000 ОПЕРАЦИЙ ВВОДА-ВЫВОДА | До 8 000<sup>1</sup> |
| Максимальное число входящих данных для файла | 60 MiB/с | 200 MiB/сек (до 1 гиб/с с помощью многоканальной предварительной версии SMB)<sup>2</sup>|
| Максимальное число исходящих входящих для файла | 60 MiB/с | 300 MiB/сек (до 1 гиб/с с помощью многоканальной предварительной версии SMB)<sup>2</sup> |
| Максимальное число параллельных дескрипторов | 2 000 дескрипторы | 2 000 дескрипторы  |

<sup>1 применяется для чтения и записи iOS (обычно это меньшие размеры ввода-вывода, меньшие или равные 64 КИБ). Операции с метаданными, кроме операций чтения и записи, могут быть ниже.</sup> 
 <sup>2 подчиняются ограничениям сети компьютеров, доступной пропускной способности, размерам операций ввода-вывода, глубине очереди и другим факторам. Дополнительные сведения см. в статье [многоканальная производительность SMB](./storage-files-smb-multichannel-performance.md).</sup>

## <a name="azure-file-sync-scale-targets"></a>Целевые показатели масштабируемости службы "Синхронизация файлов Azure"
В таблице указаны пределы тестирования, проведенного Майкрософт, и жесткие ограничения для некоторых целевых показателей.

| Ресурс | Назначение | Строгое ограничение |
|----------|--------------|------------|
| Служб синхронизации службы хранилища на регион | 100 служб синхронизации хранилища | Да |
| Число групп синхронизации на службу синхронизации хранилища | 200 групп синхронизации | Да |
| Число зарегистрированных серверов на службу синхронизации хранилища | 99 серверов | Да |
| Количество облачных конечных точек на группу синхронизации | 1 облачная конечная точка | Да |
| Количество конечных точек сервера на группу синхронизации | 100 конечных точек сервера | Да |
| Число конечных точек сервера на сервер | 30 конечных точек сервера | Да |
| Число объектов файловой системы (папок и файлов) на группу синхронизации | 100 млн объектов | нет |
| Максимальное число объектов файловой системы (папок и файлов) в каталоге | 5 млн объектов | Да |
| Максимальная длина дескриптора защиты объекта (папок и файлов) | 64 КиБ | Да |
| Размер файла | 100 ГиБ | нет |
| Минимальный размер для файла, который будет связан | V9 и более поздние версии: на основе размера кластера файловой системы (двойной размер кластера файловой системы). Например, если размер кластера файловой системы равен 4 КИБ, минимальный размер файла будет равен 8 КИБ.<br> Версия 8 и более старые: 64 КиБ  | Да |

> [!Note]  
> Конечная точка Синхронизации файлов Azure может масштабироваться до размера общей папки Azure. Если достигнуто ограничение для размера общей папки Azure, синхронизация не будет выполняться.

### <a name="azure-file-sync-performance-metrics"></a>Метрики производительности службы синхронизации файлов Azure
Так как агент службы синхронизации файлов Azure работает на компьютере под управлением Windows Server, который подключается к общим папкам Azure, эффективная синхронизация зависит от ряда факторов в вашей инфраструктуре: Windows Server и базовой конфигурации диска, пропускной способности сети между сервером и хранилищем Azure, размера файла, общего размера набора данных и активности в наборе данных. Так как служба синхронизации файлов Azure работает на уровне файлов, характеристики производительности решения на основе этой службы лучше измеряются в количестве обрабатываемых объектов (файлов и каталогов) в секунду.

Для службы синхронизации файлов Azure производительность имеет решающее значение на двух этапах:

1. **Исходная одноразовая подготовка**. Сведения об оптимальном развертывании для оптимизации производительности при начальной подготовке см. в разделе [Подключение с помощью службы синхронизации файлов Azure](storage-sync-files-deployment-guide.md#onboarding-with-azure-file-sync).
2. **Непрерывная синхронизация**. После первоначального добавления данных в общие папки Azure служба синхронизации файлов Azure синхронизирует несколько конечных точек.

Чтобы помочь вам спланировать развертывание для каждого из этапов, ниже приведены результаты, полученные во время внутреннего тестирования в системе со следующей конфигурацией.

| Конфигурация системы | Сведения |
|-|-|
| ЦП | 64 виртуальных ядер с кэшем L3 на 64 МиБ |
| Память | 128 ГиБ |
| Диск | Диски SAS с RAID 10 и кэшем, работающем от аккумулятора |
| Сеть | Сеть 1 Гбит/с |
| Рабочая нагрузка | Файловый сервер общего назначения|

| Одноразовая начальная подготовка  | Сведения |
|-|-|
| Число объектов | 25 млн объектов |
| Размер набора данных| ~ 4,7 тиб |
| Средний размер файлов | ~ 200 КИБ (самый крупный файл: 100 гиб) |
| Исходное перечисление изменений в облаке | 20 объектов в секунду  |
| Пропускная способность отправки | 20 объектов в секунду на группу синхронизации |
| Пропускная способность загрузки пространства имен | 400 объектов в секунду |

### <a name="initial-one-time-provisioning"></a>Одноразовая начальная подготовка

**Исходное перечисление изменений в облаке**. при создании новой группы синхронизации начальное перечисление изменений в облаке является первым этапом, который будет выполнен. В этом процессе система будет перечислять все элементы в файловом ресурсе Azure. Во время этого процесса не будет выполняться синхронизация, т. к. ни один из облачных конечных точек не будет загружен в конечную точку сервера, а элементы не будут переданы из конечной точки сервера в облачную конечную точку. Действие синхронизации будет возобновлено после завершения первоначального перечисления изменений в облаке.
Скорость производительности составляет 20 объектов в секунду. Клиенты могут оценить время, необходимое для завершения первоначального перечисления изменений в облаке, определив количество элементов в облачной общей папке и используя следующую формулу для получения времени в днях. 

   **Время (в днях) для начального перечисления облака = (число объектов в облачной конечной точке)/(20 * 60 * 60 * 24)**

**Начальная синхронизация данных из Windows Server в общую папку Azure**. Многие синхронизация файлов Azure развертывания начинаются с пустого файлового ресурса Azure, так как все данные находятся на сервере Windows Server. В таких случаях исходное перечисление изменений в облаке выполняется быстро, и большая часть времени будет потрачена на синхронизацию изменений с Windows Server в общих файловых ресурсах Azure. 

Хотя синхронизация отправляет данные в общую папку Azure, на локальном файловом сервере нет простоев, а администраторы могут [настроить ограничения сети](https://docs.microsoft.com/azure/storage/files/storage-sync-files-server-registration#set-azure-file-sync-network-limits) , чтобы ограничить объем пропускной способности, используемый для фоновой передачи данных.

Начальная синхронизация обычно ограничивается начальной скоростью передачи в 20 файлов в секунду на группу синхронизации. Клиенты могут оценить время отправки всех своих данных в Azure, используя следующую формулу для получения времени в днях:  

   **Время (в днях) отправки файлов в группу синхронизации = (число объектов в конечной точке сервера)/(20 * 60 * 60 * 24)**

Разделение данных на несколько конечных точек сервера и групп синхронизации может ускорить эту начальную передачу данных, так как отправка может выполняться параллельно для нескольких групп синхронизации с частотой в 20 элементов в секунду. Таким образом, две группы синхронизации будут выполняться с общей скоростью 40 элементов в секунду. Общее время выполнения — это временная оценка для группы синхронизации с наибольшим количеством синхронизируемых файлов.

**Пропускная способность загрузки пространства имен** При добавлении новой конечной точки сервера в существующую группу синхронизации агент Синхронизация файлов Azure не скачивает содержимое файлов из конечной точки облака. Сначала он синхронизирует полное пространство имен, а затем запускает фоновый вызов для скачивания файлов, либо полностью, либо, если включено распределение по уровням облака, в политику распределения по уровням облака, установленную на конечной точке сервера.

| Непрерывная синхронизация  | Сведения  |
|-|--|
| Количество синхронизированных объектов| 125 000 объектов (~1 % обновления) |
| Размер набора данных| 50 ГиБ |
| Средний размер файлов | ~500 КиБ |
| Пропускная способность отправки | 20 объектов в секунду на группу синхронизации |
| Полная пропускная способность скачивания* | 60 объектов в секунду |

* Если включено распределение по уровням облака, вы, скорее всего, будете наблюдать лучшую производительность, так как скачиваются только некоторые данные файлов. Служба синхронизации файлов Azure скачивает данные кэшированных файлов только при их изменении в любой из конечных точек. Для любых многоуровневых или вновь созданных файлов агент не скачивает данные файла и вместо этого синхронизирует пространство имен со всеми конечными точками сервера. Агент также поддерживает частичное скачивание многоуровневых файлов по мере получения доступа к ним пользователем. 

> [!Note]  
> Цифры выше не являются показателем наблюдаемой производительности. Фактическая производительность будет зависеть от нескольких факторов, как указано в начале этого раздела.

В качестве общего руководства по развертыванию вы должны учитывать следующие моменты:

- Пропускная способность объекта приблизительно масштабируется пропорционально количеству групп синхронизации на сервере. Разделение данных на несколько групп синхронизации на сервере улучшает пропускную способность, которая также ограничена сервером и сетью.
- Пропускная способность объекта обратно пропорциональна пропускной способности в МиБ в секунду. Для файлов меньшего размера вы получите более высокую пропускную способность с точки зрения количества объектов, обработанных в секунду, но меньшую пропускную способность в МиБ в секунду. И наоборот, для файлов большего размера будет обработано меньше объектов в секунду, но с более высокой пропускной способностью в МиБ в секунду. Пропускная способность в МиБ в секунду ограничена целевыми объектами масштабирования файлов Azure.

## <a name="see-also"></a>См. также
- [Планирование развертывания Файлов Azure](storage-files-planning.md)
- [Планирование развертывания службы синхронизации файлов Azure (предварительная версия)](storage-sync-files-planning.md)
