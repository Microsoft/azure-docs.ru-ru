---
title: Часто задаваемые вопросы о службе файлов Azure | Документация Майкрософт
description: Получите ответы на часто задаваемые вопросы о службе файлов Azure. Вы можете параллельно подключать файловые ресурсы Azure в облачных или локальных развертываниях Windows, Linux или macOS.
author: roygara
ms.service: storage
ms.date: 02/23/2020
ms.author: rogarana
ms.subservice: files
ms.topic: conceptual
ms.openlocfilehash: 2d4286cc8bc08eaf7d0b376a8b7789c8c8db183d
ms.sourcegitcommit: dda0d51d3d0e34d07faf231033d744ca4f2bbf4a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102202643"
---
# <a name="frequently-asked-questions-faq-about-azure-files"></a>Часто задаваемые вопросы о службе файлов Azure
Служба [файлов Azure](storage-files-introduction.md) предлагает полностью управляемые общие файловые ресурсы в облаке, доступные через стандартный промышленный [протокол SMB](/windows/win32/fileio/microsoft-smb-protocol-and-cifs-protocol-overview) и [протокол NFS](https://en.wikipedia.org/wiki/Network_File_System) (Предварительная версия). Общие ресурсы службы файлов Azure можно одновременно подключить к облачным или локальным развертываниям Windows, Linux и macOS. Вы также можете кэшировать общие файловые ресурсы Azure на компьютерах под управлением Windows Server с помощью функции "Синхронизация файлов Azure", чтобы получить быстрый доступ из расположения, где используются данные.

В этой статье приведены ответы на часто задаваемые вопросы о возможностях и функциях службы файлов Azure, включая использование синхронизации файлов Azure в отношении этой службы. Если вы не нашли ответ на свой вопрос, свяжитесь с нами, используя следующие каналы (в порядке эскалации):

1. Раздел комментариев этой статьи.
2. [Страница Майкрософт с вопросами и ответами о службе хранилища Azure](/answers/topics/azure-file-storage.html).
3. [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files). 
4. Служба поддержки Майкрософт. Чтобы создать запрос на поддержку на портале Azure, на вкладке **Справка** нажмите кнопку **Справка и поддержка**, а затем выберите **Новый запрос на поддержку**.

## <a name="general"></a>Общие сведения
* <a id="why-files-useful"></a>
  **Чем полезна служба файлов Azure?**  
   Вы можете использовать эту службу, чтобы создавать общие файловые ресурсы в облаке без необходимости управления дополнительными нагрузками физического сервера, устройства или модуля. Всю эту монотонную работу мы делаем за вас, включая обновления ОС и замену неработоспособных дисков. Дополнительные сведения о сценариях, для работы с которыми будет полезна служба файлов Azure, см. в разделе [Зачем нужна служба файлов Azure](storage-files-introduction.md#why-azure-files-is-useful).

* <a id="file-access-options"></a>
  **Какие имеются способы доступа к файлам в службе файлов Azure?**  
    Общие файловые ресурсы SMB можно подключить на локальном компьютере с помощью протокола SMB 3,0. также можно использовать такие средства, как [Обозреватель службы хранилища](https://storageexplorer.com/) , для доступа к файлам в общей папке. Файловые ресурсы NFS можно подключить на локальном компьютере, скопировав или вставляя скрипт, предоставленный портал Azure. Для доступа к файлам в общем файловом ресурсе Azure из приложения можно использовать клиентские библиотеки хранилища, REST API, PowerShell или Azure CLI.

* <a id="what-is-afs"></a>
  **Что такое служба "Синхронизация файлов Azure"?**  
    Вы можете использовать службу синхронизации файлов Azure, чтобы централизованно хранить файловые ресурсы организации в службе файлов Azure, обеспечивая гибкость, производительность и совместимость локального файлового сервера. Это достигается путем преобразования компьютеров Windows Server в быстрый кэш общего файлового ресурса Azure. Для локального доступа к данным вы можете использовать любой протокол, в том числе SMB, NFS и FTPS, доступный в Windows Server. Кроме того, вы можете создать любое количество кэшей в любом регионе.

* <a id="files-versus-blobs"></a>
  **Почему для хранения данных предпочтительнее использовать файловый ресурс Azure, а не хранилище BLOB-объектов Azure?**  
    Эти службы позволяют хранить большой объем данных в облаке, но их предназначение несколько различно. 
    
    Хранилище BLOB-объектов Azure можно использовать для облачных приложений с широкими возможностями масштабирования для хранения неструктурированных данных. Чтобы добиться максимальной производительности и масштабируемости, лучше не использовать хранилище BLOB-объектов Azure, так как в сравнении с реальной файловой системой оно представляет собой упрощенный вариант хранения. Доступ к хранилищу BLOB-объектов Azure можно получить только с помощью клиентских библиотек на основе REST (или напрямую через протокол REST).

    Служба файлов Azure главным образом представляет собой файловую систему. Служба "Файлы Azure" содержит все известные вам абстракции, связанные с файлами, с которыми вы знакомы в течение длительного времени использования локальных операционных систем. Как и хранилище BLOB-объектов Azure, служба "Файлы Azure" предлагает интерфейс REST и клиентские библиотеки на основе REST. В отличие от хранилища BLOB-объектов Azure, служба файлов Azure предоставляет доступ к общим папкам Azure по протоколу SMB или NFS. Общие файловые ресурсы можно подключать непосредственно в Windows, Linux или macOS, локально или на облачных виртуальных машинах, не записывая код или присоединяя какие-либо специальные драйверы к файловой системе. Вы также можете кэшировать общие файловые ресурсы SMB Azure на локальных файловых серверах с помощью Синхронизация файлов Azure для быстрого доступа, близко к месту использования данных. 
   
    Дополнительные сведения о различиях между службой "Файлы Azure" и хранилищем BLOB-объектов Azure см. в статье [Введение в основные службы хранилища Azure](../common/storage-introduction.md). Дополнительные сведения о хранилище BLOB-объектов Azure см. в статье [Общие сведения о хранилище BLOB-объектов](../blobs/storage-blobs-introduction.md).

* <a id="files-versus-disks"></a>**Почему предпочтительнее использовать файловый ресурс Azure, а не диски Azure?**  
    Диски Azure — это обычные диски. Чтобы диск Azure стал полезен, его необходимо подключить к виртуальной машине, работающей в Azure. С дисками Azure можно работать во всех случаях, когда их использование на локальном сервере практично. Диск Azure можно использовать как системный диск ОС, область буфера ОС или выделенное хранилище приложения. Интересный способ использования дисков Azure — это создание файлового сервера в облаке для использования в тех же расположениях, в которых используется файловый ресурс Azure. Развертывание файлового сервера на виртуальных машинах Azure — это высокопроизводительный способ получения хранилища файлов в Azure, если вам нужны варианты развертывания, которые сейчас не поддерживаются службой "файлы Azure". 

    Тем не менее запуск файлового сервера с помощью дисков Azure, используемых в качестве серверного хранилища, обойдется гораздо дороже, чем использование файлового ресурса Azure. Причины следующие. Первая. Кроме оплаты использования дискового хранилища вам также необходимо будет оплатить стоимость работы одной или нескольких виртуальных машин Azure. Вторая. Вам также придется управлять виртуальными машинами, используемыми для запуска файлового сервера, например обновлять ОС. И третья. Если в конечном счете вам потребуется локальное кэширование данных, то для реализации такого кэширования вы сами должны будете настроить технологии репликации, например репликацию распределенной файловой системы (DFSR), а также управлять ими.

    Один из способов, который вы можете применить (кроме использования дисков Azure в качестве серверного хранилища), чтобы по максимуму использовать возможности службы "Файлы Azure" и файлового сервера, размещенного на виртуальных машинах Azure, — установить службу синхронизации файлов Azure на этом файловом сервере, размещенном на виртуальной машине в облаке. Если файловый ресурс Azure находится в том же регионе, что и файловый сервер, можно включить распределение по уровням облака и задать максимальный процент (99 %) свободного пространства на диске. Это обеспечит минимальное дублирование данных, а вы сможете использовать любые необходимые вам приложения на файловых серверах, например, которым нужно поддерживать протокол NFS.

    Дополнительные сведения о способе настройки высокопроизводительного и высокодоступного файлового сервера в Azure см. в записи блога о [развертывании гостевых кластеров виртуальной машины IaaS в Microsoft Azure](https://blogs.msdn.microsoft.com/clustering/2017/02/14/deploying-an-iaas-vm-guest-clusters-in-microsoft-azure/). Дополнительные сведения о различиях между службой "Файлы Azure" и дисками Azure см. в статье [Введение в основные службы хранилища Azure](../common/storage-introduction.md). Дополнительные сведения о дисках Azure см. в статье [Обзор компонента "Управляемые диски" Azure](../../virtual-machines/managed-disks-overview.md).

* <a id="get-started"></a>
  **Как начать работу со службой файлов Azure?**  
   Это очень легко. Сначала [Создайте файловый ресурс SMB](storage-how-to-create-file-share.md) или [Создайте общую папку NFS](storage-files-how-to-create-nfs-shares.md), а затем подключите ее к используемой операционной системе. 

  * [Подключение общего ресурса SMB в Windows](storage-how-to-use-files-windows.md)
  * [Подключение общего ресурса SMB в Linux](storage-how-to-use-files-linux.md)
  * [Подключение общего ресурса SMB в macOS](storage-how-to-use-files-mac.md)
  * [Подключение общей папки NFS](storage-files-how-to-mount-nfs-shares.md)

    Более подробные сведения по развертыванию общего файлового ресурса Azure для замены рабочих файловых ресурсов в вашей организации см. в статье [Планирование развертывания службы файлов Azure](storage-files-planning.md).

* <a id="redundancy-options"></a>
  **Какие параметры избыточности хранилища поддерживаются в службе файлов Azure?**  
    В настоящее время служба файлов Azure поддерживает локально избыточное хранилище (LRS), хранилище, избыточное в пределах зоны (ZRS), геоизбыточное хранилище (GRS) и хранилище, геоизбыточное между зонами (GZRS). Уровень "Премиум" файлов Azure в настоящее время поддерживает только LRS и ZRS.

* <a id="tier-options"></a>
  **Какие уровни хранилища поддерживаются службой файлов Azure?**  
    Служба файлов Azure поддерживает два уровня хранилища: "Премиум" и "Стандартный". Стандартные общие файловые ресурсы создаются в учетных записях хранения общего назначения (GPv1 или GPv2), а премиумные общие файловые ресурсы создаются в учетных записях хранения FileStorage. Узнайте, как создавать [стандартные общие файловые ресурсы](storage-how-to-create-file-share.md) и [общие файловые ресурсы уровня "Премиум"](./storage-how-to-create-file-share.md). 
    
    > [!NOTE]
    > Нельзя создавать общие файловые ресурсы Azure из учетных записей хранения только для больших двоичных объектов или учетных записей хранения уровня *Премиум* общего назначения (GPv1 или GPv2). Стандартные общие файловые ресурсы Azure должны создаваться только в учетных записях общего назначения уровня *Стандартный*, а общие файловые ресурсы Azure уровня "Премиум" должны создаваться только в учетных записях хранения FileStorage. Учетные записи хранения общего назначения уровня *Премиум* (GPv1 и GPv2) предназначены только для страничных BLOB-объектов класса "Премиум". 

* <a id="file-locking"></a>
  **Поддерживает ли служба "файлы Azure" блокировку файлов?**  
    Да, Файлы Azure полностью поддерживают блокировку файлов в стиле SMB/Windows, [см. сведения](/rest/api/storageservices/managing-file-locks).

* <a id="give-us-feedback"></a>
  **Очень хотелось бы, чтобы в службу файлов Azure была включена отдельная функция. Это возможно?**  
    Рабочая группа службы файлов Azure готова рассмотреть все предложения и отзывы в отношении своей работы. Проголосуйте за вариант, который вам понравился, на странице, посвященной [оптимизации службы хранилища Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files). Мы заинтересованы в разработке новых полезных функций.

## <a name="azure-file-sync"></a>Служба синхронизации файлов Azure

* <a id="afs-region-availability"></a>
  **В каких регионах поддерживается функция "Синхронизация файлов Azure"?**  
    Список доступных регионов можно найти в [этом разделе](storage-sync-files-planning.md#azure-file-sync-region-availability) руководства по планированию развертывания функции "Синхронизация файлов Azure". Мы планируем постоянно добавлять дополнительные регионы, в том числе регионы, не являющиеся общедоступными.

* <a id="cross-domain-sync"></a>
  **Могут ли в одной группе синхронизации находиться серверы, присоединенные к домену, и серверы, независимые от него?**  
    Да. Группа синхронизации может содержать конечные точки сервера, которые могут принадлежать к разным группам Active Directory, даже если они независимы от домена. Хотя технически такая конфигурация работает, мы не рекомендуем ее использовать как стандартную, так как списки ACL, определенные для файлов и папок на одном сервере, могут не учитываться другими серверами в этой же группе синхронизации. Чтобы получить оптимальные результаты, мы рекомендуем выполнить синхронизацию между серверами в одном лесу Active Directory, серверами в разных лесах Active Directory с установленными отношениями доверия или между серверами, независимыми от домена, а не использовать все варианты сразу.

* <a id="afs-change-detection"></a>
  **Если файл был создан непосредственно в файловом ресурсе Azure через SMB или портал, сколько времени займет его синхронизация с серверами в группе синхронизации?**  
    [!INCLUDE [storage-sync-files-change-detection](../../../includes/storage-sync-files-change-detection.md)]


* <a id="afs-sync-time"></a>
  **Сколько времени займет Синхронизация файлов Azure отправки 1TiB данных?**
  
    Производительность зависит от параметров среды, конфигурации и того, является ли это начальной синхронизацией или текущей синхронизацией. Дополнительные сведения см. в разделе [Синхронизация файлов Azure метрики производительности](storage-files-scale-targets.md#azure-file-sync-performance-metrics) .

* <a id="afs-conflict-resolution"></a>**Что произойдет при изменении одного файла на двух серверах приблизительно в одно время?**  
    Синхронизация файлов Azure использует простую стратегию разрешения конфликтов. в то же время сохраняются оба изменения в файлах, измененных в двух конечных точках. Сохранится имя того файла, который был изменен последним. Старый файл (определяемый LastWriteTime) содержит имя конечной точки и номер конфликта, добавленный к имени файла. Для конечных точек сервера имя конечной точки — это имя сервера. Для облачных конечных точек имя конечной точки — **Cloud**. Имя соответствует этой таксономии: 
   
    \<FileNameWithoutExtension\>-\<endpointName\>\[-#\].\<ext\>  

    Например, файл CompanyReport.docx при первом конфликте станет CompanyReport-CentralServer.docx, где CentralServer является расположением, в котором запись изменений произошла раньше. Для второго конфликта соответственно будет использоваться имя CompanyReport-CentralServer-1.docx. Синхронизация файлов Azure поддерживает 100 конфликтующих файлов для каждого файла. После достижения максимального количества конфликтующих файлов файл не будет синхронизироваться, пока число конфликтующих файлов не станет меньше 100.

* <a id="afs-storage-redundancy"></a>
  **Поддерживает ли служба "Синхронизация файлов Azure" геоизбыточное хранилище?**  
    Да, служба файлов Azure поддерживает локально избыточное хранилище (LRS) и геоизбыточное хранилище (GRS). Если отработка отказа учетной записи хранения запускается между связанными регионами из учетной записи, настроенной для GRS, корпорация Майкрософт рекомендует рассматривать новую область только как резервную копию данных. Служба синхронизации файлов Azure не запустит автоматическую синхронизацию с новым основным регионом. 

* <a id="sizeondisk-versus-size"></a>
  **Почему свойство файла *Размер на диске* не соответствует свойству *Размер* после использования службы "Синхронизация файлов Azure"?**  
  См. раздел [понимание синхронизация файлов Azure распределение по уровням облака](storage-sync-cloud-tiering-overview.md#tiered-vs-locally-cached-file-behavior).

* <a id="is-my-file-tiered"></a>
  **Как определить, что файл был перемещен?**  
  См. раздел [Управление многоуровневые файлы синхронизация файлов Azure](storage-sync-how-to-manage-tiered-files.md#how-to-check-if-your-files-are-being-tiered).

* <a id="afs-recall-file"></a>**Файл, который мне нужен, был перемещен. Как мне локально отозвать его на диск?**  
  См. раздел [Управление многоуровневые файлы синхронизация файлов Azure](storage-sync-how-to-manage-tiered-files.md#how-to-recall-a-tiered-file-to-disk).

* <a id="afs-force-tiering"></a>
  **Как можно принудительно переместить файл или каталог?**  
  См. раздел [Управление многоуровневые файлы синхронизация файлов Azure](storage-sync-how-to-manage-tiered-files.md#how-to-force-a-file-or-directory-to-be-tiered).

* <a id="afs-effective-vfs"></a>
  **Как определяется *свободное место в томе*, если в нем используется несколько конечных точек сервера?**  
  См. статью [выбор синхронизация файлов Azure политик уровня облака](storage-sync-cloud-tiering-policy.md#multiple-server-endpoints-on-a-local-volume).
  
* <a id="afs-tiered-files-tiering-disabled"></a>
  **У меня отключено распределение по уровням облака, почему в расположении серверной конечной точки есть многоуровневые файлы?**  
    Существует две причины, по которым многоуровневые файлы могут существовать в расположении конечной точки сервера.

    - При добавлении новой конечной точки сервера в существующую группу синхронизации при выборе варианта отозвать пространство имен First или отозвать только пространство имен для начального режима загрузки файлы будут отображаться как многоуровневые, пока они не загружаются локально. Чтобы избежать этого, установите флажок не использовать многоуровневые файлы для начального режима загрузки. Чтобы отозвать файлы вручную, используйте командлет [Invoke-сторажесинкфилерекалл](storage-sync-how-to-manage-tiered-files.md#how-to-recall-a-tiered-file-to-disk) .

    - Если распределение по уровням облака было включено на конечной точке сервера, а затем отключено, файлы останутся распределенными по уровням до тех пор, пока они не будут доступны.

* <a id="afs-tiered-files-not-showing-thumbnails"></a>
  **Почему мои многоуровневые файлы не показывают эскизы или предварительные версии в проводнике Windows?**  
    Для многоуровневых файлов эскизы и предварительные версии не будут отображаться на конечной точке сервера. Такое поведение ожидается, так как функция кэширования эскизов в Windows намеренно пропускает чтение файлов с помощью атрибута offline. Если выбрано распределение по уровням в облаке, считывание через многоуровневые файлы приведет к их скачанию (отзыв).

    Это поведение не относится к Синхронизация файлов Azure, в проводнике Windows отображается «серый крестик» для всех файлов с установленным атрибутом «вне сети». При доступе к файлам по протоколу SMB вы увидите значок X. Подробное описание этого поведения см. на [https://blogs.msdn.microsoft.com/oldnewthing/20170503-00/?p=96105](https://blogs.msdn.microsoft.com/oldnewthing/20170503-00/?p=96105)

    Вопросы управления многоуровневыми файлами см. в разделе [Управление многоуровневыми файлами](storage-sync-how-to-manage-tiered-files.md).

* <a id="afs-files-excluded"></a>
  **Какие файлы или папки автоматически исключены в службе "Синхронизация файлов Azure"?**  
  См. [Пропущенные файлы](storage-sync-files-planning.md#files-skipped).

* <a id="afs-os-support"></a>
  **Могу ли я использовать службу "Синхронизация файлов Azure" с Windows Server 2008 R2, Linux или своим запоминающим устройством, подключаемым к сети (NAS)?**  
    Сейчас служба синхронизации файлов Azure поддерживает только Windows Server 2019, Windows Server 2016 и Windows Server 2012 R2. В данный момент мы ничего не планируем, но мы с радостью рассмотрим предложения по поводу поддержки дополнительных платформ, проанализировав потребности клиентов. Сообщите нам о платформах, для которых нужно реализовать поддержку, на портале [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files).

* <a id="afs-tiered-files-out-of-endpoint"></a>
  **Почему многоуровневые файлы существуют вне пространства имен конечной точки сервера?**  
    До выпуска агента службы "Синхронизация файлов Azure" версии 3 эта служба блокировала перемещение многоуровневых файлов за пределы конечной точки сервера, но на тот же том, на котором размещена эта конечная точка сервера. Это не затрагивало операции копирования, перемещение файлов без уровней и перемещение многоуровневых файлов на другие тома. Причиной такого поведения было неявное предположение о том, что проводник и другие интерфейсы API Windows обрабатывают эти операции перемещения на тот же том, что и (практически) мгновенные операции переименования. Это означает, что после перемещения с помощью проводника или других методов перемещения (например, командной строки или PowerShell) будет невозможно отозвать данные из облака с помощью службы "Синхронизация файлов Azure". Начиная с [агента службы "Синхронизация файлов Azure" версии 3.0.12.0](storage-files-release-notes.md#supported-versions) эта служба позволяет переместить многоуровневый файл за пределы конечной точки сервера. Мы избегаем упомянутых выше проблем, позволяя многоуровневому файлу существовать в виде многоуровневого файла за пределами конечной точки сервера, а затем отзывая этот файл в фоновом режиме. Это означает, что перемещение в пределах тома выполняется мгновенно, и мы выполняем все действия для отзыва файла на диск после завершения перемещения. 

* <a id="afs-do-not-delete-server-endpoint"></a>
  **У меня возникла проблема со службой "Синхронизация файлов Azure" на сервере (синхронизация, распределение по уровням облака и т. д). Следует ли удалить и создать заново конечную точку сервера?**  
    [!INCLUDE [storage-sync-files-remove-server-endpoint](../../../includes/storage-sync-files-remove-server-endpoint.md)]
    
* <a id="afs-resource-move"></a>
  **Можно ли переместить службу синхронизации хранилища и (или) учетную запись хранения в другую группу ресурсов, подписку или клиент Azure AD?**  
   Да, служба синхронизации хранилища и (или) учетная запись хранения можно переместить в другую группу ресурсов, подписку или клиент Azure AD. После перемещения службы синхронизации хранилища или учетной записи хранения необходимо предоставить приложению Microsoft. StorageSync доступ к учетной записи хранения (см. раздел [обеспечение доступа к учетной записи хранения у синхронизация файлов Azure](./storage-sync-files-troubleshoot.md?tabs=portal1%252cportal#troubleshoot-rbac)).

    > [!Note]  
    > При создании облачной конечной точки служба синхронизации хранилища и учетная запись хранения должны находиться в одном клиенте Azure AD. После создания облачной конечной точки службу синхронизации хранилища и учетную запись хранения можно переместить в другой клиент Azure AD.
    
* <a id="afs-ntfs-acls"></a>
  **Сохраняет ли служба синхронизации файлов Azure наряду с данными, хранящимися в службе файлов Azure, списки управления доступом NTFS для каталогов или файлов?**

    По состоянию на 24 февраля 2020 г. новые и существующие списки управления доступом, сгруппированные с помощью службы синхронизации файлов Azure, сохраняются в формате NTFS, а изменения этих списков, вносимые непосредственно в общий файловый ресурс Azure, будут синхронизироваться со всеми серверами в группе синхронизации. Все изменения в ТУД, внесенные в службы файлов Azure, будут синхронизироваться через службу синхронизации файлов Azure. При копировании данных в службу файлов Azure обязательно используйте средство копирования, которое поддерживает необходимую "точность" для копирования атрибутов, меток времени и ACL в файловый ресурс Azure — либо через SMB, либо в службу "другие". При использовании средств копирования Azure, таких как AzCopy, важно использовать последнюю версию. Просмотрите [таблицу средств копирования файлов](storage-files-migration-overview.md#file-copy-tools) , чтобы получить общие сведения о средствах копирования Azure, чтобы обеспечить возможность копирования всех важных метаданных файла.

    Если вы включили Azure Backup в управляемые общие файловые ресурсы синхронизации файлов, списки управления доступом к файлам можно будет по-прежнему восстанавливать в рамках рабочего процесса восстановления резервной копии. Это работает либо для всего общего ресурса, либо для отдельных файлов и каталогов.

    Если вы используете моментальные снимки как часть решения для самостоятельного управления резервным копированием файловых ресурсов, управляемых с помощью синхронизации файлов, списки управления доступом могут быть неправильно восстановлены в списках управления доступом NTFS, если моментальные снимки были сделаны до 24 февраля 2020 г. В этом случае рассмотрите возможность обращения в службу поддержки Azure.
    
## <a name="security-authentication-and-access-control"></a>Безопасность, проверка подлинности и управление доступом
* <a id="ad-support"></a>
**Поддерживает ли служба "Файлы Azure" проверку подлинности и управление доступом на основе удостоверений?**  
    
    Да, Файлы Azure поддерживают проверку подлинности и управление доступом на основе удостоверений. Можно выбрать один из двух способов использования управления доступом на основе удостоверений: локальных служб домен Active Directory или Azure Active Directory доменных служб (AD DS Azure). Локальные доменные службы Active Directory (AD DS) поддерживают проверку подлинности с помощью присоединенных к домену AD DS компьютеров (локально или в Azure) для доступа к общим файловым ресурсам Azure через SMB. Проверка подлинности Azure AD по протоколу SMB для Файлов Azure использует присоединенные к домену Azure AD DS виртуальные машины Windows для получения доступа к общим ресурсам, каталогам и файлам, с использованием учетных данных Azure AD. Дополнительные сведения см. в статье [Общие сведения о поддержке проверки подлинности на основе удостоверения для доступа к SMB в Файлах Azure](storage-files-active-directory-overview.md). 

    В службе файлов Azure предусмотрено два дополнительных способа управления доступом:

    - Вы можете использовать подписанные URL-адреса (SAS), чтобы создать маркеры со специальными разрешениями, которые будут допустимы для использования в течение определенного интервала времени. Например, вы можете создать маркер с доступом только для чтения для одного конкретного файла со сроком действия 10 минут. Любой пользователь, обладающий этим маркером, пока он действует, получит доступ только для чтения к этому файлу на 10 минут. Подписанные ключи общего доступа поддерживаются только через интерфейс REST API или в клиентских библиотеках. Вам необходимо подключить файловый ресурс Azure через протокол SMB с помощью ключей учетной записи хранения.

    - Служба синхронизации файлов Azure сохранит все дискреционные списки ACL или DACL и выполнит их репликацию (на основе Active Directory или локально) для всех конечных точек сервера, с которыми она синхронизируется. 
    
    Для получения исчерпывающего представления всех протоколов, поддерживаемых в службах хранилища Azure, можно обратиться к разделу [Авторизация доступа к службе хранилища Azure](../common/storage-auth.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json). 
    
* <a id="encryption-at-rest"></a>
**Как обеспечить шифрование неактивных данных файлового ресурса Azure?**  

    Да. Дополнительные сведения см. в [Шифрование службы хранилища Azure](../common/storage-service-encryption.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

* <a id="access-via-browser"></a>
**Как предоставить доступ к определенному файлу через браузер?**  

    Вы можете использовать подписанные URL-адреса, чтобы создать маркеры со специальными разрешениями, которые будут допустимы для использования в течение определенного интервала времени. Например, вы можете создать маркер с доступом только для чтения к конкретному файлу и задать определенный интервал его действия. Пока маркер действителен, любой пользователь, у которого есть этот URL-адрес, сможет обращаться к файлу непосредственно из любого браузера. Вы можете легко создать ключ подписанного URL-адреса из пользовательского интерфейса, например обозревателя службы хранилища Azure.

* <a id="file-level-permissions"></a>
**Можно ли задать разрешение только для чтения или только для записи в отдельных папках внутри общего ресурса?**  

    При подключении общей папки по протоколу SMB такой уровень контроля над разрешениями недоступен. Тем не менее при создании подписанного URL-адреса с помощью API-интерфейса REST или клиентских библиотек для папок в общем ресурсе можно указать разрешения только для чтения или записи.

* <a id="ip-restrictions"></a>
**Можно ли внедрить ограничения IP-адресов для файлового ресурса Azure?**  

    Да. Доступ к общему файловому ресурсу Azure можно ограничить на уровне учетной записи хранения. Дополнительные сведения см. в статье [Настройка брандмауэров службы хранилища Azure и виртуальных сетей (предварительная версия)](../common/storage-network-security.md?toc=%2fazure%2fstorage%2ffiles%2ftoc.json).

* <a id="data-compliance-policies"></a>
**Какие политики соответствия данных поддерживаются службой файлов Azure?**  

   В основе работы службы файлов Azure лежит та же архитектура хранилища, которая используется и для других служб хранилища в службе хранилища Azure. К этой службе применяются те же политики соответствия данных. Дополнительные сведения о соответствии данных в службе хранилища Azure см. в разделах [Предложения для соответствия требованиям в службе хранилища Azure](../common/storage-compliance-offerings.md) и [Центр управления безопасностью Майкрософт](https://microsoft.com/trustcenter/default.aspx).

* <a id="file-auditing"></a>
**Как выполнять аудит доступа к файлам и изменения в службе "файлы Azure"?**

  Существуют два варианта, которые предоставляют функции аудита для службы файлов Azure.
  - Если пользователи обращаются к файловому ресурсу Azure напрямую, можно использовать [журналы службы хранилища Azure (Предварительная версия)](../blobs/monitor-blob-storage.md?tabs=azure-powershell#analyzing-logs) для наблюдения за изменениями файлов и доступом пользователей. Эти журналы можно использовать для устранения неполадок, и запросы записываются в журнал наиболее эффективно.
  - Если пользователи обращаются к файловому ресурсу Azure через Windows Server с установленным агентом Синхронизация файлов Azure, используйте [политику аудита](/windows/security/threat-protection/auditing/apply-a-basic-audit-policy-on-a-file-or-folder) или сторонний продукт, чтобы отслеживать изменения файлов и доступ пользователей на Windows Server. 
   
### <a name="ad-ds--azure-ad-ds-authentication"></a>AD DS & проверки подлинности AD DS Azure
* <a id="ad-support-devices"></a>
**Поддерживают ли доменные службы Azure Active Directory (Azure AD DS) Файлов Azure доступ по протоколу SMB под учетными данными Azure AD c устройств, присоединенных к Azure AD или зарегистрированных в Azure AD?**

    Нет, этот сценарий не поддерживается.

* <a id="ad-vm-subscription"></a>
**Можно ли получить доступ к общим файловым ресурсам Azure под учетными данными Azure AD с виртуальной машины с другой подпиской?**

    Если подписка, в которой развернут общий файловый ресурс, связана с тем же клиентом Azure AD, что и развертывание Azure AD DS, к домену которого подключена виртуальная машина, вы сможете получить доступ к файловым ресурсам Azure под теми же учетными данными Azure AD. Это ограничение накладывается не на подписку, а на связанный клиент Azure AD.
    
* <a id="ad-support-subscription"></a>
**Можно ли включить AD DS Azure или локальную проверку подлинности AD DS для файловых ресурсов Azure с помощью клиента Azure AD, отличного от основного клиента файлового ресурса Azure?**

    Нет, Файлы Azure поддерживают интеграцию Azure AD DS или локальных Azure AD DS только с клиентом Azure AD, который находится в той же подписке, что и общий файловый ресурс. С клиентом Azure AD может быть связана только одна подписка. Это ограничение относится как к AD DS Azure, так и к локальным методам проверки подлинности AD DS. При использовании локальных доменных службы Active Directory для проверки подлинности [учетные данные AD DS должны быть синхронизированы с Azure AD](../../active-directory/hybrid/how-to-connect-install-roadmap.md), с которым связана учетная запись хранения.

* <a id="ad-linux-vms"></a>
**Поддерживает ли проверка подлинности Azure AD DS или локальных AD DS для файловых ресурсов Azure виртуальные машины Linux?**

    Нет, проверка подлинности с виртуальных машин Linux не поддерживается.

* <a id="ad-aad-smb-afs"></a>
**Поддерживает ли файловые ресурсы, управляемые Синхронизация файлов Azure, поддержку проверки подлинности Azure AD DS или локальной AD DS?**

    Да, вы можете включить проверку подлинности служб AD DS Azure или локальных AD DS для файлового ресурса, управляемого Синхронизацией файлов Azure. Изменения в списке управления доступом NTFS каталога или файла для локальных файловых серверов будут распределены по уровням в Файлах Azure, и наоборот.

* <a id="ad-aad-smb-files"></a>
**Как проверить, включена ли проверка подлинности AD DS в учетной записи хранения, и получить сведения о домене?**

    Инструкции см. [здесь](./storage-files-identity-ad-ds-enable.md#confirm-the-feature-is-enabled).

* <a id=""></a>
**Поддерживает ли проверка подлинности Azure AD Файлов Azure виртуальные машины Linux?**

    Нет, проверка подлинности с виртуальных машин Linux не поддерживается.

* <a id="ad-multiple-forest"></a>
**Поддерживает ли локальная проверка подлинности AD DS для файловых ресурсов Azure интеграцию со средой AD DS, использующей несколько лесов?**    

    Локальная проверка подлинности AD DS Файлов Azure интегрируется только с лесом доменной службы, в которой зарегистрирована учетная запись хранения. Для поддержки проверки подлинности из другого леса в среде должно быть правильно настроено доверие леса. Способ регистрации файлов Azure в AD DS почти идентичен способу для обычного файлового сервера, где в AD DS для проверки подлинности создается удостоверение (учетная запись входа компьютера или службы). Единственное отличие заключается в том, что зарегистрированное имя субъекта-службы учетной записи хранения заканчивается на "file.core.windows.net", что не соответствует суффиксу домена. Обратитесь к администратору домена, чтобы узнать, требуется ли обновление политики маршрутизации суффиксов, чтобы включить проверку подлинности нескольких лесов из-за другого суффикса домена. Ниже приведен пример, в котором можно настроить политику маршрутизации суффиксов.
    
    Пример. Если пользователи в лесу домена хотят получить доступ к общей папке с учетной записью хранения, зарегистрированной для домена в лесу б, это не будет автоматически работать, так как субъект-служба учетной записи хранения не имеет суффикса, соответствующего суффиксу любого домена в лесу A. Мы можем решить эту проблемы, вручную настроив правило маршрутизации суффикса с леса A на лес B для настраиваемого суффикса "file.core.windows.net".
    Во-первых, необходимо добавить новый настраиваемый суффикс в лесу б. Убедитесь, что у вас есть соответствующие административные разрешения для изменения конфигурации, а затем выполните следующие действия:   
    1. Вход в домен компьютера, присоединенный к лесу б
    2.  Откройте консоль "Active Directory домены и отношения доверия"
    3.  Щелкните правой кнопкой мыши "Active Directory домены и отношения доверия".
    4.  Щелкните "Свойства".
    5.  Щелкните "Добавить".
    6.  Добавить "file.core.windows.net" в качестве суффиксов имени участника-пользователя
    7.  Нажмите кнопку "Применить", а затем "ОК", чтобы закрыть мастер.
    
    Затем добавьте правило маршрутизации суффикса в лесу а, чтобы оно перенаправлялось на лес B.
    1.  Вход в домен компьютера, присоединенный к лесу A
    2.  Откройте консоль "Active Directory домены и отношения доверия"
    3.  Щелкните правой кнопкой мыши домен, к которому требуется получить доступ к общей папке, затем перейдите на вкладку "доверия" и выберите домен в лесу B из исходящих доверий. Если вы еще не настроили доверие между двумя лесами, необходимо сначала настроить доверие.
    4.  Щелкните "Свойства...". затем "Маршрутизация суффикса имен"
    5.  Проверьте, отображается ли суффикс "*. file.core.windows.net". В противном случае щелкните "Обновить".
    6.  Выберите "*. file.core.windows.net", а затем щелкните "включить" и "Применить".

* <a id=""></a>
**Какие регионы доступны для службы файлов Azure AD DS проверки подлинности?**

    Дополнительные сведения см. в разделе [Доступность AD DS в регионах](storage-files-identity-auth-active-directory-enable.md#regional-availability).
    
* <a id="ad-aad-smb-afs"></a>
**Можно ли использовать проверку подлинности Active Directory файлов Azure (AD) для файловых ресурсов, управляемых Синхронизация файлов Azure?**

    Да, вы можете включить проверку подлинности AD DS для файлового ресурса, управляемого Синхронизацией файлов Azure. Изменения в списке управления доступом NTFS каталога или файла для локальных файловых серверов будут распределены по уровням в Файлах Azure, и наоборот.

* <a id="ad-aad-smb-files"></a>
**Есть ли какие-либо различия между созданием учетной записи компьютера или учетной записи входа службы для представления моей учетной записи хранения в AD?**

    Между [учетной записью компьютера](/windows/security/identity-protection/access-control/active-directory-accounts#manage-default-local-accounts-in-active-directory) (по умолчанию) или [учетной записью входа службы](/windows/win32/ad/about-service-logon-accounts) нет разницы с точки зрения работы проверки подлинности с Файлами Azure. Вы можете сами выбрать удобный способ представления учетной записи хранения в качестве удостоверения в среде AD. DomainAccountType (тип учетной записи домена) по умолчанию, установленный в командлете Join-AzStorageAccountForAuth — учетная запись компьютера. Однако срок действия пароля, настроенный в среде AD, может отличаться для учетной записи компьютера или службы. [Обновление пароля удостоверения учетной записи хранения в AD](./storage-files-identity-ad-ds-update-password.md) должно учитывать это.
 
* <a id="ad-support-rest-apis"></a>
**Существуют ли интерфейсы API-интерфейсов RESTFUL для поддержки Get/Set/Copy Directory/File ACL Windows?**

    Да, мы поддерживаем API-интерфейсы REST, которые получают, устанавливают или копируют списки ACL NTFS для каталогов или файлов при использовании API REST [2019-07-07](/rest/api/storageservices/versioning-for-the-azure-storage-services#version-2019-07-07) (или более поздней версии). Мы также поддерживаем сохранение списков ACL Windows в инструментах на основе RESTFUL: [AzCopy v 10.4 +](https://github.com/Azure/azure-storage-azcopy/releases).

## <a name="network-file-system"></a>NFS

* <a id="when-to-use-nfs"></a>
**Когда следует использовать службу файлов Azure NFS?**

    См. раздел [Общие папки NFS (Предварительная версия)](storage-files-compare-protocols.md#nfs-shares-preview).

* <a id="backup-nfs-data"></a>
**Разделы справки данные резервных копий, хранящиеся в общих папках NFS?**

    Резервное копирование данных на общих ресурсах NFS может быть организовано с помощью привычных средств, например rsync или продуктов от одного из наших сторонних партнеров по резервному копированию. Несколько партнеров по резервному копированию, включая [Commvault](https://documentation.commvault.com/commvault/v11/article?p=92634.htm), [Veeam](https://www.veeam.com/blog/?p=123438)и [Veritas](https://players.brightcove.net/4396107486001/default_default/index.html?videoId=6189967101001) , были частью нашей первоначальной предварительной версии и расширяют свои решения для работы с SMB 3,0 и NFS 4,1 для службы файлов Azure.

* <a id="migrate-nfs-data"></a>
**Можно ли перенести существующие данные в общую папку NFS?**

    В пределах региона можно использовать стандартные средства, такие как SCP, rsync или СШФС, для перемещения данных. Так как к службе файлов Azure можно получить доступ из нескольких экземпляров вычислений одновременно, можно улучшить скорость копирования с параллельной передачей. Если вы хотите перенести данные за пределы региона, используйте VPN или Expressroute для подключения к файловой системе из локального центра обработки данных.

## <a name="on-premises-access"></a>Локальный доступ

* <a id="port-445-blocked"></a>
**Мой поставщик услуг Интернета или ИТ-услуг блокирует порт 445, что создает сбой при подключении файлов Azure. Что делать?**

    Вы можете узнать о [различных способах устранения неполадок, связанных с блокированием порта 445, здесь](./storage-troubleshoot-windows-file-connection-problems.md#cause-1-port-445-is-blocked). Служба Файлы Azure разрешает подключения извне региона или центра обработки данных только с помощью SMB 3.0 (с поддержкой шифрования). Протокол SMB 3.0 представил множество функций безопасности, включая шифрование каналов, очень безопасное при использовании через Интернет. Однако возможно, что порт 445 заблокирован из-за исторических причин или уязвимостей, обнаруженных в более ранних версиях SMB. В идеале порт должен быть заблокирован только для трафика SMB 1.0, SMB 1.0 должен быть отключен для всех клиентов.

* <a id="expressroute-not-required"></a>
**Нужно ли использовать Azure ExpressRoute для подключения к службе файлов Azure или использования службы "Синхронизация файлов Azure" локально?**  

    Нет. ExpressRoute не требуется для доступа к общему файловому ресурсу Azure. Если файловый ресурс Azure подключается локально, нужен всего лишь открытый порт 445 (исходящий TCP-порт) для доступа к Интернету (это порт, к которому обращается SMB). При использовании службы синхронизации файлов Azure требуется всего лишь порт 443 (исходящий TCP-порт) для доступа к HTTPS (SMB не требуется). Тем не менее для ExpressRoute вы *можете* использовать любой из этих параметров доступа.

* <a id="mount-locally"></a>
**Как подключить файловый ресурс Azure на локальном компьютере?**  

    Если разрешен исходящий TCP-трафик через порт 445 и клиент (например, Windows 10 или Windows Server 2016) поддерживает протокол SMB 3.0, то подключение к общему файловому ресурсу осуществляется по протоколу SMB. Если порт 445 заблокирован политикой организации или поставщиком услуг Интернета, для доступа к общему файловому ресурсу Azure можно использовать службу синхронизации файлов Azure.

## <a name="backup"></a>Резервное копирование
* <a id="backup-share"></a>
**Как создать резервную копию файлового ресурса Azure?**  
    Вы можете использовать периодически [создаваемые моментальные снимки общих ресурсов](storage-snapshots-files.md) для защиты от случайного удаления. Вы можете воспользоваться AzCopy, RoboCopy или сторонним средством архивации, с помощью которого можно создать резервную копию подключенной общей папки. Служба Azure Backup позволяет создавать резервные копии файлов Azure. Ознакомьтесь с дополнительными сведениями о [резервном копировании файловых ресурсов Azure службой Azure Backup](../../backup/backup-afs.md).

## <a name="share-snapshots"></a>Моментальные снимки общих ресурсов

### <a name="share-snapshots-general"></a>Моментальные снимки общих ресурсов Общие сведения
* <a id="what-are-snaphots"></a>
**Что представляют собой моментальные снимки файловых ресурсов?**  
    Моментальные снимки общих файловых ресурсов Azure позволяют создавать версии общих файловых ресурсов только для чтения. Вы также можете использовать службу файлов Azure, чтобы копировать более старую версию содержимого в тот же общий ресурс, альтернативное расположение в Azure или в локальную среду для дальнейших изменений. Дополнительные сведения о моментальных снимках общего ресурса см. в статье [Обзор моментальных снимков для службы файлов Azure (предварительная версия)](storage-snapshots-files.md).

* <a id="where-are-snapshots-stored"></a>
**Где хранятся мои моментальные снимки общих ресурсов?**  
    Моментальные снимки общего ресурса и сам общий файловый ресурс хранятся в одной и той же учетной записи хранения.

* <a id="snapshot-consistency"></a>
**Согласованы ли моментальные снимки общих ресурсов в разных приложениях?**  
    Нет, моментальные снимки общих ресурсов не согласованы между приложениями. Перед созданием моментального снимка общего ресурса пользователю понадобится очистить операции записи из приложения и перенести их в общий ресурс.

* <a id="snapshot-limits"></a>
**Есть ли ограничения на число моментальных снимков общего ресурса?**  
    Да. Служба файлов Azure позволяет сохранять максимум 200 моментальных снимков общих ресурсов. Моментальные снимки общих ресурсов не учитываются в квоте общих ресурсов, так что общее пространство, занимаемое всеми моментальными снимками общих ресурсов, неограниченно. Ограничения учетной записи хранения по-прежнему применяются. После достижения ограничения в 200 моментальных снимков общих ресурсов вам необходимо удалить старые моментальные снимки, чтобы создать новые.

* <a id="snapshot-cost"></a>
**Сколько нужно платить за моментальные снимки общего ресурса?**  
    Для моментальных снимков действуют стандартные тарифы на транзакции и хранилище. По своей природе моментальные снимки являются добавочными. Базовый моментальный снимок — это сам общий ресурс. Последующие моментальные снимки — добавочные. В них хранятся только отличия от предыдущего моментального снимка. Это означает, что разница в счетах будет минимальной при минимальной обработке рабочей нагрузки. Сведения о тарифах на использование функции "Файлы Azure" уровня "Стандартный" см. на [странице с ценами](https://azure.microsoft.com/pricing/details/storage/files/). Сейчас можно узнать объем пространства, используемый моментальным снимком общего ресурса, сравнив оплачиваемую емкость с используемой. Мы работаем над инструментарием для усовершенствования функции отчетов.

* <a id="ntfs-acls-snaphsots"></a>
**Сохраняются ли списки управления доступом NTFS для каталогов и файлов в моментальных снимках общих ресурсов?**  
    Списки управления доступом NTFS для каталогов и файлов сохраняются в моментальных снимках общих ресурсов.

### <a name="create-share-snapshots"></a>Создание моментальных снимков общих ресурсов
* <a id="file-snaphsots"></a>
**Можно ли создать моментальный снимок общего ресурса для отдельных файлов?**  
    Моментальные снимки общих ресурсов создаются на уровне общего файлового ресурса. Вы можете восстановить отдельные файлы из моментальных снимков общего файлового ресурса, но нельзя создать моментальные снимки общего ресурса на уровне файлов. Тем не менее, если вы создали моментальный снимок общих ресурсов на уровне общего ресурса и требуется перечислить моментальные снимки общих ресурсов, в которых изменился конкретный файл, это можно сделать с помощью компонента **Предыдущие версии** на подключенном общем ресурсе Windows. 
    
    Если вам нужна функция моментального снимка файла, сообщите нам об этом на форуме [UserVoice службы файлов Azure](https://feedback.azure.com/forums/217298-storage/category/180670-files).

* <a id="encrypted-snapshots"></a>
**Можно ли создать моментальные снимки зашифрованного файлового ресурса?**  
    Вы можете сделать моментальный снимок общего ресурса общих файловых ресурсов Azure с включенным шифрованием неактивных данных. Вы можете восстановить файлы из моментального снимка общего ресурса в зашифрованном общем файловом ресурсе. Если общий ресурс зашифрован, его моментальный снимок также будет зашифрован.

* <a id="geo-redundant-snaphsots"></a>
**Являются ли мои моментальные снимки общего ресурса геоизбыточными?**  
    Моментальные снимки общего ресурса имеют ту же избыточность, что и соответствующий общий файловый ресурс Azure. При выборе геоизбыточного хранилища для своей учетной записи данные моментального снимка общего ресурса также будут храниться отдельно в парном регионе.

### <a name="manage-share-snapshots"></a>Управление моментальными снимками общих ресурсов
* <a id="browse-snapshots-linux"></a>
**Можно просмотреть мои моментальные снимки общих ресурсов на компьютере Linux?**  
    Azure CLI позволяет создавать, перечислять, просматривать и восстанавливать моментальные снимки общих ресурсов в Linux.

* <a id="copy-snapshots-to-other-storage-account"></a>
**Можно ли скопировать моментальные снимки общедоступного ресурса в другую учетную запись хранения?**  
    Вы можете скопировать файлы из моментальных снимков общего ресурса в другое расположение, но не сами моментальные снимки общего ресурса.

### <a name="restore-data-from-share-snapshots"></a>Восстановление данных из моментальных снимков общих ресурсов
* <a id="promote-share-snapshot"></a>
**Можно ли повысить уровень моментального снимка общедоступного ресурса до базового общедоступного ресурса?**  
    Вы можете скопировать данные из моментального снимка общего ресурса в любое другое место назначения. Вы не можете повысить уровень моментального снимка общего ресурса до базового общего ресурса.

* <a id="restore-snapshotted-file-to-other-share"></a>
**Можно ли восстановить данные из моментального снимка общего ресурса в другую учетную запись хранения?**  
    Да. Вы можете скопировать файлы из моментального снимка общего ресурса в исходное или альтернативное расположение, включающее ту же или другую учетную запись хранения в том же или другом регионе. Можно также скопировать файлы в локальное расположение или любую другую облачную среду.    
  
### <a name="clean-up-share-snapshots"></a>Удаление моментальных снимков общих ресурсов
* <a id="delete-share-keep-snapshots"></a>
**Можно ли удалить общий ресурс, не удаляя его моментальные снимки?**  
    Вам не удастся удалить общий ресурс, если в нем имеются активные моментальные снимки общего ресурса. Вы можете использовать API для удаления моментальных снимков общего ресурса вместе с ресурсом. Вы также можете удалить моментальные снимки общего ресурса и сам ресурс на портале Azure.

* <a id="delete-share-with-snapshots"></a>
**Что случится с моими моментальными снимками общедоступного ресурса при удалении учетной записи хранения?**  
    При удалении учетной записи хранения также удаляются и моментальные снимки общего ресурса.

## <a name="billing-and-pricing"></a>Выставление счетов и цены
* <a id="vm-file-share-network-traffic"></a>
**Включается ли сетевой трафик между виртуальной машиной и файловыми ресурсами Azure в тарифицируемый трафик подписки?**  
    Если общий файловый ресурс и виртуальная машина находятся в одном регионе Azure, дополнительная оплата за трафик между этим ресурсом и виртуальной машиной отсутствует. Если общий файловый ресурс и виртуальная машина находятся в разных регионах, трафик между ними будет тарифицирован как внешний трафик.

* <a id="share-snapshot-price"></a>
**Сколько нужно платить за моментальные снимки общего ресурса?**  
     При использовании предварительной версии плата за моментальные снимки общего ресурса не взимается. Однако применяется стандартная плата за транзакции и исходящий трафик. После выпуска общедоступной версии для подписок будет взиматься плата за ресурсы и транзакции моментальных снимков общих ресурсов.
     
     По своей природе моментальные снимки общих ресурсов являются добавочными. Базовый моментальный снимок общего ресурса — это сам общий ресурс. Последующие моментальные снимки общего ресурса — добавочные. Они хранят только отличия от предыдущего моментального снимка общего ресурса. Тарифицируется только измененное содержимое. Если общий ресурс содержит 100 ГиБ данных, из которых с момента создания последнего моментального снимка общего ресурса изменилось всего лишь 5 ГиБ, моментальный снимок общего ресурса использует только 5 ГиБ дополнительно, и счет будет выставлен только за 105 ГиБ. Дополнительные сведения о стандартных расходах на транзакции и исходящие данные см. на [странице цен](https://azure.microsoft.com/pricing/details/storage/files/).

## <a name="scale-and-performance"></a>Масштаб и производительность
* <a id="files-scale-limits"></a>
**Каковы ограничения на масштабирование службы файлов Azure?**  
    Дополнительные сведения о целевых показателях масштабируемости и производительности службы файлов Azure см. в статье [Целевые показатели масштабируемости и производительности службы файлов Azure](storage-files-scale-targets.md).

* <a id="need-larger-share"></a>
**Какие размеры доступны для файловых ресурсов Azure?**  
    Размеры файловых ресурсов Azure (премиумных и стандартных) можно увеличивать до 100 ТиБ. См. раздел [Адаптация к более крупным файловым ресурсам (уровень "Стандартный")](storage-files-planning.md#enable-standard-file-shares-to-span-up-to-100-tib) руководства по адаптации к более крупным файловым ресурсам для уровня "Стандартный".

* <a id="lfs-performance-impact"></a>
**Влияет ли увеличение квоты файловых ресурсов на мои рабочие нагрузки или Синхронизацию файлов Azure?**
    
    Нет. Увеличение квоты не влияет на рабочие нагрузки и Синхронизацию файлов Azure.

* <a id="open-handles-quota"></a>
**Сколько клиентов могут одновременно получить доступ к одному файлу?**    
    Установлена квота в 2000 открытых дескрипторов на один файл. По достижении этого ограничения вы увидите соответствующую ошибку.

* <a id="zip-slow-performance"></a>
**При попытке распаковать файлы в службе файлов Azure снижается производительность. Что делать?**  
    Для передачи большого числа файлов в службу файлов Azure мы рекомендуем использовать AzCopy (для Windows, предварительную версию для Linux и UNIX) или Azure PowerShell, так как эти средства оптимизированы для сетевой передачи файлов.

* <a id="slow-perf-windows-81-2012r2"></a>
**Почему после подключения файлового ресурса Azure в Windows Server 2012 R2 или Windows 8.1 снижается производительность?**  
    Имеется известная проблема при подключении файлового ресурса Azure в Windows Server 2012 R2 и Windows 8.1 с накопительным обновлением за апрель 2014 г. для Windows 8.1 и Windows Server 2012 R2. Для достижения оптимальной производительности убедитесь, что на всех экземплярах Windows Server 2012 R2 и Windows 8.1 есть это исправление. (Мы рекомендуем всегда устанавливать все обновления Windows через Центр обновления Windows.) Дополнительные сведения см. в соответствующей статье базы знаний Майкрософт [Slow performance when you access Azure Files from Windows 8.1 or Server 2012 R2](https://support.microsoft.com/kb/3114025) (Снижение производительности при доступе к службе файлов Azure из Windows 8.1 или Server 2012 R2).

## <a name="features-and-interoperability-with-other-services"></a>Функции и совместимость с другими службами
* <a id="cluster-witness"></a>
**Можно ли использовать файловый ресурс Azure в качестве *файлового ресурса-свидетеля* для отказоустойчивого кластера Windows Server?**  
    Сейчас такая конфигурация не поддерживается для общего файлового ресурса Azure. Дополнительные сведения о способах настройки этой возможности для хранилища BLOB-объектов Azure см. в статье [Deploy a Cloud Witness for a Failover Cluster](/windows-server/failover-clustering/deploy-cloud-witness) (Развертывание облака-свидетеля для отказоустойчивого кластера).

* <a id="containers"></a>
**Можно ли подключить файловый ресурс Azure на экземпляре контейнера Azure?**  
    Да, файловые ресурсы Azure оптимальны для сохранения сведений после истечения времени существования экземпляра контейнера. Дополнительные сведения см. в статье [Подключение файлового ресурса Azure с помощью Экземпляров контейнеров Azure](../../container-instances/container-instances-volume-azure-files.md).

* <a id="rest-rename"></a>
**Существует ли операция переименования в REST API?**  
    На данный момент нет.

* <a id="nested-shares"></a>
**Могу ли я настроить вложенные общие ресурсы? Другими словами — файловый ресурс в файловом ресурсе?**  
    Нет. Общая папка *является* виртуальным драйвером для подключения, поэтому вложенные общие папки не поддерживаются.

* <a id="ibm-mq"></a>
**Как использовать службу файлов Azure с IBM MQ?**  
    Компания IBM выпустила руководство по настройке службы файлов Azure в службе, которую используют пользователи IBM MQ. Дополнительные сведения см. в статье [How to setup IBM MQ Multi instance queue manager with Microsoft Azure File Service](https://github.com/ibm-messaging/mq-azure/wiki/How-to-setup-IBM-MQ-Multi-instance-queue-manager-with-Microsoft-Azure-File-Service) (Настройка службы файлов Microsoft Azure в многоэкземплярном диспетчере очередей IBM MQ).

## <a name="see-also"></a>См. также раздел
* [Устранение неполадок службы файлов Azure в Windows](storage-troubleshoot-windows-file-connection-problems.md)
* [Устранение неполадок службы файлов Azure в Linux](storage-troubleshoot-linux-file-connection-problems.md)
* [Устранение неполадок службы "Синхронизация файлов Azure"](storage-sync-files-troubleshoot.md)