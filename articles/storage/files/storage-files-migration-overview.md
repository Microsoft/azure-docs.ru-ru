---
title: Переход на общие папки Azure
description: Узнайте о миграции в файловые ресурсы Azure и найдите свое руководством по миграции.
author: fauhse
ms.service: storage
ms.topic: conceptual
ms.date: 3/18/2020
ms.author: fauhse
ms.subservice: files
ms.openlocfilehash: 27056f39885949d52c9fcc0d1472033cfc8f9aa0
ms.sourcegitcommit: e6de1702d3958a3bea275645eb46e4f2e0f011af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102554876"
---
# <a name="migrate-to-azure-file-shares"></a>Переход на общие папки Azure

В этой статье рассматриваются основные аспекты миграции в файловые ресурсы Azure.

Эта статья содержит основные сведения о миграции и таблицу руководств по миграции. Эти руководства помогут переместить файлы в файловые ресурсы Azure. Руководства организованы в зависимости от того, где находятся ваши данные и какая модель развертывания (только облачная или гибридная), куда вы перемещаетесь.

## <a name="migration-basics"></a>Основы миграции

Azure имеет несколько доступных типов облачного хранилища. Фундаментальным аспектом миграции файлов в Azure является определение того, какой вариант хранилища Azure подходит для ваших данных.

[Файловые ресурсы Azure](storage-files-introduction.md) подходят для файловых данных общего назначения. Эти данные включают в себя все, что вы используете локальную общую папку SMB или NFS для. С помощью [Синхронизация файлов Azure](storage-sync-files-planning.md)можно кэшировать содержимое нескольких файловых ресурсов Azure на серверах, работающих под управлением Windows Server в локальной среде.

Для приложения, которое в данный момент выполняется на локальном сервере, может быть хорошим выбором хранение файлов в общей папке Azure. Вы можете переместить приложение в Azure и использовать общие файловые ресурсы Azure в качестве общего хранилища. Для этого сценария можно также использовать [диски Azure](../../virtual-machines/managed-disks-overview.md) .

Некоторые облачные приложения не зависят от протокола SMB или локального доступа к данным или общего доступа на компьютере. Для этих приложений лучше всего подходит хранилище объектов, такое как [большие двоичные объекты Azure](../blobs/storage-blobs-overview.md) .

Ключом в любой миграции является фиксация всех применимых файлов при перемещении файлов из текущего места хранения в Azure. Степень точности, которую поддерживает служба хранилища Azure, и объем, который требуется вашему сценарию, также поможет вам выбрать подходящую службу хранилища Azure. Файловые данные общего назначения обычно зависят от метаданных файла. Данные приложения могут не быть.

Ниже приведены два основных компонента файла.

- **Поток данных**: поток данных файла хранит содержимое файла.
- **Метаданные файла**: метаданные файла имеют следующие компоненты:
   * Атрибуты файла, например "только для чтения"
   * Разрешения для файлов, которые могут называться *разрешениями NTFS* или *ACL для файлов и папок* .
   * Метки времени, в особенности создание и изменение времени последнего изменения
   * Альтернативный поток данных, который является пространством для хранения больших объемов нестандартных свойств

Точность файла в миграции может быть определена как возможность:

- Сохраните все применимые сведения о файлах в источнике.
- Перенесите файлы с помощью средства миграции.
- Храните файлы в целевом хранилище миграции.

Чтобы обеспечить бесперебойную миграцию, найдите [оптимальное средство копирования](#migration-toolbox) в соответствии с вашими потребностями и сопоставьте целевой объект хранилища с источником.

Принимая во внимание приведенные выше сведения, вы видите, что целевое хранилище для файлов общего назначения в Azure — это [файловые ресурсы Azure](storage-files-introduction.md).

В отличие от хранилища объектов в больших двоичных объектах Azure, файловый ресурс Azure может хранить метаданные файлов в собственном формате. Файловые ресурсы Azure также сохраняют иерархию, атрибуты и разрешения для файлов и папок. Разрешения NTFS могут храниться в файлах и папках, так как они находятся в локальной среде.

Пользователь Active Directory, который является своим локальным контроллером домена, может получить собственный доступ к файловому ресурсу Azure. Таким образом, пользователь может Azure Active Directory доменных служб (Azure AD DS). Каждый из них использует свое текущее удостоверение для получения доступа на основе разрешений на общий доступ и списков ACL для файлов и папок. Такое поведение аналогично тому, как пользователь соединяется с локальной общей папкой.

Альтернативный поток данных — это основной аспект точности файла, который в настоящее время не может храниться в файле в общей папке Azure. Он сохраняется локально при использовании Синхронизация файлов Azure.

Узнайте больше о [проверке подлинности Azure AD](storage-files-identity-auth-active-directory-enable.md) и [аутентификации Azure AD DS](storage-files-identity-auth-active-directory-domain-service-enable.md) для файловых ресурсов Azure.

## <a name="migration-guides"></a>Руководства по переносу

В следующей таблице приведены подробные руководства по миграции.

Как использовать таблицу:

1. Откройте строку для исходной системы, в которой хранятся файлы в данный момент.

1. Выберите одну из следующих целей:

   - Гибридное развертывание с использованием Синхронизация файлов Azure для кэширования содержимого файловых ресурсов Azure в локальной среде
   - Общие файловые ресурсы Azure в облаке

   Выберите целевой столбец, соответствующий вашему выбору.

1. В пределах пересечения исходного и целевого объектов в ячейке таблицы перечислены доступные сценарии миграции. Выберите один из них, чтобы напрямую перейти к подробному руководству по миграции.

Сценарий без ссылки еще не содержит опубликованного руководств по миграции. Периодически проверяйте эту таблицу на наличие обновлений. Новые руководства будут опубликованы, когда они станут доступны.

| Источник | Цель: </br>Гибридное развертывание | Цель: </br>Развертывание только в облаке |
|:---|:--|:--|
| | Сочетание инструментов:| Сочетание инструментов: |
| Windows Server 2012 R2 и более поздние версии | <ul><li>[Синхронизация файлов Azure](storage-sync-files-deployment-guide.md)</li><li>[Синхронизация файлов Azure и Azure Датабокс](storage-sync-offline-data-transfer.md)</li></ul> | <ul><li>Через Robocopy к подключенному файловому ресурсу Azure</li><li>Via Синхронизация файлов Azure</li></ul> |
| Windows Server 2012 и более ранние версии | <ul><li>Через Датабокс и Синхронизация файлов Azure до последней серверной ОС</li><li>С помощью службы миграции хранилища на последний сервер с Синхронизация файлов Azure, а затем отправьте</li></ul> | <ul><li>С помощью службы миграции хранилища на последний сервер с Синхронизация файлов Azure</li><li>Через Robocopy к подключенному файловому ресурсу Azure</li></ul> |
| Хранилище, подключенное к сети (NAS) | <ul><li>[Через Синхронизация файлов Azureную отправку](storage-files-migration-nas-hybrid.md)</li><li>[Через Датабокс + Синхронизация файлов Azure](storage-files-migration-nas-hybrid-databox.md)</li></ul> | <ul><li>Через Robocopy к подключенному файловому ресурсу Azure</li></ul> |
| Linux/Samba | <ul><li>[Синхронизация файлов Azure и Robocopy](storage-files-migration-linux-hybrid.md)</li></ul> | <ul><li>Через Robocopy к подключенному файловому ресурсу Azure</li></ul> |
| Microsoft Azure StorSimple облачном устройстве 8100 или облачном устройстве StorSimple 8600 | <ul><li>[Через выделенную облачную службу переноса данных](storage-files-migration-storsimple-8000.md)</li></ul> | |
| Облачное устройство StorSimple 1200 | <ul><li>[Via Синхронизация файлов Azure](storage-files-migration-storsimple-1200.md)</li></ul> | |

## <a name="migration-toolbox"></a>Панель элементов миграции

### <a name="file-copy-tools"></a>Средства копирования файлов

Существует несколько средств копирования файлов, доступных в корпорации Майкрософт и других. Чтобы выбрать подходящий инструмент для сценария миграции, необходимо учитывать следующие фундаментальные вопросы.

* Поддерживает ли средство исходные и целевые расположения для копирования файлов?

* Поддерживает ли средство сетевой путь или доступные протоколы (например, службы RESTFUL, SMB или NFS) между исходным и целевым расположением хранилища?

* Сохраняет ли инструмент требуемое качество файла, поддерживаемое исходным и целевым расположениями?

    В некоторых случаях целевое хранилище не поддерживает ту же точность, что и источник. Если целевое хранилище достаточно для ваших потребностей, оно должно соответствовать только возможностям целевого файла.

* Есть ли у средства функции, которые позволяют обеспечить соответствие стратегии миграции?

    Например, рассмотрим, позволяет ли средство сократить время простоя.
    
    Если средство поддерживает параметр для отражения источника в целевой объект, часто его можно запускать несколько раз в одном и том же исходном и целевом источнике, пока источник остается доступным.

    При первом запуске средства копируется основная часть данных. Этот начальный запуск может быть последним. Он часто длится дольше, чем требуется для перевода источника данных в автономный режим для бизнес-процессов.

    При зеркальном отображении источника на целевой объект (как в случае с **Robocopy/мир**) можно запустить средство еще раз для того же источника и целевого объекта. Запуск выполняется гораздо быстрее, так как ему необходимо передавать только изменения источника, происходящие после предыдущего запуска. При таком запуске средство копирования может значительно сократить время простоя.

В следующей таблице приведены средства Майкрософт и их текущее пригодность для файловых ресурсов Azure.

| Рекомендуемая | Инструмент | Поддержка файловых ресурсов Azure | Сохранение точности файла |
| :-: | :-- | :---- | :---- |
|![Да, рекомендуется](media/storage-files-migration-overview/circle-green-checkmark.png)| RoboCopy | Поддерживается. Файловые ресурсы Azure можно подключить как сетевые диски. | Полная точность. * |
|![Да, рекомендуется](media/storage-files-migration-overview/circle-green-checkmark.png)| Синхронизация файлов Azure | Встроенная интегрирована в файловые ресурсы Azure. | Полная точность. * |
|![Да, рекомендуется](media/storage-files-migration-overview/circle-green-checkmark.png)| Служба миграции хранилища | Непрямое поддержка. Файловые ресурсы Azure можно подключить как сетевые диски на целевых серверах SMS. | Полная точность. * |
|![Да, рекомендуется](media/storage-files-migration-overview/circle-green-checkmark.png)| AzCopy </br>Версия 10,6 | Поддерживается. | Не поддерживает копию корневого списка ACL исходного кода, в противном случае — полную точность. * </br>[Узнайте, как использовать AzCopy с файловыми ресурсами Azure](../common/storage-use-azcopy-files.md) |
|![Да, рекомендуется](media/storage-files-migration-overview/circle-green-checkmark.png)| Data Box | Поддерживается. | Датабокс полностью поддерживает метаданные. |
|![Не полностью рекомендуется](media/storage-files-migration-overview/triangle-yellow-exclamation.png)| Обозреватель службы хранилища Azure </br>Версия 1,14 | Поддерживается. | Не копирует списки ACL. Поддерживает метки времени.  |
|![Не рекомендуется](media/storage-files-migration-overview/circle-red-x.png)| Фабрика данных Azure | Поддерживается. | Не копирует метаданные. |
|||||

*\* Полная точность: соответствует или превышает возможности общего доступа к файлам Azure.*

### <a name="migration-helper-tools"></a>Средства поддержки миграции

В этом разделе описываются средства, помогающие спланировать и запустить миграцию.

#### <a name="robocopy-from-microsoft-corporation"></a>Robocopy от корпорации Майкрософт

Robocopy — это одно из средств, наиболее применимых к миграции файлов. Она входит в состав Windows. Основная [Документация по Robocopy](/windows-server/administration/windows-commands/robocopy) является полезным ресурсом для многих вариантов этого инструмента.

#### <a name="treesize-from-jam-software-gmbh"></a>TreeSize от ЗАСТРЯВШей программы GmbH

Синхронизация файлов Azure масштабируется преимущественно с числом элементов (файлов и папок), а не с общим объемом хранилища. Средство TreeSize позволяет определить количество элементов на томах Windows Server.

С помощью этого средства можно создать перспективу перед [развертыванием Синхронизация файлов Azure](storage-sync-files-deployment-guide.md). Его также можно использовать, если распределение по уровням облака выполняется после развертывания. В этом случае вы увидите количество элементов и каталоги, в которых наиболее часто используется серверный кэш.

Проверенная версия средства — версия 4.4.1. Он совместим с облачными файлами. При нормальной работе средство не вызывает отзыв многоуровневых файлов.

## <a name="next-steps"></a>Дальнейшие действия

1. Создайте план, для которого требуется развертывание файловых ресурсов Azure (только для облачных или гибридных).
1. Ознакомьтесь со списком доступных руководств по миграции, чтобы найти подробное руководство, соответствующее источнику и развертыванию файловых ресурсов Azure.

Дополнительные сведения о технологиях службы файлов Azure, указанных в этой статье:

* [Общие сведения о общей папке Azure](storage-files-introduction.md)
* [Планирование развертывания службы синхронизации файлов Azure (предварительная версия)](storage-sync-files-planning.md)
* [Синхронизация файлов Azure: распределение по уровням облака](storage-sync-cloud-tiering-overview.md)