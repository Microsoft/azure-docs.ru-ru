---
title: Выберите способ авторизации доступа к данным BLOB-объектов в портал Azure
titleSuffix: Azure Storage
description: При доступе к данным большого двоичного объекта с помощью портал Azure портал выполняет запросы к службе хранилища Azure. Эти запросы к службе хранилища Azure могут пройти проверку подлинности и авторизоваться с помощью учетной записи Azure AD или ключа доступа к учетной записи хранения.
services: storage
author: tamram
ms.service: storage
ms.topic: how-to
ms.date: 02/10/2021
ms.author: tamram
ms.reviewer: ozgun
ms.subservice: blobs
ms.custom: contperf-fy21q1
ms.openlocfilehash: 319bbdd7809e224ca608fdac06d4b304c2052e86
ms.sourcegitcommit: d4734bc680ea221ea80fdea67859d6d32241aefc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100391547"
---
# <a name="choose-how-to-authorize-access-to-blob-data-in-the-azure-portal"></a>Выберите способ авторизации доступа к данным BLOB-объектов в портал Azure

При доступе к данным большого двоичного объекта с помощью [портал Azure](https://portal.azure.com)портал выполняет запросы к службе хранилища Azure. Запрос к службе хранилища Azure можно авторизовать с помощью учетной записи Azure AD или ключа доступа к учетной записи хранения. Портал указывает, какой метод используется, и позволяет переключаться между ними, если у вас есть соответствующие разрешения.  

Можно также указать способ авторизации отдельной операции передачи больших двоичных объектов в портал Azure. По умолчанию на портале используется любой метод, который вы уже используете для авторизации операции передачи BLOB-объекта, но вы можете изменить этот параметр при отправке большого двоичного объекта.

## <a name="permissions-needed-to-access-blob-data"></a>Разрешения, необходимые для доступа к данным большого двоичного объекта

В зависимости от того, как вы хотите авторизовать доступ к данным большого двоичного объекта в портал Azure, вам потребуются определенные разрешения. В большинстве случаев эти разрешения предоставляются через Управление доступом на основе ролей Azure (Azure RBAC). Дополнительные сведения об Azure RBAC см. в статье [что такое управление доступом на основе ролей Azure (Azure RBAC)](../../role-based-access-control/overview.md).

### <a name="use-the-account-access-key"></a>Использование ключа доступа к учетной записи

Чтобы получить доступ к данным большого двоичного объекта с помощью ключа доступа к учетной записи, необходимо назначить роль Azure, которая включает действие Azure RBAC **(Microsoft. Storage/storageAccounts/listkeys/действие**). Эта роль Azure может быть встроенной или настраиваемой ролью. Встроенные роли, поддерживающие **Microsoft. Storage, storageAccounts/listkeys/Action** , включают:

- Роль [владельца](../../role-based-access-control/built-in-roles.md#owner) Azure Resource Manager
- Роль [участника](../../role-based-access-control/built-in-roles.md#contributor) Azure Resource Manager
- Роль [участника учетной записи хранения](../../role-based-access-control/built-in-roles.md#storage-account-contributor)

При попытке получить доступ к данным большого двоичного объекта в портал Azure на портале сначала проверяется, была ли назначена роль с помощью **Microsoft. Storage/storageAccounts/listkeys/Action**. Если вы назначили роль с этим действием, портал использует ключ учетной записи для доступа к данным большого двоичного объекта. Если вы не назначили роль с этим действием, портал пытается получить доступ к данным с помощью учетной записи Azure AD.

> [!IMPORTANT]
> Если учетная запись хранения заблокирована с блокировкой Azure Resource Manager **только для чтения** , операция " [список ключей](/rest/api/storagerp/storageaccounts/listkeys) " не разрешена для этой учетной записи хранения. **Список ключей** является операцией POST, и все операции POST предотвращаются, если для учетной записи настроена блокировка **только для чтения** . По этой причине, если учетная запись заблокирована с блокировкой **только для чтения** , пользователи должны использовать учетные данные Azure AD для доступа к данным большого двоичного объекта на портале. Сведения о доступе к данным большого двоичного объекта на портале с помощью Azure AD см. в статье [Использование учетной записи Azure AD](#use-your-azure-ad-account).

> [!NOTE]
> Администратор службы роли администратора классической подписки и Co-Administrator включает в себя эквивалент роли [владельца](../../role-based-access-control/built-in-roles.md#owner) Azure Resource Manager. Роль **владелец** включает все действия, включая **Microsoft. Storage/storageAccounts/listkeys/Action**, поэтому пользователь с одной из этих административных ролей также может получать доступ к данным большого двоичного объекта с помощью ключа учетной записи. Дополнительные сведения см. в статье [Роли классического администратора подписки, роли Azure и роли администратора Azure AD](../../role-based-access-control/rbac-and-directory-admin-roles.md#classic-subscription-administrator-roles).

### <a name="use-your-azure-ad-account"></a>Использование учетной записи Azure AD

Чтобы получить доступ к данным большого двоичного объекта из портал Azure с помощью учетной записи Azure AD, для вас должны быть справедливы обе следующие инструкции:

- Вы назначили роль [читателя](../../role-based-access-control/built-in-roles.md#reader) Azure Resource Manager как минимум на уровне учетной записи хранения или выше. Роль **читателя** предоставляет наиболее ограниченные разрешения, но также приемлема другая роль Azure Resource Manager, которая предоставляет доступ к ресурсам управления учетной записью хранения.
- Вам была назначена встроенная или пользовательская роль, предоставляющая доступ к данным большого двоичного объекта.

Назначение роли **читателя** или другое назначение роли Azure Resource Manager необходимо для того, чтобы пользователь мог просматривать ресурсы управления учетной записью хранения и переходить по ним в портал Azure. Роли Azure, предоставляющие доступ к данным BLOB-объектов, не предоставляют доступ к ресурсам управления учетной записью хранения. Чтобы получить доступ к данным большого двоичного объекта на портале, пользователю нужны разрешения для навигации по ресурсам учетной записи хранения. Дополнительные сведения об этом требовании см. [в разделе Назначение роли читателя для доступа к порталу](../common/storage-auth-aad-rbac-portal.md#assign-the-reader-role-for-portal-access).

Встроенные роли, поддерживающие доступ к данным большого двоичного объекта, включают:

- [Владелец данных большого двоичного объекта службы хранилища](../../role-based-access-control/built-in-roles.md#storage-blob-data-owner): для управления доступом POSIX для Azure Data Lake Storage 2-го поколения.
- [Участник данных BLOB-объектов хранилища](../../role-based-access-control/built-in-roles.md#storage-blob-data-contributor): разрешения на чтение, запись и удаление для больших двоичных объектов.
- [Модуль чтения данных большого двоичного объекта хранилища](../../role-based-access-control/built-in-roles.md#storage-blob-data-reader): разрешения только на чтение для больших двоичных объектов.

Пользовательские роли могут поддерживать различные сочетания тех же разрешений, которые предоставляются встроенными ролями. Дополнительные сведения о создании пользовательских ролей Azure см. в статьях [пользовательские роли Azure](../../role-based-access-control/custom-roles.md) и [Определение ролей для ресурсов Azure](../../role-based-access-control/role-definitions.md).

> [!IMPORTANT]
> Предварительная версия Обозреватель службы хранилища в портал Azure не поддерживает использование учетных данных Azure AD для просмотра и изменения BLOB-объектов. Обозреватель службы хранилища в портал Azure всегда использует ключи учетной записи для доступа к данным. Чтобы использовать Обозреватель службы хранилища в портал Azure, необходимо назначить роль, включающую **Microsoft. Storage/storageAccounts/listkeys/Action**.

## <a name="navigate-to-blobs-in-the-azure-portal"></a>Перейдите к BLOB-объектам в портал Azure

Чтобы просмотреть данные большого двоичного объекта на портале, перейдите к **обзору** учетной записи хранения и щелкните ссылки для **больших двоичных объектов**. Кроме того, можно переходить к разделу **Служба BLOB-объектов** в меню.

:::image type="content" source="media/anonymous-read-access-configure/blob-public-access-portal.png" alt-text="Снимок экрана, показывающий, как переходить к данным большого двоичного объекта в портал Azure":::

## <a name="determine-the-current-authentication-method"></a>Определение текущего метода проверки подлинности

При переходе к контейнеру портал Azure указывает, используется ли в настоящее время ключ доступа к учетной записи или учетная запись Azure AD для проверки подлинности.

### <a name="authenticate-with-the-account-access-key"></a>Проверка подлинности с помощью ключа доступа учетной записи

Если проверка подлинности выполняется с помощью ключа доступа к учетной записи, вы увидите **ключ доступа** , указанный в качестве метода проверки подлинности на портале:

:::image type="content" source="media/authorize-data-operations-portal/auth-method-access-key.png" alt-text="Снимок экрана с пользовательским доступом к контейнерам с помощью ключа учетной записи":::

Чтобы переключиться на использование учетной записи Azure AD, щелкните ссылку, выделенную на изображении. При наличии соответствующих разрешений через назначенные вам роли Azure вы сможете продолжать работу. Однако если у вас нет нужных разрешений, появится сообщение об ошибке следующего вида:

:::image type="content" source="media/authorize-data-operations-portal/auth-error-azure-ad.png" alt-text="Ошибка отображается, если учетная запись Azure AD не поддерживает доступ":::

Обратите внимание, что в списке нет BLOB-объектов, если у вашей учетной записи Azure AD нет разрешений на их просмотр. Щелкните ссылку **Переключение на ключ доступа** , чтобы снова использовать ключ доступа для проверки подлинности.

### <a name="authenticate-with-your-azure-ad-account"></a>Пройдите проверку подлинности с учетной записью Azure AD.

Если вы выполняете проверку подлинности с помощью учетной записи Azure AD, вы увидите на портале **учетную запись пользователя Azure AD** , указанную в качестве метода проверки подлинности:

:::image type="content" source="media/authorize-data-operations-portal/auth-method-azure-ad.png" alt-text="Снимок экрана с пользовательским доступом к контейнерам с помощью учетной записи Azure AD":::

Чтобы переключиться на использование ключа доступа к учетной записи, щелкните ссылку, выделенную на изображении. Если у вас есть доступ к ключу учетной записи, вы сможете продолжать работу. Однако если у вас отсутствует доступ к ключу учетной записи, вы увидите сообщение об ошибке следующего вида:

:::image type="content" source="media/authorize-data-operations-portal/auth-error-access-key.png" alt-text="Если у вас нет доступа к ключу учетной записи, отображается ошибка":::

Обратите внимание, что в списке нет BLOB-объектов, если у вас нет доступа к ключам учетной записи. Щелкните ссылку **Переключение на учетную запись пользователя Azure AD** , чтобы снова использовать учетную запись Azure AD для проверки подлинности.

## <a name="specify-how-to-authorize-a-blob-upload-operation"></a>Укажите способ авторизации операции передачи BLOB-объекта

При отправке большого двоичного объекта из портал Azure можно указать, следует ли выполнять проверку подлинности и авторизовать эту операцию с помощью ключа доступа к учетной записи или учетных данных Azure AD. По умолчанию на портале используется текущий метод проверки подлинности, как показано в [подокне определение текущего метода проверки подлинности](#determine-the-current-authentication-method).

Чтобы указать способ авторизации операции передачи BLOB-объекта, выполните следующие действия.

1. В портал Azure перейдите к контейнеру, куда нужно отправить большой двоичный объект.
1. Нажмите кнопку **Отправить**.
1. Разверните раздел **Дополнительно** , чтобы отобразить дополнительные свойства большого двоичного объекта.
1. В поле **тип проверки подлинности** укажите, следует ли авторизовать операцию отправки с помощью учетной записи Azure AD или ключа доступа к учетной записи, как показано на следующем рисунке:

    :::image type="content" source="media/authorize-data-operations-portal/auth-blob-upload.png" alt-text="Снимок экрана, показывающий, как изменить метод авторизации при передаче BLOB-объекта":::

## <a name="next-steps"></a>Следующие шаги

- [Проверка подлинности доступа к BLOB-объектам и очередям Azure с помощью Azure Active Directory](../common/storage-auth-aad.md)
- [Назначение роли Azure для доступа к большим двоичным объектам и данным очереди с помощью портала Azure](../common/storage-auth-aad-rbac-portal.md)
- [Используйте Azure CLI, чтобы назначить роль Azure для доступа к данным BLOB-объектов и очередей.](../common/storage-auth-aad-rbac-cli.md)
- [Использование модуля Azure PowerShell для назначения роли Azure доступа к данным BLOB-объектов и очередей](../common/storage-auth-aad-rbac-powershell.md)
