---
title: Области шифрования для хранилища BLOB-объектов
description: Области шифрования обеспечивают возможность управлять шифрованием на уровне контейнера или отдельного большого двоичного объекта. Области шифрования можно использовать для создания безопасных границ между данными, которые находятся в одной учетной записи хранения, но принадлежат разным клиентам.
services: storage
author: tamram
ms.service: storage
ms.date: 03/26/2021
ms.topic: conceptual
ms.author: tamram
ms.reviewer: ozgun
ms.subservice: common
ms.openlocfilehash: 16a600d7caf65f880ffb5c2a2abfe5a9774a7795
ms.sourcegitcommit: c8b50a8aa8d9596ee3d4f3905bde94c984fc8aa2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/28/2021
ms.locfileid: "105640457"
---
# <a name="encryption-scopes-for-blob-storage"></a>Области шифрования для хранилища BLOB-объектов

Области шифрования позволяют управлять шифрованием с помощью ключа, относящегося к контейнеру или отдельному большому двоичному объекту. Области шифрования можно использовать для создания безопасных границ между данными, которые находятся в одной учетной записи хранения, но принадлежат разным клиентам.

Дополнительные сведения о работе с областями шифрования см. в разделе [Создание областей шифрования и управление ими](encryption-scope-manage.md).

[!INCLUDE [storage-data-lake-gen2-support](../../../includes/storage-data-lake-gen2-support.md)]

## <a name="how-encryption-scopes-work"></a>Как работают области шифрования

По умолчанию учетная запись хранения шифруется с помощью ключа, относящегося ко всей учетной записи хранения. При определении области шифрования указывается ключ, который может быть ограничен контейнером или отдельным BLOB-объектом. При применении к большому двоичному объекту области шифрования большой двоичный объект шифруется с помощью этого ключа. Когда область шифрования применяется к контейнеру, она выступает в качестве области по умолчанию для больших двоичных объектов в этом контейнере, чтобы все большие двоичные объекты, передаваемые в этот контейнер, могли быть зашифрованы с помощью одного ключа. Контейнер может быть настроен для принудительного применения области шифрования по умолчанию для всех больших двоичных объектов в контейнере или для разрешения передачи отдельного большого двоичного объекта в контейнер с областью шифрования, отличной от используемой по умолчанию.

Операции чтения большого двоичного объекта, созданного с использованием области шифрования, происходят прозрачно, пока область шифрования не отключена.

### <a name="key-management"></a>Управление ключами

При определении области шифрования можно указать, защищена ли область с помощью ключа, управляемого корпорацией Майкрософт, или с помощью управляемого клиентом ключа, который хранится в Azure Key Vault. Различные области шифрования в одной и той же учетной записи хранения могут использовать управляемые корпорацией Майкрософт ключи. Также можно переключить тип ключа, используемый для защиты области шифрования от управляемого клиентом ключа до ключа, управляемого Майкрософт, или наоборот в любое время. Дополнительные сведения о ключах, управляемых клиентом, см. в разделе [управляемые клиентом ключи для шифрования службы хранилища Azure](../common/customer-managed-keys-overview.md). Дополнительные сведения о ключах, управляемых корпорацией Майкрософт, см. в разделе [сведения об управлении ключами шифрования](../common/storage-service-encryption.md#about-encryption-key-management).

Если вы определяете область шифрования с помощью ключа, управляемого клиентом, то можете обновить версию ключа автоматически или вручную. Если вы решили автоматически обновлять версию ключа, служба хранилища Azure проверяет хранилище ключей или управляемый модуль HSM ежедневно для новой версии ключа, управляемого клиентом, и автоматически обновляет ключ до последней версии. Дополнительные сведения об обновлении версии ключа для управляемого клиентом ключа см. [в разделе Обновление версии ключа](../common/customer-managed-keys-overview.md#update-the-key-version).

Учетная запись хранения может иметь до 10 000 областей шифрования, защищенных ключами, управляемыми клиентом, для которых версия ключа обновляется автоматически. Если в вашей учетной записи хранения уже есть 10 000 областей шифрования, которые защищены автоматически обновляемыми ключами, управляемыми клиентом, необходимо вручную обновить ключ для всех дополнительных областей шифрования, защищенных с помощью управляемых клиентом ключей.  

### <a name="encryption-scopes-for-containers-and-blobs"></a>Области шифрования для контейнеров и больших двоичных объектов

При создании контейнера можно указать область шифрования по умолчанию для больших двоичных объектов, которые впоследствии будут переданы в этот контейнер. При указании области шифрования по умолчанию для контейнера можно выбрать способ применения области шифрования по умолчанию.

- Можно потребовать, чтобы все большие двоичные объекты, отправленные в контейнер, использовали область шифрования по умолчанию. В этом случае каждый большой двоичный объект в контейнере шифруется с помощью того же ключа.
- Можно позволить клиенту переопределить область шифрования по умолчанию для контейнера, чтобы можно было передать большой двоичный объект с областью шифрования, отличной от области по умолчанию. В этом случае большие двоичные объекты в контейнере могут быть зашифрованы с помощью разных ключей.

В следующей таблице перечислены действия, выполняемые при передаче большого двоичного объекта в зависимости от настройки области шифрования по умолчанию для контейнера.

| Область шифрования, определенная для контейнера, —... | Отправка большого двоичного объекта с областью шифрования по умолчанию... | Отправка большого двоичного объекта с областью шифрования, отличной от области по умолчанию... |
|--|--|--|
| Область шифрования по умолчанию с разрешенными переопределениями | Выполняется | Выполняется |
| Область шифрования по умолчанию с запрещенными переопределениями | Выполняется | Сбои |

Для контейнера во время создания контейнера необходимо указать область шифрования по умолчанию.

Если для контейнера не указана область шифрования по умолчанию, можно передать большой двоичный объект, используя любую область шифрования, определенную для учетной записи хранения. Область шифрования должна быть указана во время передачи большого двоичного объекта.

## <a name="disabling-an-encryption-scope"></a>Отключение области шифрования

При отключении области шифрования все последующие операции чтения или записи, выполненные с помощью области шифрования, завершатся ошибкой HTTP с кодом 403 (запрещено). При повторном включении области шифрования операции чтения и записи будут выполняться нормально.

Если область шифрования отключена, плата за нее больше не взимается. Отключите все области шифрования, которые не требуются, чтобы избежать ненужных расходов.

Если область шифрования защищена с помощью ключа, управляемого клиентом, и вы удалите ключ в хранилище ключей, данные станут недоступными. Не забудьте также отключить область шифрования, чтобы избежать оплаты за нее.

Помните, что управляемые клиентом ключи защищаются с помощью обратимого удаления и очистки защиты в хранилище ключей, а удаленный ключ зависит от поведения, определенного для этих свойств. Дополнительные сведения см. в одном из следующих разделов документации по Azure Key Vault:

- [Как использовать обратимое удаление в Key Vault с помощью PowerShell](../../key-vault/general/key-vault-recovery.md)
- [Как использовать обратимое удаление в Key Vault с помощью интерфейса командной строки](../../key-vault/general/key-vault-recovery.md)

> [!IMPORTANT]
> Невозможно удалить область шифрования.

## <a name="next-steps"></a>Дальнейшие шаги

- [Шифрование службы хранилища Azure для неактивных данных](../common/storage-service-encryption.md)
- [Создание областей шифрования и управление ими](encryption-scope-manage.md)
- [Управляемые клиентом ключи для шифрования службы хранилища Azure](../common/customer-managed-keys-overview.md)
- [Что такое хранилище ключей Azure?](../../key-vault/general/overview.md)