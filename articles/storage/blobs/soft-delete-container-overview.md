---
title: Обратимое удаление для контейнеров (Предварительная версия)
titleSuffix: Azure Storage
description: Обратимое удаление для контейнеров (Предварительная версия) обеспечивает защиту данных, позволяя легко восстанавливать данные при ошибочном изменении или удалении приложения или другого пользователя учетной записи хранения.
services: storage
author: tamram
ms.service: storage
ms.topic: conceptual
ms.date: 03/05/2021
ms.author: tamram
ms.subservice: blobs
ms.custom: references_regions
ms.openlocfilehash: f157b44e92289d0e9c5b88108550c144344c5206
ms.sourcegitcommit: f7eda3db606407f94c6dc6c3316e0651ee5ca37c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "102211147"
---
# <a name="soft-delete-for-containers-preview"></a>Обратимое удаление для контейнеров (Предварительная версия)

Обратимое удаление для контейнеров (Предварительная версия) защищает данные от случайного или злонамеренного удаления. Если для учетной записи хранения включено обратимое удаление контейнера, все удаленные контейнеры и их содержимое сохраняются в службе хранилища Azure в течение заданного периода. В течение срока хранения можно восстановить ранее удаленные контейнеры. Восстановление контейнера восстанавливает все большие двоичные объекты в этом контейнере при его удалении.

Чтобы обеспечить сквозную защиту данных больших двоичных объектов, корпорация Майкрософт рекомендует включить следующие функции защиты данных:

- Обратимое удаление контейнера для восстановления удаленного контейнера. Дополнительные сведения о включении обратимого удаления контейнера см. в разделе [Включение обратимого удаления контейнеров и управление ими](soft-delete-container-enable.md).
- Управление версиями BLOB-объектов для автоматического обслуживания предыдущих версий большого двоичного объекта. Если управление версиями BLOB-объектов включено, можно восстановить более раннюю версию большого двоичного объекта, чтобы восстановить данные, если они ошибочно изменены или удалены. Сведения о включении управления версиями BLOB-объектов см. в разделе [Включение управления версиями BLOB-объектов и управление ими](versioning-enable.md).
- Обратимое удаление BLOB-объекта для восстановления удаленного большого двоичного объекта или версии. Сведения о включении обратимого удаления BLOB-объектов см. в разделе [Включение обратимого удаления больших двоичных объектов и управление ими](soft-delete-blob-enable.md).

> [!IMPORTANT]
> Обратимое удаление контейнера сейчас находится на **этапе предварительной версии**. Ознакомьтесь с [дополнительными условиями использования Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/) предварительных версий для юридических условий, которые относятся к функциям Azure, которые доступны в бета-версии, предварительном просмотре или еще не включены в общедоступную версию.

## <a name="how-container-soft-delete-works"></a>Как работает обратимое удаление контейнера

При включении обратимого удаления контейнера можно указать срок хранения для удаленных контейнеров в диапазоне от 1 до 365 дней. Срок хранения по умолчанию составляет 7 дней. В течение срока хранения удаленный контейнер можно восстановить, вызвав операцию **восстановления контейнера** .

При восстановлении контейнера также восстанавливаются большие двоичные объекты контейнера и любые версии BLOB-объектов. Однако обратимое удаление контейнера можно использовать только для восстановления больших двоичных объектов, если сам контейнер был удален. Чтобы восстановить удаленный большой двоичный объект, если его родительский контейнер не был удален, необходимо использовать обратимое удаление BLOB-объектов или управление версиями BLOB-объектов.

На следующей схеме показано, как можно восстановить удаленный контейнер при включенном обратимом удалении контейнера.

:::image type="content" source="media/soft-delete-container-overview/container-soft-delete-diagram.png" alt-text="Диаграмма, показывающая, как можно восстановить контейнер обратимого удаления":::

При восстановлении контейнера его можно восстановить до исходного имени, если это имя не было использовано повторно. Если исходное имя контейнера было использовано, можно восстановить контейнер с новым именем.

По истечении срока хранения контейнер удаляется из хранилища Azure без возможности восстановления и не может быть восстановлен. Часы начинаются с периода хранения в момент удаления контейнера. Вы можете изменить срок хранения в любое время, но помните, что обновленный срок хранения применяется только к вновь удаленным контейнерам. Ранее удаленные контейнеры будут окончательно удалены в зависимости от срока хранения, который действовал на момент удаления контейнера.

Отключение обратимого удаления контейнера не приводит к окончательному удалению контейнеров, которые ранее были обратимо удалены. Все контейнеры обратимого удаления будут окончательно удалены по истечении срока хранения, который действовал на момент удаления контейнера.

> [!IMPORTANT]
> Обратимое удаление контейнера не защищает от удаления учетной записи хранения, но только для удаления контейнеров в этой учетной записи. Чтобы защитить учетную запись хранения от удаления, Настройте блокировку для ресурса учетной записи хранения. Дополнительные сведения о блокировке ресурсов Azure Resource Manager см. [в разделе Блокировка ресурсов для предотвращения непредвиденных изменений](../../azure-resource-manager/management/lock-resources.md).

## <a name="about-the-preview"></a>Сведения о предварительной версии

Обратимое удаление контейнера доступно в предварительной версии во всех регионах Azure.

REST API службы хранилища Azure версии 2019-12-12 или более поздней поддерживает обратимое удаление контейнера.

### <a name="storage-account-support"></a>Поддержка учетных записей хранения

Обратимое удаление контейнера доступно для следующих типов учетных записей хранения:

- Учетные записи хранения общего назначения версии 2 и v1
- Блокировать учетные записи хранения BLOB-объектов
- Учетные записи хранения BLOB-объектов

Также поддерживаются учетные записи хранения с иерархическим пространством имен, разрешенным для использования с Azure Data Lake Storage 2-го поколения.

### <a name="register-for-the-preview"></a>Зарегистрируйтесь для использования предварительной версии

Чтобы зарегистрироваться в предварительной версии для обратимого удаления контейнера, используйте PowerShell или Azure CLI, чтобы отправить запрос на регистрацию этой функции в подписке. После утверждения запроса можно включить обратимое удаление контейнера с помощью любого нового или существующего общего назначения, хранилища BLOB-объектов или учетных записей хранения блочных BLOB-объектов уровня "Премиум".

# <a name="powershell"></a>[PowerShell](#tab/powershell)

Чтобы зарегистрироваться в PowerShell, вызовите команду [Register-азпровидерфеатуре](/powershell/module/az.resources/register-azproviderfeature) .

```powershell
# Register for container soft delete (preview)
Register-AzProviderFeature -ProviderNamespace Microsoft.Storage `
    -FeatureName ContainerSoftDelete

# Refresh the Azure Storage provider namespace
Register-AzResourceProvider -ProviderNamespace Microsoft.Storage
```

# <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

Чтобы зарегистрироваться в Azure CLI, вызовите команду [AZ Feature Register](/cli/azure/feature#az-feature-register) .

```azurecli
az feature register --namespace Microsoft.Storage --name ContainerSoftDelete
az provider register --namespace 'Microsoft.Storage'
```

---

### <a name="check-the-status-of-your-registration"></a>Проверка состояния регистрации

Чтобы проверить состояние регистрации, используйте PowerShell или Azure CLI.

# <a name="powershell"></a>[PowerShell](#tab/powershell)

Чтобы проверить состояние регистрации с помощью PowerShell, вызовите команду [Get-азпровидерфеатуре](/powershell/module/az.resources/get-azproviderfeature) .

```powershell
Get-AzProviderFeature -ProviderNamespace Microsoft.Storage -FeatureName ContainerSoftDelete
```

# <a name="azure-cli"></a>[Azure CLI](#tab/azure-cli)

Чтобы проверить состояние регистрации с помощью Azure CLI, вызовите команду [AZ Feature](/cli/azure/feature#az-feature-show) .

```azurecli
az feature show --namespace Microsoft.Storage --name ContainerSoftDelete
```

---

## <a name="pricing-and-billing"></a>Цены и выставление счетов

Для включения обратимого удаления контейнера дополнительная плата не взимается. Счета за данные в обратимо удаленных контейнерах выставляются по той же ставке, что и активные данные.

## <a name="next-steps"></a>Дальнейшие действия

- [Настройка обратимого удаления контейнера](soft-delete-container-enable.md)
- [Обратимое удаление для больших двоичных объектов](soft-delete-blob-overview.md)
- [Управление версиями BLOB-объектов](versioning-overview.md)
