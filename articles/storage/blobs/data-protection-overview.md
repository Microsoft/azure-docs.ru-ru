---
title: Общие сведения о защите данных
titleSuffix: Azure Storage
description: Возможности защиты данных, доступные для хранилища BLOB-объектов и Azure Data Lake Storage 2-го поколения данных, позволяют защитить данные от удаления или перезаписи. Если необходимо восстановить данные, которые были удалены или перезаписаны, это поможет вам выбрать вариант восстановления, который лучше подходит для вашего сценария.
services: storage
author: tamram
ms.service: storage
ms.date: 03/22/2021
ms.topic: conceptual
ms.author: tamram
ms.reviewer: prishet
ms.subservice: common
ms.openlocfilehash: afd98e629500bc90cc9ddd1ed4ab2472f733e845
ms.sourcegitcommit: ba3a4d58a17021a922f763095ddc3cf768b11336
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2021
ms.locfileid: "104803799"
---
# <a name="data-protection-overview"></a>Общие сведения о защите данных

Служба хранилища Azure обеспечивает защиту данных для хранилища BLOB-объектов и Azure Data Lake Storage 2-го поколения, помогая подготовиться к сценариям, в которых необходимо восстановить данные, которые были удалены или перезаписаны. Важно подумать о том, как лучше защитить данные до возникновения инцидента, который может нарушить его работу. Это руководство поможет вам заранее определить, какие функции защиты данных требуются вашему сценарию, и как их реализовать. Если необходимо восстановить данные, которые были удалены или перезаписаны, в этом обзоре также приводятся рекомендации по выполнению действий в зависимости от сценария.

В документации по службе хранилища Azure *Защита данных* относится к стратегиям защиты учетной записи хранения и данных в ней от удаления или изменения, а также для восстановления данных после их удаления или изменения. Служба хранилища Azure также предлагает варианты *аварийного восстановления*, включая несколько уровней избыточности для защиты данных от простоев служб из-за проблем с оборудованием или естественных аварий, а также управляемой клиентом отработки отказа в случае, если центр обработки данных в основном регионе становится недоступным. Дополнительные сведения о защите данных от простоев служб см. в разделе [Аварийное восстановление](#disaster-recovery).

## <a name="recommendations-for-basic-data-protection"></a>Рекомендации по базовой защите данных

Если вы ищете базовое покрытие защиты данных для вашей учетной записи хранения и содержащихся в ней данных, то корпорация Майкрософт рекомендует выполнить следующие действия, начиная с:

- Настройте блокировку Azure Resource Manager для учетной записи хранения, чтобы защитить учетную запись от удаления или изменения конфигурации. [Подробнее...](../common/lock-account-resource.md)
- Включите обратимое удаление контейнера для учетной записи хранения, чтобы восстановить удаленный контейнер и его содержимое. [Подробнее...](soft-delete-container-enable.md)
- Сохраняйте состояние большого двоичного объекта через равные промежутки времени:
  - Для рабочих нагрузок хранилища BLOB-объектов включите управление версиями BLOB-объектов, чтобы автоматически сохранять данные о состоянии при каждом удалении или перезаписи большого двоичного объекта. [Подробнее...](versioning-enable.md)
  - Для Azure Data Lake Storage рабочих нагрузок сделайте моментальные снимки вручную, чтобы сохранить состояние данных в определенный момент времени. [Подробнее...](snapshots-overview.md)

Эти параметры, а также дополнительные параметры защиты данных для других сценариев более подробно описаны в следующем разделе.

Общие сведения о затратах, связанных с этими функциями, см. в разделе [Сводка по затратам](#summary-of-cost-considerations).

## <a name="overview-of-data-protection-options"></a>Общие сведения о вариантах защиты данных

В следующей таблице перечислены параметры, доступные в службе хранилища Azure для распространенных сценариев защиты данных. Выберите сценарии, применимые к вашей ситуации, чтобы узнать больше о доступных параметрах. Обратите внимание, что в настоящее время для учетных записей хранения с включенным иерархическим пространством имен доступны не все функции.

| Сценарий | Data Protection, параметр | Рекомендации | Преимущество защиты | Доступно для Data Lake Storage |
|--|--|--|--|--|
| Запрет удаления или изменения учетной записи хранения. | Блокировка Azure Resource Manager<br />[Подробнее...](../common/lock-account-resource.md) | Блокировка всех учетных записей хранения с блокировкой Azure Resource Manager, чтобы предотвратить удаление учетной записи хранения. | Защищает учетную запись хранения от изменений при удалении или изменении конфигурации.<br /><br />Не защищает контейнеры или большие двоичные объекты в учетной записи от удаления или перезаписи. | Да |
| Запрещает удаление или изменение контейнера и его больших двоичных объектов в течение заданного интервала. | Политика неизменности в контейнере<br />[Подробнее...](storage-blob-immutable-storage.md) | Установите в контейнере политику неизменности для защиты критически важных для бизнеса документов, например, чтобы удовлетворить законодательные или нормативные требования соответствия. | Защищает контейнер и его большие двоичные объекты от всех операций удаления и перезаписи.<br /><br />Если действует юридическая блокировка или заблокированная политика хранения на основе времени, учетная запись хранения также защищена от удаления. Контейнеры, для которых не задана политика неизменности, не защищены от удаления. | Да, в предварительной версии |
| Восстановление удаленного контейнера в течение указанного интервала. | Обратимое удаление контейнера (Предварительная версия)<br />[Подробнее...](soft-delete-container-overview.md) | Включите обратимое удаление контейнера для всех учетных записей хранения с минимальным интервалом хранения в 7 дней.<br /><br />Включите управление версиями больших двоичных объектов и обратимое удаление BLOB-объектов вместе с обратимым удалением контейнера для защиты отдельных больших двоичных объектов в контейнере.<br /><br />Храните контейнеры, для которых требуются разные периоды хранения, в отдельных учетных записях хранения. | Удаленный контейнер и его содержимое можно восстановить в течение срока хранения.<br /><br />Восстановить можно только операции уровня контейнера (например, [удалить контейнер](/rest/api/storageservices/delete-container)). Обратимое удаление контейнера не позволяет восстановить отдельный большой двоичный объект в контейнере, если этот BLOB-объект удален. | Да, в предварительной версии |
| Автоматически сохранять состояние большого двоичного объекта в предыдущей версии при перезапись или удалении. | Управление версиями BLOB-объектов<br />[Подробнее...](versioning-overview.md) | Включите управление версиями BLOB-объектов вместе с обратимым удалением контейнера и обратимым удалением BLOB-объектов для учетных записей хранения, где требуется оптимальная защита данных больших двоичных объектов.<br /><br />Хранение данных большого двоичного объекта, не требующих управления версиями в отдельной учетной записи для ограничения затрат. | Каждая операция перезаписи или удаления большого двоичного объекта создает новую версию. Большой двоичный объект можно восстановить из предыдущей версии, если большой двоичный объект удален или перезаписан. | Нет |
| Восстановление удаленного большого двоичного объекта или версии BLOB-объекта в течение указанного интервала. | Обратимое удаление BLOB-объекта<br />[Подробнее...](soft-delete-blob-overview.md) | Включите обратимое удаление BLOB-объектов для всех учетных записей хранения с минимальным интервалом хранения в 7 дней.<br /><br />Включите управление версиями BLOB-объектов и обратимое удаление контейнеров вместе с обратимым удалением BLOB-объектов для оптимизации защиты данных больших двоичных объектов.<br /><br />Храните большие двоичные объекты, для которых требуются разные сроки хранения, в отдельных учетных записях хранения. | Удаленная версия большого двоичного объекта или большого двоичного объекта может быть восстановлена в течение срока хранения. | Нет |
| Восстановление набора блочных BLOB-объектов до предыдущей точки во времени. | Восстановление на момент времени<br />[Подробнее...](point-in-time-restore-overview.md) | Чтобы использовать восстановление на момент времени для возврата к более раннему состоянию, разработайте приложение для удаления отдельных блочных BLOB-объектов вместо удаления контейнеров. | Набор блочных BLOB-объектов может быть возвращен в свое состояние в определенной точке в прошлом.<br /><br />Отменяются только операции, выполняемые с блочными BLOB-объектами. Любые операции, выполняемые над контейнерами, страничные BLOB-объекты или добавочные большие двоичные объекты, не возвращаются. | Нет |
| Вручную сохранить состояние большого двоичного объекта в определенный момент времени. | Моментальный снимок большого двоичного объекта<br />[Подробнее...](snapshots-overview.md) | Рекомендуется в качестве альтернативы управления версиями больших двоичных объектов, если управление версиями не подходит для вашего сценария, из-за затрат или других соображений, а также если в учетной записи хранения включено иерархическое пространство имен. | Большой двоичный объект можно восстановить из моментального снимка, если большой двоичный объект перезаписывается. При удалении большого двоичного объекта моментальные снимки также удаляются. | Да, в предварительной версии |
| Большой двоичный объект можно удалить или перезазаписать, но данные регулярно копируются во вторую учетную запись хранения. | Выполните откат собственного решения для копирования данных во вторую учетную запись с помощью репликации объектов службы хранилища Azure или средства, например AzCopy или фабрики данных Azure. | Рекомендуется для обеспечения защиты от непредвиденных намеренных действий или непредсказуемых ситуаций.<br /><br />Создайте вторую учетную запись хранения в том же регионе, что и первичная учетная запись, чтобы избежать выплат за исходящий трафик. | Данные можно восстановить из второй учетной записи хранения, если основная учетная запись может быть скомпрометирована каким-либо образом. | AzCopy и фабрика данных Azure поддерживаются.<br /><br />Репликация объектов не поддерживается. |

## <a name="data-protection-by-resource-type"></a>Защита данных по типу ресурса

В следующей таблице перечислены варианты защиты данных службы хранилища Azure в соответствии с ресурсами, которые они защищают.

| Data Protection, параметр | Защищает учетную запись от удаления | Защищает контейнер от удаления | Защищает большой двоичный объект от удаления | Защищает большой двоичный объект от перезаписи |
|--|--|--|--|--|
| Блокировка Azure Resource Manager | Да | Нет<sup>1</sup> | Нет | Нет |
| Политика неизменности в контейнере | Да<sup>2</sup> | Да | Да | Да |
| Обратимое удаление контейнера | Нет | Да | Нет | Нет |
| Управление версиями BLOB-объектов<sup>3</sup> | Нет | Нет | Да | Да |
| Обратимое удаление BLOB-объекта<sup>3</sup> | Нет | Нет | Да | Да |
| Восстановление до точки во времени<sup>3</sup> | Нет | Нет | Да | Да |
| Моментальный снимок большого двоичного объекта | Нет | Нет | Нет | Да |
| Выполните откат своего решения для копирования данных во вторую учетную запись<sup>4</sup> | Нет | Да | Да | Да |

<sup>1</sup> блокировка Azure Resource Manager не защищает контейнер от удаления.<br />
<sup>2</sup> , если для контейнера действует юридическая блокировка или заблокированная политика хранения на основе времени, учетная запись хранения также защищена от удаления.<br />
<sup>3</sup> в настоящее время не поддерживается для рабочих нагрузок Data Lake Storage.<br />
<sup>4</sup> AzCopy и фабрика данных Azure — это параметры, которые поддерживаются для рабочих нагрузок хранилища BLOB-объектов и Data Lake Storage. Репликация объектов поддерживается только для рабочих нагрузок хранилища BLOB-объектов.<br />

## <a name="recover-deleted-or-overwritten-data"></a>Восстановление удаленных или перезаписанных данных

Если необходимо восстановить данные, которые были перезаписаны или удалены, то, как это делается, зависит от того, какие параметры защиты данных включены и какие ресурсы были затронуты. В следующей таблице описаны действия, которые можно предпринять для восстановления данных.

| Удаленный или перезаписанный ресурс | Возможные действия по восстановлению | Требования к восстановлению |
|--|--|--|
| Учетная запись хранения | Попытка восстановления удаленной учетной записи хранения<br />[Подробнее...](../common/storage-account-recover.md) | Учетная запись хранения изначально была создана с помощью модели развертывания Azure Resource Manager и была удалена за последние 14 дней. Новая учетная запись хранения с тем же именем не была создана, так как исходная учетная запись была удалена. |
| Контейнер | Восстановление обратимо удаленного контейнера и его содержимого<br />[Подробнее...](soft-delete-container-enable.md) | Обратимое удаление контейнера включено, и срок хранения обратимого удаления контейнера еще не истек. |
| Контейнеры и BLOB-объекты | Восстановление данных из второй учетной записи хранения | Все операции с контейнерами и BLOB-объектами были эффективно реплицированы во вторую учетную запись хранения. |
| Большой двоичный объект (любой тип) | Восстановление большого двоичного объекта из предыдущей версии<sup>1</sup><br />[Подробнее...](versioning-enable.md) | Управление версиями BLOB-объектов включено, и у большого двоичного объекта есть одна или несколько предыдущих версий. |
| Большой двоичный объект (любой тип) | Восстановление обратимо удаленного большого двоичного объекта<sup>1</sup><br />[Подробнее...](soft-delete-blob-enable.md) | Обратимое удаление BLOB-объекта включено, и срок хранения обратимого удаления не истек. |
| Большой двоичный объект (любой тип) | Восстановление большого двоичного объекта из моментального снимка<br />[Подробнее...](snapshots-manage-dotnet.md) | Большой двоичный объект имеет один или несколько моментальных снимков. |
| Набор блочных BLOB-объектов | Восстановление набора блочных BLOB-объектов до своего состояния в более ранней точке во времени<sup>1</sup><br />[Подробнее...](point-in-time-restore-manage.md) | Восстановление до точки во времени включено, а точка восстановления находится в пределах интервала хранения. Учетная запись хранения не была скомпрометирована или повреждена. |
| Версия BLOB-объекта | Восстановление обратимо удаленных версий<sup>1</sup><br />[Подробнее...](soft-delete-blob-enable.md) | Обратимое удаление BLOB-объекта включено, и срок хранения обратимого удаления не истек. |

<sup>1</sup> в настоящее время не поддерживается для рабочих нагрузок Data Lake Storage.

## <a name="summary-of-cost-considerations"></a>Сводка по соображениям затрат

В следующей таблице приводятся общие сведения о затратах для различных параметров защиты данных, описанных в этом пошаговом руководству.

| Data Protection, параметр | Рекомендации по затратам |
|-|-|
| Блокировка Azure Resource Manager для учетной записи хранения | Не взимается Настройка блокировки учетной записи хранения. |
| Политика неизменности в контейнере | Не взимается плата за настройку политики неизменности в контейнере. |
| Обратимое удаление контейнера | Не взимается плата за включение обратимого удаления контейнера для учетной записи хранения. Данные в обратимо удаленном контейнере выставляются по той же ставке, что и активные данные, пока контейнер обратимого удаления не будет окончательно удален. |
| Управление версиями BLOB-объектов | Не взимается плата за включение управления версиями BLOB-объектов для учетной записи хранения. После включения управления версиями BLOB-объектов каждая операция записи или удаления в большом двоичном объекте в учетной записи создает новую версию, что может привести к увеличению затрат на ресурсы.<br /><br />Плата за версию большого двоичного объекта взимается на основе уникальных блоков или страниц. Таким образом, затраты увеличиваются, так как базовый большой двоичный объект сходится от определенной версии. Изменение уровня BLOB-объекта или версии большого двоичного объекта может оказать влияние на выставление счетов. Дополнительные сведения см. в разделе [цены и выставление счетов](versioning-overview.md#pricing-and-billing).<br /><br />Используйте управление жизненным циклом для удаления старых версий по мере необходимости для контроля затрат. Дополнительные сведения см. в разделе [Оптимизация затрат путем автоматизации уровней доступа к хранилищу BLOB-объектов Azure](storage-lifecycle-management-concepts.md). |
| Обратимое удаление BLOB-объекта | Не взимается плата за включение обратимого удаления BLOB-объектов для учетной записи хранения. Данные в обратимо удаленном большом двоичном объекте выставляются по той же ставке, что и активные данные, до тех пор, пока не будет окончательно удален Обратимо удаленный BLOB-объект. |
| Восстановление на момент времени | Не взимается плата за включение восстановления на момент времени для учетной записи хранения; Однако включение восстановления на момент времени также позволяет использовать управление версиями BLOB-объектов, обратимое удаление и канал изменений, каждый из которых может привести к дополнительным издержкам.<br /><br />При выполнении операции восстановления выставляются счета за восстановление до точки во времени. Стоимость операции восстановления зависит от объема восстанавливаемых данных. Дополнительные сведения см. в разделе [цены и выставление счетов](point-in-time-restore-overview.md#pricing-and-billing). |
| Моментальные снимки BLOB-объектов | Счета за данные в моментальном снимке выставляются на основе уникальных блоков или страниц. Таким образом, затраты увеличиваются, так как базовый большой двоичный объект сходится от моментального снимка. Изменение уровня большого двоичного объекта или моментального снимка может оказать влияние на выставление счетов. Дополнительные сведения см. в разделе [цены и выставление счетов](snapshots-overview.md#pricing-and-billing).<br /><br />Используйте управление жизненным циклом, чтобы удалить старые моментальные снимки по мере необходимости для контроля затрат. Дополнительные сведения см. в разделе [Оптимизация затрат путем автоматизации уровней доступа к хранилищу BLOB-объектов Azure](storage-lifecycle-management-concepts.md). |
| Копирование данных во вторую учетную запись хранения | Обслуживание данных во второй учетной записи хранения влечет за собой стоимость ресурсов и транзакций. Если вторая учетная запись хранения находится в регионе, отличном от региона исходной учетной записи, то при копировании данных в эту вторую учетную запись также будет взиматься плата за исходящий трафик. |

## <a name="disaster-recovery"></a>Аварийное восстановление

Служба хранилища Azure всегда поддерживает несколько копий данных, чтобы защитить их от запланированных и незапланированных событий, включая временные сбои оборудования, сети или перебои электроэнергии, а также крупномасштабные стихийные бедствия. Избыточность гарантирует, что ваша учетная запись хранения будет соответствовать целям доступности и устойчивости даже в случае сбоев. Дополнительные сведения о настройке высокой доступности учетной записи хранения см. в статье [избыточность службы хранилища Azure](../common/storage-redundancy.md).

В случае сбоя в центре обработки данных, если ваша учетная запись хранения является избыточной по двум географическим регионам (геоизбыточное хранилище), вы можете выполнить отработку отказа учетной записи из основного региона в дополнительный. Дополнительные сведения см. в статье [Аварийное восстановление и отработка отказа учетной записи хранения](../common/storage-disaster-recovery-guidance.md).

Управляемая клиентом отработка отказа в настоящее время не поддерживается для учетных записей хранения с включенным иерархическим пространством имен. Дополнительные сведения см. [в разделе функции хранилища BLOB-объектов, доступные в Azure Data Lake Storage 2-го поколения](data-lake-storage-supported-blob-storage-features.md).

## <a name="next-steps"></a>Следующие шаги

- [Репликация службы хранилища Azure](../common/storage-redundancy.md)
- [Аварийное восстановление и отработка отказа учетной записи хранения](../common/storage-disaster-recovery-guidance.md)
