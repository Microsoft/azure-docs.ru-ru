---
title: Шифрование службы хранилища Azure для неактивных данных
description: Служба хранилища Azure защищает данные, автоматически шифруя их перед сохранением в облаке. Вы можете использовать ключи, управляемые корпорацией Майкрософт, для шифрования данных в учетной записи хранения или управлять шифрованием с помощью собственных ключей.
services: storage
author: tamram
ms.service: storage
ms.date: 09/17/2020
ms.topic: conceptual
ms.author: tamram
ms.reviewer: ozgun
ms.subservice: common
ms.openlocfilehash: b2471ccd2a412c7cbae9d4e59412ac055697e3d7
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102180366"
---
# <a name="azure-storage-encryption-for-data-at-rest"></a>Шифрование службы хранилища Azure для неактивных данных

Служба хранилища Azure использует шифрование на стороне сервера (SSE) для автоматического шифрования данных при их сохранении в облаке. Шифрование службы хранилища Azure защищает ваши данные и помогает удовлетворить ваши обязательства по обеспечению безопасности и соответствия требованиям Организации.

## <a name="about-azure-storage-encryption"></a>О шифровании службы хранилища Azure

Данные в службе хранилища Azure шифруются и расшифровываются прозрачно с использованием 256-разрядного [шифрования AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard), одним из наиболее подданных блоков блочных шифров и совместимым с FIPS 140-2. Шифрование службы хранилища Azure аналогично шифрованию BitLocker в Windows.

Шифрование службы хранилища Azure включено для всех учетных записей хранения, включая как диспетчер ресурсов, так и классические учетные записи хранения. Шифрование службы хранилища Azure не может быть отключено. Поскольку данные защищены по умолчанию, вам не нужно изменять код или приложения, чтобы воспользоваться преимуществами шифрования службы хранилища Azure.

Данные в учетной записи хранения шифруются независимо от уровня производительности ("Стандартный" или "Премиум"), уровня доступа ("горячий" или "холодного") или модели развертывания (Azure Resource Manager или классической версии). Все большие двоичные объекты на уровне архива также шифруются. Все параметры избыточности службы хранилища Azure поддерживают шифрование, и все данные в основном и дополнительном регионах шифруются при включенной георепликации. Все ресурсы службы хранилища Azure шифруются, включая большие двоичные объекты, диски, файлы, очереди и таблицы. Все метаданные объекта также шифруются. Дополнительные затраты на шифрование службы хранилища Azure отсутствуют.

Каждый блочный большой двоичный объект, добавочный большой двоичный объект или страничный BLOB-объект, записанный в службу хранилища Azure после 20 октября 2017, шифруется. Большие двоичные объекты, созданные до этой даты, продолжают шифроваться фоновым процессом. Чтобы принудительно выполнить шифрование большого двоичного объекта, созданного до 20 октября 2017, можно переписать большой двоичный объект. Сведения о проверке состояния шифрования большого двоичного объекта см. в разделе [Проверка состояния шифрования большого двоичного](../blobs/storage-blob-encryption-status.md)объекта.

Дополнительные сведения о криптографических модулях, лежащих в основе шифрования службы хранилища Azure, см. в разделе [API шифрования: следующее поколение](/windows/desktop/seccng/cng-portal).

Сведения о шифровании и управлении ключами для управляемых дисков Azure см. в статье [Шифрование управляемых дисков Azure на стороне сервера](../../virtual-machines/disk-encryption.md).

## <a name="about-encryption-key-management"></a>Об управлении ключами шифрования

По умолчанию данные в новой учетной записи хранения шифруются с помощью ключей, управляемых корпорацией Майкрософт. Вы можете продолжать использовать ключи, управляемые корпорацией Майкрософт, для шифрования данных, а также управлять шифрованием с помощью собственных ключей. Если вы решили управлять шифрованием с помощью собственных ключей, у вас есть два варианта. Можно использовать любой из типов управления ключами или и то, и другое.

- Вы можете указать *ключ, управляемый клиентом* , который будет использоваться для шифрования и расшифровки данных в хранилище BLOB-объектов и в службе файлов Azure. <sup>1, 2 ключи,</sup> управляемые клиентом, должны храниться в Azure Key Vault или Azure Key Vault управляемой аппаратной модели безопасности (HSM) (в предварительной версии). Дополнительные сведения о ключах, управляемых клиентом, см. в статье [Использование управляемых клиентом ключей для шифрования службы хранилища Azure](./customer-managed-keys-overview.md).
- Вы можете указать *предоставленный клиентом ключ* для операций с хранилищем BLOB-объектов. Клиент, выполняющий запрос на чтение или запись к хранилищу BLOB-объектов, может включать ключ шифрования в запрос, чтобы детально контролировать способ шифрования и расшифровки данных BLOB-объектов. Дополнительные сведения о ключах, предоставляемых клиентом, см. в разделе [Указание ключа шифрования для запроса к хранилищу BLOB-объектов](../blobs/encryption-customer-provided-keys.md).

В следующей таблице сравниваются параметры управления ключами для шифрования службы хранилища Azure.

| Параметр управления ключами | Ключи, управляемые Майкрософт | Ключи, управляемые клиентом | Ключи, предоставляемые клиентом |
|--|--|--|--|
| Операции шифрования и расшифровки | Azure | Azure | Azure |
| Поддерживаемые службы хранилища Azure | Все | Хранилище BLOB-объектов, файлы Azure<sup>1, 2</sup> | Хранилище BLOB-объектов |
| Хранилище ключей | Хранилище ключей (Майкрософт) | Azure Key Vault или Key Vault HSM | Собственное хранилище ключей клиента |
| Ответственность за смену ключей | Microsoft | Клиент | Клиент |
| Управление ключами | Microsoft | Клиент | Клиент |

<sup>1</sup> сведения о создании учетной записи, поддерживающей использование управляемых клиентом ключей с хранилищем очередей, см. в разделе [Создание учетной записи, которая поддерживает управляемые клиентом ключи для очередей](account-encryption-key-create.md?toc=%2fazure%2fstorage%2fqueues%2ftoc.json).<br />
<sup>2</sup> дополнительные сведения о создании учетной записи, поддерживающей использование управляемых клиентом ключей с хранилищем таблиц, см. в разделе [Создание учетной записи, которая поддерживает управляемые клиентом ключи для таблиц](account-encryption-key-create.md?toc=%2fazure%2fstorage%2ftables%2ftoc.json).

> [!NOTE]
> Ключи, управляемые корпорацией Майкрософт, поворачиваются соответствующим образом в соответствии с требованиями. Если у вас есть особые требования к смене ключей, корпорация Майкрософт рекомендует перейти на управляемые клиентом ключи, чтобы вы могли самостоятельно управлять вращением и проводить аудит.

## <a name="doubly-encrypt-data-with-infrastructure-encryption"></a>Удвоение шифрования данных с помощью шифрования инфраструктуры

Клиенты, которым требуется высокий уровень защиты данных, могут также включить 256-разрядное шифрование AES на уровне инфраструктуры службы хранилища Azure. Если включено шифрование инфраструктуры, данные в учетной записи хранения шифруются дважды &mdash; на уровне службы и один раз на уровне инфраструктуры &mdash; с двумя различными алгоритмами шифрования и двумя разными ключами. Двойное шифрование данных службы хранилища Azure позволяет защититься от ситуации, когда один из алгоритмов шифрования или ключей может быть скомпрометирован. В этом сценарии дополнительный уровень шифрования сохраняется для защиты данных.

Шифрование на уровне службы поддерживает использование ключей, управляемых корпорацией Майкрософт, или ключей, управляемых клиентом, с помощью Azure Key Vault. Шифрование на уровне инфраструктуры основано на ключах, управляемых корпорацией Майкрософт, и всегда использует отдельный ключ.

Дополнительные сведения о создании учетной записи хранения, которая обеспечивает шифрование инфраструктуры, см. в разделе [Создание учетной записи хранения с включенным шифрованием инфраструктуры для двойного шифрования данных](infrastructure-encryption-enable.md).

## <a name="encryption-scopes-for-blob-storage-preview"></a>Области шифрования для хранилища BLOB-объектов (Предварительная версия)

По умолчанию учетная запись хранения шифруется с помощью ключа, относящегося к учетной записи хранения. Вы можете использовать ключи, управляемые корпорацией Майкрософт, или управляемые клиентом ключи, хранящиеся в Azure Key Vault, чтобы защитить и контролировать доступ к ключу, который шифрует ваши данные.

Области шифрования позволяют при необходимости управлять шифрованием на уровне контейнера или отдельного большого двоичного объекта. Области шифрования можно использовать для создания безопасных границ между данными, которые находятся в одной учетной записи хранения, но принадлежат разным клиентам.

Вы можете создать одну или несколько областей шифрования для учетной записи хранения с помощью поставщика ресурсов службы хранилища Azure. При создании области шифрования указывается, защищена ли область с помощью ключа, управляемого корпорацией Майкрософт, или с помощью ключа, управляемого клиентом, который хранится в Azure Key Vault. Различные области шифрования в одной и той же учетной записи хранения могут использовать управляемые корпорацией Майкрософт ключи.

После создания области шифрования можно указать эту область шифрования в запросе для создания контейнера или большого двоичного объекта. Дополнительные сведения о создании области шифрования см. в статье [Создание и управление областями шифрования (Предварительная версия)](../blobs/encryption-scope-manage.md).

> [!NOTE]
> Области шифрования не поддерживаются с учетными записями геоизбыточного хранилища с доступом на чтение (RA-GRS) и доступом на чтение геоизбыточных зон (RA-ГЗРС) во время действия предварительной версии.

[!INCLUDE [storage-data-lake-gen2-support](../../../includes/storage-data-lake-gen2-support.md)]

> [!IMPORTANT]
> Предварительная версия областей шифрования предназначена только для использования в рабочей среде. Соглашения об уровне обслуживания (SLA) для рабочих сред сейчас недоступны.
>
> Чтобы избежать непредвиденных затрат, не забудьте отключить все области шифрования, которые в настоящее время не нужны.

### <a name="create-a-container-or-blob-with-an-encryption-scope"></a>Создание контейнера или большого двоичного объекта с областью шифрования

Большие двоичные объекты, созданные в области шифрования, шифруются ключом, указанным для этой области. Можно указать область шифрования для отдельного большого двоичного объекта при создании большого двоичного объекта или указать область шифрования по умолчанию при создании контейнера. Если на уровне контейнера задана область шифрования по умолчанию, все большие двоичные объекты в этом контейнере шифруются с помощью ключа, связанного с областью по умолчанию.

При создании большого двоичного объекта в контейнере с областью шифрования по умолчанию можно указать область шифрования, которая переопределяет область шифрования по умолчанию, если контейнер настроен для разрешения переопределений области шифрования по умолчанию. Чтобы предотвратить переопределение области шифрования по умолчанию, настройте контейнер для запрета переопределений для отдельного большого двоичного объекта.

Операции чтения большого двоичного объекта, принадлежащего к области шифрования, происходят прозрачно, пока область шифрования не отключена.

### <a name="disable-an-encryption-scope"></a>Отключение области шифрования

При отключении области шифрования все последующие операции чтения или записи, выполненные с помощью области шифрования, завершатся ошибкой HTTP с кодом 403 (запрещено). При повторном включении области шифрования операции чтения и записи будут выполняться нормально.

Если область шифрования отключена, плата за нее больше не взимается. Отключите все области шифрования, которые не требуются, чтобы избежать ненужных расходов.

Если область шифрования защищена с помощью ключей, управляемых клиентом, для Azure Key Vault, можно также удалить связанный ключ в хранилище ключей, чтобы отключить область шифрования. Помните, что управляемые клиентом ключи в Azure Key Vault защищены с помощью обратимого удаления и защиты от вирусов, а удаленный ключ зависит от поведения, определенного для этих свойств. Дополнительные сведения см. в одном из следующих разделов документации по Azure Key Vault:

- [Как использовать обратимое удаление в Key Vault с помощью PowerShell](../../key-vault/general/key-vault-recovery.md)
- [Как использовать обратимое удаление в Key Vault с помощью интерфейса командной строки](../../key-vault/general/key-vault-recovery.md)

> [!NOTE]
> Невозможно удалить область шифрования.

## <a name="next-steps"></a>Дальнейшие действия

- [Что такое хранилище ключей Azure?](../../key-vault/general/overview.md)
- [Управляемые клиентом ключи для шифрования службы хранилища Azure](customer-managed-keys-overview.md)
- [Области шифрования для хранилища BLOB-объектов (Предварительная версия)](../blobs/encryption-scope-overview.md)
