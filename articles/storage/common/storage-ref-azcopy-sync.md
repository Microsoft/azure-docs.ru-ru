---
title: azcopy Sync | Документация Майкрософт
description: В этой статье содержатся справочные сведения о команде azcopy Sync.
author: normesta
ms.service: storage
ms.topic: reference
ms.date: 07/24/2020
ms.author: normesta
ms.subservice: common
ms.reviewer: zezha-msft
ms.openlocfilehash: dc3451a4b46a317dccda0e4292dcb1712b4171f0
ms.sourcegitcommit: aaa65bd769eb2e234e42cfb07d7d459a2cc273ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/27/2021
ms.locfileid: "98878313"
---
# <a name="azcopy-sync"></a>azcopy sync

Реплицирует исходное расположение в целевое расположение.

## <a name="synopsis"></a>Краткий обзор

Время последнего изменения используется для сравнения. Файл пропускается, если время последнего изменения в назначении является более новым.

Поддерживаются следующие пары.

- локальный < — > большого двоичного объекта Azure (можно использовать проверку подлинности SAS или OAuth).
- BLOB-объект Azure < — > большого двоичного объекта Azure (источник должен включать SAS или является общедоступным; для назначения можно использовать проверку подлинности SAS или OAuth).
- Файловый < Azure — > файл Azure (источник должен включать SAS или является общедоступным; Для назначения следует использовать проверку подлинности SAS.)

Команда Sync отличается от команды копирования несколькими способами.

1. По умолчанию рекурсивный флаг имеет значение true, а Sync копирует все подкаталоги. Синхронизация копирует только файлы верхнего уровня внутри каталога, если для рекурсивного флага задано значение false.
2. При синхронизации между виртуальными каталогами добавьте замыкающую косую черту в путь (см. примеры), если существует большой двоичный объект с таким же именем, как у одного из виртуальных каталогов.
3. Если `deleteDestination` флаг имеет значение true или Prompt, то Sync удалит файлы и большие двоичные объекты в месте назначения, которые отсутствуют в источнике.

## <a name="related-conceptual-articles"></a>Связанные концептуальные статьи

- [Начало работы с AzCopy](storage-use-azcopy-v10.md)
- [Перенос данных с помощью AzCopy и хранилища BLOB-объектов](./storage-use-azcopy-v10.md#transfer-data)
- [Перенос данных с помощью AzCopy и хранилища файлов](storage-use-azcopy-files.md)
- [Configure, optimize, and troubleshoot AzCopy](storage-use-azcopy-configure.md) (Настройка, оптимизация и устранение неполадок с AzCopy)

### <a name="advanced"></a>Продвинутый уровень

Если не указать расширение файла, AzCopy автоматически определит тип содержимого файлов при отправке с локального диска на основе расширения или содержимого файла (если не указано расширение).

Встроенная таблица подстановки является небольшой, но в UNIX она дополняется файлами MIME локальной системы, если она доступна по одному или нескольким из следующих имен:

- /етк/миме.типес
- /etc/apache2/mime.types
- /етк/апаче/миме.типес

В Windows типы MIME извлекаются из реестра.

```azcopy
azcopy sync <source> <destination> [flags]
```

## <a name="examples"></a>Примеры

Синхронизировать один файл:

```azcopy
azcopy sync "/path/to/file.txt" "https://[account].blob.core.windows.net/[container]/[path/to/blob]"
```

То же, что и выше, но также вычислит хэш MD5 содержимого файла, а затем сохраните этот хэш MD5 как свойство Content-MD5 большого двоичного объекта. 

```azcopy
azcopy sync "/path/to/file.txt" "https://[account].blob.core.windows.net/[container]/[path/to/blob]" --put-md5
```

Синхронизируйте весь каталог, включая его подкаталоги (Обратите внимание, что по умолчанию используется рекурсия):

```azcopy
azcopy sync "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]"
```

или

```azcopy
azcopy sync "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]" --put-md5
```

Синхронизировать только файлы внутри каталога, но не подкаталоги или файлы внутри подкаталогов:

```azcopy
azcopy sync "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]" --recursive=false
```

Синхронизировать подмножество файлов в каталоге (например, только файлы JPG и PDF или имя файла `exactName` ):

```azcopy
azcopy sync "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]" --include-pattern="*.jpg;*.pdf;exactName"
```

Синхронизировать весь каталог, но исключить определенные файлы из области (например: каждый файл, начинающийся с foo или заканчивающийся на Bar):

```azcopy
azcopy sync "/path/to/dir" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]" --exclude-pattern="foo*;*bar"
```

Синхронизировать один большой двоичный объект:

```azcopy
azcopy sync "https://[account].blob.core.windows.net/[container]/[path/to/blob]?[SAS]" "https://[account].blob.core.windows.net/[container]/[path/to/blob]"
```

Синхронизация виртуального каталога:

```azcopy
azcopy sync "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]?[SAS]" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]" --recursive=true
```

Синхронизируйте виртуальный каталог, имя которого совпадает с именем большого двоичного объекта (добавьте замыкающую косую черту в путь для устранения неоднозначности):

```azcopy
azcopy sync "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]/?[SAS]" "https://[account].blob.core.windows.net/[container]/[path/to/virtual/dir]/" --recursive=true
```

Синхронизация каталога файлов Azure (с тем же синтаксисом, что и BLOB-объект):

```azcopy
azcopy sync "https://[account].file.core.windows.net/[share]/[path/to/dir]?[SAS]" "https://[account].file.core.windows.net/[share]/[path/to/dir]" --recursive=true
```

> [!NOTE]
> Если флаги включения и исключения используются вместе, будут рассматриваться только файлы, соответствующие шаблонам включения, но те, которые соответствуют шаблонам исключения, всегда будут игнорироваться.

## <a name="options"></a>Варианты

**--Block-Size-МБ** float используйте этот размер блока (указанный в MIB) при отправке в службу хранилища Azure или скачивании из службы хранилища Azure. Значение по умолчанию вычисляется автоматически на основе размера файла. Десятичные дроби разрешены (например: `0.25` ).

**--Check-Md5** определяет, насколько строго следует проверять хэши MD5 при скачивании. Этот параметр доступен только при скачивании. Доступные значения: `NoCheck` , `LogOnly` , `FailIfDifferent` , `FailIfDifferentOrMissing` . (по умолчанию `FailIfDifferent` ). (по умолчанию `FailIfDifferent` )

**--Delete — строка назначения** определяет, следует ли удалить лишние файлы из места назначения, которые отсутствуют в источнике. Можно задать значение `true` , `false` или `prompt` . Если задано значение `prompt` , пользователю будет предложено задать вопрос перед планированием удаления файлов и больших двоичных объектов. (по умолчанию `false` ). (по умолчанию `false` )

**--Exclude-атрибуты** строка (только для Windows) исключает файлы, атрибуты которых соответствуют списку атрибутов. Пример: `A;S;R`

**--Строка исключения-Path** исключает эти пути при сравнении источника с назначением. Этот параметр не поддерживает подстановочные знаки (*). Проверяет относительный префикс пути (например: `myFolder;myFolder/subDirName/file.pdf` ).

**--исключение-шаблон** строка исключает файлы, имя которых совпадает со списком шаблонов. Пример: `*.jpg;*.pdf;exactName`

**—**    Справка по синхронизации.

**--include-Attributes** String (только для Windows) включает только те файлы, атрибуты которых соответствуют списку атрибутов. Пример: `A;S;R`

**--include — строка шаблона** включает только файлы, имена которых совпадают с списком шаблонов. Пример: `*.jpg;*.pdf;exactName`

**--строка на уровне журнала** определяет уровень детализации журнала для файла журнала, доступные уровни: `INFO` (все запросы и ответы), `WARNING` (медленные ответы), ( `ERROR` только неудачные запросы) и `NONE` (без выходных журналов). (по умолчанию `INFO` ). 

**--Preserve-SMB-info**   Значение false по умолчанию. Сохраняет сведения о свойстве SMB (время последней записи, время создания, биты атрибутов) между ресурсами, поддерживающими SMB (файлы Windows и Azure). Этот флаг применяется к файлам и папкам, если только не задан фильтр только для файлов (например, шаблон include). Информация, переданная для папок, такая же, как и для файлов, за исключением времени последней записи, которое не сохраняется для папок.

**--Preserve-SMB-разрешения**   Значение false по умолчанию. Сохраняет списки ACL SMB между ресурсами, которые поддерживаются (файлы Windows и Azure). Этот флаг применяется к файлам и папкам, если только не задан фильтр только для файлов (например, `include-pattern` ).

**--Размещение-MD5**     Создайте хэш MD5 для каждого файла и сохраните хэш как свойство Content-MD5 целевого большого двоичного объекта или файла. (По умолчанию хэш не создается.) Доступно только при отправке.

**--recursive** `True` по умолчанию при синхронизации между каталогами рекурсивно выполняется Поиск подкаталогов.     (по умолчанию `True` ). 

**--S2S-Preserve-уровень доступа**  Сохранение уровня доступа во время копирования службы в службу. Дополнительные сведения см. в статье [хранилище BLOB-объектов Azure: горячий, холодный и архивный уровни доступа](../blobs/storage-blob-storage-tiers.md) , чтобы гарантировать, что Целевая учетная запись хранения поддерживает настройку уровня доступа. В случаях, когда установка уровня доступа не поддерживается, используйте s2sPreserveAccessTier = false, чтобы обойти копирование уровня доступа. (по умолчанию `true` ). 

## <a name="options-inherited-from-parent-commands"></a>Параметры, унаследованные от родительских команд

|Параметр|Описание|
|---|---|
|--Cap-Мбит/с UInt32|Скорость передачи с прописными буквами в мегабит в секунду. Посекундная пропускная способность может немного отличаться от ограничения. Если этот параметр имеет значение 0 или пропущен, пропускная способность не ограничена.|
|--строка выходного типа|Формат вывода команды. Среди вариантов: Text, JSON. Значение по умолчанию — "Text".|
|--Trusted-Microsoft-суффикс строка   |Указывает дополнительные суффиксы домена, в которых могут быть отправлены Azure Active Directory токены входа.  Значение по умолчанию — "*. Core.Windows.NET;*". core.chinacloudapi.cn; *. Core.cloudapi.de;*. core.usgovcloudapi.net ". Все перечисленные здесь значения добавляются к значениям по умолчанию. В целях безопасности следует размещать только Microsoft Azureные домены. Несколько записей разделяются точкой с запятой.|

## <a name="see-also"></a>См. также

- [azcopy](storage-ref-azcopy.md)
