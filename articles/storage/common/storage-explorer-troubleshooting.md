---
title: Руководство по устранению неполадок в обозревателе хранилищ Azure | Документы Майкрософт
description: Общие сведения о методах отладки для Обозреватель службы хранилища Azure
services: storage
author: Deland-Han
manager: dcscontentpm
ms.service: storage
ms.topic: troubleshooting
ms.date: 07/28/2020
ms.author: delhan
ms.openlocfilehash: 15df9b38abe35fe3eefad2fa160e1c1f16fe7aa7
ms.sourcegitcommit: 5bbc00673bd5b86b1ab2b7a31a4b4b066087e8ed
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/07/2021
ms.locfileid: "102439465"
---
# <a name="azure-storage-explorer-troubleshooting-guide"></a>Руководство по устранению неполадок в обозревателе хранилищ Azure

Обозреватель службы хранилища Microsoft Azure — это изолированное приложение, которое упрощает работу с данными из Cлужбы хранилища Azure на платформе Windows, macOS и Linux. Приложение может подключаться к учетным записям хранения, размещенным в Azure, National Clouds и Azure Stack.

В этом пошаговом руководством описаны решения проблем, которые обычно встречаются в Обозреватель службы хранилища.

## <a name="azure-rbac-permissions-issues"></a>Проблемы с разрешениями RBAC в Azure

Управление доступом на основе ролей Azure с помощью [Azure RBAC](../../role-based-access-control/overview.md) обеспечивает строгое управление доступом к ресурсам Azure, объединяя наборы разрешений в _роли_. Ниже приведены некоторые стратегии, позволяющие обеспечить оптимальную работу Azure RBAC в Обозреватель службы хранилища.

### <a name="how-do-i-access-my-resources-in-storage-explorer"></a>Разделы справки получить доступ к моим ресурсам в Обозреватель службы хранилища?

Если у вас возникли проблемы с доступом к ресурсам хранилища через Azure RBAC, возможно, вам не были назначены соответствующие роли. В следующих разделах описываются разрешения Обозреватель службы хранилища, которые в настоящее время требуются для доступа к ресурсам хранилища. Если вы не уверены, что у вас есть соответствующие роли или разрешения, обратитесь к администратору учетной записи Azure.

#### <a name="read-listget-storage-accounts-permissions-issue"></a>Проблемы с разрешениями "чтение: список/получить учетные записи хранения"

Необходимо иметь разрешение на вывод списка учетных записей хранения. Чтобы получить это разрешение, необходимо назначить роль _читателя_ .

#### <a name="list-storage-account-keys"></a>Вывод списка ключей учетной записи хранения

Обозреватель службы хранилища также могут использовать ключи учетной записи для проверки подлинности запросов. Доступ к ключам учетной записи можно получить с помощью более мощных ролей, таких как роль _участника_ .

> [!NOTE]
> Ключи доступа предоставляют неограниченные разрешения всем, кто их владеет. Поэтому мы не рекомендуем использовать эти ключи для учетных записей пользователей. Если необходимо отозвать ключи доступа, их можно повторно создать из [портал Azure](https://portal.azure.com/).

#### <a name="data-roles"></a>Роли данных

Необходимо назначить по крайней мере одну роль, которая предоставляет доступ для чтения данных из ресурсов. Например, если вы хотите перечислить или скачать большие двоичные объекты, потребуется по крайней мере роль _читателя данных BLOB-объекта хранилища_ .

### <a name="why-do-i-need-a-management-layer-role-to-see-my-resources-in-storage-explorer"></a>Зачем нужна роль уровня управления для просмотра ресурсов в Обозреватель службы хранилища?

Служба хранилища Azure имеет два уровня доступа: _Управление_ и _данные_. Доступ к подпискам и учетным записям хранения осуществляется через уровень управления. Доступ к контейнерам, BLOB-объектам и другим ресурсам данных осуществляется через уровень данных. Например, если вы хотите получить список учетных записей хранения из Azure, отправьте запрос в конечную точку управления. Если вам нужен список контейнеров больших двоичных объектов в учетной записи, отправьте запрос в соответствующую конечную точку службы.

Роли Azure могут предоставлять разрешения на управление или доступ к уровню данных. Например, роль читателя предоставляет доступ только для чтения к ресурсам уровня управления.

Строго говоря, роль читателя не предоставляет разрешений уровня данных и не является необходимой для доступа к слою данных.

Обозреватель службы хранилища упрощает доступ к ресурсам, собирая необходимые сведения для подключения к ресурсам Azure. Например, чтобы отобразить контейнеры больших двоичных объектов, Обозреватель службы хранилища отправляет запрос "список контейнеров" в конечную точку службы BLOB-объектов. Чтобы получить эту конечную точку, Обозреватель службы хранилища ищет в списке подписки и учетные записи хранения, к которым у вас есть доступ. Для поиска подписок и учетных записей хранения Обозреватель службы хранилища также требуется доступ к слою управления.

Если у вас нет роли, предоставляющей какие-либо разрешения уровня управления, Обозреватель службы хранилища не сможет получить сведения, необходимые для подключения к слою данных.

### <a name="what-if-i-cant-get-the-management-layer-permissions-i-need-from-my-administrator"></a>Что делать, если я не могу получить необходимые разрешения уровня управления от администратора?

Если вы хотите получить доступ к контейнерам больших двоичных объектов, ADLS 2-го поколения контейнерам, каталогам или очередям, вы можете присоединиться к этим ресурсам с помощью учетных данных Azure.

1. Откройте диалоговое окно Подключение.
1. Выберите тип ресурса, к которому необходимо подключиться.
1. Выберите **Вход с помощью Azure Active Directory (Azure AD)**. Выберите **Далее**.
1. Выберите учетную запись пользователя и клиента, связанные с ресурсом, к которому вы подключаетесь. Выберите **Далее**.
1. Введите URL-адрес ресурса и введите уникальное отображаемое имя для соединения. Нажмите кнопку **Далее** , а затем **Подключиться**.

Для других типов ресурсов в настоящее время нет решения, связанного с Azure RBAC. В качестве обходного решения можно запросить URL-адрес SAS, а затем присоединить его к ресурсу, выполнив следующие действия.

1. Откройте диалоговое окно Подключение.
1. Выберите тип ресурса, к которому необходимо подключиться.
1. Выберите **подпись общего доступа (SAS)**. Выберите **Далее**.
1. Введите полученный URL-адрес SAS и введите уникальное отображаемое имя для подключения. Нажмите кнопку **Далее** , а затем **Подключиться**.
 
Дополнительные сведения о подключении к ресурсам см. в разделе [Подключение к отдельному ресурсу](../../vs-azure-tools-storage-manage-with-storage-explorer.md?tabs=linux#attach-to-an-individual-resource).

### <a name="recommended-azure-built-in-roles"></a>Рекомендуемые встроенные роли Azure

Существует несколько встроенных ролей Azure, которые могут предоставить разрешения, необходимые для использования Обозреватель службы хранилища. Ниже приведены некоторые из этих ролей.
- [Владелец](../../role-based-access-control/built-in-roles.md#owner): управление всеми ресурсами, включая доступ к ресурсам.
- [Участник](../../role-based-access-control/built-in-roles.md#contributor): управление всеми ресурсами без доступа к ресурсам.
- [Читатель](../../role-based-access-control/built-in-roles.md#reader): чтение и вывод списка ресурсов.
- [Участник учетной записи хранения](../../role-based-access-control/built-in-roles.md#storage-account-contributor). полное управление учетными записями хранения.
- [Владелец данных BLOB-объекта хранилища](../../role-based-access-control/built-in-roles.md#storage-blob-data-owner): полный доступ к контейнерам и данным больших двоичных объектов службы хранилища Azure.
- [Участник данных BLOB-объектов службы хранилища](../../role-based-access-control/built-in-roles.md#storage-blob-data-contributor): чтение, запись и удаление контейнеров и больших двоичных объектов службы хранилища Azure.
- [Модуль чтения BLOB-объектов хранилища](../../role-based-access-control/built-in-roles.md#storage-blob-data-reader): чтение и перечисление контейнеров хранилища Azure и больших двоичных объектов.

> [!NOTE]
> Роли участников "владелец", "участник" и "учетная запись хранения" предоставляют доступ к ключу учетной записи.

## <a name="error-self-signed-certificate-in-certificate-chain-and-similar-errors"></a>Ошибка: самозаверяющий сертификат в цепочке сертификатов (и аналогичные ошибки)

Ошибки сертификатов обычно возникают в одной из следующих ситуаций.

- Приложение подключается через _прозрачный прокси-сервер_. Это означает, что сервер (например, сервер компании) перехватывает трафик HTTPS, расшифровывает его, а затем шифрует с помощью самозаверяющего сертификата.
- Вы используете приложение, которое внедряет самозаверяющий сертификат TLS/SSL в получаемые сообщения HTTPS. Примерами приложений, включающих сертификаты, являются антивирусные и сетевые программы проверки трафика.

Когда Обозреватель службы хранилища видит самозаверяющий или недоверенный сертификат, он больше не знает, было ли изменено полученное сообщение HTTPS. Если у вас есть копия самозаверяющего сертификата, можно указать Обозреватель службы хранилища доверять ему, выполнив следующие действия.

1. Получите копию сертификата X. 509 (CER) в кодировке Base-64.
2. Перейдите к разделу **изменение**  >  **SSL-сертификатов**  >  **Импорт сертификатов**, а затем с помощью средства выбора файлов найдите, выберите и откройте CER-файл.

Эта проблема также может возникать, если имеется несколько сертификатов (корневой и промежуточный). Чтобы устранить эту ошибку, необходимо добавить оба сертификата.

Если вы не знаете, откуда поступает сертификат, выполните следующие действия, чтобы найти его:

1. Установите OpenSSL.
    * [Windows](https://slproweb.com/products/Win32OpenSSL.html). любой из легких версий должен быть достаточным.
    * Mac и Linux: должны быть добавлены в операционную систему.
2. Выполните команду OpenSSL.
    * Windows: Откройте каталог установки, выберите **/bin/**, а затем дважды щелкните **openssl.exe**.
    * Mac и Linux: запустите `openssl` из терминала.
3. Выполните `s_client -showcerts -connect microsoft.com:443`.
4. Найдите самозаверяющие сертификаты. Если вы не знаете, какие сертификаты являются самозаверяющими, обратите внимание, что в любом месте субъект `("s:")` и издатель совпадают `("i:")` .
5. При обнаружении самозаверяющих сертификатов для каждого из них скопируйте и вставьте все из (и включая) `-----BEGIN CERTIFICATE-----` `-----END CERTIFICATE-----` в новый CER-файл.
6. Откройте обозреватель службы хранилища и перейдите к разделу **изменение**  >  **SSL-сертификатов**  >  **Импорт сертификатов**. Затем с помощью средства выбора файлов найдите, выберите и откройте созданные CER файлы.

Если вы не можете найти самозаверяющие сертификаты, выполнив эти действия, обратитесь к нам через средство обратной связи. Можно также открыть Обозреватель службы хранилища из командной строки с помощью `--ignore-certificate-errors` флага. При открытии с этим флагом Обозреватель службы хранилища игнорирует ошибки сертификата.

## <a name="sign-in-issues"></a>Проблемы при входе

### <a name="blank-sign-in-dialog-box"></a>Диалоговое окно «пустой вход»

Пустые диалоговые окна входа чаще всего возникают, когда службы федерации Active Directory (AD FS) (AD FS) предложит Обозреватель службы хранилища выполнить перенаправление, которое не поддерживается электронными адресами. Чтобы обойти эту ошибку, можно попытаться использовать поток кода устройства для входа. Для этого выполните следующие действия.

1. На левой вертикальной панели инструментов откройте **Параметры**. На панели Параметры перейдите к разделу   >  **Вход** в приложение. Включите **Вход с помощью потока кода устройства**.
2. Откройте диалоговое окно **Подключение** (с помощью значка подключения на левой вертикальной панели или выбрав **Добавить учетную запись** на панели учетной записи).
3. Выберите среду, в которой требуется выполнить вход.
4. Выберите **Войти**.
5. Следуйте инструкциям на следующей панели.

Если вы не можете войти в учетную запись, которую вы хотите использовать, так как браузер по умолчанию уже вошел в другую учетную запись, выполните одно из следующих действий.

- Вручную скопировать ссылку и код в закрытом режиме вашего браузера.
- Вручную скопировать ссылку и код в другой браузер.

### <a name="reauthentication-loop-or-upn-change"></a>Цикл повторной аутентификации или изменение имени участника-пользователя

Если вы находитесь в цикле повтора проверки подлинности или изменили UPN одной из ваших учетных записей, выполните следующие действия.

1. Удалите все учетные записи, а затем закройте Обозреватель службы хранилища.
2. Удалите папку .IdentityService с компьютера. В Windows папка находится в расположении `C:\users\<username>\AppData\Local`. Для Mac и Linux вы можете найти папку в корневой папке каталога пользователя.
3. Если вы используете Mac или Linux, вам также потребуется удалить запись Microsoft. Developer. Идентитисервице из хранилища ключей операционной системы. Хранилище ключей на компьютере Mac — это приложение *GNOME цепочки ключей* . В Linux приложение обычно называется набором _ключей_, но имя может отличаться в зависимости от распределения.

### <a name="conditional-access"></a>Условный доступ

Из-за ограничений в библиотеке Azure AD, используемой Обозреватель службы хранилища, условный доступ не поддерживается, если Обозреватель службы хранилища используется в Windows 10, Linux или macOS.

## <a name="mac-keychain-errors"></a>Ошибки цепочки ключей Mac

Иногда цепочка ключей macOS может ввести состояние, вызывающее проблемы с библиотекой проверки подлинности Обозреватель службы хранилища. Чтобы извлечь цепочку ключей из этого состояния, выполните следующие действия.

1. Закройте Обозреватель службы хранилища.
2. Откройте цепочку ключей (нажмите кнопку + пробел, введите **цепочку ключей** и нажмите клавишу ВВОД).
3. Выберите цепочку ключей "Login".
4. Щелкните значок замка, чтобы заблокировать цепочку ключей. (Замок по-видимому будет заблокирован после завершения процесса. Это может занять несколько секунд в зависимости от того, какие приложения открыты.

    ![Значок замка](./media/storage-explorer-troubleshooting/unlockingkeychain.png)

5. Откройте Обозреватель службы хранилища.
6. Вам будет предложено сообщение, например "концентратору услуг требуется получить доступ к цепочке ключей". Введите пароль учетной записи администратора Mac и установите флажок **всегда разрешать** (или **Разрешить** , если **всегда разрешить** недоступно).
7. Попробуйте выполнить вход.

### <a name="general-sign-in-troubleshooting-steps"></a>Общие действия по устранению неполадок входа

* Если вы находитесь в macOS, а окно входа никогда не отображается в диалоговом окне **Ожидание проверки подлинности** , попробуйте выполнить [следующие действия](#mac-keychain-errors).
* Перезапустите Обозреватель службы хранилища.
* Если диалоговое окно проверки подлинности пустое, подождите не менее одной минуты, прежде чем его закрыть.
* Убедитесь, что параметры прокси-сервера и сертификата правильно настроены как для компьютера, так и для Обозреватель службы хранилища.
* Если вы используете Windows и имеете доступ к Visual Studio 2019 на том же компьютере и учетным данным для входа, попробуйте войти в Visual Studio 2019. После успешного входа в Visual Studio 2019 вы можете открыть Обозреватель службы хранилища и просмотреть свою учетную запись на панели учетной записи.

Если ни один из этих методов не работает, [откройте вопрос в GitHub](https://github.com/Microsoft/AzureStorageExplorer/issues).

### <a name="missing-subscriptions-and-broken-tenants"></a>Отсутствие подписки и неисправные клиенты

Если вы не можете получить подписки после успешного входа, попробуйте выполнить следующие методы устранения неполадок:

* Убедитесь, что учетная запись имеет доступ к необходимым подпискам. Вы можете проверить доступ, войдя на портал для среды Azure, которую вы пытаетесь использовать.
* Убедитесь, что вы вошли в подходящую среду Azure (Azure, Azure для Китая, Azure для Германии, Azure для государственных организаций США или пользовательскую среду).
* Если вы находитесь за прокси-сервером, убедитесь, что вы правильно настроили прокси-сервер Обозреватель службы хранилища.
* Попробуйте удалить и повторно добавить учетную запись.
* Если есть ссылка "Дополнительные сведения", проверьте, какие сообщения об ошибках выводятся для неудачных клиентов. Если вы не знаете, как реагировать на сообщения об ошибках, вы можете [открыть вопрос в GitHub](https://github.com/Microsoft/AzureStorageExplorer/issues).

## <a name="cant-remove-an-attached-account-or-storage-resource"></a>Не удается удалить подключенную учетную запись или ресурс хранилища

Если вы не можете удалить подключенную учетную запись или ресурс хранилища с помощью пользовательского интерфейса, можно вручную удалить все подключенные ресурсы, удалив следующие папки:

* Windows: `%AppData%/StorageExplorer`
* macOS: `/Users/<your_name>/Library/Application Support/StorageExplorer`
* Linux: `~/.config/StorageExplorer`

> [!NOTE]
> Закройте Обозреватель службы хранилища перед удалением этих папок.

> [!NOTE]
> Если вы когда-либо импортировали SSL-сертификаты, создайте резервную копию содержимого `certs` каталога. Позже вы сможете использовать резервную копию, чтобы повторно импортировать сертификаты SSL.

## <a name="proxy-issues"></a>Проблемы с прокси-сервером

Обозреватель службы хранилища поддерживает подключение к ресурсам службы хранилища Azure через прокси-сервер. При возникновении проблем с подключением к Azure через прокси-сервер ниже приведены некоторые рекомендации.

> [!NOTE]
> Обозреватель службы хранилища поддерживает только обычную проверку подлинности на прокси-серверах. Другие методы проверки подлинности, такие как NTLM, не поддерживаются.

> [!NOTE]
> Обозреватель службы хранилища не поддерживает файлы автоматической настройки прокси-сервера для настройки параметров прокси-сервера.

### <a name="verify-storage-explorer-proxy-settings"></a>Проверка параметров прокси-сервера Обозреватель службы хранилища

Параметр **конфигурации "приложение > прокси →** прокси-сервер" определяет, из каких источников обозреватель службы хранилища получает конфигурацию прокси-сервера.

При выборе варианта "использовать переменные среды" обязательно задайте `HTTPS_PROXY` `HTTP_PROXY` переменные среды или (переменные среды учитывают регистр, поэтому обязательно Задайте правильные переменные). Если эти переменные не определены или являются недопустимыми, Обозреватель службы хранилища не будет использовать прокси-сервер. Перезапустите Обозреватель службы хранилища после изменения переменных среды.

Если выбран параметр "использовать параметры прокси приложения", проверьте правильность параметров прокси-сервера в приложении.

### <a name="steps-for-diagnosing-issues"></a>Действия по диагностике проблем

Если у вас по-прежнему возникают проблемы, попробуйте следующие методы устранения неполадок:

1. Если вы можете подключиться к Интернету без использования прокси-сервера, убедитесь, что Обозреватель службы хранилища работает без включенных параметров прокси-сервера. При успешном подключении Обозреватель службы хранилища может возникнуть ошибка прокси-сервера. Для выявления проблем обратитесь к администратору.
2. Убедитесь, что другие приложения, использующие прокси-сервер, работают должным образом.
3. Убедитесь, что вы можете подключиться к порталу для среды Azure, которую вы пытаетесь использовать.
4. Убедитесь, что вы можете получать ответы от конечных точек службы. Введите один из URL-адресов конечной точки в браузере. Если вы можете подключиться, вы должны получить `InvalidQueryParameterValue` или аналогичный XML-ответ.
5. Проверьте, может ли другой пользователь, использующий Обозреватель службы хранилища с тем же прокси-сервером, подключиться. Если это возможно, обратитесь к администратору прокси-сервера.

### <a name="tools-for-diagnosing-issues"></a>Инструменты для выявления проблем

Средство работы с сетью, например Fiddler, может помочь в диагностике проблем.

1. Настройте сетевой инструмент в качестве прокси-сервера, работающего на локальном узле. Если необходимо продолжить работу после фактического прокси-сервера, может потребоваться настроить сетевое средство для подключения через прокси-сервер.
2. Проверьте номер порта, используемый средством для работы с сетью.
3. Настройте параметры прокси-сервера Обозреватель службы хранилища для использования локального узла и номера порта средства сетевого доступа (например, "localhost: 8888").
 
При правильном задании сетевое средство будет регистрировать сетевые запросы, выполняемые Обозреватель службы хранилища в конечные точки управления и службы.
 
Если средство работы с сетью не регистрирует Обозреватель службы хранилища трафика, попробуйте проверить средство с помощью другого приложения. Например, введите URL-адрес конечной точки для одного из ресурсов хранилища (например, `https://contoso.blob.core.windows.net/` ) в веб-браузере, и вы получите ответ, аналогичный следующему:

  ![Пример кода](./media/storage-explorer-troubleshooting/4022502_en_2.png)

  Ответ предполагает, что ресурс существует, даже если у вас нет доступа к нему.

Если средство работы с сетью отображает трафик только от других приложений, может потребоваться изменить параметры прокси-сервера в Обозреватель службы хранилища. В противном случае необходимо настроить параметры средства.

### <a name="contact-proxy-server-admin"></a>Обратитесь к администратору прокси-сервера

Если параметры прокси-сервера верны, то, возможно, придется обратиться к администратору прокси-серверов, чтобы:

* Убедитесь, что прокси-сервер не блокирует трафик в конечные точки управления или ресурсов Azure.
* Проверьте протокол аутентификации, используемый прокси-сервером. Обозреватель службы хранилища поддерживает только основные протоколы проверки подлинности. Обозреватель службы хранилища не поддерживает прокси-серверы NTLM.

## <a name="unable-to-retrieve-children-error-message"></a>Сообщение об ошибке "Не удается получить дочерние элементы"

Если вы подключены к Azure через прокси-сервер, проверьте правильность параметров прокси-сервера.

Если владелец подписки или учетной записи предоставил вам доступ к ресурсу, убедитесь, что у вас есть разрешения на чтение или перечисление для этого ресурса.

## <a name="connection-string-doesnt-have-complete-configuration-settings"></a>В строке подключения не заданы полные параметры конфигурации

Если вы получили это сообщение об ошибке, возможно, у вас нет необходимых разрешений для получения ключей для вашей учетной записи хранения. Чтобы убедиться, что это так, перейдите на портал и найдите учетную запись хранения. Это можно сделать, щелкнув правой кнопкой мыши узел для своей учетной записи хранения и выбрав **Открыть на портале**. Затем перейдите в колонку **ключи доступа** . Если у вас нет разрешений на Просмотр ключей, вы увидите сообщение "у вас нет доступа". Чтобы обойти эту ошибку, можно получить ключ учетной записи от кого-либо другого и присоединиться по имени и ключу, либо попросить кого-либо о сопоставлении безопасности с учетной записью хранения и использовать ее для подключения учетной записи хранения.

Если вы видите ключи учетной записи, задавайте проблему в GitHub, чтобы мы могли помочь вам устранить проблему.

## <a name="error-occurred-while-adding-new-connection-typeerror-cannot-read-property-version-of-undefined"></a>Произошла ошибка при добавлении нового соединения: Типиррор: не удается прочитать свойство "версия" неопределенного

При появлении этого сообщения об ошибке при попытке добавить пользовательское подключение данные подключения, хранящиеся в локальном диспетчере учетных данных, могут быть повреждены. Чтобы обойти эту ошибку, попробуйте удалить поврежденные локальные подключения, а затем добавьте их повторно:

1. Запустите Обозреватель хранилища. В меню выберите **Справка**  >  **Переключение средства для разработчиков**.
2. В открывшемся окне на вкладке **приложение** выберите **Локальное хранилище** (слева) > **File://**.
3. В зависимости от типа подключения, с которым возникла неполадка, найдите его ключ и скопируйте его значение в текстовый редактор. Значение представляет собой массив имен пользовательских соединений, как в следующем примере:
    * Учетные записи хранения
        * `StorageExplorer_CustomConnections_Accounts_v1`
    * контейнеров BLOB-объектов;
        * `StorageExplorer_CustomConnections_Blobs_v1`
        * `StorageExplorer_CustomConnections_Blobs_v2`
    * общих папок;
        * `StorageExplorer_CustomConnections_Files_v1`
    * очередей;
        * `StorageExplorer_CustomConnections_Queues_v1`
    * Таблицы
        * `StorageExplorer_CustomConnections_Tables_v1`
4. После сохранения текущих имен соединений задайте значение в Средства для разработчиков `[]` .

Если вы хотите сохранить неповрежденные подключения, выполните следующие действия для нахождение поврежденных подключений. Если вы не хотите потерять все существующие подключения, можно пропустить эти шаги и выполнить инструкции для конкретных платформ, чтобы очистить данные подключения.

1. В текстовом редакторе повторно добавьте имя каждого подключения в Средства для разработчиков, а затем проверьте, работает ли соединение.
2. Если подключение работает правильно, оно не повреждено и его можно спокойно оставить. Если подключение не работает, удалите его значение из Средства для разработчиков и запишите его, чтобы впоследствии его можно было добавить позже.
3. Повторяйте до тех пор, пока не будут проверены все подключения.

После прохождения всех подключений для всех соединений с именами, которые не добавляются обратно, необходимо очистить поврежденные данные (если они есть) и добавить их обратно с помощью стандартных действий в Обозреватель службы хранилища.

# <a name="windows"></a>[Windows](#tab/Windows)

1. В меню **Пуск** найдите **Диспетчер учетных данных** и откройте его.
2. Перейдите в раздел **учетные данные Windows**.
3. В разделе **Общие учетные данные** найдите записи с `<connection_type_key>/<corrupted_connection_name>` ключом (например, `StorageExplorer_CustomConnections_Accounts_v1/account1` ).
4. Удалите эти записи и повторно добавьте подключения.

# <a name="macos"></a>[macOS](#tab/macOS)

1. Откройте "Spotlight" (Command + пробел) и найдите **доступ к цепочке ключей**.
2. Ищите записи, имеющие `<connection_type_key>/<corrupted_connection_name>` ключ (например, `StorageExplorer_CustomConnections_Accounts_v1/account1` ).
3. Удалите эти записи и повторно добавьте подключения.

# <a name="linux"></a>[Linux](#tab/Linux)

Локальное управление учетными данными зависит от дистрибутива Linux. Если дистрибутив Linux не предоставляет встроенное средство графического пользовательского интерфейса для управления локальными учетными данными, можно установить стороннее средство для управления локальными учетными данными. Например, можно использовать [сеахорсе](https://wiki.gnome.org/Apps/Seahorse/), средство графического пользовательского интерфейса с открытым исходным кодом для управления локальными учетными данными Linux.

1. Откройте средство управления локальными учетными данными и найдите сохраненные учетные данные.
2. Ищите записи, имеющие `<connection_type_key>/<corrupted_connection_name>` ключ (например, `StorageExplorer_CustomConnections_Accounts_v1/account1` ).
3. Удалите эти записи и повторно добавьте подключения.
---

Если вы по-прежнему столкнулись с этой ошибкой после выполнения этих действий или хотите поделиться с поврежденными подключениями, [откройте](https://github.com/microsoft/AzureStorageExplorer/issues) на странице GitHub ошибку.

## <a name="issues-with-sas-url"></a>Проблемы с URL-адресом SAS

Если вы подключаетесь к службе через URL-адрес SAS и возникла ошибка:

* убедитесь, что URL-адрес предоставляет необходимые разрешения на чтение или перечисление ресурсов.
* Убедитесь, что срок действия URL-адреса не истек.
* Если URL-адрес основан на политике доступа, убедитесь, что политика доступа не была отозвана.

Если вы случайно присоединяетесь с использованием недопустимого URL-адреса SAS и теперь не можете отсоединяться, выполните следующие действия.

1. Когда вы используете Обозреватель службы хранилища, нажмите клавишу F12, чтобы открыть окно Средства для разработчиков.
2. На вкладке **приложение** выберите **Локальное хранилище**  >  **File://** в дереве слева.
3. Найти ключ, связанный с типом службы для проблемного URI SAS. Например, если неверный URI SAS относится к контейнеру больших двоичных объектов, найдите ключ с именем `StorageExplorer_AddStorageServiceSAS_v1_blob`.
4. Значение ключа должно быть массивом JSON. Найдите объект, связанный с неправильным URI, и удалите его.
5. Нажмите клавиши CTRL+R, чтобы перезагрузить обозреватель хранилища.

## <a name="linux-dependencies"></a>Зависимости Linux

### <a name="snap"></a>Snap-пакеты

Обозреватель службы хранилища 1.10.0 и более поздние версии доступны в качестве привязки к хранилищу привязкой. Обозреватель службы хранилищаная привязка устанавливает все свои зависимости автоматически и обновляется при наличии новой версии привязки. Установка привязки Обозреватель службы хранилища является рекомендуемым методом установки.

Обозреватель службы хранилища требует использования диспетчера паролей, который может потребоваться установить вручную, прежде чем Обозреватель службы хранилища будет работать правильно. Вы можете подключить Обозреватель службы хранилища к диспетчеру паролей системы, выполнив следующую команду:

```bash
snap connect storage-explorer:password-manager-service :password-manager-service
```

### <a name="targz-file"></a>Файл tar. gz

Вы также можете скачать приложение как файл tar. gz, но необходимо установить зависимости вручную.

Обозреватель службы хранилища, как указано в файле. tar. gz, поддерживается только для следующих версий Ubuntu. Обозреватель службы хранилища могут работать с другими дистрибутивами Linux, но официально не поддерживаются.

- Ubuntu 20,04 x64
- Ubuntu 18,04 x64
- Ubuntu 16,04 x64

Обозреватель службы хранилища требуется установка .NET Core в системе. Мы рекомендуем использовать .NET Core 2,1, но Обозреватель службы хранилища также будет работать с 2,2.

> [!NOTE]
> Для Обозреватель службы хранилища версии 1.7.0 и более ранних требуется .NET Core 2,0. Если установлена более новая версия .NET Core, необходимо [исправить обозреватель службы хранилища](#patching-storage-explorer-for-newer-versions-of-net-core). Если вы используете Обозреватель службы хранилища 1.8.0 или более поздней версии, вам потребуется по крайней мере .NET Core 2,1.

# <a name="ubuntu-2004"></a>[Ubuntu 20.04](#tab/2004)

1. Скачайте файл Обозреватель службы хранилища. tar. gz.
2. Установите [среду выполнения .NET Core](/dotnet/core/install/linux):
   ```bash
   wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb; \
     sudo dpkg -i packages-microsoft-prod.deb; \
     sudo apt-get update; \
     sudo apt-get install -y apt-transport-https && \
     sudo apt-get update && \
     sudo apt-get install -y dotnet-runtime-2.1
   ```

# <a name="ubuntu-1804"></a>[Ubuntu 18.04](#tab/1804)

1. Скачайте файл Обозреватель службы хранилища. tar. gz.
2. Установите [среду выполнения .NET Core](/dotnet/core/install/linux):
   ```bash
   wget https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb; \
     sudo dpkg -i packages-microsoft-prod.deb; \
     sudo apt-get update; \
     sudo apt-get install -y apt-transport-https && \
     sudo apt-get update && \
     sudo apt-get install -y dotnet-runtime-2.1
   ```

# <a name="ubuntu-1604"></a>[Ubuntu 16.04](#tab/1604)

1. Скачайте файл Обозреватель службы хранилища. tar. gz.
2. Установите [среду выполнения .NET Core](/dotnet/core/install/linux):
   ```bash
   wget https://packages.microsoft.com/config/ubuntu/16.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb; \
     sudo dpkg -i packages-microsoft-prod.deb; \
     sudo apt-get update; \
     sudo apt-get install -y apt-transport-https && \
     sudo apt-get update && \
     sudo apt-get install -y dotnet-runtime-2.1
   ```
---

Многие библиотеки, необходимые Обозреватель службы хранилища предустановленными с помощью стандартных установок Ubuntu. В пользовательских средах могут отсутствовать некоторые из этих библиотек. При возникновении проблем с запуском Обозреватель службы хранилища рекомендуется убедиться, что в системе установлены следующие пакеты:

- iproute2
- libasound2
- libatm1
- libgconf2-4
- libnspr4
- libnss3
- libpulse0
- libsecret-1-0
- libx11-xcb1
- libxss1
- libxtables11
- libxtst6
- xdg-utils

### <a name="patching-storage-explorer-for-newer-versions-of-net-core"></a>Обозреватель службы хранилища исправлений для новых версий .NET Core

Для Обозреватель службы хранилища 1.7.0 или более ранней версии может потребоваться исправить версию .NET Core, используемую Обозреватель службы хранилища:

1. Скачайте версию 1.5.43 Стреамжсонрпк [из NuGet](https://www.nuget.org/packages/StreamJsonRpc/1.5.43). Найдите ссылку скачать пакет в правой части страницы.
2. После загрузки пакета измените расширение файла с `.nupkg` на `.zip` .
3. Распакуйте пакет.
4. Откройте папку `streamjsonrpc.1.5.43/lib/netstandard1.1/`.
5. Скопируйте в `StreamJsonRpc.dll` следующие расположения в папке обозреватель службы хранилища:
   * `StorageExplorer/resources/app/ServiceHub/Services/Microsoft.Developer.IdentityService/`
   * `StorageExplorer/resources/app/ServiceHub/Hosts/ServiceHub.Host.Core.CLR.x64/`

## <a name="open-in-explorer-from-the-azure-portal-doesnt-work"></a>"Открыть в проводнике" из портал Azure не работает

Если кнопка **Открыть в обозревателе** на портал Azure не работает, убедитесь, что вы используете совместимый браузер. Следующие браузеры прошли проверку на совместимость:
* Microsoft Edge
* Mozilla Firefox;
* Google Chrome;
* Microsoft Internet Explorer

## <a name="next-steps"></a>Дальнейшие действия

Если ни одно из этих решений не работает, [откройте вопрос в GitHub](https://github.com/Microsoft/AzureStorageExplorer/issues). Это можно также сделать, нажав кнопку **сообщить об ошибке в GitHub** в левом нижнем углу.

![Отзывы](./media/storage-explorer-troubleshooting/feedback-button.PNG)