---
title: Руководство по сканированию данных с помощью Azure Purview (предварительная версия)
description: В рамках этого руководства вы запустите начальный набор для настройки пространства данных, а затем просканируете данные из источников данных для помещения в каталог Azure Purview.
author: viseshag
ms.author: viseshag
ms.service: purview
ms.subservice: purview-data-catalog
ms.topic: tutorial
ms.date: 12/01/2020
ms.openlocfilehash: e373556d189e9fffc0626d19250e79c09962a004
ms.sourcegitcommit: 1a98b3f91663484920a747d75500f6d70a6cb2ba
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2021
ms.locfileid: "99062109"
---
# <a name="tutorial-scan-data-with-azure-purview-preview"></a>Руководство по сканированию данных с помощью Azure Purview (предварительная версия)

> [!IMPORTANT]
> Сейчас предоставляется предварительная версия Azure Purview. [Дополнительные условия использования Azure для предварительных версий в Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/) содержат дополнительные юридические условия, применимые к функциям Azure, которые предоставляются в бета-версии, предварительной версии или еще не выпущены в общедоступной версии по другим причинам.

В рамках этой *серии из пяти руководств* вы изучите основы управления данными в пространстве данных с помощью Azure Purview (предварительная версия). Пространство данных, создаваемое в этой части руководства, используется и в остальных частях серии.

В части 1 этой серии учебников вы выполните указанные ниже задачи:

> [!div class="checklist"]
>
> * создание пространства данных с разными ресурсами данных Azure;
> * сканирование данных в каталог.

## <a name="prerequisites"></a>Предварительные требования

* Подписка Azure. Если у вас еще нет подписки Azure, [создайте бесплатную учетную запись Azure](https://azure.microsoft.com/free/?ref=microsoft.com&utm_source=microsoft.com&utm_medium=docs&utm_campaign=visualstudio), прежде чем начинать работу.
* [Учетная запись Azure Purview.](create-catalog-portal.md)
* [Начальный набор](https://github.com/Azure/Purview-Samples/blob/master/PurviewStarterKitV4.zip), который развернет для вас пространство данных.

> [!NOTE]
> Начальный набор доступен только для ОС Windows.

## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на [портал Azure](https://portal.azure.com).

## <a name="create-a-data-estate"></a>Создание пространства данных

В этом разделе вы запустите скрипты начального набора, чтобы создать имитацию пространства данных. Пространством данных называется портфель всех данных, принадлежащих компании. Скрипт из этого начального набора выполняет следующие действия:

* создание учетной записи Хранилища BLOB-объектов Azure и заполнение ее данными;
* создание учетной записи Azure Data Lake Storage 2-го поколения;
* создание экземпляра Фабрики данных Azure и связывание этого экземпляра с Azure Purview;
* настройка и активация конвейера действия копирования между учетной записью Хранилища BLOB-объектов Azure и учетной записью Azure Data Lake Storage 2-го поколения;
* отправка связанных сведений о происхождении данных из Фабрики данных Azure в Azure Purview.

### <a name="prepare-to-run-the-starter-kit"></a>Подготовка к запуску начального набора

Чтобы настроить для начального набора клиентское программное обеспечение на компьютере Windows, сделайте следующее.

1. [Скачайте начальный набор](https://download.microsoft.com/download/9/7/9/979db3b1-0916-4997-a7fb-24e3d8f83174/PurviewStarterKitV4.zip) и извлеките его содержимое в произвольное расположение.


1. На локальном компьютере в поле поиска на панели задач Windows введите **PowerShell**. В списке результатов поиска щелкните правой кнопкой мыши **Windows PowerShell** и выберите **Запуск от имени администратора**.

1. В окне PowerShell введите следующую команду, заменив `<path-to-starter-kit>` реальным путем к папке с файлами, извлеченными из начального набора.

   ```powershell
   dir -Path <path-to-starter-kit> -Recurse | Unblock-File
   ```

1. Введите следующую команду для установки командлетов Azure.

   ```powershell
   Install-Module -Name Az -AllowClobber -Scope CurrentUser
   ```

1. Если появится предупреждение *Для продолжения требуется поставщик NuGet*, введите **Y** и нажмите клавишу ВВОД.

1. Если появится предупреждение *Ненадежный репозиторий*, введите **A** и нажмите клавишу ВВОД.

Установка требуемых модулей в PowerShell может занять около минуты.

### <a name="collect-data-needed-to-run-the-scripts"></a>Сбор необходимых данных для выполнения скриптов

Прежде чем запускать скрипты PowerShell для начальной загрузки каталога, получите значения следующих аргументов для использования в скриптах:

* идентификатор клиента;
   1. На [портале Azure](https://portal.azure.com)выберите **Azure Active Directory**.
   1. В разделе **Управление** в области навигации слева выберите **Свойства**. Затем выберите значок копирования для значения **Идентификатор клиента**, чтобы сохранить его в буфер обмена. Вставьте это значение в текстовый редактор для последующего использования.

* SubscriptionID
   1. На портале Azure найдите и выберите имя экземпляра Azure Purview, который вы создали при подготовке предварительных требований.
   1. Перейдите в раздел **Обзор** и сохраните идентификатор GUID из поля **Идентификатор подписки**.

   > [!NOTE]
   > Убедитесь, что вы используете ту самую подписку, в которой была создана учетная запись Azure Purview. Эту же подписку мы ранее поместили в список разрешений.

* CatalogName: имя учетной записи Azure Purview, созданной в соответствии с [этими инструкциями](create-catalog-portal.md).

* CatalogResourceGroupName: имя группы ресурсов, в которой была создана учетная запись Azure Purview.

### <a name="verify-permissions"></a>Проверка разрешений

Выполните следующие шаги, чтобы добавить пользователя, от имени которого выполняется скрипт, в учетную запись Azure Purview, созданную при подготовке предварительных требований. Пользователям для работы нужны роли *куратора данных Purview* и *администратора источника данных Purview*. 

Если вы создавали учетную запись Azure Purview самостоятельно, доступ был вам предоставлен автоматически, так что можете пропустить этот раздел.

1. Перейдите на страницу "Учетные записи Purview" на портале Azure и выберите учетную запись Azure Purview, которую вы хотите изменить.

1. На странице этой учетной записи выберите вкладку **Управление доступом (IAM)** и щелкните **Добавить**.

1. Выберите **Добавить назначение ролей**.

1. Введите **Роль куратора данных Purview** в поле *Роль*.
 
1. Оставьте значение по умолчанию в поле *Назначение доступа для*. Это должно быть значение **Пользователь, группа или субъект-служба**.

1. В разделе **Выберите** введите имя пользователя, который запускает скрипт.

1. Щелкните **Сохранить**.

1. Повторите предыдущие шаги, задав для параметра *Роль* значение **Роль администратора источника данных Purview**.

Дополнительные сведения см. в [описании разрешений каталога](catalog-permissions.md).

### <a name="run-the-client-side-setup-scripts"></a>Запуск скриптов установки на стороне клиента

Когда настройка каталога завершится, выполните в окне PowerShell следующие скрипты, чтобы создать ресурсы, заменив заполнители ранее собранными значениями.

1. Чтобы перейти к каталогу начального набора, выполните следующую команду. Замените `path-to-starter-kit` путем к папке с извлеченным файлом.

   ```powershell
   cd <path-to-starter-kit>
   ```

1. Следующая команда задает политику выполнения для локального компьютера. Введите **A**, что обозначает *Да для всех*, в ответ на запрос об изменении политики выполнения.

   ```powershell
   Set-ExecutionPolicy -ExecutionPolicy Unrestricted
   ```

1. Подключитесь к Azure, выполнив следующую команду. Замените заполнители `TenantID` и `SubscriptionID` .

   ```powershell
   .\RunStarterKit.ps1 -ConnectToAzure -TenantId <TenantID> `
   -SubscriptionId <SubscriptionID>
   ```

   При выполнении этой команды может появиться всплывающее окно для входа с учетными данными Azure Active Directory.


1. Выполните следующую команду, чтобы запустить начальный набор. Замените заполнители `CatalogName`, `TenantID`, `SubscriptionID`, `NewResourceGroupName` и `CatalogResourceGroupName`. Для `NewResourceGroupName` укажите уникальное имя (должно содержать только строчные числа и буквы) группы ресурсов, которая будет содержать пространство данных.

   > [!IMPORTANT]
   > Для параметра **newresourcegroupname** допускаются только цифры и строчные буквы общим количеством не более 17 символов. **Прописные буквы и специальные символы не допускаются.** Это ограничение связано с правилами именования для учетных записей хранения.

   ```powershell
   .\RunStarterKit.ps1 -CatalogName <CatalogName> -TenantId <TenantID>`
   -ResourceGroup <newresourcegroupname> `
   -SubscriptionId <SubscriptionID> `
   -CatalogResourceGroup <CatalogResourceGroupName>
   ```

Создание и настройка среды могут занять до 10 минут. В течение этого времени могут отображаться различные всплывающие окна, которые можно спокойно игнорировать. Не закрывайте окно **BlobDataCreator.exe**, оно закроется автоматически по завершении работы.

Когда появится сообщение `Executing Copy pipeline xxxxxxxxxx-487e-4fc4-9628-92dd8c2c732b`, дождитесь, пока запустится и завершит работу очередной экземпляр **BlobDataCreator.exe**.

> [!IMPORTANT]
> Если значение Number of active tasks (Число активных задач) перестанет уменьшаться, выйдите из окна создателя BLOB-объектов и нажмите клавишу ВВОД в окне PowerShell.

Когда этот процесс завершится, будет готова группа ресурсов с указанным именем. В этой группе ресурсов содержатся учетные записи Фабрики данных Azure, Хранилища BLOB-объектов Azure и Azure Data Lake Storage 2-го поколения. Группа ресурсов размещается в указанной вами подписке.

## <a name="scan-data-into-the-catalog"></a>Сканирование данных в каталог

Сканированием называется процесс, при котором каталог подключается напрямую к источнику данных по заданному пользователем расписанию. Каталог отображает данные компании, используя процесс сканирования, сведения о происхождении данных, портал и API. Эти средства применяются для изучения содержимого, извлечения схем и анализа семантики. В этом разделе вы настроите сканирование для источников данных, которые вы создали с помощью начального набора.

Скрипт начального набора при запуске создал два источника данных: хранилище BLOB-объектов Azure и Azure Data Lake Storage 2-го поколения. Сканирование позволит поочередно загрузить эти источники данных в каталог.

### <a name="authenticate-to-your-storage-with-managed-identity"></a>Аутентификация в хранилище с использованием управляемого удостоверения

При создании учетной записи автоматически создается управляемое удостоверение с тем же именем, что и у учетной записи Azure Purview. Прежде чем сканировать данные, необходимо предоставить Azure Purview роли с разрешениями для учетных записей хранения.

1. Перейдите к группе ресурсов, которую создал начальный набор, и выберите учетную запись хранилища BLOB-объектов.

1. Щелкните **Управление доступом (IAM)** в области навигации слева. Затем щелкните **+ Добавить**.

1. Для параметра "Роль" задайте значение **Читатель данных BLOB-объектов хранилища** и введите имя учетной записи Azure в поле **Выберите**. Затем щелкните **Сохранить**, чтобы назначить эту роль учетной записи Purview.

   :::image type="content" source="media/tutorial-scan-data/add-role-assignment.png" alt-text="Добавление назначения роли":::

1. Повторите предыдущие шаги для Azure Data Lake Storage 2-го поколения.

### <a name="scan-your-data-sources"></a>Сканирование источников данных

1. Перейдите к ресурсу Azure Purview на [портале Azure](https://portal.azure.com) и выберите элемент *Open Purview Studio* (Открыть Purview Studio). Вы автоматически перейдете на домашнюю страницу Purview Studio.

1. На веб-странице каталога выберите **Источники** и щелкните **Зарегистрировать**. Теперь выберите вариант **Хранилище BLOB-объектов Azure** и щелкните **Продолжить**.

   :::image type="content" source="media/tutorial-scan-data/add-blob-storage.png" alt-text="Регистрация ресурса хранилища BLOB-объектов":::

1. На странице **Регистрация источников** введите значение **Имя**. В поле **Имя учетной записи хранения** выберите учетную запись хранилища BLOB-объектов Azure, которую ранее создали с помощью начального набора. Это учетная запись с именем `<YourResourceGroupName>adcblob`. Нажмите кнопку **Готово**.

   :::image type="content" source="./media/tutorial-scan-data/register-azure-blob-storage.png" alt-text="Снимок экрана демонстрирует параметры для регистрации источника данных хранилища BLOB-объектов Azure." border="true":::

1. В представлении карты **Источники данных** выберите **Новое сканирование** на плитке Хранилища BLOB-объектов Azure.

   :::image type="content" source="./media/tutorial-scan-data/select-setup-scan.png" alt-text="Снимок экрана демонстрирует, как выбрать настройку сканирования для источника данных." border="true":::

1. На странице **Сканирование** введите имя для сканирования, затем выберите управляемое удостоверение в раскрывающемся списке **Учетные данные** и щелкните **Продолжить**.

   :::image type="content" source="media/tutorial-scan-data/scan-blob.png" alt-text="Сканирование хранилища BLOB-объектов в Azure Purview":::

1. Вы можете задать в качестве области сканирования конкретные большие двоичные объекты. Для выполнения этого руководства оставьте выбранными все ресурсы и щелкните **Продолжить**.

   :::image type="content" source="media/tutorial-scan-data/scope-your-scan.png" alt-text="Область сканирования для хранилища":::

1. Выберите набор правил сканирования по умолчанию и щелкните **Продолжить**.

1. Можно также настроить триггер сканирования для регулярных сканирований. Для выполнения этого руководства выберите вариант **Однократно** и щелкните **Продолжить**.

1. Щелкните **Сохранить и запустить**, чтобы завершить сканирование.

1. Повторите предыдущие шаги для сканирования учетной записи Azure Data Lake Storage 2-го поколения.

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы узнали, как выполнять следующие задачи:
> [!div class="checklist"]
>
> * запуск скрипта начального набора для настройки среды пространства данных;
> * сканирование данных для отправки в каталог Azure Purview.

Переходите к следующему руководству, где объясняется навигация по домашней странице и поиск ресурса.

> [!div class="nextstepaction"]
> [Навигация по домашней странице и поиск активов](tutorial-asset-search.md)
