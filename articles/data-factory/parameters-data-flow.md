---
title: Параметризация потоков данных для сопоставления
description: Узнайте, как параметризовать поток данных сопоставления из конвейеров фабрики данных.
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.date: 05/01/2020
ms.openlocfilehash: 564c7cf6e9627db08d543b964ce476e71bfb473d
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "93040755"
---
# <a name="parameterizing-mapping-data-flows"></a>Параметризация потоков данных для сопоставления

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)] 

Сопоставление потоков данных в фабрике данных Azure поддерживает использование параметров. Определите параметры в определении потока данных и используйте их во всех выражениях. Значения параметров задаются вызывающим конвейером через действие "выполнение потока данных". Задать значения в выражениях действия потока данных можно тремя способами:

* задайте динамическое значение с помощью языка выражений для потока управления конвейером;
* задайте динамическое значение с помощью языка выражений потока данных;
* задайте статическое литеральное значение с помощью любого из этих двух языков выражений.

Используйте эту возможность, чтобы потоки данных были общими, гибкими и пригодными для многократного использования. С помощью этих параметров можно параметризовать параметры потока данных и выражения.

## <a name="create-parameters-in-a-mapping-data-flow"></a>Создание параметров в потоке данных сопоставления

Чтобы добавить параметры в поток данных, щелкните в пустой части холста потока. Вы увидите общие свойства. В области Параметры появится вкладка с именем **параметр**. Выберите **создать** , чтобы создать новый параметр. Для каждого параметра необходимо указать имя, выбрать тип и при необходимости задать значение по умолчанию.

![Создание параметров потока данных](media/data-flow/create-params.png "Создание параметров потока данных")

## <a name="use-parameters-in-a-mapping-data-flow"></a>Использование параметров в потоке данных сопоставления 

На параметры можно ссылаться в любом выражении потока данных. Параметры начинаются с $ и являются неизменяемыми. Список доступных параметров можно найти в построителе выражений на вкладке **Параметры** .

![На снимке экрана показаны доступные параметры на вкладке Параметры.](media/data-flow/parameter-expression.png "Выражение параметра потока данных")

Можно быстро добавить дополнительные параметры, выбрав **новый параметр** и указав имя и тип.

![На снимке экрана показаны параметры на вкладке Параметры с добавленными новыми параметрами.](media/data-flow/new-parameter-expression.png "Выражение параметра потока данных")

## <a name="assign-parameter-values-from-a-pipeline"></a>Назначение значений параметров из конвейера

После создания потока данных с параметрами его можно выполнить из конвейера с помощью действия "выполнение потока данных". После добавления действия на холст конвейера вы увидите доступные параметры потока данных на вкладке **Параметры** действия.

При назначении значений параметров можно использовать язык [выражений конвейера](control-flow-expression-language-functions.md) или [язык выражений потока данных](data-flow-expression-functions.md) на основе типов Spark. Каждый поток данных сопоставления может иметь любое сочетание параметров конвейера и выражения потока данных.

![На снимке экрана показана вкладка Параметры с выражением потока данных, выбранным для значения MyParam.](media/data-flow/parameter-assign.png "Задание параметра потока данных")

### <a name="pipeline-expression-parameters"></a>Параметры выражения конвейера

Параметры выражений конвейера позволяют ссылаться на системные переменные, функции, параметры конвейера и переменные, аналогичные другим действиям конвейера. Если щелкнуть **выражение конвейера**, откроется Боковая навигационная, позволяющая ввести выражение с помощью построителя выражений.

![На снимке экрана показана панель построитель выражений.](media/data-flow/parameter-pipeline.png "Задание параметра потока данных")

При ссылке параметры конвейера оцениваются, а затем их значения используются в языке выражений потока данных. Тип выражения конвейера не должен соответствовать типу параметра потока данных. 

#### <a name="string-literals-vs-expressions"></a>Выражения VS для строковых литералов

При назначении параметра выражения конвейера типа String по умолчанию добавляются кавычки, и значение будет оцениваться как литерал. Чтобы считать значение параметра в виде выражения потока данных, установите флажок выражение рядом с параметром.

![Снимок экрана показывает выражение панели параметров потока данных, выбранное для параметра.](media/data-flow/string-parameter.png "Задание параметра потока данных")

Значение, если параметр потока данных `stringParam` ссылается на параметр конвейера со значением `upper(column1)` . 

- Если выбрано выражение, `$stringParam` вычисляется значение Столбец1 все прописные.
- Если выражение не проверяется (поведение по умолчанию),  `$stringParam` результатом вычисления будет `'upper(column1)'`

#### <a name="passing-in-timestamps"></a>Передача меток времени

В языке выражений конвейера системные переменные, такие как `pipeline().TriggerTime` и, например, `utcNow()` возвращают метки времени в виде строк в формате "гггг-мм-дд \' T \' чч: мм: СС". ССССССЗ ". Чтобы преобразовать их в параметры потока данных типа timestamp, используйте интерполяцию строк для включения в функцию нужной метки времени `toTimestamp()` . Например, чтобы преобразовать время срабатывания конвейера в параметр потока данных, можно использовать `toTimestamp(left('@{pipeline().TriggerTime}', 23), 'yyyy-MM-dd\'T\'HH:mm:ss.SSS')` . 

![На снимке экрана показана вкладка Параметры, на которой можно ввести время активации.](media/data-flow/parameter-timestamp.png "Задание параметра потока данных")

> [!NOTE]
> Потоки данных могут поддерживать только до 3 миллисекунд. `left()`Функция используется для усечения дополнительных цифр.

#### <a name="pipeline-parameter-example"></a>Пример параметра конвейера

Предположим, что у вас есть целочисленный параметр `intParam` , ссылающийся на параметр конвейера типа String, `@pipeline.parameters.pipelineParam` . 

![На снимке экрана показана вкладка Параметры с параметрами с именами Стрингпарам и Интпарам.](media/data-flow/parameter-pipeline-2.png "Задание параметра потока данных")

`@pipeline.parameters.pipelineParam` присваивается значение `abs(1)` во время выполнения.

![На снимке экрана показана вкладка Параметры с выбранным значением b s (1).](media/data-flow/parameter-pipeline-4.png "Задание параметра потока данных")

При `$intParam` указании ссылки в выражении, например в производном столбце, будет вычислено значение `abs(1)` return `1` . 

![На снимке экрана показано значение Columns.](media/data-flow/parameter-pipeline-3.png "Задание параметра потока данных")

### <a name="data-flow-expression-parameters"></a>Параметры выражения потока данных

Выберите **выражение потока данных** , чтобы открыть построитель выражений потока данных. Вы сможете ссылаться на функции, другие параметры и любой определенный столбец схемы по всему потоку данных. Это выражение будет оцениваться так, как если бы оно ссылалось на.

> [!NOTE]
> Если передать недопустимое выражение или создать ссылку на столбец схемы, который не существует в этом преобразовании, параметр будет иметь значение null.


### <a name="passing-in-a-column-name-as-a-parameter"></a>Передача имени столбца в качестве параметра

Распространенным шаблоном является передача имени столбца в качестве значения параметра. Если столбец определен в схеме потока данных, вы можете ссылаться на него непосредственно в виде строкового выражения. Если столбец не определен в схеме, используйте `byName()` функцию. Не забудьте привести столбец к соответствующему типу с помощью функции приведения, такой как `toString()` .

Например, если требуется сопоставлять строковый столбец на основе параметра `columnName` , можно добавить преобразование «Производный столбец», равное `toString(byName($columnName))` .

![Передача имени столбца в качестве параметра](media/data-flow/parameterize-column-name.png "Передача имени столбца в качестве параметра")

## <a name="next-steps"></a>Дальнейшие действия
* [Выполнение действия потока данных](control-flow-execute-data-flow-activity.md)
* [Выражения потока управления](control-flow-expression-language-functions.md)
