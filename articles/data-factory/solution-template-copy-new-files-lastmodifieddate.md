---
title: Копировать новые и измененные файлы по LastModifiedDate
description: Узнайте, как использовать шаблон решения для копирования новых и измененных файлов с помощью LastModifiedDate с фабрикой данных Azure.
author: dearandyxu
ms.author: yexu
ms.reviewer: ''
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 3/8/2019
ms.openlocfilehash: 94d09dc96d017dba3b16cc5fe113272a9393741d
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100362086"
---
# <a name="copy-new-and-changed-files-by-lastmodifieddate-with-azure-data-factory"></a>Копирование новых и измененных файлов с помощью LastModifiedDate с фабрикой данных Azure

[!INCLUDE[appliesto-adf-xxx-md](includes/appliesto-adf-xxx-md.md)]

В этой статье описывается шаблон решения, который можно использовать для копирования новых и измененных файлов только с помощью LastModifiedDate из файлового хранилища в целевое хранилище. 

## <a name="about-this-solution-template"></a>Информация о шаблоне решения

Этот шаблон сначала выбирает новые и измененные файлы только по их атрибутам **LastModifiedDate**, а затем копирует выбранные файлы из хранилища источников данных в хранилище назначения данных.

Шаблон содержит одно действие:
- **Копировать** для копирования новых и измененных файлов только по LastModifiedDate из хранилища файлов в целевое хранилище.

Шаблон определяет шесть параметров:
-  *FolderPath_Source* — это путь к папке, в которой можно считывать файлы из исходного хранилища. Необходимо заменить значение по умолчанию на собственный путь к папке.
-  *Directory_Source* — это путь к вложенной папке, в которую можно считывать файлы из исходного хранилища. Необходимо заменить значение по умолчанию своим собственным путем к вложенной папке.
-  *FolderPath_Destination* — путь к папке, в которую необходимо скопировать файлы в целевое хранилище. Необходимо заменить значение по умолчанию на собственный путь к папке.
-  *Directory_Destination* — путь к вложенной папке, куда нужно скопировать файлы в целевое хранилище. Необходимо заменить значение по умолчанию своим собственным путем к вложенной папке.
-  *LastModified_From* используется для выбора файлов, атрибут LastModifiedDate которых равен значению DateTime или равен ему.  Чтобы выбрать только новые файлы, которые не были скопированы в последний раз, это значение даты и времени может быть временем, когда конвейер был активирован в последний раз. Вы можете заменить значение по умолчанию "2019-02-01T00:00:00Z" ожидаемым LastModifiedDate в часовом поясе UTC. 
-  *LastModified_To* используется для выбора файлов, атрибут LastModifiedDate которых предшествует этому значению DateTime. Чтобы выбрать только новые файлы, которые не были скопированы в последний раз, это значение даты и времени может быть текущим временем.  Вы можете заменить значение по умолчанию "2019-02-01T00:00:00Z" ожидаемым LastModifiedDate в часовом поясе UTC. 

## <a name="how-to-use-this-solution-template"></a>Использование шаблона решения

1. Перейдите к шаблону **Копировать новые файлы только по LastModifiedDate**. Создайте **новое** подключение к исходному хранилищу. В исходном хранилище хранилища необходимо скопировать файлы.

    ![Создание нового подключения к источнику](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate1.png)
    
2. Создайте **новое** подключение к целевому хранилищу. В целевом хранилище необходимо скопировать файлы. 

    ![Создание нового подключения к целевому хранилищу](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate3.png)

3. Щелкните **Использовать этот шаблон**.

    ![Использовать этот шаблон](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate4.png)
    
4. На панели откроется доступный конвейер, как показано в следующем примере:

    ![Отображение конвейера](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate5.png)

5. Выберите **Отладка**, запишите значения **параметров** и нажмите кнопку **Готово**.  На рисунке ниже мы устанавливаем параметры следующим образом.
   - **FolderPath_Source** = sourcefolder
   - **Directory_Source** — вложенная папка
   - **FolderPath_Destination** = destinationfolder
   - **Directory_Destination** — вложенная папка
   - **LastModified_From** = 2019-02-01T00:00:00Z
   - **LastModified_To** = 2019-03-01T00:00:00Z
    
    В примере показано, что файлы, которые были в последний раз изменены в диапазоне времени (**2019-02-01T00:00:00Z** до **2019-03-01T00:00:00Z**), будут скопированы из исходного пути **sourcefolder/** в папку назначения путь к **папке destinationfolder/**.  Их можно заменить собственными параметрами.

    ![Запуск конвейера](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate6.png)

6. Просмотрите результаты. Вы увидите, что в целевое хранилище скопированы только те файлы, которые были изменены в течение заданного интервала времени.

    ![Просмотр результатов](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate7.png)
    
7. Теперь можно добавить триггер Windows "переворачивающегося" для автоматизации этого конвейера, чтобы конвейер всегда мог периодически копировать новые и измененные файлы только LastModifiedDate.  Выберите **добавить триггер** и щелкните **создать или изменить**.

    ![Снимок экрана, посвященный пункту меню "создать/изменить", который отображается при выборе пункта "добавить триггер".](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate8.png)
    
8. В окне **Add Triggers** (Добавление триггеров) выберите **+ Создать**.

9. Выберите **окно "переворачивающегося"** для типа триггера, установите **каждые 15 минут** в качестве периодичности (можно изменить на любое время). Выберите **Да** для поля активировано и нажмите кнопку **ОК**.

    ![Создание триггера](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate10.png)    
    
10. Задайте значения для **параметров запуска триггера** следующим образом, а затем нажмите кнопку **Готово**.
    - **FolderPath_Source**  =  **sourcefolder**.  Вы можете заменить папку в исходном хранилище данных.
    - **Directory_Source**  =  **вложенная папка**.  Вы можете заменить вложенной папкой в исходном хранилище данных.
    - **FolderPath_Destination**  =  **destinationfolder**.  Вы можете заменить папку в целевом хранилище данных.
    - **Directory_Destination**  =  **вложенная папка**.  Вы можете заменить вложенной папкой в целевом хранилище данных.
    - **LastModified_From**  =   **\@ триггер (). Outputs. windowStartTime**.  Это системная переменная из триггера, определяющая время, когда конвейер был активирован в последний раз.
    - **LastModified_To**  =  **\@ триггер (). Outputs. windowEndTime**.  Это системная переменная из триггера, определяющая время активации конвейера на данный момент.
    
    ![Входные параметры](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate11.png)
    
11. Выберите **Опубликовать все**.
    
    ![Опубликовать все](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate12.png)

12. Создание новых файлов в исходной папке хранилища источников данных.  Теперь вы ожидаете автоматического запуска конвейера, и в целевое хранилище будут скопированы только новые файлы.

13. Выберите вкладку **мониторинг** на левой навигационной панели и подождите около 15 минут, если повторение триггера задано каждые 15 минут. 

14. Просмотрите результаты. Вы увидите, что конвейер будет активирован автоматически каждые 15 минут, и только новые или измененные файлы из исходного хранилища будут скопированы в целевое хранилище в каждом выполнении конвейера.

    ![Снимок экрана, на котором показаны результаты, возвращаемые при активации конвейера.](media/solution-template-copy-new-files-lastmodifieddate/copy-new-files-lastmodifieddate15.png)
    
## <a name="next-steps"></a>Дальнейшие действия

- [Общие сведения о службе фабрики данных Azure, службе интеграции данных в облаке](introduction.md)
