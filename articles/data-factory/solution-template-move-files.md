---
title: Перемещение файлов между файловым хранилищем
description: Узнайте, как использовать шаблон решения для перемещения файлов между файловым хранилищем с помощью фабрики данных Azure.
author: dearandyxu
ms.author: yexu
ms.reviewer: ''
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 7/12/2019
ms.openlocfilehash: c88f2d25046ee017fccd2cee6e951be72d4dda91
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100361950"
---
# <a name="move-files-with-azure-data-factory"></a>Перемещение файлов с помощью фабрики данных Azure

[!INCLUDE[appliesto-adf-xxx-md](includes/appliesto-adf-xxx-md.md)]

Действие копирования ADF имеет встроенную поддержку сценария "Move" при копировании двоичных файлов между хранилищами хранилища.  Чтобы включить его, установите для параметра "Делетефилесафтеркомплетион" значение true в действии копирования. После этого действие копирования удалит файлы из хранилища источников данных после завершения задания. 

В этой статье описывается шаблон решения, а также еще один подход к использованию ADF-гибкого потока управления, а также действие копирования и действия по удалению для достижения того же сценария. Один из распространенных сценариев использования этого шаблона: файлы постоянно удаляются в целевую папку исходного хранилища. Создав триггер расписания, конвейер ADF может периодически перемещать эти файлы из источника в целевое хранилище.  Способ, которым конвейер ADF достигает "перемещения файлов", получает файлы из целевой папки, копируя их в другую папку в целевом хранилище, а затем удаляя те же файлы из целевой папки в исходном хранилище.

> [!NOTE]
> Имейте в виду, что этот шаблон предназначен для перемещения файлов, а не для перемещения папок.  Если необходимо переместить папку, изменив набор данных так, чтобы она содержала только путь к папке, а затем использовать действие копирования и удаления для ссылки на тот же набор данных, представляющий папку, необходимо соблюдать осторожность. Дело в том, что новые файлы НЕ должны поступать в папку между операциями копирования и удаления. Если же в папку поступили новые файлы сразу после того, как действие копирования завершило копирование файлов, а действие Delete еще не начало работу, вероятно, что действие Delete удалит новые файлы, которые еще НЕ успели скопироваться в назначенное место.

## <a name="about-this-solution-template"></a>Информация о шаблоне решения

Этот шаблон получает файлы из исходного хранилища на основе файлов. Затем каждый из них перемещается в целевое хранилище.

Шаблон содержит пять действий:
- Параметр **Metadata** возвращает список объектов, включая файлы и вложенные папки из папки в исходном хранилище. Объекты не будут извлекаться рекурсивно. 
- **Фильтр** Фильтрация списка объектов в действии с помощью **метаданных** для выбора только файлов. 
- **Foreach** получает список файлов из действия **фильтра** , а затем перебирает список и передает каждый файл действию копирования и удалению.
- **Копировать** копирует один файл из источника в целевое хранилище.
- **Delete** удаляет один и тот же файл из исходного хранилища.

Шаблон определяет четыре параметра:
- *SourceStore_Location* — это путь к папке исходного хранилища, из которой нужно переместить файлы. 
- *SourceStore_Directory* — это путь к вложенной папке исходного хранилища, из которого нужно переместить файлы.
- *DestinationStore_Location* — это путь к папке конечного хранилища, куда нужно переместить файлы. 
- *DestinationStore_Directory* — это путь к вложенной папке конечного хранилища, куда нужно переместить файлы.

## <a name="how-to-use-this-solution-template"></a>Использование шаблона решения

1. Перейдите к шаблону **Перемещение файлов** . Выберите существующее подключение или создайте **новое** подключение к исходному хранилищу файлов, из которого нужно переместить файлы. Имейте в виду, что **DataSource_Folder** и **DataSource_File** ссылаются на одно и то же подключение к исходному хранилищу файлов.

    ![Создание нового подключения к источнику](media/solution-template-move-files/move-files1.png)

2. Выберите существующее подключение или создайте **новое** подключение к целевому хранилищу файлов, куда нужно переместить файлы.

    ![Создание нового подключения к целевому хранилищу](media/solution-template-move-files/move-files2.png)

3. Выберите **использовать вкладку шаблон** .
    
4. Вы увидите конвейер, как показано в следующем примере:

    ![Отображение конвейера](media/solution-template-move-files/move-files4.png)

5. Выберите **Отладка**, введите **Параметры**, а затем нажмите **Готово**.   Параметры — это путь к папке, в которую нужно переместить файлы, и путь к папке, в которую нужно переместить файлы. 

    ![Запуск конвейера](media/solution-template-move-files/move-files5.png)

6. Просмотрите результаты.

    ![Просмотр результатов](media/solution-template-move-files/move-files6.png)

## <a name="next-steps"></a>Дальнейшие действия

- [Копирование новых и измененных файлов с помощью LastModifiedDate с фабрикой данных Azure](solution-template-copy-new-files-lastmodifieddate.md)

- [Копирование файлов из нескольких контейнеров с помощью Фабрики данных Azure](solution-template-copy-files-multiple-containers.md)