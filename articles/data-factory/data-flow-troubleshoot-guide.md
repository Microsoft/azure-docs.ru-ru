---
title: Устранение неполадок при сопоставлении потоков данных
description: Узнайте, как устранять неполадки потока данных в фабрике данных Azure.
ms.author: makromer
author: kromerm
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: troubleshooting
ms.date: 09/11/2020
ms.openlocfilehash: f8a852a8c4197169061a9c7633f4f363ad057337
ms.sourcegitcommit: 15d27661c1c03bf84d3974a675c7bd11a0e086e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "102505806"
---
# <a name="troubleshoot-mapping-data-flows-in-azure-data-factory"></a>Устранение неполадок сопоставления потоков данных в фабрике данных Azure

[!INCLUDE[appliesto-adf-xxx-md](includes/appliesto-adf-xxx-md.md)]

В этой статье рассматриваются распространенные методы устранения неполадок при сопоставлении потоков данных в фабрике данных Azure.

## <a name="common-error-codes-and-messages"></a>Распространенные коды ошибок и сообщения об ошибках 

### <a name="error-code-df-executor-sourceinvalidpayload"></a>Код ошибки: DF-Executor-SourceInvalidPayload
- **Сообщение**. Не удалось выполнить предварительный просмотр данных, отладку и поток данных конвейера, так как контейнер не существует
- **Причина**: набор данных содержит контейнер, который не существует в хранилище.
- **Рекомендация**: Убедитесь, что контейнер, указанный в наборе данных, существует и доступен.

### <a name="error-code-df-executor-systemimplicitcartesian"></a>Код ошибки: DF-Executor-SystemImplicitCartesian

- **Сообщение**. Неявное декартово произведение для внутреннего соединения не поддерживается, используйте перекрестное соединение. Столбцы, используемые при соединении, должны создавать уникальные ключи для строк.
- **Причина**: неявные декартовы продукты для внутренних соединений между логическими планами не поддерживаются. Если вы используете столбцы в соединении, создайте уникальный ключ с по крайней мере одним столбцом с обеих сторон связи.
- **Рекомендация**. для соединений, не основанных на равенство, используйте пользовательское перекрестное соединение.

### <a name="error-code-df-executor-systeminvalidjson"></a>Код ошибки: DF-Executor-SystemInvalidJson

- **Сообщение**. Ошибка синтаксического анализа JSON, неподдерживаемая кодировка или многострочность
- **Причина**: возможные проблемы с JSON-файлом: неподдерживаемая кодировка, повреждение байт или использование источника JSON в качестве одного документа во многих вложенных строках.
- **Рекомендация**: Убедитесь, что кодировка JSON-файла поддерживается. В преобразовании «источник», использующем набор данных JSON, разверните **Параметры JSON** и включите **один документ**.
 
### <a name="error-code-df-executor-broadcasttimeout"></a>Код ошибки: DF-Executor-BroadcastTimeout

- **Сообщение**. Ошибка окончания времени ожидания трансляции. Убедитесь, что широковещательный поток создает данные в течение 60 секунд во время отладки и 300 секунд при выполнении заданий.
- **Причина**: для широковещательных запусков по умолчанию используется время ожидания в 60 секунд, а для выполнения заданий — 300 секунд. Поток, выбранный для вещания, слишком велик для получения данных в пределах этого ограничения.
- **Рекомендация**: на вкладке **Оптимизация** в преобразованиях потока данных для операций JOIN, EXISTS и Lookup. Параметр широковещательной рассылки по умолчанию имеет значение **Auto**. Если задан параметр **Auto** или вы вручную настраиваете левую или правую сторону для вещания в **фиксированном** состоянии, можно настроить более крупную конфигурацию среды выполнения интеграции Azure (IR) или отключить вещание. Для наилучшей производительности потоков данных рекомендуется разрешить Spark вещание с помощью **Auto** и использовать оптимизированную для памяти Azure IR. 
 
  Если вы запускаете поток данных при выполнении теста отладки из запуска конвейера отладки, вы можете столкнуться с этим условием чаще. Это связано с тем, что фабрика данных Azure регулирует время ожидания вещания до 60 секунд, чтобы обеспечить более быструю процедуру отладки. Вы можете продлить время ожидания до 300-секундного запуска триггера. Для этого можно использовать параметр среды выполнения действия " **Отладка**",  >   чтобы использовать Azure IR, определенные в действии конвейера "выполнение потока данных".

- **Сообщение**. ошибка истечения времени ожидания широковещательного подключения. чтобы избежать этой проблемы, можно выбрать параметр "Выкл." вещания в преобразовании «соединение/существует» или «Уточняющий запрос». Если вы планируете широковещательное соединение для повышения производительности, убедитесь, что широковещательный поток может создавать данные в течение 60 секунд при выполнении отладки и 300 секунд при выполнении заданий.
- **Причина**: время ожидания вещания по умолчанию составляет 60 секунд в запусках отладки и 300 секунд в выполнении задания. В широковещательном соединении поток, выбранный для вещания, слишком велик для получения данных в пределах этого предела. Если широковещательное соединение не используется, передача по умолчанию по потоку данных может достигать такого же ограничения.
- **Рекомендация**. Отключите параметр Broadcast или Избегайте широковещательной трансляции больших потоков данных, для которых обработка может занять более 60 секунд. Выберите поток меньшего размера для вещания. Большие таблицы хранилища данных SQL Azure и исходные файлы обычно не являются хорошим выбором. При отсутствии широковещательного подключения при возникновении этой ошибки используйте кластер большего размера.

### <a name="error-code-df-executor-conversion"></a>Код ошибки: DF-Executor-Conversion

- **Сообщение**. Сбой преобразования в дату или время из-за недопустимого символа
- **Причина**: данные не имеют ожидаемого формата.
- **Рекомендация**: Используйте правильный тип данных.

### <a name="error-code-df-executor-invalidcolumn"></a>Код ошибки: DF-Executor-InvalidColumn
- **Сообщение**. Необходимо указать имя столбца в запросе, задайте псевдоним при использовании функции SQL
- **Причина**: не указано имя столбца.
- **Рекомендация**: Задайте псевдоним, если вы используете функцию SQL, например min () или Max ().

### <a name="error-code-df-executor-drivererror"></a>Код ошибки: DF-исполнителя-Дривереррор
- **Сообщение**: INT96 имеет устаревший тип отметок времени, который не поддерживается ПОТОКОМ данных ADF. Попробуйте обновить тип столбца до последних типов.
- **Причина**: ошибка драйвера.
- **Рекомендация**: INT96 — это устаревший тип отметки времени, который не поддерживается потоком данных фабрики данных Azure. Рекомендуется обновить тип столбца до последнего типа.

### <a name="error-code-df-executor-blockcountexceedslimiterror"></a>Код ошибки: DF-исполнителя-Блокккаунтексцеедслимитеррор
- **Сообщение**: Счетчик незафиксированных блоков не может превышать максимальное ограничение в 100 000 блоков. Проверьте конфигурацию большого двоичного объекта.
- **Причина**: максимальное число незафиксированных блоков в большом двоичном объекте — 100 000.
- **Рекомендация**: чтобы получить дополнительные сведения об этой проблеме, обратитесь к группе разработчиков продуктов Майкрософт.

### <a name="error-code-df-executor-partitiondirectoryerror"></a>Код ошибки: DF-исполнителя-Партитиондиректореррор
- **Сообщение**: указанный исходный путь содержит либо несколько секционированных каталогов (например, <Source Path> /<корневой каталог 1>/a = 10/b = 20, <Source Path> /<корневой каталог 2>/c = 10/d = 30) или секционированный каталог с другим файлом или несекционированным каталогом (например, <Source Path> /<корневой каталог 1>/a = 10/b = 20, <Source Path> /Directory 2/file1), удалите корневой каталог раздела из исходного пути и прочтите его с помощью отдельного преобразования источника.
- **Причина**: исходный путь содержит несколько секционированных каталогов или секционированный каталог с другим файлом или несекционированным каталогом.
- **Рекомендация**: удалите секционированный корневой каталог из исходного пути и прочтите его с помощью отдельного преобразования источника.

### <a name="error-code-df-executor-invalidtype"></a>Код ошибки: DF-исполнителя-Инвалидтипе
- **Сообщение**. Убедитесь, что тип параметра совпадает с типом переданного значения. Передача параметров с плавающей точкой из конвейеров в настоящее время не поддерживается.
- **Причина**: тип данных для объявленного типа несовместим с фактическим значением параметра.
- **Рекомендация**: Убедитесь, что значения параметров, переданные в поток данных, соответствуют объявленному типу.

### <a name="error-code-df-executor-columnunavailable"></a>Код ошибки: DF-исполнителя-Колумнунаваилабле
- **Сообщение**: имя столбца, используемое в выражении, недоступно или недопустимо
- **Причина**: недопустимое или недоступное имя столбца, используемое в выражении.
- **Рекомендация**: Проверьте имена столбцов в выражениях.

### <a name="error-code-df-executor-parseerror"></a>Код ошибки: DF-исполнителя-Парсиррор
- **Сообщение**: выражение не может быть проанализировано
- **Причина**: в выражении возникли ошибки синтаксического анализа из-за неправильного форматирования.
- **Рекомендация**: Проверьте форматирование в выражении.

### <a name="error-code-df-executor-systemimplicitcartesian"></a>Код ошибки: DF-Executor-SystemImplicitCartesian
- **Сообщение**. Неявное декартово произведение для внутреннего соединения не поддерживается, используйте перекрестное соединение. Столбцы, используемые при соединении, должны создавать уникальные ключи для строк.
- **Причина**: неявные декартовы продукты для внутренних соединений между логическими планами не поддерживаются. Если вы используете столбцы в соединении, создайте уникальный ключ.
- **Рекомендация**: для соединений, не основанных на равенство, используйте перекрестное соединение.

### <a name="error-code-df-executor-systeminvalidjson"></a>Код ошибки: DF-Executor-SystemInvalidJson
- **Сообщение**. Ошибка синтаксического анализа JSON, неподдерживаемая кодировка или многострочность
- **Причина**: возможные проблемы с JSON-файлом: неподдерживаемая кодировка, повреждение байт или использование источника JSON в качестве одного документа во многих вложенных строках.
- **Рекомендация**: Убедитесь, что кодировка JSON-файла поддерживается. В преобразовании «источник», использующем набор данных JSON, разверните **Параметры JSON** и включите **один документ**.



### <a name="error-code-df-executor-conversion"></a>Код ошибки: DF-Executor-Conversion
- **Сообщение**. Сбой преобразования в дату или время из-за недопустимого символа
- **Причина**: данные не имеют ожидаемого формата.
- **Рекомендация**: Используйте правильный тип данных.


### <a name="error-code-df-executor-blockcountexceedslimiterror"></a>Код ошибки: DF-исполнителя-Блокккаунтексцеедслимитеррор
- **Сообщение**: Счетчик незафиксированных блоков не может превышать максимальное ограничение в 100 000 блоков. Проверьте конфигурацию большого двоичного объекта.
- **Причина**: максимальное число незафиксированных блоков в большом двоичном объекте — 100 000.
- **Рекомендация**: чтобы получить дополнительные сведения об этой проблеме, обратитесь к группе разработчиков продуктов Майкрософт.

### <a name="error-code-df-executor-partitiondirectoryerror"></a>Код ошибки: DF-исполнителя-Партитиондиректореррор
- **Сообщение**: указанный исходный путь содержит либо несколько секционированных каталогов (например, *<Source Path> /<корневой каталог 1>/a = 10/b = 20, <Source Path> /<корневой каталог 2>/c = 10/d = 30*) или секционированный каталог с другим файлом или несекционированным каталогом (например, *<Source Path> /<корневой каталог 1>/A = 10/b = 20, <Source Path> /Directory 2/file1*), удалите корневой каталог раздела из исходного пути и прочтите его с помощью отдельного преобразования источника.
- **Причина**: исходный путь содержит несколько секционированных каталогов или секционированный каталог с другим файлом или несекционированным каталогом. 
- **Рекомендация**: удалите секционированный корневой каталог из исходного пути и прочтите его с помощью отдельного преобразования источника.

### <a name="error-code-getcommand-outputasync-failed"></a>Код ошибки: Сбой команды OutputAsync
- **Сообщение**. Во время отладки потока данных и предварительного просмотра данных Сбой команды GetCommand OutputAsync с...
- **Причина**: Эта ошибка является внутренней ошибкой службы. 
- **Рекомендация**: повторите операцию и перезапустите сеанс отладки. Если повторная попытка и перезагрузка не помогли устранить проблему, обратитесь в службу поддержки пользователей. 

### <a name="error-code-df-executor-outofmemoryerror"></a>Код ошибки: DF-исполнителя-OutOfMemoryError
 
- **Сообщение**: в кластере возникла ошибка нехватки памяти во время выполнения. Повторите попытку, используя среду выполнения интеграции с большим числом ядер и (или) оптимизированным для памяти типом вычислений
- **Причина**: в кластере заканчивается память.
- **Рекомендация**: Отладочные кластеры предназначены для разработки. Используйте выборку данных и соответствующий тип вычислений и размер для запуска полезных данных. Советы по повышению производительности см. в разделе [сопоставление с данными о производительности потока данных](concepts-data-flow-performance.md).

### <a name="error-code-df-executor-illegalargument"></a>Код ошибки: DF-исполнителя-Иллегаларгумент

- **Сообщение**. Убедитесь, что ключ доступа в связанной службе указан правильно.
- **Причина**: имя учетной записи или ключ доступа неверны.
- **Рекомендация**: Убедитесь, что имя учетной записи или ключ доступа, указанные в связанной службе, указаны правильно. 

### <a name="error-code-df-executor-invalidtype"></a>Код ошибки: DF-исполнителя-Инвалидтипе
- **Сообщение**. Убедитесь, что тип параметра совпадает с типом переданного значения. Передача параметров с плавающей точкой из конвейеров в настоящее время не поддерживается.
- **Причина**: тип данных для объявленного типа несовместим с фактическим значением параметра. 
- **Рекомендация**: укажите правильные типы данных.

### <a name="error-code-df-executor-columnunavailable"></a>Код ошибки: DF-исполнителя-Колумнунаваилабле
- **Сообщение**: имя столбца, используемое в выражении, недоступно или недопустимо.
- **Причина**: в выражении используется недопустимое или недоступное имя столбца.
- **Рекомендация**: Проверьте имена столбцов, используемые в выражениях.


### <a name="error-code-df-executor-parseerror"></a>Код ошибки: DF-исполнителя-Парсиррор
- **Сообщение**: выражение не может быть проанализировано.
- **Причина**: в выражении возникли ошибки синтаксического анализа из-за неправильного форматирования. 
- **Рекомендация**: Проверьте форматирование в выражении.


 ### <a name="error-code-df-executor-outofdiskspaceerror"></a>Код ошибки: DF-исполнителя-Аутофдискспацееррор
- **Сообщение**: Внутренняя ошибка сервера
- **Причина**: в кластере заканчивается свободное место.
- **Рекомендация**: Повторите конвейер. Если это не решит проблему, обратитесь в службу поддержки пользователей.


 ### <a name="error-code-df-executor-storeisnotdefined"></a>Код ошибки: DF-исполнителя-Стореиснотдефинед
- **Сообщение**: Конфигурация хранилища не определена. Эта ошибка потенциально вызвана недопустимым назначением параметра в конвейере.
- **Причина**: не определено.
- **Рекомендация**: Проверьте назначение значения параметра в конвейере. Выражение параметра может содержать недопустимые символы.

### <a name="error-code-df-excel-invalidconfiguration"></a>Код ошибки: DF-Excel-Инвалидконфигуратион
- **Сообщение**: требуется имя или индекс листа Excel.
- **Причина**: не определено.
- **Рекомендация**: проверьте значение параметра. Укажите имя листа или индекс для чтения данных Excel.

- **Сообщение**: имя и индекс листа Excel не могут существовать одновременно.
- **Причина**: не определено.
- **Рекомендация**: проверьте значение параметра. Укажите имя листа или индекс для чтения данных Excel.

- **Сообщение**: указан недопустимый диапазон.
- **Причина**: не определено.
- **Рекомендация**: проверьте значение параметра. Укажите допустимый диапазон по ссылке. Дополнительные сведения см. в разделе [свойства Excel](./format-excel.md#dataset-properties).

- **Сообщение**: недопустимый файл Excel предоставляется, хотя поддерживаются только файлы. xlsx и. xls
- **Причина**: не определено.
- **Рекомендация**: Убедитесь, что файл Excel имеет расширение xlsx или xls.


 ### <a name="error-code-df-excel-invaliddata"></a>Код ошибки: DF-Excel-InvalidData
- **Сообщение**: лист Excel не существует.
- **Причина**: не определено.
- **Рекомендация**: проверьте значение параметра. Укажите допустимое имя листа или индекс для чтения данных Excel.

- **Сообщение**: чтение файлов Excel с другой схемой сейчас не поддерживается.
- **Причина**: не определено.
- **Рекомендация**: Используйте поддерживаемый файл Excel.

- **Сообщение**: тип данных не поддерживается.
- **Причина**: не определено.
- **Рекомендация**: Используйте поддерживаемые типы данных файлов Excel.

### <a name="error-code-4502"></a>Код ошибки: 4502
- **Сообщение**. существуют существенные одновременные выполнения маппингдатафлов, которые вызывают сбои из-за регулирования в Integration Runtime.
- **Причина**: большое количество запусков действий потока данных происходит параллельно в среде выполнения интеграции. Дополнительные сведения см. в статье [ограничения фабрики данных Azure](../azure-resource-manager/management/azure-subscription-service-limits.md#data-factory-limits).
- **Рекомендация**. Если требуется параллельное выполнение дополнительных действий потока данных, распределите их между несколькими средами выполнения интеграции.


### <a name="error-code-invalidtemplate"></a>Код ошибки: Инвалидтемплате
- **Сообщение**: невозможно вычислить выражение конвейера.
- **Причина**: выражение конвейера, переданное в действии потока данных, не обрабатывается правильно из-за синтаксической ошибки.
- **Рекомендация**: Проверьте действие в мониторинге активности, чтобы проверить выражение.

### <a name="error-code-2011"></a>Код ошибки: 2011
- **Сообщение**: действие было запущено на Azure Integration Runtime и не смогло расшифровать учетные данные хранилища данных или вычислить подключение с помощью автономной Integration Runtime. Проверьте конфигурацию связанных служб, связанных с этим действием, и убедитесь, что используется правильный тип среды выполнения интеграции.
- **Причина**: поток данных не поддерживает связанные службы в самостоятельных средах выполнения интеграции.
- **Рекомендация**: Настройка потока данных для выполнения в управляемой среде выполнения интеграции виртуальной сети.

## <a name="miscellaneous-troubleshooting-tips"></a>Прочие советы по устранению неполадок
- **Ошибка:** возникло непредвиденное исключение, сбой выполнения.
    - **Сообщение**. Во время выполнения действия потока данных: возникло непредвиденное исключение, и произошел сбой выполнения.
    - **Причина**: Эта ошибка является внутренней ошибкой службы. Повторите операцию и перезапустите сеанс отладки.
    - **Рекомендация**. Если повторная попытка и перезагрузка не помогли устранить проблему, обратитесь в службу поддержки пользователей.

-  **Ошибка**: выходные данные не выводятся при соединении во время предварительной версии отладочных данных.
    - **Сообщение**: существует большое количество значений NULL или отсутствующих значений, которые могут быть вызваны тем, что вычислено слишком мало строк. Попробуйте обновить ограничение для строк отладки и обновить данные.
    - **Причина**: условие объединения либо не соответствует ни одной строке, либо привело к большому числу значений NULL во время просмотра данных.
    - **Рекомендация**: в **параметрах отладки** увеличьте число строк в пределах исходной строки. Не забудьте выбрать Azure IR с кластером потока данных, достаточно большим для обработки дополнительных данных.
    
- **Причина**: ошибка проверки в источнике с многострочными CSV-файлами. 
    - **Сообщение**: может появиться одно из следующих сообщений об ошибке:
        - Последний столбец имеет значение null или отсутствует.
        - Проверка схемы в источнике завершается ошибкой.
        - Импорт схемы не удается правильно отобразить в интерфейсе UX, а последний столбец содержит символ новой строки в имени.
    - **Причина**. в потоке данных СОПОСТАВЛЕНИЯ исходный CSV-файл не работает, если в качестве разделителя строк используется \r\n. Иногда дополнительные строки при возврате каретки могут вызвать ошибки. 
    - **Рекомендация**: Создайте файл в источнике, используя \n в качестве разделителя строк, а не \r\n. Или используйте действие копирования для преобразования CSV-файла, чтобы использовать \n в качестве разделителя строк.

## <a name="general-troubleshooting-guidance"></a>Общие рекомендации по устранению неполадок
1. Проверьте состояние подключений к набору данных. В каждом преобразовании источника и приемника перейдите к связанной службе для каждого набора данных, который вы используете, и проверьте подключения.
2. Проверьте состояние соединений файлов и таблиц в конструкторе потока данных. В режиме отладки выберите **Предварительный просмотр данных** в исходных преобразованиях, чтобы убедиться, что вы можете получить доступ к данным.
3. Если все выглядит правильно в предварительной версии данных, перейдите в конструктор конвейера и разместите поток данных в действии конвейера. Выполните отладку конвейера для комплексного тестирования.

## <a name="next-steps"></a>Дальнейшие действия

Дополнительные сведения об устранении неполадок см. в следующих ресурсах:

*  [Блог о Фабрике данных](https://azure.microsoft.com/blog/tag/azure-data-factory/)
*  [Запросы на добавление функции в Фабрику данных](https://feedback.azure.com/forums/270578-data-factory)
*  [Видео по Azure](https://azure.microsoft.com/resources/videos/index/?sort=newest&services=data-factory)
*  [Форум Stack Overflow по Фабрике данных](https://stackoverflow.com/questions/tagged/azure-data-factory)
*  [Сведения о Фабрике данных в Twitter](https://twitter.com/hashtag/DataFactory)

