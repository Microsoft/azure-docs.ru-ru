---
title: Устранение неполадок при сопоставлении потоков данных
description: Узнайте, как устранять неполадки с потоками данных в Фабрике данных Azure.
ms.author: makromer
author: kromerm
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: troubleshooting
ms.date: 09/11/2020
ms.openlocfilehash: a95cacafc5b1d00b1e4d04fd84cdda2de72b6a59
ms.sourcegitcommit: 27d616319a4f57eb8188d1b9d9d793a14baadbc3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/15/2021
ms.locfileid: "100523011"
---
# <a name="troubleshoot-mapping-data-flows-in-azure-data-factory"></a>Устранение неполадок сопоставления потоков данных в фабрике данных Azure

[!INCLUDE[appliesto-adf-xxx-md](includes/appliesto-adf-xxx-md.md)]

В этой статье рассматриваются распространенные методы устранения неполадок при сопоставлении потоков данных в фабрике данных Azure.

## <a name="common-error-codes-and-messages"></a>Распространенные коды ошибок и сообщения об ошибках 

### <a name="error-code-df-executor-sourceinvalidpayload"></a>Код ошибки: DF-Executor-SourceInvalidPayload
- **Сообщение**. Не удалось выполнить предварительный просмотр данных, отладку и поток данных конвейера, так как контейнер не существует
- **Причины**. Набор данных содержит контейнер, который не существует в хранилище.
- **Рекомендация**. Убедитесь, что контейнер, указанный в наборе данных, существует или доступен.

### <a name="error-code-df-executor-systemimplicitcartesian"></a>Код ошибки: DF-Executor-SystemImplicitCartesian

- **Сообщение**. Неявное декартово произведение для внутреннего соединения не поддерживается, используйте перекрестное соединение. Столбцы, используемые при соединении, должны создавать уникальные ключи для строк.
- **Причины**. Неявное декартово произведение для внутреннего соединения между логическими планами не поддерживается. Если столбцы используются в соединении, то требуется уникальный ключ, содержащий по крайней мере один столбец из обеих сторон связи.
- **Рекомендация**. Для соединений на основе неравенства необходимо выбрать пользовательское перекрестное соединение.

### <a name="error-code-df-executor-systeminvalidjson"></a>Код ошибки: DF-Executor-SystemInvalidJson

- **Сообщение**. Ошибка синтаксического анализа JSON, неподдерживаемая кодировка или многострочность
- **Причины**. Возможные проблемы с файлом JSON: неподдерживаемая кодировка, поврежденные байты или использование источника JSON как отдельного документа во многих вложенных строках.
- **Рекомендация**. Убедитесь, что кодировка JSON-файла поддерживается. В преобразовании источника, использующего набор данных JSON, разверните узел "Параметры JSON" и включите параметр "Один документ".
 
### <a name="error-code-df-executor-broadcasttimeout"></a>Код ошибки: DF-Executor-BroadcastTimeout

- **Сообщение**. Ошибка окончания времени ожидания трансляции. Убедитесь, что широковещательный поток создает данные в течение 60 секунд во время отладки и 300 секунд при выполнении заданий.
- **Причины**. время ожидания вещания по умолчанию составляет 60 секунд при выполнении отладки и 300 секунд при выполнении задания. Поток, выбранный для вещания, кажется слишком большим для получения данных в пределах этого предела.
- **Рекомендация**. Перейдите на вкладку "Оптимизация" в области преобразования потока данных для операций Join, Exists и Lookup. Параметр по умолчанию для трансляции — "Авто". Если задано значение "Auto" или вы вручную настраиваете левую или правую сторону для вещания в разделе "Исправлено", можно задать более крупную Azure Integration Runtimeную конфигурацию или отключить вещание. Для лучшей производительности потоков данных рекомендуется разрешить Spark трансляции в режиме "Авто" и использовать оптимизированную для памяти Azure IR. Если вы выполняете поток данных при выполнении теста отладки из запуска конвейера отладки, вы можете столкнуться с этим условием чаще. Это обусловлено тем, что ADF регулирует время ожидания вещания до 60 секунд, чтобы обеспечить более быструю процедуру отладки. Если вы хотите продлить его до времени ожидания 300 секунд из запущенного запуска, можно использовать параметр Отладка > использовать действие во время выполнения действия для использования Azure IR, определенного в действии конвейера потока данных.

- **Сообщение**. ошибка истечения времени ожидания широковещательного подключения. чтобы избежать этой проблемы, можно выбрать параметр "Выкл." вещания в преобразовании «соединение/существует» или «Уточняющий запрос». Если вы планируете широковещательное соединение для повышения производительности, убедитесь, что широковещательный поток может создавать данные в течение 60 секунд при выполнении отладки и 300 секунд при выполнении заданий.
- **Причины**. Время ожидания трансляции по умолчанию составляет 60 секунд для отладки и 300 секунд для заданий. При широковещательном соединении поток, выбранный для вещания, кажется слишком большим для получения данных в пределах этого предела. Если широковещательное соединение не используется, вещание по умолчанию, выполненное потоком данных, может достигать того же ограничения.
- **Рекомендация**. Отключите параметр Broadcast или Избегайте широковещательной трансляции больших потоков данных, в которых обработка может занять более 60 секунд. Вместо этого выберите поток меньшего размера для вещания. Большие таблицы SQL/DW и исходные файлы обычно являются недопустимыми кандидатами. При отсутствии широковещательного подключения Используйте кластер большего размера в случае возникновения ошибки.

### <a name="error-code-df-executor-conversion"></a>Код ошибки: DF-Executor-Conversion

- **Сообщение**. Сбой преобразования в дату или время из-за недопустимого символа
- **Причины**. Формат данных отличается от ожидаемого.
- **Рекомендация**. Используйте правильный тип данных

### <a name="error-code-df-executor-invalidcolumn"></a>Код ошибки: DF-Executor-InvalidColumn
- **Сообщение**. Необходимо указать имя столбца в запросе, задайте псевдоним при использовании функции SQL
- **Причины**. Имя столбца не было указано.
- **Рекомендация**. Задайте псевдоним при использовании функции SQL, например min()/max() и т. д.

### <a name="error-code-df-executor-drivererror"></a>Код ошибки: DF-исполнителя-Дривереррор
- **Сообщение**: INT96 имеет устаревший тип отметок времени, который не поддерживается ПОТОКОМ данных ADF. Попробуйте обновить тип столбца до последних типов.
- **Причины**: ошибка драйвера
- **Рекомендация**: INT96 имеет устаревший тип отметок времени, который не поддерживается ПОТОКОМ данных ADF. Рекомендуется обновить тип столбца до последних типов.

### <a name="error-code-df-executor-blockcountexceedslimiterror"></a>Код ошибки: DF-исполнителя-Блокккаунтексцеедслимитеррор
- **Сообщение**: Счетчик незафиксированных блоков не может превышать максимальное ограничение в 100 000 блоков. Проверьте конфигурацию большого двоичного объекта.
- **Причины**. в большом двоичном объекте может быть не более 100 000 незафиксированных блоков.
- **Рекомендация**: для получения дополнительных сведений обратитесь в службу разработчиков Майкрософт по поводу этой проблемы

### <a name="error-code-df-executor-partitiondirectoryerror"></a>Код ошибки: DF-исполнителя-Партитиондиректореррор
- **Сообщение**: указанный исходный путь содержит либо несколько секционированных каталогов (например, <Source Path> /<корневой каталог 1>/a = 10/b = 20, <Source Path> /<корневой каталог 2>/c = 10/d = 30) или секционированный каталог с другим файлом или несекционированным каталогом (например, <Source Path> /<корневой каталог 1>/a = 10/b = 20, <Source Path> /Directory 2/file1), удалите корневой каталог раздела из исходного пути и прочтите его с помощью отдельного преобразования источника.
- **Причины**: исходный путь содержит несколько секционированных каталогов или секционированного каталога с другим файлом или несекционированным каталогом.
- **Рекомендация**: удалите секционированный корневой каталог из исходного пути и прочтите его с помощью отдельного преобразования источника.

### <a name="error-code-df-executor-outofmemoryerror"></a>Код ошибки: DF-исполнителя-OutOfMemoryError
- **Сообщение**: в кластере возникла ошибка нехватки памяти во время выполнения. Повторите попытку, используя среду выполнения интеграции с большим числом ядер и (или) оптимизированным для памяти типом вычислений
- **Причины**: недостаточно памяти в кластере
- **Рекомендация**. отладочные кластеры предназначены для целей разработки. Используйте выборку данных, соответствующий тип вычислений и размер для запуска полезных данных. Сведения о настройке для достижения оптимальной производительности см. в [руководстве по повышению производительности потока данных сопоставления](concepts-data-flow-performance.md) .

### <a name="error-code-df-executor-invalidtype"></a>Код ошибки: DF-исполнителя-Инвалидтипе
- **Сообщение**. Убедитесь, что тип параметра совпадает с типом переданного значения. Передача параметров с плавающей точкой из конвейеров в настоящее время не поддерживается.
- **Причины**: несовместимые типы данных между объявленным типом и фактическим значением параметра
- **Рекомендация**: Убедитесь, что значения параметров, переданные в поток данных, соответствуют объявленному типу.

### <a name="error-code-df-executor-columnunavailable"></a>Код ошибки: DF-исполнителя-Колумнунаваилабле
- **Сообщение**: имя столбца, используемое в выражении, недоступно или недопустимо
- **Причины**: недопустимое или недоступное имя столбца, используемое в выражениях
- **Рекомендация**: Проверьте имена столбцов, используемые в выражениях

### <a name="error-code-df-executor-parseerror"></a>Код ошибки: DF-исполнителя-Парсиррор
- **Сообщение**: выражение не может быть проанализировано
- **Причины**: в выражении возникли ошибки синтаксического анализа из-за форматирования
- **Рекомендация**: Проверьте форматирование в выражении.

### <a name="error-code-df-executor-systemimplicitcartesian"></a>Код ошибки: DF-Executor-SystemImplicitCartesian
- **Сообщение**. Неявное декартово произведение для внутреннего соединения не поддерживается, используйте перекрестное соединение. Столбцы, используемые при соединении, должны создавать уникальные ключи для строк.
- **Причины**. Неявное декартово произведение для внутреннего соединения между логическими планами не поддерживается. Если столбцы, используемые в соединении, создают уникальный ключ
- **Рекомендация**. для соединений, не основанных на равенстве, необходимо выбрать перекрестное соединение.

### <a name="error-code-df-executor-systeminvalidjson"></a>Код ошибки: DF-Executor-SystemInvalidJson
- **Сообщение**. Ошибка синтаксического анализа JSON, неподдерживаемая кодировка или многострочность
- **Причины**. Возможные проблемы с файлом JSON: неподдерживаемая кодировка, поврежденные байты или использование источника JSON как отдельного документа во многих вложенных строках.
- **Рекомендация**. Убедитесь, что кодировка JSON-файла поддерживается. В преобразовании источника, использующего набор данных JSON, разверните узел "Параметры JSON" и включите параметр "Один документ".



### <a name="error-code-df-executor-conversion"></a>Код ошибки: DF-Executor-Conversion
- **Сообщение**. Сбой преобразования в дату или время из-за недопустимого символа
- **Причины**. Формат данных отличается от ожидаемого.
- **Рекомендация**: Используйте правильный тип данных.


### <a name="error-code-df-executor-blockcountexceedslimiterror"></a>Код ошибки: DF-исполнителя-Блокккаунтексцеедслимитеррор
- **Сообщение**: Счетчик незафиксированных блоков не может превышать максимальное ограничение в 100 000 блоков. Проверьте конфигурацию большого двоичного объекта.
- **Причины**. в большом двоичном объекте может быть не более 100 000 незафиксированных блоков.
- **Рекомендация**. для получения дополнительных сведений обратитесь в службу технической поддержки Майкрософт по поводу этой проблемы

### <a name="error-code-df-executor-partitiondirectoryerror"></a>Код ошибки: DF-исполнителя-Партитиондиректореррор
- **Сообщение**: указанный исходный путь содержит либо несколько секционированных каталогов (например, *<Source Path> /<корневой каталог 1>/a = 10/b = 20, <Source Path> /<корневой каталог 2>/c = 10/d = 30*) или секционированный каталог с другим файлом или несекционированным каталогом (например, *<Source Path> /<корневой каталог 1>/A = 10/b = 20, <Source Path> /Directory 2/file1*), удалите корневой каталог раздела из исходного пути и прочтите его с помощью отдельного преобразования источника.
- **Причины**: исходный путь содержит несколько секционированных каталогов или секционированного каталога с другим файлом или несекционированным каталогом.
- **Рекомендация**: удалите секционированный корневой каталог из исходного пути и прочтите его с помощью отдельного преобразования источника.

### <a name="error-code-getcommand-outputasync-failed"></a>Код ошибки: Сбой команды OutputAsync
- **Сообщение**. Во время отладки потока данных и предварительного просмотра данных Сбой команды GetCommand OutputAsync с...
- **Причины**. Это ошибка серверной службы. Вы можете повторить операцию, а также перезапустить сеанс отладки.
- **Рекомендация**. Если повторная попытка и перезапуск не помогли устранить проблему, обратитесь в службу поддержки. 

### <a name="error-code-df-executor-outofmemoryerror"></a>Код ошибки: DF-исполнителя-OutOfMemoryError
 
- **Сообщение**: в кластере возникла ошибка нехватки памяти во время выполнения. Повторите попытку, используя среду выполнения интеграции с большим числом ядер и (или) оптимизированным для памяти типом вычислений
- **Причины**: недостаточно памяти в работе кластера.
- **Рекомендация**. отладочные кластеры предназначены для целей разработки. Используйте выборку данных требуемый тип и размер вычислений для запуска полезных данных. Сведения о настройке потоков данных для лучшей производительности см. в [руководстве по производительности потока](https://docs.microsoft.com/azure/data-factory/concepts-data-flow-performance) данных.

### <a name="error-code-df-executor-illegalargument"></a>Код ошибки: DF-исполнителя-Иллегаларгумент
- **Сообщение**. Убедитесь, что ключ доступа в связанной службе указан правильно.
- **Причины**: неправильное имя учетной записи или ключ доступа.
- **Рекомендация**: укажите имя нужной учетной записи или ключ доступа.

- **Сообщение**. Убедитесь, что ключ доступа в связанной службе указан правильно.
- **Причины**: неправильное имя учетной записи или ключ доступа
- **Рекомендация**: Убедитесь, что имя учетной записи или ключ доступа, указанные в связанной службе, указаны правильно. 

### <a name="error-code-df-executor-invalidtype"></a>Код ошибки: DF-исполнителя-Инвалидтипе
- **Сообщение**. Убедитесь, что тип параметра совпадает с типом переданного значения. Передача параметров с плавающей точкой из конвейеров в настоящее время не поддерживается.
- **Причины**: несовместимые типы данных между объявленным типом и фактическим значением параметра
- **Рекомендация**: укажите правильные типы данных.

### <a name="error-code-df-executor-columnunavailable"></a>Код ошибки: DF-исполнителя-Колумнунаваилабле
- **Сообщение**: имя столбца, используемое в выражении, недоступно или недопустимо.
- **Причины**: в выражениях используется недопустимое или недоступное имя столбца.
- **Рекомендация**: Проверьте имена столбцов, используемые в выражениях.


### <a name="error-code-df-executor-parseerror"></a>Код ошибки: DF-исполнителя-Парсиррор
- **Сообщение**: выражение не может быть проанализировано.
- **Причины**: в выражении возникли ошибки синтаксического анализа из-за форматирования.
- **Рекомендация**: Проверьте форматирование в выражении.


 ### <a name="error-code-df-executor-outofdiskspaceerror"></a>Код ошибки: DF-исполнителя-Аутофдискспацееррор
- **Сообщение**: Внутренняя ошибка сервера
- **Причины**: на кластере заканчивается свободное место.
- **Рекомендация**: Повторите конвейер. Если проблема не исчезнет, обратитесь в службу поддержки пользователей.


 ### <a name="error-code-df-executor-storeisnotdefined"></a>Код ошибки: DF-исполнителя-Стореиснотдефинед
- **Сообщение**: Конфигурация хранилища не определена. Эта ошибка потенциально вызвана недопустимым назначением параметра в конвейере.
- **Причины**: не определено
- **Рекомендация**: Проверьте назначение значения параметра в конвейере. Выражение параметра может содержать недопустимые символы.

### <a name="error-code-df-excel-invalidconfiguration"></a>Код ошибки: DF-Excel-Инвалидконфигуратион
- **Сообщение**: требуется имя или индекс листа Excel.
- **Причины**: не определено
- **Рекомендация**: проверьте значение параметра и укажите имя листа или индекс для чтения данных Excel.

- **Сообщение**: имя и индекс листа Excel не могут существовать одновременно.
- **Причины**: не определено
- **Рекомендация**: проверьте значение параметра и укажите имя листа или индекс для чтения данных Excel.

- **Сообщение**: указан недопустимый диапазон.
- **Причины**: не определено
- **Рекомендация**: проверьте значение параметра и укажите допустимый диапазон по ссылке: [свойства Excel](https://docs.microsoft.com/azure/data-factory/format-excel#dataset-properties).

- **Сообщение**: недопустимый файл Excel предоставляется, хотя поддерживаются только файлы. xlsx и. xls
- **Причины**: не определено
- **Рекомендация**: Убедитесь, что файл Excel имеет расширение xlsx или xls.


 ### <a name="error-code-df-excel-invaliddata"></a>Код ошибки: DF-Excel-InvalidData
- **Сообщение**: лист Excel не существует.
- **Причины**: не определено
- **Рекомендация**: проверьте значение параметра и укажите допустимое имя или индекс листа для чтения данных Excel.

- **Сообщение**: чтение файлов Excel с другой схемой сейчас не поддерживается.
- **Причины**: не определено
- **Рекомендация**: Используйте правильный файл Excel.

- **Сообщение**: тип данных не поддерживается.
- **Причины**: не определено
- **Рекомендация**. Используйте типы данных "Right" для файлов Excel.

### <a name="error-code-4502"></a>Код ошибки: 4502
- **Сообщение**. существуют существенные одновременные выполнения маппингдатафлов, которые вызывают сбои из-за регулирования в Integration Runtime.
- **Причины**: большое количество запусков действий потока данных выполняется параллельно на Integration Runtime. Дополнительные сведения о [пределах фабрики данных Azure](https://docs.microsoft.com/azure/azure-resource-manager/management/azure-subscription-service-limits#data-factory-limits)см. здесь.
- **Рекомендация**. Если вы хотите параллельно выполнять больше действий потока данных, распространите их по нескольким средам выполнения интеграции.


### <a name="error-code-invalidtemplate"></a>Код ошибки: Инвалидтемплате
- **Сообщение**: невозможно вычислить выражение конвейера.
- **Причины**: выражение конвейера, переданное в действии DataFlow, не обрабатывается правильно из-за синтаксической ошибки.
- **Рекомендация**: Проверьте правильность выражения в действии в области мониторинга активности.

### <a name="error-code-2011"></a>Код ошибки: 2011
- **Сообщение**: действие было запущено на Azure Integration Runtime и не смогло расшифровать учетные данные хранилища данных или вычислить подключение с помощью автономной Integration Runtime. Проверьте конфигурацию связанных служб, связанных с этим действием, и убедитесь, что используется правильный тип среды выполнения интеграции.
- **Причины**: поток данных не поддерживает связанные службы с локальной средой выполнения интеграции.
- **Рекомендация**: Настройте поток данных для запуска в среде выполнения интеграции с помощью "управляемая виртуальная сеть".

## <a name="miscellaneous-troubleshooting-tips"></a>Прочие советы по устранению неполадок
- **Ошибка:** Обнаружено непредвиденное исключение и выполнение завершилось сбоем
    - **Сообщение**. Во время выполнения действия потока данных: возникло непредвиденное исключение, и произошел сбой выполнения.
    - **Причины**. Это ошибка серверной службы. Вы можете повторить операцию, а также перезапустить сеанс отладки.
    - **Рекомендация**. Если повторная попытка и перезапуск не помогли устранить проблему, обратитесь в службу поддержки.

-  **Ошибка**: предварительный просмотр отладочных данных без выходных данных при соединении
    - **Сообщение**: существует большое количество значений NULL или отсутствующих значений, которые могут быть вызваны тем, что вычислено слишком мало строк. Попробуйте обновить ограничение для строк отладки и обновить данные.
    - **Причины**: условие объединения не соответствует ни одной строке или привело к большому ЧИСЛУ значений NULL при предварительном просмотре данных.
    - **Рекомендация**: перейдите в раздел Параметры отладки и увеличьте число строк в пределах исходной строки. Убедитесь, что выбран Azure IR с большим количеством кластеров потоков данных для обработки дополнительных данных.
    
- **Причина**: ошибка проверки в источнике с многострочными CSV-файлами 
    - **Сообщение**: может появиться одно из следующих сообщений об ошибке:
        - Последний столбец имеет значение null или отсутствует.
        - Проверка схемы в источнике завершается ошибкой.
        - Импорт схемы не удается правильно отобразить в интерфейсе UX, а последний столбец содержит символ новой строки в имени.
    - **Причины**. в потоке данных сопоставления в настоящее время источник многострочного CSV не работает с разделителем строк \r\n AS. Иногда лишние строки в символах возврата к исходному значению прерывается. 
    - **Рекомендация**: либо создайте файл в источнике с разделителем строки \n, а не \r\n. Или используйте действие копирования для преобразования CSV-файла с \r\n в \n в качестве разделителя строк.

## <a name="general-troubleshooting-guidance"></a>Общие рекомендации по устранению неполадок
1. Проверьте состояние подключений к набору данных. В каждом преобразовании источника и приемника проверьте связанную службу для каждого набора данных, который вы используете, и протестируйте соединения.
2. Проверьте состояние подключения файла и таблицы в конструкторе потока данных. Чтобы убедиться, что у вас есть доступ к данным, переключитесь на отладку и щелкните "Предварительный просмотр данных" в преобразовании источника.
3. Если в предварительном просмотре все выглядит нормально, перейдите в конструктор конвейера и разместите поток данных в действии конвейера. Выполните отладку конвейера для комплексного тестирования.

## <a name="next-steps"></a>Дальнейшие действия

Для получения дополнительных сведений об устранении неполадок воспользуйтесь следующими ресурсами:

*  [Блог о Фабрике данных](https://azure.microsoft.com/blog/tag/azure-data-factory/)
*  [Запросы на добавление функции в Фабрику данных](https://feedback.azure.com/forums/270578-data-factory)
*  [Видео по Azure](https://azure.microsoft.com/resources/videos/index/?sort=newest&services=data-factory)
*  [Форум о переполнении стека для фабрики данных](https://stackoverflow.com/questions/tagged/azure-data-factory)
*  [Сведения о Фабрике данных в Twitter](https://twitter.com/hashtag/DataFactory)
