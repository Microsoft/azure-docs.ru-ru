---
title: Среда выполнения интеграции
description: Сведения о среде выполнения интеграции в фабрике данных Azure.
ms.author: abnarain
author: nabhishek
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 07/14/2020
ms.openlocfilehash: 911674a80b531a50cfb429c5dc0ff41f1aaceb08
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "100389949"
---
# <a name="integration-runtime-in-azure-data-factory"></a>Среда выполнения интеграции в фабрике данных Azure 

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

Среда выполнения интеграции (IR) — это инфраструктура вычислений, которую фабрика данных Azure использует для обеспечения перечисленных ниже возможностей интеграции данных в разных сетевых средах.

- **Поток данных**. выполняет [поток данных](concepts-data-flow-overview.md) в управляемой среде вычислений Azure.  
- **Перемещение данных**. копирование данных между хранилищами данных в общедоступной сети и хранилищах данных в частной сети (локальной или виртуальной частной сети). Поддерживаются встроенные соединители, преобразование форматов, сопоставление столбцов, высокопроизводительная и масштабируемая передача данных.
- **Отправка** действий. действия по отправке и мониторингу, выполняемые в различных службах вычислений, таких как Azure Databricks, Azure HDInsight, машинное обучение Azure, база данных SQL azure, SQL Server и многое другое.
- **Выполнение пакетов служб SSIS**. Выполнение пакетов служб SQL Server Integration Services (SSIS) в собственном коде в управляемой вычислительной среде Azure.

В фабрике данных действия определяют выполняемые операции. Связанная служба обозначает целевое хранилище данных или службу вычислений. Среда выполнения интеграции соединяет между собой действия и связанные службы.  На него ссылается связанная служба или действие, а также среда вычислений, в которой действие запускается или отправляется из. Такая схема позволяет выполнять действия в регионе, который максимально близко расположен к целевому хранилищу данных или службе вычислений, обеспечивает высокую производительность и соблюдение требований по безопасности и соответствию.

Среды выполнения интеграции можно создавать в службе "Фабрика данных Azure" через [центр управления](author-management-hub.md) , а также любые действия, наборы данных или потоки, которые ссылаются на них.

## <a name="integration-runtime-types"></a>Типы сред выполнения интеграции

Фабрика данных предлагает три типа Integration Runtime (IR), и следует выбрать тип, который наилучшим образом обслуживает возможности интеграции данных и потребности в сетевой среде, которую вы ищете.  Эти три типа перечислены ниже.

- Azure
- Локальное размещение
- Службы SSIS Azure

В следующей таблице описаны возможности и поддержка сетей для каждого типа интеграции среды выполнения.

Тип IR | Общедоступная сеть | Частная сеть
------- | -------------- | ---------------
Azure | Поток данных<br/>Перемещение данных<br/>Диспетчеризация действий | Поток данных<br/>Перемещение данных<br/>Диспетчеризация действий
Локальное размещение | Перемещение данных<br/>Диспетчеризация действий | Перемещение данных<br/>Диспетчеризация действий
Службы SSIS Azure | Выполнение пакетов служб SSIS | Выполнение пакетов служб SSIS


## <a name="azure-integration-runtime"></a>Среда выполнения интеграции Azure

Среда выполнения интеграции Azure может:

- Выполнение потоков данных в Azure 
- Выполнение действия копирования между облачными хранилищами данных
- Отправьте следующие действия преобразования в общедоступную сеть: действие "Записная книжка/JAR/Python", действие Hive HDInsight, действие Pig hdinsight, действие MapReduce hdinsight, действие HDInsight Spark, действие потоковой передачи HDInsight, Машинное обучение Azure Studio (классическая) действие выполнения пакета, Машинное обучение Azure Studio (классическая модель). действия по обновлению ресурсов, действия с хранимой процедурой, Data Lake Analytics действия "Поиск" и "получение метаданных".

### <a name="azure-ir-network-environment"></a>Сетевая среда Azure IR

Azure Integration Runtime поддерживает подключение к хранилищам данных и службы вычислений с общедоступными конечными точками. При включении управляемой виртуальной сети Azure Integration Runtime поддерживает подключение к хранилищам данных с помощью службы Private Link в среде частной сети.

### <a name="azure-ir-compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование Azure IR
Среда выполнения интеграции Azure предоставляет полностью управляемые вычисления в Azure без использования серверов.  Вам не нужно беспокоиться о подготовке инфраструктуры, установке программного обеспечения, исправлении или масштабировании емкости.  Кроме того, вы платите только за фактическое время использования.

Среда выполнения интеграции Azure предоставляет вычисления в собственном коде для безопасного, надежного и высокопроизводительного перемещения данных между облачными хранилищами данных.  Вам достаточно указать, сколько единиц интеграции данных нужно использовать для действия копирования, и среда Azure IR гибко увеличит объем вычислительных ресурсов соответствующим образом. Вам не нужно явно изменять размеры Integration Runtime. 

Отправка действия — это упрощенная операция для направления действия в целевую службу вычислений, поэтому для этого сценария не требуется масштабировать размер вычислений.

Сведения о создании и настройке Azure IR см. в разделе [Создание и настройка Azure Integration Runtime](create-azure-integration-runtime.md). 

> [!NOTE] 
> Среда выполнения интеграции Azure имеет свойства, связанные со средой выполнения потока данных, которая определяет базовую инфраструктуру вычислений, которая будет использоваться для выполнения потоков данных. 

## <a name="self-hosted-integration-runtime"></a>Локальная среда выполнения интеграции

В локальной среде IR доступны следующие возможности.

- Выполнение действия копирования между облачными хранилищами данных и хранилищем данных в частной сети.
- Отправка следующих действий преобразования в ресурсы вычислений в локальной или виртуальной сети Azure. действие Hive HDInsight (BYOC — создание собственного кластера), действие HDInsight Pig (BYOC), действие MapReduce HDInsight (BYOC), действие HDInsight Spark (BYOC), действие потоковой передачи HDInsight (BYOC), Машинное обучение Azure Studio (классическая модель) действие выполнения пакета, Машинное обучение Azure Studio (классическая модель). действия для обновления ресурсов, действия хранимой процедуры, Data Lake Analytics действия U-SQL , Настраиваемое действие (выполняется в пакетной службе Azure), действие поиска и действие получение метаданных.

> [!NOTE] 
> Используйте локальную среду выполнения интеграции для поддержки хранилищ данных, для которых требуется собственный драйвер, например SAP Hana, MySQL и т. д.  Дополнительные сведения см. в разделе [Поддерживаемые хранилища данных](copy-activity-overview.md#supported-data-stores-and-formats).

> [!NOTE] 
> Среда выполнения Java (JRE) — это зависимость саморазмещенного IR. Убедитесь, что на том же узле установлен JRE.

### <a name="self-hosted-ir-network-environment"></a>Локальная сетевая среда IR

Если вы хотите безопасно выполнять интеграцию данных в среде частной сети, которая не имеет прямой информации из общедоступного облачного окружения, вы можете установить локальную среду IR в локальной среде, расположенной за корпоративным брандмауэром, или внутри виртуальной частной сети.  Локальная среда выполнения интеграции использует только исходящие HTTP-соединения во внешнюю сеть.

### <a name="self-hosted-ir-compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование локальной среды IR

Установите локально размещенное IR на локальном компьютере или в виртуальной машине в частной сети. В настоящее время локальная IR может выполняться только в операционной системе Windows.  

Чтобы получить высокий уровень доступности и масштабируемости, разверните локальную IR. Для этого следует связать логический экземпляр с несколькими локальными компьютерами в режиме "активный — активный".  Дополнительные сведения см. в статье [Создание и настройка](create-self-hosted-integration-runtime.md) локальной среды IR в разделе руководства для получения дополнительных сведений.

## <a name="azure-ssis-integration-runtime"></a>Среда выполнения интеграции Azure SSIS

Чтобы переместить уже существующую рабочую нагрузку SSIS, создайте Azure SSIS IR для выполнения пакетов служб SSIS в собственной среде.

### <a name="azure-ssis-ir-network-environment"></a>Сетевая среда Azure-SSIS IR

Среда выполнения интеграции Azure SSIS может быть подготовлена в общедоступной сети или частной сети.  Доступ к локальным данным обеспечивается за счет присоединения среды выполнения интеграции Azure SSIS к виртуальной сети, подключенной к локальной сети.  

### <a name="azure-ssis-ir-compute-resource-and-scaling"></a>Вычислительные ресурсы и масштабирование Azure-SSIS IR

Azure SSIS IR — это полностью управляемый кластер виртуальных машин Azure, выделенный для выполнения пакетов служб SSIS. Вы можете подключить собственную базу данных SQL Azure или SQL Управляемый экземпляр для каталога проектов или пакетов служб SSIS (SSISDB). Чтобы увеличить или уменьшить масштаб вычислительных ресурсов, укажите соответствующее количество узлов в кластере. Чтобы снизить расходы на среду выполнения интеграции служб SSIS Azure, вы можете в любой момент останавливать ее и снова запускать.

Дополнительные сведения см. в руководстве по созданию и настройке Azure SSIS IR.  После создания среды вы сможете развернуть существующие пакеты служб SSIS и управлять ими практически так же, как при использовании локальной SSIS, с помощью привычных средств, например SQL Server Data Tools (SSDT) и SQL Server Management Studio (SSMS).

Дополнительные сведения о среде выполнения Azure SSIS см. в следующих статьях: 

- [Развертывание пакетов служб интеграции SQL Server (SSIS) в Azure](./tutorial-deploy-ssis-packages-azure.md). В этой статье приведены пошаговые инструкции по созданию Azure-SSIS IR и использованию базы данных SQL Azure для размещения каталога служб SSIS. 
- [Создание среды выполнения интеграции Azure SSIS](create-azure-ssis-integration-runtime.md). Эта статья раскрывает учебник и содержит инструкции по использованию Управляемый экземпляр SQL и присоединению инфракрасной связи к виртуальной сети. 
- [Мониторинг среды выполнения интеграции в фабрике данных Azure](monitor-integration-runtime.md#azure-ssis-integration-runtime). В этом статье показано, как извлечь сведения о среде выполнения интеграции Azure SSIS и описания состояний из возвращаемых данных. 
- [Manage an Azure-SSIS integration runtime](manage-azure-ssis-integration-runtime.md) (Управление средой выполнения интеграции Azure SSIS). В этой статье показано, как остановить, запустить или удалить Azure SSIS IR. В ней также показано, как развернуть Azure SSIS IR путем добавления дополнительных узлов в среду выполнения интеграции. 
- [Присоединение среды выполнения интеграции Azure SSIS к виртуальной сети](join-azure-ssis-integration-runtime-virtual-network.md) В этой статье содержатся общие сведения о присоединении среды выполнения интеграции Azure–SSIS к виртуальной сети Azure. В ней также показано, как настроить виртуальную сеть, чтобы присоединить среду выполнения интеграции Azure–SSIS к виртуальной сети с помощью портала Azure. 

## <a name="integration-runtime-location"></a>Расположение среды выполнения интеграции

### <a name="relationship-between-factory-location-and-ir-location"></a>Отношение между расположением фабрики и расположением IR

Когда клиент создает экземпляр фабрики данных, ему необходимо указать расположение фабрики данных. Расположение фабрики данных — это место, в котором хранятся метаданные этой фабрики данных и из которого инициируется конвейер. Метаданные для фабрики хранятся только в выбранном регионе клиента и не будут храниться в других регионах.

Сейчас, чтобы переместить данные между хранилищами данных или обработать данные с помощью служб вычислений, фабрика данных может обращаться к хранилищам данных и службам вычислений в других регионах Azure. Это поведение реализуется через [глобально доступную среду IR](https://azure.microsoft.com/global-infrastructure/services/) для обеспечения соответствия данных, эффективности и снижения расходов на исходящий трафик.

Расположение среды IR определяет расположение ее вычислительных ресурсов, то есть, по сути, место выполнения всех операций по перемещению данных, диспетчеризации действий и выполнению пакета SSIS. Расположение IR может отличаться от расположения фабрики данных, которой она принадлежит. 

### <a name="azure-ir-location"></a>Расположение Azure IR

Можно задать определенное расположение Azure IR, в этом случае выполнение или отправку действия будет происходить в определенном регионе.

Если вы решили использовать автоматическое разрешение Azure IR в общедоступной сети (по умолчанию),

- Для действия копирования ADF-файл будет оптимальным решением для автоматического обнаружения расположения хранилища данных в приемнике, а затем использовать IR в том же регионе, если он доступен, или ближе всего к одному географическому элементу. Если регион хранилища данных-приемник не удается обнаружить, используется IR в регионе фабрики данных в качестве альтернативы.

  Например, у вас есть ваша фабрика, созданная в восточной части США, 
  
  - При копировании данных в большой двоичный объект Azure в западной части США, если ADF успешно обнаружил, что BLOB-объект находится в западной части США, действие копирования выполняется на IR в западной части США; Если при обнаружении региона происходит сбой, действие копирования выполняется на IR в восточной части США.
  - При копировании данных в Salesforce, для которых не удается обнаружить регион, действие копирования выполняется на IR в восточной части США.

  >[!TIP] 
  >Если применяются строгие требования к соответствию данных и нужно, чтобы данные не покидали определенную географическую область, вы можете явным образом создать среду Azure IR в конкретном регионе и направить связанную службу в эту среду IR с помощью свойства ConnectVia. Например, если вы хотите скопировать данные из большого двоичного объекта в южная часть Соединенного Королевства в Azure синапсе Analytics в южная часть Соединенного Королевства и хотите убедиться, что данные не оставляют Великобритании, создайте Azure IR в южная часть Соединенного Королевства и свяжите обе связанные службы с этим IR.

- Для выполнения операции Lookup/-Metadata/Delete (также называемых действиями конвейера), диспетчеризации действий преобразования (также называемых внешними действиями) и операций создания (проверка соединения, просмотр списка папок и списка таблиц, предварительный просмотр данных), ADF использует IR в области фабрики данных.

- Для потока данных ADF использует IR в области фабрики данных. 

  > [!TIP] 
  > Рекомендуется убедиться, что поток данных выполняется в том же регионе, что и соответствующие хранилища данных (если это возможно). Это можно сделать, выполнив автоматическую разрешающую Azure IR (если расположение хранилища данных совпадает с расположением фабрики данных) или создав новый экземпляр Azure IR в том же регионе, в котором хранятся данные, а затем выполнить на нем поток данных. 

Если вы включили управляемую виртуальную сеть для автоматического разрешения Azure IR, ADF использует IR в области фабрики данных. 

Вы можете отслеживать, какие расположения IR используются во время выполнения действия, в представлении мониторинга действий конвейера в пользовательском интерфейсе или в полезных данных мониторинга действий.

### <a name="self-hosted-ir-location"></a>Расположение локальной среды IR

Локальная IR логически регистрируется в фабрике данных, а вычислительные ресурсы для ее работы вы предоставляете самостоятельно. Поэтому для локальных IR нельзя явно задать свойство расположения. 

Если локальная IR используется для перемещения данных, она извлекает данные из источника и записывает их в приемник.

### <a name="azure-ssis-ir-location"></a>Расположение среды Azure-SSIS IR

От выбора расположения для службы Azure SSIS IR зависит производительность рабочих процессов извлечения, преобразования и загрузки.

- Расположение Azure-SSIS IR не обязательно должно совпадать с расположением фабрики данных, но должно совпадать с расположением собственной базы данных SQL Azure или SQL Управляемый экземпляр, где SSISDB. Это позволит среде выполнения интеграции Azure SSIS легко обращаться к базе данных SSIS, не генерируя лишний трафик между расположениями.
- Если у вас нет существующей базы данных SQL или SQL Управляемый экземпляр, но у вас есть локальные источники данных или назначения, следует создать новую базу данных SQL Azure или SQL Управляемый экземпляр в том же расположении, что и виртуальная сеть, подключенная к локальной сети.  Таким образом вы можете создать Azure-SSIS IR с помощью новой базы данных SQL Azure или SQL Управляемый экземпляр и присоединить эту виртуальную сеть в одном расположении, что позволит свести к минимуму перемещение данных в разных местах.
- Если расположение существующей базы данных SQL Azure или Управляемый экземпляр SQL не совпадает с расположением виртуальной сети, подключенной к локальной сети, сначала создайте Azure-SSIS IR с помощью существующей базы данных SQL Azure или Управляемый экземпляр SQL, а затем соедините другую виртуальную сеть в том же расположении, а затем настройте виртуальную сеть для подключения к виртуальной сети между разными расположениями.

На следующей схеме показаны параметры расположения фабрики данных и ее среды выполнения интеграции.

![Расположение среды выполнения интеграции](media/concepts-integration-runtime/integration-runtime-location.png)

## <a name="determining-which-ir-to-use"></a>Выбор IR для использования

### <a name="copy-activity"></a>Действие копирования

Для действия копирования нужны связанные службы источника и приемника данных, которые определяют направление потока данных. Далее описан алгоритм выбора экземпляра среды выполнения интеграции, который будет выполнять копирование. 

- **Копирование между двумя облачными источниками данных**. когда службы источника и приемника используют Azure IR, ADF использует региональные Azure IR, если вы указали, или автоматическое определение расположения Azure IR при выборе автоматического разрешения IR (по умолчанию), как описано в разделе [расположение среды выполнения интеграции](#integration-runtime-location) .
- **Копирование между облачным источником данных и источником данных в частной сети**. Если связанная служба источника или приемника использует локальную IR, действие копирования выполняется в среде в этой локальной среде.
- **Копирование между двумя источниками данных в частной сети**: как связанная служба источника и приемника должны указывать на один и тот же экземпляр среды выполнения интеграции, и эта среда выполнения интеграции используется для выполнения действия копирования.

### <a name="lookup-and-getmetadata-activity"></a>Действие поиска и получения метаданных

Действие поиска и получения метаданных выполняется в среде выполнения интеграции, ассоциированной со связанной службой хранилища данных.

### <a name="external-transformation-activity"></a>Действие внешнего преобразования

Каждое действие внешнего преобразования, использующее внешний модуль вычислений, имеет целевую связанную службу вычислений, которая указывает на среду выполнения интеграции. Этот экземпляр среды выполнения интеграции определяет расположение, из которого отправляется это внешнее действие преобразования, запрограммированное вручную.

### <a name="data-flow-activity"></a>Действие потока данных

Действия потока данных выполняются в связанной с ним среде выполнения интеграции Azure. Вычисление Spark, используемое потоками данных, определяется свойствами потока данных в Azure Integration Runtime и полностью управляется ADF.

## <a name="next-steps"></a>Дальнейшие действия

См. следующие статьи:

- [Создание среды выполнения интеграции Azure](create-azure-integration-runtime.md)
- [Создание и настройка локальной среды выполнения интеграции](create-self-hosted-integration-runtime.md)
- [Создайте среду выполнения интеграции Azure SSIS](create-azure-ssis-integration-runtime.md). Эта статья раскрывает учебник и содержит инструкции по использованию Управляемый экземпляр SQL и присоединению инфракрасной связи к виртуальной сети.