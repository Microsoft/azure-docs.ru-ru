---
title: Режим отладки потока данных сопоставления
description: Запуск интерактивного сеанса отладки при создании потоков данных
ms.author: makromer
author: kromerm
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 02/19/2021
ms.openlocfilehash: 0aa472aca40acbaf3f8c8a09469d08fe6b37187a
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "101699765"
---
# <a name="mapping-data-flow-debug-mode"></a>Режим отладки потока данных сопоставления

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

## <a name="overview"></a>Обзор

Режим отладки потока данных сопоставления фабрики данных Azure позволяет интерактивно наблюдать за преобразованием формы данных во время сборки и отладки потоков данных. Сеанс отладки можно использовать как во время разработки потока данных, так и во время выполнения потоков данных для отладки конвейера. Чтобы включить режим отладки, используйте кнопку "Отладка потока данных" в верхней части области конструктора.

![Ползунок отладки](media/data-flow/debugbutton.png "Ползунок отладки")

После включения ползунка вам будет предложено выбрать конфигурацию среды выполнения интеграции, которую вы хотите использовать. Если выбран параметр Ауторесолвеинтегратионрунтиме, будет отображаться кластер с восемью ядрами "общий", а также по умолчанию с 60-минутным временем для жизни. Если вы хотите сделать группу неактивной до истечения времени ожидания сеанса, можно выбрать более высокий срок жизни. Дополнительные сведения о средах выполнения интеграции потока данных см. в разделе [производительность потока данных](concepts-data-flow-performance.md#ir).

![Выбор IR для отладки](media/data-flow/debug-new-1.png "Выбор IR для отладки")

Если включен режим отладки, вы будете в интерактивном режиме создавать поток данных с активным кластером Spark. Сеанс будет закрыт после отключения отладки в Фабрике данных Azure. Следует помнить о почасовой оплате, которая взимается в Azure Databricks за время, когда сеанс отладки был включен.

В большинстве случаев рекомендуется строить потоки данных в режиме отладки, чтобы можно было проверить бизнес-логику и просмотреть преобразования данных перед публикацией работы в фабрике данных Azure. Используйте кнопку "Отладка" на панели конвейера для проверки потока данных в конвейере.

![Просмотр сеансов отладки потока данных](media/iterative-development-debugging/view-dataflow-debug-sessions.png)

> [!NOTE]
> Каждый сеанс отладки, запускаемый пользователем из пользовательского интерфейса браузера ADF, — это новый сеанс с собственным кластером Spark. Вы можете использовать представление Мониторинг для сеансов отладки выше, чтобы просматривать сеансы отладки на фабрике и управлять ими. За каждый час производится оплата каждый сеанс отладки, включая время существования TTL.

## <a name="cluster-status"></a>Состояние кластера

Индикатор состояния кластера в верхней части области конструктора становится зеленым, когда кластер готов к отладке. Если кластер уже готов, тогда зеленый индикатор появится практически мгновенно. Если кластер не был запущен при переходе в режим отладки, кластер Spark выполняет холодную загрузку. Индикатор будет прокрутся до тех пор, пока среда не будет готова к интерактивной отладке.

После завершения отладки отключите параметр Отладка, чтобы кластер Spark мог завершить работу, и вы больше не оплачиваете оплату за действия по отладке.

## <a name="debug-settings"></a>Параметры отладки

После включения режима отладки можно изменить способ предварительного просмотра данных в потоке данных. Параметры отладки можно изменить, нажав кнопку "параметры отладки" на панели инструментов холста потока данных. Вы можете выбрать ограничение строки или источник файла для использования в каждом из исходных преобразований. Ограничения строк в этом параметре относятся только к текущему сеансу отладки. Можно также выбрать промежуточную связанную службу, которая будет использоваться для источника Azure синапсе Analytics. 

![Параметры отладки](media/data-flow/debug-settings.png "Параметры отладки")

Если у вас есть параметры в потоке данных или в любом из набора данных, на которые имеются ссылки, можно указать, какие значения следует использовать во время отладки, выбрав вкладку **Параметры** .

Используйте параметры выборки, чтобы указать образцы файлов или образцы таблиц данных, чтобы не нужно было изменять исходные DataSet. Используя образец файла или таблицы, можно сохранить в потоке данных те же параметры логики и свойств, что и при тестировании подмножества данных.

![Параметры отладки](media/data-flow/debug-settings2.png "Параметры отладки")

Значение по умолчанию, используемое для режима отладки в потоках данных ADF, — небольшой 4-ядерный однорабочий узел с 4-ядерным узлом одного драйвера. Это прекрасно подходит для небольших выборок данных при тестировании логики потока данных. Если вы развернете ограничения строк в параметрах отладки во время предварительной версии данных или настроили большее количество выборок в источнике во время отладки конвейера, можно рассмотреть возможность установки более крупной среды вычислений в новом Azure Integration Runtime. Затем можно перезапустить сеанс отладки с помощью более крупной среды вычислений.

## <a name="data-preview"></a>Предварительный просмотр данных

В режиме отладки вкладка "Предварительный просмотр данных" засветится на нижней панели. Без режима отладки поток данных будет показывать только текущие метаданные в и из всех преобразований на вкладке Проверка. Предварительный просмотр данных запрашивает только число строк, заданное в качестве ограничения в параметрах отладки. Нажмите кнопку **Обновить** , чтобы получить предварительную версию данных.

![Предварительный просмотр данных](media/data-flow/datapreview.png "Предварительный просмотр данных")

> [!NOTE]
> Источники файлов ограничивают только отображаемые строки, но не считываемые строки. Для очень больших наборов данных рекомендуется взять небольшую часть этого файла и использовать его для тестирования. Можно выбрать временный файл в параметрах отладки для каждого источника, который является типом файлового набора данных.

Если при работе с Потоком данных включен режим отладки, данные не записываются в преобразование приемника. Сеанс отладки предназначен для использования в качестве тестового окружения для преобразований. Приемники не нужны во время отладки и игнорируются в потоке данных. Если вы хотите протестировать запись данных в приемник, выполните поток данных из конвейера фабрики данных Azure и используйте выполнение отладки из конвейера.

Предварительный просмотр данных — это моментальный снимок преобразованных данных, использующий ограничения строк и выборку данных из кадров данных в памяти Spark. Поэтому в этом сценарии не используются и не тестируются драйверы приемника.

### <a name="testing-join-conditions"></a>Тестирование условий соединения

При выполнении модульного тестирования соединений, существующих или преобразований "Уточняющий запрос" убедитесь, что для теста используется небольшой набор известных данных. Чтобы задать временный файл, который будет использоваться для тестирования, можно использовать параметр параметры отладки выше. Это необходимо, поскольку при ограничении или отборе строк из большого набора данных нельзя предсказать, какие строки и какие ключи будут считываться в последовательность для тестирования. Результат является недетерминированным, что означает, что условия объединения могут завершиться ошибкой.

### <a name="quick-actions"></a>Быстрые действия

После просмотра данных можно создать быстрое преобразование для приведения, удаления или внесения изменений в столбец. Щелкните заголовок столбца и выберите один из параметров на панели инструментов предварительного просмотра данных.

![На снимке экрана показана панель инструментов предварительного просмотра данных с параметрами: приведение, изменение, статистика и удаление.](media/data-flow/quick-actions1.png "Быстрые действия")

После выбора изменения предварительный просмотр данных будет немедленно обновлен. Нажмите кнопку **подтвердить** в правом верхнем углу, чтобы создать новое преобразование.

![На снимке экрана показана кнопка подтверждения.](media/data-flow/quick-actions2.png "Быстрые действия")

**Приведение** и **изменение** приводят к формированию преобразования «Производный столбец», а **Удаление** создаст преобразование «SELECT».

![На снимке экрана показаны параметры производного столбца.](media/data-flow/quick-actions3.png "Быстрые действия")

> [!NOTE]
> При изменении потока данных необходимо повторно получить предварительную версию данных перед добавлением быстрого преобразования.

### <a name="data-profiling"></a>Профилирование данных

Выбор столбца на вкладке Предварительный просмотр данных и нажатие кнопки **Статистика** на панели инструментов Предварительный просмотр данных повлечет за собой диаграмму на правом краю сетки данных с подробными статистическими данными о каждом поле. Фабрика данных Azure будет принимать решения на основе выборки данных того типа диаграммы, который нужно отобразить. Поля высокой кратности будут по умолчанию иметь значения NULL/NOT NULL, тогда как категория и числовые данные с низкой кратностью будут отображать линейчатые диаграммы, отображающие частоту значений данных. Вы также увидите максимальную или длинную длину строковых полей, минимальное и максимальное значения в числовых полях, стандартную разработку, процентили, количество и среднее значение.

![Статистика по столбцам](media/data-flow/stats.png "Статистика по столбцам")

## <a name="next-steps"></a>Дальнейшие действия

* После завершения сборки и отладки потока данных [выполните его из конвейера.](control-flow-execute-data-flow-activity.md)
* При тестировании конвейера с потоком данных используйте [параметр выполнения отладки](iterative-development-debugging.md) конвейера.
