---
title: Мониторинг потоков данных сопоставления
description: Визуальное наблюдение за потоками данных сопоставления в фабрике данных Azure
author: kromerm
ms.author: makromer
ms.reviewer: daperlov
ms.service: data-factory
ms.topic: conceptual
ms.custom: seo-lt-2019
ms.date: 11/22/2020
ms.openlocfilehash: 9ca5ea5cdebe297af5081ae6e219935c56ba942e
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "96004889"
---
# <a name="monitor-data-flows"></a>Мониторинг потоков данных

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

После создания и отладки потока данных вы, возможно, захотите настроить его выполнение по расписанию в контексте конвейера. Вы можете запланировать запуск конвейера из службы "Фабрика данных Azure" с помощью триггеров. Кроме того, с помощью параметра Trigger Now (Запустить сейчас) в построителе конвейеров в службе "Фабрика данных Azure" вы можете инициировать однократное выполнение, чтобы проверить поток данных в контексте конвейера.

Во время выполнения конвейера вы сможете осуществлять мониторинг конвейера и всех содержащихся в нем действий, в том числе действия потока данных. Щелкните значок мониторинга на панели слева пользовательского интерфейса службы "Фабрика данных Azure". Появится экран, аналогичный показанному ниже. Выделенные значки позволят посмотреть подробные сведения о действиях в конвейере, в том числе действии потока данных.

![На снимке экрана показаны значки для выбора конвейеров для получения дополнительных сведений.](media/data-flow/mon001.png "Мониторинг потоков данных")

На этом уровне вы увидите статистику, включая статистику времени выполнения и состояния. Идентификаторы выполнения на уровне действия и конвейера отличаются. На предыдущем уровне приведен идентификатор выполнения конвейера. Если выбрать значок очков, появятся подробные сведения о выполнении потока данных.

![На снимке экрана показан значок очков для просмотра сведений о выполнении потока данных.](media/data-flow/monitoring-details.png "Мониторинг потоков данных")

В представлении графического мониторинга узла приведена упрощенная доступная только для просмотра версия графа потока данных.

![Снимок экрана показывает версию диаграммы, которая доступна только для просмотра.](media/data-flow/mon003.png "Мониторинг потоков данных")

Ниже приведено видео о мониторинге производительности потоков данных с экрана мониторинга ADF:

> [!VIDEO https://www.microsoft.com/en-us/videoplayer/embed/RE4u4mH]

## <a name="view-data-flow-execution-plans"></a>Просмотр планов выполнения потоков данных

Когда поток данных выполняется в Spark, Фабрика данных Azure определяет оптимальные пути выполнения кода на основе цельности потока данных. Кроме того, пути выполнения могут возникнуть на разных узлах горизонтального масштабирования и в разных секциях данных. Таким образом, граф мониторинга представляет структуру потока, принимая во внимание путь выполнения преобразований. При выборе отдельных узлов вы увидите "группировки", представляющие код, который выполнялся вместе в кластере. Время и числа, которые вы видите, относятся к этим группам, а не отдельным этапам в структуре.

![На снимке экрана показана страница для потока данных.](media/data-flow/mon004.png "Мониторинг потоков данных")

* Если выбрать пустое место в окне мониторинга, в нижней области появится статистика со временем и количеством строк по каждому приемнику, а также преобразования, данные из приемников которых отображаются в журнале преобразований.

* При выборе отдельных преобразований на панели справа появятся дополнительные сведения со статистикой по секциям, количеством столбцов, показателями асимметрии (насколько равномерно распределяются данные по секциям) и эксцесса (число пиков в данных).

* Если выбрать приемник в представлении узла, отобразится журнал преобразований столбцов. Существуют три различных метода накопления столбцов в потоке данных перед попаданием в приемник. К ним относятся:

  * Вычисляемый. Вы используете столбец для условной обработки или в выражении в потоке данных, но не помещаете его в приемник.
  * Производный. Столбец создается в потоке, т. е. он отсутствует в источнике.
  * Сопоставленный. Столбец поступил из источника, и его сопоставление выполняется в поле приемника.
  * Состояние потока: текущее состояние выполнения.
  * Состояние запуска кластера: время, уходящее на получение вычислительной среды JIT Spark для выполнения потока данных.
  * Число преобразований: количество шагов преобразования, выполняемых в потоке.
  
![На снимке экрана показан параметр обновления.](media/data-flow/monitornew.png "Мониторинг потоков данных")

## <a name="total-sink-processing-time-vs-transformation-processing-time"></a>Общее время обработки приемника и время обработки преобразования

Каждый этап преобразования включает в себя общее время выполнения этого этапа с учетом общего количества операций, связанных с каждым выполнением секции. Щелкнув приемник, вы увидите "время обработки приемника". Это время включает в себя общее время преобразования *и* время ввода-вывода, затраченное на запись данных в целевое хранилище. Разница между временем обработки приемника и общей суммой преобразования — время ввода-вывода для записи данных.

Вы также можете просмотреть подробные сведения о каждом шаге преобразования секций, если открыть выходные данные JSON из действия потока данных в представлении мониторинга конвейера ADF. JSON содержит время в миллисекундах для каждой секции, в то время как представление мониторинга UX представляет собой совокупное время объединения секций.

```
 {
     "stage": 4,
     "partitionTimes": [
          14353,
          14914,
          14246,
          14912,
          ...
         ]
}
```

### <a name="post-processing-time"></a>Время завершающей обработки

При выборе на карте значка преобразования приемника на панели слайдов справа будет отображаться дополнительная точка данных, называемая "время обработки" в нижней части страницы. Это количество времени, затраченного на выполнение задания в кластере Spark *после* загрузки, преобразования и написания данных. Это время может включать в себя закрытие пулов соединений, завершение работы драйвера, удаление файлов, объединение файлов и т. д. При выполнении в потоке действий, например "перемещение файлов" и "вывод в отдельный файл", скорее всего, будет увеличиваться значение времени обработки.
  
## <a name="error-rows"></a>Строки с ошибками

Включение обработки ошибок строк в приемнике потока данных будет отражено в выходных данных мониторинга. Если для приемника задано значение "сообщать об ошибке", в выходных данных мониторинга отображается количество успешных и неудачных строк при щелчке узла мониторинг приемника.

![На снимке экрана показаны строки ошибок.](media/data-flow/error-row-2.png "Мониторинг строки ошибки выполнен успешно")

При выборе команды "сообщить о сбое при ошибке" будут отображаться те же выходные данные, что и в выходном тексте мониторинга активности. Это связано с тем, что действие потока данных вернет ошибку для выполнения и подробное представление мониторинга будет недоступно.

![На снимке экрана показаны строки ошибок в действии.](media/data-flow/error-rows-4.png "Ошибка при мониторинге строки")

## <a name="monitor-icons"></a>Значки мониторинга

Этот значок означает, что данные преобразования уже были кэшированы в кластере, поэтому это учитывается при расчете времени и определении пути выполнения.

![На снимке экрана показан значок диска.](media/data-flow/mon005.png "Мониторинг потоков данных")

Кроме того, вы увидите зеленые круглые значки в преобразовании. Это количество приемников, в которые передаются данные.
