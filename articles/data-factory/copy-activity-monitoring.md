---
title: Мониторинг действия копирования
description: Узнайте, как отслеживать выполнение действия копирования в фабрике данных Azure.
author: linda33wj
ms.service: data-factory
ms.topic: conceptual
ms.date: 08/06/2020
ms.author: jingwang
ms.openlocfilehash: 58860e404dff3030e51ff2977eaee081a15247f7
ms.sourcegitcommit: d4734bc680ea221ea80fdea67859d6d32241aefc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100388300"
---
# <a name="monitor-copy-activity"></a>Мониторинг действия копирования

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

В этой статье описано, как отслеживать выполнение действия копирования в фабрике данных Azure. Это продолжение [статьи об обзоре действия копирования](copy-activity-overview.md), в которой представлены общие сведения о действии копирования.

## <a name="monitor-visually"></a>Визуальный мониторинг

Создав и опубликовав конвейер в фабрике данных Azure, его можно связать с триггером или вручную запустить прямое выполнение. В пользовательском интерфейсе фабрики данных Azure по умолчанию можно отслеживать все выполнения конвейера. Общие сведения о мониторинге фабрики данных Azure в целом с [визуального мониторинга фабрики данных Azure](monitor-visually.md).

Чтобы отслеживать выполнение действия копирования, перейдите в пользовательский интерфейс "создатель фабрики данных **& монитор** ". На вкладке **монитор** отображается список запусков конвейеров, щелкните ссылку **имя конвейера** , чтобы получить доступ к списку выполнения действий в конвейере.

![Мониторинг выполнения конвейера](./media/copy-activity-overview/monitor-pipeline-run.png)

На этом уровне можно просмотреть ссылки на входные данные действия копирования, выходные данные и ошибки (если не удается выполнить действие копирования), а также статистику, например длительность или состояние. Если нажать кнопку **сведений** (очков) рядом с именем действия копирования, вы получите подробные сведения о выполнении действия копирования. 

![Мониторинг выполнения действия копирования](./media/copy-activity-overview/monitor-copy-activity-run.png)

В этом графическом представлении мониторинга фабрика данных Azure предоставляет сведения о выполнении действия копирования, включая том чтения и записи данных, число файлов и строк данных, скопированных из источника в приемник, пропускная способность, конфигурации, применяемые для сценария копирования, действия, выполняемые действием копирования, с учетом соответствующих длительностей и сведений и т. д. Сведения о возможных метриках и подробном описании см. в [этой таблице](#monitor-programmatically) . 

В некоторых сценариях при выполнении действия копирования в фабрике данных вы увидите **«Советы по настройке производительности»**  в верхней части представления наблюдения за действиями копирования, как показано в примере. Советы указывают на узкие места, выявленные модулем ADF для конкретного выполнения копирования, а также рекомендации по изменению пропускной способности копирования. Дополнительные сведения об [автоматической настройке производительности](copy-activity-performance-troubleshooting.md#performance-tuning-tips).

В нижней части **сведений о выполнении и длительности** описываются основные этапы, с которыми проходит действие копирования, что особенно полезно для устранения неполадок с производительностью копирования. Узким местом при выполнении копирования является одна из самых длинных периодов. Дополнительные сведения см. в статье [Устранение неполадок с производительностью действий копирования](copy-activity-performance-troubleshooting.md) для каждого этапа и подробное руководство по устранению неполадок.

**Пример. копирование из Amazon S3 в Azure Data Lake Storage 2-го поколения**

![Отслеживание сведений о выполнении действия копирования](./media/copy-activity-overview/monitor-copy-activity-run-details.png)

## <a name="monitor-programmatically"></a>Мониторинг при помощи программных средств

Сведения о выполнении действия копирования и характеристики производительности также возвращаются в разделе **вывод результатов выполнения действия копирования**  >   , который используется для визуализации представления мониторинга пользовательского интерфейса. Ниже приведен полный список свойств, которые могут быть возвращены. Вы увидите только те свойства, которые применимы к сценарию копирования. Сведения о программном мониторинге выполнения действий в целом см. в разделе [программный мониторинг фабрики данных Azure](monitor-programmatically.md).

| Имя свойства  | Описание | Единица в выходных данных |
|:--- |:--- |:--- |
| dataRead | Фактический объем данных, считанных из источника. | Значение Int64 в байтах |
| dataWritten | Фактическое подключение данных, записанных или зафиксированных в приемнике. Размер может отличаться от `dataRead` размера, так как он связан с тем, как каждое хранилище данных хранит данные. | Значение Int64 в байтах |
| filesRead | Число файлов, считанных из файлового источника. | Значение Int64 (не единица измерения) |
| filesWritten | Число файлов, записанных или зафиксированных в приемнике на основе файлов. | Значение Int64 (не единица измерения) |
| филесскиппед | Число файлов, пропущенных в файловом источнике. | Значение Int64 (не единица измерения) |
| датаконсистенциверификатион | Сведения о проверке согласованности данных, где можно узнать, были ли скопированные данные согласованы между исходным и целевым хранилищами. Дополнительные сведения см. в [этой статье](copy-activity-data-consistency.md#monitoring). | Массив |
| саурцепеакконнектионс | Пиковое число одновременных подключений, установленных для исходного хранилища данных во время выполнения действия копирования. | Значение Int64 (не единица измерения) |
| синкпеакконнектионс | Пиковое число одновременных подключений, установленных в хранилище данных приемника во время выполнения действия копирования. | Значение Int64 (не единица измерения) |
| ровсреад | Число строк, считанных из источника. Эта метрика не применяется при копировании файлов "как есть" без их синтаксического анализа, например, если наборы данных исходного и приемника имеют тип двоичного формата или другой тип формата с идентичными параметрами. | Значение Int64 (не единица измерения) |
| rowsCopied | Число строк, скопированных в приемник. Эта метрика не применяется при копировании файлов "как есть" без их синтаксического анализа, например, если наборы данных исходного и приемника имеют тип двоичного формата или другой тип формата с идентичными параметрами.  | Значение Int64 (не единица измерения) |
| rowsSkipped | Количество пропущенных несовместимых строк. Можно включить пропуск несовместимых строк, задав `enableSkipIncompatibleRow` для значение true. | Значение Int64 (не единица измерения) |
| copyDuration | Длительность выполнения копирования. | Значение Int32 в секундах |
| throughput | Интенсивность передачи данных. | Число с плавающей запятой, в кбит/с |
| саурцепеакконнектионс | Пиковое число одновременных подключений, установленных для исходного хранилища данных во время выполнения действия копирования. | Значение Int32 (без единицы измерения) |
| синкпеакконнектионс| Пиковое число одновременных подключений, установленных в хранилище данных приемника во время выполнения действия копирования.| Значение Int32 (без единицы измерения) |
| sqlDwPolyBase | Используется ли Polybase при копировании данных в Azure синапсе Analytics. | Логическое |
| redshiftUnload | Используется ли выгрузка при копировании данных из RedShift. | Логическое |
| hdfsDistcp | Используется ли DistCp при копировании данных из HDFS. | Логическое |
| effectiveIntegrationRuntime | Среда выполнения интеграции (IR) или среда выполнения, используемая для выполнения действия, в формате `<IR name> (<region if it's Azure IR>)` . | Текст (string) |
| usedDataIntegrationUnits | Единицы интеграции актуальных данных во время копирования. | Значение Int32 |
| usedParallelCopies | Использованное количество параллельных процессов копирования. | Значение Int32 |
| logPath | Путь к журналу сеанса пропущенных данных в хранилище BLOB-объектов. См. раздел [отказоустойчивость](copy-activity-overview.md#fault-tolerance). | Текст (string) |
| executionDetails | Дополнительные сведения о стадиях, с которыми проходит действие копирования, и соответствующих шагах, длительностей, конфигурациях и т. д. Мы не рекомендуем анализировать этот раздел, так как он может измениться. Чтобы лучше понять, как она помогает понять и устранять неполадки при копировании, см. раздел [мониторинг визуального](#monitor-visually) раздела. | Массив |
| перфрекоммендатион | Скопируйте советы по настройке производительности. Дополнительные сведения см. в разделе [Советы по настройке производительности](copy-activity-performance-troubleshooting.md#performance-tuning-tips) . | Массив |
| биллингреференце | Потребление счетов за заданный запуск. Дополнительные сведения см. в статье [мониторинг потребления на уровне выполнения действий](plan-manage-costs.md#monitor-consumption-at-activity-run-level). | Объект |
| дуратионинкуеуе | Длительность очереди в секунду перед началом выполнения действия копирования. | Объект |

**Пример**.

```json
"output": {
    "dataRead": 1180089300500,
    "dataWritten": 1180089300500,
    "filesRead": 110,
    "filesWritten": 110,
    "filesSkipped": 0,
    "sourcePeakConnections": 640,
    "sinkPeakConnections": 1024,
    "copyDuration": 388,
    "throughput": 2970183,
    "errors": [],
    "effectiveIntegrationRuntime": "DefaultIntegrationRuntime (East US)",
    "usedDataIntegrationUnits": 128,
    "billingReference": "{\"activityType\":\"DataMovement\",\"billableDuration\":[{\"Managed\":11.733333333333336}]}",
    "usedParallelCopies": 64,
    "dataConsistencyVerification": 
    { 
        "VerificationResult": "Verified", 
        "InconsistentData": "None" 
    },
    "executionDetails": [
        {
            "source": {
                "type": "AmazonS3"
            },
            "sink": {
                "type": "AzureBlobFS",
                "region": "East US",
                "throttlingErrors": 6
            },
            "status": "Succeeded",
            "start": "2020-03-04T02:13:25.1454206Z",
            "duration": 388,
            "usedDataIntegrationUnits": 128,
            "usedParallelCopies": 64,
            "profile": {
                "queue": {
                    "status": "Completed",
                    "duration": 2
                },
                "transfer": {
                    "status": "Completed",
                    "duration": 386,
                    "details": {
                        "listingSource": {
                            "type": "AmazonS3",
                            "workingDuration": 0
                        },
                        "readingFromSource": {
                            "type": "AmazonS3",
                            "workingDuration": 301
                        },
                        "writingToSink": {
                            "type": "AzureBlobFS",
                            "workingDuration": 335
                        }
                    }
                }
            },
            "detailedDurations": {
                "queuingDuration": 2,
                "transferDuration": 386
            }
        }
    ],
    "perfRecommendation": [
        {
            "Tip": "6 write operations were throttled by the sink data store. To achieve better performance, you are suggested to check and increase the allowed request rate for Azure Data Lake Storage Gen2, or reduce the number of concurrent copy runs and other data access, or reduce the DIU or parallel copy.",
            "ReferUrl": "https://go.microsoft.com/fwlink/?linkid=2102534 ",
            "RuleName": "ReduceThrottlingErrorPerfRecommendationRule"
        }
    ],
    "durationInQueue": {
        "integrationRuntimeQueue": 0
    }
}
```

## <a name="next-steps"></a>Дальнейшие действия
См. другие статьи о действиях копирования:

\- [Действие копирования в фабрике данных Azure](copy-activity-overview.md)

\- [Руководство по настройке производительности действия копирования](copy-activity-performance.md)