---
title: Формат XML в фабрике данных Azure
description: В этом разделе описывается, как работать с форматом XML в фабрике данных Azure.
author: linda33wj
ms.service: data-factory
ms.topic: conceptual
ms.date: 10/29/2020
ms.author: jingwang
ms.openlocfilehash: a4082e1e00ecb1d3b0157fcc35616704eaab0aae
ms.sourcegitcommit: d4734bc680ea221ea80fdea67859d6d32241aefc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/14/2021
ms.locfileid: "100386362"
---
# <a name="xml-format-in-azure-data-factory"></a>Формат XML в фабрике данных Azure

[!INCLUDE[appliesto-adf-asa-md](includes/appliesto-adf-asa-md.md)]

Если вы хотите **проанализировать XML-файлы**, следуйте этой статье. 

Формат XML поддерживается для следующих соединителей: [Amazon S3](connector-amazon-simple-storage-service.md), [большой двоичный объект Azure](connector-azure-blob-storage.md), [Azure Data Lake Storage 1-го поколения](connector-azure-data-lake-store.md), [Azure Data Lake Storage 2-го поколения](connector-azure-data-lake-storage.md), [хранилище файлов Azure](connector-azure-file-storage.md), [Файловая система](connector-file-system.md), [FTP](connector-ftp.md), [Google Cloud Storage](connector-google-cloud-storage.md), [HDFS](connector-hdfs.md), [http](connector-http.md)и [SFTP](connector-sftp.md). Он поддерживается в качестве источника, но не для приемника.

## <a name="dataset-properties"></a>Свойства набора данных

Полный список разделов и свойств, доступных для определения наборов данных, см. в статье о [наборах данных](concepts-datasets-linked-services.md). В этом разделе содержится список свойств, поддерживаемых XML-набором данных.

| Свойство         | Описание                                                  | Обязательно |
| ---------------- | ------------------------------------------------------------ | -------- |
| type             | Свойство Type набора данных должно иметь значение **XML**. | Да      |
| location         | Параметры расположения файлов. Каждый файловый соединитель имеет собственный тип расположения и поддерживаемые свойства в разделе `location` . **См. сведения в статье о соединителе. раздел свойств набора данных >**. | Да      |
| encodingName     | Тип кодировки, используемый для чтения и записи тестовых файлов. <br>Допустимы следующие значения: "UTF-8", "UTF-16", "UTF-16BE", "UTF-32", "UTF-32BE", "US-ASCII", "UTF-7", "BIG5", "EUC-JP", "EUC-KR", "GB2312", "GB18030", "JOHAB", "SHIFT-JIS", "CP875", "CP866", "IBM00858", "IBM037", "IBM273", "IBM437", "IBM500", "IBM737", "IBM775", "IBM850", "IBM852", "IBM855", "IBM857", "IBM860", "IBM861", "IBM863", "IBM864", "IBM865", "IBM869", "IBM870", "IBM01140", "IBM01141", "IBM01142", "IBM01143", "IBM01144", "IBM01145", "IBM01146", "IBM01147", "IBM01148", "IBM01149", "ISO-2022-JP", "ISO-2022-KR", "ISO-8859-1", "ISO-8859-2", "ISO-8859-3", "ISO-8859-4", "ISO-8859-5", "ISO-8859-6", "ISO-8859-7", "ISO-8859-8", "ISO-8859-9", "ISO-8859-13" , "ISO-8859-15", "WINDOWS-874", "WINDOWS-1250", "WINDOWS-1251", "WINDOWS-1252", "WINDOWS-1253", "WINDOWS-1254", "WINDOWS-1255", "WINDOWS-1256", "WINDOWS-1257", "WINDOWS-1258".| Нет       |
| nullValue | Задает строковое представление значения NULL.<br/>Значение по умолчанию — **пустая строка**. | Нет |
| compression | Группа свойств для настройки сжатия файла. Настройте этот раздел, если требуется сжатие и распаковка во время выполнения действия. | Нет |
| type<br>(*в `compression` разделе*) | Кодек сжатия, используемый для чтения и записи XML-файлов. <br>Допустимые значения: **bzip2**, **gzip**, **Deflate**, **ZipDeflate**, **таргзип**, **tar**, **привязки** или **lz4**. Значение по умолчанию не сжато.<br>**Примечание** . в настоящее время действие копирования не поддерживает "привязку" & "lz4", а поток данных сопоставления не поддерживает "ZipDeflate", "таргзип" и "tar".<br>**Обратите внимание** , что при использовании действия копирования для распаковки файлов **ZipDeflate** / **таргзип** / **tar** и записи в файловый приемник данных файлы по умолчанию извлекаются в папку: `<path specified in dataset>/<folder named as source compressed file>/` , `preserveZipFileNameAsFolder` / `preserveCompressionFileNameAsFolder` чтобы указать, следует ли сохранять имена сжатых файлов в виде структуры папок, используйте параметр [Источник действия копирования](#xml-as-source) . | Нет.  |
| уровень<br/>(*в `compression` разделе*) | Коэффициент сжатия. <br>Допустимые значения: **оптимальный** или **самый быстрый**.<br>- **Самый быстрый:** Операция сжатия должна завершиться как можно быстрее, даже если итоговый файл не сжимается оптимально.<br>- **Оптимально**. операция сжатия должна быть оптимально сжата, даже если выполнение операции займет больше времени. Дополнительные сведения см. в разделе [Уровень сжатия](/dotnet/api/system.io.compression.compressionlevel). | Нет       |

Ниже приведен пример набора данных XML в хранилище BLOB-объектов Azure.

```json
{
    "name": "XMLDataset",
    "properties": {
        "type": "Xml",
        "linkedServiceName": {
            "referenceName": "<Azure Blob Storage linked service name>",
            "type": "LinkedServiceReference"
        },
        "typeProperties": {
            "location": {
                "type": "AzureBlobStorageLocation",
                "container": "containername",
                "folderPath": "folder/subfolder",
            },
            "compression": {
                "type": "ZipDeflate"
            }
        }
    }
}
```

## <a name="copy-activity-properties"></a>Свойства действия копирования

Полный список разделов и свойств, используемых для определения действий, см. в статье [Конвейеры и действия в фабрике данных Azure](concepts-pipelines-activities.md). В этом разделе содержится список свойств, поддерживаемых источником XML.

Сведения о сопоставлении XML-данных и приемника хранилища данных и формата в [сопоставлении схем](copy-activity-schema-and-type-mapping.md). При предварительном просмотре XML-файлов данные отображаются с иерархией JSON, а для указания полей используется путь JSON.

### <a name="xml-as-source"></a>XML в качестве источника

В разделе ***\* Источник \**** действия копирования поддерживаются следующие свойства. Дополнительные сведения см. в статье [поведение соединителя XML](#xml-connector-behavior).

| Свойство      | Описание                                                  | Обязательно |
| ------------- | ------------------------------------------------------------ | -------- |
| type          | Свойство Type источника действия копирования должно иметь значение **XmlSource**. | Да      |
| форматсеттингс | Группа свойств. См. таблицу **параметров чтения XML** ниже. | Нет       |
| сторесеттингс | Группа свойств для чтения данных из хранилища данных. Каждый файловый соединитель имеет собственные Поддерживаемые параметры чтения в разделе `storeSettings` . Дополнительные **сведения см. в статье о соединителе — > свойства действия копирования**. | Нет       |

Поддерживаемые **параметры чтения XML** в разделе `formatSettings` :

| Свойство      | Описание                                                  | Обязательно |
| ------------- | ------------------------------------------------------------ | -------- |
| type          | Для типа Форматсеттингс должно быть задано значение **ксмлреадсеттингс**. | Да      |
| validationMode | Указывает, следует ли проверять схему XML.<br>Допустимые значения: **None** (по умолчанию, без проверки), **XSD** (проверка с использованием XSD), **DTD** (проверка с помощью DTD). | нет |
| пространства имен | Следует ли включать пространство имен при синтаксическом анализе XML-файлов. Допустимые значения: **true** (по умолчанию), **false**. | нет |
| намеспацепрефиксес | URI пространства имен для сопоставления с префиксом, который используется для именования полей при синтаксическом анализе XML-файла.<br/>Если в XML-файле есть пространство имен и включено пространство имен, по умолчанию имя поля совпадает с именем в XML-документе.<br>Если в этой карте есть элемент, определенный для URI пространства имен, имя поля будет иметь значение `prefix:fieldName` . | Нет |
| детектдататипе | Определяет, следует ли обнаруживать типы данных Integer, Double и Boolean. Допустимые значения: **true** (по умолчанию), **false**.| нет |
| компрессионпропертиес | Группа свойств для распаковки данных для данного кодека сжатия. | Нет       |
| пресервезипфиленамеасфолдер<br>(*под `compressionProperties` -> `type` именем `ZipDeflateReadSettings`*)  | Применяется, когда для входного набора данных настроено сжатие **ZipDeflate** . Указывает, следует ли сохранять имя исходного zip-файла в виде структуры папок во время копирования.<br>— Если задано значение **true (по умолчанию)**, фабрика данных записывает распакованные файлы в `<path specified in dataset>/<folder named as source zip file>/` .<br>— Если задано значение **false**, фабрика данных записывает несжатые файлы непосредственно в `<path specified in dataset>` . Убедитесь, что у вас нет повторяющихся имен файлов в разных файлах ZIP-файлов, чтобы избежать перегонки или непредвиденного поведения.  | Нет |
| пресервекомпрессионфиленамеасфолдер<br>(*в `compressionProperties` -> `type` виде `TarGZipReadSettings` или `TarReadSettings`*) | Применяется, когда для входного набора данных настроено сжатие **таргзип** / **tar** . Указывает, следует ли сохранять имя исходного сжатого файла в виде структуры папок во время копирования.<br>— Если задано значение **true (по умолчанию)**, фабрика данных записывает распакованные файлы в `<path specified in dataset>/<folder named as source compressed file>/` . <br>— Если задано значение **false**, фабрика данных записывает распакованные файлы непосредственно в `<path specified in dataset>` . Убедитесь, что у вас нет повторяющихся имен файлов в разных исходных файлах, чтобы избежать перегонки или непредвиденного поведения. | Нет |

## <a name="mapping-data-flow-properties"></a>Свойства потока данных для сопоставления

При сопоставлении потоков данных можно выполнять чтение и запись в формате XML в следующих хранилищах данных: [хранилище BLOB-объектов Azure](connector-azure-blob-storage.md#mapping-data-flow-properties), [Azure Data Lake Storage 1-го поколения](connector-azure-data-lake-store.md#mapping-data-flow-properties)и [Azure Data Lake Storage 2-го поколения](connector-azure-data-lake-storage.md#mapping-data-flow-properties). Можно указать XML-файлы с помощью набора данных XML или [встроенного набора данных](data-flow-source.md#inline-datasets).

### <a name="source-properties"></a>Свойства источника

В таблице ниже перечислены свойства, поддерживаемые источником XML. Эти свойства можно изменить на вкладке **Параметры источника** . Дополнительные сведения см. в статье [поведение соединителя XML](#xml-connector-behavior). При использовании встроенного набора данных вы увидите дополнительные параметры файла, которые совпадают со свойствами, описанными в разделе [Свойства набора данных](#dataset-properties) . 

| Имя | Описание | Обязательно | Допустимые значения | Свойство сценария потока данных |
| ---- | ----------- | -------- | -------------- | ---------------- |
| Подстановочные пути | Будут обработаны все файлы, соответствующие пути с подстановочными знаками. Переопределяет папку и путь к файлу, заданные в наборе данных. | Нет | String[] | вилдкардпасс |
| Корневой путь раздела | Для секционированных файловых данных можно ввести корневой путь к разделу, чтобы считывать секционированные папки в виде столбцов. | нет | Строка | партитионрутпас |
| Список файлов | Указывает, указан ли источник на текстовый файл, в котором перечислены обрабатываемые файлы | Нет | `true` либо `false` | fileList |
| Столбец для хранения имени файла | Создать новый столбец с именем и путем к исходному файлу | нет | Строка | ровурлколумн |
| После завершения | Удалите или переместите файлы после обработки. Путь к файлу начинается с корня контейнера | Нет | Delete: `true` или `false` <br> Поместить `['<from>', '<to>']` | пуржефилес <br>мовефилес |
| Фильтровать по дате последнего изменения | Выберите фильтр файлов в зависимости от времени последнего изменения | Нет | Отметка времени | modifiedAfter <br>modifiedBefore |
| Режим проверки | Указывает, следует ли проверять схему XML. | Нет | `None` (по умолчанию, без проверки)<br>`xsd` (проверка с использованием XSD)<br>`dtd` (проверка с помощью DTD). | validationMode |
| Пространства имен | Следует ли включать пространство имен при синтаксическом анализе XML-файлов. | Нет | `true` (по умолчанию) или `false` | пространства имен |
| Пары префиксов пространств имен | URI пространства имен для сопоставления с префиксом, который используется для именования полей при синтаксическом анализе XML-файла.<br/>Если в XML-файле есть пространство имен и включено пространство имен, по умолчанию имя поля совпадает с именем в XML-документе.<br>Если в этой карте есть элемент, определенный для URI пространства имен, имя поля будет иметь значение `prefix:fieldName` . | Нет | Массив с шаблоном`['URI1'->'prefix1','URI2'->'prefix2']` | намеспацепрефиксес |
| Разрешить не найдены файлы | Если значение — true, ошибка не возникает, если файлы не найдены | Нет | `true` либо `false` | игноренофилесфаунд |

### <a name="xml-source-script-example"></a>Пример скрипта источника XML

Приведенный ниже скрипт является примером конфигурации источника XML в таблице сопоставление потоков данных с помощью режима набора данных.

```
source(allowSchemaDrift: true,
    validateSchema: false,
    validationMode: 'xsd',
    namespaces: true) ~> XMLSource
```

Приведенный ниже скрипт является примером конфигурации источника XML с помощью встроенного режима набора данных.

```
source(allowSchemaDrift: true,
    validateSchema: false,
    format: 'xml',
    fileSystem: 'filesystem',
    folderPath: 'folder',
    validationMode: 'xsd',
    namespaces: true) ~> XMLSource
```

## <a name="xml-connector-behavior"></a>Поведение соединителя XML

При использовании XML в качестве источника Обратите внимание на следующее.

- XML-атрибуты:

    - Атрибуты элемента анализируются как подполя элемента в иерархии.
    - Имя поля атрибута соответствует шаблону `@attributeName` .

- Проверка XML-схемы:

    - Можно выбрать не проверять схему или проверить схему с помощью XSD или DTD.
    - При использовании XSD или DTD для проверки XML-файлов необходимо ссылаться на XSD/DTD внутри XML-файлов по относительному пути.

- Обработка пространства имен:

    - Пространство имен можно отключить при использовании потока данных. в этом случае атрибуты, определяющие пространство имен, будут анализироваться как обычные атрибуты.
    - При включении пространства имен имена элементов и атрибутов следуют шаблону       `namespaceUri,elementName` и по `namespaceUri,@attributeName` умолчанию. Можно определить префикс пространства имен для каждого URI пространства имен в источнике, в этом случае имена элемента и атрибуты следуют шаблону `definedPrefix:elementName` или `definedPrefix:@attributeName` вместо него.

- Столбец значений:

    - Если XML-элемент имеет как простое текстовое значение, так и атрибуты или дочерние элементы, то простое текстовое значение анализируется как значение столбца значений со встроенным именем поля `_value_` . Он также наследует пространство имен элемента, если применимо.

## <a name="next-steps"></a>Следующие шаги

- [Действие копирования в фабрике данных Azure](copy-activity-overview.md)
- [Поток данных для сопоставления](concepts-data-flow-overview.md)
- [Действие поиска](control-flow-lookup-activity.md)
- [Действие получения метаданных в Фабрике данных Azure](control-flow-get-metadata-activity.md)