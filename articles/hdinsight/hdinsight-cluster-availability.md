---
title: Как отслеживать доступность кластера с помощью Apache Ambari в Azure HDInsight
description: Узнайте, как использовать Apache Ambari для мониторинга работоспособности и доступности кластера.
ms.service: hdinsight
ms.topic: how-to
ms.custom: hdinsightactive,seoapr2020
ms.date: 05/01/2020
ms.openlocfilehash: dcbe44defeb89ad2f67833b263e5f4983070a46c
ms.sourcegitcommit: 42e4f986ccd4090581a059969b74c461b70bcac0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2021
ms.locfileid: "104863536"
---
# <a name="how-to-monitor-cluster-availability-with-apache-ambari-in-azure-hdinsight"></a>Как отслеживать доступность кластера с помощью Apache Ambari в Azure HDInsight

Кластеры HDInsight включают Apache Ambari, который предоставляет сведения о работоспособности на быстром и предопределенных оповещениях.

В этой статье показано, как использовать Ambari для мониторинга кластера и пошаговые инструкции по настройке оповещений Ambari, наблюдению за доступностью узлов и созданию оповещения Azure Monitor, которое срабатывает, когда период пульса не был получен с одного или нескольких узлов за пять часов.

## <a name="dashboard"></a>Панель мониторинга

Доступ к панели мониторинга Ambari можно получить, перейдя по ссылке **Ambari** в разделе **панели мониторинга кластера** в обзоре HDInsight в портал Azure, как показано ниже. Кроме того, доступ к нему можно получить, перейдя `https://CLUSTERNAME.azurehdinsight.net` в браузер, где имя_кластера — это имя кластера.

:::image type="content" source="media/hdinsight-cluster-availability/azure-portal-dashboard-ambari.png" alt-text="Представление портала ресурсов HDInsight":::

Затем вам будет предложено ввести имя пользователя и пароль для входа в кластер. Введите учетные данные, выбранные при создании кластера.

Затем вы перейдете на панель мониторинга Ambari, которая содержит мини-приложения, отображающие несколько метрик, чтобы получить краткий обзор работоспособности кластера HDInsight. Эти мини-приложения показывают метрики, такие как количество динамических узлов данных (рабочих узлов) и Жаурналнодес (узел Zookeeper), время бесперебойной работы Наменодес (головные узлы), а также метрики, относящиеся к определенным типам кластеров, такие как YARN время работы ResourceManager для кластеров Spark и Hadoop.

:::image type="content" source="media/hdinsight-cluster-availability/apache-ambari-dashboard.png" alt-text="Отображение панели мониторинга с помощью Apache Ambari":::

## <a name="hosts--view-individual-node-status"></a>Узлы — Просмотр состояния отдельного узла

Также можно просмотреть сведения о состоянии отдельных узлов. Перейдите на вкладку **узлы** , чтобы просмотреть список всех узлов в кластере, и ознакомьтесь с основными сведениями о каждом узле. Зеленая галочка слева от имени каждого узла указывает на то, что все компоненты находятся на узле. Если компонент не работает на узле, вместо зеленой проверки отображается красный предупреждающий треугольник.

:::image type="content" source="media/hdinsight-cluster-availability/apache-ambari-hosts1.png" alt-text="Представление узлов HDInsight Apache Ambari":::

Затем можно выбрать **имя** узла, чтобы просмотреть более подробные метрики узла для этого конкретного узла. В этом представлении отображается состояние и доступность каждого отдельного компонента.

:::image type="content" source="media/hdinsight-cluster-availability/apache-ambari-hosts-node.png" alt-text="Apache Ambari размещает представление одного узла":::

## <a name="ambari-alerts"></a>Ambari оповещения

Ambari также предлагает несколько настраиваемых оповещений, которые могут предоставлять уведомления о определенных событиях. Когда оповещения запускаются, они отображаются в левом верхнем углу Ambari в красном значке, содержащем количество оповещений. При выборе этого значка отображается список текущих оповещений.

:::image type="content" source="media/hdinsight-cluster-availability/apache-ambari-alerts.png" alt-text="Число текущих предупреждений Apache Ambari":::

Чтобы просмотреть список определений предупреждений и их состояний, перейдите на вкладку **оповещения** , как показано ниже.

:::image type="content" source="media/hdinsight-cluster-availability/ambari-alerts-definitions.png" alt-text="Представление определений предупреждений Ambari":::

Ambari предлагает множество стандартных предупреждений, относящихся к доступности, в том числе:

| Имя предупреждения                        | Описание   |
|---|---|
| Сводка по работоспособности узла           | Это предупреждение уровня обслуживания активируется при наличии неработоспособных узлов с данным|
| Работоспособность высокой доступности NameNode | Это предупреждение уровня обслуживания активируется, если не запущены активные NameNode или резервные NameNode.|
| Процент доступных Жаурналнодес    | Это оповещение активируется, если количество Жаурналнодес вниз в кластере превышает заданное критическое пороговое значение. Он объединяет результаты проверок процесса Жаурналноде. |
| Доступно узлов в процентах       | Это оповещение активируется, если число отключенных узлов данных в кластере превышает заданное критическое пороговое значение. В нем суммируются результаты проверок в процессе обработки узлов данных.|


Чтобы просмотреть сведения о предупреждении или изменить критерии, выберите **имя** оповещения. В качестве примера следует использовать **сводку по работоспособности узлов** . Вы можете просмотреть описание предупреждения, а также конкретные критерии, которые активируют предупреждение или критическое оповещение и интервал проверки для критерия. Чтобы изменить конфигурацию, нажмите кнопку **изменить** в правом верхнем углу окна конфигурации.

:::image type="content" source="media/hdinsight-cluster-availability/ambari-alert-configuration.png" alt-text="Настройка оповещений Apache Ambari":::

Здесь можно изменить описание и, что более важно, интервал проверки и пороговые значения для предупреждений или критических оповещений.

:::image type="content" source="media/hdinsight-cluster-availability/ambari-alert-configuration-edit.png" alt-text="Представление для изменения конфигураций оповещений Ambari":::

В этом примере можно создать два неработоспособных узла, которые активируют критическое оповещение, и 1 неработоспособный узел только запустит предупреждение. По завершении редактирования нажмите кнопку **сохранить** .

## <a name="email-notifications"></a>уведомления по электронной почте.

При необходимости можно также настроить уведомления по электронной почте для оповещений Ambari. Для этого на вкладке **оповещения** нажмите кнопку **действия** в левом верхнем углу, а затем **Управление уведомлениями.**

:::image type="content" source="media/hdinsight-cluster-availability/ambari-manage-notifications.png" alt-text="Действие &quot;Управление уведомлениями&quot; Ambari":::

Откроется диалоговое окно для управления уведомлениями об оповещениях. Выберите в **+** нижней части диалогового окна и заполните обязательные поля, чтобы указать Ambari с данными о почтовом сервере, с которых следует отправлять сообщения электронной почты.

> [!TIP]
> Настройка уведомлений по электронной почте Ambari может быть хорошим способом получения оповещений в одном месте при управлении множеством кластеров HDInsight.

## <a name="next-steps"></a>Дальнейшие действия

- [Доступность и надежность кластеров Apache Hadoop в HDInsight](./hdinsight-business-continuity.md)
- [Доступность кластера — журналы Azure Monitor](./cluster-availability-monitor-logs.md)
- [Использование журналов Azure Monitor](hdinsight-hadoop-oms-log-analytics-tutorial.md)
- [Уведомления по электронной почте Apache Ambari](apache-ambari-email.md)
