---
title: Azure HDInsight Accelerated Writes for Apache HBase (Ускорение операций записи Azure HDInsight для Apache HBase)
description: В этой статье представлен обзор функции ускорения операций записи в Azure HDInsight, в которой используются управляемые диски уровня "Премиум" для повышения производительности журнала упреждающего ввода в Apache HBase.
ms.service: hdinsight
ms.topic: how-to
ms.date: 01/24/2020
ms.openlocfilehash: 1f5a9f05b94f43db9e1d883ef5e86f8621f39251
ms.sourcegitcommit: 2f9f306fa5224595fa5f8ec6af498a0df4de08a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "98943036"
---
# <a name="azure-hdinsight-accelerated-writes-for-apache-hbase"></a>Azure HDInsight Accelerated Writes for Apache HBase (Ускорение операций записи Azure HDInsight для Apache HBase)

Эта статья содержит сведения о функции **ускоренной записи** для Apache HBase в Azure HDInsight и о том, как ее можно эффективно использовать для повышения производительности операций записи. **Ускоренная запись** использует [управляемые диски Azure](../../virtual-machines/disks-types.md#premium-ssd) уровня "Премиум", чтобы повысить производительность журнала "Предварительная запись Apache HBase" (WAL). Дополнительные сведения о Apache HBase см. [в статье что такое Apache HBase в HDInsight](apache-hbase-overview.md).

## <a name="overview-of-hbase-architecture"></a>Общие сведения об архитектуре HBase

В HBase **строка** состоит из одного или нескольких **столбцов** и определяется **ключом строки**. **Таблица** состоит из нескольких строк. Столбцы содержат **ячейки**, имеющие отметки времени версии значения в этом столбце. Столбцы группируются в **семейства столбцов**, а все столбцы в семействе столбцов хранятся вместе в файлах хранилища с именем **файлах hFile**.

**Регионы** в HBase используются для балансировки нагрузки обработки данных. Сначала HBase сохраняет строки таблицы в одном регионе. Строки распределяются по нескольким регионам по мере увеличения объема данных в таблице. **Серверы регионов** могут выполнять запросы к нескольким регионам.

## <a name="write-ahead-log-for-apache-hbase"></a>Журнал упреждающего создания для Apache HBase

HBase сначала записывает обновления данных в тип журнала фиксации, называемый упреждающим журналом записи (WAL). После того как обновление будет сохранено в WAL, оно записывается в **MemStore** в памяти. Когда объем данных в памяти достигает максимальной емкости, он записывается на диск как **HFile**.

Если **регионсервер** завершается сбоем или становится недоступным до очистки MemStore, для воспроизведения обновлений можно использовать журнал упреждающего ввода. Без WAL в случае сбоя **регионсервер** перед очисткой обновлений в **HFile** все эти обновления теряются.

## <a name="accelerated-writes-feature-in-azure-hdinsight-for-apache-hbase"></a>Функция ускоренного записи в Azure HDInsight для Apache HBase

Функция ускорения операций записи решает проблему с большим количеством задержек при записи, вызванную созданием журналов, которые находятся в облачном хранилище.  Функция ускоренного записи для кластеров HDInsight Apache HBase присоединяет диски, управляемые SSD-накопителем класса Premium, к каждому Регионсервер (рабочему узлу). Затем записи журнала записываются в файловую систему Hadoop (HDFS), подключенную к этим управляемым дискам уровня "Премиум", а не облачному хранилищу.  Управляемые диски уровня "Премиум" используют диски Solid-State (SSDs) и предлагают отличную производительность операций ввода-вывода с отказоустойчивостью.  В отличие от неуправляемых дисков, если одна единица хранения выходит из строя, она не влияет на другие единицы хранения в той же группе доступности.  В результате управляемые диски обеспечивают низкую задержку при записи и повышенную устойчивость для ваших приложений. Дополнительные сведения о дисках, управляемых Azure, см. в статье Общие сведения о [управляемых дисках Azure](../../virtual-machines/managed-disks-overview.md).

## <a name="how-to-enable-accelerated-writes-for-hbase-in-hdinsight"></a>Включение ускоренного выполнения операций записи для HBase в HDInsight

Чтобы создать кластер HBase с функцией ускорения записи, выполните действия, описанные в разделе [Настройка кластеров в HDInsight](../hdinsight-hadoop-provision-linux-clusters.md). На вкладке " **основы** " выберите тип кластера HBase, укажите версию компонента и установите флажок рядом с **параметром включить операции записи HBase с ускорением**. Затем продолжите выполнение оставшихся действий по созданию кластера.

![Включить параметр ускоренной записи для HDInsight Apache HBase](./media/apache-hbase-accelerated-writes/azure-portal-create-hbase-wals.png)

## <a name="other-considerations"></a>Другие замечания

Чтобы сохранить устойчивость данных, создайте кластер с минимальным числом трех рабочих узлов. После создания кластер нельзя масштабировать до трех рабочих узлов.

Очистите или отключите таблицы HBase перед удалением кластера, чтобы не потерять данные журнала для записи.

```
flush 'mytable'
```

```
disable 'mytable'
```

Выполните аналогичные действия при уменьшении масштаба кластера: Очистка таблиц и отключение таблиц для остановки входящих данных. Вы не можете масштабировать кластер до трех узлов.

Выполнение этих действий обеспечит успешное увеличение масштаба и избежать возможного перехода namenode в защищенный режим из-за резервных копий или временных файлов.

Если namenode перейдет в безопасный режим после уменьшения масштаба, используйте команды HDFS для повторной репликации реплицируемых блоков и получения HDFS из безопасного режима. Эта повторная репликация позволит успешно перезапустить HBase.

## <a name="next-steps"></a>Дальнейшие действия

* Официальная документация по Apache HBase по [журналу "упреждающее создание](https://hbase.apache.org/book.html#wal) "
* Сведения об обновлении кластера HDInsight Apache HBase для ускорения записи см. в статье [Перенос кластера Apache HBase в новую версию](apache-hbase-migrate-new-version.md).
