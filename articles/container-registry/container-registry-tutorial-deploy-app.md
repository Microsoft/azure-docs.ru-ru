---
title: Учебник. Развертывание из геореплицированного реестра
description: Развертывание веб-приложения на основе Linux в два разных региона Azure с помощью образа контейнера из геореплицированного реестра контейнеров Azure. Вторая часть руководства из трех частей.
ms.topic: tutorial
ms.date: 08/20/2018
ms.custom: seodec18, mvc
ms.openlocfilehash: 7a203bfc9b1317bc258e4a93ae4ac03ecbdc7a15
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "92148424"
---
# <a name="tutorial-deploy-a-web-app-from-a-geo-replicated-azure-container-registry"></a>Руководство по Развертывание веб-приложения из геореплицированного реестра контейнеров Azure

Это вторая часть руководства, состоящего из трех частей. В [первой части](container-registry-tutorial-prepare-registry.md) создавался закрытый геореплицированный реестр контейнеров, а образ контейнера создавался из источника и отправлялся в реестр. В этой статье вы ознакомитесь с аспектом геореплицируемого реестра, касающимся сети. В рамках руководства контейнер развертывается в два экземпляра веб-приложений в двух разных регионах Azure. Затем каждый экземпляр извлекает образ контейнера из ближайшего реестра.

В этом руководстве, второй части серии:

> [!div class="checklist"]
> * образ контейнера развертывается в два экземпляра *веб-приложения для контейнеров*;
> * проверяется развернутое приложение.

Если геореплицированный реестр еще не создан и образ контейнерного примера приложения не отправлен в него, вернитесь к предыдущему руководству и серии: [Подготовка геореплицированного реестра контейнеров Azure](container-registry-tutorial-prepare-registry.md).

В следующей статье из этой серии будет выполнено обновление приложения и отправка обновленного образа контейнера в реестр. Наконец перейдите к каждому выполняющемуся экземпляру веб-приложения, чтобы просмотреть изменения, автоматически отображаемые в них, показывая георепликацию и веб-перехватчики реестра контейнеров Azure в действии.

## <a name="automatic-deployment-to-web-apps-for-containers"></a>Автоматическое развертывание в службе "Веб-приложение для контейнеров"

Реестр контейнеров Azure предоставляет поддержку для развертывания контейнерных приложений напрямую в [веб-приложения для контейнеров](../app-service/index.yml). В рамках этого руководства с помощью портала Azure развертывается образ контейнера, созданного в предыдущих руководствах, в два плана веб-приложений, расположенных в разных регионах.

Если при развертывании веб-приложения из образа контейнера в реестр у вас есть геореплицированный реестр в том же регионе, реестр контейнеров Azure создаст [веб-перехватчик](container-registry-webhook.md) образа развертывания для вас. При отправке нового образа в репозиторий контейнера, веб-перехватчик примет изменения и автоматически развернет новый образ контейнера в веб-приложении.

## <a name="deploy-a-web-app-for-containers-instance"></a>Развертывание экземпляра веб-приложения для контейнеров

На этом этапе создается экземпляр веб-приложения для контейнеров в регионе *западная часть США*.

Войдите на [портал Azure](https://portal.azure.com) и перейдите к реестру, созданному в предыдущем руководстве.

Выберите **Репозитории** > **acr-helloworld**, щелкните правой кнопкой мыши тег **v1** в разделе **Теги** и выберите **Развернуть в веб-приложении**:

![Развертывание в службу приложений на портале Azure][deploy-app-portal-01]

Если параметр "Развернуть в веб-приложении" отключен, это значит, что вы не включили администратора реестра, как указано в руководстве по [созданию реестра контейнеров](container-registry-tutorial-prepare-registry.md#create-a-container-registry). Вы можете включить администратора на портале Azure, выбрав **Параметры** > **Ключи доступа**.

В отобразившемся разделе **Веб-приложение для контейнеров** (отобразится, когда вы выберете "Развернуть в веб-приложении") укажите следующие значения параметров:

| Параметр | Значение |
|---|---|
| **Имя сайта** | Глобально уникальное имя для веб-приложения. В этом примере используется формат `<acrName>-westus`, чтобы легко определить реестр и регион из которого развернуто веб-приложение. |
| **Группа ресурсов** | **Используйте имеющиеся** > `myResourceGroup` |
| **Расположение или план службы приложений** | Создайте новый план с именем `plan-westus` в регионе **западная часть США**. |
| **Изображение** | `acr-helloworld:v1` |
| **Операционная система** | Linux |

> [!NOTE]
> При создании плана службы приложений для развертывания контейнерного приложения автоматически выбирается план по умолчанию для размещения приложения. План по умолчанию зависит от параметра операционной системы.

Выберите **Создать**, чтобы подготовить веб-приложение в регионе *западная часть США*.

![Снимок экрана: окно "Веб-приложение для контейнеров" с выделенной кнопкой "Создать"][deploy-app-portal-02]

## <a name="view-the-deployed-web-app"></a>Просмотр развернутого веб-приложения

После завершения развертывания можно просмотреть выполняющееся приложение, перейдя по URL-адресу в браузере.

На портале выберите **Службы приложений**, а затем — веб-приложение, которое было подготовлено на предыдущем шаге. В этом примере веб-приложение называется *uniqueregistryname westus*.

Выберите ссылку URL-адреса веб-приложения в правой верхней части раздела **Служба приложений** для просмотра выполняющегося приложения в браузере.

![Снимок экрана: раздел "Обзор" Службы приложений с выделенным URL-адресом веб-приложения][deploy-app-portal-04]

После развертывания образа Docker из геореплицированного реестра контейнеров сайт отобразит образ, представляющий регион Azure, в котором размещен реестр контейнеров.

![Снимок экрана: развернутое веб-приложение, просматриваемое в браузере][deployed-app-westus]

## <a name="deploy-second-web-app-for-containers-instance"></a>Развертывание второго экземпляра веб-приложения для контейнеров

Используйте процедуру, описанную в предыдущем разделе для развертывания второго веб-приложения в регионе *восточная часть США*. В разделе **Веб-приложение для контейнеров** укажите следующие значения.

| Параметр | Значение |
|---|---|
| **Имя сайта** | Глобально уникальное имя для веб-приложения. В этом примере используется формат `<acrName>-eastus`, чтобы легко определить реестр и регион из которого развернуто веб-приложение. |
| **Группа ресурсов** | **Используйте имеющиеся** > `myResourceGroup` |
| **Расположение или план службы приложений** | Создайте новый план с именем `plan-eastus` в регионе **восточная часть США**. |
| **Изображение** | `acr-helloworld:v1` |
| **Операционная система** | Linux |

Выберите **Создать**, чтобы подготовить веб-приложение в регионе *восточная часть США*.

![Снимок экрана: окно "Веб-приложение для контейнеров" с выделенной кнопкой "Создать"][deploy-app-portal-06]

## <a name="view-the-second-deployed-web-app"></a>Просмотр второго развернутого веб-приложения

Как и ранее можно просмотреть выполняющееся приложение, перейдя по URL-адресу в браузере.

На портале выберите **Службы приложений**, а затем — веб-приложение, которое было подготовлено на предыдущем шаге. В этом примере веб-приложение с именем *uniqueregistryname-eastus*.

Выберите ссылку URL-адреса веб-приложения в правой верхней части раздела **Обзор службы приложений** для просмотра выполняющегося приложения в браузере.

![Веб-приложение в конфигурации Linux на портале Azure][deploy-app-portal-07]

После развертывания образа Docker из геореплицированного реестра контейнеров сайт отобразит образ, представляющий регион Azure, в котором размещен реестр контейнеров.

![Просмотр развернутого веб-приложения в браузере][deployed-app-eastus]

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве было выполнено развертывание двух экземпляров веб-приложения для контейнеров из геореплицированного реестра контейнеров Azure.

Перейдите к следующему руководству, чтобы развернуть новый образ контейнера в реестре контейнеров, а затем убедитесь, что веб-приложения, выполняемые в обоих регионах были автоматически обновлены.

> [!div class="nextstepaction"]
> [Отправка обновленного образа в региональные развертывания](./container-registry-tutorial-deploy-update.md)

<!-- IMAGES -->
[deploy-app-portal-01]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-01.png
[deploy-app-portal-02]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-02.png
[deploy-app-portal-03]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-03.png
[deploy-app-portal-04]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-04.png
[deploy-app-portal-05]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-05.png
[deploy-app-portal-06]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-06.png
[deploy-app-portal-07]: ./media/container-registry-tutorial-deploy-app/deploy-app-portal-07.png
[deployed-app-westus]: ./media/container-registry-tutorial-deploy-app/deployed-app-westus.png
[deployed-app-eastus]: ./media/container-registry-tutorial-deploy-app/deployed-app-eastus.png