---
title: Шаблон мультитенантного веб-приложения | Документация Майкрософт
description: Найдите обзоры архитектуры и шаблоны разработки, описывающие, как реализовать мультитенантное веб-приложение в Azure.
services: ''
documentationcenter: .net
author: wadepickett
manager: wpickett
editor: ''
ms.assetid: 4f0281d2-1555-42b0-a99d-1222fade0b0f
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 06/05/2015
ms.author: wpickett
ms.custom: devx-track-dotnet
ms.openlocfilehash: d36a2804519e5728dd068cc6c06ad005244e8c95
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "95524102"
---
# <a name="multitenant-applications-in-azure"></a>Мультитенантные приложения Azure
Многоклиентское приложение — это общий ресурс, позволяющий пользователям в разных клиентах просматривать приложение, как если бы оно было собственным. Типичным сценарием, который вызывается для приложения с несколькими клиентами, является одно, в котором всем пользователям приложения из разных клиентов может потребоваться настроить пользовательский интерфейс, но в противном случае предъявляются те же базовые бизнес-требования. Примерами больших приложений с большим количеством клиентов являются Microsoft 365, Outlook.com и visualstudio.com.

С точки зрения поставщика приложения преимущества мультитенантности связаны в основном с оптимизацией работы и расходов. Одна версия приложения может соответствовать потребностям многих клиентов/заказчиков, что позволяет консолидировать задачи системного администрирования, такие как мониторинг, настройка производительности, поддержка программного обеспечения и резервное копирование данных.

Ниже приведен список наиболее значимых целей и требований с точки зрения поставщика.

* **Подготовка.** Необходимо иметь возможность подготавливать новых клиентов для приложения.  Для мультитенатных приложений с большим количеством клиентов, как правило, необходимо автоматизировать этот процесс, включив возможность самостоятельной подготовки.
* **Возможность поддержки.** Необходимо иметь возможность обновить приложение и выполнить другие задачи поддержки во время использования приложения несколькими клиентами.
* **Мониторинг.** Необходимо иметь возможность постоянного мониторинга приложения для определения любых проблем и их эффективного устранения. Это включает мониторинг использования приложения каждым клиентом.

Правильно реализованного мультитенантное приложение предоставляет пользователям следующие преимущества.

* **Изоляция.** Действия отдельных клиентов не влияют на использование приложения другими клиентами. Клиенты не могут получить доступ к данным друг друга. С точки зрения клиента он имеет эксклюзивный доступ к приложению.
* **Доступность.** Отдельные клиенты нуждаются в постоянной доступности приложения, возможно, с определением гарантии в соглашении об уровне обслуживания. Опять же, действия других клиентов не должны влиять на доступность приложения.
* **Масштабируемость.** Приложение масштабируется для соответствия требованиям отдельных клиентов. Присутствие и действия других клиентов не должны влиять на производительность приложения.
* **Расходы.** Расходы ниже, чем при использовании выделенного для одного клиента приложения, так как мультитенантность обеспечивает совместное использование ресурсов.
* Возможность **настройки**. Возможность настройки приложения для отдельного клиента различными способами, например путем добавления и удаления функциональных возможностей, изменения цветов и логотипов или даже добавления собственного кода или сценария.

Вкратце, хотя существует множество соображений, которые необходимо учитывать для предоставления высокомасштабируемой службы, существует ряд целей и требований, которые являются общими для многих приложений из нескольких клиентов. Некоторые могут не быть связаны с определенными сценариями, а важность отдельных целей и требований будут различаться в каждом сценарии. Как поставщик многоклиентского приложения, вы также имеете цели и требования, такие как, которые соответствуют целям и требованиям клиента, рентабельности, выставлению счетов, нескольким уровням обслуживания, подготовке, мониторингу поддержки и автоматизации.

Дополнительные сведения о дополнительных аспектах разработки мультитенантного приложения см. в статье [Размещение мультитенантного приложения в Azure][Hosting a Multi-Tenant Application on Azure]. Сведения о распространенных шаблонах архитектуры данных для мультитенантных приложений базы данных SaaS см. в статье [Шаблоны разработки для мультитенантных приложений SaaS с использованием Базы данных Azure SQL](./azure-sql/database/saas-tenancy-app-design-patterns.md). 

Azure предоставляет различные функциональные возможности, которые позволяют устранить основные проблемы, возникающие при разработке мультитенантной системы.

**Изоляция**

* Сегментирование клиентов веб-сайтов по заголовкам узлов с подключением TLS или без него
* Сегментация клиентов веб-сайтов с помощью параметров запросов.
* Веб-службы в рабочих ролях.
  * Рабочие роли, которые обычно обрабатывают данные в серверной части приложения.
  * Веб-роли, которые, как правило, функционируют как интерфейсные части приложений.

**Память**

Управление данными, например база данных SQL Azure или службы хранилища Azure, например служба таблиц, которая предоставляет службы для хранения больших объемов неструктурированных данных и службы BLOB-объектов, которая предоставляет службы для хранения больших объемов неструктурированных текстовых или двоичных данных, таких как видео, аудио и изображения.

* Защита многоклиентских данных в базе данных SQL для каждого клиента SQL Server имена входа.
* Используя таблицы Azure для ресурсов приложения, указав политику доступа на уровне контейнера, вы можете настроить разрешения, не выполняя для ресурсов новый URL-адрес, защищенный с помощью подписанных на основе общего доступа подписей.
* Очереди Azure для ресурсов приложения. Очереди Azure часто используются для выполнения обработки от имени клиентов, однако также могут быть использованы для распределения работы, необходимой для подготовки и управления.
* Очереди Service Bus для ресурсов приложения, которые передают работу в общую службу. Можно использовать отдельную очередь, где каждый клиент-отправитель может иметь разрешения (по требованиям ACS) только на передачу данных в эту очередь, тогда как только получатели из службы могут иметь разрешение на прием из очереди данных, поступающих от нескольких клиентов.

**Службы подключения и безопасности**

* Azure Service Bus — это инфраструктура обмена сообщениями, которая размещается между приложениями и позволяет им обмениваться сообщениями в слабосвязанной конфигурации для улучшения масштабирования и устойчивости.

**Сетевые службы**

Azure предоставляет несколько сетевых служб, поддерживающих проверку подлинности и повышающих управляемость размещенных приложений. К ним относятся перечисленные ниже службы.

* Виртуальная сеть Azure позволяет подготавливать виртуальные частные сети (VPN) в Azure, управлять ими, а также обеспечить безопасный канал с локальной ИТ-инфраструктурой.
* Диспетчер трафика (Traffic Manager) виртуальных сетей обеспечивает балансировку нагрузки по входящему трафику между несколькими размещенными службами Azure независимо от того, работают они в одном центре обработки данных или распределены по всему миру.
* Azure Active Directory (Azure AD) — это современная служба на основе интерфейса REST, которая предоставляет возможности для управления идентификацией и доступом в облачных приложениях. Использование Azure AD для ресурсов приложений обеспечивает простой способ проверки подлинности и авторизации пользователей для получения доступа к веб-приложениям и службам, одновременно позволяя выделять функции проверки подлинности и авторизации в коде.
* Azure Service Bus предоставляет возможность безопасного обмена сообщениями и передачи данных для распределенных и гибридных приложений, например связи между размещенными в Azure приложениями и локальными приложениями и службами без необходимости в использовании комплексных инфраструктур брандмауэра и безопасности. Использование ретранслятора служебной шины для ресурсов приложения для доступа к службам, предоставляемым в качестве конечных точек, может принадлежать клиенту (например, размещенному вне системы, например локально), или же они могут быть подготовлены специально для клиента (поскольку конфиденциальные данные, относящиеся к клиенту, перемещаются между ними).

**Подготовка ресурсов**

Azure предоставляет несколько способов инициализации новых клиентов для приложения. Для мультитенатных приложений с большим количеством клиентов, как правило, необходимо автоматизировать этот процесс, включив возможность самостоятельной подготовки.

* Рабочие роли позволяют подготовить и отменить подготовку ресурсов для каждого клиента (например, при регистрации или отмене регистрации клиентов), собирать показатели для использования этих данных, а также управлять масштабированием по определенному расписанию или в ответ на пересечение порогового значения или ключевого показателя производительности. Эта же роль может использоваться для передачи обновлений и модернизаций в решение.
* BLOB-объекты Azure могут использоваться для подготовки вычислительных ресурсов или предварительно инициализированных ресурсов хранения для новых клиентов, обеспечивая при этом политики доступа на уровне контейнера для защиты пакетов, VHD-образов и других ресурсов вычислительных служб.
* Возможности подготовки ресурсов баз данных SQL для клиентов включают следующие:
  
  * DDL в скриптах или внедренных в качестве ресурсов в сборках.
  * Пакеты SQL Server 2008 R2, развернутые программными средствами.
  * Копирование из главной эталонной базы данных.
  * Использование импорта и экспорта базы данных для подготовки новых баз данных из файла.

<!--links-->

[Hosting a Multi-Tenant Application on Azure]: /previous-versions/msp-n-p/hh534480(v=pandp.10)
[Designing Multitenant Applications on Azure]: https://msdn.microsoft.com/library/windowsazure/hh689716