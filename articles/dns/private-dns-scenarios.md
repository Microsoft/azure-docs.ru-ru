---
title: Сценарии для частных зон — Azure DNS
description: В этой статье описаны распространенные сценарии использования Частные зоны Azure DNS.
services: dns
author: rohinkoul
ms.service: dns
ms.topic: article
ms.date: 10/05/2019
ms.author: rohink
ms.openlocfilehash: ab850adb2e9a25778d5f44ba711eb0762fe562c8
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "76939344"
---
# <a name="azure-dns-private-zones-scenarios"></a>Сценарии использования частных зон Azure DNS

Частные зоны Azure DNS обеспечивают разрешение имен внутри виртуальной сети и между виртуальными сетями. В этой статье мы рассмотрим несколько распространенных сценариев, которые можно реализовать с помощью этой функции.

## <a name="scenario-name-resolution-scoped-to-a-single-virtual-network"></a>Сценарий. Разрешение имен в пределах одной виртуальной сети
В этом сценарии имеется виртуальная сеть в Azure, содержащая ряд ресурсов Azure, включая виртуальные машины. Требуется разрешать имена ресурсов из виртуальной сети через доменное имя (зону DNS), при этом разрешение имен должно быть частным и недоступным из Интернета. Кроме того, требуется, чтобы служба Azure автоматически регистрировала в зоне DNS виртуальные машины, размещенные в виртуальной сети. 

Этот сценарий описан ниже. Виртуальная сеть A содержит две виртуальные машины (VNETA-VM1 и VNETA-VM2). С каждой из них связаны частные IP-адреса. После создания частной зоны contoso.com и привязывания этой виртуальной сети в качестве виртуальной сети регистрации служба Azure DNS автоматически создаст две записи A в этой зоне, как показано ниже. Теперь на запросы DNS из VNETA-VM1 для разрешения VNETA-VM2.contoso.com будет отправляться ответ DNS, который содержит частный IP-адрес VNETA-VM2. Кроме того, на обратный запрос DNS (PTR) для частного IP-адреса (10.0.0.1) VNETA-VM1, отправленный из VNETA-VM2, будет получен ответ DNS с именем VNETA-VM1, что и требовалось. 

![Разрешение имен в отдельной виртуальной сети](./media/private-dns-scenarios/single-vnet-resolution.png)

## <a name="scenario-name-resolution-across-virtual-networks"></a>Сценарий. Разрешение имен между виртуальными сетями

Этот сценарий является наиболее распространенным случаем, когда нужно связать частную зону с несколькими виртуальными сетями. Этот сценарий может охватывать такие архитектуры, как "звезда", в которой к центральной виртуальной сети подключено несколько периферийных виртуальных сетей. Центральная виртуальная сеть может быть привязана к частной зоне как виртуальная сеть регистрации, а периферийные виртуальные сети — как виртуальные сети разрешения имен. 

На следующей схеме показана простая версия этого сценария, в которой имеются только две виртуальные сети — A и B. Сеть A используется в качестве виртуальной сети регистрации, а сеть B — в качестве виртуальной сети разрешения имен. Обе виртуальные сети должны совместно использовать общую зону contoso.com. При создании зоны и привязывании к ней виртуальных сетей разрешения имен и регистрации служба Azure автоматически регистрирует записи DNS для виртуальных машин (VNETA-VM1 и VNETA-VM2) из виртуальной сети A. Можно также вручную добавить записи DNS в зону для виртуальных машин в виртуальной сети разрешения B. При такой конфигурации поведение прямых и обратных запросов DNS будет следующим.
* На запрос DNS VNETB-VM1 в виртуальной сети разрешения имен B для VNETA-VM1.contoso.com будет получен ответ DNS, содержащий частный IP-адрес VNETA-1.
* На обратный запрос DNS (PTR) из VNETB-VM2 в виртуальной сети разрешения имен B для 10.1.0.1 будет получен ответ DNS, содержащий полное доменное имя VNETB-VM1.contoso.com.  
* В ответ на обратный запрос DNS (PTR) из VNETB-VM3 в виртуальной сети разрешения имен B для 10.0.0.1 будет получен NXDOMAIN. Причина заключается в том, что обратные запросы DNS относятся только к той же виртуальной сети. 


![Разрешение имен для нескольких виртуальных сетей](./media/private-dns-scenarios/multi-vnet-resolution.png)

## <a name="scenario-split-horizon-functionality"></a>Сценарий. Функциональные возможности "расщепления горизонта"

В этом сценарии приведен вариант использования, в котором для одной и той же зоны DNS требуется реализовать разный режим разрешения DNS в зависимости от того, где находится клиент (в Azure или в Интернете). Например, у вас могут быть частная и общедоступная версии приложения с разными функциональными возможностями и поведением, но вы хотите использовать одинаковое доменное имя для обеих версий. Этот сценарий можно реализовать с помощью Azure DNS, создав общедоступную зону DNS и частную зону с таким же именем.

Этот сценарий показан на следующей схеме. Имеется виртуальная сеть A с двумя виртуальными машинами (VNETA-VM1 и VNETA-VM2), для которых выделены частные и общедоступные IP-адреса. Вы создаете общедоступную зону DNS contoso.com и регистрируете в ней общедоступные IP-адреса этих виртуальных машин в качестве записей DNS. Кроме того, вы создаете частную зону DNS, которая также называется contoso.com, указав сеть A в качестве виртуальной сети регистрации. Azure автоматически зарегистрирует виртуальные машины как записи A в частной зоне, указав их частные IP-адреса.

Теперь, когда интернет-клиент отправит запрос DNS для поиска VNETA-VM1.contoso.com, служба Azure вернет запись общедоступного IP-адреса из общедоступной зоны. Если такой же запрос DNS будет отправлен из другой виртуальной машины (например, VNETA-VM2) в той же виртуальной сети A, то служба Azure вернет запись частного IP-адреса из частной зоны. 

![Разрешение имен с "расщеплением горизонта"](./media/private-dns-scenarios/split-brain-resolution.png)

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения об использовании частных зон DNS см. в статье [Using Azure DNS for private domains](private-dns-overview.md) (Использование Azure DNS для частных доменов).

Узнайте, как создать [частную зону DNS](./private-dns-getstarted-powershell.md) в Azure DNS.

Сведения о зонах и записях DNS см. в разделе [Общие сведения о зонах и записях DNS](dns-zones-records.md).

Дополнительные сведения о некоторых других ключевых [сетевых возможностях](../networking/networking-overview.md) Azure.

