---
title: Преобразование шаблона портала в спецификацию шаблона
description: Описывает, как преобразовать существующий шаблон из коллекции портал Azure в спецификации шаблона.
ms.topic: conceptual
ms.date: 01/22/2021
ms.author: tomfitz
author: tfitzmac
ms.openlocfilehash: 8fe02f55348f2cdcabb43e05bb547819d4b51228
ms.sourcegitcommit: 78ecfbc831405e8d0f932c9aafcdf59589f81978
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2021
ms.locfileid: "98739140"
---
# <a name="convert-template-gallery-in-portal-to-template-specs"></a>Преобразование коллекции шаблонов на портале в спецификации шаблонов

Портал Azure предоставляет способ хранения шаблонов Azure Resource Manager (шаблонов ARM) в учетной записи. **Эта функция является устаревшей.** Чтобы продолжить использовать шаблоны в этой коллекции, преобразуйте их в [спецификации шаблонов](template-specs.md).

В этой статье показано, как преобразовать существующие шаблоны из коллекции шаблонов в спецификации шаблонов.

На портале устаревшие функции называются **шаблонами (Предварительная версия)**. Чтобы узнать, есть ли у вас шаблоны для преобразования, просмотрите [коллекцию шаблонов на портале](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Gallery%2Fmyareas%2Fgalleryitems). Эти шаблоны имеют тип ресурса `Microsoft.Gallery/myareas/galleryitems` .

## <a name="deprecation-of-portal-feature"></a>Нерекомендуемая функция портала

Галерея шаблонов на портале устарела 21 января 2021 г. Его можно продолжать использовать до 21 февраля. Начиная с 22 февраля вы не можете создавать новые шаблоны в коллекции порталов, но вы по-прежнему можете просматривать и развертывать существующие шаблоны.

С 22 июня эта функция будет удалена с портала, а все операции API будут заблокированы. Вы не сможете просматривать или развертывать шаблоны из коллекции.

До 22 июня необходимо перенести все шаблоны, которые вы хотите продолжить использовать. Для переноса шаблонов можно использовать один из методов, приведенных в этой статье. После удаления компонента необходимо открыть обращение в службу поддержки, чтобы получить все шаблоны, которые не были перенесены.

## <a name="convert-with-powershell-script"></a>Преобразование с помощью скрипта PowerShell

Чтобы упростить преобразование шаблонов в галерее шаблонов, используйте сценарий PowerShell из репозитория шаблонов быстрого запуска Azure. При запуске скрипта можно либо создать новую спецификацию шаблона для каждого шаблона, либо скачать шаблон, который создает спецификацию шаблона. Скрипт не удаляет шаблон из коллекции шаблонов.

1. Скопируйте [Скрипт миграции](https://github.com/Azure/azure-quickstart-templates/blob/master/201-templatespec-migrate-create/Migrate-GalleryItems.ps1). Сохраните локальную копию с именем *Migrate-GalleryItems.ps1*.
1. Чтобы создать новые спецификации шаблонов, укажите значения для `-ResourceGroupName` параметров и `-Location` . 

   Задайте для параметра значение `ItemsToExport` `MyGalleryItems` , чтобы экспортировать шаблоны. Задайте для параметра значение `AllGalleryItems` , чтобы экспортировать все шаблоны, к которым у вас есть доступ.

   В следующем примере создаются новые спецификации шаблонов для каждого шаблона в группе ресурсов с именем **мигратедрг**. Скрипт создает группу ресурсов, если она не существует.

   ```azurepowershell
   .\Migrate-GalleryItems.ps1 -ResourceGroupName migratedRG -Location westus2 -ItemsToExport MyGalleryItems
   ```

1. Чтобы загрузить шаблоны, которые можно использовать для создания спецификаций шаблонов, не выводят значения для группы ресурсов или расположения. Вместо этого укажите `-ExportToFile` . Шаблон не совпадает с шаблоном в коллекции. Вместо этого он содержит ресурс спецификации шаблона, который создает спецификацию шаблона для шаблона.

   В следующем примере шаблоны загружаются без создания спецификаций шаблонов.

   ```azurepowershell
   .\Migrate-GalleryItems.ps1 -ItemsToExport MyGalleryItems -ExportToFile
   ```

   Сведения о развертывании шаблона, который создает спецификацию шаблона, см. в разделе [Краткое руководство по созданию и развертыванию шаблона Spec (Предварительная версия)](quickstart-create-template-specs.md).

Дополнительные сведения о скрипте и его параметрах см. в разделе [Создание темплатеспекс из шаблонов коллекции шаблонов](https://github.com/Azure/azure-quickstart-templates/tree/master/201-templatespec-migrate-create).

## <a name="manually-convert-through-portal"></a>Ручное преобразование через портал

Вы можете вручную скопировать шаблоны из коллекции в новые спецификации шаблонов.

1. Откройте [шаблоны (Предварительная версия)](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Gallery%2Fmyareas%2Fgalleryitems) на портале.
1. Выберите шаблон для миграции.
1. Выберите **Просмотр шаблона**.
1. Скопируйте содержимое шаблона.
1. На панели поиска портала найдите **спецификации шаблонов**. Выберите этот параметр.
1. Выберите **Создание спецификации шаблона**.
1. Укажите значения для параметров имя, подписка, Группа ресурсов, расположение и версия.
1. Выберите **Далее: изменить шаблон**.
1. Для содержимого шаблона вставьте скопированный шаблон из коллекции шаблонов.
1. Выберите **Review + Create** (Просмотреть и создать).
1. После успешного завершения проверки выберите **создать**.

Если вам нужно поделиться спецификацией шаблона с другими пользователями в Организации, [установите контроль доступа на основе ролей](../../role-based-access-control/tutorial-role-assignments-group-powershell.md) для группы или пользователей, которым требуется доступ.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о спецификациях шаблонов см. в статье [Создание и развертывание спецификаций шаблонов](template-specs.md).
