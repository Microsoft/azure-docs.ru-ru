---
title: Доступ к локальным источникам данных
description: Подключение к локальным источникам данных из Azure Logic Apps путем создания ресурса шлюза данных в Azure
services: logic-apps
ms.suite: integration
ms.reviewer: arthii, logicappspm
ms.topic: article
ms.date: 01/20/2021
ms.openlocfilehash: 356e63bb0a749ad0f41d886e75971e9b05c7f9dc
ms.sourcegitcommit: 867cb1b7a1f3a1f0b427282c648d411d0ca4f81f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "99219000"
---
# <a name="connect-to-on-premises-data-sources-from-azure-logic-apps"></a>Подключение к локальным источникам данных из Azure Logic Apps

После [установки локального *шлюза данных* на локальном компьютере](../logic-apps/logic-apps-gateway-install.md) и до того, как вы сможете получить доступ к локальным источникам данных из приложений логики, необходимо создать в Azure ресурс шлюза для установки шлюза. Затем этот ресурс шлюза можно выбрать в триггерах и действиях, которые вы хотите использовать для [локальных соединителей](../connectors/apis-list.md#on-premises-connectors) , доступных в Azure Logic Apps. Azure Logic Apps поддерживает операции чтения и записи через шлюз данных. Однако эти операции имеют [ограничения для размера полезных данных](/data-integration/gateway/service-gateway-onprem#considerations).

В этой статье показано, как создать ресурс шлюза Azure для ранее [установленного шлюза на локальном компьютере](../logic-apps/logic-apps-gateway-install.md). Дополнительные сведения о шлюзе см. [в разделе Работа шлюза](../logic-apps/logic-apps-gateway-install.md#gateway-cloud-service).

> [!TIP]
> Для прямого доступа к локальным ресурсам в виртуальных сетях Azure без использования шлюза рекомендуется создать [*среду службы интеграции*](../logic-apps/connect-virtual-network-vnet-isolated-environment-overview.md) . 

Сведения о том, как использовать шлюз с другими службами, см. в следующих статьях:

* [Локальный шлюз данных Microsoft Power Automate](/power-automate/gateway-reference)
* [Локальный шлюз данных](/power-bi/service-gateway-onprem)
* [Локальный шлюз данных Microsoft Power Apps](/powerapps/maker/canvas-apps/gateway-reference)
* [Локальный шлюз данных](../analysis-services/analysis-services-gateway.md)

<a name="supported-connections"></a>

## <a name="supported-data-sources"></a>Поддерживаемые источники данных

В Azure Logic Apps локальный шлюз данных поддерживает [локальные соединители](../connectors/apis-list.md#on-premises-connectors) для этих источников данных:

* BizTalk Server 2016
* Файловая система
* IBM DB2  
* IBM Informix
* IBM MQ
* MySQL
* Oracle Database
* PostgreSQL
* SAP
* SharePoint Server
* SQL Server
* Teradata

Вы также можете создавать [настраиваемые соединители](../logic-apps/custom-connector-overview.md) , которые подключаются к источникам данных по протоколам HTTP или HTTPS с помощью функции RESTFUL или SOAP. Хотя сам шлюз не требует дополнительных затрат, [модель ценообразования Logic Apps](../logic-apps/logic-apps-pricing.md) применяется к этим соединителям и другим операциям в Azure Logic Apps.

## <a name="prerequisites"></a>Предварительные условия

* [Локальный шлюз данных уже установлен на локальном компьютере](../logic-apps/logic-apps-gateway-install.md). Эта установка шлюза должна существовать до создания ресурса шлюза, ссылающегося на эту установку.

* У вас есть [та же учетная запись Azure и подписка](../logic-apps/logic-apps-gateway-install.md#requirements) , которые использовались для установки шлюза. Эта учетная запись Azure должна принадлежать только к одному [клиенту или каталогу Azure Active Directory (Azure AD)](../active-directory/fundamentals/active-directory-whatis.md#terminology). Для создания ресурса шлюза в Azure необходимо использовать одну и ту же учетную запись и подписку Azure, так как только администратор шлюза может создать ресурс шлюза в Azure. Субъекты-службы в настоящее время не поддерживаются.

  * При создании ресурса шлюза в Azure выберите установку шлюза, чтобы связать его с ресурсом шлюза и только с этим ресурсом шлюза. Каждый ресурс шлюза может ссылаться только на одну установку шлюза. Невозможно выбрать установку шлюза, которая уже связана с другим ресурсом шлюза.

  * Ресурсы приложения логики и шлюза не должны существовать в одной подписке Azure. В триггерах и действиях, где можно использовать ресурс шлюза, можно выбрать другую подписку Azure с ресурсом шлюза, но только в том случае, если эта подписка существует в том же клиенте или каталоге Azure AD, что и приложение логики. Кроме того, необходимо иметь права администратора на шлюзе, который может быть настроен другим администратором. Дополнительные сведения см. в статье [Data Gateway: Автоматизация с помощью PowerShell. часть 1](https://community.powerbi.com/t5/Community-Blog/Data-Gateway-Automation-using-PowerShell-Part-1/ba-p/1117330) и [PowerShell: Data Gateway-Add-датагатевайклустерусер](/powershell/module/datagateway/add-datagatewayclusteruser).

    > [!NOTE]
    > В настоящее время невозможно совместно использовать ресурсы шлюза или установки в нескольких подписках. Чтобы отправить отзыв о продукте, см. [Microsoft Azure форуме обратной связи](https://feedback.azure.com/forums/34192--general-feedback).

<a name="create-gateway-resource"></a>

## <a name="create-azure-gateway-resource"></a>Создание ресурса шлюза Azure

После установки шлюза на локальном компьютере создайте ресурс Azure для шлюза.

1. Войдите в [портал Azure](https://portal.azure.com) с той же учетной записью Azure, которая использовалась для установки шлюза.

1. В поле поиска портал Azure введите "локальный шлюз данных" и выберите **локальные шлюзы данных**.

   ![Поиск элемента "Локальный шлюз данных"](./media/logic-apps-gateway-connection/search-for-on-premises-data-gateway.png)

1. В разделе **локальные шлюзы данных** выберите **Добавить**.

   ![Добавление нового ресурса Azure для шлюза данных](./media/logic-apps-gateway-connection/add-azure-data-gateway-resource.png)

1. В разделе **Создание шлюза подключения** укажите эти сведения для ресурса шлюза. Когда все будет готово, выберите **Создать**.

   | Свойство. | Описание |
   |----------|-------------|
   | **Имя ресурса** | Укажите имя для ресурса шлюза, который содержит только буквы, цифры, дефисы ( `-` ), символы подчеркивания ( `_` ), круглые скобки ( `(` , `)` ) и точки ( `.` ). |
   | **Подписка** | Выберите подписку Azure для учетной записи Azure, которая использовалась для установки шлюза. Подписка по умолчанию основана на учетной записи Azure, которая использовалась для входа. |
   | **Группа ресурсов** | [Группа ресурсов Azure](../azure-resource-manager/management/overview.md) , которую вы хотите использовать. |
   | **Расположение** | Тот же регион или расположение, которые были выбраны для облачной службы шлюза во время [установки шлюза](../logic-apps/logic-apps-gateway-install.md). В противном случае установка шлюза не будет отображаться в списке **имя установки** . Расположение приложения логики может отличаться от расположения ресурса шлюза. |
   | **Имя установки** | Выберите установку шлюза, которая отображается в списке только при соблюдении следующих условий. <p><p>— При установке шлюза используется тот же регион, что и для ресурса шлюза, который вы хотите создать. <br>— Установка шлюза не связана с другим ресурсом шлюза Azure. <br>— Установка шлюза связана с той же учетной записью Azure, которую вы используете для создания ресурса шлюза. <br>— Ваша учетная запись Azure принадлежит одному [клиенту или каталогу Azure Active Directory (Azure AD)](../active-directory/fundamentals/active-directory-whatis.md#terminology) и является той же учетной записью, которая использовалась для установки шлюза. <p><p>Дополнительные сведения см. в разделе [часто задаваемые вопросы](#faq) . |
   |||

   Ниже приведен пример установки шлюза, расположенного в том же регионе, что и ресурс шлюза, и он связан с одной и той же учетной записью Azure:

   ![Укажите сведения для создания ресурса шлюза данных](./media/logic-apps-gateway-connection/on-premises-data-gateway-create-connection.png)

<a name="connect-logic-app-gateway"></a>

## <a name="connect-to-on-premises-data"></a>Подключение к локальным данным

Когда вы создадите ресурс шлюза и свяжете свою подписку Azure с этим ресурсом, можно будет создать подключение между приложением логики и локальным источником данных с помощью шлюза.

1. На портале Azure создайте приложение логики или откройте его в конструкторе приложений логики.

1. Добавьте соединитель, который поддерживает локальные подключения, например **SQL Server**.

1. Установите флажок **Connect via on-premises data gateway** (Подключение через локальный шлюз данных).

1. В разделе **шлюз** в списке **Подписка** выберите подписку Azure с нужным ресурсом шлюза.

   Ресурсы приложения логики и шлюза не должны существовать в одной подписке Azure. Вы можете выбрать другую подписку Azure, у каждой из которых есть ресурс шлюза, но только в том случае, если эти подписки существуют в том же клиенте или каталоге Azure AD, что и приложение логики, и у вас есть права администратора на шлюзе, который может быть настроен другим администратором. Дополнительные сведения см. в статье [Data Gateway: Автоматизация с помощью PowerShell. часть 1](https://community.powerbi.com/t5/Community-Blog/Data-Gateway-Automation-using-PowerShell-Part-1/ba-p/1117330) и [PowerShell: Data Gateway-Add-датагатевайклустерусер](/powershell/module/datagateway/add-datagatewayclusteruser).
  
1. В списке **шлюз подключения** , в котором показаны доступные ресурсы шлюза в выбранной подписке, выберите нужный ресурс шлюза. Каждый ресурс шлюза связан с установкой одного шлюза.

   > [!NOTE]
   > Список шлюзов включает ресурсы шлюза в других регионах, так как расположение приложения логики может отличаться от расположения ресурса шлюза. 

1. Укажите уникальное имя подключения и другие необходимые сведения, которые зависят от подключения, которое необходимо создать.

   Уникальное имя подключения позволяет легко найти это подключение позже, особенно при создании нескольких подключений. При необходимости добавьте также имя домена для вашего имени пользователя.

   Пример:

   ![Создание подключения между логическим приложением и шлюзом данных](./media/logic-apps-gateway-connection/logic-app-gateway-connection.png)

1. Когда все будет готово, выберите **Создать**.

Подключение шлюза теперь готово к использованию приложением логики.

## <a name="edit-connection"></a>Изменение подключения

Чтобы обновить параметры подключения шлюза, можно изменить подключение.

1. Чтобы найти все подключения API только для приложения логики, в меню приложения логики в разделе **средства разработки** выберите **подключения API**.

   ![В меню приложения логики выберите пункт "подключения API".](./media/logic-apps-gateway-connection/logic-app-api-connections.png)

1. Выберите нужное подключение шлюза, а затем щелкните **изменить подключение API**.

   > [!TIP]
   > Если обновления не вступят в силу, попробуйте [остановить и перезапустить учетную запись службы Windows шлюза](../logic-apps/logic-apps-gateway-install.md#restart-gateway) для установки шлюза.

Чтобы найти все подключения API, связанные с подпиской Azure, выполните следующие действия.

* В меню портал Azure выберите **все службы**  >  подключения к **веб-**  >  **API**.
* Либо в меню портал Azure выберите **все ресурсы**. Установите фильтр **типов** для **соединения API**.

<a name="change-delete-gateway-resource"></a>

## <a name="delete-gateway-resource"></a>Удаление ресурса шлюза

Чтобы создать другой ресурс шлюза, свяжите установку шлюза с другим ресурсом шлюза или удалите ресурс шлюза, вы можете удалить ресурс шлюза, не влияя на установку шлюза.

1. В меню портал Azure выберите **все ресурсы** или найдите и выберите **все ресурсы** на любой странице. Найдите и выберите ресурс шлюза данных.

1. Если он еще не выбран, в меню ресурсов шлюза выберите **Локальный шлюз данных**. На панели инструментов ресурса шлюза выберите **Удалить**.

   Пример:

   ![Удаление ресурса шлюза в Azure](./media/logic-apps-gateway-connection/delete-on-premises-data-gateway.png)

<a name="faq"></a>

## <a name="frequently-asked-questions"></a>Часто задаваемые вопросы

**Вопрос**. Почему Установка шлюза не отображается при создании ресурса шлюза в Azure? <br/>
**Ответ**. Такая ошибка может произойти по нескольким причинам.

* Учетная запись Azure не является учетной записью, используемой для установки шлюза на локальном компьютере. Убедитесь, что вы вошли в портал Azure с тем же идентификатором, который использовался для установки шлюза. Только администратор шлюза может создать ресурс шлюза в Azure. Субъекты-службы в настоящее время не поддерживаются.

* Ваша учетная запись Azure не принадлежит только одному [клиенту или каталогу Azure AD](../active-directory/fundamentals/active-directory-whatis.md#terminology). Убедитесь, что вы используете тот же клиент Azure AD или каталог, который использовался во время установки шлюза.

* Установка ресурса шлюза и шлюза не существует в одном регионе. Однако расположение приложения логики может отличаться от расположения ресурса шлюза.

* Установка шлюза уже связана с другим ресурсом шлюза. Каждый ресурс шлюза может ссылаться только на одну установку шлюза, которая может ссылаться только на одну учетную запись Azure и подписку. Поэтому нельзя выбрать установку шлюза, которая уже связана с другим ресурсом шлюза. Эти установки не будут отображаться в списке **имя установки** .

  Чтобы просмотреть регистрации шлюза в портал Azure, найдите все ресурсы Azure с типом ресурса " **локальный шлюз данных** " во *всех* подписках Azure. Сведения об удалении связи между установкой шлюза и другим ресурсом шлюза см. в разделе [Удаление ресурса шлюза](#change-delete-gateway-resource).

[!INCLUDE [existing-gateway-location-changed](../../includes/logic-apps-existing-gateway-location-changed.md)]

## <a name="next-steps"></a>Дальнейшие действия

* [Защита приложений логики](./logic-apps-securing-a-logic-app.md)
* [Распространенные примеры и сценарии использования приложений логики](./logic-apps-examples-and-scenarios.md)
