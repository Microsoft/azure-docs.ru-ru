---
title: Преобразование XML между форматами
description: Создание преобразований или сопоставлений, которые изменяют форматы данных XML в Azure Logic Apps с Пакетом интеграции Enterprise.
services: logic-apps
ms.suite: integration
author: divyaswarnkar
ms.author: divswa
ms.reviewer: jonfan, estfan, logicappspm
ms.topic: article
ms.date: 07/08/2016
ms.openlocfilehash: 038c1d4c0f0b5ffd7b9aabea2de32e3a44e3b221
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "97654138"
---
# <a name="create-maps-that-transform-xml-between-formats-in-azure-logic-apps-with-enterprise-integration-pack"></a>Создание преобразований или сопоставлений, которые изменяют форматы данных XML в Azure Logic Apps с Пакетом интеграции Enterprise

В интеграции Enterprise используются соединитель преобразования, который позволяет преобразовывать данные из одного формата в другой. Например, вы получили входящее сообщение, содержащее текущую дату в формате "ГодМесяцДень". Вы хотите преобразовать эту дату в формат "МесяцДеньГод" с помощью преобразования.

## <a name="what-does-a-transform-do"></a>Что делает преобразование?
Преобразование, или сопоставление, состоит из исходной схемы XML (входных данных) и целевой схемы XML (выходных данных). Вы можете использовать разные встроенные функции, помогающие работать с данными и управлять ими, включая действия со строками, условные назначения, арифметические выражения, модули форматирования даты и времени и даже циклические конструкции.

## <a name="how-to-create-a-transform"></a>Как создать преобразование?
Преобразование или карту можно создать с помощью [пакета SDK интеграции Enterprise](https://aka.ms/vsmapsandschemas)для Visual Studio. После создания и тестирования преобразования его можно передать в свою учетную запись интеграции. 

## <a name="how-to-use-a-transform"></a>Как использовать преобразование
После передачи преобразования или сопоставления в учетную запись интеграции их можно использовать для создания приложения логики. Приложение логики выполняет преобразование всякий раз, когда оно активируется (и существует входное содержимое, которое необходимо преобразовать).

**Ниже приведены указания по использованию преобразования**.

### <a name="prerequisites"></a>Предварительные условия

* Создание учетной записи интеграции и добавление карты в нее  

Теперь, когда предварительные требования выполнены, пора создать приложение логики.  

1. Создайте приложение логики и [свяжите его с учетной записью интеграции](./logic-apps-enterprise-integration-create-integration-account.md "Сведения о связывании учетной записи интеграции с приложением логики") , содержащей карту.
2. Добавление триггера **запроса** в приложение логики  
   ![Снимок экрана: раскрывающийся список "отображать управляемые API Майкрософт" с выбранным триггером запроса. Раскрывающийся список находится в приложении логики, созданном с помощью пакета SDK для интеграции Visual Studio Enterprise.](./media/logic-apps-enterprise-integration-transforms/transform-1.png)    
3. Добавьте действие **Преобразовать XML**, щелкнув **Добавить действие** .  
   ![Снимок экрана, показывающий кнопку "добавить действие", выбранную на экране триггера запроса.](./media/logic-apps-enterprise-integration-transforms/transform-2.png)   
4. Введите слово *transform* в поле поиска, чтобы отфильтровать все действия и оставить только то, которое необходимо использовать.  
   ![Снимок экрана, показывающий, как выполнить поиск действия преобразования XML в раскрывающемся списке "Показать управляемые API Майкрософт", чтобы его можно было добавить в триггер запроса.](./media/logic-apps-enterprise-integration-transforms/transform-3.png)  
5. Выберите действие **Преобразовать XML**.   
6. Добавьте **содержимое** XML, которое будет преобразовано. В качестве **содержимого** можно использовать любые данные XML, получаемые в HTTP-запросе. В этом примере выберите текст HTTP-запроса, активировавшего приложение логики.

   > [!NOTE]
   > Убедитесь, что содержимое для **преобразования XML** предоставлено в формате XML. Если содержимое предоставлено не в формате XML или в кодировке Base 64, необходимо указать выражение для обработки содержимого. Например, можно использовать [функции](logic-apps-workflow-definition-language.md#functions), такие как ```@base64ToBinary``` для декодирования содержимого или ```@xml``` для обработки содержимого в формате XML.
 

7. Выберите имя **карты** , которую вы хотите использовать для преобразования. Эта карта должна находиться в вашей учетной записи интеграции. На предыдущем шаге вы уже предоставили приложению логики доступ к своей учетной записи интеграции, содержащей карту.      
   ![Снимок экрана, показывающий поля содержимого и карт на экране преобразования XML для триггера запроса.](./media/logic-apps-enterprise-integration-transforms/transform-4.png) 
8. Сохраните результаты своих действий.  
    ![Снимок экрана, показывающий кнопку "Сохранить" в конструкторе Logic Apps.](./media/logic-apps-enterprise-integration-transforms/transform-5.png) 

На этом настройка карты завершена. В случае реального приложения может потребоваться сохранить преобразованные данные в бизнес-приложении, например Salesforce. Можно легко добавить действие для отправки выходных данных преобразования в Salesforce. 

Теперь можно проверить преобразование, выполнив запрос к конечной точке HTTP.  


## <a name="features-and-use-cases"></a>Функции и варианты использования
* Преобразование, создаваемое в сопоставлении, может быть простым, таким как копирование имени и адреса из одного документа в другой. Но вы также можете создавать и более сложные преобразования с помощью встроенных операций сопоставления.  
* Многие операции или функции сопоставления легко доступны, включая строки, функции даты-времени и пр.  
* Можно выполнять прямое копирование данных между схемами. В модуле сопоставления из пакета SDK сделать это так же просто, как нарисовать линию, соединяющую элементы в исходной схеме с соответствующими элементами в целевой схеме.  
* При создании сопоставления отображается его графическое представление, включая все созданные вами отношения и связи.
* Используйте функцию тестирования сопоставления, чтобы добавить пример XML-сообщения. Тогда одним щелчком вы сможете протестировать созданное сопоставление и увидеть полученный результат.  
* Передача существующих карт  
* Включена поддержка формата XML.

## <a name="advanced-features"></a>Дополнительные функции

### <a name="reference-assembly-or-custom-code-from-maps"></a>Базовая сборка или настраиваемый код из карт 
Действие преобразования также поддерживает карты или преобразования со ссылкой на внешнюю сборку. Эта возможность позволяет вызывать настраиваемый код .NET непосредственно из карт XSLT. Ниже приведены предварительные требования для использования сборки в картах.

* Карту и сборку, на которую добавлена ссылка в карте, необходимо [передать в учетную запись интеграции](./logic-apps-enterprise-integration-maps.md). 

  > [!NOTE]
  > Карту и сборку необходимо передавать в определенном порядке. Сначала нужно передать сборку, а затем — карту со ссылкой на сборку.

* Кроме того, в карте должны быть следующие атрибуты и раздел CDATA с вызовом кода сборки:

    * **name** — имя настраиваемой сборки;
    * **namespace** — пространство имен в сборке, где содержится настраиваемый код.

  В этом примере показана карта, в которую добавлена ссылка на сборку с именем XslUtilitiesLib. В карте выполняется вызов метода `circumreference` из сборки.

  ```xml
  <?xml version="1.0" encoding="UTF-8"?>
  <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:user="urn:my-scripts">
  <msxsl:script language="C#" implements-prefix="user">
    <msxsl:assembly name="XsltHelperLib"/>
    <msxsl:using namespace="XsltHelpers"/>
    <![CDATA[public double circumference(int radius){ XsltHelper helper = new XsltHelper(); return helper.circumference(radius); }]]>
  </msxsl:script>
  <xsl:template match="data">
   <circles>
    <xsl:for-each select="circle">
      <circle>
        <xsl:copy-of select="node()"/>
          <circumference>
            <xsl:value-of select="user:circumference(radius)"/>
          </circumference>
      </circle>
    </xsl:for-each>
   </circles>
  </xsl:template>
    </xsl:stylesheet>
  ```


### <a name="byte-order-mark"></a>Метка порядка байтов
По умолчанию ответ при преобразовании начинается с метки порядка байтов. Эта функция доступна только при работе в редакторе представления кода. Чтобы отключить эту функцию, укажите `disableByteOrderMark` для свойства `transformOptions`:

```json
"Transform_XML": {
    "inputs": {
        "content": "@{triggerBody()}",
        "integrationAccount": {
            "map": {
                "name": "TestMap"
            }
        },
        "transformOptions": "disableByteOrderMark"
    },
    "runAfter": {},
    "type": "Xslt"
}
```





## <a name="learn-more"></a>Дополнительные сведения
* [Дополнительные сведения о Пакете интеграции Enterprise](../logic-apps/logic-apps-enterprise-integration-overview.md "Дополнительные сведения о Пакет интеграции Enterprise")  
* [Дополнительные сведения о сопоставлениях](../logic-apps/logic-apps-enterprise-integration-maps.md "Сведения о картах интеграции Enterprise")  