---
title: Создание рабочих процессов Logic Apps Preview в портал Azure
description: Создавайте и запускайте рабочие процессы для сценариев автоматизации и интеграции с помощью предварительной версии Azure Logic Apps в портал Azure.
services: logic-apps
ms.suite: integration
ms.reviewer: estfan, logicappspm, az-logic-apps-dev
ms.topic: conceptual
ms.date: 12/07/2020
ms.openlocfilehash: a7e19894a4688fe270422e93f7081f98e0b699a3
ms.sourcegitcommit: 2aa52d30e7b733616d6d92633436e499fbe8b069
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "97936538"
---
# <a name="create-stateful-and-stateless-workflows-in-the-azure-portal-with-azure-logic-apps-preview"></a>Создание рабочих процессов с отслеживанием состояния и без отслеживания состояния в портал Azure с предварительной версией Azure Logic Apps

> [!IMPORTANT]
> Эта возможность предоставляется в общедоступной предварительной версии без соглашения об уровне обслуживания. Не рекомендуем использовать ее в рабочей среде. Некоторые функции могут не поддерживаться или их возможности могут быть ограничены. Дополнительные сведения см. в статье [Дополнительные условия использования предварительных выпусков Microsoft Azure](https://azure.microsoft.com/support/legal/preview-supplemental-terms/).

[Предварительная версия Azure Logic Apps](logic-apps-overview-preview.md)позволяет создавать решения для автоматизации и интеграции в приложениях, данных, облачных службах и системах, создавая и запуская приложения логики, которые включают [рабочие процессы с *отслеживанием состояния* и *без отслеживания состояния*](logic-apps-overview-preview.md#stateful-stateless) в портал Azure, начиная с нового типа ресурсов **приложения логики (Предварительная версия)** . С помощью этого нового типа приложения логики можно создать несколько рабочих процессов, работающих на основе переработанной среды выполнения предварительной версии Azure Logic Apps, которая обеспечивает переносимость, лучшую производительность и гибкость при развертывании и запуске в различных средах размещения, а не только в Azure, но и в контейнерах DOCKER. Дополнительные сведения о новом типе приложения логики см. в разделе [обзор Azure Logic Apps предварительной версии](logic-apps-overview-preview.md).

![Снимок экрана, на котором показано портал Azure в конструкторе рабочих процессов для ресурса "приложение логики (Предварительная версия)".](./media/create-stateful-stateless-workflows-azure-portal/azure-portal-logic-apps-overview.png)

В портал Azure можно начать с создания нового ресурса **приложения логики (Предварительная версия)** . Хотя вы также можете начать с [создания проекта в Visual Studio Code с расширением Azure Logic Apps (Предварительная версия)](create-stateful-stateless-workflows-visual-studio-code.md), оба подхода предоставляют возможность развертывания и запуска приложения логики в тех же видах сред размещения.

В то же время можно создать исходный тип приложения логики. Хотя возможности разработки на портале отличаются от исходных и новых типов приложений логики, ваша подписка Azure может включать оба типа. Вы можете просматривать все развернутые приложения логики в подписке Azure и получать к ним доступ, но приложения организованы в собственные категории и разделы.

В этой статье показано, как создать приложение логики и рабочий процесс в портал Azure с помощью типа ресурсов **приложения логики (Предварительная версия)** и выполнения этих высокоуровневые задачи:

* Создайте новый ресурс приложения логики и добавьте пустой рабочий процесс.

* Добавьте триггер и действие.

* Запускает рабочий процесс.

* Просмотр журнала выполнения рабочего процесса.

* Включите или откройте Application Insights после развертывания.

* Включите журнал выполнения для рабочих процессов без отслеживания состояния.

> [!NOTE]
> Сведения о текущих известных проблемах см. на [странице Logic Apps общедоступная Предварительная версия известных проблем в GitHub](https://github.com/Azure/logicapps/blob/master/articles/logic-apps-public-preview-known-issues.md).

## <a name="prerequisites"></a>Предварительные требования

* Учетная запись и подписка Azure. Если у вас нет ее, вы можете [зарегистрироваться для получения бесплатной учетной записи Azure](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).

* [Учетная запись хранения Azure](../storage/common/storage-account-overview.md) , так как ресурс **приложения логики (Предварительная версия)** включен в функции Azure и имеет [требования к хранению, аналогичные приложениям-функциям](../azure-functions/storage-considerations.md). Можно использовать существующую учетную запись хранения или создать учетную запись хранения заранее или во время создания приложения логики.

  > [!NOTE]
  > [Приложения логики с отслеживанием состояния](logic-apps-overview-preview.md#stateful-stateless) выполняют транзакции хранилища, такие как использование очередей для планирования и хранения состояний рабочих процессов в таблицах и больших двоичных объектах. Эти транзакции поставляются с [оплатой за хранилище Azure](https://azure.microsoft.com/pricing/details/storage/). Дополнительные сведения о том, как приложения логики с отслеживанием состояния хранят данные во внешнем хранилище, см. в статье [Отслеживание состояния и без отслеживания состояния](logic-apps-overview-preview.md#stateful-stateless).

* Чтобы создать тот же пример приложения логики в этой статье, вам потребуется учетная запись электронной почты Office 365 Outlook, которая использует рабочую или учебную учетную запись Майкрософт для входа.

  Если вы решили использовать другой [соединитель электронной почты, поддерживаемый Azure Logic Apps](/connectors/), например Outlook.com или [Gmail](../connectors/connectors-google-data-security-privacy-policy.md), вы по-прежнему можете следовать этому примеру, и общие действия одинаковы, но пользовательский интерфейс и параметры могут отличаться. Например, если вы используете соединитель Outlook.com, используйте личную учетная запись Майкрософт вместо входа.

* Чтобы протестировать пример приложения логики, созданного в этой статье, необходимо средство, которое может отправить вызовы триггера запроса, что является первым шагом в примере приложения логики. Если у вас нет такого средства, вы можете скачать, установить и использовать [POST](https://www.postman.com/downloads/).

* При создании приложения логики с параметрами, поддерживающими использование [Application Insights](../azure-monitor/app/app-insights-overview.md), при необходимости можно включить ведение журнала диагностики и трассировку для приложения логики. Это можно сделать либо при создании приложения логики, либо после развертывания. Необходимо иметь Application Insights экземпляр, но этот ресурс можно создать [заранее](../azure-monitor/app/create-workspace-resource.md), при создании приложения логики или после развертывания.

## <a name="create-the-logic-app-resource"></a>Создание ресурса приложения логики

1. Войдите на [портал Azure](https://portal.azure.com) с помощью учетных данных учетной записи Azure.

1. В поле поиска портал Azure введите `logic app preview` и выберите **приложение логики (Предварительная версия)**.

   ![Снимок экрана, на котором показано поле поиска портал Azure с выбранным термином "Предварительная версия приложения логики" и выбранного ресурса "приложение логики (Предварительная версия)".](./media/create-stateful-stateless-workflows-azure-portal/find-logic-app-resource-template.png)

1. На странице **приложение логики (Предварительная версия)** выберите **Добавить**.

1. На странице **Создание приложения логики (Предварительная версия)** на вкладке **основы** укажите эти сведения о приложении логики.

   | Свойство | Обязательно | Значение | Описание |
   |----------|----------|-------|-------------|
   | **Подписка** | Да | <*Azure-subscription-name*> | Подписка Azure, которая будет использоваться для приложения логики. |
   | **Группа ресурсов** | Да | <*имя_группы_ресурсов_Azure*> | Группа ресурсов Azure, в которой вы создадите приложение логики и связанные ресурсы. Это имя ресурса должно быть уникальным в разных регионах и может содержать только буквы, цифры, дефисы ( **-** ), символы подчеркивания (**_**), круглые скобки (**()**) и точки (**.**). <p><p>В этом примере создается группа ресурсов с именем `Fabrikam-Workflows-RG` . |
   | **Имя приложения логики** | Да | <*logic-app-name*> | Имя, используемое для приложения логики. Это имя ресурса должно быть уникальным в разных регионах и может содержать только буквы, цифры, дефисы ( **-** ), символы подчеркивания (**_**), круглые скобки (**()**) и точки (**.**). <p><p>В этом примере создается приложение логики с именем `Fabrikam-Workflows` . <p><p>**Примечание**. имя приложения логики автоматически получает суффикс, `.azurewebsites.net` так как ресурс **приложения логики (Предварительная версия)** работает на базе функций Azure, использующих то же соглашение об именовании приложений. |
   | **Опубликовать** | Да | <*Развертывание — среда*> | Назначение развертывания для приложения логики. Вы можете развернуть в Azure, выбрав **Рабочий процесс** или контейнер DOCKER. <p><p>В этом примере используется **Рабочий процесс**, который является ресурсом **приложения логики (Предварительная версия)** в Azure. <p><p>При выборе **контейнера DOCKER** [укажите контейнер для использования в параметрах приложения логики](#set-docker-container). |
   | **Регион** | Да | <*Azure-region*> | Регион Azure, используемый при создании группы ресурсов и ресурсов. <p><p>В этом примере используется регион **западная часть США**. |
   |||||

   Приведем пример:

   ![Снимок экрана, на котором показаны портал Azure и страница "Создание приложения логики (Предварительная версия)".](./media/create-stateful-stateless-workflows-azure-portal/create-logic-app-resource-portal.png)

1. Затем на вкладке **Размещение** укажите сведения о решении хранилища и плане размещения, который будет использоваться для приложения логики.

   | Свойство | Обязательно | Значение | Описание |
   |----------|----------|-------|-------------|
   | **Учетная запись хранения** | Да | <*Azure-storage-account-name*> | [Учетная запись хранения Azure](../storage/common/storage-account-overview.md) , используемая для транзакций хранилища. Имя этого ресурса должно быть уникальным в разных регионах и содержать 3-24 символов только с цифрами и строчными буквами. Выберите существующую учетную запись или создайте новую. <p><p>В этом примере создается учетная запись хранения с именем `fabrikamstorageacct` . |
   | **Тип плана** | Да | <*План размещения Azure*> | [План размещения](../app-service/overview-hosting-plans.md) , используемый для развертывания приложения логики ( [**Premium**](../azure-functions/functions-premium-plan.md) или [**план службы приложений**](../azure-functions/dedicated-plan.md)). Ваш выбор влияет на ценовые категории, которые можно выбрать позже. <p><p>В этом примере используется **план службы приложений**. <p><p>**Примечание**. как и в случае с функциями Azure, для типа ресурсов **приложения логики (Предварительная версия)** требуется план размещения и ценовая категория. Планы по размещению потребления не поддерживаются и не доступны для этого типа ресурсов. Дополнительные сведения см. в следующих разделах: <p><p>- [Масштабирование и размещение функций Azure](../azure-functions/functions-scale.md) <br>- [Сведения о ценах на службу приложений](https://azure.microsoft.com/pricing/details/app-service/) <p><p> |
   | **План Windows** | Да | <*имя плана*> | Имя используемого плана. Выберите существующий план или укажите имя для нового плана. <p><p>В этом примере используется имя `Fabrikam-Service-Plan`. |
   | **SKU и размер** | Да | <*Ценовая категория*> | [Ценовая](../app-service/overview-hosting-plans.md) Категория, используемая для размещения приложения логики. На ваши варианты влияет выбранный ранее тип плана. Чтобы изменить уровень по умолчанию, выберите **изменить размер**. Затем можно выбрать другие ценовые категории в зависимости от необходимой рабочей нагрузки. <p><p>В этом примере используется бесплатная **ценовая категория F1** для рабочих нагрузок **разработки и тестирования** . Дополнительные сведения см. в [сведениях о ценах на службу приложений](https://azure.microsoft.com/pricing/details/app-service/). |
   |||||

1. Затем, если параметры создания и развертывания поддерживают использование [Application Insights](../azure-monitor/app/app-insights-overview.md), при необходимости можно включить ведение журнала диагностики и трассировку для приложения логики.

   1. На вкладке **мониторинг** в разделе **Application Insights** задайте для параметра **включить Application Insights** значение **Да** , если он еще не выбран.

   1. Для параметра **Application Insights** выберите существующий экземпляр Application Insights или, если нужно создать новый экземпляр, выберите **создать** и укажите имя, которое нужно использовать.

1. После того как Azure проверит параметры приложения логики, на вкладке " **Проверка и создание** " выберите **создать**.

   Пример:

   ![Снимок экрана, на котором показаны портал Azure и новые параметры ресурсов приложения логики.](./media/create-stateful-stateless-workflows-azure-portal/check-logic-app-resource-settings.png)

   После завершения развертывания Azure приложение логики автоматически становится активным и запущенным, но не делает ничего, так как рабочие процессы не существуют.

1. На странице Завершение развертывания выберите **Перейти к ресурсу** , чтобы начать создание рабочего процесса.

   ![Снимок экрана, на котором показаны портал Azure и завершенное развертывание.](./media/create-stateful-stateless-workflows-azure-portal/logic-app-completed-deployment.png)

<a name="set-docker-container"></a>

## <a name="specify-docker-container-for-deployment"></a>Указание контейнера DOCKER для развертывания

Если вы выбрали **контейнер DOCKER** при создании приложения логики, убедитесь, что вы предоставляете сведения о контейнере, который вы хотите использовать для развертывания, после того, как портал Azure создаст ресурс **приложения логики (Предварительная версия)** .

1. В портал Azure перейдите к ресурсу приложения логики.

1. В меню приложения логики в разделе **Параметры** выберите **Параметры контейнера**. Укажите сведения и расположение для образа контейнера DOCKER.

   ![Снимок экрана, на котором показано меню приложения логики с выбранным параметром "Параметры контейнера".](./media/create-stateful-stateless-workflows-azure-portal/logic-app-deploy-container-settings.png)

1. По завершении сохраните параметры.

<a name="add-workflow"></a>

## <a name="add-a-blank-workflow"></a>Добавление пустого рабочего процесса

1. После того как Azure откроет ресурс, в меню приложения логики выберите **рабочие процессы**. На панели задач **рабочие процессы** выберите **Добавить**.

   ![Снимок экрана, на котором показано меню ресурсов приложения логики с выбранным параметром "рабочие процессы", а затем на панели инструментов будет выбрано "Добавить".](./media/create-stateful-stateless-workflows-azure-portal/logic-app-add-blank-workflow.png)

1. После открытия панели **Рабочий процесс** укажите имя рабочего процесса и выберите тип рабочего процесса с [ **отслеживанием состояния** или **без отслеживания состояния**](logic-apps-overview-preview.md#stateful-stateless) . Когда все будет готово, выберите **Создать**.

   В этом примере добавляется пустой рабочий процесс с отслеживанием состояния с именем `Fabrikam-Stateful-Workflow` . По умолчанию рабочий процесс включен, но не выполняет никаких действий до тех пор, пока не будет добавлен триггер и действия.

   ![Снимок экрана, показывающий добавленный пустой рабочий процесс с отслеживанием состояния "Fabrikam-State с отслеживанием рабочего процесса".](./media/create-stateful-stateless-workflows-azure-portal/logic-app-blank-workflow-created.png)

1. Затем откройте пустой рабочий процесс в конструкторе, чтобы можно было добавить триггер и действие.

   1. В списке Рабочий процесс выберите пустой рабочий процесс.

   1. В меню Рабочий процесс в разделе **разработчик** выберите **конструктор**.

      В области конструктора окно **Выбор операции** уже отображается и выбирается по умолчанию, чтобы панель **добавить триггер** также была открыта.

      ![Снимок экрана, на котором показан открытый конструктор рабочих процессов с выбранным параметром "выбрать операцию" в области конструктора.](./media/create-stateful-stateless-workflows-azure-portal/opened-logic-app-designer-blank-workflow.png)

<a name="add-trigger-actions"></a>

## <a name="add-a-trigger-and-an-action"></a>Добавление триггера и действия

В этом примере создается рабочий процесс, который выполняет следующие действия:

* Встроенный [триггер запроса](../connectors/connectors-native-reqres.md) **при получении HTTP-запроса**, который получает входящие вызовы или запросы и создает конечную точку, которую могут вызывать другие службы или приложения логики.

* [Office 365 Outlook](../connectors/connectors-create-api-office365-outlook.md)— **Отправка сообщения электронной почты**.

* Встроенное [действие ответа](../connectors/connectors-native-reqres.md), которое используется для отправки ответа и возврата данных обратно вызывающему объекту.

### <a name="add-the-request-trigger"></a>Добавление триггера "Запрос"

Перед добавлением триггера в пустой рабочий процесс убедитесь в том, что конструктор рабочих процессов открыт и что на поверхности конструктора выбран запрос **Выбор операции** .

1. Рядом с областью конструктора в области **добавить триггер** в поле поиска **Выбор операции** убедитесь, что выбрана **Встроенная** вкладка. На этой вкладке отображаются триггеры, которые изначально выполняются в Azure Logic Apps.

1. В поле поиска **Выбор операции** введите `when a http request` и выберите Встроенный триггер запроса, названный **при получении HTTP-запроса**.

   ![Снимок экрана, на котором показан конструктор и * * Добавление области триггера * * с выбранным триггером "при получении HTTP-запроса".](./media/create-stateful-stateless-workflows-azure-portal/find-request-trigger.png)

   Когда триггер появляется в конструкторе, открывается область сведений триггера, в которой отображаются свойства, параметры и другие действия триггера.

   ![Снимок экрана, на котором показан конструктор с выбранным триггером "при получении HTTP-запроса" и открытие области сведений о триггере.](./media/create-stateful-stateless-workflows-azure-portal/request-trigger-added-to-designer.png)

   > [!TIP]
   > Если область сведений не отображается, проверяет, выбран ли триггер в конструкторе.

1. Если необходимо удалить элемент из конструктора, [выполните следующие действия для удаления элементов из конструктора](#delete-from-designer).

1. Чтобы сохранить работу, на панели инструментов конструктора нажмите кнопку **сохранить**.

   При первом сохранении рабочего процесса и запуске этого рабочего процесса с помощью триггера запроса служба Logic Apps автоматически создает URL-адрес для конечной точки, созданной триггером запроса. Позднее при тестировании рабочего процесса вы отправляете запрос на этот URL-адрес, который запускает триггер и запускает рабочий процесс.

### <a name="add-the-office-365-outlook-action"></a>Добавление действия Office 365 Outlook

1. В конструкторе в разделе добавленный триггер выберите **новый шаг**.

   В конструкторе появится запрос **Выбор операции** , после чего откроется область **Добавить панель действий** , чтобы можно было выбрать следующее действие.

   > [!NOTE]
   > Если в области **Добавить действие** отображается сообщение об ошибке "не удается прочитать свойство" фильтр "неопределенного", сохраните рабочий процесс, перезагрузите страницу, снова откройте рабочий процесс и повторите попытку.

1. В области **Добавление действия** в поле Поиск **операции** выберите **Azure**. На этой вкладке показаны управляемые соединители, доступные и развернутые в Azure.

   > [!NOTE]
   > Если в области **Добавить действие** отображается сообщение об ошибке, `The access token expiry UTC time '{token-expiration-date-time}' is earlier than current UTC time '{current-date-time}'` Сохраните рабочий процесс, перезагрузите страницу, снова откройте рабочий процесс и попробуйте добавить действие еще раз.

   В этом примере используется действие Office 365 Outlook с именем **Send a email (v2)**.

   ![Снимок экрана, на котором показан конструктор и "* * Добавление действия * *" с выбранным действием Outlook "отправить электронное письмо" для Office 365.](./media/create-stateful-stateless-workflows-azure-portal/find-send-email-action.png)

1. В области Подробности действия на вкладке **Создание подключения** выберите **Вход** , чтобы создать подключение к учетной записи электронной почты.

   ![Снимок экрана, на котором показан конструктор и область сведений "Отправка сообщения электронной почты (v2)" с выбранным параметром "вход".](./media/create-stateful-stateless-workflows-azure-portal/send-email-action-sign-in.png)

1. Когда появится запрос на согласие на доступ к учетной записи электронной почты, выполните вход с использованием учетных данных своей учетной записи.

   > [!NOTE]
   > Если появляется сообщение об ошибке, `Failed with error: 'The browser is closed.'. Please sign in again` Проверьте, блокирует ли браузер сторонние файлы cookie. Если эти файлы cookie заблокированы, попробуйте добавить их `https://portal.azure.com` в список сайтов, которые могут использовать файлы cookie. Если вы используете режим режиме инкогнито, убедитесь, что сторонние файлы cookie не блокируются при работе в этом режиме.
   > 
   > При необходимости перезагрузите страницу, откройте рабочий процесс, снова добавьте действие электронной почты и попытайтесь создать подключение.

   После того как Azure создаст подключение, в конструкторе появится действие **Отправить сообщение электронной почты** , которое будет выбрано по умолчанию. Если действие не выбрано, выберите действие, чтобы также открыть его область сведений.

1. В области Подробности действия на вкладке **Параметры** укажите необходимые сведения для действия, например:

   ![Снимок экрана, на котором показан конструктор и область сведений "Отправка сообщения электронной почты" с выбранной вкладкой "Параметры".](./media/create-stateful-stateless-workflows-azure-portal/send-email-action-details.png)

   | Свойство | Обязательно | Значение | Описание |
   |----------|----------|-------|-------------|
   | **Чтобы** | Да | <*ваш адрес электронной почты*> | Получатель электронной почты, который может быть адресом электронной почты для целей тестирования. В этом примере используется фиктивное сообщение электронной почты `sophiaowen@fabrikam.com` . |
   | **Тема** | Да | `An email from your example workflow` | тему сообщения; |
   | **Текст** | Да | `Hello from your example workflow!` | Содержимое сообщения электронной почты |
   ||||

   > [!NOTE]
   > При внесении изменений в области сведений на вкладке **Параметры**, **статический результат** или **выполнить после** вкладок убедитесь, что выбран параметр **Готово** к фиксации этих изменений перед переключением вкладок или изменением фокуса на конструктор. В противном случае изменения в конструкторе не сохраняются.

1. Сохраните результаты своих действий. На панели инструментов конструктора щелкните **Сохранить**.

Далее, чтобы протестировать рабочий процесс, запустите запуск вручную.

## <a name="trigger-the-workflow"></a>Активация рабочего процесса

В этом примере рабочий процесс выполняется, когда триггер запроса получает входящий запрос, который отправляется на URL-адрес конечной точки, созданной триггером. При первом сохранении рабочего процесса служба Logic Apps автоматически создала этот URL-адрес. Поэтому, прежде чем отправить запрос на запуск рабочего процесса, необходимо найти этот URL-адрес.

1. В конструкторе рабочих процессов выберите триггер запроса с именем **при получении HTTP-запроса**.

1. После открытия области сведений на вкладке **Параметры** найдите свойство **HTTP POST URL** . Чтобы скопировать созданный URL-адрес, выберите **URL-адрес копирования** (значок копирования файла) и сохраните URL-адрес в другое место. URL-адрес имеет следующий формат:

   `http://<logic-app-name>.azurewebsites.net:443/api/<workflow-name>/triggers/manual/invoke?api-version=2020-05-01-preview&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=<shared-access-signature>`

   ![Снимок экрана, на котором показан конструктор с триггером запроса и URL-адресом конечной точки в свойстве "HTTP POST URL".](./media/create-stateful-stateless-workflows-azure-portal/find-request-trigger-url.png)

   В этом примере URL-адрес выглядит следующим образом:

   `https://fabrikam-workflows.azurewebsites.net:443/api/Fabrikam-Stateful-Workflow/triggers/manual/invoke?api-version=2020-05-01-preview&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=xxxxxXXXXxxxxxXXXXxxxXXXXxxxxXXXX`

   > [!TIP]
   > URL-адрес конечной точки можно также найти в панели **Обзор** приложения логики в свойстве **URL-адрес рабочего процесса** .
   >
   > 1. В меню ресурс выберите **Обзор**.
   > 1. В области **Обзор** найдите свойство **URL-адрес рабочего процесса** .
   > 1. Чтобы скопировать URL-адрес конечной точки, наведите указатель мыши на конец текста URL-адреса конечной точки и выберите **Копировать в буфер обмена** (значок копирования файла).

1. Чтобы проверить URL-адрес, отправив запрос, откройте [сообщение POST](https://www.postman.com/downloads/) или предпочтительное средство для создания и отправки запросов.

   Этот пример можно продолжить с помощью процедуры POST. Дополнительные сведения см. в разделе [posting начало работы](https://learning.postman.com/docs/getting-started/introduction/).

   1. На панели инструментов после выберите **создать**.

      ![Снимок экрана, на котором показана публикация после нажатия кнопки "создать"](./media/create-stateful-stateless-workflows-azure-portal/postman-create-request.png)

   1. В области **создать новую** в разделе **стандартные блоки** выберите **запрос**.

   1. В окне **запрос на сохранение** в разделе **имя запроса** введите имя запроса, например `Test workflow trigger` .

   1. В разделе **выберите коллекцию или папку для сохранения** выберите **создать коллекцию**.

   1. В разделе **все коллекции** укажите имя коллекции, которую нужно создать для упорядочения запросов, нажмите клавишу ВВОД и выберите **сохранить в <*коллекция-имя* >**. В этом примере `Logic Apps requests` в качестве имени коллекции используется.

      Откроется панель запроса публикации, чтобы можно было отправить запрос на URL-адрес конечной точки для триггера запроса.

      ![Снимок экрана, показывающий сообщение POST с открытой панелью запросов](./media/create-stateful-stateless-workflows-azure-portal/postman-request-pane.png)

   1. На панели запрос в поле адрес рядом со списком метод, в котором в данный **момент отображается метод** запроса по умолчанию, вставьте скопированный ранее URL-адрес и нажмите кнопку **Отправить**.

      ![Снимок экрана, показывающий POST и URL-адрес конечной точки в поле адреса с выбранной кнопкой "Отправить"](./media/create-stateful-stateless-workflows-azure-portal/postman-test-endpoint-url.png)

      При срабатывании триггера пример рабочего процесса запускается и отправляет сообщение электронной почты, похожее на следующий пример:

      ![Снимок экрана, показывающий электронную почту Outlook, как описано в примере](./media/create-stateful-stateless-workflows-azure-portal/workflow-app-result-email.png)

## <a name="review-run-history"></a>Просмотр журнала выполнения

Для рабочего процесса с отслеживанием состояния после выполнения каждого рабочего процесса можно просмотреть журнал выполнения, включая состояние общего запуска, для триггера и для каждого действия вместе с входными и выходными данными.

1. В портал Azure в меню рабочего процесса выберите **мониторинг**.

   На панели " **монитор** " отображается журнал выполнения для этого рабочего процесса.

   ![Снимок экрана, показывающий панель "монитор" и журнал выполнения рабочего процесса.](./media/create-stateful-stateless-workflows-azure-portal/find-run-history.png)

   > [!TIP]
   > Если Последнее состояние выполнения не отображается, нажмите кнопку **Обновить** на панели инструментов панели **монитор** . Запуск не выполняется для триггера, который пропущен из-за условий неудовлетворенных или не удается найти данные.

   | Состояние выполнения | Описание |
   |------------|-------------|
   | **Прерывание** | Выполнение остановлено или не завершено из-за внешних проблем, например сбоя системы или подписки Azure. |
   | **Клонения** | Запуск был активирован и запущен, но получен запрос на отмену. |
   | **Сбой** | Не удалось выполнить по крайней мере одно действие в ходе выполнения. Последующие действия в рабочем процессе не были настроены для обработки сбоя. |
   | **Выполнение** | Запуск был запущен и выполняется, но это состояние также может отображаться для запуска, который регулируется из-за [ограничений действия](logic-apps-limits-and-config.md) или [текущего тарифного плана](https://azure.microsoft.com/pricing/details/logic-apps/). <p><p>**Совет**. Если вы настроили [ведение журнала диагностики](monitor-logic-apps-log-analytics.md), можно получить сведения о любых происходящих событиях регулирования. |
   | **Успешно** | Запуск выполнен. Если какое-либо действие завершилось сбоем, последующее действие в рабочем процессе обработало этот сбой. |
   | **Истекло время ожидания** | Время выполнения истекло, так как текущая длительность превысила ограничение продолжительности выполнения, которое управляется [параметром **срок хранения журнала выполнения в днях**](logic-apps-limits-and-config.md#run-duration-retention-limits). Длительность выполнения вычисляется с использованием времени начала и длительности выполнения в это время начала. <p><p>**Примечание**. Если длительность выполнения также превышает текущий *Размер журнала выполнения*, который также управляется [параметром **срок хранения журнала выполнения в днях**](logic-apps-limits-and-config.md#run-duration-retention-limits), запуск удаляется из журнала запусков заданием ежедневной очистки. Независимо от того, завершилось ли время ожидания выполнения или завершено, срок хранения всегда вычисляется с использованием времени начала выполнения и *текущего* предела удержания. Таким образом, при уменьшении предельной продолжительности выполняемого запуска время ожидания истекает. Однако выполнение либо остается, либо удаляется из журнала запусков в зависимости от того, превышает ли длительность выполнения предел удержания. |
   | **Ожидание** | Выполнение не началось или приостановлено, например, из-за более раннего экземпляра рабочего процесса, который еще работает. |
   |||

1. Чтобы проверить состояние каждого этапа выполнения, выберите Запуск, который необходимо проверить.

   Откроется представление сведения о запуске, в котором отображается состояние каждого шага в запуске.

   ![Снимок экрана, на котором показано представление сведений о запуске с состоянием каждого шага в рабочем процессе.](./media/create-stateful-stateless-workflows-azure-portal/review-run-details.png)

   Ниже приведены возможные состояния, которые могут иметь каждый шаг в рабочем процессе.

   | Состояние действия | Значок | Описание |
   |---------------|------|-------------|
   | Прерывание | ![Значок состояния действия "прервано"][aborted-icon] | Действие остановлено или не завершено из-за внешних проблем, например сбоя системы или подписки Azure. |
   | Отменено | ![Значок состояния действия "отменено"][cancelled-icon] | Действие было запущено, но получило запрос на отмену. |
   | Сбой | ![Значок состояния действия "сбой"][failed-icon] | Не удалось выполнить действие. |
   | Запущен | ![Значок состояния выполняемого действия][running-icon] | Действие выполняется в данный момент. |
   | Пропущено | ![Значок состояния действия "пропущено"][skipped-icon] | Действие было пропущено, так как предыдущее действие завершилось с ошибкой. Действие имеет `runAfter` условие, которое требует, чтобы предыдущее действие было успешно завершено перед выполнением текущего действия. |
   | Выполнено | ![Значок состояния действия "выполнен"][succeeded-icon] | Действие было выполнено. |
   | Выполнен с повторными попытками | ![Значок состояния действия "выполнен с повторными попытками"][succeeded-with-retries-icon] | Действие было завершено, но только после одной или нескольких повторных попыток. Чтобы просмотреть журнал повторных попыток, в представлении сведения о журнале выполнения выберите это действие, чтобы можно было просмотреть входные и выходные данные. |
   | Истекло время ожидания | ![Значок состояния действия "истекло время ожидания"][timed-out-icon] | Действие остановлено из-за предельного времени ожидания, указанного в параметрах этого действия. |
   | Ожидание | ![Значок состояния "ожидание" действия][waiting-icon] | Применяется к действию веб-перехватчика, ожидающему входящего запроса от вызывающего. |
   ||||

   [aborted-icon]: ./media/create-stateful-stateless-workflows-azure-portal/aborted.png
   [cancelled-icon]: ./media/create-stateful-stateless-workflows-azure-portal/cancelled.png
   [failed-icon]: ./media/create-stateful-stateless-workflows-azure-portal/failed.png
   [running-icon]: ./media/create-stateful-stateless-workflows-azure-portal/running.png
   [skipped-icon]: ./media/create-stateful-stateless-workflows-azure-portal/skipped.png
   [succeeded-icon]: ./media/create-stateful-stateless-workflows-azure-portal/succeeded.png
   [succeeded-with-retries-icon]: ./media/create-stateful-stateless-workflows-azure-portal/succeeded-with-retries.png
   [timed-out-icon]: ./media/create-stateful-stateless-workflows-azure-portal/timed-out.png
   [waiting-icon]: ./media/create-stateful-stateless-workflows-azure-portal/waiting.png

1. Чтобы проверить входные и выходные данные для определенного шага, выберите этот шаг.

   ![Снимок экрана, на котором показаны входные и выходные данные в выбранном действии "отправить сообщение электронной почты".](./media/create-stateful-stateless-workflows-azure-portal/review-step-inputs-outputs.png)

1. Для дальнейшей проверки входных и выходных данных этого шага выберите параметр **Показывать необработанные входные** данные или **отобразить необработанные выходные данные**.

<a name="enable-open-application-insights"></a>

## <a name="enable-or-open-application-insights-after-deployment"></a>Включение или открытие Application Insights после развертывания

Во время выполнения рабочего процесса приложение логики выдает данные телеметрии вместе с другими событиями. Эту телеметрию можно использовать для получения более четкого представления о том, насколько хорошо работает рабочий процесс, а также о том, как среда выполнения Logic Apps работает различными способами. Вы можете отслеживать рабочий процесс с помощью [Application Insights](../azure-monitor/app/app-insights-overview.md), который предоставляет данные телеметрии практически в реальном времени (динамические метрики). Эта возможность упрощает исследование сбоев и проблем с производительностью при использовании этих данных для диагностики проблем, настройки оповещений и построения диаграмм.

Если параметры создания и развертывания приложения логики поддерживают использование [Application Insights](../azure-monitor/app/app-insights-overview.md), при необходимости можно включить ведение журнала диагностики и трассировку для приложения логики. Это можно сделать либо при создании приложения логики в портал Azure, либо после развертывания. Необходимо иметь Application Insights экземпляр, но этот ресурс можно создать [заранее](../azure-monitor/app/create-workspace-resource.md), при создании приложения логики или после развертывания.

Чтобы включить Application Insights в развернутом приложении логики или открыть панель мониторинга Application Insights если она уже включена, выполните следующие действия.

1. В портал Azure найдите развернутое приложение логики.

1. В меню приложения логики в разделе **Параметры** выберите **Application Insights**.

1. Если Application Insights не включено, в области **Application Insights** выберите **включить Application Insights**. После обновления панели в нижней части щелкните **Применить**.

   Если Application Insights включен, в области **Application Insights** выберите **представление Application Insights данные**.

После открытия Application Insights можно просматривать различные метрики для приложения логики.

<a name="enable-run-history-stateless"></a>

## <a name="enable-run-history-for-stateless-workflows"></a>Включить журнал выполнения для рабочих процессов без отслеживания состояния

Чтобы упростить отладку рабочего процесса без отслеживания состояния, можно включить журнал выполнения для этого рабочего процесса, а затем отключить журнал выполнения по завершении. Выполните следующие действия для портал Azure или, если вы работаете в Visual Studio Code, см. статью [создание рабочих процессов с отслеживанием состояния и без отслеживания состояния в Visual Studio Code](create-stateful-stateless-workflows-visual-studio-code.md#enable-run-history-stateless).

1. В [портал Azure](https://portal.azure.com)найдите и откройте ресурс **приложения логики (Предварительная версия)** .

1. В меню приложения логики в разделе **Параметры** выберите **Конфигурация**.

1. На вкладке **Параметры приложения** выберите **создать параметр приложения**.

1. В области **Добавление/изменение параметров приложения** в поле **имя** введите имя параметра операции: 

   `Workflows.{yourWorkflowName}.OperationOptions`

1. В поле **значение** введите следующее значение: `WithStatelessRunHistory`

   Пример:

   ![Снимок экрана, показывающий ресурс портал Azure и приложения логики (Предварительная версия) с параметром "Конфигурация" > "создать параметры приложения" < "Открыть/изменить параметр приложения" и "рабочие процессы". {Йоурворкфловнаме}. Оператионоптионс "для параметра задано значение" Висстателессрунхистори ".](./media/create-stateful-stateless-workflows-azure-portal/stateless-operation-options-run-history.png)

1. Чтобы завершить эту задачу, нажмите кнопку **ОК**. На панели инструментов панели **конфигурации** нажмите кнопку **сохранить**.

1. Чтобы отключить журнал выполнения по завершении, присвойте `Workflows.{yourWorkflowName}.OperationOptions` свойству значение `None` , или удалите свойство вместе со значением.

<a name="delete-from-designer"></a>

## <a name="delete-items-from-the-designer"></a>Удаление элементов из конструктора

Чтобы удалить элемент в рабочем процессе из конструктора, выполните любое из следующих действий.

* Выберите элемент, откройте контекстное меню элемента (Shift + F10) и выберите **Удалить**. Для подтверждения выберите **ОК**.

* Выберите элемент и нажмите клавишу DELETE. Для подтверждения выберите **ОК**.

* Выберите элемент, чтобы открыть область сведений для этого элемента. В верхнем правом углу панели откройте меню с многоточием (**...**) и выберите **Удалить**. Для подтверждения выберите **ОК**.

  ![Снимок экрана, на котором показан выбранный элемент в конструкторе с открытой областью сведений, плюс кнопка с многоточием и командой "Удалить".](./media/create-stateful-stateless-workflows-azure-portal/delete-item-from-designer.png)

  > [!TIP]
  > Если меню многоточия не отображается, раскройте окно браузера, чтобы в области сведений отображалась кнопка с многоточием (**...**) в правом верхнем углу.

<a name="troubleshoot"></a>

## <a name="troubleshoot-problems-and-errors"></a>Устранение неполадок и ошибок

<a name="missing-triggers-actions"></a>

### <a name="new-triggers-and-actions-are-missing-from-the-designer-picker-for-previously-created-workflows"></a>В средстве выбора конструктора для ранее созданных рабочих процессов отсутствуют новые триггеры и действия.

Azure Logic Apps Preview поддерживает встроенные действия для операций с функциями Azure, ликвидных операций и XML-операций, таких как **Проверка XML** и **XML-преобразование**. Однако для ранее созданных приложений логики эти действия могут не отображаться в конструкторе, чтобы вы могли выбрать, будет ли приложение логики использовать устаревшую версию пакета расширений `Microsoft.Azure.Functions.ExtensionBundle.Workflows` .

Чтобы устранить эту проблему, выполните следующие действия, чтобы удалить устаревшую версию, чтобы пакет расширений мог автоматически обновиться до последней версии.

> [!NOTE]
> Это решение относится только к ресурсам **приложения логики (Предварительная версия)** , которые создаются с помощью портал Azure, а не приложений логики, которые создаются и развертываются с помощью Visual Studio Code и расширения Azure Logic Apps (Предварительная версия). См. раздел [Поддерживаемые триггеры и действия отсутствуют в конструкторе в Visual Studio Code](create-stateful-stateless-workflows-visual-studio-code.md#missing-triggers-actions).

1. В портал Azureе закройте приложение логики.

   1. В меню приложения логики выберите **Обзор**.

   1. На панели инструментов панели **Обзор** нажмите кнопку **прерывать**.

1. В меню приложения логики в разделе **средства разработки** выберите **Дополнительные инструменты**.

1. В области **Дополнительные инструменты** выберите **Go**, чтобы открыть среду KUDU для приложения логики.

1. На панели инструментов KUDU откройте меню **консоль отладки** и выберите **cmd**. 

   Откроется окно консоли, в котором можно будет перейти к папке пакета с помощью командной строки. Также можно просмотреть структуру каталогов, отображаемую в окне консоли.

1. Перейдите в следующую папку, содержащую версии папок для существующего пакета:

   `...\home\data\Functions\ExtensionBundles\Microsoft.Azure.Functions.ExtensionBundle.Workflows`

1. Удалите папку версии для существующего пакета. В окне консоли можно выполнить следующую команду, которая будет заменена `{bundle-version}` существующей версией:

   `rm -rf {bundle-version}`

   Пример: `rm -rf 1.1.3`

   > [!TIP]
   > Если появляется сообщение об ошибке, например "отказано в доступе" или "файл используется", обновите страницу в браузере и повторите предыдущие шаги, пока папка не будет удалена.

1. В портал Azure вернитесь на страницу **обзора** приложения логики и выберите **перезапустить**.

   Портал автоматически получает и использует последний пакет.

## <a name="next-steps"></a>Дальнейшие действия

Мы хотели бы узнать о своих впечатлениях в этой общедоступной предварительной версии!

* При возникновении ошибок или проблем [Создайте свои проблемы в GitHub](https://github.com/Azure/logicapps/issues).
* Для вопросов, запросов, комментариев и других отзывов [Используйте эту форму обратной связи](https://aka.ms/lafeedback).
