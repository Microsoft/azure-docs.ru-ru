---
title: Как обрезать видео с помощью Media Encoder Standard в Azure | Документация Майкрософт
description: Обрезка заключается в выборе прямоугольного окна в пределах видеокадра и кодировании в нем пикселей. В этой статье показано, как обрезать видео с помощью Media Encoder Standard.
services: media-services
documentationcenter: ''
author: IngridAtMicrosoft
manager: femila
editor: ''
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 03/10/2021
ms.author: anilmur
ms.reviewer: juliako
ms.openlocfilehash: 6a15e57884f85e2d56b77c3e5eec1267133fe96d
ms.sourcegitcommit: 225e4b45844e845bc41d5c043587a61e6b6ce5ae
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2021
ms.locfileid: "103016735"
---
# <a name="crop-videos-with-media-encoder-standard"></a>Обрезка видео с помощью Media Encoder Standard

[!INCLUDE [media services api v2 logo](./includes/v2-hr.md)] 

Для обрезки входного видео можно использовать стандартный кодировщик служб мультимедиа (MES). Обрезка заключается в выборе прямоугольного окна в пределах видеокадра и кодировании в нем пикселей. Этот процесс продемонстрирован на схеме ниже.

![Обрезка видео](./media/media-services-crop-video/media-services-crop-video01.png)

Предположим, у вас есть входное видео с разрешением 1920 x 1080 пикселей (соотношение сторон 16:9), но по бокам экрана есть черные полосы. Таким образом, активное видео имеет разрешение 1440 x 1080 пикселей или соотношение сторон 4:3. Чтобы обрезать или изменить черные полосы и закодировать область с разрешением 1440 x 1080, можно использовать стандартный кодировщик служб мультимедиа.

Обрезка в MES — это стадия предварительной обработки. Поэтому параметры обрезки в предустановке кодирования применяются к исходному видео. Кодирование — это последующая стадия. Параметры ширины и высоты применяются к *предварительно обработанному* видео, а не к исходному. При создании предустановки необходимо сделать следующее: a) выбрать параметры обрезки на основе исходного видео; б) выбрать параметры кодирования на основе обрезанного видео. Если параметры кодирования не сопоставлены с обрезанным видео, выходное видео не будет выглядеть должным образом.

В [следующем](media-services-custom-mes-presets-with-dotnet.md#encoding_with_dotnet) разделе показано, как создать задание кодирования с помощью MES и указать пользовательскую предустановку для задачи кодирования. 

## <a name="creating-a-custom-preset"></a>Создание пользовательской предустановки
Пример, приведенный на схеме:

1. Разрешение исходного видео — 1920 x 1080.
2. Его необходимо обрезать, чтобы получилось видео с разрешением 1440 x 1080, расположенное по центру входного кадра.
3. Это означает, что смещение по оси X равно 240 ((1920 – 1440)/2), а смещение по оси Y равно нулю.
4. Ширина и высота прямоугольника обрезки — 1440 и 1080 соответственно.
5. На стадии кодирования необходимо создать три уровня с разрешениями 1440 x 1080, 960 x 720 и 480 x 360 соответственно.

### <a name="json-preset"></a>Предустановка JSON

```json
{
  "Version": 1.0,
  "Sources": [
    {
      "Streams": [],
      "Filters": {
        "Crop": {
          "X": 240,
          "Y": 0,
          "Width": 1440,
          "Height": 1080
        }
      },
      "Pad": true
    }
  ],
  "Codecs": [
    {
      "KeyFrameInterval": "00:00:02",
      "H264Layers": [
        {
          "Profile": "Auto",
          "Level": "auto",
          "Bitrate": 3400,
          "MaxBitrate": 3400,
          "BufferWindow": "00:00:05",
          "Width": 1440,
          "Height": 1080,
          "BFrames": 3,
          "ReferenceFrames": 3,
          "AdaptiveBFrame": true,
          "Type": "H264Layer",
          "FrameRate": "0/1"
        },
        {
          "Profile": "Auto",
          "Level": "auto",
          "Bitrate": 2250,
          "MaxBitrate": 2250,
          "BufferWindow": "00:00:05",
          "Width": 960,
          "Height": 720,
          "BFrames": 3,
          "ReferenceFrames": 3,
          "AdaptiveBFrame": true,
          "Type": "H264Layer",
          "FrameRate": "0/1"
        },
        {
          "Profile": "Auto",
          "Level": "auto",
          "Bitrate": 1250,
          "MaxBitrate": 1250,
          "BufferWindow": "00:00:05",
          "Width": 480,
          "Height": 360,
          "BFrames": 3,
          "ReferenceFrames": 3,
          "AdaptiveBFrame": true,
          "Type": "H264Layer",
          "FrameRate": "0/1"
        }
      ],
      "Type": "H264Video"
    },
    {
      "Profile": "AACLC",
      "Channels": 2,
      "SamplingRate": 48000,
      "Bitrate": 128,
      "Type": "AACAudio"
    }
  ],
  "Outputs": [
    {
      "FileName": "{Basename}_{Width}x{Height}_{VideoBitrate}.mp4",
      "Format": {
        "Type": "MP4Format"
      }
    }
  ]
}
```

## <a name="restrictions-on-cropping"></a>Ограничения при обрезке
Обрезка должна выполняться вручную. Вам потребуется загрузить входное видео в подходящее средство редактирования, которое позволит выбрать интересующие вас кадры, навести курсор на определение смещений для прямоугольника обрезки, чтобы определить предустановку кодирования, настроенную для этого конкретного видео, и т. д. Эта функция не предназначена для следующих целей: автоматическое обнаружение и удаление черных леттербокс/пилларбокс границ во входном видео.

К функции обрезки также применяются приведенные ниже ограничения. В случае их несоблюдения задача кодирования может завершиться сбоем или вывести непредвиденный результат.

1. Координаты и размер прямоугольника обрезки должны соответствовать входному видео.
2. Как уже говорилось, значения ширины и высоты в параметрах кодирования должны соответствовать обрезанному видео.
3. Обрезка применяется к видео, записанному в альбомном режиме (т. е. она не применяется к видео, которое записано с использованием смартфона, повернутого вертикально или настроенного на книжный режим).
4. Рекомендуется применять к прогрессивному видео, которое записывается в пикселях широкоформатного кадра.

## <a name="provide-feedback"></a>Отзывы
[!INCLUDE [media-services-user-voice-include](../../../includes/media-services-user-voice-include.md)]

## <a name="next-step"></a>Дальнейшие действия
См. схемы обучения по службам мультимедиа Azure, которые позволят вам узнать о возможностях, предлагаемых AMS.  

[!INCLUDE [media-services-learning-paths-include](../../../includes/media-services-learning-paths-include.md)]
