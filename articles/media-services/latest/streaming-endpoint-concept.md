---
# <a name="mandatory-fields-see-more-on-akamsskyeyemeta"></a>Обязательные поля. Дополнительные сведения см. на aka.ms/skyeye/meta.
Title: конечные точки потоковой передачи (источник): Описание служб мультимедиа Azure: сведения о конечных точках потоковой передачи (источник), динамическую упаковку и службу потоковой передачи, которые доставляют содержимое непосредственно в клиентское приложение проигрывателя или в сеть доставки содержимого (CDN). services: media-services documentationcenter: '' author: IngridAtMicrosoft manager: femila editor: ''

MS. Service: мультимедиа-службы MS. Рабочая нагрузка: MS. Topic: концептуальная МС. Дата: 02/13/2020 MS. author: инхенкел
---

# <a name="streaming-endpoints-origin-in-azure-media-services"></a>Конечные точки потоковой передачи (источник) в службах мультимедиа Azure

В Cлужбы мультимедиа Microsoft Azure [Конечная точка потоковой передачи](/rest/api/media/streamingendpoints) представляет собой динамическую (JIT) упаковку и службу-источник, которые могут доставлять содержимое в реальном времени и по запросу непосредственно в приложение клиентского проигрывателя, используя один из распространенных протоколов потокового мультимедиа (HLS или тире). Кроме того, **Конечная точка потоковой передачи** обеспечивает динамическое (JIT) шифрование для ведущих DRM в отрасли. 

Когда вы создаете учетную запись Служб мультимедиа, конечная точка потоковой передачи **по умолчанию** создается в остановленном состоянии. В учетной записи можно создать больше конечных точек потоковой передачи (см. раздел [квоты и ограничения](limits-quotas-constraints.md)).

> [!NOTE]
> Чтобы начать потоковую передачу видео, вам потребуется запустить **конечную точку потоковой передачи**, из которой предполагается транслировать видео.
>
> Счет выставляется, только если конечная точка потоковой передачи находится в состоянии выполняется.

Обязательно ознакомьтесь с разделом [Динамическая упаковка](dynamic-packaging-overview.md) . 

## <a name="naming-convention"></a>Соглашение об именовании

Формат имени узла для URL-адреса потоковой передачи: `{servicename}-{accountname}-{regionname}.streaming.media.azure.net` , где `servicename` = имя конечной точки потоковой передачи или имя события в реальном времени.

При использовании конечной точки потоковой передачи по умолчанию `servicename` не указывается, поэтому URL-адрес имеет следующее значение: `{accountname}-{regionname}.streaming.azure.net` .

### <a name="limitations"></a>Ограничения

* Максимальное значение имени конечной точки потоковой передачи — 24 символа.
* Имя должно соответствовать этому шаблону [регулярного выражения](/dotnet/standard/base-types/regular-expression-language-quick-reference) : `^[a-zA-Z0-9]+(-*[a-zA-Z0-9])*$` .

## <a name="types"></a>Типы

Существует два типа **конечных точек потоковой передачи** : **Standard** (Предварительная версия) и **Premium**. Тип определяется по количеству единиц масштабирования (`scaleUnits`), выделенных для конечной точки потоковой передачи.

Максимальный размер единицы потоковой передачи обычно равен 10. Свяжитесь с [нами,](https://azure.microsoft.com/support/create-ticket/) чтобы увеличить лимит для вашей учетной записи.

В таблице ниже описаны типы.

|Тип|Единицы масштабирования|Описание|
|--------|--------|--------|  
|**Стандартный**|0|Конечной точкой потоковой передачи по умолчанию является **стандартный** тип — ее можно изменить на тип Premium, изменив `scaleUnits` .|
|**Премиальный**|> 0|**Premium** Конечные точки потоковой передачи подходят для расширенных рабочих нагрузок и обеспечивают выделенную и масштабируемую пропускную способность. Вы переходите к типу **Premium** , настраивая `scaleUnits` (единицы потоковой передачи). `scaleUnits` предоставляют определенную выходную пропускную способность, которую можно приобрести с шагом приращения 200 Мбит/с. При использовании типа " **премиум** " Каждая включенная единица обеспечивает дополнительную пропускную способность для приложения. |

> [!NOTE]
> Для клиентов, желающих доставлять содержимое в крупную аудиторию Интернета, рекомендуется включить CDN в конечной точке потоковой передачи.

Сведения об уровне обслуживания см. в разделе [цены и соглашение об уровне обслуживания](https://azure.microsoft.com/pricing/details/media-services/).

## <a name="comparing-streaming-types"></a>Сравнение типов потоковой передачи

Компонент|Standard|Premium
---|---|---
Пропускная способность |До 600 Мбит/с и может обеспечить более эффективную пропускную способность при использовании CDN.|200 Мбит/с на единицу потоковой передачи. Может обеспечить более эффективную пропускную способность при использовании CDN.
Сеть доставки содержимого|Azure CDN, CDN сторонней сети или нет CDN.|Azure CDN, CDN сторонней сети или нет CDN.
Пропорциональное выставление счетов| Ежедневно|Ежедневно
Динамическое шифрование|Да|Да
Динамическая упаковка|Да|Да
Масштабирование|Автоматически масштабируется до целевой пропускной способности.|Дополнительные службы SUs
IP-фильтрация/G20/пользовательский узел <sup>1</sup>|Да|Да
Прогрессивное скачивание|Да|Да
Рекомендуемый способ использования |Рекомендуется для большинства сценариев потоковой передачи.|Специализированное использование.

<sup>1</sup> используется только непосредственно в конечной точке потоковой передачи, если CDN не включен в конечной точке.<br/>

### <a name="versions"></a>Версии

|Тип|Версия конечной точки потоковой передачи|Единицы масштабирования|Сеть доставки содержимого|Выставление счетов|
|--------------|----------|-----------------|-----------------|-----------------|
|Классический|1.0|0|Н/Д|Бесплатный|
|Стандартная конечная точка потоковой передачи (Предварительная версия)|2.0|0|Да|Платный|
|Единицы потоковой передачи типа "Премиум"|1.0|> 0|Да|Платный|
|Единицы потоковой передачи типа "Премиум"|2.0|> 0|Да|Платный|

### <a name="features"></a>Компоненты

Компонент|Standard|Premium
---|---|---
Пропускная способность |До 600 Мбит/с и может обеспечить более эффективную пропускную способность при использовании CDN.|200 Мбит/с на единицу потоковой передачи. Может обеспечить более эффективную пропускную способность при использовании CDN.
Сеть доставки содержимого|Azure CDN, CDN сторонних поставщиков или без CDN.|Azure CDN, CDN сторонних поставщиков или без CDN.
Пропорциональное выставление счетов| Ежедневно|Ежедневно
Динамическое шифрование|Да|Да
Динамическая упаковка|Да|Да
Масштабирование|Автоматически масштабируется до целевой пропускной способности.|Дополнительные единицы потоковой передачи.
IP-фильтрация/G20/пользовательский узел <sup>1</sup>|Да|Да
Прогрессивное скачивание|Да|Да
Рекомендуемый способ использования |Рекомендуется для большинства сценариев потоковой передачи.|Специализированное использование. 

<sup>1</sup> используется только непосредственно в конечной точке потоковой передачи, если сеть CDN не включена в конечной точке.<br/>

Сведения об уровне обслуживания см. в разделе [цены и соглашение об уровне обслуживания](https://azure.microsoft.com/pricing/details/media-services/).

## <a name="migration-between-types"></a>Миграция между типами

Исходный тип | Кому | Действие
---|---|---
Классический|Standard|Необходима миграция.
Классический|Premium| Масштабирование (дополнительные единицы потоковой передачи).
Стандартный/Премиум|Классический|Недоступно (если конечная точка потоковой передачи версии 1.0; допускается переход на классическую версию с настройкой значения 0 для единиц потоковой передачи).
"Стандартный" (с и без CDN)|"Премиум" (с теми же конфигурациями)|Допускается в **запущенном** состоянии (с использованием портала Azure).
"Премиум" (с и без CDN)|"Стандартный" (с теми же конфигурациями)|Допускается в **запущенном** состояния (с использованием портала Azure).
"Стандартный" (с и без CDN)|"Премиум" (с другой конфигурацией)|Допускается в **остановленном** состоянии (с использованием портала Azure). Не допускается в запущенном состоянии.
"Премиум" (с и без CDN)|"Стандартный" (с другой конфигурацией)|Допускается в **остановленном** состоянии (с использованием портала Azure). Не допускается в запущенном состоянии.
Версия 1.0: единиц потоковой передачи >= 1 (с CDN)|"Стандартный" и "Премиум" (без CDN)|Допускается в **остановленном** состоянии. Не допускается в **запущенном** состоянии.
Версия 1.0: единиц потоковой передачи >= 1 (с CDN)|"Стандартный" (с и без CDN)|Допускается в **остановленном** состоянии. Не допускается в **запущенном** состоянии. Версия 1.0 CDN будет удалена. Будет создана и запущена новая.
Версия 1.0: единиц потоковой передачи >= 1 (с CDN)|"Премиум" (с и без CDN)|Допускается в **остановленном** состоянии. Не допускается в **запущенном** состоянии. Классическая версия CDN будет удалена. Будет создана и запущена новая.







## <a name="streaming-endpoint-properties"></a>Свойства конечной точки потоковой передачи

В этом разделе приводятся сведения о некоторых свойствах конечной точки потоковой передачи. Примеры создания новой конечной точки потоковой передачи и описания всех свойств см. в [этой статье](/rest/api/media/streamingendpoints/create).

- `accessControl`: Используется для настройки следующих параметров безопасности для этой конечной точки потоковой передачи: ключи проверки подлинности заголовка подписи Akamai и IP-адреса, разрешенные для подключения к этой конечной точке. Это свойство может быть задано, только если `cdnEnabled` имеет значение false.

- `cdnEnabled`: Указывает, включена ли интеграция Azure CDN для этой конечной точки потоковой передачи (по умолчанию отключена). Если задать для `cdnEnabled` значение true, следующие конфигурации интеграции отключаются: `customHostNames` и `accessControl`.

    Не все центры обработки данных поддерживают интеграцию Azure CDN. Чтобы проверить, доступна ли интеграция Azure CDN в центре обработки данных, выполните следующие действия.

  - Попробуйте задать для параметра `cdnEnabled` значение true.
  - Проверьте возвращенный результат для `HTTP Error Code 412` (PreconditionFailed) с сообщением "свойство конечной точки потоковой передачи не может быть установлено в значение true, так как возможность CDN недоступна в текущем регионе".

    При возникновении этой ошибки центр обработки данных его не поддерживает. Попробуйте использовать другой центр обработки данных.

- `cdnProfile`: Если параметр `cdnEnabled` имеет значение true, можно также передать `cdnProfile` значения. `cdnProfile` — имя профиля CDN, в котором будет создана конечная точка CDN. Вы можете предоставить имеющийся cdnProfile или создать его. Если значение равно NULL, а `cdnEnabled` — true, используется значение по умолчанию (AzureMediaStreamingPlatformCdnProfile). Если параметр `cdnProfile` уже предоставлен, с его использованием создается конечная точка. Если профиль не существует, автоматически создается новый профиль.
- `cdnProvider`: Если сеть CDN включена, можно также передавать `cdnProvider` значения. `cdnProvider` определяет, какой поставщик будет использоваться. Сейчас поддерживаются три значения: StandardVerizon, PremiumVerizon и StandardAkamai. Если значение не указано и `cdnEnabled` имеет значение true, используется "стандардверизон" (это значение по умолчанию).
- `crossSiteAccessPolicies`: Используется для указания политик межсайтового доступа для различных клиентов. Дополнительные сведения см. в статьях [Спецификация файла междоменной политики](https://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html) и [Настройка доступности службы на границах домена](/previous-versions/azure/azure-services/gg185950(v=azure.100)). Параметры применяются только к Smooth Streaming.
- `customHostNames`: Используется для настройки конечной точки потоковой передачи для приема трафика, направленного на пользовательское имя узла. Это свойство допустимо для конечных точек потоковой передачи уровня "Стандартный" и "Премиум" и может быть задано, когда `cdnEnabled` : false.

    Владение доменным именем должно быть подтверждено службами мультимедиа. Службы мультимедиа проверяют принадлежность доменного имени, запросив `CName` запись, СОДЕРЖАЩУЮ идентификатор учетной записи служб мультимедиа, в качестве компонента, добавляемого в используемый домен. Например, чтобы использовать sports.contoso.com в качестве пользовательского имени узла для конечной точки потоковой передачи, запись для `<accountId>.contoso.com` необходимо настроить для указания одного из имен узлов проверки Служб мультимедиа. Имя узла проверки состоит из верифиднс. `\<mediaservices-dns-zone>` .

    Ниже перечислены ожидаемые зоны DNS, которые будут использоваться в записи проверки для различных регионов Azure.
  
  - Северная Америка, Европа, Сингапур, Гонконг, САР, Япония:

    - `media.azure.net`
    - `verifydns.media.azure.net`

  - Китай:

    - `mediaservices.chinacloudapi.cn`
    - `verifydns.mediaservices.chinacloudapi.cn`

    Например, `CName` запись, которая сопоставляет "945a4c4e-28ea-45cd-8ccb-a519f6b700ad.contoso.com" с "verifydns.Media.Azure.NET", подтверждает, что у идентификатора служб мультимедиа 945a4c4e-28ea-45cd-8ccb-a519f6b700ad есть право владения доменом contoso.com, что позволяет использовать любое имя в Contoso.com в качестве пользовательского имени узла для конечной точки потоковой передачи в этой учетной записи. Чтобы найти значение идентификатора службы мультимедиа, перейдите на [портал Azure](https://portal.azure.com/) и выберите свою учетную запись службы мультимедиа. **Идентификатор учетной записи** отображается в правом верхнем углу страницы.

    При попытке задать имя пользовательского узла без соответствующей проверки `CName` записи ответ DNS завершится ошибкой, а затем будет кэшироваться в течение некоторого времени. После получения соответствующей записи повторная проверка кэшированного ответа может занять некоторое время. В зависимости от поставщика DNS для личного домена это может занять от нескольких минут до часа для повторной проверки записи.

    В дополнение к, `CName` которое сопоставляется `<accountId>.<parent domain>` с `verifydns.<mediaservices-dns-zone>` , необходимо создать другую `CName` , которая сопоставляет имя пользовательского узла (например, `sports.contoso.com` ) с именем узла в конечной точке потоковой передачи служб мультимедиа (например, `amstest-usea.streaming.media.azure.net` ).

    > [!NOTE]
    > Конечные точки потоковой передачи, расположенные в одном центре обработки данных, не могут использовать одно и то же имя пользовательского узла.

    Сейчас службы мультимедиа не поддерживают TLS для личных доменов.

- `maxCacheAge` — Переопределяет заданный по умолчанию заголовок управления для кэша HTTP max-age, заданный конечной точкой потоковой передачи для фрагментов мультимедиа и манифестов по требованию. Это значение задается в секундах.
- `resourceState` -

    - Остановлено: начальное состояние конечной точки потоковой передачи после создания
    - Запуск: переходит в состояние выполнения
    - Работает: поддерживает потоковую передачу содержимого клиентам
    - Масштабирование: единицы масштабирования увеличиваются или уменьшаются.
    - Остановка: переходит в остановленное состояние
    - Удаляется: удаляется

- `scaleUnits`: Предоставьте выделенную емкость исходящего трафика, которую можно приобрести с шагом в 200 Мбит/с. Если вам нужно выполнить переход к типу **Премиум**, настройте параметр `scaleUnits`.

## <a name="why-use-multiple-streaming-endpoints"></a>Зачем использовать несколько конечных точек потоковой передачи?

Одна конечная точка потоковой передачи может выполнять потоковую передачу видео в режиме реального времени и по запросу, а большинство клиентов используют только одну конечную точку потоковой передачи В этом разделе приводятся некоторые примеры того, почему может потребоваться использовать несколько конечных точек потоковой передачи.

* Каждая зарезервированная единица разрешает 200 Мбит/с для пропускной способности. Если вам требуется более 2 000 Мбит/с (2 Гбит/с), можно использовать вторую конечную точку потоковой передачи и балансировку нагрузки, чтобы предоставить дополнительную пропускную способность.

    Тем не менее CDN является лучшим способом достижения масштабируемости потоковой передачи содержимого, но если вы доставляете настолько много содержимого, что CDN запрашивает более 2 Гбит/с, можно добавить дополнительные конечные точки потоковой передачи (источники). В этом случае потребуется передать URL-адреса содержимого, которые сбалансированы между двумя конечными точками потоковой передачи. Такой подход обеспечивает лучшее кэширование, чем попытки отправки запросов в каждый источник случайным образом (например, через диспетчер трафика). 
    
    > [!TIP]
    > Обычно, если CDN запрашивает более 2 Гбит/с, то что-то может быть неправильно настроено (например, без экранирования источника).
    
* Балансировка нагрузки различных поставщиков CDN. Например, можно настроить конечную точку потоковой передачи по умолчанию для использования CDN Verizon и создать вторую, чтобы использовать Akamai. Затем добавьте какую-либо балансировку нагрузки между двумя, чтобы обеспечить балансировку для нескольких CDN. 

    Однако клиент часто выполняет балансировку нагрузки между несколькими поставщиками CDN, используя один источник.
* Потоковая передача смешанного содержимого: в реальном времени и видео по запросу. 

    Шаблоны доступа для содержимого в режиме реального времени и по запросу сильно отличаются. В реальном времени содержимое, как правило, получает много спроса на одно и то же содержимое. Содержимое видео по запросу (длинный заключительный Архив содержимого для экземпляра) имеет низкий уровень использования в одном и том же содержимом. Таким образом, кэширование работает очень хорошо в активном содержимом, но не также на длинном заключительном фрагменте содержимого.

    Рассмотрим ситуацию, в которой клиенты в основном отслеживают содержимое в реальном времени, но иногда отслеживают содержимое по запросу и обслуживаются из одной и той же конечной точки потоковой передачи. При низком использовании содержимого по запросу будет занимать место в кэше, которое лучше сохранить для содержимого в реальном времени. В этом сценарии мы рекомендуем передавать содержимое в реальном времени из одной конечной точки потоковой передачи и длинного заключительного фрагмента содержимого из другой конечной точки потоковой передачи. Это повысит производительность содержимого интерактивного события.
    
## <a name="scaling-streaming-with-cdn"></a>Масштабирование потоковой передачи с помощью CDN

См. следующие статьи:

- [Общие сведения о CDN](../../cdn/cdn-overview.md)
- [Масштабирование потоковой передачи с помощью CDN](scale-streaming-cdn.md)

## <a name="ask-questions-and--get-updates"></a>Задавайте вопросы и получайте обновления

Прочитайте статью [сообщества Служб мультимедиа Azure](media-services-community.md), чтобы узнать, как задавать вопросы, оставлять отзывы и получать новости о Службах мультимедиа.

## <a name="see-also"></a>См. также раздел

[Динамическая упаковка](dynamic-packaging-overview.md)

## <a name="next-steps"></a>Дальнейшие действия

[Управление конечными точками потоковой передачи](manage-streaming-endpoints-howto.md)
