---
title: Распознавание анимированных символов с помощью индексатора видео как
titleSuffix: Azure Media Services
description: В этом примере показано, как использовать функцию распознавания анимированных символов с помощью индексатора видео.
services: media-services
author: Juliako
manager: femila
ms.service: media-services
ms.subservice: video-indexer
ms.custom: references_regions
ms.topic: how-to
ms.date: 12/07/2020
ms.author: juliako
ms.openlocfilehash: 1ee179efbe936c742f1eb51b998c10f9349c14fb
ms.sourcegitcommit: 799f0f187f96b45ae561923d002abad40e1eebd6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/24/2020
ms.locfileid: "97763393"
---
# <a name="use-the-animated-character-detection-preview-with-portal-and-api"></a>Использование функции обнаружения анимированных символов (Предварительная версия) с помощью портала и API 

Индексатор видео служб мультимедиа Azure поддерживает обнаружение, группирование и распознавание символов в анимированном содержимом, эта функция доступна через портал Azure и через API. Ознакомьтесь с [этим обзорным](animated-characters-recognition.md) разделом.

В этой статье показано, как использовать обнаружение анимированных символов с помощью портал Azure и API индексатора видео.

## <a name="use-the-animated-character-detection-with-portal"></a>Использование распознавания анимированных символов с помощью портала 

В пробных учетных записях Управление интеграцией Пользовательское визуальное распознавание осуществляется с помощью индексатора видео. Вы можете приступить к созданию и использованию модели анимированных символов. При использовании пробной учетной записи можно пропустить следующий раздел ("подключение учетной записи Пользовательское визуальное распознавание").

### <a name="connect-your-custom-vision-account-paid-accounts-only"></a>Подключение учетной записи Пользовательское визуальное распознавание (только платные учетные записи)

Если вы владеете платной учетной записью индексатора видео, сначала необходимо подключить учетную запись Пользовательское визуальное распознавание. Если у вас еще нет учетной записи Пользовательское визуальное распознавание, создайте ее. Дополнительные сведения см. в разделе [пользовательское визуальное распознавание](../../cognitive-services/custom-vision-service/overview.md).

> [!NOTE]
> Обе учетные записи должны находиться в одном регионе. Интеграция с Пользовательское визуальное распознавание в настоящее время не поддерживается в японском регионе.

Оплаченные учетные записи, имеющие доступ к своей учетной записи Пользовательское визуальное распознавание, могут видеть модели и изображения с тегами. Дополнительные сведения об [улучшении классификатора в пользовательское визуальное распознавание](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/getting-started-improving-your-classifier). 

Обратите внимание, что обучение модели должно выполняться только через индексатор видео, а не через веб-сайт Пользовательское визуальное распознавание. 

#### <a name="connect-a-custom-vision-account-with-api"></a>Подключение учетной записи Пользовательское визуальное распознавание с помощью API 

Выполните следующие действия, чтобы подключить учетную запись Пользовательское визуальное распознавание к индексатору видео или изменить учетную запись Пользовательское визуальное распознавание, которая в настоящее время подключена к индексатору видео:

1. Перейдите по [www.customvision.AI](https://www.customvision.ai) и войдите в систему.
1. Скопируйте ключи для учебных и прогнозирующих ресурсов:

    > [!NOTE]
    > Чтобы предоставить все ключи, необходимо иметь два отдельных ресурса в Пользовательское визуальное распознавание, один для обучения и один для прогнозирования.
1. Укажите другие сведения:

    * Конечная точка 
    * Идентификатор ресурса прогноза
1. Перейдите к [индексатору видео](https://vi.microsoft.com/)и войдите в него.
1. Щелкните вопросительный знак в правом верхнем углу страницы и выберите **Справочник по API**.
1. Убедитесь, что вы подписаны на службу управления API, щелкнув вкладку **продукты** . Если у вас есть подключенный API, можно перейти к следующему шагу, в противном случае — Subscribe. 
1. На портале разработчика щелкните **полный справочник по API** и перейдите к **операциям**.  
1. Выберите **подключить пользовательское визуальное распознавание учетную запись (Предварительная версия)** и нажмите кнопку **попробовать**.
1. Заполните обязательные поля, а также маркер доступа и нажмите кнопку **Отправить**. 

    Дополнительные сведения о том, как получить маркер доступа к индексатору видео, см. на [портале разработчика](https://api-portal.videoindexer.ai/docs/services/operations/operations/Get-Account-Access-Token?)и в [соответствующей документации](video-indexer-use-apis.md#obtain-access-token-using-the-authorization-api).  
1. Когда вызов вернет 200 OK, ваша учетная запись будет подключена.
1. Чтобы проверить подключение, перейдите на портал " [индексатор видео](https://vi.microsoft.com/)"):
1. Нажмите кнопку **Настройка модели содержимого** в правом верхнем углу.
1. Перейдите на вкладку **анимированные символы** .
1. Выбрав Управление моделями в Пользовательское визуальное распознавание, вы перейдете в только что подключенную учетную запись Пользовательское визуальное распознавание.

> [!NOTE]
> В настоящее время поддерживаются только модели, созданные с помощью индексатора видео. Модели, созданные с помощью Пользовательское визуальное распознавание, будут недоступны. Кроме того, рекомендуется изменять модели, созданные с помощью индексатора видео, только с помощью платформы индексатора видео, так как изменения, внесенные с помощью Пользовательское визуальное распознавание, могут привести к непредвиденным результатам.

### <a name="create-an-animated-characters-model"></a>Создание модели анимированных символов

1. Откройте веб-сайт [Индексатора видео](https://vi.microsoft.com/) и выполните вход.
1. Чтобы настроить модель в учетной записи, нажмите кнопку **Настройка модели содержимого** в левой части страницы.

    > [!div class="mx-imgBorder"]
    > :::image type="content" source="./media/content-model-customization/content-model-customization.png" alt-text="Настройка модели содержимого в индексаторе видео":::
1. Перейдите на вкладку " **анимированные символы** " в разделе "Настройка модели".
1. Щелкните **Добавить модель**.
1. Назовите модель и нажмите клавишу ВВОД, чтобы сохранить имя.

> [!NOTE]
> Рекомендуется иметь одну пользовательскую модель представления для каждого анимированного ряда. 

### <a name="index-a-video-with-an-animated-model"></a>Индексирование видео с помощью анимированной модели

Для начального обучения загрузите по крайней мере два видео. Каждый из них должен быть предпочтительнее более 15 минут, прежде чем будет ожидаться хорошая модель распознавания. Если вы используете более короткие эпизоды, мы рекомендуем загрузить видео не менее 30 минут перед обучением. Это позволит объединять группы, принадлежащие одному и тому же символу, из разных сцен и фоновых рисунков, а значит, увеличить вероятность того, что он обнаружит символ на следующих эпизодах, которые вы индексируете. Чтобы обучить модель на нескольких видеороликах (эпизодах), необходимо индексировать их все с помощью одной и той же модели анимации. 

1. Нажмите кнопку **Отправить** .
1. Выберите видео для отправки (из файла или с помощью URL-адреса).
1. Щелкните **Дополнительные параметры**.
1. В разделе **люди/анимированные символы** выберите **модели анимации**.
1. Если у вас одна модель, она будет выбрана автоматически, и при наличии нескольких моделей можно выбрать в раскрывающемся меню один из них.
1. Щелкните Отправить.
1. После индексирования видео обнаруженные символы отображаются в разделе " **анимированные символы** " в области " **аналитика** ".

Перед созданием тегов и обучении модели все анимированные символы будут называться "Unknown #X". После обучения модели они также будут распознаны.

### <a name="customize-the-animated-characters-models"></a>Настройка моделей с анимированными символами

1. Назовите символы в индексаторе видео.

    1. После создания модели для группы символов рекомендуется проверить эти группы в Пользовательское визуальное распознавание. 
    1. Чтобы пометить анимированный символ в видео, перейдите на вкладку **аналитика**   и нажмите кнопку **изменить**   в правом верхнем углу окна. 
    1. В области **аналитика**   щелкните любой из обнаруженных анимированных символов и измените их имена с "Unknown #X" на временное имя (или имя, которое ранее было назначено символу). 
    1. После ввода нового имени щелкните значок галочки рядом с новым именем. Это сохранит новое имя в модели в индексаторе видео. 
1. Только платные учетные записи. Ознакомьтесь с группами в Пользовательское визуальное распознавание 

    > [!NOTE]
    > Оплаченные учетные записи, имеющие доступ к своей учетной записи Пользовательское визуальное распознавание, могут видеть модели и изображения с тегами. Дополнительные сведения об [улучшении классификатора в пользовательское визуальное распознавание](https://docs.microsoft.com/azure/cognitive-services/custom-vision-service/getting-started-improving-your-classifier). Важно отметить, что обучение модели должно выполняться только через индексатор видео (как описано в этом топид), а не через веб-сайт Пользовательское визуальное распознавание. 

    1. Перейдите на страницу **пользовательские модели** в индексаторе видео и выберите вкладку **анимированные символы** . 
    1. Нажмите кнопку изменить для модели, над которой вы работаете, чтобы управлять ею в Пользовательское визуальное распознавание. 
    1. Проверьте каждую группу символов: 

        * Если группа содержит несвязанные образы, рекомендуется удалить их на веб-сайте Пользовательское визуальное распознавание. 
        * Если есть изображения, принадлежащие другому символу, измените тег на этих изображениях, щелкнув изображение, добавив правый тег и удалив неправильный тег. 
        * Если группа является неправильной, то есть она содержит в основном несимвольные образы или изображения из нескольких символов, вы можете удалить их на веб-сайте Пользовательское визуальное распознавание или в Video Insights. 
        * Иногда алгоритм группирования разделяет символы на разные группы. Поэтому рекомендуется предоставлять всем группам, принадлежащим одному и тому же имени, одну и ту же букву (в Video Insights), что сразу же приводит к тому, что все эти группы будут отображаться на веб-сайте Пользовательское визуальное распознавание. 
    1. После уточнения группы убедитесь, что исходное имя, к которому он прикреплено, соответствует символу в группе. 
1. Обучение модели 

    1. После завершения редактирования всех нужных имен необходимо обучить модель. 
    1. После того как символ будет обучен в модели, он будет распознан следующим видео, проиндексированным в этой модели. 
    1. Откройте страницу Настройка и щелкните вкладку **анимированные символы**   , а затем нажмите кнопку **обучение** , чтобы обучить модель. Чтобы обеспечить подключение между видео 
    
Индексатор и модель не обучить модель на веб-сайте Пользовательское визуальное распознавание (платные учетные записи имеют доступ к Пользовательское визуальное распознаваниеному веб-сайту) только в индексаторе видео. После обучения любое видео, которое будет индексироваться или переиндексировано с помощью этой модели, будет распознавать обученные символы. 

## <a name="delete-an-animated-character-and-the-model"></a>Удаление анимированного символа и модели

1. Удаление анимированного символа.

    1. Чтобы удалить анимированный символ в Video Insights, перейдите на вкладку **аналитика** и нажмите кнопку **изменить** в правом верхнем углу окна.
    1. Выберите анимированный символ и нажмите кнопку **Удалить** под его именем.

    > [!NOTE]
    > Это позволит удалить аналитику из этого видео, но не повлияет на модель.
1. Удаление модели.

    1. Нажмите кнопку **Настройка модели содержимого** в верхнем меню и перейдите на вкладку **анимированные символы** .
    1. Щелкните значок с многоточием справа от модели, которую необходимо удалить, а затем нажмите кнопку Удалить.
    
    * Платная учетная запись. модель будет отключена от индексатора видео, и ее невозможно будет подключить повторно.
    * Пробная учетная запись. модель также будет удалена из таможенного видения. 
    
        > [!NOTE]
        > В пробной учетной записи имеется только одна модель, которую можно использовать. После удаления вы не сможете обучить другие модели.

## <a name="use-the-animated-character-detection-with-api"></a>Использование распознавания анимированных символов с помощью API 

1. Подключите учетную запись Пользовательское визуальное распознавание.

    Если вы владеете платной учетной записью индексатора видео, сначала необходимо подключить учетную запись Пользовательское визуальное распознавание. <br/>
    Если у вас еще нет учетной записи Пользовательское визуальное распознавание, создайте ее. Дополнительные сведения см. в разделе [пользовательское визуальное распознавание](../../cognitive-services/custom-vision-service/overview.md).

    [Подключите учетную запись пользовательское визуальное распознавание с помощью API](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Connect-Custom-Vision-Account?tags=&pattern=&groupBy=tag).
1. Создание модели анимированных символов.

    Используйте API [создания модели анимации](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Create-Animation-Model?&groupBy=tag) .
1. Индексирование и повторное индексирование видео.

    Используйте API [повторной индексации](https://api-portal.videoindexer.ai/docs/services/operations/operations/Re-Index-Video?) . 
1. Настройка моделей с анимированными символами.

    Использование API-интерфейса для [обучения модели анимации](https://api-portal.videoindexer.ai/docs/services/Operations/operations/Train-Animation-Model?&groupBy=tag) .

### <a name="view-the-output"></a>Просмотр результатов

Просмотр анимированных символов в созданном JSON файле.

```json
"animatedCharacters": [
    {
    "videoId": "e867214582",
    "confidence": 0,
    "thumbnailId": "00000000-0000-0000-0000-000000000000",
    "seenDuration": 201.5,
    "seenDurationRatio": 0.3175,
    "isKnownCharacter": true,
    "id": 4,
    "name": "Bunny",
    "appearances": [
        {
            "startTime": "0:00:52.333",
            "endTime": "0:02:02.6",
            "startSeconds": 52.3,
            "endSeconds": 122.6
        },
        {
            "startTime": "0:02:40.633",
            "endTime": "0:03:16.6",
            "startSeconds": 160.6,
            "endSeconds": 196.6
        },
    ]
    },
]
```

## <a name="limitations"></a>Ограничения

* В настоящее время возможность "идентификации анимации" не поддерживается в East-Asiaном регионе.
* Символы, которые выглядят маленькими или далеко не в видео, могут быть неправильно идентифицированы, если качество видео низкое.
* Рекомендуется использовать модель для набора анимированных символов (например, для каждого анимированного ряда).

## <a name="next-steps"></a>Дальнейшие действия

[Общие сведения об Индексаторе видео](video-indexer-overview.md)
