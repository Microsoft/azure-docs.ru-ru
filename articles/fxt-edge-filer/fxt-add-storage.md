---
title: Руководство. Добавление хранилища в кластер Azure FXT Edge Filer
description: Настройка серверного хранилища и виртуального пространства имен для клиента в Azure FXT Edge Filer
author: ekpgh
ms.author: rohogue
ms.service: fxt-edge-filer
ms.topic: tutorial
ms.date: 06/20/2019
ms.openlocfilehash: 7d10c6c1ce440b2ffe964dc78379ef3ab108e78e
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92217530"
---
# <a name="tutorial-add-back-end-storage-and-configure-the-virtual-namespace"></a>Руководство. Добавление серверного хранилища и настройка виртуального пространства имен

В этом руководстве объясняется, как добавить серверное хранилища для кэша и как настроить виртуальную файловую систему для клиента.

Кластер подключается к системам серверного хранилища, чтобы получить запрошенные клиентом данные и сохранить изменения, требующие более длительного хранения, чем в кэше.

Пространство имен является фиктивной файловой системой для клиента, которая позволяет менять серверное хранилище без влияния на рабочие процессы на стороне клиента.

В этом руководстве описано следующее.

> [!div class="checklist"]
>
> * Добавление серверного хранилища к кластеру Azure FXT Edge Filer
> * Определение пути к хранилищу, доступного для клиента

## <a name="about-back-end-storage"></a>Сведения о серверном хранилище

Кластер Azure FXT Edge Filer использует определение *основного файлового хранилища* для сопоставления системы серверного хранилища с кластером FXT.

Решение Azure FXT Edge Filer совместимо с несколькими популярными аппаратными системами NAS и умеет использовать пустые контейнеры из хранилища BLOB-объектов Azure или других облачных хранилищ.

Облачные контейнеры хранилища должны быть пустыми при добавлении, чтобы операционная система FXT получила полный контроль над данными в томе облачного хранилища. После добавления контейнера в кластер в качестве основного файлового хранилища вы сможете переместить существующие данные в облачный контейнер.

Используйте панель управления для добавления на компьютер основного файлового хранилища.

> [!NOTE]
>
> Если вы хотите использовать Amazon AWS или Google Cloud, необходимо установить лицензию на компонент FlashCloud<sup>TM</sup>. Обратитесь к представителю корпорации Майкрософт для получения лицензионного ключа и следуйте инструкциям из руководства по настройке, в котором описан процесс [добавления или удаления лицензии компонентов](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/install_licenses.html#install-licenses).
>
> Поддержка хранилища BLOB-объектов Azure предусмотрена лицензией на программное обеспечение Azure FXT Edge Filer.

Подробные сведения о добавлении основного файлового хранилища вы найдете в следующих разделах руководства по настройке кластера:

* Дополнительные сведения о выборе основного файлового хранилища и подготовке к его добавлению см. в разделе [о работе с основными файловыми хранилищами](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/core_filer_overview.html#core-filer-overview).
* Подробное описание предварительных требований и пошаговые инструкции см. в следующих статьях:

  * [Adding a New NAS Core Filer](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/new_core_filer_nas.html#create-core-filer-nas) (Добавление основного файлового хранилища NAS);
  * [Adding a New Cloud Core Filer](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/new_core_filer_cloud.html#create-core-filer-cloud) (Добавление нового облачного основного файлового хранилища).

После добавления основного файлового хранилища вы можете изменить его настройки на странице параметров.

## <a name="add-a-core-filer"></a>Добавление основного файлового хранилища

Чтобы определить основное файловое хранилище, нажмите кнопку **Create** (Создать) на странице параметров **Core Filer** > **Manage Core Filers** (Основное файловое хранилище > Управление основными файловыми хранилищами).

![Нажатие кнопки "Создать" над списком основных файловых хранилищ на странице управления основными файловыми хранилищами](media/fxt-cluster-config/create-core-filer-button.png)

**Мастер добавления основного файлового хранилища** поможет вам поэтапно создать основное файловое хранилище, связанное с серверным хранилищем. Руководство по настройке кластера содержит пошаговое описание процесса, который будет разным для хранилища NFS/NAS и для облачного хранилища (см. ссылки выше).

В ходе создания хранилища сделайте следующее:

* Выберите тип основного файлового хранилища (NAS или облачное).

  ![Первая страница мастера создания основного облачного хранилища на основе аппаратного NAS. Параметр "облачное основное файловое хранилище" отключен и отображает сообщение об ошибке из-за отсутствия лицензии.](media/fxt-cluster-config/new-nas-1.png)

* Укажите имя для основного файлового хранилища. Имя должно быть таким, чтобы администраторы кластера могли понять, какую систему хранения представляет хранилище.

* Для основных файловых хранилищ на основе NAS укажите полное доменное имя (FQDN) или IP-адрес. Для всех основных файловых хранилищ мы рекомендуем использовать только полное доменное имя, а для доступа через SMB это требование является обязательным.

* Выберите политику кэша. Вторая страница мастера перечисляет список политик, доступных для нового основного файлового хранилища. Дополнительные сведения см. в [разделе о политиках кэша руководства по настройке кластера](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_manage_cache_policies.html).

  ![Вторая страница мастера создания основного файлового хранилища на основе аппаратного NAS. Открыто раскрывающееся меню политики кэша, где несколько вариантов недоступны, а три доступны для выбора (работа в обход кластера, кэширование чтения и кэширование чтения и записи).](media/fxt-cluster-config/new-nas-choose-cache-policy.png)

* Для облачного хранилища необходимо также указать облачную службу и учетные данные для доступа. Дополнительные сведения см. в [разделе об облачных службах и протоколах](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/new_core_filer_cloud.html#cloud-service-and-protocol) руководства по настройке кластера.

  ![Сведения об основном файловом хранилище в мастере создания основного облачного хранилища](media/fxt-cluster-config/new-core-filer-cloud3.png)
  
  Если вы уже добавили в кластер учетные данные для доступа к облаку, они отобразятся в этом списке. Обновите и добавьте учетные данные на странице настроек **Cluster** (Кластер) > **Cloud Credentials** (Учетные данные облака).

Завершив настройку всех необходимых параметров в мастере, нажмите кнопку **Add Filer** (Добавить файловое хранилище), чтобы сохранить изменения.

Через несколько секунд новая система хранения появится в списке основных файловых хранилищ на **панели мониторинга**, а также станет доступной на страницах настроек основного файлового хранилища.

![Основное файловое хранилище Flurry-NAS на странице параметров управления основными файловыми хранилищами с развернутым представлением подробных сведений о файловом хранилище](media/fxt-cluster-config/core-filer-in-manage-page.png)

На этом снимке экрана у основного файлового хранилища отсутствует виртуальный сервер. Основное файловое хранилище необходимо связать с виртуальным сервером и создать точку соединения, чтобы клиенты получили доступ к хранилищу. Эти действия описаны далее в разделе [Настройка пространства имен](#configure-the-namespace).

## <a name="configure-the-namespace"></a>Настройка пространства имен

Кластер Azure FXT Edge Filer создает виртуальную файловую систему, которая именуется *пространством имен кластера* и позволяет клиентам удобно обращаться к данным, хранящимся в разных системах серверной части. Поскольку клиенты обращаются к файлам по виртуальному пути, системы хранения можно добавлять или заменять без изменения клиентского рабочего процесса.

Пространство имен кластера также позволяет представлять облака и системы хранения NAS в аналогичных файловых структурах.

Виртуальные серверы кластера поддерживают пространство имен и предоставляют содержимое клиентам. Для создания пространства имен кластера нужно выполнить два шага:

1. Создание виртуального сервера
1. настроить соединения между серверными системами хранения и путями в клиентской файловой системе.

### <a name="create-a-vserver"></a>Создание виртуального сервера

Виртуальные файловые серверы VServers управляют потоками данных между клиентом и основными файловыми системами кластера и выполняют такие задачи:

* содержат IP-адреса для взаимодействия с клиентами;
* создают пространство имен и определяют точки соединения, которые сопоставляют структуру виртуальных каталогов, предназначенных для клиентов, с процедурами экспорта в серверном хранилище;
* управляют доступом к файлам, в том числе применяют политики экспорта для основного файлового хранилища и системы проверки подлинности пользователей;
* предоставляют инфраструктуру SMB.

Прежде чем приступить к настройке виртуального сервера для кластера, ознакомьтесь с документацией по предоставленным ссылками и обсудите с представителем корпорации Майкрософт возможности пространства имен и виртуальных серверов. При использовании виртуальных локальных сетей их следует [создать](fxt-configure-network.md#adjust-network-settings) до того, как создавать виртуальный сервер.

В этих разделах руководства по настройке кластера вы познакомитесь с возможностями виртуального сервера FXT и глобального пространства имен:

* [Creating and Working with VServers](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/settings_overview.html#creating-and-working-with-vservers) (Создание виртуальных серверов и работа с ними);
* [Using a Global Namespace](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gns_overview.html) (Использование глобального пространства имен);
* [Creating a VServer](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_vserver_manage.html#creating-a-vserver) (Создание виртуального сервера).

Для кластера нужен по крайней мере один виртуальный сервер.

Чтобы создать виртуальный сервер, вам потребуются следующие сведения:

* Имя для виртуального сервера.

* Диапазон IP-адресов, через которые виртуальный сервер будет взаимодействовать с клиентами.

  При создании виртуального сервера необходимо указать один диапазон последовательных IP-адресов. Вы сможете позднее добавить новые адреса на странице параметров **сети для взаимодействия с клиентами**;

* Если в сети есть виртуальные локальные сети, нужно указать ту, которую будет использовать виртуальный сервер.

Используйте страницу параметров **VServer** (Виртуальный сервер) > **Manage VServers** (Управление виртуальными серверами), чтобы создать виртуальный сервер. Дополнительные сведения см. в [разделе о создании виртуального сервера](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_vserver_manage.html#creating-a-vserver) руководства по настройке кластера.

![Всплывающее окно создания виртуального сервера](media/fxt-cluster-config/new-vserver.png)

### <a name="create-a-junction"></a>Создание соединения

Карта *соединений* сопоставляет путь к серверному хранилищу с пространством имен, доступным для клиентов.

Вы можете использовать эту систему для упрощения пути, используемого в точках подключения клиентов, и для удобства масштабирования емкости, так как один виртуальный путь может поддерживать сразу несколько основных файловых хранилищ.

![Страница мастера нового соединения с заполненными параметрами](media/fxt-cluster-config/add-junction-full.png)

Изучите раздел [**VServer (Виртуальный сервер)** > **Namespace (Пространство имен)**](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/gui_namespace.html) руководства по настройке кластера, чтобы получить исчерпывающие сведения о создании соединения для пространства имен.

![Страница настроек VServer > Namespace (Виртуальный сервер > Пространство имен) со сведениями для соединения](media/fxt-cluster-config/namespace-populated.png)

## <a name="configure-export-rules"></a>Настройка правил экспорта

Когда будут готовы виртуальный сервер и основное файловое хранилище, следует настроить правила и политики экспорта, которые управляют доступом клиентов к файлам с помощью правил и политик экспорта основного файлового хранилища.

Во-первых, на странице **VServer** > **Export Rules** (Правила экспорта) добавьте новые правила, чтобы изменить политику по умолчанию, или создайте собственную политику экспорта.

Во-вторых, на странице **VServer** > **Export Policies** (Политики экспорта) примените настроенную политику к операциям экспорта основного файлового хранилища при доступе через этот виртуальный сервер.

Подробности см. в разделе [об управлении доступом к основному файловому хранилищу с помощью правил и политик экспорта](https://azure.github.io/Avere/legacy/ops_guide/4_7/html/export_rules_overview.html) руководства по настройке кластера.

## <a name="next-steps"></a>Дальнейшие действия

Завершив добавление хранилища и настройку пространства имен для взаимодействия с клиентами, завершите начальную настройку кластера. 

> [!div class="nextstepaction"]
> [Настройка параметров сети кластера](fxt-configure-network.md)
