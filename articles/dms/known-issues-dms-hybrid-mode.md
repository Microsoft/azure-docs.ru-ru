---
title: Известные проблемы и ограничения миграции с использованием гибридного режима
description: Узнайте об известных проблемах и ограничениях миграции с помощью Azure Database Migration Service в гибридном режиме.
services: database-migration
author: pochiraju
ms.author: rajpo
manager: craigg
ms.reviewer: craigg
ms.service: dms
ms.workload: data-services
ms.custom: mvc
ms.topic: troubleshooting
ms.date: 02/20/2020
ms.openlocfilehash: 819fe5ced6c91819c817065305a31fca456ea5c0
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "91291849"
---
# <a name="known-issuesmigration-limitations-with-using-hybrid-mode"></a>Известные проблемы и ограничения миграции с использованием гибридного режима

Известные проблемы и ограничения, связанные с использованием Azure Database Migration Service в гибридном режиме, описаны в следующих разделах.

## <a name="installer-fails-to-authenticate"></a>Установщик не проходит проверку подлинности

После отправки сертификата в Адапп для проверки подлинности в Azure может потребоваться задержка до нескольких минут. Установщик попытается повторить попытку с некоторой задержкой, но задержка распространения может быть больше, чем повторная попытка, и вы увидите сообщение **фаиледтожетакцесстокенексцептион** . Если сертификат был передан в правильный Адапп, а в dmsSettings.jsвключен правильный идентификатор AppId, попробуйте выполнить команду Install еще раз.

## <a name="service-offline-after-successful-installation"></a>Служба отключена после успешной установки

Если служба отображается как автономная после успешного завершения процесса установки, попробуйте выполнить следующие действия.

1. В портал Azure в экземпляре Azure Database Migration Service перейдите на вкладку **гибридные** параметры и убедитесь, что Рабочая роль зарегистрирована, проверив сетку зарегистрированных рабочих ролей.

    Состояние этого рабочего процесса должно быть в **сети**, но при наличии проблемы оно может отображаться как " **вне сети** ".

2. Проверьте состояние службы на рабочем компьютере, выполнив следующую команду PowerShell:

    ```
    Get-Service Scenario*
    ```

    Эта команда позволяет получить состояние службы Windows, выполняющей рабочую роль. Должен быть только один результат. Если Рабочая роль остановлена, можно попытаться перезапустить ее с помощью следующей команды PowerShell:

    ```
    Start-Service Scenario*
    ```

    Вы также можете проверить службу в пользовательском интерфейсе служб Windows.

3. Если служба Windows перезапускается между запуском и остановкой, то при запуске рабочей роли возникли проблемы. Проверьте Azure Database Migration Service журналы гибридных рабочих ролей, чтобы определить проблему.

    - Журналы процесса установки хранятся в папке Logs в папке, из которой был запущен исполняемый файл установщика.
    - Azure Database Migration Service журналы гибридных рабочих ролей хранятся в папке **воркерлогс** в папке, в которой установлена рабочая роль. По умолчанию файлы журналов гибридной рабочей роли находятся в папке **C:\Program филес\датабасемигратионсервицехибрид\воркерлогс**.

## <a name="using-your-own-signed-certificate"></a>Использование собственного подписанного сертификата

Сертификат, созданный действием Женератецерт, является самозаверяющим сертификатом, который может быть неприемлемым в зависимости от внутренних политик безопасности. Вместо использования этого сертификата можно указать собственный сертификат и предоставить отпечаток в dmsSettings.js. Этот сертификат необходимо отправить в Адапп и установить на компьютер, на котором вы устанавливаете Azure Database Migration Service гибридную рабочую роль. Затем установите этот сертификат с закрытым ключом в хранилище сертификатов локального компьютера.

## <a name="running-the-worker-service-as-a-low-privilege-account"></a>Запуск службы рабочей роли в качестве учетной записи с минимальными правами доступа

По умолчанию Azure Database Migration Service служба гибридной рабочей роли работает от имени учетной записи локальной системы. Учетную запись, используемую для этой службы, можно изменить, если используемая учетная запись имеет разрешения сети. Чтобы изменить учетную запись запуска от имени службы, используйте следующую процедуру.

1. Завершите работу службы либо с помощью служб Windows, либо с помощью команды Stop-Service в PowerShell.

2. Обновите службу, чтобы она использовала другую учетную запись входа.

3. В разделе certmgr для сертификатов локального компьютера предоставьте разрешения закрытого ключа для новой учетной записи для **ключа гибридного приложения DMS** и **пары ключей обработчика сценариев DMS** .

    а. Откройте certmgr, чтобы просмотреть следующие разделы:

    - Ключ гибридного приложения DMS
    - Ключ установки гибридной рабочей роли DMS
    - Пара ключей обработчика сценариев DMS

    b. Щелкните правой кнопкой мыши запись **ключа гибридного приложения DMS** , наведите указатель на пункт **все задачи**, а затем выберите **Управление закрытыми ключами**.

    c. На вкладке **Безопасность** выберите **Добавить**, а затем введите имя учетной записи.

    d. Используйте те же действия для предоставления разрешения на закрытый ключ для новой учетной записи в сертификат **пары ключей механизма сценария DMS** .

## <a name="unregistering-the-worker-manually"></a>Отмена регистрации рабочего процесса вручную

Если у вас больше нет доступа к рабочему компьютеру, можно отменить регистрацию рабочей роли и повторно использовать экземпляр Azure Database Migration Service, выполнив следующие действия:

1. В портал Azure получите экземпляр Azure Database Migration Service, а затем перейдите на страницу **гибридные** параметры.

   В списке появится запись о рабочем процессе, состояние которой отображается как **Автономная**.

2. В правом углу списка записи о работнике щелкните многоточие, а затем выберите отменить **регистрацию**.

## <a name="addressing-issues-for-specific-migration-scenarios"></a>Устранение проблем для конкретных сценариев миграции

В следующих разделах описываются вопросы, связанные с сценариями, которые относятся к использованию Azure Database Migration Service гибридного режима для выполнения оперативной миграции.

### <a name="online-migrations-to-azure-sql-managed-instance"></a>Оперативная миграция в Azure SQL Управляемый экземпляр

**Высокая загрузка ЦП**

**Ошибка**. для оперативной миграции на SQL управляемый экземпляр компьютер, на котором работает гибридная Рабочая роль, будет столкнуться с высокой загрузкой ЦП, если слишком много резервных копий или если резервные копии слишком велики.

**Устранение**. чтобы устранить эту ошибку, используйте сжатые резервные копии, разделите миграцию так, чтобы она использовала несколько общих ресурсов, или увеличьте масштаб компьютера, на котором выполняется Гибридная Рабочая роль.
