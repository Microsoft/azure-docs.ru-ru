---
title: Разработка защищенных приложений в Azure | Документация Майкрософт
description: В этой статье даются рекомендации для этапов реализации и проверки проекта веб-приложения.
author: TerryLanfear
manager: barbkess
ms.author: terrylan
ms.date: 06/12/2019
ms.topic: article
ms.service: security
ms.subservice: security-develop
services: azure
ms.assetid: 521180dc-2cc9-43f1-ae87-2701de7ca6b8
ms.devlang: na
ms.tgt_pltfrm: na
ms.workload: na
ms.openlocfilehash: 52c93bef4529f27ad38677f17209e7b48e997368
ms.sourcegitcommit: 7edadd4bf8f354abca0b253b3af98836212edd93
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/10/2021
ms.locfileid: "102548450"
---
# <a name="develop-secure-applications-on-azure"></a>Разработка защищенных приложений в Azure
В этой статье представлены действия по обеспечению безопасности и элементы управления безопасностью, которые следует учитывать при разработке приложений для облака. В статье рассматриваются вопросы и концепции безопасности, которые следует учитывать на этапах реализации и проверки [жизненного цикла разработки защищенных приложений (Майкрософт)](/previous-versions/windows/desktop/cc307891(v=msdn.10)) (SDL). Ее цель — помочь вам определить действия и службы Azure, которые можно использовать для разработки хорошо защищенного приложения.

В этой статье описаны следующие этапы SDL:

- Реализация
- Проверка

## <a name="implementation"></a>Реализация
Основное внимание на этапе реализации нужно уделить внедрению лучших методик для предотвращения проблем, связанных с безопасностью, обнаружения таких проблем и устранения их из кода.
Всегда учитывайте вероятность того, что ваше приложение будет использоваться непредусмотренным вами образом. Это поможет предотвратить случайное или намеренное использование вашего приложения ненадлежащим образом.

### <a name="perform-code-reviews"></a>Выполнение проверок кода

Перед фиксацией изменений в коде выполняйте [его проверку](/azure/devops/learn/devops-at-microsoft/code-reviews-not-primarily-finding-bugs), чтобы повысить общее качество и снизить риск возникновения ошибок. Для управления процессом проверки кода можно использовать [Visual Studio](/azure/devops/repos/tfvc/get-code-reviewed-vs).

### <a name="perform-static-code-analysis"></a>Статический анализ кода

Проверка кода обычно предусматривает [статический анализ кода](https://owasp.org/www-community/controls/Static_Code_Analysis), также известный как *анализ исходного кода*. Под статическим анализом кода обычно понимается запуск средств статического анализа кода для поиска потенциальных уязвимостей в коде без его выполнения. Используются такие методы, как [taint-анализ](https://en.wikipedia.org/wiki/Taint_checking) и [анализ потока данных](https://en.wikipedia.org/wiki/Data-flow_analysis).

Azure Marketplace предлагает [инструменты разработчика](https://azuremarketplace.microsoft.com/marketplace/apps/category/developer-tools?page=1&search=code%20review), которые выполняют статический анализ кода и помогают с проверкой кода.

### <a name="validate-and-sanitize-every-input-for-your-application"></a>Проверка и очистка всех входных данных для приложения

Рассматривайте все входные данные как ненадежные, чтобы защитить приложение от наиболее распространенных уязвимостей веб-приложений. Ненадежные данные могут использовать злоумышленники для атак путем внедрения кода. Ко входным данным приложения относятся параметры в URL-адресе, ввод пользователя, данные из базы данных или из API, а также все передаваемые данные, на которые может повлиять пользователь. Приложение должно [проверить](https://owasp.org/www-project-proactive-controls/v3/en/c5-validate-inputs) синтаксическую и семантическую допустимость данных, прежде чем использовать их каким-либо способом (включая вывод обратно пользователю).

Выполняйте проверку входных данных на раннем этапе потока данных, чтобы только правильно сформированные данные попадали в рабочий процесс. Нельзя допускать, чтобы неправильно сформированные данные были сохранены в базе данных или привели к неисправности в компоненте на последующем этапе.

Добавление и алловлистинг — это два общих подхода к проверке синтаксиса входных данных:

  - Добавление пытается проверить, что введенные пользователем данные не содержат "известное вредоносное" содержимое.

  - Алловлистинг пытается проверить, соответствует ли введенные пользователем данные набору "известных хороших" входных данных. Символьная алловлистинг — это форма алловлистинг, где приложение проверяет, содержит ли введенные пользователем данные только «известные хорошие» символы или что входные данные соответствуют известному формату.
    Например, с его помощью можно проверить, содержит ли имя пользователя только буквенно-цифровые символы или содержит ли оно ровно две цифры.

Алловлистинг является предпочтительным подходом для создания безопасного программного обеспечения.
Добавление подвержена ошибкам, так как невозможно представить полный список потенциально недопустимых входных данных.

Выполняйте эту работу на сервере, а не на стороне клиента (или и на сервере, и на стороне клиента).

### <a name="verify-your-applications-outputs"></a>Проверка выходных данных приложения

Любые выходные данные, представленные визуально или в документе, обязательно должны быть закодированы и экранированы. [Экранирование](https://owasp.org/www-community/Injection_Theory#Escaping_.28aka_Output_Encoding.29), также называемое *кодировкой вывода*, используется для того, чтобы данные, которые не являются доверенными, нельзя было использовать в качестве транспорта для атаки путем внедрения. Экранирование в сочетании с проверкой данных обеспечивает многоуровневую защиту для повышения безопасности системы в целом.

Экранирование гарантирует, что все будет отображается как *выходные данные*. Экранирование также указывает интерпретатору, что данные не предназначены для выполнения, и это предотвращает срабатывание атак. Это еще один распространенный способ атаки, который называется *межсайтовый скриптинг* (XSS).

Если вы используете веб-платформу стороннего производителя, вы можете проверить параметры кодировки для вывода на веб-сайтах с помощью [памятки OWASP по предотвращению межсайтового скриптинга](https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md).

### <a name="use-parameterized-queries-when-you-contact-the-database"></a>Использование параметризованных запросов при обращении к базе данных

Никогда не создавайте запрос к встроенной базе данных динамически в коде с последующей отправкой непосредственно в базу данных. Вредоносный код, вставленный в приложение, может привести к краже, очистке или изменению базы данных. Приложение также может быть использовано для запуска вредоносных команд операционной системы в ОС, в которой размещена ваша база данных.

Вместо этого используйте параметризованные запросы или хранимые процедуры. При использовании параметризованных запросов можно безопасно вызывать процедуру из кода и передавать ей строку, не беспокоясь о том, что она будет рассматриваться как часть инструкции запроса.

### <a name="remove-standard-server-headers"></a>Удаление стандартных заголовков сервера

Такие заголовки, как Server, X-Powered-By и X-AspNet-Version, раскрывают сведения о сервере и базовых технологиях. Рекомендуется подавлять эти заголовки, чтобы предотвратить возможность создания отпечатка приложения.
См. запись блога об [удалении стандартных заголовков серверов на веб-сайтах Azure](https://azure.microsoft.com/blog/removing-standard-server-headers-on-windows-azure-web-sites/).

### <a name="segregate-your-production-data"></a>Обособление производственных данных

Производственные ("рабочие") данные не следует использовать при разработке, тестировании и в каких-либо других целях, не связанных с рабочими процессами. Для всех работ по разработке и тестированию нужно использовать маскированный ([анонимизированный](https://en.wikipedia.org/wiki/Data_anonymization)) набор данных.

Тогда у меньшего количества людей будет доступ к рабочим данным, что сокращает возможности для атак. При этом будет также ограничен доступ к персональным данным, что устраняет потенциальную брешь в конфиденциальности.

### <a name="implement-a-strong-password-policy"></a>Применение политики надежных паролей

Для защиты от атак методом прямого подбора и перебора по словарю реализуйте политику надежных паролей, чтобы пользователи создавали сложные пароли (например, длиной не менее 12 символов, а также содержащие алфавитно-цифровые и специальные символы).

Для создания и применения политик паролей можно использовать платформу удостоверений. Azure AD B2C помогает управлять паролями, предоставляя [встроенные политики](../../active-directory-b2c/tutorial-create-user-flows.md#create-a-password-reset-user-flow), функцию [самостоятельного сброса пароля](../../active-directory-b2c/user-flow-self-service-password-reset.md) и другие возможности.

Чтобы обеспечить защиту от атак на учетные записи по умолчанию, все ключи и пароли должны быть заменяемыми. Кроме того, их нужно создавать или заменять после установки ресурсов.

Если приложению нужно создавать пароли автоматически, они должны создаваться случайным образом и иметь высокий уровень энтропии.

### <a name="validate-file-uploads"></a>Проверка передаваемых файлов

Если приложение позволяет [передавать файлы](https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload), предусмотрите меры для этого небезопасного действия. Первый шаг при многих атаках заключается во внедрении вредоносного кода в атакуемую систему. Злоумышленник может сделать это при передаче файла. OWASP предлагает решения для проверки файла, определяющие безопасность передаваемых файлов.

Антивредоносные программы помогают обнаруживать и удалять вирусы, шпионские и другие вредоносные программы. Вы можете установить [Microsoft Antimalware](../fundamentals/antimalware.md) или решение от партнеров Майкрософт для защиты конечных точек ([Trend Micro](https://www.trendmicro.com/azure/), [Symantec](https://www.broadcom.com/products), [McAfee](https://www.mcafee.com/us/products.aspx), [Защитник Windows](/windows/security/threat-protection/windows-defender-antivirus/windows-defender-antivirus-in-windows-10) и [Endpoint Protection](/configmgr/protect/deploy-use/endpoint-protection)).

[Microsoft Antimalware](../fundamentals/antimalware.md) обладает такими возможностями, как обеспечение защиты в реальном времени, плановое сканирование, исправление вредоносных действий, обновление подписей, обновление модуля защиты, отправка образцов и сбор событий исключения. Для упрощения развертывания и использования встроенных обнаружений (оповещений и инцидентов) антивредоносное ПО Майкрософт и партнерские решения можно интегрировать с [центром безопасности Azure](../../security-center/security-center-partner-integration.md).

### <a name="dont-cache-sensitive-content"></a>Не кэшируйте конфиденциальное содержимое

Не кэшируйте конфиденциальное содержимое в браузере. Браузеры могут сохранять информацию для кэширования и ведения истории. Кэшированные файлы хранятся в папке, подобной папке временных файлов Интернета в Internet Explorer. При повторном обращении к страницам браузер отображает их из кэша. Если конфиденциальные сведения (например, адреса, данные кредитной карты, номер социального страхования или имя пользователя) демонстрируется пользователю, эта информация может быть сохранена в кэше браузера, а значит ее можно получить путем проверки кэша браузера или просто нажатием кнопки **Назад** в браузере.

## <a name="verification"></a>Проверка
Этап проверки включает в себя комплекс мер по обеспечению соответствия кода принципам безопасности и конфиденциальности, которые были установлены на предыдущих этапах.

### <a name="find-and-fix-vulnerabilities-in-your-application-dependencies"></a>Поиск и устранение уязвимостей в зависимостях приложения

Вам нужно просканировать приложение и его зависимые библиотеки для обнаружения компонентов с известными уязвимостями. Для выполнения этой проверки можно использовать такие продукты, как [OWASP Dependency Check](https://www.owasp.org/index.php/OWASP_Dependency_Check),[Snyk](https://snyk.io/) и [Black Duck](https://www.blackducksoftware.com/).

Для веб-приложений Службы приложений Azure доступно сканирование уязвимостей на базе [Tinfoil Security](https://www.tinfoilsecurity.com/). [Сканирование Tinfoil Security через Службу приложений](https://azure.microsoft.com/blog/web-vulnerability-scanning-for-azure-app-service-powered-by-tinfoil-security/) предоставляет разработчикам и администраторам быстрые, интегрированные и экономичные средства обнаружения и устранения уязвимостей до того, как злоумышленник сможет их использовать.

> [!NOTE]
> Также можно [интегрировать Tinfoil Security с Azure AD](../../active-directory/saas-apps/tinfoil-security-tutorial.md). Интеграция Tinfoil Security с Azure AD имеет следующие преимущества:
>  - С помощью Azure AD вы можете контролировать, у кого есть доступ к приложению Tinfoil Security.
>  - Вы можете включить автоматический вход для пользователей (единый вход) в Tinfoil Security с помощью их учетных записей Azure AD.
>  - Вы можете управлять учетными записями централизованно на портале Azure.

### <a name="test-your-application-in-an-operating-state"></a>Тестирование приложения в рабочем состоянии

Динамическое тестирование безопасности приложений (DAST) — это процесс тестирования приложения в рабочем состоянии для поиска уязвимостей системы безопасности. Средства DAST анализируют программы во время их выполнения для поиска уязвимостей системы безопасности, таких как повреждение памяти, незащищенная конфигурация сервера, межсайтовый скриптинг, проблемы с разрешениями пользователей, внедрение кода SQL и другие критически важные аспекты безопасности.

DAST отличается от статического тестирования безопасности приложений (SAST). Средства SAST анализируют исходный код или скомпилированные версии кода на наличие изъянов безопасности в то время, когда он не выполняется.

DAST рекомендуется выполнять при участии специалиста по вопросам безопасности ([пентестера](../fundamentals/pen-testing.md) или оценщика уязвимостей). Если это невозможно, вы можете самостоятельно выполнить DAST с помощью сканера веб-прокси, освоив некоторые приемы. Подключите сканер DAST на ранних этапах, чтобы не допустить возникновения очевидных проблем безопасности в коде. Список сканеров уязвимостей веб-приложений см. на веб-сайте [OWASP](https://owasp.org/www-community/Vulnerability_Scanning_Tools).

### <a name="perform-fuzz-testing"></a>Нечеткое тестирование

При [нечетком тестировании](https://cloudblogs.microsoft.com/microsoftsecure/2007/09/20/fuzz-testing-at-microsoft-and-the-triage-process/) вы вызываете сбой программы, намеренно предоставляя приложению неправильно сформированные или случайные данные. Вызов сбоя программы позволяет выявить потенциальные проблемы безопасности до выпуска приложения.

[Security Risk Detection](https://www.microsoft.com/en-us/security-risk-detection/) — это уникальная служба нечеткого тестирования Майкрософт, предназначенная для поиска критических с точки зрения безопасности ошибок в программном обеспечении.

### <a name="conduct-attack-surface-review"></a>Проверка поверхности атаки

Проверка поверхности атаки после завершения написания кода позволяет учесть все изменения в архитектуре или реализации приложения или системы. Она помогает гарантировать, что все новые векторы атак, созданные в результате изменений, включая модели угроз, прошли проверку, а связанные с ними риски были устранены.

Вы можете определить поверхность атаки путем сканирования приложения. Корпорация Майкрософт предлагает средство анализа поверхности атаки под названием [Attack Surface Analyzer](https://www.microsoft.com/download/details.aspx?id=58105). Вы можете выбрать одно из многих коммерческих средств динамического тестирования и сканирования уязвимостей, включая [OWASP Zed Attack Proxy Project](https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project), [Arachni](http://arachni-scanner.com/), [Skipfish](https://code.google.com/p/skipfish/) и [w3af](http://w3af.sourceforge.net/). Эти средства сканируют приложение и определяют, какие его части доступны через Интернет. Вы также можете выполнить поиск аналогичных [средств для разработчиков в Azure Marketplace](https://azuremarketplace.microsoft.com/marketplace/apps/category/developer-tools?page=1).

### <a name="perform-security-penetration-testing"></a>Тесты на проникновение

Защита приложения так же важна, как и тестирование любых других функций. Сделайте [тесты на проникновение](../fundamentals/pen-testing.md) стандартной частью процесса сборки и развертывания. Планируйте регулярные тесты на проникновение и сканирование уязвимостей в развернутых приложениях, а также мониторинг открытых портов, конечных точек и атак.

### <a name="run-security-verification-tests"></a>Тесты проверки безопасности

[Secure DevOps Kit for Azure](https://azsk.azurewebsites.net/index.html) (AzSK) содержит тесты проверки безопасности для нескольких служб платформы Azure. Запускайте эти тесты время от времени, чтобы гарантировать защиту подписки Azure и других ресурсов, обеспечивающих работу приложения. Эти тесты также можно автоматизировать с помощью расширений AzSK для непрерывной интеграции и непрерывного развертывания (CI/CD), что позволяет выполнять эти тесты с помощью расширения для Visual Studio.

## <a name="next-steps"></a>Дальнейшие действия
В следующих статьях представлены элементы управления безопасностью и действия, которые рекомендуется использовать при проектировании и развертывании защищенных приложений.

- [Проектирование защищенных приложений](secure-design.md)
- [Развертывание защищенных приложений](secure-deploy.md)