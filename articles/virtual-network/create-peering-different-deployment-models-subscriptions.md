---
title: Создание пиринга виртуальных сетей Azure с разными моделями развертывания в разных подписках
titlesuffix: Azure Virtual Network
description: Узнайте, как создать пиринг между виртуальными сетями, созданными с помощью разных моделей развертывания Azure, которые существуют в разных подписках Azure.
services: virtual-network
documentationcenter: ''
author: KumudD
ms.service: virtual-network
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/25/2020
ms.author: kumud
ms.reviewer: anavin
ms.openlocfilehash: 29a64931ac92eacf8948ae067118b6b25198c85d
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "98223471"
---
# <a name="create-a-virtual-network-peering---different-deployment-models-and-subscriptions"></a>Создание пиринга виртуальных сетей с разными моделями развертывания в разных подписках

В этом руководстве вы узнаете, как создать пиринг между виртуальными сетями, созданными с помощью разных моделей развертывания. Эти виртуальные сети находятся в разных подписках. Установление пиринга между двумя виртуальными сетями позволяет ресурсам в разных виртуальных сетях взаимодействовать друг с другом с такими же пропускной способностью и задержкой, как если бы эти ресурсы находились в одной виртуальной сети. Узнайте больше о [пиринге виртуальных сетей](virtual-network-peering-overview.md).

Действия по созданию пиринга виртуальных сетей зависят от того, находятся ли виртуальные сети в одной или разных подписках, и того, какая [модель развертывания Azure](../azure-resource-manager/management/deployment-models.md?toc=%2fazure%2fvirtual-network%2ftoc.json) использовалась для их создания. Узнайте, как создать пиринг виртуальных сетей в других сценариях, щелкнув сценарий в следующей таблице.

|Модель развертывания Azure  | Подписка Azure.  |
|--------- |---------|
|[Обе Resource Manager](tutorial-connect-virtual-networks-portal.md) |Аналогично|
|[Обе Resource Manager](create-peering-different-subscriptions.md) |Разные|
|[Одна виртуальная сеть Resource Manager, одна классическая виртуальная сеть](create-peering-different-deployment-models.md) |Аналогично|

Невозможно создать пиринг между двумя виртуальными сетями, созданными с помощью классической модели развертывания. В этом руководстве используются виртуальные сети, существующие в одном и том же регионе. Это руководство по созданию пиринга между виртуальными сетями в одном регионе. Пиринг можно создавать между виртуальными сетями в разных [поддерживаемых регионах](virtual-network-manage-peering.md#cross-region). Рекомендуется ознакомиться с [требованиями и ограничениями пиринга](virtual-network-manage-peering.md#requirements-and-constraints) перед созданием пиринга виртуальных сетей.

При создании пиринга между виртуальными сетями, которые существуют в разных подписках, подписки могут быть связаны с одним и тем же клиентом Azure Active Directory. Если у вас еще нет клиента Azure Active Directory, можно быстро [создать его](../active-directory/develop/quickstart-create-new-tenant.md?toc=%2fazure%2fvirtual-network%2ftoc.json#create-a-new-azure-ad-tenant).

Для создания пиринга виртуальных сетей можно использовать [портал Azure](#portal), [интерфейс командной строки](#cli) Azure (Azure CLI) или Azure [PowerShell](#powershell). Щелкните любую из предыдущих ссылок на инструмент, чтобы перейти непосредственно к инструкциям по созданию пиринга виртуальных сетей с помощью выбранного инструмента.

## <a name="create-peering---azure-portal"></a><a name="portal"></a>Создание пиринга с помощью портала Azure

В этом руководстве используются разные учетные записи для каждой подписки. Если вы используете учетную запись, имеющую разрешения для обеих подписок, то можете использовать эту учетную запись для всех действий. Пропустите выход с портала и назначение разрешений еще одного пользователя для виртуальных сетей.

1. Войдите в [портал Azure](https://portal.azure.com) как пользователь a. У учетной записи, используемой для входа, должны быть необходимые разрешения для создания пиринга виртуальных сетей. Список разрешений см. в разделе [Создание, изменение и удаление пиринга в виртуальной сети](virtual-network-manage-peering.md#permissions).
2. Щелкните **+ Создать**, выберите **Сети** и щелкните **Виртуальная сеть**.
3. В колонке **Создание виртуальной сети** введите или выберите значения для приведенных ниже параметров и щелкните **Создать**.
    - **Имя**: *myVnetA*.
    - **Диапазон адресов**: *10.0.0.0/16*.
    - **Имя подсети**: *по умолчанию*.
    - **Диапазон адресов подсети**: *10.0.0.0/24*.
    - **Подписка**: выберите подписку A.
    - **Группа ресурсов.** выберите **Создать новую**, а затем введите *myResourceGroupA*.
    - **Расположение.** *восточная часть США*.
4. В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetA*. Когда сеть **myVnetA** появится в результатах поиска, щелкните ее. Отобразится колонка для виртуальной сети **myVnetA**.
5. В вертикальном списке параметров в левой части отобразившейся колонки **myVnetA** щелкните **Управление доступом (IAM)**.
6. В открывшейся колонке **myVnetA — управление доступом (IAM)** щелкните **+Добавить назначение роли**.
7. В отобразившейся колонке **Добавление назначение роли** в поле **Роль** выберите **Участник сетей**.
8. В поле **выбрать** выберите пользователя b или введите адрес электронной почты пользователя b, чтобы найти его. Отобразится список пользователей из того же клиента Azure Active Directory, с которым связана виртуальная сеть, с которой вы устанавливаете пиринг. Щелкните пользователя B, когда он появится в списке.
9. Выберите команду **Сохранить**.
10. Выйдите с портала как пользователь A, а затем войдите как пользователь B.
11. Щелкните **+ Создать**, введите *Виртуальная сеть* в поле **Поиск по Marketplace**, а затем щелкните **Виртуальная сеть** в результатах поиска.
12. В открывшейся колонке **Виртуальная сеть** в поле **Выбор модели развертывания** выберите **Классический** и нажмите кнопку **Создать**.
13. В отобразившейся колонке "Создание виртуальной сети (классической)" введите приведенные ниже значения.

    - **Имя**: *myVnetB*.
    - **Диапазон адресов**: *10.1.0.0/16*.
    - **Имя подсети**: *по умолчанию*.
    - **Диапазон адресов подсети**: *10.1.0.0/24*.
    - **Подписка**: выберите подписку B.
    - **Группа ресурсов.** выберите **Создать новую**, а затем введите *myResourceGroupB*.
    - **Расположение.** *восточная часть США*.

14. В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetB*. Когда сеть **myVnetB** появится в результатах поиска, щелкните ее. Отобразится колонка для виртуальной сети **myVnetB**.
15. В вертикальном списке параметров в левой части отобразившейся колонки **myVnetB** щелкните **Свойства**. Скопируйте **Идентификатор ресурса**, он понадобится нам позже. Идентификатор ресурса аналогичен приведенному ниже примеру. `/subscriptions/<Subscription ID>/resourceGroups/myResourceGroupB/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB`
16. Выполните шаги 5–9 для myVnetB, указав **пользователя A** на шаге 8.
17. Выйдите с портала как пользователь B, а затем войдите как пользователь A.
18. В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetA*. Когда сеть **myVnetA** появится в результатах поиска, щелкните ее. Отобразится колонка для виртуальной сети **myVnetA**.
19. Щелкните **myVnetA**.
20. В вертикальном списке параметров в левой части отобразившейся колонки **myVnetA** щелкните **Пиринги**.
21. В открывшейся колонке **myVnetA — пиринги** щелкните **+ Добавить**.
22. В открывшейся колонке **Добавить пиринг** введите или выберите значения приведенных ниже параметров, после чего нажмите кнопку **ОК**.
     - **Имя**: *myVnetAToMyVnetB*.
     - **Модель развертывания виртуальной сети**: выберите **Классический**.
     - **Я знаю идентификатор ресурса**: установите этот флажок.
     - **Идентификатор ресурса**: введите идентификатор ресурса myVnetB, скопированный на шаге 15.
     - **Разрешить доступ к виртуальным сетям**: выберите значение **Включено**.
    Другие параметры в этом руководстве не используются. Чтобы узнать о всех параметрах пиринга, прочитайте раздел [Создание, изменение и удаление пиринга в виртуальной сети](virtual-network-manage-peering.md#create-a-peering).
23. После нажатия кнопки **ОК** на предыдущем шаге колонка **Добавить пиринг** закроется, и вы снова увидите колонку **myVnetA — пиринги**. Через несколько секунд созданный пиринг отобразится в этой колонке. В столбце **Состояние пиринга** для созданного пиринга **myVnetAToMyVnetB** указано состояние **Подключено**. Пиринг установлен. Нет необходимости создавать пиринг между классической виртуальной сетью и виртуальной сетью Resource Manager.

    Теперь все ресурсы Azure, созданные в любой из виртуальных сетей, могут взаимодействовать друг с другом, используя свои IP-адреса. Если вы используете разрешение имен Azure по умолчанию для виртуальных сетей, то ресурсы в этих виртуальных сетях не смогут разрешать имена между виртуальными сетями. Если требуется разрешение имен между виртуальными сетями в пиринге, необходимо создать собственный DNS-сервер. Узнайте, как настроить [разрешение имен с помощью собственного DNS-сервера](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-that-uses-your-own-dns-server).

24. **Необязательно**: хотя в этом руководстве не рассматривается создание виртуальных машин, можно создать по виртуальной машине в каждой виртуальной сети и подключить эти виртуальные машины друг к другу, чтобы проверить связь.
25. **Необязательно**: чтобы удалить ресурсы, созданные при работе с этим руководством, выполните инструкции, описанные в разделе [Удаление ресурсов](#delete-portal) этой статьи.

## <a name="create-peering---azure-cli"></a><a name="cli"></a>Создание пиринга с помощью Azure CLI

В этом руководстве используются разные учетные записи для каждой подписки. Если вы используете учетную запись, имеющую разрешения для обеих подписок, то можете использовать эту учетную запись для всех действий. Пропустите выход из Azure и удалите строки сценария, назначающие роли пользователей. Замените UserA@azure.com и UserB@azure.com во всех следующих сценариях именами пользователей, которые вы используете для пользователей A и B. Выполните следующие действия с помощью классического интерфейса командной строки Azure и Azure CLI. Действия из Azure Cloud Shell можно выполнить, только выбрав кнопку **Попробовать** в любом из следующих действий или установив [классический интерфейс командной строки](/cli/azure/install-classic-cli) и [CLI](/cli/azure/install-azure-cli) и выполнив команды на локальном компьютере.

1. При использовании Cloud Shell перейдите к шагу 2, так как Cloud Shell выполняет автоматический вход Azure. Запустите сеанс командной строки и войдите в Azure с помощью команды `azure login`.
2. Запустите классический интерфейс командной строки в режиме управления службами, введя команду `azure config mode asm`.
3. Чтобы создать классическую виртуальную сеть, введите приведенную ниже команду классического интерфейса командной строки.

    ```console
    azure network vnet create --vnet myVnetB --address-space 10.1.0.0 --cidr 16 --location "East US"
    ```

4. Остальные действия необходимо выполнить с помощью оболочки bash и Azure CLI (а не классического интерфейса командной строки).
5. Скопируйте следующий сценарий в текстовый редактор на своем компьютере. Замените `<SubscriptionB-Id>` идентификатором своей подписки. Если вам неизвестен идентификатор подписки, введите команду `az account show`. Значением **идентификатора** в выходных данных является идентификатор подписки. Скопируйте измененный сценарий, вставьте его в сеанс интерфейса командной строки и нажмите клавишу `Enter` .

    ```azurecli-interactive
    az role assignment create \
      --assignee UserA@azure.com \
      --role "Classic Network Contributor" \
      --scope /subscriptions/<SubscriptionB-Id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB
    ```

    На шаге 4 платформа Azure создала классическую виртуальную сеть в группе ресурсов *Default-Networking*.
6. Выйдите из Azure как пользователь B, затем войдите в Azure CLI как пользователь A.
7. Создайте группу ресурсов и виртуальную сеть Resource Manager. Скопируйте следующий сценарий, вставьте его в окно сеанса интерфейса командной строки и нажмите клавишу `Enter`.

    ```azurecli-interactive
    #!/bin/bash

    # Variables for common values used throughout the script.
    rgName="myResourceGroupA"
    location="eastus"

    # Create a resource group.
    az group create \
      --name $rgName \
      --location $location

    # Create virtual network A (Resource Manager).
    az network vnet create \
      --name myVnetA \
      --resource-group $rgName \
      --location $location \
      --address-prefix 10.0.0.0/16

    # Get the id for myVnetA.
    vNetAId=$(az network vnet show \
      --resource-group $rgName \
      --name myVnetA \
      --query id --out tsv)

    # Assign UserB permissions to myVnetA.
    az role assignment create \
      --assignee UserB@azure.com \
      --role "Network Contributor" \
      --scope $vNetAId
    ```

8. Создайте пиринг между двумя виртуальными сетями, созданными с помощью разных моделей развертывания. Скопируйте следующий сценарий в текстовый редактор на своем компьютере. Замените `<SubscriptionB-id>` идентификатором своей подписки. Если вы не узнаете идентификатор подписки, введите `az account show` команду. Значение **ID** в выходных данных — это идентификатор подписки. Azure создал виртуальную сеть (классическая модель), созданную на шаге 4 в группе ресурсов с именем *по умолчанию — Networking*. Вставьте измененный сценарий в окно сеанса интерфейса командной строки и нажмите клавишу `Enter`.

    ```azurecli-interactive
    # Peer VNet1 to VNet2.
    az network vnet peering create \
      --name myVnetAToMyVnetB \
      --resource-group $rgName \
      --vnet-name myVnetA \
      --remote-vnet-id  /subscriptions/<SubscriptionB-id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB \
      --allow-vnet-access
    ```

9. После выполнения сценария просмотрите сведения о пиринге виртуальной сети Resource Manager. Скопируйте следующий сценарий и вставьте его в сеанс интерфейса командной строки.

    ```azurecli-interactive
    az network vnet peering list \
      --resource-group $rgName \
      --vnet-name myVnetA \
      --output table
    ```

    В выходных данных в столбце **PeeringState** (Состояние пиринга) указано состояние **Connected** (Подключен).

    Теперь все ресурсы Azure, созданные в любой из виртуальных сетей, могут взаимодействовать друг с другом, используя свои IP-адреса. Если вы используете разрешение имен Azure по умолчанию для виртуальных сетей, то ресурсы в этих виртуальных сетях не смогут разрешать имена между виртуальными сетями. Если требуется разрешение имен между виртуальными сетями в пиринге, необходимо создать собственный DNS-сервер. Узнайте, как настроить [разрешение имен с помощью собственного DNS-сервера](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-that-uses-your-own-dns-server).

10. **Необязательно**: хотя в этом руководстве не рассматривается создание виртуальных машин, можно создать по виртуальной машине в каждой виртуальной сети и подключить эти виртуальные машины друг к другу, чтобы проверить связь.
11. **Необязательно**: чтобы удалить ресурсы, созданные при работе с этим руководством, выполните инструкции, описанные в разделе [Удаление ресурсов](#delete-cli) этой статьи.

## <a name="create-peering---powershell"></a><a name="powershell"></a>Создание пиринга с помощью PowerShell

В этом руководстве используются разные учетные записи для каждой подписки. Если вы используете учетную запись, имеющую разрешения для обеих подписок, то можете использовать эту учетную запись для всех действий. Пропустите выход из Azure и удалите строки сценария, назначающие роли пользователей. Замените UserA@azure.com и UserB@azure.com во всех следующих сценариях именами пользователей, которые вы используете для пользователей A и B. 

1. Установите последнюю версию модулей PowerShell [Azure](https://www.powershellgallery.com/packages/Azure) и [AZ](https://www.powershellgallery.com/packages/Az) . Если вы еще не работали с Azure PowerShell, ознакомьтесь со статьей [Overview of Azure PowerShell](/powershell/azure/?toc=%2fazure%2fvirtual-network%2ftoc.json) (Общие сведения об Azure PowerShell).
2. Запустите сеанс PowerShell.
3. В PowerShell войдите в подписку пользователя B от имени этого пользователя, введя команду `Add-AzureAccount`. У учетной записи, используемой для входа, должны быть необходимые разрешения для создания пиринга виртуальных сетей. Список разрешений см. в разделе [Создание, изменение и удаление пиринга в виртуальной сети](virtual-network-manage-peering.md#permissions).
4. Чтобы создать классическую виртуальную сеть с помощью PowerShell, необходимо создать новый или изменить существующий файл конфигурации сети. Узнайте, как [экспортировать, обновлять и импортировать файлы конфигурации сети](/previous-versions/azure/virtual-network/virtual-networks-using-network-configuration-file). Файл должен содержать приведенный ниже элемент **VirtualNetworkSite** для виртуальной сети, используемой в этом руководстве.

    ```xml
    <VirtualNetworkSite name="myVnetB" Location="East US">
      <AddressSpace>
        <AddressPrefix>10.1.0.0/16</AddressPrefix>
      </AddressSpace>
      <Subnets>
        <Subnet name="default">
          <AddressPrefix>10.1.0.0/24</AddressPrefix>
        </Subnet>
      </Subnets>
    </VirtualNetworkSite>
    ```

    > [!WARNING]
    > Импорт измененного файла конфигурации сети может привести к изменениям в классических виртуальных сетях в вашей подписке. Убедитесь, что вы добавили только указанную выше виртуальную сеть и не изменили или удалили имеющиеся в своей подписке виртуальные сети. 

5. Войдите в подписку пользователя B от имени этого пользователя для выполнения команд Resource Manager, введя команду `Connect-AzAccount`.
6. Назначьте разрешения пользователя A виртуальной сети myVnetB. Скопируйте приведенный ниже сценарий в текстовый редактор на своем компьютере и замените `<SubscriptionB-id>` идентификатором подписки B. Если вам неизвестен этот идентификатор подписки, введите команду `Get-AzSubscription`, чтобы просмотреть его. Значение **Id** (Идентификатор) в полученных выходных данных является идентификатором вашей подписки. На шаге 4 платформа Azure создала вашу классическую виртуальную сеть в группе ресурсов *Default-Networking*. Чтобы выполнить сценарий, скопируйте измененный сценарий, вставьте его в окно сеанса PowerShell и нажмите клавишу `Enter`.

    ```powershell
    New-AzRoleAssignment `
      -SignInName UserA@azure.com `
      -RoleDefinitionName "Classic Network Contributor" `
      -Scope /subscriptions/<SubscriptionB-id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB
    ```

7. Выйдите из Azure как пользователь B и войдите в подписку пользователя A от имени пользователя A, введя команду `Connect-AzAccount`. У учетной записи, используемой для входа, должны быть необходимые разрешения для создания пиринга виртуальных сетей. Список разрешений см. в разделе [Создание, изменение и удаление пиринга в виртуальной сети](virtual-network-manage-peering.md#permissions).
8. Создайте виртуальную сеть Resource Manager, скопировав следующий сценарий, вставив его PowerShell и нажав клавишу `Enter`.

    ```powershell
    # Variables for common values
      $rgName='MyResourceGroupA'
      $location='eastus'

    # Create a resource group.
    New-AzResourceGroup `
      -Name $rgName `
      -Location $location

    # Create virtual network A.
    $vnetA = New-AzVirtualNetwork `
      -ResourceGroupName $rgName `
      -Name 'myVnetA' `
      -AddressPrefix '10.0.0.0/16' `
      -Location $location
    ```

9. Назначьте разрешения пользователя B виртуальной сети myVnetA. Скопируйте приведенный ниже сценарий в текстовый редактор на своем компьютере и замените `<SubscriptionA-Id>` идентификатором подписки A. Если вам неизвестен этот идентификатор подписки, введите команду `Get-AzSubscription`, чтобы просмотреть его. Значение **Id** (Идентификатор) в полученных выходных данных является идентификатором вашей подписки. Вставьте измененную версию сценарий в окно сеанса PowerShell и нажмите клавишу `Enter`, чтобы выполнить его.

    ```powershell
    New-AzRoleAssignment `
      -SignInName UserB@azure.com `
      -RoleDefinitionName "Network Contributor" `
      -Scope /subscriptions/<SubscriptionA-Id>/resourceGroups/myResourceGroupA/providers/Microsoft.Network/VirtualNetworks/myVnetA
    ```

10. Скопируйте приведенный ниже сценарий в текстовый редактор на своем компьютере и замените `<SubscriptionB-id>` идентификатором подписки B. Чтобы создать пиринг между myVnetA и myVNetB, скопируйте измененный сценарий, вставьте его в PowerShell и нажмите клавишу `Enter`.

    ```powershell
    Add-AzVirtualNetworkPeering `
      -Name 'myVnetAToMyVnetB' `
      -VirtualNetwork $vnetA `
      -RemoteVirtualNetworkId /subscriptions/<SubscriptionB-id>/resourceGroups/Default-Networking/providers/Microsoft.ClassicNetwork/virtualNetworks/myVnetB
    ```

11. Просмотрите состояние пиринга myVnetA, скопировав следующий сценарий в PowerShell и нажав клавишу `Enter`.

    ```powershell
    Get-AzVirtualNetworkPeering `
      -ResourceGroupName $rgName `
      -VirtualNetworkName myVnetA `
      | Format-Table VirtualNetworkName, PeeringState
    ```

    Отображается состояние **Connected** (Подключено). Оно принимает значение **Connected** (Подключено) после настройки пиринга из myVnetB к myVnetA.

    Теперь все ресурсы Azure, созданные в любой из виртуальных сетей, могут взаимодействовать друг с другом, используя свои IP-адреса. Если вы используете разрешение имен Azure по умолчанию для виртуальных сетей, то ресурсы в этих виртуальных сетях не смогут разрешать имена между виртуальными сетями. Если требуется разрешение имен между виртуальными сетями в пиринге, необходимо создать собственный DNS-сервер. Узнайте, как настроить [разрешение имен с помощью собственного DNS-сервера](virtual-networks-name-resolution-for-vms-and-role-instances.md#name-resolution-that-uses-your-own-dns-server).

12. **Необязательно**: хотя в этом руководстве не рассматривается создание виртуальных машин, можно создать по виртуальной машине в каждой виртуальной сети и подключить эти виртуальные машины друг к другу, чтобы проверить связь.
13. **Необязательно**: чтобы удалить ресурсы, созданные при работе с этим руководством, выполните инструкции, описанные в разделе [Удаление ресурсов](#delete-powershell) этой статьи.

## <a name="delete-resources"></a><a name="delete"></a>Удаление ресурсов
По завершении работы с этим руководством может потребоваться удалить созданные в его рамках ресурсы, чтобы за их использование не взималась плата. При удалении группы ресурсов будут также удалены все ресурсы, содержащиеся в ней.

### <a name="azure-portal"></a><a name="delete-portal"></a>Портал Azure

1. В поле поиска на портале введите **myResourceGroupA**. В результатах поиска щелкните **myResourceGroupA**.
2. В колонке **myResourceGroupA** щелкните значок **Удалить**.
3. Чтобы подтвердить удаление, введите **myResourceGroupA** в поле **Введите имя группы ресурсов**, а затем щелкните **Удалить**.
4. В поле **Поиск ресурсов**, находящемся в верхней части портала, введите *myVnetB*. Когда сеть **myVnetB** появится в результатах поиска, щелкните ее. Отобразится колонка для виртуальной сети **myVnetB**.
5. В колонке **myVnetB** щелкните **Удалить**.
6. В окне **Удалить виртуальную сеть** нажмите кнопку **Да**, чтобы подтвердить удаление.

### <a name="azure-cli"></a><a name="delete-cli"></a>Интерфейс командной строки Azure

1. Войдите в Azure с помощью Azure CLI, чтобы удалить виртуальную сеть Resource Manager с помощью приведенной ниже команды.

   ```azurecli-interactive
   az group delete --name myResourceGroupA --yes
   ```

2. Войдите в Azure с помощью классического интерфейса командной строки, чтобы удалить классическую виртуальную сеть, выполнив приведенные ниже команды.

   ```console
   azure config mode asm

   azure network vnet delete --vnet myVnetB --quiet
   ```

### <a name="powershell"></a><a name="delete-powershell"></a>PowerShell

1. В командной строке PowerShell введите приведенную ниже команду, чтобы удалить виртуальную сеть Resource Manager.

   ```powershell
   Remove-AzResourceGroup -Name myResourceGroupA -Force
   ```

2. Чтобы удалить классическую виртуальную сеть с помощью PowerShell, необходимо изменить существующий файл конфигурации сети. Узнайте, как [экспортировать, обновлять и импортировать файлы конфигурации сети](/previous-versions/azure/virtual-network/virtual-networks-using-network-configuration-file). Удалите приведенный ниже элемент VirtualNetworkSite для виртуальной сети, используемой в этом руководстве.

   ```xml
   <VirtualNetworkSite name="myVnetB" Location="East US">
     <AddressSpace>
       <AddressPrefix>10.1.0.0/16</AddressPrefix>
     </AddressSpace>
     <Subnets>
       <Subnet name="default">
         <AddressPrefix>10.1.0.0/24</AddressPrefix>
       </Subnet>
     </Subnets>
   </VirtualNetworkSite>
   ```

   > [!WARNING]
   > Импорт измененного файла конфигурации сети может привести к изменениям в классических виртуальных сетях в вашей подписке. Убедитесь, что вы удалили только указанную выше виртуальную сеть и не изменили или удалили другие виртуальные сети в своей подписке. 

## <a name="next-steps"></a>Дальнейшие действия

- Внимательно ознакомьтесь с важными [ограничениями и особенностями работы пиринга виртуальных сетей](virtual-network-manage-peering.md#requirements-and-constraints), прежде чем создавать пиринг виртуальных сетей для рабочей среды.
- Узнайте о [параметрах пиринга виртуальных сетей](virtual-network-manage-peering.md#create-a-peering).
- Узнайте, как [создать звездообразную топологию сети](/azure/architecture/reference-architectures/hybrid-networking/hub-spoke#virtual-network-peering) с помощью пиринга виртуальных сетей.