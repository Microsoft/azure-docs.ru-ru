---
title: Добавление или удаление сетевых интерфейсов на виртуальных машинах Azure
description: Узнайте, как добавлять и удалять сетевые интерфейсы виртуальных машин.
services: virtual-network
documentationcenter: na
author: KumudD
manager: mtillman
editor: ''
tags: azure-resource-manager
ms.assetid: ''
ms.service: virtual-network
ms.devlang: NA
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/13/2020
ms.author: kumud
ms.openlocfilehash: 43d3da49688a7daeb3ea4e0c1c3dba505dcd3b59
ms.sourcegitcommit: e6de1702d3958a3bea275645eb46e4f2e0f011af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/20/2021
ms.locfileid: "102508339"
---
# <a name="add-network-interfaces-to-or-remove-network-interfaces-from-virtual-machines"></a>Добавление и удаление сетевых интерфейсов виртуальных машин

Узнайте, как добавить существующий сетевой интерфейс при создании виртуальной машины Azure. Также научитесь добавлять или удалять сетевые интерфейсы из существующей виртуальной машины в остановленном (освобожденном) состоянии. Сетевой интерфейс позволяет виртуальной машине Azure взаимодействовать с Интернетом, Azure и локальными ресурсами. Виртуальная машина имеет один или несколько сетевых интерфейсов. 

При необходимости см. инструкции по [добавлению, изменению и удалению IP-адресов для сетевого интерфейса Azure](virtual-network-network-interface-addresses.md). Сведения о создании, изменении и удалении сетевых интерфейсов см. в разделе [Управление сетевыми интерфейсами](virtual-network-network-interface.md).

## <a name="before-you-begin"></a>Перед началом

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]

Если у вас ее нет, настройте учетную запись Azure с активной подпиской. [Создайте учетную запись](https://azure.microsoft.com/free/?ref=microsoft.com&utm_source=microsoft.com&utm_medium=docs&utm_campaign=visualstudio) бесплатно. Перед началом оставшейся части этой статьи выполните одну из следующих задач:

- **Пользователи портала**. войдите в [портал Azure](https://portal.azure.com) с помощью учетной записи Azure.

- **Пользователи PowerShell**. выполните команды в [Azure Cloud Shell](https://shell.azure.com/powershell)или запустите PowerShell с компьютера. Azure Cloud Shell — это бесплатная интерактивная оболочка, с помощью которой можно выполнять действия, описанные в этой статье. Она включает предварительно установленные общие инструменты Azure и настроена для использования с вашей учетной записью. На вкладке Обозреватель Azure Cloud Shell найдите раскрывающийся список **выбрать среду** , а затем выберите **PowerShell** , если он еще не выбран.

    Если вы используете PowerShell локально, используйте Azure PowerShell Module версии 1.0.0 или более поздней. Выполните командлет `Get-Module -ListAvailable Az.Network`, чтобы узнать установленную версию. Если вам необходимо выполнить обновление, ознакомьтесь со статьей, посвященной [установке модуля Azure PowerShell](/powershell/azure/install-az-ps). Выполните команду `Connect-AzAccount`, чтобы создать подключение к Azure.

- **Пользователи интерфейса командной строки Azure (CLI)**. выполните команды в [Azure Cloud Shell](https://shell.azure.com/bash)или запустите CLI с компьютера. Если вы используете Azure CLI локально, используйте Azure CLI версии не ниже 2.0.26 или более поздней. Выполните командлет `az --version`, чтобы узнать установленную версию. Если вам необходимо выполнить установку или обновление, см. статью [Установка Azure CLI 2.0](/cli/azure/install-azure-cli). Выполните команду `az login`, чтобы создать подключение к Azure.

## <a name="add-existing-network-interfaces-to-a-new-vm"></a>Добавление имеющихся сетевых интерфейсов к новой виртуальной машине

При создании виртуальной машины с помощью портала портал создает сетевой интерфейс с параметрами по умолчанию и подключает сетевой интерфейс к виртуальной машине. Портал нельзя использовать для добавления существующих сетевых интерфейсов в новую виртуальную машину или для создания виртуальной машины с несколькими сетевыми интерфейсами. Для этого можно использовать CLI или PowerShell. Не забудьте ознакомиться с [ограничениями](#constraints). При создании виртуальной машины с несколькими сетевыми интерфейсами, необходимо также настроить ОС, чтобы использовать их соответствующим образом. Дополнительные сведения см. в статьях о настройке виртуальных машин [Windows](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#configure-guest-os-for-multiple-nics) или [Linux](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#configure-guest-os-for-multiple-nics).

### <a name="commands"></a>Команды

Перед созданием виртуальной машины [Создайте сетевой интерфейс](virtual-network-network-interface.md#create-a-network-interface).

|Инструмент|Команда|
|---|---|
|CLI|[az network nic create](/cli/azure/network/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#az-network-nic-create)|
|PowerShell|[New-AzNetworkInterface](/powershell/module/az.network/new-aznetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json)|

## <a name="add-a-network-interface-to-an-existing-vm"></a>Добавление сетевого интерфейса к имеющейся виртуальной машине

Чтобы добавить сетевой интерфейс к виртуальной машине, выполните следующие действия.

1. Перейдите в [портал Azure](https://portal.azure.com) , чтобы найти существующую виртуальную машину. Найдите и щелкните **Виртуальные машины**.

2. Выберите имя виртуальной машины. Она должна поддерживать количество сетевых интерфейсов, которое вы хотите добавить. Чтобы узнать, сколько сетевых интерфейсов поддерживает каждый размер виртуальной машины, см. размеры в Azure для [виртуальных машин Linux](../virtual-machines/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) или [виртуальных машин Windows](../virtual-machines/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

3. На панели команд виртуальной машины выберите команду " **Закрыть**", а затем нажмите **кнопку "ОК** " в диалоговом окне подтверждения. Затем дождитесь, пока **состояние** виртуальной машины не изменится на **остановлено (освобождено)**.

4. В строке меню виртуальной **машины выберите сеть**  >  **Подключить сетевой интерфейс**. Затем в окне **Подключение существующего сетевого интерфейса** выберите сетевой интерфейс, который вы хотите подключить, и нажмите кнопку **ОК**.

    >[!NOTE]
    >В выбранном сетевом интерфейсе не может быть включена Ускоренная сеть, не может быть назначен IPv6-адрес и он должен находиться в той же виртуальной сети с сетевым интерфейсом, подключенным к виртуальной машине в данный момент.

    Если у вас нет сетевого интерфейса, сначала создайте его. Для этого выберите **Создать сетевой интерфейс**. Дополнительные сведения см. в разделе [Создание сетевого интерфейса](virtual-network-network-interface.md#create-a-network-interface). Сведения о дополнительных ограничениях при добавлении сетевых интерфейсов к виртуальным машинам см. в разделе [Ограничения](#constraints).

5. В строке меню виртуальной машины выберите **Обзор**  >  **Начало** , чтобы перезапустить виртуальную машину.

Теперь можно настроить в операционной системе виртуальной машины использование нескольких сетевых интерфейсов должным образом. Дополнительные сведения см. в статьях о настройке виртуальных машин [Windows](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#configure-guest-os-for-multiple-nics) или [Linux](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#configure-guest-os-for-multiple-nics).

### <a name="commands"></a>Команды

|Инструмент|Команда|
|---|---|
|CLI|[AZ VM NIC Add](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#az-vm-nic-add) (Справочник); [подробные инструкции](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#add-a-nic-to-a-vm)|
|PowerShell|[Add-азвмнетворкинтерфаце](/powershell/module/az.compute/add-azvmnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json) (ссылка); [подробные инструкции](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#add-a-nic-to-an-existing-vm)|

## <a name="view-network-interfaces-for-a-vm"></a>Просмотр сетевых интерфейсов для виртуальной машины

Вы можете просмотреть сетевые интерфейсы, подключенные к виртуальной машине, чтобы изучить конфигурацию каждого из них, а также назначенные им IP-адреса. 

1. Перейдите в [портал Azure](https://portal.azure.com) , чтобы найти существующую виртуальную машину. Найдите и щелкните **Виртуальные машины**.

    >[!NOTE]
    >Войдите, используя учетную запись, которой назначена роль "владелец", "участник" или "участник сети" для вашей подписки. Дополнительные сведения о назначении ролей учетным записям см. в разделе [Участник сети](../role-based-access-control/built-in-roles.md?toc=%2fazure%2fvirtual-network%2ftoc.json#network-contributor).

2. Выберите имя виртуальной машины, для которой необходимо просмотреть подключенные сетевые интерфейсы.

3. В строке меню виртуальной машины выберите **сети**.

Дополнительную информацию о параметрах сетевого интерфейса и сведения об их изменении см. в статье [Создание, изменение или удаление сетевых интерфейсов](virtual-network-network-interface.md). Сведения о добавлении, изменении и удалении IP-адресов для сетевых интерфейсов Azure см. в [этой статье](virtual-network-network-interface-addresses.md).

### <a name="commands"></a>Команды

|Инструмент|Команда|
|---|---|
|CLI|[AZ VM NIC List](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#az-vm-nic-list)|
|PowerShell|[Get-AzVM](/powershell/module/az.compute/get-azvm?toc=%2fazure%2fvirtual-network%2ftoc.json)|

## <a name="remove-a-network-interface-from-a-vm"></a>Удаление сетевого интерфейса из виртуальной машины

1. Перейдите в [портал Azure](https://portal.azure.com) , чтобы найти существующую виртуальную машину. Найдите и щелкните **Виртуальные машины**.

2. Выберите имя виртуальной машины, для которой необходимо просмотреть подключенные сетевые интерфейсы.

3. На панели инструментов виртуальной машины выберите " **Отключить**".

4. Подождите, пока **состояние** виртуальной машины не изменится на **Остановлено (освобождено)**.

5. В строке меню виртуальной **машины выберите сеть**  >  **Отключить сетевой интерфейс**.

6. В диалоговом окне **отсоединение сетевого интерфейса** выберите сетевой интерфейс, который вы хотите отключить. Нажмите кнопку **ОК**.

    >[!NOTE]
    >Если в списке указан только один сетевой интерфейс, отключить его нельзя, так как к виртуальной машине всегда должен быть подключен хотя бы один сетевой интерфейс.

### <a name="commands"></a>Команды

|Инструмент|Команда|
|---|---|
|CLI|[AZ VM NIC Remove](/cli/azure/vm/nic?toc=%2fazure%2fvirtual-network%2ftoc.json#az-vm-nic-remove) (Reference); [подробные инструкции](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#remove-a-nic-from-a-vm)|
|PowerShell|[Remove-азвмнетворкинтерфаце](/powershell/module/az.compute/remove-azvmnetworkinterface?toc=%2fazure%2fvirtual-network%2ftoc.json) (Reference); [подробные инструкции](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json#remove-a-nic-from-an-existing-vm)|

## <a name="constraints"></a>Ограничения

- К виртуальной машине должен быть подключен по крайней мере один сетевой интерфейс.

- К виртуальной машине можно подключить столько сетевых интерфейсов, сколько поддерживает ее размер. Дополнительные сведения о количестве сетевых интерфейсов, поддерживаемых размером каждой виртуальной машины, см. в разделе размеры в Azure для [виртуальных машин Linux](../virtual-machines/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json) или [виртуальных машин Windows](../virtual-machines/sizes.md?toc=%2fazure%2fvirtual-network%2ftoc.json). Все размеры поддерживают как минимум два сетевых интерфейса.

- Сетевые интерфейсы, добавляемые в виртуальную машину, в настоящее время не могут быть присоединены к другой виртуальной машине. Дополнительные сведения о создании сетевого интерфейса см. в [этом разделе](virtual-network-network-interface.md#create-a-network-interface).

- В прошлом можно было добавить сетевые интерфейсы только к виртуальным машинам, которые поддерживали несколько сетевых интерфейсов и были созданы по крайней мере с двумя сетевыми интерфейсами. Не удалось добавить сетевой интерфейс к виртуальной машине, созданной с помощью одного сетевого интерфейса, даже если размер виртуальной машины поддерживал более одного сетевого интерфейса. И наоборот, сетевые интерфейсы можно было удалять только из виртуальной машины по крайней мере с тремя сетевыми интерфейсами, так как виртуальные машины, созданные по крайней мере с двумя сетевыми интерфейсами, всегда должны были иметь по крайней мере два сетевых интерфейса. Эти ограничения больше не применяются. Теперь вы можете создать виртуальную машину с любым количеством сетевых интерфейсов (в пределах количества, поддерживаемого размером виртуальной машины).

- По умолчанию первый сетевой интерфейс, подключенный к виртуальной машине, является *основным* сетевым интерфейсом. Все остальные сетевые интерфейсы в виртуальной машине считаются *дополнительными*.

- Вы можете контролировать, к какому сетевому интерфейсу отправляются исходящий трафик. Однако по умолчанию виртуальная машина отправляет весь исходящий трафик на IP-адрес, назначенный основной IP-конфигурации основного сетевого интерфейса.

- В прошлом все виртуальные машины в одной группе доступности должны были иметь один или несколько сетевых интерфейсов. Теперь в одной группе доступности могут находиться виртуальные машины с любым количеством сетевых интерфейсов (в пределах количества, поддерживаемого размером виртуальной машины). Виртуальную машину можно добавить в группу доступности только при ее создании. Дополнительные сведения о группах доступности см. в разделе [Настройка нескольких виртуальных машин в группе доступности для обеспечения избыточности](../virtual-machines/availability.md?toc=%2fazure%2fvirtual-network%2ftoc.json).

- Вы можете подключать сетевые интерфейсы в одной виртуальной машине к разным подсетям в виртуальной сети. Однако все сетевые интерфейсы должны быть подключены к одной виртуальной сети.

- Вы можете добавить любой IP-адрес для любой IP-конфигурации любого основного или дополнительного сетевого интерфейса во внутренний Azure Load Balancer. Раньше во внутренний пул можно было добавить только основной IP-адрес для основного сетевого интерфейса. Дополнительные сведения об IP-адресах и IP-конфигурациях см. в статье [Добавление, изменение и удаление IP-адресов для сетевых интерфейсов Azure](virtual-network-network-interface-addresses.md).

- При удалении виртуальной машины подключенные к ней сетевые интерфейсы не удаляются. Если вы удалите виртуальную машину, сетевые интерфейсы отключатся от нее. Вы можете добавить эти сетевые интерфейсы к разным виртуальным машинам или удалить их.

- Достижение оптимальной производительности требует ускорения работы в сети. В некоторых случаях необходимо явно включить ускоренную сеть для виртуальных машин [Windows](create-vm-accelerated-networking-powershell.md) или [Linux](create-vm-accelerated-networking-cli.md) .

## <a name="next-steps"></a>Дальнейшие действия

Сведения о создании виртуальной машины с несколькими сетевыми интерфейсами или IP-адресами см. в следующих статьях:

|Задача|Инструмент|
|---|---|
|Создание виртуальной машины с несколькими сетевыми адаптерами|[Интерфейс командной строки](../virtual-machines/linux/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json), [PowerShell](../virtual-machines/windows/multiple-nics.md?toc=%2fazure%2fvirtual-network%2ftoc.json)|
|Создание виртуальной машины с одним сетевым адаптером, которому назначено несколько IPv4-адресов|[Интерфейс командной строки](virtual-network-multiple-ip-addresses-cli.md), [PowerShell](virtual-network-multiple-ip-addresses-powershell.md)|
|Создание виртуальной машины с одним сетевым адаптером, которому назначен частный IPv6-адрес (обслуживаемый Azure Load Balancer).|[Интерфейс командной строки](../load-balancer/load-balancer-ipv6-internet-cli.md?toc=%2fazure%2fvirtual-network%2ftoc.json), [PowerShell](../load-balancer/load-balancer-ipv6-internet-ps.md?toc=%2fazure%2fvirtual-network%2ftoc.json), [шаблон Azure Resource Manager](../load-balancer/load-balancer-ipv6-internet-template.md?toc=%2fazure%2fvirtual-network%2ftoc.json)|