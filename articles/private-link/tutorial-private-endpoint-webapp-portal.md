---
title: Руководство по подключению к веб-приложению с помощью частной конечной точки Azure
titleSuffix: Azure Private Link
description: Начните работу с этим учебником, используя частную конечную точку Azure для подключения к веб-приложению в частном порядке.
author: asudbring
ms.author: allensu
ms.service: private-link
ms.topic: tutorial
ms.date: 10/19/2020
ms.openlocfilehash: 502c48a92f5b41c4434d03139335a0ce05fa451f
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/29/2021
ms.locfileid: "92896979"
---
# <a name="tutorial-connect-to-a-web-app-using-an-azure-private-endpoint"></a>Руководство по подключению к веб-приложению с помощью частной конечной точки Azure

Частная конечная точка Azure — ключевой компонент для построения Приватного канала в Azure. Это позволяет ресурсам Azure, таким как виртуальные машины (ВМ), обмениваться данными с ресурсами Приватного канала в частном порядке.

В этом руководстве описано следующее:

> [!div class="checklist"]
> * Создание виртуальной сети и узла бастиона.
> * Создайте виртуальную машину.
> * Создание веб-приложения.
> * Создание частной конечной точки.
> * Проверка подключения к частной конечной точке веб-приложения.

Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free/?WT.mc_id=A261C142F), прежде чем начинать работу.

> [!Note]
> Частная конечная точка доступна в общедоступных регионах для веб-приложений Windows категории Премиум V2, Премиум V3, веб-приложений Linux и плана ценовой категории "Премиум" для Функций Azure (иногда это называется эластичным планом "Премиум"). 

## <a name="prerequisites"></a>Обязательные условия

* Подписка Azure

## <a name="sign-in-to-azure"></a>Вход в Azure

Войдите на [портал Azure](https://portal.azure.com).

## <a name="create-a-virtual-network-and-bastion-host"></a>Создание виртуальной сети и узла бастиона

В этом разделе вы создадите виртуальную сеть, подсеть и узел бастиона. 

Для безопасного подключения к виртуальной машине с целью тестирования частной конечной точки будет использоваться узел бастиона.

1. Слева вверху экрана щелкните **Создать ресурс > Сеть > Виртуальная сеть** или выполните поиск по фразе **виртуальная сеть**.

2. В подменю **Создать виртуальную сеть** введите или выберите следующую информацию на вкладке **Основные сведения**:

    | **Параметр**          | **Значение**                                                           |
    |------------------|-----------------------------------------------------------------|
    | **Сведения о проекте**  |                                                                 |
    | Подписка     | Выбор подписки Azure                                  |
    | Группа ресурсов   | Выберите **MyResourceGroup**. |
    | **Сведения об экземпляре** |                                                                 |
    | Имя             | Введите **myVNet**.                                    |
    | Регион           | Выберите **Западная Европа**. |

3. Откройте вкладку **IP-адрес** или нажмите кнопку **Далее: IP-адреса** внизу страницы.

4. На вкладке **IP-адреса** укажите следующие сведения:

    | Параметр            | Значение                      |
    |--------------------|----------------------------|
    | Диапазон IPv4-адресов | Введите **10.1.0.0/16**. |

5. В разделе **Имя подсети** выберите **по умолчанию**.

6. В окне **Изменение подсети** введите следующие сведения:

    | Параметр            | Значение                      |
    |--------------------|----------------------------|
    | Имя подсети | Введите **mySubnet**. |
    | Диапазон адресов подсети | Введите **10.1.0.0/24**. |

7. Щелкните **Сохранить**.

8. Перейдите на вкладку **Безопасность**.

9. В разделе **BastionHost** выберите **Включить**. Введите такие сведения:

    | Параметр            | Значение                      |
    |--------------------|----------------------------|
    | Имя бастиона | Введите **myBastionHost**. |
    | Адресное пространство AzureBastionSubnet | Введите **10.1.1.0/24**. |
    | Общедоступный IP-адрес | Выберите **Создать**. </br> В поле **Имя** введите **myBastionIP**. </br> Щелкните **ОК**. |


8. Перейдите на вкладку **Просмотр и создание** или нажмите кнопку **Просмотр и создание**.

9. Нажмите кнопку **Создать**.

## <a name="create-a-virtual-machine"></a>Создание виртуальной машины

В этом разделе вы создадите виртуальную машину, которая будет использоваться для тестирования частной конечной точки.


1. В левой верхней части портала выберите **Создать ресурс** > **Вычисления** > **Виртуальная машина** или выполните поиск по словам **виртуальная машина** в поле поиска.
   
2. В разделе **Создание виртуальной машины** на вкладке **Основные сведения** укажите следующее.

    | Параметр | Значение                                          |
    |-----------------------|----------------------------------|
    | **Сведения о проекте** |  |
    | Подписка | Выбор подписки Azure |
    | Группа ресурсов | Выберите **MyResourceGroup**. |
    | **Сведения об экземпляре** |  |
    | Имя виртуальной машины | Введите **myVM**. |
    | Регион | Выберите **Западная Европа**. |
    | Параметры доступности | Выберите **Избыточность инфраструктуры не требуется**. |
    | Образ — | Выберите **Windows Server 2019 Datacenter — Gen1** |
    | Точечный экземпляр Azure | Выберите **Нет**. |
    | Размер | Выберите размер виртуальной машины или подтвердите значение по умолчанию. |
    | **Учетная запись администратора** |  |
    | Имя пользователя | Введите имя пользователя. |
    | Пароль | Введите пароль. |
    | Подтверждение пароля | Введите пароль еще раз. |

3. Выберите вкладку **Сеть** или **Далее: диски**, затем **Далее: сеть**.
  
4. На вкладке "Сеть" укажите следующее.

    | Параметр | Значение |
    |-|-|
    | **Сетевой интерфейс** |  |
    | Виртуальная сеть | **myVNet** |
    | Подсеть | **mySubnet** |
    | Общедоступный IP-адрес | Выберите **Отсутствует**. |
    | Сетевая группа безопасности сетевого адаптера | **Основной**|
    | Общедоступные входящие порты | Выберите **Отсутствует**. |
   
5. Выберите **Review + create** (Просмотреть и создать). 
  
6. Проверьте параметры, а затем нажмите кнопку **Создать**.

## <a name="create-web-app"></a>Создание веб-приложения

Из этого раздела вы узнаете, как создать веб-приложение.

1. В меню слева поочередно выберите **Создать ресурс** > **Хранилище** > **Веб-приложение** или найдите **веб-приложение** в поле поиска.

2. На странице **Создание веб-приложения** на вкладке **Основные сведения** укажите следующее.

    | Параметр | Значение                                          |
    |-----------------------|----------------------------------|
    | **Сведения о проекте** |  |
    | Подписка | Выбор подписки Azure |
    | Группа ресурсов | Выберите **MyResourceGroup**. |
    | **Сведения об экземпляре** |  |
    | Имя | Введите **mywebapp**. Если имя недоступно, введите уникальное имя. |
    | Публикация | Выберите **Код**. |
    | Стек среды выполнения | Выберите **.NET Core 3.1 (LTS)** . |
    | Операционная система | Выберите **Windows**. |
    | Регион | Выберите **Западная Европа**. |
    | **План службы приложений** |  |
    | План Windows (Западная Европа) | Выберите **Создать**. </br> Введите **myServicePlan** в поле **Имя**. |
    | Номер SKU и размер | Выберите **Изменить размер**. </br> Выберите **P2V2** в окне **Выбор характеристик**. </br> Нажмите кнопку **Применить**. |
   
3. Выберите **Проверить и создать**.

4. Нажмите кнопку **создания**.

    :::image type="content" source="./media/tutorial-private-endpoint-webapp-portal/create-web-app.png" alt-text="Вкладка &quot;Основные сведения&quot; для создания веб-приложения на портале Azure." border="true":::

## <a name="create-private-endpoint"></a>Создание частной конечной точки

1. В меню слева выберите **Все ресурсы** > **myWebApp** или имя, выбранное во время создания.

2. В разделе "Обзор веб-приложения" выберите **Параметры** > **Сеть**.

3. На вкладке **Сеть** выберите **Настройте подключения к частной конечной точке**.

4. На экране **Подключения к частной конечной точке** выберите **Добавить**.

5. Введите или выберите следующие сведения на экране **Добавление частной конечной точки**:

    | Параметр | Значение |
    | ------- | ----- |
    | Имя | Введите **mywebappendpoint**. |
    | Подписка | Выберите свою подписку. |
    | Виртуальная сеть | Выберите **myVNet**. |
    | Подсеть | Выберите **mySubnet**. |
    | Интеграция с частной зоной DNS | Выберите **Да**. |

6. Щелкните **ОК**.
    

## <a name="test-connectivity-to-private-endpoint"></a>Проверка подключения к частной конечной точке

В этом разделе описано, как использовать виртуальную машину, созданную на предыдущем шаге, для подключения к веб-приложению через частную конечную точку.

1. В области навигации слева выберите **Группы ресурсов**.

2. Выберите **myResourceGroup**.

3. Выберите **myVM**.

4. На обзорной странице для **myVM** выберите **Подключиться**, а затем — **Бастион**.

5. Нажмите синюю кнопку **Использовать Бастион**.

6. Введите имя пользователя и пароль, указанные при создании виртуальной машины.

7. После подключения откройте на сервере Windows PowerShell.

8. Введите `nslookup <webapp-name>.azurewebsites.net`. Замените **\<webapp-name>** именем веб-приложения, созданного на предыдущих шагах.  Вы получите сообщение, аналогичное показанному ниже:

    ```powershell
    Server:  UnKnown
    Address:  168.63.129.16

    Non-authoritative answer:
    Name:    mywebapp8675.privatelink.azurewebsites.net
    Address:  10.1.0.5
    Aliases:  mywebapp8675.azurewebsites.net
    ```

    Для имени веб-приложения возвращен частный IP-адрес **10.1.0.5**.  Этот адрес находится в подсети виртуальной сети, созданной ранее.

9. Откройте веб-браузер на своем локальном компьютере и введите внешний URL-адрес веб-приложения **https://\<webapp-name>.azurewebsites.net**.

10. Убедитесь, что вы получили страницу **403**. Эта страница указывает, что веб-приложение недоступно извне.

    :::image type="content" source="./media/tutorial-private-endpoint-webapp-portal/web-app-ext-403.png" alt-text="Страница 403 для внешнего адреса веб-приложения." border="true":::

11. В окне подключения бастиона к **myVM** откройте Internet Explorer.

12. Введите URL-адрес веб-приложения **https://\<webapp-name>.azurewebsites.net**.

13. Убедитесь, что вы получили страницу веб-приложения по умолчанию.

    :::image type="content" source="./media/tutorial-private-endpoint-webapp-portal/web-app-default-page.png" alt-text="Страница веб-приложения по умолчанию." border="true":::

18. Закройте подключение к **myVM**.

## <a name="clean-up-resources"></a>Очистка ресурсов

Если вы не собираетесь продолжать использовать это приложение, удалите виртуальную сеть, виртуальную машину и веб-приложение, выполнив следующие действия.

1. В меню слева выберите **Группы ресурсов**.

2. Выберите **myResourceGroup**.

3. Выберите **Удалить группу ресурсов**.

4. В поле **ВВЕДИТЕ ИМЯ ГРУППЫ РЕСУРСОВ** введите **myResourceGroup**.

5. Выберите команду **Удалить**.

## <a name="next-steps"></a>Дальнейшие действия

Создание службы Приватного канала:
> [!div class="nextstepaction"]
> [Создание службы "Приватный канал"](create-private-link-service-portal.md)
