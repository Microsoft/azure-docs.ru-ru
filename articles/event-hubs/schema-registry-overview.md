---
title: Реестр схем Azure в Центрах событий (предварительная версия)
description: В этой статье приведены общие сведения о поддержке реестра схем Центрами событий Azure (предварительная версия).
ms.topic: overview
ms.date: 09/22/2020
ms.custom: references_regions
ms.openlocfilehash: a876651b76aa259754623854b8fc4a7c6c8a939e
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92330501"
---
# <a name="azure-schema-registry-in-event-hubs-preview"></a>Реестр схем Azure в Центрах событий (предварительная версия)
Во многих сценариях потоковой передачи событий и обмена сообщениями полезные данные событий или сообщений содержит структурированные данные, которые либо сериализуются, либо десериализуется с использованием управляемого схемой формата, например Apache Avro. Так же, как и при использовании схемы JSON, отправителям и получателям может потребоваться проверить целостность данных с помощью документа схемы. Для управляемых схемой форматов предоставление схемы объекту-получателю сообщений является необходимым условием для того, чтобы этот объект-получатель мог десериализовать данные. 

**Реестр схем Azure** — это функция Центров событий, которая предоставляет центральный репозиторий для документов схемы для управляемых событиями и ориентированных на обмен сообщениями приложений. Он обеспечивает гибкость работы приложений-производителей и приложений-получателей при обмене данными, избавляя от необходимости управлять схемой и позволяя совместно использовать ее в приложениях обоих типов, а также развивать их с разными темпами. Реестр схем также предоставляет простую платформу управления для повторно используемых схем и определяет связь между схемами через конструкцию группировки (группы схем).

> [!NOTE]
> - Функция **Реестр схем** в настоящее время находится на этапе **предварительной версии** и не рекомендуется для рабочих нагрузок в рабочей среде.
> - Эта функция доступна только на **стандартных** и **выделенных** уровнях и не предоставляется на уровне **Базовый**.

При использовании управляемых схемой платформ сериализации, например Apache Avro, выведение метаданных сериализации в общие схемы также помогает значительно сократить объем служебных данных для каждого сообщения, позволяя исключить сведения о типе и имена полей, добавляемые в каждый набор данных, как в случае с такими форматами с поддержкой тегов, как JSON. Хранение схем вместе с событиями и в инфраструктуре событий, гарантирует постоянную доступность метаданных, необходимых для сериализации или десериализации, и исключает неверное размещение схем. 

## <a name="event-hubs-namespace"></a>пространство имен Центров событий;
Теперь в пространстве имен Центров событий можно размещать группы схем вместе с центрами событий (или разделами Kafka). Он содержит реестр схем и может включать несколько групп схем. Помимо размещения в Центрах событий Azure реестр схем можно использовать глобально со всеми службами обмена сообщениями Azure и любым другим посредником для сообщений или событий. Каждая из этих групп схем является отдельно защищаемым репозиторием для набора схем. Группы можно согласовать с определенным приложением или подразделением. 

## <a name="schema-groups"></a>Группы схем
Группа схем — это логическая группа похожих схем в соответствии с вашими бизнес-критериями. Группа схем может содержать несколько версий схемы. Параметр принудительного обеспечения совместимости в группе схем позволяет гарантировать обратную совместимость более новых версий схемы.

Граница безопасности, устанавливаемая механизмом группирования, помогает избежать непреднамеренной утечки коммерческих тайн посредством метаданных в ситуациях, когда пространство имен совместно используется несколькими участниками. Она также позволяет владельцам приложений управлять схемами независимо от других приложений, использующих то же пространство имен.


## <a name="schemas"></a>Схемы
Схемы определяют контракт между объектами-производителями и объектами-получателями. Схема, определенная в реестре схем Центров событий, помогает управлять контрактом за пределами данных событий, избавляя от служебных данных в полезных данных. Схема имеет имя, тип (например, запись, массив и т. д.), режим совместимости (нет, прямая, обратная, полная) и тип сериализации (сейчас только в Avro). Можно создать несколько версий схемы, а затем получить и использовать определенную из них. 

## <a name="client-sdks"></a>Клиентские пакеты SDK
Вы можете использовать одну из следующих библиотек, включающих сериализатор Avro, который можно применять для сериализации и десериализации полезных данных, содержащих идентификаторы схем в реестре схем и данные в формате Avro.

- [.NET — Microsoft.Azure.Data.SchemaRegistry.ApacheAvro](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/schemaregistry/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro)
- [Java — azure-data-schemaregistry-avro](https://github.com/Azure/azure-sdk-for-java/tree/master/sdk/schemaregistry/azure-data-schemaregistry-avro/)
- [Python — azure-schemaregistry-avroserializer](https://github.com/Azure/azure-sdk-for-python/tree/master/sdk/schemaregistry/azure-schemaregistry-avroserializer)
- [JavaScript — @azure/schema-registry-avro](https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/schemaregistry/schema-registry-avro)
- [Apache Kafka](https://github.com/Azure/azure-schema-registry-for-kafka/) — запуск интегрированных в Kafka сериализаторов и десериализаторы Apache Avro, которые поддерживаются реестром схем Azure. Клиентский сериализатор Apache Kafka клиента Java для реестра схем Azure можно использовать в любом сценарии Apache Kafka, с любым развертыванием на основе Apache Kafka® и любой облачной службой. 

На следующем рисунке показан поток сведений реестра схем, передаваемый с помощью Центров событий. 

:::image type="content" source="./media/schema-registry-overview/flow-diagram.png" alt-text="Схема процесса":::

## <a name="standard-vs-dedicated-limits"></a>Стандартные и специальные ограничения
Сведения об ограничениях (например, на количество групп схем в пространстве имен), которые могут быть одинаковыми или отличаться для стандартных и специальных уровней Центров событий, см. в разделе об [ограничениях реестра схем](../azure-resource-manager/management/azure-subscription-service-limits.md#schema-registry-limitations).

## <a name="azure-role-based-access-control"></a>Управление доступом на основе ролей в Azure
При доступе к реестру схем с помощью программных средств необходимо зарегистрировать приложение в Azure Active Directory (Azure AD) и добавить субъект безопасности приложения в одну из ролей системы управления доступом на основе ролей Azure (Azure RBAC).

| Роль | Описание | 
| ---- | ----------- | 
| Владелец | Чтение, запись и удаление групп и схем реестра схем. |
| Участник | Чтение, запись и удаление групп и схем реестра схем. |
| [Читатель реестра схем (предварительная версия)](../role-based-access-control/built-in-roles.md#schema-registry-reader-preview) | Чтение и перечисление групп и схем в реестре схем. |
| [Участник реестра схем (предварительная версия)](../role-based-access-control/built-in-roles.md#schema-registry-reader-preview) | Чтение, запись и удаление групп и схем реестра схем. |

Инструкции по созданию и регистрации приложения с помощью портала Azure см. в статье о [регистрации приложения в Azure AD](../active-directory/develop/quickstart-register-app.md). Запишите идентификатор клиента (идентификатор приложения), идентификатор арендатора и секрет для использования их в коде. 

## <a name="next-steps"></a>Дальнейшие действия

- Сведения о создании реестра схем с помощью портал Azure см. в статье [Создание реестра схем Центров событий с помощью портала Azure](create-schema-registry.md).
- См. следующие примеры **библиотеки клиента Avro для реестра схем**.
    - [.NET](https://github.com/Azure/azure-sdk-for-net/tree/master/sdk/schemaregistry/Microsoft.Azure.Data.SchemaRegistry.ApacheAvro/tests/Samples)
    - [Java](https://github.com/Azure/azure-sdk-for-java/tree/master/sdk/schemaregistry/azure-data-schemaregistry-avro/src/samples)
    - [JavaScript](https://github.com/Azure/azure-sdk-for-js/tree/master/sdk/schemaregistry/schema-registry-avro/samples )
    - [Python](https://github.com/Azure/azure-sdk-for-python/tree/master/sdk/schemaregistry/azure-schemaregistry-avroserializer/samples )
    - [Интеграция Kafka и Avro для реестра схем Azure](https://github.com/Azure/azure-schema-registry-for-kafka/tree/master/csharp/avro/samples)
