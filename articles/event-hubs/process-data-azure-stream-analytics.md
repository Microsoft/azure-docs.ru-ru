---
title: Обработка данных из концентраторов событий Azure с помощью Stream Analytics | Документация Майкрософт
description: В этой статье показано, как обрабатывать данные из концентратора событий Azure с помощью задания Azure Stream Analytics.
ms.date: 06/23/2020
ms.topic: article
ms.openlocfilehash: 2db4fba59a1a06a24ee2939c51ecdf65aa06cef3
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "85312890"
---
# <a name="process-data-from-your-event-hub-using-azure-stream-analytics"></a>Обработка данных из концентратора событий с помощью Azure Stream Analytics 
Azure Stream Analytics служба упрощает прием, обработку и анализ потоковой передачи данных из концентраторов событий Azure, позволяя получать эффективные аналитические данные для выполнения действий в реальном времени. Такая интеграция позволяет быстро создать конвейер аналитики "горячего" пути. Вы можете использовать портал Azure для визуализации входящих данных и создания запроса Stream Analytics. Когда запрос будет готов, его можно переместить в рабочую среду всего за несколько щелчков мыши. 

## <a name="key-benefits"></a>Основные преимущества
Ниже приведены основные преимущества концентраторов событий Azure и интеграции Azure Stream Analytics. 
- **Предварительный просмотр данных** — можно просмотреть входящие данные из концентратора событий в портал Azure.
- **Тестирование запроса** — подготовка запроса преобразования и его тестирование непосредственно в портал Azure. Синтаксис языка запросов см. в документации по [языку Stream Analytics запросов](/stream-analytics-query/built-in-functions-azure-stream-analytics) .
- **Развертывание запроса в рабочей среде** — можно развернуть запрос в рабочей среде, создав и запустив задание Azure Stream Analytics.

## <a name="end-to-end-flow"></a>Сквозной поток

1. Войдите на [портал Azure](https://portal.azure.com). 
1. Перейдите к **пространству имен концентраторов событий** и перейдите к **концентратору событий**, который содержит входящие данные. 
1. На странице концентратор событий выберите **обработать данные** .  

    ![Плитка "обработка данных"](./media/process-data-azure-stream-analytics/process-data-tile.png)
1. Выберите **Обзор** на плитке **включить аналитические данные в реальном времени на основе событий** . 

    ![Выбор Stream Analytics](./media/process-data-azure-stream-analytics/process-data-page-explore-stream-analytics.png)
1. Отобразится страница запроса со значениями, уже заданными для следующих полей:
    1. **Концентратор событий** в качестве входных данных для запроса.
    1. Образец **SQL запроса** с инструкцией SELECT. 
    1. Псевдоним **выхода** для ссылки на результаты теста запроса. 

        ![Редактор запросов](./media/process-data-azure-stream-analytics/query-editor.png)
        
        > [!NOTE]
        >  При первом использовании этой функции Эта страница запрашивает разрешение на создание группы потребителей и политику для концентратора событий для предварительного просмотра входящих данных.
1. Выберите **создать** на панели **просмотра входных данных** , как показано на предыдущем рисунке. 
1. На этой вкладке немедленно появится моментальный снимок последних входящих данных.
    - Тип сериализации в данных определяется автоматически (JSON/CSV). Вы можете вручную изменить его, а также в JSON/CSV/AVRO.
    - Вы можете просмотреть входящие данные в формате таблицы или необработанном формате. 
    - Если данные не являются актуальными, выберите **Обновить** , чтобы просмотреть последние события. 

        Ниже приведен пример данных в **табличном формате**:   ![ результаты в формате таблицы.](./media/process-data-azure-stream-analytics/snapshot-results.png)

        Ниже приведен пример данных в **формате RAW**: 

        ![Результаты в формате RAW](./media/process-data-azure-stream-analytics/snapshot-results-raw-format.png)
1. Выберите **тестовый запрос** , чтобы просмотреть моментальный снимок результатов тестирования запроса на вкладке **Результаты теста** . Вы также можете скачать результаты.

    ![Результаты тестового запроса](./media/process-data-azure-stream-analytics/test-results.png)
1. Напишите собственный запрос для преобразования данных. См. раздел [Справочник по языку запросов Stream Analytics](/stream-analytics-query/stream-analytics-query-language-reference).
1. После тестирования запроса и его перемещения в рабочую среду выберите **развернуть запрос**. Чтобы развернуть запрос, создайте Azure Stream Analytics задание, в котором можно задать выходные данные для задания и запустить задание. Чтобы создать задание Stream Analytics, укажите имя задания и нажмите кнопку **создать**.

      ![Создание задания Azure Stream Analytics](./media/process-data-azure-stream-analytics/create-stream-analytics-job.png)

      > [!NOTE] 
      >  Рекомендуется создать группу потребителей и политику для каждого нового задания Azure Stream Analytics, созданного на странице концентраторы событий. Группы потребителей допускают только пять одновременных средств чтения, поэтому для каждого задания выделяется выделенная группа потребителей, что позволяет избежать ошибок, которые могут возникнуть из-за превышения этого ограничения. Выделенная политика позволяет поворачивать ключ или отзывать разрешения без влияния на другие ресурсы. 
1. Теперь ваше задание Stream Analytics создано, где запрос прошел проверку, а входные данные — это концентратор событий. 

9.  Чтобы завершить конвейер, задайте **выходные данные** запроса и нажмите кнопку **запустить** , чтобы запустить задание.

    > [!NOTE]
    > Перед запуском задания не забудьте заменить аутпуталиас именем выхода, созданным в Azure Stream Analytics.

      ![Установка выходных данных и запуск задания](./media/process-data-azure-stream-analytics/set-output-start-job.png)


## <a name="known-limitations"></a>Известные ограничения
При тестировании запроса загрузка результатов теста занимает около 6 секунд. Мы работаем над улучшением производительности тестирования. Однако при развертывании в рабочей среде Azure Stream Analytics будет иметь задержку в секунду.

## <a name="streaming-units"></a>Единицы потоковой передачи
В Azure Stream Analytics задании по умолчанию используется три единицы потоковой передачи (SUs). Чтобы настроить этот параметр, выберите **масштаб** в меню слева на странице **Stream Analytics задание** в портал Azure. Дополнительные сведения о единицах потоковой передачи см. в разделе [изучение и настройка единиц потоковой передачи](../stream-analytics/stream-analytics-streaming-unit-consumption.md).

![Масштабирование единиц потоковой передачи](./media/process-data-azure-stream-analytics/scale.png)

## <a name="next-steps"></a>Дальнейшие действия
Дополнительные сведения о Stream Analytics запросах см. в разделе [язык запросов Stream Analytics](/stream-analytics-query/built-in-functions-azure-stream-analytics) .
