---
title: Авторизация доступа с помощью Azure Active Directory
description: В этой статье содержатся сведения о предоставлении доступа к ресурсам концентраторов событий с помощью Azure Active Directory.
ms.topic: conceptual
ms.date: 06/23/2020
ms.openlocfilehash: d794b03fdbb5429983788c74cbb05a7c13bf2d76
ms.sourcegitcommit: 910a1a38711966cb171050db245fc3b22abc8c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "92910803"
---
# <a name="authorize-access-to-event-hubs-resources-using-azure-active-directory"></a>Авторизация доступа к ресурсам концентраторов событий с помощью Azure Active Directory
Концентраторы событий Azure поддерживают использование Azure Active Directory (Azure AD) для авторизации запросов к ресурсам концентраторов событий. С помощью Azure AD можно использовать управление доступом на основе ролей Azure (Azure RBAC) для предоставления разрешений субъекту безопасности, который может быть пользователем или субъектом-службой приложения. Дополнительные сведения о ролях и назначениях ролей см. в разделе [Основные сведения о различных ролях](../role-based-access-control/overview.md).

## <a name="overview"></a>Обзор
Когда участник безопасности (пользователь или приложение) пытается получить доступ к ресурсу концентраторов событий, запрос должен быть полномочным. В Azure AD доступ к ресурсу выполняется в два этапа. 

 1. Во-первых, удостоверение субъекта безопасности проходит проверку подлинности и возвращается маркер OAuth 2,0. Имя ресурса для запроса маркера является `https://eventhubs.azure.net/` одинаковым для всех облаков и клиентов. Для клиентов Kafka ресурс, запрашивающий маркер, — `https://<namespace>.servicebus.windows.net` .
 1. Затем маркер передается как часть запроса в службу концентраторов событий для авторизации доступа к указанному ресурсу.

Для этапа аутентификации требуется, чтобы запрос от приложения содержал маркер доступа OAuth 2.0 в среде выполнения. Если приложение выполняется в сущности Azure, такой как виртуальная машина Azure, масштабируемый набор виртуальных машин или приложение-функция Azure, оно может использовать управляемое удостоверение для доступа к ресурсам. Сведения о проверке подлинности запросов, выполняемых управляемым удостоверением в службе концентраторов событий, см. в статье [Аутентификация доступа к ресурсам концентраторов событий Azure с помощью Azure Active Directory и управляемых удостоверений для ресурсов Azure](authenticate-managed-identity.md). 

Для шага авторизации требуется, чтобы одна или несколько ролей Azure были назначены субъекту безопасности. Концентраторы событий Azure предоставляют роли Azure, охватывающие наборы разрешений для ресурсов концентраторов событий. Роли, назначенные субъекту безопасности, определяют разрешения, которые будут иметь субъекта. Дополнительные сведения о ролях Azure см. [в статье встроенные роли Azure для концентраторов событий](#azure-built-in-roles-for-azure-event-hubs)Azure. 

Собственные приложения и веб-приложения, которые делают запросы к концентраторам событий, также могут авторизоваться в Azure AD. Сведения о том, как запросить маркер доступа и использовать его для авторизации запросов к ресурсам концентраторов событий, см. в статье [Проверка подлинности доступа к концентраторам событий Azure с помощью Azure AD из приложения](authenticate-application.md). 

## <a name="assign-azure-roles-for-access-rights"></a>Назначение ролей Azure для прав доступа
Azure Active Directory (Azure AD) разрешает права доступа к защищенным ресурсам через [Управление доступом на основе ролей Azure (Azure RBAC)](../role-based-access-control/overview.md). Концентраторы событий Azure определяют набор встроенных ролей Azure, охватывающих общие наборы разрешений, используемых для доступа к данным концентратора событий. Кроме того, можно определить пользовательские роли для доступа к данным.

Когда роль Azure назначается субъекту безопасности Azure AD, Azure предоставляет доступ к этим ресурсам для этого субъекта безопасности. Доступ может быть ограничен уровнем подписки, группой ресурсов, пространством имен концентраторов событий или любым ресурсом. Субъектом безопасности в Azure AD может быть пользователь, субъект-служба приложения или [управляемое удостоверение службы для ресурсов Azure.](../active-directory/managed-identities-azure-resources/overview.md)

## <a name="azure-built-in-roles-for-azure-event-hubs"></a>Встроенные роли Azure для концентраторов событий Azure
Azure предоставляет следующие встроенные роли Azure для авторизации доступа к данным концентраторов событий с помощью Azure AD и OAuth:

| Роль | Описание | 
| ---- | ----------- | 
| [Владелец данных концентраторов событий Azure](../role-based-access-control/built-in-roles.md#azure-event-hubs-data-owner) | Используйте эту роль, чтобы предоставить полный доступ к ресурсам концентраторов событий. |
| [Отправитель данных концентраторов событий Azure](../role-based-access-control/built-in-roles.md#azure-event-hubs-data-sender) | Используйте эту роль, чтобы предоставить доступ на отправку ресурсам концентраторов событий. |
| [Приемник данных концентраторов событий Azure](../role-based-access-control/built-in-roles.md#azure-event-hubs-data-receiver) | Используйте эту роль, чтобы предоставить доступ к ресурсам концентраторов событий. |

Встроенные роли реестра схемы см. в разделе [роли реестра схемы](schema-registry-overview.md#azure-role-based-access-control).

## <a name="resource-scope"></a>Область ресурса 
Прежде чем назначить роль Azure субъекту безопасности, определите для него область доступа. Рекомендуется всегда предоставлять максимально узкие области.

В следующем списке описываются уровни, на которых можно ограничить доступ к ресурсам концентраторов событий, начиная с самой короткой области:

- **Группа потребителей**. в этой области Назначение ролей применяется только к этой сущности. Сейчас портал Azure не поддерживает назначение роли Azure субъекту безопасности на этом уровне. 
- **Концентратор событий**. Назначение ролей применяется к сущности концентратора событий и группе потребителей под ней.
- **Пространство имен**: назначение ролей охватывает всю топологию концентраторов событий в пространстве имен и связанную с ней группу потребителей.
- **Группа ресурсов**. Назначение ролей применяется ко всем ресурсам концентраторов событий в группе ресурсов.
- **Подписка**. Назначение ролей применяется ко всем ресурсам концентраторов событий во всех группах ресурсов в подписке.

> [!NOTE]
> - Помните, что для распространения назначений ролей Azure может потребоваться до пяти минут. 
> - Это содержимое относится как к концентраторам событий, так и к концентраторам событий для Apache Kafka. Дополнительные сведения о концентраторах событий для поддержки Kafka см. в разделе [концентраторы событий для Kafka-Security и Authentication](event-hubs-for-kafka-ecosystem-overview.md#security-and-authentication).


Дополнительные сведения о том, как определяются встроенные роли, см. в разделе [Знакомство с определениями ролей](../role-based-access-control/role-definitions.md#management-and-data-operations). Дополнительные сведения о создании пользовательских ролей Azure см. в статье [пользовательские роли Azure](../role-based-access-control/custom-roles.md).



## <a name="samples"></a>Примеры
- [Примеры Microsoft. Azure. EventHubs](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/Microsoft.Azure.EventHubs/Rbac). 
    
    В этих примерах используется библиотека **Microsoft.Azure.EventHubs** старой версии, но вы можете легко обновить ее до библиотеки **Azure.Messaging.EventHubs** последней версии. Чтобы начать использовать в примере библиотеку новой версии вместо старой, ознакомьтесь с руководством по [переходу с Microsoft.Azure.EventHubs на Azure.Messaging.EventHubs](https://github.com/Azure/azure-sdk-for-net/blob/master/sdk/eventhub/Azure.Messaging.EventHubs/MigrationGuide.md).
- [Примеры Azure. Messaging. EventHubs](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/Azure.Messaging.EventHubs/ManagedIdentityWebApp)

    Этот пример обновлен для использования последней библиотеки **Azure. Messaging. EventHubs** .
- [Концентраторы событий для примеров Kafka-OAuth](https://github.com/Azure/azure-event-hubs-for-kafka/tree/master/tutorials/oauth). 


## <a name="next-steps"></a>Дальнейшие действия
- Сведения о назначении встроенной роли Azure субъекту безопасности см. в статье [Проверка подлинности доступа к ресурсам концентраторов событий с помощью Azure Active Directory](authenticate-application.md).
- Узнайте [, как создавать пользовательские роли с помощью Azure RBAC](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/Microsoft.Azure.EventHubs/Rbac/CustomRole).
- Узнайте [, как использовать Azure Active Directory с EH](https://github.com/Azure/azure-event-hubs/tree/master/samples/DotNet/Microsoft.Azure.EventHubs/Rbac/AzureEventHubsSDK)

См. следующие статьи:

- [Проверка подлинности запросов к концентраторам событий Azure из приложения с помощью Azure Active Directory](authenticate-application.md)
- [Проверка подлинности управляемого удостоверения с Azure Active Directory для доступа к ресурсам концентраторов событий](authenticate-managed-identity.md)
- [Проверка подлинности запросов к концентраторам событий Azure с помощью подписанных URL](authenticate-shared-access-signature.md)
- [Авторизация доступа к ресурсам концентраторов событий с помощью подписанных URL](authorize-access-shared-access-signature.md)
