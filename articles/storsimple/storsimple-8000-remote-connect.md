---
title: Удаленное подключение к устройству StorSimple
description: Объясняется, как настроить устройство для удаленного управления, а затем подключиться к Windows PowerShell для StorSimple по протоколу HTTP или HTTPS.
author: alkohli
ms.service: storsimple
ms.topic: how-to
ms.date: 01/02/2018
ms.author: alkohli
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 1da688dfb00b26ca6b561d5aa0fb548c221381c5
ms.sourcegitcommit: 772eb9c6684dd4864e0ba507945a83e48b8c16f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "85514581"
---
# <a name="connect-remotely-to-your-storsimple-8000-series-device"></a>Удаленное подключение к устройству StorSimple серии 8000

## <a name="overview"></a>Обзор

Вы можете подключаться к своему устройству удаленно с помощью Windows PowerShell. При таком способе подключения меню не отображается. (Меню отображается только в том случае, если для подключения используется последовательная консоль устройства.) При удаленном взаимодействии Windows PowerShell вы подключаетесь к определенному пространству выполнения. Также можно указать язык интерфейса.

Дополнительные сведения об использовании удаленного взаимодействия Windows PowerShell для управления устройством см. в статье [Использование Windows PowerShell для StorSimple для администрирования устройства StorSimple](storsimple-8000-windows-powershell-administration.md).

В этом учебнике объясняется, как настроить устройство для удаленного управления, а затем подключиться к Windows PowerShell для StorSimple. Для удаленного подключения с использованием Windows PowerShell можно использовать HTTP или HTTPS. Однако при выборе способа подключения к Windows PowerShell для StorSimple следует учесть приведенные ниже сведения.

* Прямое подключение к последовательной консоли устройства является безопасным, а подключение к последовательной консоли через сетевые коммутаторы — нет. При подключении к последовательной консоли устройства через сетевые коммутаторы учитывайте угрозы для безопасности.
* Подключение через сеанс HTTP может быть более безопасным, чем подключение через последовательную консоль по сети. Хотя это не самый безопасный метод, его можно использовать в доверенных сетях.
* Наиболее безопасным и рекомендуемым способом подключения является подключение через сеанс HTTPS с самозаверяющим сертификатом.

К интерфейсу Windows PowerShell можно подключиться удаленно. Однако удаленный доступ к устройству StorSimple в интерфейсе Windows PowerShell по умолчанию отключен. Следует включить удаленное управление сначала на устройстве, а затем — в клиенте, который будет использоваться для доступа к устройству.

Действия, описанные в этой статье, были выполнены в системе узла под управлением Windows Server 2012 R2.

## <a name="connect-through-http"></a>Подключение по протоколу HTTP

Подключение к Windows PowerShell для StorSimple через сеанс HTTP обеспечивает более высокий уровень безопасности по сравнению с подключением через последовательную консоль устройства StorSimple. Хотя это не самый безопасный метод, его можно использовать в доверенных сетях.

Для настройки удаленного управления можно использовать портал Azure или последовательную консоль. Выберите одну из следующих процедур:

* Включение удаленного управления по протоколу HTTP с помощью портала Azure
* [Включение удаленного управления по протоколу HTTP с помощью последовательной консоли](#use-the-serial-console-to-enable-remote-management-over-http)

После включения удаленного управления используйте следующую процедуру для подготовки клиента для удаленного подключения.

* [Подготовка клиента для удаленного подключения](#prepare-the-client-for-remote-connection)

### <a name="use-the-azure-portal-to-enable-remote-management-over-http"></a>Включение удаленного управления по протоколу HTTP с помощью портала Azure

Чтобы включить удаленное управление по протоколу HTTP, выполните следующие действия на портале Azure.

#### <a name="to-enable-remote-management-through-the-azure-portal"></a>Включение удаленного управления с помощью портала Azure

1. Откройте службу диспетчера устройств StorSimple. Выберите **Устройства**, а затем щелкните устройство, на котором нужно настроить удаленное управление. Последовательно выберите пункты **Параметры устройства > Безопасность**.
2. В колонке **Параметры безопасности** щелкните **Удаленное управление**.
3. В колонке **Удаленное управление** для параметра **Включить удаленное управление** установите значение **Да**.
4. Теперь вы можете выбрать подключение по HTTP. (По умолчанию используется подключение по протоколу HTTPS.) Убедитесь, что выбран протокол HTTP.
   
   > [!NOTE]
   > Подключение по HTTP допустимо только в доверенных сетях.
   
5. Щелкните **Сохранить**, а затем щелкните **Да**, когда появится запрос на подтверждение.

### <a name="use-the-serial-console-to-enable-remote-management-over-http"></a>Включение удаленного управления по протоколу HTTP с помощью последовательной консоли
Для включения удаленного управления выполните следующие действия в последовательной консоли устройства.

#### <a name="to-enable-remote-management-through-the-device-serial-console"></a>Включение удаленного управления с помощью последовательной консоли
1. В меню последовательной консоли выберите вариант 1. Дополнительные сведения об использовании последовательной консоли устройства см. в статье [Подключение к Windows PowerShell для StorSimple через последовательную консоль устройства](storsimple-8000-windows-powershell-administration.md#connect-to-windows-powershell-for-storsimple-via-the-device-serial-console).
2. В командной строке введите следующую команду: `Enable-HcsRemoteManagement –AllowHttp`
3. Вы получите уведомление об уязвимостях системы безопасности при подключении к устройству с помощью HTTP. При появлении запроса подтвердите, введя **Y**.
4. Убедитесь, что HTTP включен, набрав: `Get-HcsSystem`
5. Убедитесь, что значение поля **RemoteManagementMode** равно **HttpsAndHttpEnabled**. На следующем рисунке показаны эти параметры в PuTTY.
   
     ![Последовательный HTTPS и HTTP включены](./media/storsimple-remote-connect/HCS_SerialHttpsAndHttpEnabled.png)

### <a name="prepare-the-client-for-remote-connection"></a>Подготовка клиента для удаленного подключения
Для включения удаленного управления выполните следующие действия в клиенте.

#### <a name="to-prepare-the-client-for-remote-connection"></a>Подготовка клиента для удаленного подключения
1. Запустите сеанс Windows PowerShell от имени администратора. Если вы используете клиент Windows 10, по умолчанию служба удаленного управления Windows работает в ручном режиме. Чтобы запустить службу, введите этот командлет:

    `Start-Service WinRM`
    
2. Введите следующую команду, чтобы добавить IP-адрес устройства StorSimple в список доверенных узлов клиента:
   
     `Set-Item wsman:\localhost\Client\TrustedHosts <device_ip> -Concatenate -Force`
   
     Замените <*device_ip*> IP-адресом своего устройства, например: 
   
     `Set-Item wsman:\localhost\Client\TrustedHosts 10.126.173.90 -Concatenate -Force`
3. Введите следующую команду, чтобы сохранить учетные данные устройства в переменной: 
   
    ```
    $cred = Get-Credential
    ```
    
4. В открывшемся диалоговом окне:
   
   1. Введите имя пользователя в следующем формате: *device_ip\SSAdmin*.
   2. Введите пароль администратора устройства, который был установлен при настройке устройства с помощью мастера установки. Пароль по умолчанию — *Password1*.
5. Запустите сеанс Windows PowerShell на устройстве, введя следующую команду:
   
     `Enter-PSSession -Credential $cred -ConfigurationName SSAdminConsole -ComputerName <device_ip>`
   
   > [!NOTE]
   > Чтобы создать сеанс Windows PowerShell для виртуального устройства StorSimple, добавьте параметр `–Port` и укажите общий порт, настроенный для удаленного взаимодействия с виртуальным устройством StorSimple.
   
   
На этом этапе у вас должен быть активный удаленный сеанс Windows PowerShell с устройством.
   
![Удаленное взаимодействие PowerShell через HTTP](./media/storsimple-remote-connect/HCS_PSRemotingUsingHTTP.png)

## <a name="connect-through-https"></a>Подключение по протоколу HTTPS

Подключение к Windows PowerShell для StorSimple через сеанс HTTPS — наиболее безопасный и рекомендуемый метод удаленного подключения к устройству Microsoft Azure StorSimple. В следующих процедурах описана настройка последовательной консоли и клиентских компьютеров для использования HTTPS для подключения к Windows PowerShell для StorSimple.

Для настройки удаленного управления можно использовать портал Azure или последовательную консоль. Выберите одну из следующих процедур:

* Включение удаленного управления по протоколу HTTPS с помощью портала Azure
* [Включение удаленного управления по протоколу HTTPS с помощью последовательной консоли](#use-the-serial-console-to-enable-remote-management-over-https)

После включения удаленного управления используйте следующие процедуры для подготовки узла для удаленного управления и подключения к устройству с удаленного узла.

* [Подготовка узла для удаленного управления](#prepare-the-host-for-remote-management)
* [Подключение к устройству с удаленного узла](#connect-to-the-device-from-the-remote-host)

### <a name="use-the-azure-portal-to-enable-remote-management-over-https"></a>Включение удаленного управления по протоколу HTTPS с помощью портала Azure

Чтобы включить удаленное управление по протоколу HTTPS, выполните следующие действия на портале Azure.

#### <a name="to-enable-remote-management-over-https-from-the-azure-portal"></a>Включение удаленного управления по протоколу HTTPS на портале Azure

1. Откройте службу диспетчера устройств StorSimple. Выберите **Устройства**, а затем щелкните устройство, на котором нужно настроить удаленное управление. Последовательно выберите пункты **Параметры устройства > Безопасность**.
2. В колонке **Параметры безопасности** щелкните **Удаленное управление**.
3. Установите для параметра **Включить удаленное управление** значение **Да**.
4. Теперь вы можете выбрать подключение по HTTPS. (По умолчанию используется подключение по протоколу HTTPS.) Убедитесь, что выбран протокол HTTPS.
5. Щелкните многоточие (…), а затем выберите **Загрузить сертификат удаленного управления**. Укажите расположение для сохранения этого файла. Этот сертификат следует установить на компьютере клиента или узла, который будет использоваться для подключения к устройству.
6. Нажмите кнопку **Сохранить**, а затем щелкните **Да**, когда появится запрос на подтверждение.

### <a name="use-the-serial-console-to-enable-remote-management-over-https"></a>Включение удаленного управления по протоколу HTTPS с помощью последовательной консоли

Для включения удаленного управления выполните следующие действия в последовательной консоли устройства.

#### <a name="to-enable-remote-management-through-the-device-serial-console"></a>Включение удаленного управления с помощью последовательной консоли
1. В меню последовательной консоли выберите вариант 1. Дополнительные сведения об использовании последовательной консоли устройства см. в статье [Подключение к Windows PowerShell для StorSimple через последовательную консоль устройства](storsimple-8000-windows-powershell-administration.md#connect-to-windows-powershell-for-storsimple-via-the-device-serial-console).
2. В командной строке введите следующую команду:
   
     `Enable-HcsRemoteManagement`
   
    Эта команда должна включить протокол HTTPS на вашем устройстве.
3. Убедитесь, что HTTPS включен, набрав: 
   
     `Get-HcsSystem`
   
    Убедитесь, что в поле **RemoteManagementMode** задано значение **HttpsEnabled**. На следующем рисунке показаны эти параметры в PuTTY.
   
     ![Последовательный HTTPS включен](./media/storsimple-remote-connect/HCS_SerialHttpsEnabled.png)
4. Из вывода команды `Get-HcsSystem`скопируйте серийный номер устройства и сохраните его для последующего использования.
   
   > [!NOTE]
   > Серийный номер сопоставляется CN-имени в сертификате.
   
5. Получите сертификат удаленного управления, набрав: 
   
     `Get-HcsRemoteManagementCert`
   
    Появится сертификат, похожий на показанный ниже:
   
    ![Получение сертификата удаленного управления](./media/storsimple-remote-connect/HCS_GetRemoteManagementCertificate.png)
6. Скопируйте информацию из сертификата от **-----BEGIN CERTIFICATE-----** до **-----END CERTIFICATE-----** в текстовый редактор, например в "Блокнот", и сохраните файл в формате CER. (При подготовке удаленного узла этот файл будет необходимо скопировать на этот узел.)
   
   > [!NOTE]
   > Чтобы создать новый сертификат, используйте командлет `Set-HcsRemoteManagementCert`.
   
### <a name="prepare-the-host-for-remote-management"></a>Подготовка узла для удаленного управления

Чтобы подготовить компьютер узла для удаленного подключения, которое использует сеанс HTTPS, выполните следующие процедуры.

* [Импортируйте CER файл в корневое хранилище клиента или удаленного узла](#to-import-the-certificate-on-the-remote-host).
* [Добавьте серийные номера устройств в файл hosts на удаленном узле](#to-add-device-serial-numbers-to-the-remote-host).

Каждая из этих процедур описана ниже.

#### <a name="to-import-the-certificate-on-the-remote-host"></a>Импорт сертификата на удаленном узле
1. Щелкните правой кнопкой мыши CER-файл и выберите команду **Установить сертификат**. Откроется мастер импорта сертификатов.
   
    ![Мастер импорта сертификатов 1](./media/storsimple-remote-connect/HCS_CertificateImportWizard1.png)
2. В качестве **Расположения хранилища** выберите **Локальный компьютер**, а затем нажмите кнопку **Далее**.
3. Выберите **Поместить все сертификаты в следующее хранилище**, затем нажмите кнопку **Обзор**. Перейдите в корневое хранилище удаленного узла и нажмите кнопку **Далее**.
   
    ![Мастер импорта сертификатов 2](./media/storsimple-remote-connect/HCS_CertificateImportWizard2.png)
4. Нажмите кнопку **Готово**. Появится сообщение о том, что импорт успешно выполнен.
   
    ![Мастер импорта сертификатов 3](./media/storsimple-remote-connect/HCS_CertificateImportWizard3.png)

#### <a name="to-add-device-serial-numbers-to-the-remote-host"></a>Добавление серийных номеров устройства в удаленный узел
1. Откройте "Блокнот" от имени администратора и откройте файл hosts, расположенный в папке \Windows\System32\Drivers\etc.
2. Добавьте следующие три записи в файл hosts: **IP-адрес данных 0**, **Фиксированный IP-адрес контроллера 0** и **Фиксированный IP-адрес контроллера 1**.
3. Введите серийный номер устройства, сохраненный ранее. Сопоставьте его с IP-адресом, как показано на следующем рисунке. Добавьте в конце серийного номера контроллера 0 и контроллера 1 значения **Controller0** и **Controller1** (CN-имя).
   
    ![Добавление имени CN в файл hosts](./media/storsimple-remote-connect/HCS_AddingCNNameToHostsFile.png)
4. Сохраните файл hosts.

### <a name="connect-to-the-device-from-the-remote-host"></a>Подключение к устройству с удаленного узла

Используйте Windows PowerShell и TLS для ввода сеанса SSAdmin на устройстве с удаленного узла или клиента. Сеанс SSAdmin соответствует пункту 1 в меню [последовательной консоли](storsimple-8000-windows-powershell-administration.md#connect-to-windows-powershell-for-storsimple-via-the-device-serial-console) устройства.

Выполните следующую процедуру на компьютере, с которого будет выполняться удаленное подключение Windows PowerShell.

#### <a name="to-enter-an-ssadmin-session-on-the-device-by-using-windows-powershell-and-tls"></a>Ввод сеанса SSAdmin на устройстве с помощью Windows PowerShell и TLS
1. Запустите сеанс Windows PowerShell от имени администратора. Если вы используете клиент Windows 10, по умолчанию служба удаленного управления Windows работает в ручном режиме. Чтобы запустить службу, введите этот командлет:

    `Start-Service WinRM`

2. Добавьте IP-адрес устройства в доверенные узлы клиента, набрав:
   
     `Set-Item wsman:\localhost\Client\TrustedHosts <device_ip> -Concatenate -Force`
   
    Замените <*device_ip*> IP-адресом своего устройства, например: 
   
     `Set-Item wsman:\localhost\Client\TrustedHosts 10.126.173.90 -Concatenate -Force`
3. Чтобы создать новые учетные данные, введите:
   
     `$cred = New-Object pscredential @("<IP of target device>\SSAdmin", (ConvertTo-SecureString -Force -AsPlainText "<Device Administrator Password>"))`
   
    Где <*IP of target device*> — это IP-адрес DATA 0 вашего устройства, например, **10.126.173.90**, как показано на предыдущем рисунке файла hosts. Также укажите пароль администратора для вашего устройства.
4. Создайте сеанс, набрав:
   
     `$session = New-PSSession -UseSSL -ComputerName <Serial number of target device> -Credential $cred -ConfigurationName "SSAdminConsole"`
   
    В качестве параметра -ComputerName в командлете введите <*серийный номер целевого устройства*>. Этот серийный номер был сопоставлен с IP-адресом DATA 0 в файле hosts на удаленном узле. Пример — **SHX0991003G44MT**, как показано на следующем рисунке.
5. Тип:
   
     `Enter-PSSession $session`
6. Вам потребуется подождать несколько минут, после чего вы будете подключены к устройству через протокол HTTPS через TLS. Вы увидите сообщение о том, что вы подключены к устройству.
   
    ![Удаленное взаимодействие PowerShell с использованием HTTPS и TLS](./media/storsimple-remote-connect/HCS_PSRemotingUsingHTTPSAndSSL.png)

## <a name="next-steps"></a>Дальнейшие действия

* Узнайте больше об [использовании Windows PowerShell для администрирования устройства StorSimple](storsimple-8000-windows-powershell-administration.md).
* Узнайте больше об [использовании службы диспетчера устройств StorSimple для администрирования устройства StorSimple](storsimple-8000-manager-service-administration.md).

