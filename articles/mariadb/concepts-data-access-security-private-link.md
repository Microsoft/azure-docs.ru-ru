---
title: Частная ссылка — база данных Azure для MariaDB
description: Узнайте, как работает частная связь для базы данных Azure для MariaDB.
author: mksuni
ms.author: sumuth
ms.service: jroth
ms.topic: conceptual
ms.date: 03/10/2020
ms.openlocfilehash: 12f52cd497d606fda6bbea9b54f467522373eeb7
ms.sourcegitcommit: 52e3d220565c4059176742fcacc17e857c9cdd02
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/21/2021
ms.locfileid: "98665146"
---
# <a name="private-link-for-azure-database-for-mariadb"></a>Частная ссылка для базы данных Azure для MariaDB

Частная ссылка позволяет создавать частные конечные точки для базы данных Azure для MariaDB и, таким образом, предоставляет службы Azure в частной виртуальной сети (VNet). Частная конечная точка предоставляет частный IP-адрес, который можно использовать для подключения к серверу базы данных Azure для MariaDB, как и любой другой ресурс в виртуальной сети.

Чтобы получить список служб PaaS, поддерживающих функции закрытых ссылок, ознакомьтесь с [документацией по](../private-link/index.yml)частному каналу. Частная конечная точка — это частный IP-адрес в определенной [виртуальной сети](../virtual-network/virtual-networks-overview.md) и подсети.

> [!NOTE]
> Функция "Частная связь" доступна только для серверов базы данных Azure для MariaDB в общего назначения или ценовых категориях, оптимизированных для памяти. Убедитесь, что сервер базы данных находится в одной из этих ценовых категорий.

## <a name="data-exfiltration-prevention"></a>Предотвращение кражи данных

Data ex-фильтрация в базе данных Azure для MariaDB — когда полномочный пользователь, например администратор базы данных, может извлекать данные из одной системы и перемещать их в другое расположение или систему за пределами Организации. Например, пользователь перемещает данные в учетную запись хранения, принадлежащую третьей стороне.

Рассмотрим ситуацию с пользователем, работающим с MariaDB Workbench, в виртуальной машине Azure, которая подключается к экземпляру базы данных Azure для MariaDB. Этот экземпляр MariaDB находится в центре обработки данных в западной части США. В приведенном ниже примере показано, как ограничить доступ с помощью общедоступных конечных точек в базе данных Azure для MariaDB, используя элементы управления доступом к сети.

* Отключите весь трафик службы Azure к базе данных Azure для MariaDB через общедоступную конечную точку, установив флажок Разрешить службам Azure отключать. Убедитесь, что IP-адреса или диапазоны не разрешены для доступа к серверу через [правила брандмауэра](concepts-firewall-rules.md) или [конечные точки службы виртуальной сети](concepts-data-access-security-vnet.md).

* Разрешите трафик только в базу данных Azure для MariaDB, используя частный IP-адрес виртуальной машины. Дополнительные сведения см. в статьях, посвященных [конечной точке службы](concepts-data-access-security-vnet.md) и [правилам брандмауэра виртуальной сети](howto-manage-vnet-portal.md).

* На виртуальной машине Azure Ограничьте область исходящего подключения с помощью групп безопасности сети (группы безопасности сети) и тегов службы следующим образом:

    * Укажите правило NSG, разрешающее трафик для тега службы = SQL. WestUs — разрешает подключение к базе данных Azure для MariaDB в западной части США
    * Укажите правило NSG (с более высоким приоритетом) для запрета трафика для тега службы = SQL — запрет подключений к базе данных MariaDB во всех регионах</br></br>

После завершения установки виртуальная машина Azure может подключаться только к базе данных Azure для MariaDB в регионе "Западная часть США". Однако подключение не ограничено одной базой данных Azure для MariaDB. Виртуальная машина по-прежнему может подключаться к любой базе данных Azure для MariaDB в регионе "Западная часть США", включая базы данных, которые не входят в подписку. Хотя мы сократили масштабы кражи данных в приведенном выше сценарии до определенного региона, мы не полностью устранили ее.</br>

С помощью частного канала теперь можно настроить такие элементы управления доступом к сети, как группы безопасности сети, чтобы ограничить доступ к частной конечной точке. Затем отдельные ресурсы Azure PaaS сопоставляются с конкретными частными конечными точками. Вредоносная программа предварительной оценки может получить доступ только к сопоставленному ресурсу PaaS (например, базе данных Azure для MariaDB) и другим ресурсам.

## <a name="on-premises-connectivity-over-private-peering"></a>Локальные подключения через частный пиринг

При подключении к общедоступной конечной точке из локальных компьютеров необходимо добавить IP-адрес в брандмауэр на основе IP-адресов, используя правило брандмауэра уровня сервера. Хотя эта модель отлично подходит для предоставления доступа к отдельным компьютерам для рабочих нагрузок разработки или тестирования, управлять ею в рабочей среде сложно.

С помощью закрытой ссылки можно включить локальный доступ к частной конечной точке с помощью [Express Route](https://azure.microsoft.com/services/expressroute/) (ER), частного пиринга или [VPN-туннеля](../vpn-gateway/index.yml). Затем они могут отключить доступ через общедоступную конечную точку и не использовать брандмауэр на основе IP-адресов.

> [!NOTE]
> Иногда база данных Azure для MariaDB и подсеть виртуальной сети относятся к разным подпискам. В этих случаях необходимо обеспечить следующую конфигурацию:
> - Убедитесь, что в обеих подписках зарегистрирован поставщик ресурсов **Microsoft. дбформариадб** . Дополнительные сведения см. в разделе [resource-manager-registration][resource-manager-portal]

## <a name="configure-private-link-for-azure-database-for-mariadb"></a>Настройка частной ссылки для базы данных Azure для MariaDB

### <a name="creation-process"></a>Процесс создания

Для включения закрытой ссылки требуются частные конечные точки. Это можно сделать с помощью следующих руководств.

* [Портал Azure](howto-configure-privatelink-portal.md)
* [CLI](howto-configure-privatelink-cli.md)

### <a name="approval-process"></a>Процесс утверждения

После того как администратор сети создаст закрытую конечную точку (PE), администратор может управлять подключением к частной конечной точке (PEC) к базе данных Azure для MariaDB. Такое разделение обязанностей между администратором сети и АДМИНИСТРАТОРом базы данных полезно для управления подключением к службе "служба Azure для MariaDB". 

* Перейдите к ресурсу сервера базы данных Azure для MariaDB в портал Azure. 
    * Выберите подключения частной конечной точки в левой области.
    * Отображает список всех подключений к частным конечным точкам (ПЕКС)
    * Соответствующая частная конечная точка (PE) создана

![Выбор закрытого портала конечной точки](media/concepts-data-access-and-security-private-link/select-private-link-portal.png)

* Выберите отдельное PEC из списка, щелкнув его.

![Выберите закрытую конечную точку, ожидающие утверждения](media/concepts-data-access-and-security-private-link/select-private-link.png)

* Администратор сервера MariaDB может одобрить или отклонить PEC и при необходимости добавить короткий текст ответа.

![Выберите сообщение частной конечной точки](media/concepts-data-access-and-security-private-link/select-private-link-message.png)

* После утверждения или отклонения список будет отражать соответствующее состояние вместе с текстом ответа.

![выберите конечное состояние частной конечной точки](media/concepts-data-access-and-security-private-link/show-private-link-approved-connection.png)

## <a name="use-cases-of-private-link-for-azure-database-for-mariadb"></a>Варианты использования частной ссылки для базы данных Azure для MariaDB

Клиенты могут подключаться к частной конечной точке из той же виртуальной сети, одноранговой виртуальной сети в том же регионе или через подключение между виртуальными сетями в разных регионах. Кроме того, клиенты могут подключаться из локальной среды с помощью ExpressRoute, частного пиринга или VPN-туннелирования. Ниже приведена упрощенная схема, на которой показаны распространенные варианты использования.

![Выберите Общие сведения о конечной точке частного назначения](media/concepts-data-access-and-security-private-link/show-private-link-overview.png)

### <a name="connecting-from-an-azure-vm-in-peered-virtual-network-vnet"></a>Подключение из виртуальной машины Azure в одноранговой виртуальной сети (VNet)
Настройте [пиринг виртуальных сетей](../virtual-network/tutorial-connect-virtual-networks-powershell.md) , чтобы установить подключение к базе данных Azure для MariaDB с виртуальной машины Azure в одноранговой виртуальной сети.

### <a name="connecting-from-an-azure-vm-in-vnet-to-vnet-environment"></a>Подключение из виртуальной машины Azure в среде виртуальных сетей
Настройте [подключение VPN-шлюза](../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md) между виртуальными сетями, чтобы установить подключение к базе данных Azure для MariaDB с виртуальной машины Azure в другом регионе или в подписке.

### <a name="connecting-from-an-on-premises-environment-over-vpn"></a>Подключение из локальной среды через VPN
Чтобы установить подключение из локальной среды к базе данных Azure для MariaDB, выберите и реализуйте один из следующих вариантов:

* [Подключение "точка — сеть"](../vpn-gateway/vpn-gateway-howto-point-to-site-rm-ps.md)
* [VPN-подключение типа "сеть —сеть"](../vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)
* [Канал ExpressRoute](../expressroute/expressroute-howto-linkvnet-portal-resource-manager.md)

## <a name="private-link-combined-with-firewall-rules"></a>Использование Приватного канала совместно с правилами брандмауэра

При использовании Приватного канала совместно с правилами брандмауэра возможны следующие ситуации и результаты.

* Если не настроить какие бы то ни было правила брандмауэра, по умолчанию трафик не будет доступен для базы данных Azure для MariaDB.

* Если вы настраиваете общедоступный трафик или конечную точку службы и создаете частные конечные точки, то для разных типов входящего трафика применяется соответствующий тип правила брандмауэра.

* Если вы не настраиваете общедоступную конечную точку и не создаете частные конечные точки, то база данных Azure для MariaDB доступна только через частные конечные точки. Если не настроить общедоступный трафик или конечную точку службы после того, как все утвержденные частные конечные точки будут отклонены или удалены, трафик не сможет получить доступ к базе данных Azure для MariaDB.

## <a name="deny-public-access-for-azure-database-for-mariadb"></a>Запрет общего доступа для базы данных Azure для MariaDB

Если вы хотите использовать только частные конечные точки для доступа к своей базе данных Azure для MariaDB, можно отключить настройку всех общедоступных конечных точек ([правил брандмауэра](concepts-firewall-rules.md) и [конечных точек службы виртуальной](concepts-data-access-security-vnet.md)сети), задав для параметра "запретить общедоступную **сеть** " на сервере базы данных. 

Если для этого параметра задано значение *Да*, для базы данных Azure для MariaDB разрешены только подключения через частные конечные точки. Если для этого параметра установлено значение *нет*, клиенты могут подключаться к базе данных Azure для MariaDB на основе параметров брандмауэра или конечной точки службы виртуальной сети. Кроме того, после установки значения "доступ к частной сети" клиенты не смогут добавлять и обновлять существующие правила брандмауэра и "правила конечной точки службы виртуальной сети".

> [!Note]
> Эта функция доступна во всех регионах Azure, где база данных Azure для PostgreSQL-Single Server поддерживает общего назначения и ценовые категории, оптимизированные для памяти.
>
> Этот параметр не влияет на конфигурации SSL и TLS для базы данных Azure для MariaDB.

Сведения о настройке **запрета доступа к** общедоступной сети для базы данных Azure для MariaDB с портал Azure см. в разделе [Настройка запрета доступа к общедоступной сети](howto-deny-public-network-access.md).

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о функциях безопасности базы данных Azure для MariaDB см. в следующих статьях:

* Сведения о настройке брандмауэра для базы данных Azure для MariaDB см. в разделе [Поддержка брандмауэра](concepts-firewall-rules.md).

* Чтобы узнать, как настроить конечную точку службы виртуальной сети для базы данных Azure для MariaDB, см. раздел [Настройка доступа из виртуальных сетей](concepts-data-access-security-vnet.md).

* Общие сведения о подключении к базе данных Azure для MariaDB см. в статье [архитектура службы "база данных Azure для MariaDB](concepts-connectivity-architecture.md) ".

<!-- Link references, to text, Within this same GitHub repo. -->
[resource-manager-portal]: ../azure-resource-manager/management/resource-providers-and-types.md
